---
title: WordPress Vulnerability Sinks
description: "A list of 'sink' points in WordPress — where input data can lead to the execution of malicious actions."
date: 2025-11-13 19:00:00 +0700
categories: [Bug Bounty]
tags: [sink, wordpress]
images: ["app.png"]
featuredImage: "app.png"

lightgallery: true

toc:
  auto: false
---

<!--more-->

## Why This Article?

Trong quá trình pentest việc **xác định các điểm sink** là bước then chốt — đó là nơi dữ liệu đầu vào (user-controlled) thực sự được tiêu thụ và có khả năng gây ra hành vi độc hại (RCE, SQLi, XSS, file write, v.v.). Mỗi lỗ hổng thường liên quan đến một hoặc nhiều sink; nếu chỉ tìm input không thôi thì dễ bỏ sót đường dẫn thực thi.

Mục tiêu của bài viết này là: Tổng hợp tập trung các **sink** thường gặp trong WordPress để dễ tra cứu.

Bằng cách có một “bản đồ sink” rõ ràng, pentester, CVE analyst và developer sẽ tiếp cận lỗ hổng hiệu quả hơn — từ phát hiện tới khắc phục.

## WordPress Sink Catalog

### SQL Injection (SQLi)
* [`$wpdb->query`](https://developer.wordpress.org/reference/classes/wpdb/query/)
* [`$wpdb->get_var`](https://developer.wordpress.org/reference/classes/wpdb/get_var/)
* [`$wpdb->get_row`](https://developer.wordpress.org/reference/classes/wpdb/get_row/)
* [`$wpdb->get_col`](https://developer.wordpress.org/reference/classes/wpdb/get_col/)
* [`$wpdb->get_results`](https://developer.wordpress.org/reference/classes/wpdb/get_results/)

```regex
\$wpdb->\s*(query|get_(var|row|col|results))\s*
```

> [!NOTE]
> **Magic Quotes** là tính năng PHP tự động escape ký tự đặc biệt (`'`, `"`, `\`, NULL) trong dữ liệu đầu vào để giảm nguy cơ SQL Injection. Nó không hoàn hảo, chỉ escape một số ký tự và PHP đã tắt mặc định. WordPress vẫn dùng cơ chế này qua `wp_magic_quotes()` và `add_magic_quotes()` để tự động xử lý `$_GET`, `$_POST`, `$_COOKIE`, `$_SERVER`, nhưng developer nên dùng các biện pháp chuẩn như `$wpdb->prepare()` để chống SQLi.

### Cross-Site Scripting (XSS)
* [`add_shortcode`](https://developer.wordpress.org/reference/functions/add_shortcode/)
* [`register_block_type `](https://developer.wordpress.org/reference/functions/register_block_type/)
* `elementor/widgets/register `
* `render`

```regex
\b(add_shortcode|register_block_type|elementor/widgets/register|render|print|echo|innerHTML|outerHTML|document\.write)\b
```

### Local File Inclusion (LFI)
* [`include`](https://www.php.net/manual/en/function.include.php)
* [`include_once`](https://www.php.net/manual/en/function.include-once.php)
* [`require`](https://www.php.net/manual/en/function.require.php)
* [`require_once`](https://www.php.net/manual/en/function.require-once.php)

```regex
\b(include|require)(_once)?\b
```

> [!NOTE]
> Remote File Inclusion (RFI) xảy ra khi ứng dụng PHP cho phép `include`/`require` một tập tin từ URL do người dùng kiểm soát — điều kiện thường là `allow_url_fopen` và `allow_url_include` bật — dẫn tới việc tải và thực thi mã PHP từ máy chủ từ xa, gây **remote code execution**. Ngăn chặn bằng cách tắt `allow_url_include`, không dùng input trực tiếp trong include/require, và áp whitelist/normalize đường dẫn.

### Server Side Request Forgery (SSRF)

* **PHP related**

  * [`file_get_contents`](https://www.php.net/manual/en/function.file-get-contents.php)
  * [`readfile`](https://www.php.net/manual/en/function.readfile.php)
  * [`fopen`](https://www.php.net/manual/en/function.fopen.php)
  * [`stream_get_contents`](https://www.php.net/manual/en/function.stream-get-contents.php)
  * [`file`](https://www.php.net/manual/en/function.file.php)
  * [`curl_exec` / `cURL`](https://www.php.net/manual/en/function.curl-exec.php)

```regex
\b(file_get_contents|readfile|fopen|stream_get_contents|curl_exec|curl_init|curl_setopt|curl_multi_exec)\b
```

* **WordPress related**

  * [`wp_remote_head`](https://developer.wordpress.org/reference/functions/wp_remote_head/)
  * [`wp_remote_get`](https://developer.wordpress.org/reference/functions/wp_remote_get/)
  * [`wp_remote_post`](https://developer.wordpress.org/reference/functions/wp_remote_post/)
  * [`wp_remote_request`](https://developer.wordpress.org/reference/functions/wp_remote_request/)

```regex
\bwp_remote_(head|get|post|request)\b
```
### Arbitrary File Upload

* **PHP related**

  * [`move_uploaded_file`](https://www.php.net/manual/en/function.move-uploaded-file.php)
  * [`file_put_contents`](https://www.php.net/manual/en/function.file-put-contents.php)
  * [`fwrite`](https://www.php.net/manual/en/function.fwrite.php)
  * [`fputs`](https://www.php.net/manual/en/function.fputs.php)
  * [`copy`](https://www.php.net/manual/en/function.copy.php)
  * [`fputcsv`](https://www.php.net/manual/en/function.fputcsv.php)
  * [`rename`](https://www.php.net/manual/en/function.rename.php)
  * [`ZipArchive::extractTo`](https://www.php.net/manual/en/ziparchive.extractto.php)
  * [`PharData::extractTo`](https://www.php.net/manual/en/phardata.extractto.php)
  * [`unzip_file`](https://developer.wordpress.org/reference/functions/unzip_file/)

```regex
\b(move_uploaded_file|file_put_contents|fwrite|fputs|copy|fputcsv|rename|ZipArchive::extractTo|PharData::extractTo|unzip_file)\b
```

* **WordPress related**

  * [`WP_Filesystem_Direct::put_contents`](https://developer.wordpress.org/reference/classes/wp_filesystem_direct/#method-put_contents)
  * [`WP_Filesystem_Direct::move`](https://developer.wordpress.org/reference/classes/wp_filesystem_direct/#method-move)
  * [`WP_Filesystem_Direct::copy`](https://developer.wordpress.org/reference/classes/wp_filesystem_direct/#method-copy)
  * [`wp_handle_upload()` with `test_type => false`](https://developer.wordpress.org/reference/functions/wp_handle_upload/)

```regex
\b(WP_Filesystem_Direct::put_contents|WP_Filesystem_Direct::move|WP_Filesystem_Direct::copy|wp_handle_upload)\b
```

### Arbitrary File Read

* **PHP related**

  * [`file_get_contents`](https://www.php.net/manual/en/function.file-get-contents.php)
  * [`readfile`](https://www.php.net/manual/en/function.readfile.php)
  * [`fopen`](https://www.php.net/manual/en/function.fopen.php)
  * [`fread`](https://www.php.net/manual/en/function.fread.php)
  * [`fgets`](https://www.php.net/manual/en/function.fgets.php)
  * [`fgetcsv`](https://www.php.net/manual/en/function.fgetcsv.php)
  * [`fgetss` (deprecated from PHP 7.3)](https://www.php.net/manual/en/function.fgetss.php)
  * [`file`](https://www.php.net/manual/en/function.file.php)
  * [`curl_exec` / cURL](https://www.php.net/manual/en/function.curl-exec.php)

```regex
\b(file_get_contents|readfile|fopen|fread|fgets|fgetcsv|fgetss|curl_exec)\b
```

* **WordPress related**

  * [`WP_Filesystem_Direct::get_contents`](https://developer.wordpress.org/reference/classes/wp_filesystem_direct/#method-get_contents)
  * [`WP_Filesystem_Direct::get_contents_array`](https://developer.wordpress.org/reference/classes/wp_filesystem_direct/#method-get_contents-array)

```regex
\b(WP_Filesystem_Direct::get_contents|WP_Filesystem_Direct::get_contents_array)\b
```

### Arbitrary File Deletion

* **PHP related**

  * [`unlink`](https://www.php.net/manual/en/function.unlink.php)
  * [`rmdir`](https://www.php.net/manual/en/function/rmdir.php)

```regex
\b(unlink|rmdir)\b
```

* **WordPress related**

  * [`wp_delete_file`](https://developer.wordpress.org/reference/functions/wp_delete_file/)
  * [`wp_delete_file_from_directory`](https://developer.wordpress.org/reference/functions/wp_delete_file_from_directory/)
  * [`WP_Filesystem_Direct::delete`](https://developer.wordpress.org/reference/classes/wp_filesystem_direct/#method-delete)
  * [`WP_Filesystem_Direct::rmdir`](https://developer.wordpress.org/reference/classes/wp_filesystem_direct/#method-rmdir)

```regex
\b(wp_delete_file|wp_delete_file_from_directory|WP_Filesystem_Direct::delete|WP_Filesystem_Direct::rmdir)\b
```
### PHP Object Injection

* [`unserialize`](https://www.php.net/manual/en/function.unserialize.php)
* [`maybe_unserialize`](https://developer.wordpress.org/reference/functions/maybe_unserialize/)

```regex
\b(unserialize|maybe_unserialize)\b
```

### Remote Code Execution (RCE)

* [`system`](https://www.php.net/manual/en/function.system.php)
* [`exec`](https://www.php.net/manual/en/function.exec.php)
* [`shell_exec`](https://www.php.net/manual/en/function.shell-exec.php)
* [`passthru`](https://www.php.net/manual/en/function.passthru.php)
* [`proc_open`](https://www.php.net/manual/en/function.proc-open.php)
* [`eval`](https://www.php.net/manual/en/function.eval.php)
* [`call_user_func`](https://www.php.net/manual/en/function.call-user-func.php)
* [`call_user_func_array`](https://www.php.net/manual/en/function.call-user-func-array.php)
* [`create_function`](https://www.php.net/manual/en/function.create-function.php) *(DEPRECATED từ PHP 7.2.0, REMOVED từ PHP 8.0.0)

```regex
\b(system|exec|shell_exec|passthru|proc_open|eval|call_user_func|call_user_func_array|create_function)\b
```

```regex
\$\w+\(
```

### Broken Access Control (RCE)

* [`'init'`](https://patchstack.com/academy/wordpress/wordpress-internals/hooks/#init-hook)
* [`'admin_init'`](https://patchstack.com/academy/wordpress/wordpress-internals/hooks/#admin_init-hook)
* [`'wp_ajax_'`](https://patchstack.com/academy/wordpress/wordpress-internals/hooks/#wp_ajax_action-hook)
* [`'wp_ajax_nopriv_'`](https://patchstack.com/academy/wordpress/wordpress-internals/hooks/#wp_ajax_nopriv_action-hook)
* [`register_rest_route`](https://patchstack.com/academy/wordpress/wordpress-internals/functions/#register_rest_route-function)

```regex
(add_action|do_action)\s*\(\s*['"]?(init|admin_init|wp_ajax_[\w-]+|wp_ajax_nopriv_[\w-]+)['"]?|register_rest_route\s*\(|permission_callback|current_user_can|wp_verify_nonce|is_user_logged_in
```

### Privilege Escalation

* [`'update_option'`](https://developer.wordpress.org/reference/functions/update_option/)
  * `users_can_register`: Quyết định có cho phép người dùng tự đăng ký tài khoản hay không
  * `default_role`: Quyết định quyền mặc định của người dùng mới

* [`'update_user_meta'`](https://developer.wordpress.org/reference/functions/update_user_meta/)
  * `wp_users`: chỉ chứa thông tin cơ bản (username, email, password…)
  * `wp_usermeta`: lưu mọi thông tin mở rộng của user
  * `wp_capabilities`: Nó lưu vai trò (role) của user

* [`'wp_insert_user'`](https://developer.wordpress.org/reference/functions/wp_insert_user/)
  * `role`: quyết định quyền của user.

* [`'wp_update_user'`](https://developer.wordpress.org/reference/functions/wp_update_user/)
  * `role`: quyết định quyền của user.

* [`'wp_set_password'`](https://developer.wordpress.org/reference/functions/wp_set_password/)

* [`'wp_set_auth_cookie'`](https://developer.wordpress.org/reference/functions/wp_set_auth_cookie/)

```sh
curl <WORDPRESS_BASE_URL>/wp-admin/admin-ajax.php?action=configure_platform_callback -d "user_id=1&fbid=1337"
curl <WORDPRESS_BASE_URL>/wp-admin/admin-ajax.php?action=login_third_party?fb-login=1&fbid=1337
```

* [`wp_set_current_user`](https://developer.wordpress.org/reference/functions/wp_set_current_user/)

* `set_role`

```regex
(update_option|update_user_meta|wp_insert_user|wp_update_user|wp_set_password|wp_set_auth_cookie|wp_set_current_user|set_role)\s*\(
```