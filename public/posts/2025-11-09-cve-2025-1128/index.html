<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>CVE-2025-1128 Analysis &amp; POC - Bui Van Y</title><meta name="author" content="Bui Van Y">
<meta name="description" content="Security Vulnerability in WordPress Everest Forms Plugin."><meta name="keywords" content='analyst, plugin, arbitrary file upload'>
  <meta itemprop="name" content="CVE-2025-1128 Analysis & POC">
  <meta itemprop="description" content="Security Vulnerability in WordPress Everest Forms Plugin.">
  <meta itemprop="datePublished" content="2025-11-09T19:00:00+07:00">
  <meta itemprop="dateModified" content="2025-11-03T18:25:14+07:00">
  <meta itemprop="wordCount" content="1994">
  <meta itemprop="image" content="http://localhost:1313/posts/2025-11-09-cve-2025-1128/app.png">
  <meta itemprop="keywords" content="Analyst,Plugin,Arbitrary File Upload"><meta property="og:url" content="http://localhost:1313/posts/2025-11-09-cve-2025-1128/">
  <meta property="og:site_name" content="Bui Van Y">
  <meta property="og:title" content="CVE-2025-1128 Analysis & POC">
  <meta property="og:description" content="Security Vulnerability in WordPress Everest Forms Plugin.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-11-09T19:00:00+07:00">
    <meta property="article:modified_time" content="2025-11-03T18:25:14+07:00">
    <meta property="article:tag" content="Analyst">
    <meta property="article:tag" content="Plugin">
    <meta property="article:tag" content="Arbitrary File Upload">
    <meta property="og:image" content="http://localhost:1313/posts/2025-11-09-cve-2025-1128/app.png">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://localhost:1313/posts/2025-11-09-cve-2025-1128/app.png">
  <meta name="twitter:title" content="CVE-2025-1128 Analysis & POC">
  <meta name="twitter:description" content="Security Vulnerability in WordPress Everest Forms Plugin.">
<meta name="application-name" content="Bui Van Y">
<meta name="apple-mobile-web-app-title" content="Bui Van Y"><meta name="theme-color" data-light="#f8f8f8" data-dark="#252627" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="icon" href="/images/svg-spinners--wind-toy.svg"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" type="text/html" href="http://localhost:1313/posts/2025-11-09-cve-2025-1128/" title="CVE-2025-1128 Analysis &amp; POC - Bui Van Y" /><link rel="prev" type="text/html" href="http://localhost:1313/posts/2025-11-08-cve-2025-39557/" title="CVE-2025-39557 Analysis &amp; POC" /><link rel="next" type="text/html" href="http://localhost:1313/posts/2025-11-10-cve-2023-48777/" title="CVE-2023-48777 Analysis &amp; POC" /><link rel="alternate" type="text/markdown" href="http://localhost:1313/posts/2025-11-09-cve-2025-1128/index.md" title="CVE-2025-1128 Analysis & POC - Bui Van Y"><link rel="stylesheet" href="/css/config.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "CVE-2025-1128 Analysis \u0026 POC",
    "inLanguage": "en",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "http:\/\/localhost:1313\/posts\/2025-11-09-cve-2025-1128\/"
    },"image": ["http:\/\/localhost:1313\/images\/avatar.png"],"genre": "posts","keywords": "analyst, plugin, arbitrary file upload","wordcount":  1994 ,
    "url": "http:\/\/localhost:1313\/posts\/2025-11-09-cve-2025-1128\/","datePublished": "2025-11-09T19:00:00+07:00","dateModified": "2025-11-03T18:25:14+07:00","publisher": {
      "@type": "Organization",
      "name": "/images/avatar.png","logo": "http:\/\/localhost:1313\/images\/avatar.png"},"author": {
        "@type": "Person",
        "name": "Bui Van Y"
      },"description": "Security Vulnerability in WordPress Everest Forms Plugin."
  }
  </script><script src="/js/head/color-scheme.min.js"></script></head>
  <body data-instant-intensity="viewport" data-header-desktop="sticky" data-header-mobile="auto"><div class="wrapper" data-page-style="normal"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper">
    <div class="header-title">
      <a href="/" title="Bui Van Y"><img class="logo" src='/images/svg-spinners--wind-toy.svg' alt="Bui Van Y" height="32" width="32"><span class="header-title-text">Bui Van Y</span></a><span class="typeit header-subtitle"><template>w41bu1</template></span></div>
    <nav>
      <ul class="menu"><li class="menu-item">
              <a class="menu-link" href="/posts/"><i class="fa-solid fa-pencil fa-beat fa-fw fa-sm" aria-hidden="true"></i> Posts</a></li><li class="menu-item">
              <a class="menu-link" href="/categories/"><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden="true"></i> Categories</a></li><li class="menu-item">
              <a class="menu-link" href="/tags/"><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> Tags</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id="search-desktop">
            <input type="text" placeholder="Search titles or contents ..." id="search-input-desktop">
            <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
              <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
            </a>
            <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
              <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
            </a>
            <span class="search-button search-loading" id="search-loading-desktop">
              <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
            </span>
          </li><li class="menu-item theme-switch" role="button" aria-label="Switch Theme" title="Switch Theme"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></li><li class="menu-item language-switch">
            <span role="button" aria-label="Select Language" title="Select Language"><i class="fa-solid fa-language fa-fw" aria-hidden="true"></i></span>
            <ul class="sub-menu"><li class="menu-item"><span class="text-secondary" title="English">English</span></li><li class="menu-item"><a href="/vi/posts/2025-11-09-cve-2025-1128/" class="menu-link" title="Vietnamese">Vietnamese</a></li></ul>
          </li></ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/" title="Bui Van Y"><img class="logo" src='/images/svg-spinners--wind-toy.svg' alt="Bui Van Y" height="26" width="26"><span class="header-title-text">Bui Van Y</span></a><span class="typeit header-subtitle"><template>w41bu1</template></span></div>
      <div class="theme-switch" role="button" aria-label="Switch Theme"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></div>
      <div class="menu-toggle" id="menu-toggle-mobile" role="button" aria-labelledby="menu-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li class="search-wrapper">
            <div class="search mobile" id="search-mobile">
              <input type="text" placeholder="Search titles or contents ..." id="search-input-mobile">
              <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
              </a>
              <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
              </a>
              <span class="search-button search-loading" id="search-loading-mobile">
                <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
              </span>
            </div>
            <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
              Cancel
            </a>
          </li><li class="menu-item"><a class="menu-link" href="/posts/"><i class="fa-solid fa-pencil fa-beat fa-fw fa-sm" aria-hidden="true"></i> Posts</a></li><li class="menu-item"><a class="menu-link" href="/categories/"><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden="true"></i> Categories</a></li><li class="menu-item"><a class="menu-link" href="/tags/"><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> Tags</a></li><li class="menu-item menu-system"><span class="menu-system-item language-switch">
              <span role="button" aria-label="Select Language" title="Select Language">English<i class="dropdown-icon fa-solid fa-chevron-down" aria-hidden="true"></i></span>
              <select id="language-select" class="language-select" onchange="location = this.value;"><option value="/posts/2025-11-09-cve-2025-1128/" selected disabled>English</option><option value="/vi/posts/2025-11-09-cve-2025-1128/">Vietnamese</option></select>
            </span></li>
      </ul>
    </nav>
  </div>
</header><div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
  </div>
  <div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
  </div><main class="fi-container"><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label="Collections"><div class="details related-details open">
      <div class="details-summary related-summary">
        <i class="fa-solid fa-fire fa-fade text-danger fa-fw" aria-hidden="true"></i>
        <span class="related-title">Related Content</span><i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></div>
      <div class="details-content related-content">
        <ul class="related-list"><li class="related-item">
              <a href="/posts/2025-11-12-cve-2025-32202/" title="CVE-2025-32202 Analysis &amp; POC">CVE-2025-32202 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/posts/2025-11-11-cve-2025-47637/" title="CVE-2025-47637 Analysis &amp; POC">CVE-2025-47637 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/posts/2025-11-10-cve-2023-48777/" title="CVE-2023-48777 Analysis &amp; POC">CVE-2023-48777 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/posts/2025-11-13-cve-2025-7847/" title="CVE-2025-7847 Analysis &amp; POC">CVE-2025-7847 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/posts/2025-11-08-cve-2025-39557/" title="CVE-2025-39557 Analysis &amp; POC">CVE-2025-39557 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/posts/2025-11-07-cve-2025-47577/" title="CVE-2025-47577 Analysis &amp; POC">CVE-2025-47577 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/posts/2025-11-06-cve-2025-10647/" title="CVE-2025-10647 Analysis &amp; POC">CVE-2025-10647 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/posts/2025-11-05-cve-2025-10147/" title="CVE-2025-10147 Analysis &amp; POC">CVE-2025-10147 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/posts/2025-11-22-cve-2025-9501/" title="CVE-2025-9501 Analysis &amp; POC">CVE-2025-9501 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/posts/2025-11-21-cve-2025-2939/" title="CVE-2025-2939 Analysis &amp; POC">CVE-2025-2939 Analysis &amp; POC</a></li></ul>
      </div>
    </div></aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX"><span>CVE-2025-1128 Analysis &amp; POC</span>
      </h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><a href="github.com/w41bu1" title="Author" rel=" author" class="author"><img class="avatar" src='/images/avatar.png' alt="Bui Van Y" height="16" width="16">&nbsp;Bui Van Y</a></span><span class="post-included-in">&nbsp;included in <a href="/categories/cve-analyst/" class="post-category" title="Category - CVE Analyst"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> CVE Analyst</a></span></div><div class="post-meta-line"><span title="published on 2025-11-09 19:00:00"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden="true"></i><time datetime="2025-11-09">2025-11-09</time></span>&nbsp;<span title="Updated on 2025-11-03 18:25:14"><i class="fa-regular fa-calendar-check fa-fw me-1" aria-hidden="true"></i><time datetime="2025-11-03">2025-11-03</time></span>&nbsp;<span title="1994 words"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden="true"></i>About 2000 words</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden="true"></i>10 minutes</span>&nbsp;</div>
    </div><div class="featured-image"><img src='/posts/2025-11-09-cve-2025-1128/app.png' alt="/posts/2025-11-09-cve-2025-1128/app.png"></div><div class="details toc" id="toc-static" data-kept="false">
        <div class="details-summary toc-title">
          <span>Contents</span>
          <span><i class="details-icon fa-solid fa-angle-right" aria-hidden="true"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#cve--basic-info">CVE &amp; Basic Info</a></li>
    <li><a href="#requirements">Requirements</a></li>
    <li><a href="#cause">Cause</a></li>
    <li><a href="#code-analysis">Code Analysis</a></li>
    <li><a href="#flow">Flow</a></li>
    <li><a href="#proof-of-concept-poc">Proof of Concept (PoC)</a></li>
    <li><a href="#conclusion">Conclusion</a></li>
    <li><a href="#key-takeaway">Key Takeaway</a></li>
    <li><a href="#references">References</a></li>
  </ul>
</nav></div>
      </div><div class="content" id="content"><h2 class="heading-element" id="cve--basic-info"><span>CVE &amp; Basic Info</span>
  <a href="#cve--basic-info" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>The <strong>Everest Forms – Contact Forms, Quiz, Survey, Newsletter &amp; Payment Form Builder</strong> plugin for <strong>WordPress</strong> is vulnerable to <strong>arbitrary file upload, read, and deletion</strong> due to missing <strong>file type</strong> and <strong>path validation</strong> in the <code>format</code> method of the <code>EVF_Form_Fields_Upload</code> class in all versions up to and including <strong>3.0.9.4</strong>. This allows <strong>unauthenticated attackers</strong> to <strong>upload, read, and delete arbitrary files</strong> on the affected site’s server, potentially leading to <strong>remote code execution</strong>, <strong>sensitive information disclosure</strong>, or <strong>site takeover</strong>.</p>
<ul>
<li><strong>CVE ID</strong>: <a href="https://www.cve.org/CVERecord?id=CVE-2025-1128"target="_blank" rel="external nofollow noopener noreferrer">CVE-2025-1128</a></li>
<li><strong>Vulnerability Type</strong>: Arbitrary File Upload</li>
<li><strong>Affected Versions</strong>: &lt;= 3.0.9.4</li>
<li><strong>Patched Versions</strong>: 3.0.9.5</li>
<li><strong>CVSS severity</strong>: High (9.8)</li>
<li><strong>Required Privilege</strong>: Unauthenticated</li>
<li><strong>Product</strong>: <a href="https://wordpress.org/plugins/everest-forms/"target="_blank" rel="external nofollow noopener noreferrer">WordPress Everest Forms Plugin</a></li>
</ul>
<h2 class="heading-element" id="requirements"><span>Requirements</span>
  <a href="#requirements" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><ul>
<li>
<p><strong>Local WordPress &amp; Debugging</strong></p>
<ul>
<li><a href="https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/"target="_blank" rel="external nofollow noopener noreferrer">Virtual Machine</a></li>
<li><a href="https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/"target="_blank" rel="external nofollow noopener noreferrer">Docker</a></li>
</ul>
</li>
<li>
<p><strong>Plugin Version</strong> - <strong>Everest Forms</strong>:</p>
<ul>
<li><code>3.0.9.4</code> – <strong>vulnerable</strong></li>
<li><code>3.0.9.5</code> – <strong>patched</strong></li>
</ul>
</li>
<li>
<p><strong>Diff Tool (diff)</strong> → <a href="https://meldmerge.org/"target="_blank" rel="external nofollow noopener noreferrer"><strong>Meld</strong></a> or any diff tool of your choice.</p>
</li>
</ul>
<h2 class="heading-element" id="cause"><span>Cause</span>
  <a href="#cause" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>This vulnerability is caused by insufficient validation of file types and file paths in the <code>format</code> method of the <code>EVF_Form_Fields_Upload</code> class. Even when a file is of an invalid type, the upload flow can continue; by modifying parts of the submitted data/communication, server-side validation can be bypassed.</p>
<div class="highlight" title="class-evf-form-fields-upload.php - v3.0.9.4" data-open="true"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="hl"><span class="lnt"> 3
</span></span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="hl"><span class="lnt"> 7
</span></span><span class="hl"><span class="lnt"> 8
</span></span><span class="hl"><span class="lnt"> 9
</span></span><span class="hl"><span class="lnt">10
</span></span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">public</span> <span class="k">function</span> <span class="nf">format</span><span class="p">(</span> <span class="nv">$field_id</span><span class="p">,</span> <span class="nv">$field_submit</span><span class="p">,</span> <span class="nv">$form_data</span><span class="p">,</span> <span class="nv">$meta_key</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span><span class="line hl"><span class="cl">    <span class="nv">$wp_filetype</span> <span class="o">=</span> <span class="nx">wp_check_filetype_and_ext</span><span class="p">(</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;tmp_path&#39;</span><span class="p">],</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$ext</span>             <span class="o">=</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$wp_filetype</span><span class="p">[</span><span class="s1">&#39;ext&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;&#39;</span> <span class="o">:</span> <span class="nv">$wp_filetype</span><span class="p">[</span><span class="s1">&#39;ext&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$type</span>            <span class="o">=</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$wp_filetype</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;&#39;</span> <span class="o">:</span> <span class="nv">$wp_filetype</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$proper_filename</span> <span class="o">=</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$wp_filetype</span><span class="p">[</span><span class="s1">&#39;proper_filename&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;&#39;</span> <span class="o">:</span> <span class="nv">$wp_filetype</span><span class="p">[</span><span class="s1">&#39;proper_filename&#39;</span><span class="p">];</span>
</span></span><span class="line hl"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="nv">$proper_filename</span> <span class="o">||</span> <span class="o">!</span> <span class="nv">$ext</span> <span class="o">||</span> <span class="o">!</span> <span class="nv">$type</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">        <span class="nx">evf</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">task</span><span class="o">-&gt;</span><span class="na">errors</span><span class="p">[</span> <span class="nv">$form_data</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="p">][</span> <span class="nv">$field_id</span> <span class="p">]</span> <span class="o">=</span> <span class="nx">esc_html__</span><span class="p">(</span> <span class="s1">&#39;File type is not allowed.&#39;</span><span class="p">,</span> <span class="s1">&#39;everest-forms&#39;</span> <span class="p">);</span>
</span></span><span class="line hl"><span class="cl">        <span class="nx">update_option</span><span class="p">(</span> <span class="s1">&#39;evf_validation_error&#39;</span><span class="p">,</span> <span class="s1">&#39;yes&#39;</span> <span class="p">);</span>
</span></span><span class="line hl"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// upload file handler
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>The <code>wp_check_filetype_and_ext()</code> function will return empty values for <code>$ext</code> and <code>$type</code> if the uploaded file is invalid (not in WordPress’s whitelist of allowed types: <a href="https://developer.wordpress.org/reference/functions/wp_get_mime_types/"target="_blank" rel="external nofollow noopener noreferrer">https://developer.wordpress.org/reference/functions/wp_get_mime_types/</a>).</p>
<p>After lines 8-9 run, there is no mechanism to stop execution, so the upload logic continues.</p>
<p>The patch fixes this by calling <a href="https://developer.wordpress.org/reference/functions/wp_die/"target="_blank" rel="external nofollow noopener noreferrer">wp_die()</a>:</p>
<div class="highlight" title="class-evf-form-fields-upload.php - v3.0.9.5" data-open="true"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="hl"><span class="lnt">10
</span></span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">public</span> <span class="k">function</span> <span class="nf">format</span><span class="p">(</span> <span class="nv">$field_id</span><span class="p">,</span> <span class="nv">$field_submit</span><span class="p">,</span> <span class="nv">$form_data</span><span class="p">,</span> <span class="nv">$meta_key</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$wp_filetype</span> <span class="o">=</span> <span class="nx">wp_check_filetype_and_ext</span><span class="p">(</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;tmp_path&#39;</span><span class="p">],</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$ext</span>             <span class="o">=</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$wp_filetype</span><span class="p">[</span><span class="s1">&#39;ext&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;&#39;</span> <span class="o">:</span> <span class="nv">$wp_filetype</span><span class="p">[</span><span class="s1">&#39;ext&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$type</span>            <span class="o">=</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$wp_filetype</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;&#39;</span> <span class="o">:</span> <span class="nv">$wp_filetype</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$proper_filename</span> <span class="o">=</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$wp_filetype</span><span class="p">[</span><span class="s1">&#39;proper_filename&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;&#39;</span> <span class="o">:</span> <span class="nv">$wp_filetype</span><span class="p">[</span><span class="s1">&#39;proper_filename&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="nv">$proper_filename</span> <span class="o">||</span> <span class="o">!</span> <span class="nv">$ext</span> <span class="o">||</span> <span class="o">!</span> <span class="nv">$type</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">evf</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">task</span><span class="o">-&gt;</span><span class="na">errors</span><span class="p">[</span> <span class="nv">$form_data</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="p">][</span> <span class="nv">$field_id</span> <span class="p">]</span> <span class="o">=</span> <span class="nx">esc_html__</span><span class="p">(</span> <span class="s1">&#39;File type is not allowed.&#39;</span><span class="p">,</span> <span class="s1">&#39;everest-forms&#39;</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nx">update_option</span><span class="p">(</span> <span class="s1">&#39;evf_validation_error&#39;</span><span class="p">,</span> <span class="s1">&#39;yes&#39;</span> <span class="p">);</span>
</span></span><span class="line hl"><span class="cl">        <span class="nx">wp_die</span><span class="p">(</span> <span class="s1">&#39;File type is not allowed&#39;</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// upload file handler
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 class="heading-element" id="code-analysis"><span>Code Analysis</span>
  <a href="#code-analysis" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><div class="highlight" title="class-evf-form-fields-upload.php - v3.0.9.4" data-open="true"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="hl"><span class="lnt"> 6
</span></span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">public</span> <span class="k">function</span> <span class="nf">format</span><span class="p">(</span> <span class="nv">$field_id</span><span class="p">,</span> <span class="nv">$field_submit</span><span class="p">,</span> <span class="nv">$form_data</span><span class="p">,</span> <span class="nv">$meta_key</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// Setup class properties to reuse everywhere.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">form_data</span>  <span class="o">=</span> <span class="p">(</span><span class="k">array</span><span class="p">)</span> <span class="nv">$form_data</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">form_id</span>    <span class="o">=</span> <span class="nx">absint</span><span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">form_data</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">field_id</span>   <span class="o">=</span> <span class="nv">$field_id</span><span class="p">;</span>
</span></span><span class="line hl"><span class="cl">    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">field_data</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">form_data</span><span class="p">[</span><span class="s1">&#39;form_fields&#39;</span><span class="p">][</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">field_id</span> <span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nv">$field_label</span> <span class="o">=</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">form_data</span><span class="p">[</span><span class="s1">&#39;form_fields&#39;</span><span class="p">][</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">field_id</span> <span class="p">][</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">form_data</span><span class="p">[</span><span class="s1">&#39;form_fields&#39;</span><span class="p">][</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">field_id</span> <span class="p">][</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$input_name</span>  <span class="o">=</span> <span class="nx">sprintf</span><span class="p">(</span> <span class="s1">&#39;everest_forms_%d_%s&#39;</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">form_id</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">field_id</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// Make sure json_decode() doesn&#39;t fail on newer PHP.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$raw_files</span> <span class="o">=</span> <span class="nx">json_decode</span><span class="p">(</span> <span class="nx">wp_unslash</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span> <span class="nv">$input_name</span> <span class="p">]</span> <span class="p">),</span> <span class="k">true</span> <span class="p">);</span> <span class="c1">// phpcs:ignore WordPress.Security
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span> <span class="nx">Exception</span> <span class="nv">$e</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">evf</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">task</span><span class="o">-&gt;</span><span class="na">form_fields</span><span class="p">[</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">field_id</span> <span class="p">]</span> <span class="o">=</span> <span class="nv">$processed</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Make sure we process only submitted files with the expected structure and keys.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nv">$files</span> <span class="o">=</span> <span class="nx">array_filter</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$raw_files</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="k">static</span> <span class="k">function</span> <span class="p">(</span> <span class="nv">$file</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="p">(</span> <span class="nx">is_array</span><span class="p">(</span> <span class="nv">$file</span> <span class="p">)</span> <span class="o">||</span> <span class="nx">is_object</span><span class="p">(</span> <span class="nv">$file</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">count</span><span class="p">(</span> <span class="nv">$file</span> <span class="p">)</span> <span class="o">===</span> <span class="mi">2</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$files</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">evf</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">task</span><span class="o">-&gt;</span><span class="na">form_fields</span><span class="p">[</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">field_id</span> <span class="p">]</span> <span class="o">=</span> <span class="nv">$processed</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nv">$data</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">foreach</span> <span class="p">(</span> <span class="nv">$files</span> <span class="k">as</span> <span class="nv">$file</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$file</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">generate_file_info</span><span class="p">(</span> <span class="nv">$file</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nv">$wp_filetype</span> <span class="o">=</span> <span class="nx">wp_check_filetype_and_ext</span><span class="p">(</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;tmp_path&#39;</span><span class="p">],</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nv">$ext</span>             <span class="o">=</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$wp_filetype</span><span class="p">[</span><span class="s1">&#39;ext&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;&#39;</span> <span class="o">:</span> <span class="nv">$wp_filetype</span><span class="p">[</span><span class="s1">&#39;ext&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$type</span>            <span class="o">=</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$wp_filetype</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;&#39;</span> <span class="o">:</span> <span class="nv">$wp_filetype</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$proper_filename</span> <span class="o">=</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$wp_filetype</span><span class="p">[</span><span class="s1">&#39;proper_filename&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;&#39;</span> <span class="o">:</span> <span class="nv">$wp_filetype</span><span class="p">[</span><span class="s1">&#39;proper_filename&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span> <span class="nv">$proper_filename</span> <span class="o">||</span> <span class="o">!</span> <span class="nv">$ext</span> <span class="o">||</span> <span class="o">!</span> <span class="nv">$type</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">evf</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">task</span><span class="o">-&gt;</span><span class="na">errors</span><span class="p">[</span> <span class="nv">$form_data</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="p">][</span> <span class="nv">$field_id</span> <span class="p">]</span> <span class="o">=</span> <span class="nx">esc_html__</span><span class="p">(</span> <span class="s1">&#39;File type is not allowed.&#39;</span><span class="p">,</span> <span class="s1">&#39;everest-forms&#39;</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="nx">update_option</span><span class="p">(</span> <span class="s1">&#39;evf_validation_error&#39;</span><span class="p">,</span> <span class="s1">&#39;yes&#39;</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// Allow third-party integrations.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">if</span> <span class="p">(</span> <span class="nx">has_filter</span><span class="p">(</span> <span class="s1">&#39;everest_forms_integration_uploads&#39;</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$file</span> <span class="o">=</span> <span class="nx">apply_filters</span><span class="p">(</span> <span class="s1">&#39;everest_forms_integration_uploads&#39;</span><span class="p">,</span> <span class="nv">$file</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">form_data</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">is_media_integrated</span><span class="p">()</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;tmp_path&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="nv">$file</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">generate_file_attachment</span><span class="p">(</span> <span class="nv">$file</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">elseif</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">                <span class="o">!</span> <span class="nx">isset</span><span class="p">(</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;external&#39;</span><span class="p">]</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="o">&amp;&amp;</span> <span class="nx">file_exists</span><span class="p">(</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;tmp_path&#39;</span><span class="p">]</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">create_dir</span><span class="p">(</span> <span class="nx">dirname</span><span class="p">(</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="o">@</span><span class="nx">rename</span><span class="p">(</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;tmp_path&#39;</span><span class="p">]</span> <span class="p">,</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">]</span> <span class="p">);</span> <span class="c1">// phpcs:ignore WordPress.PHP.NoSilencedErrors.Discouraged
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">set_file_fs_permissions</span><span class="p">(</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">]</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nv">$data</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">generate_file_data</span><span class="p">(</span> <span class="nv">$file</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>This plugin is intended to create form templates and use them in posts/pages. Because the vulnerability concerns <strong>file upload</strong>, we create a form with a <strong>File Upload</strong> field and embed it into a post.</p>
<p><figure><a class="lightgallery" href="/posts/2025-11-09-cve-2025-1128/create_form.png" title="Create a form with a **File Upload** field" data-thumbnail="/posts/2025-11-09-cve-2025-1128/create_form.png" data-sub-html="<h2>Create Form</h2><p>Create a form with a **File Upload** field</p>"><img loading="lazy" src='/posts/2025-11-09-cve-2025-1128/create_form.png' alt="Create Form" height="552" width="1302"></a><figcaption class="image-caption">Create a form with a **File Upload** field</figcaption>
  </figure></p>
<p>Upload any file and intercept it with BurpSuite (uploads are allowed for anonymous users when accessing the post/page that contains the form).</p>
<p><figure><a class="lightgallery" href="/posts/2025-11-09-cve-2025-1128/snap_request.png" title="Intercept file upload request with BurpSuite" data-thumbnail="/posts/2025-11-09-cve-2025-1128/snap_request.png" data-sub-html="<h2>Snap Request</h2><p>Intercept file upload request with BurpSuite</p>"><img loading="lazy" src='/posts/2025-11-09-cve-2025-1128/snap_request.png' alt="Snap Request" height="793" width="794"></a><figcaption class="image-caption">Intercept file upload request with BurpSuite</figcaption>
  </figure></p>
<p>Set a breakpoint at the <code>format()</code> method and observe.</p>
<p><figure><a class="lightgallery" href="/posts/2025-11-09-cve-2025-1128/input_name.png" title="$input_name in debugger" data-thumbnail="/posts/2025-11-09-cve-2025-1128/input_name.png" data-sub-html="<h2>Input Name</h2><p>$input_name in debugger</p>"><img loading="lazy" src='/posts/2025-11-09-cve-2025-1128/input_name.png' alt="Input Name" height="403" width="1090"></a><figcaption class="image-caption">$input_name in debugger</figcaption>
  </figure></p>
<p>From debugging, <code>$input_name</code> maps to the array containing JSON data fields <code>file</code> and <code>name</code>.</p>
<p>The data is JSON-decoded and assigned to <code>$raw_files</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$raw_files</span> <span class="o">=</span> <span class="nx">json_decode</span><span class="p">(</span> <span class="nx">wp_unslash</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span> <span class="nv">$input_name</span> <span class="p">]</span> <span class="p">),</span> <span class="k">true</span> <span class="p">);</span> <span class="c1">// phpcs:ignore WordPress.Security
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span> <span class="k">catch</span> <span class="p">(</span> <span class="nx">Exception</span> <span class="nv">$e</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">evf</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">task</span><span class="o">-&gt;</span><span class="na">form_fields</span><span class="p">[</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">field_id</span> <span class="p">]</span> <span class="o">=</span> <span class="nv">$processed</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p><figure><a class="lightgallery" href="/posts/2025-11-09-cve-2025-1128/raw_files.png" title="$raw_files in debugger" data-thumbnail="/posts/2025-11-09-cve-2025-1128/raw_files.png" data-sub-html="<h2>Raw Files</h2><p>$raw_files in debugger</p>"><img loading="lazy" src='/posts/2025-11-09-cve-2025-1128/raw_files.png' alt="Raw Files" height="372" width="1224"></a><figcaption class="image-caption">$raw_files in debugger</figcaption>
  </figure></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$files</span> <span class="o">=</span> <span class="nx">array_filter</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$raw_files</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="k">static</span> <span class="k">function</span> <span class="p">(</span> <span class="nv">$file</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">(</span> <span class="nx">is_array</span><span class="p">(</span> <span class="nv">$file</span> <span class="p">)</span> <span class="o">||</span> <span class="nx">is_object</span><span class="p">(</span> <span class="nv">$file</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">count</span><span class="p">(</span> <span class="nv">$file</span> <span class="p">)</span> <span class="o">===</span> <span class="mi">2</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">);</span></span></span></code></pre></td></tr></table>
</div>
</div><p>This filter returns the data assigned to <code>$files</code>, ensuring only submitted files with the expected structure and keys are processed; otherwise it returns empty.</p>
<p><figure><a class="lightgallery" href="/posts/2025-11-09-cve-2025-1128/files.png" title="$files in debugger" data-thumbnail="/posts/2025-11-09-cve-2025-1128/files.png" data-sub-html="<h2>Files</h2><p>$files in debugger</p>"><img loading="lazy" src='/posts/2025-11-09-cve-2025-1128/files.png' alt="Files" height="365" width="657"></a><figcaption class="image-caption">$files in debugger</figcaption>
  </figure></p>
<p>Iterating the <code>$files</code> array, the plugin calls <code>generate_file_info()</code> to create temporary information for each file, then checks the file type using <code>wp_check_filetype_and_ext()</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">foreach</span> <span class="p">(</span> <span class="nv">$files</span> <span class="k">as</span> <span class="nv">$file</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$file</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">generate_file_info</span><span class="p">(</span> <span class="nv">$file</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$wp_filetype</span> <span class="o">=</span> <span class="nx">wp_check_filetype_and_ext</span><span class="p">(</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;tmp_path&#39;</span><span class="p">],</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight" title="class-evf-form-fields-upload.php - v3.0.9.4" data-open="true"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="hl"><span class="lnt">13
</span></span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">protected</span> <span class="k">function</span> <span class="nf">generate_file_info</span><span class="p">(</span> <span class="nv">$file</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$dir</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">get_form_files_dir</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;tmp_path&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">trailingslashit</span><span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">get_tmp_dir</span><span class="p">()</span> <span class="p">)</span> <span class="o">.</span> <span class="nx">sanitize_file_name</span><span class="p">(</span><span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span>     <span class="o">=</span> <span class="s1">&#39;application/octet-stream&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="nx">is_file</span><span class="p">(</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;tmp_path&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$filetype</span>     <span class="o">=</span> <span class="nx">wp_check_filetype</span><span class="p">(</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;tmp_path&#39;</span><span class="p">]</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$filetype</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Data for no media case.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nv">$file_ext</span>              <span class="o">=</span> <span class="nx">pathinfo</span><span class="p">(</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="nx">PATHINFO_EXTENSION</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$file_base</span>             <span class="o">=</span> <span class="nx">wp_basename</span><span class="p">(</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="s2">&#34;.</span><span class="si">$file_ext</span><span class="s2">&#34;</span> <span class="p">);</span>
</span></span><span class="line hl"><span class="cl">    <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;file_name_new&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">sprintf</span><span class="p">(</span> <span class="s1">&#39;%s-%s.%s&#39;</span><span class="p">,</span> <span class="nv">$file_base</span><span class="p">,</span> <span class="nx">wp_hash</span><span class="p">(</span> <span class="nv">$dir</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">form_data</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">field_id</span> <span class="p">),</span> <span class="nx">strtolower</span><span class="p">(</span> <span class="nv">$file_ext</span> <span class="p">)</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;file_name_new&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">wp_unique_filename</span><span class="p">(</span> <span class="nx">trailingslashit</span><span class="p">(</span> <span class="nv">$dir</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">]</span> <span class="p">),</span> <span class="nx">sanitize_file_name</span><span class="p">(</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;file_name_new&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;file_url&#39;</span><span class="p">]</span>      <span class="o">=</span> <span class="nx">trailingslashit</span><span class="p">(</span> <span class="nv">$dir</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">.</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;file_name_new&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">]</span>          <span class="o">=</span> <span class="nx">trailingslashit</span><span class="p">(</span> <span class="nv">$dir</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">.</span> <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;file_name_new&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$file</span><span class="p">[</span><span class="s1">&#39;attachment_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nv">$file</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Note that the function uses <code>wp_hash()</code> to generate <code>$file['file_name_new']</code> and then concatenates it into <code>$dir['path']</code> to set <code>$file['path']</code>; this value is created using a salt configured in <code>wp-config.php</code> — so we only know that a salt exists.</p>
<div class="details admonition info open disabled">
  <div class="details-summary admonition-title"><i class="icon fa-fw fa-solid fa-circle-info" aria-hidden="true"></i>Info</div>
  <div class="details-content">
    <div class="admonition-content"><p><code>$file_ext</code> is concatenated at the end of <code>file['path']</code>, and we can control it through the <code>name</code> field supplied in the request.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-diff" data-lang="diff"><span class="line"><span class="cl"><span class="gd">- _690888869ea291.55135482.txt
</span></span></span><span class="line"><span class="cl"><span class="gd"></span><span class="gi">+ _690888869ea291.55135482.php
</span></span></span></code></pre></td></tr></table>
</div>
</div></div>
  </div>
</div><p><figure><a class="lightgallery" href="/posts/2025-11-09-cve-2025-1128/file.png" title="$file in debugger" data-thumbnail="/posts/2025-11-09-cve-2025-1128/file.png" data-sub-html="<h2>File</h2><p>$file in debugger</p>"><img loading="lazy" src='/posts/2025-11-09-cve-2025-1128/file.png' alt="File" height="709" width="1862"></a><figcaption class="image-caption">$file in debugger</figcaption>
  </figure></p>
<p>Here we only need to pay attention to three fields: <code>tmp_path</code>, <code>name</code>, <code>path</code>.</p>
<ul>
<li><code>tmp_path</code> and <code>name</code> are passed as arguments to <code>wp_check_filetype_and_ext()</code>.</li>
<li><code>tmp_path</code> and <code>path</code> are used as arguments to <code>rename()</code>.</li>
</ul>
<p>As analyzed earlier, the logic continues running even when the uploaded file is not allowed. <code>rename($file['tmp_path'], $file['path'])</code> is called to move the file from the temporary path to the final path.</p>
<hr>
<p>The <code>format()</code> method is registered as a callback for an action hook:</p>
<div class="highlight" title="class-evf-form-fields.php - v3.0.9.4"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">add_action</span><span class="p">(</span> <span class="s1">&#39;everest_forms_process_format_&#39;</span> <span class="o">.</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">type</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span> <span class="nv">$this</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span> <span class="p">),</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">4</span> <span class="p">);</span></span></span></code></pre></td></tr></table>
</div>
</div><p>When the type is <code>file-upload</code>.</p>
<p><figure><a class="lightgallery" href="/posts/2025-11-09-cve-2025-1128/type.png" title="Type required to call format" data-thumbnail="/posts/2025-11-09-cve-2025-1128/type.png" data-sub-html="<h2>Type</h2><p>Type required to call format</p>"><img loading="lazy" src='/posts/2025-11-09-cve-2025-1128/type.png' alt="Type" height="415" width="1729"></a><figcaption class="image-caption">Type required to call format</figcaption>
  </figure></p>
<p>Searching for the keyword <code>everest_forms_process_format_</code>:</p>
<p><figure><a class="lightgallery" href="/posts/2025-11-09-cve-2025-1128/action.png" title="Hook everest_forms_process_format_file-upload is invoked" data-thumbnail="/posts/2025-11-09-cve-2025-1128/action.png" data-sub-html="<h2>Action</h2><p>Hook everest_forms_process_format_file-upload is invoked</p>"><img loading="lazy" src='/posts/2025-11-09-cve-2025-1128/action.png' alt="Action" height="351" width="1771"></a><figcaption class="image-caption">Hook everest_forms_process_format_file-upload is invoked</figcaption>
  </figure></p>
<p>This hook is called in <code>do_task()</code> via <code>do_action()</code> with the dynamic <code>$field_type</code> argument:</p>
<div class="highlight" title="class-evf-form-task.php - v3.0.9.4"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">public</span> <span class="k">function</span> <span class="nf">listen_task</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;everest_forms&#39;</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span> <span class="c1">// phpcs:ignore WordPress.Security.NonceVerification
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">do_task</span><span class="p">(</span> <span class="nx">evf_sanitize_entry</span><span class="p">(</span> <span class="nx">wp_unslash</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;everest_forms&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">);</span> <span class="c1">// phpcs:ignore WordPress.Security.NonceVerification, WordPress.Security.ValidatedSanitizedInput.InputNotSanitized
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p><code>do_task()</code> is called from <code>listen_task()</code> when an Everest Forms <code>id</code> is provided in the POST request.</p>
<p><code>listen_task()</code> is registered as a callback for the <code>wp</code> action hook:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">add_action</span><span class="p">(</span> <span class="s1">&#39;wp&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span> <span class="nv">$this</span><span class="p">,</span> <span class="s1">&#39;listen_task&#39;</span> <span class="p">)</span> <span class="p">);</span></span></span></code></pre></td></tr></table>
</div>
</div><p>This hook runs on every request.</p>
<h2 class="heading-element" id="flow"><span>Flow</span>
  <a href="#flow" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><div class="diagram-container">
  <pre class="mermaid">
graph TD
A["User submits form (file)"] --> B["Browser sends POST to page with form"]
B --> C["WP hook triggered - listen_task()"]
C --> D["do_task() calls do_action() with field type"]
D --> E["everest_forms_process_format_file-upload calls format()"]
E --> F["generate_file_info() creates tmp_path, name, path"]
E --> G["wp_check_filetype_and_ext(tmp_path, name)"]
G --> H{"File type check result"}
H -->|Valid| I["rename(tmp_path → path) moves file to uploads"]
H -->|Invalid| J["Set error but continue execution"]
J --> I
I --> K["File accessible in uploads → potential executable upload"]
</pre>
  <pre class="mermaid-dark">
graph TD
A["User submits form (file)"] --> B["Browser sends POST to page with form"]
B --> C["WP hook triggered - listen_task()"]
C --> D["do_task() calls do_action() with field type"]
D --> E["everest_forms_process_format_file-upload calls format()"]
E --> F["generate_file_info() creates tmp_path, name, path"]
E --> G["wp_check_filetype_and_ext(tmp_path, name)"]
G --> H{"File type check result"}
H -->|Valid| I["rename(tmp_path → path) moves file to uploads"]
H -->|Invalid| J["Set error but continue execution"]
J --> I
I --> K["File accessible in uploads → potential executable upload"]
</pre>
  <pre class="mermaid-neutral">
graph TD
A["User submits form (file)"] --> B["Browser sends POST to page with form"]
B --> C["WP hook triggered - listen_task()"]
C --> D["do_task() calls do_action() with field type"]
D --> E["everest_forms_process_format_file-upload calls format()"]
E --> F["generate_file_info() creates tmp_path, name, path"]
E --> G["wp_check_filetype_and_ext(tmp_path, name)"]
G --> H{"File type check result"}
H -->|Valid| I["rename(tmp_path → path) moves file to uploads"]
H -->|Invalid| J["Set error but continue execution"]
J --> I
I --> K["File accessible in uploads → potential executable upload"]
</pre><div class="diagram-copy-btn" aria-label="Copy Mermaid code" role="button"><i class="fa-regular fa-clone" aria-hidden="true"></i><i class="fa-solid fa-check text-success" aria-hidden="true"></i></div>
<template><pre>
graph TD
A["User submits form (file)"] --> B["Browser sends POST to page with form"]
B --> C["WP hook triggered - listen_task()"]
C --> D["do_task() calls do_action() with field type"]
D --> E["everest_forms_process_format_file-upload calls format()"]
E --> F["generate_file_info() creates tmp_path, name, path"]
E --> G["wp_check_filetype_and_ext(tmp_path, name)"]
G --> H{"File type check result"}
H -->|Valid| I["rename(tmp_path → path) moves file to uploads"]
H -->|Invalid| J["Set error but continue execution"]
J --> I
I --> K["File accessible in uploads → potential executable upload"]
</pre></template>
</div>
<h2 class="heading-element" id="proof-of-concept-poc"><span>Proof of Concept (PoC)</span>
  <a href="#proof-of-concept-poc" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><ol>
<li>Create a <code>.txt</code> file that contains PHP code:</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">TEXT
</span></span><span class="line"><span class="cl">&lt;?php phpinfo();?&gt;</span></span></code></pre></td></tr></table>
</div>
</div><ol start="2">
<li>Enable Burp Intercept and capture the file upload request.</li>
<li>Modify the <code>name</code> field in the intercepted request to use the <code>.php</code> extension and forward the request.</li>
</ol>
<p><figure><a class="lightgallery" href="/posts/2025-11-09-cve-2025-1128/fileuploaded.png" title="File uploaded successfully" data-thumbnail="/posts/2025-11-09-cve-2025-1128/fileuploaded.png" data-sub-html="<h2>File Uploaded</h2><p>File uploaded successfully</p>"><img loading="lazy" src='/posts/2025-11-09-cve-2025-1128/fileuploaded.png' alt="File Uploaded" height="351" width="1771"></a><figcaption class="image-caption">File uploaded successfully</figcaption>
  </figure></p>
<ol start="4">
<li>Access the uploaded file.</li>
</ol>
<p><figure><a class="lightgallery" href="/posts/2025-11-09-cve-2025-1128/result.png" title="phpinfo() from uploaded file" data-thumbnail="/posts/2025-11-09-cve-2025-1128/result.png" data-sub-html="<h2>Result</h2><p>phpinfo() from uploaded file</p>"><img loading="lazy" src='/posts/2025-11-09-cve-2025-1128/result.png' alt="Result" height="1113" width="1919"></a><figcaption class="image-caption">phpinfo() from uploaded file</figcaption>
  </figure></p>
<h2 class="heading-element" id="conclusion"><span>Conclusion</span>
  <a href="#conclusion" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>The vulnerability in <code>EVF_Form_Fields_Upload::format()</code> allows arbitrary file upload, read, and deletion due to improper file type and path validation. Although the plugin logs an error when encountering an invalid file, the execution flow does not halt and still calls <code>rename()</code> to move the file into a public directory — enabling the placement of executable code on the server (RCE), disclosure of sensitive data, or site takeover. The patch (&gt;= 3.0.9.5) fixes this by stopping execution when an invalid file is detected; unpatched sites remain at high risk.</p>
<h2 class="heading-element" id="key-takeaway"><span>Key Takeaway</span>
  <a href="#key-takeaway" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><ul>
<li>Insufficient validation of file types/extensions can lead to executable file uploads.</li>
<li>Detecting an invalid file but not stopping the execution flow allows attackers to bypass checks.</li>
<li>Validation is meaningless unless accompanied by a blocking action (stop/exit/wp_die) prior to filesystem operations.</li>
<li>Validate file content (MIME/content) in addition to name/extension provided by the client.</li>
<li>Prevent PHP execution in the <code>uploads</code> directory and use safe upload APIs (e.g., <code>wp_handle_upload()</code>).</li>
</ul>
<h2 class="heading-element" id="references"><span>References</span>
  <a href="#references" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p><a href="https://book.hacktricks.wiki/en/pentesting-web/file-upload/index.html"target="_blank" rel="external nofollow noopener noreferrer">Arbitrary File Upload</a></p>
<p><a href="https://patchstack.com/database/wordpress/plugin/everest-forms/vulnerability/wordpress-everest-forms-plugin-3-0-9-4-unauthenticated-arbitrary-file-upload-read-and-deletion-vulnerability"target="_blank" rel="external nofollow noopener noreferrer">WordPress Everest Forms Plugin &lt;= 3.0.9.4 is vulnerable to Arbitrary File Upload</a></p></div><hr class="awesome-hr" />
    <h2 id="see-also">Related Content</h2>
    <ul><li>
          <a href="/posts/2025-11-12-cve-2025-32202/" title="CVE-2025-32202 Analysis &amp; POC">CVE-2025-32202 Analysis &amp; POC</a></li><li>
          <a href="/posts/2025-11-11-cve-2025-47637/" title="CVE-2025-47637 Analysis &amp; POC">CVE-2025-47637 Analysis &amp; POC</a></li><li>
          <a href="/posts/2025-11-10-cve-2023-48777/" title="CVE-2023-48777 Analysis &amp; POC">CVE-2023-48777 Analysis &amp; POC</a></li><li>
          <a href="/posts/2025-11-13-cve-2025-7847/" title="CVE-2025-7847 Analysis &amp; POC">CVE-2025-7847 Analysis &amp; POC</a></li><li>
          <a href="/posts/2025-11-08-cve-2025-39557/" title="CVE-2025-39557 Analysis &amp; POC">CVE-2025-39557 Analysis &amp; POC</a></li><li>
          <a href="/posts/2025-11-07-cve-2025-47577/" title="CVE-2025-47577 Analysis &amp; POC">CVE-2025-47577 Analysis &amp; POC</a></li><li>
          <a href="/posts/2025-11-06-cve-2025-10647/" title="CVE-2025-10647 Analysis &amp; POC">CVE-2025-10647 Analysis &amp; POC</a></li><li>
          <a href="/posts/2025-11-05-cve-2025-10147/" title="CVE-2025-10147 Analysis &amp; POC">CVE-2025-10147 Analysis &amp; POC</a></li><li>
          <a href="/posts/2025-11-22-cve-2025-9501/" title="CVE-2025-9501 Analysis &amp; POC">CVE-2025-9501 Analysis &amp; POC</a></li><li>
          <a href="/posts/2025-11-21-cve-2025-2939/" title="CVE-2025-2939 Analysis &amp; POC">CVE-2025-2939 Analysis &amp; POC</a></li></ul><div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod"><span title="Updated on 2025-11-03 18:25:14">Updated on 2025-11-03&nbsp;<a class="git-hash" href="https://github.com/w41bu1/w41bu1.github.io/commit/73a3fd59c3950ca0d503a675de1f2f3eb0657c6b" rel="external nofollow noopener noreferrer" target="_blank" title="Add post 2025-11-09-CVE-2025-1128&#10&#10Commit: 73a3fd59c3950ca0d503a675de1f2f3eb0657c6b [73a3fd5]&#10Author: w41bu1&#10Date: 2025-11-03 18:25:14"><i class="fa-solid fa-hashtag fa-fw" aria-hidden="true"></i>73a3fd5</a></span>
      </div><div class="post-info-license">
            <span><a rel="license external nofollow noopener noreferrer" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a></span>
          </div></div><div class="post-info-line">
        <div class="post-info-md"><span><a href="/posts/2025-11-09-cve-2025-1128/index.md" title="Read Markdown" class="link-to-markdown">Read Markdown</a></span><span><a href="https://github.com/w41bu1/w41bu1.github.io/blob/main/content/posts%5c2025-11-09-CVE-2025-1128%5cindex.en.md?plain=1" title="View source"target="_blank" rel="external nofollow noopener noreferrer" class="link-to-source">View source</a></span><span><a href="https://github.com/w41bu1/w41bu1.github.io/edit/main/content/posts%5c2025-11-09-CVE-2025-1128%5cindex.en.md" title="Edit this page"target="_blank" rel="external nofollow noopener noreferrer" class="link-to-edit">Edit this page</a></span><span><a href="https://github.com/w41bu1/w41bu1.github.io/issues/new?title=[BUG]%20CVE-2025-1128&#43;Analysis&#43;%26&#43;POC&amp;body=%7cField%7cValue%7c%0A%7c-%7c-%7c%0A%7cTitle%7cCVE-2025-1128&#43;Analysis&#43;%26&#43;POC%7c%0A%7cURL%7chttp://localhost:1313/posts/2025-11-09-cve-2025-1128/%7c%0A%7cFilename%7chttps://github.com/w41bu1/w41bu1.github.io/blob/main/content/posts%5c2025-11-09-CVE-2025-1128%5cindex.en.md?plain=1%7c" title="Report issue"target="_blank" rel="external nofollow noopener noreferrer" class="link-to-report">Report issue</a></span><span><a href="vscode://file/D:%5cwork%5cproject%5cw41bu1.github.io%5ccontent%5cposts%5c2025-11-09-CVE-2025-1128%5cindex.en.md" title="Open in editor"target="_blank" rel="external nofollow noopener noreferrer" class="link-to-vscode">Open in editor</a></span></div>
        <div class="post-info-share">
          <span><a href="javascript:void(0);" title="Share on X" data-sharer="twitter" data-url="http://localhost:1313/posts/2025-11-09-cve-2025-1128/" data-title="CVE-2025-1128 Analysis &amp; POC" data-hashtags="analyst,plugin,arbitrary file upload"><i class="fa-brands fa-x-twitter fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="http://localhost:1313/posts/2025-11-09-cve-2025-1128/" data-hashtag="analyst"><i class="fa-brands fa-facebook-square fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="Share on Linkedin" data-sharer="linkedin" data-url="http://localhost:1313/posts/2025-11-09-cve-2025-1128/"><i class="fa-brands fa-linkedin fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="Share on Hacker News" data-sharer="hackernews" data-url="http://localhost:1313/posts/2025-11-09-cve-2025-1128/" data-title="CVE-2025-1128 Analysis &amp; POC"><i class="fa-brands fa-hacker-news fa-fw" aria-hidden="true"></i></a>
  </span>
        </div>
      </div></div>

  <div class="post-info-more">
    <section class="post-tags"><i class="fa-solid fa-tags fa-fw me-1" aria-hidden="true"></i><a href="/tags/analyst/" class="post-tag" title="Tags - Analyst">Analyst</a><a href="/tags/plugin/" class="post-tag" title="Tags - Plugin">Plugin</a><a href="/tags/arbitrary-file-upload/" class="post-tag" title="Tags - Arbitrary File Upload">Arbitrary File Upload</a></section>
    <section><span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
    </section>
  </div><div class="post-nav"><a href="/posts/2025-11-08-cve-2025-39557/" class="post-nav-item" rel="prev" title="CVE-2025-39557 Analysis &amp; POC"><i class="fa-solid fa-angle-left fa-fw" aria-hidden="true"></i>CVE-2025-39557 Analysis &amp; POC</a><a href="/posts/2025-11-10-cve-2023-48777/" class="post-nav-item" rel="next" title="CVE-2023-48777 Analysis &amp; POC">CVE-2023-48777 Analysis &amp; POC<i class="fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article>

  <aside class="toc" id="toc-auto" aria-label="Contents"><h2 class="toc-title">Contents&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden="true"></i></h2>
      <div class="toc-content always-active" id="toc-content-auto"></div></aside><dialog id="toc-dialog" aria-labelledby="toc-dialog-title" role="dialog">
      <div class="toc">
        <h2 class="toc-title">Contents</h2>
        <div class="toc-content" id="toc-content-drawer"><nav >
  <ul>
    <li><a href="#cve--basic-info">CVE &amp; Basic Info</a></li>
    <li><a href="#requirements">Requirements</a></li>
    <li><a href="#cause">Cause</a></li>
    <li><a href="#code-analysis">Code Analysis</a></li>
    <li><a href="#flow">Flow</a></li>
    <li><a href="#proof-of-concept-poc">Proof of Concept (PoC)</a></li>
    <li><a href="#conclusion">Conclusion</a></li>
    <li><a href="#key-takeaway">Key Takeaway</a></li>
    <li><a href="#references">References</a></li>
  </ul>
</nav></div>
      </div>
    </dialog></main><footer class="footer">
    <div class="footer-container"><div class="footer-line copyright" itemscope itemtype="http://schema.org/CreativeWork"><i class="fa-regular fa-copyright fa-fw" aria-hidden="true"></i>
            <span itemprop="copyrightYear">2025</span><span class="author" itemprop="copyrightHolder">
              <a href="github.com/w41bu1">Bui Van Y</a></span><span class="license footer-divider">w41bu1</span></div><div class="footer-line statistics"></div><div class="footer-line visitor">
          <span id="busuanzi_container_site_uv" title='Total visitors'><i class="fa-regular fa-user fa-fw me-1" aria-hidden="true"></i><span id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span></span><span id="busuanzi_container_site_pv" class="footer-divider" title='Total visits'><i class="fa-regular fa-eye fa-fw me-1" aria-hidden="true"></i><span id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span></span>
        </div><div class="footer-line beian"><span class="gov"><i class="fa-solid fa-user-secret"></i></span><span class="icp footer-divider"><i class="fa-solid fa-bug"></i></span></div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons"><div class="fixed-button back-to-top animate__faster d-none" role="button" aria-label="Back to Top"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden="true"></i><svg viewBox="0 0 100 100">
              <circle class="bg" cx="50" cy="50" r="50"></circle>
              <circle class="progress" cx="50" cy="50" r="50"></circle>
            </svg></div><div id="toc-drawer-button" class="fixed-button toc-drawer-button d-none" role="button" aria-label="Contents"><i class="fa-solid fa-bars fa-fw" aria-hidden="true"></i></div></div><div id="mask"></div><noscript>
    <div class="noscript-warning">This website works best with JavaScript enabled.</div>
  </noscript>
</div><link rel="stylesheet" href="/lib/lightgallery/css/lightgallery-bundle.min.css"><link rel="stylesheet" href="/lib/pace/themes/blue/pace-theme-minimal.css"><script src="/lib/autocomplete/autocomplete.min.js" defer></script><script src="/lib/fuse/fuse.min.js" defer></script><script src="/lib/lightgallery/lightgallery.min.js" defer></script><script src="/lib/lightgallery/plugins/thumbnail/lg-thumbnail.min.js" defer></script><script src="/lib/lightgallery/plugins/zoom/lg-zoom.min.js" defer></script><script src="/lib/sharer/sharer.min.js" async defer></script><script src="/lib/typeit/index.umd.js" defer></script><script src="/lib/cell-watermark/watermark.min.js" defer></script><script src="/lib/pace/pace.min.js" async defer></script><script src="/js/config/fd005a4345ec3966e9c8f02c79ac9027.js" defer></script><script src="/js/lib/mermaid.js" type="module"></script><script src="/js/theme.min.js" defer></script><script src="/js/flyfish.min.js" defer></script></body>
</html>
