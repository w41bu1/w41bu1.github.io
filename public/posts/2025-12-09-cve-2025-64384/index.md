# CVE-2025-64384 Analysis & POC


<!--more-->

## CVE & Basic Info

The **Missing Authorization** vulnerability in **jetmonsters JetFormBuilder (jetformbuilder)** allows exploitation via **Incorrectly Configured Access Control Security Levels**. This issue affects **JetFormBuilder** from **n/a** to **<= 3.5.3**.

* **CVE ID**: [CVE-2025-64384](https://www.cve.org/CVERecord?id=CVE-2025-64384)
* **Vulnerability Type**: Broken Access Control
* **Affected Versions**: <= 3.5.3
* **Patched Versions**: 3.5.4
* **CVSS severity**: Low (5.3)
* **Required Privilege**: Contributor
* **Product**: [WordPress JetFormBuilder Plugin](https://wordpress.org/plugins/jetformbuilder/)

## Requirements

* **Local WordPress & Debugging**

  * [Virtual Machine](https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/)
  * [Docker](https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/)
* **Plugin Version** – **JetFormBuilder**:

  * `3.5.3` – **vulnerable**
  * `3.5.4` – **patched**
* **Diff Tool (diff)** → [**Meld**](https://meldmerge.org/) or any diff tool.

## Analysis

Perform code diff:

![Diff](diff.png "Difference between the vulnerable and patched versions")

**Vulnerable version (v3.5.3):**

The `Generate_Form_Endpoint` class contains functions that return the corresponding values used to register the REST API in WordPress:

* route: `/ai/generate`
* method: `POST`
* callback: `run_callback` used to generate forms with AI, with a limit of (15 requests / month)

![AI](ai.png "Form generation with AI")

This is the function used to register a new endpoint for the REST API. The basic structure is as follows:

```php
register_rest_route( 
    string $namespace, 
    string $route, 
    array  $args = array(), 
    bool   $override = false 
);
```

`$namespace`: Namespace for the route, usually the name of the plugin or module.
Example: `"myplugin/v1"`

`$route`: The endpoint path (after the namespace).
Example: `"/items"`

`$args`: Configuration array for the route, including:

* `methods`: HTTP methods (GET, POST, PUT, DELETE...).
* `callback`: Function executed when the endpoint is called.
* `permission_callback`: Function to check access permissions.
* `args`: (optional) Parameters passed to the endpoint.

`$override`: Default is `false`. If `true`, it will override an existing route.

By examining the functions in the `Generate_Form_Endpoint` class, we can see that if the API is registered, it lacks the `permission_callback` component to check access permissions. This allows all users (including unauthenticated users) to call this endpoint and freely use the AI form generation feature.

**Patched version (v3.5.4):**

```php
class Generate_Form_Endpoint extends Rest_Api_Private_Endpoint_Base
```

It indirectly extends `Rest_Api_Endpoint_Base` through `Rest_Api_Private_Endpoint_Base`:

```php
abstract class Rest_Api_Private_Endpoint_Base extends Rest_Api_Endpoint_Base {
	public function check_permission(): bool {
		return current_user_can( 'edit_jet_fb_forms' ); // admin only
	}
}
```

`check_permission` is created to override the `check_permission` method of `Rest_Api_Endpoint_Base`, ensuring that it is restricted to admin users.

```php
abstract class Rest_Api_Endpoint_Base implements Rest_Fetch_Endpoint {
    public function check_permission(): bool {
		return true; // permission_callback: true
	}
    ...
}
```

---

The plugin registered an action hook:

```php
add_action( 'rest_api_init', array( $this, 'register_routes' ) );
```

`rest_api_init`: This hook is triggered when WordPress initializes the **REST API**, at which point the `register_routes` callback is executed:

```php
public function register_routes() {
    foreach ( $this->routes() as $route ) {
        $endpoint_args = $route->get_overridden_args()
            ?: array(
                'methods'             => $route::get_methods(),
                'callback'            => array( $route, 'run_callback' ),
                'permission_callback' => array( $route, 'check_permission' ),
                'args'                => $route->get_common_args(),
            );

        $result = register_rest_route(
            $route::get_namespace(), // jet-form-builder/v1/
            "/{$route::get_rest_base()}",
            $endpoint_args,
            $route->get_override()
        );

        if ( ! $result ) {
            _doing_it_wrong(
                __METHOD__,
                "Error on register REST API route: {$route::get_namespace()}/{$route::get_rest_base()}",
                '1.4.0'
            );
        }
    }
}
```

The `register_routes` function iterates through each route and calls `register_rest_route` to register the API. `$this->routes()` contains the routes registered in two ways:

1. By extending `Rest_Api_Controller_Base`:

```php
class Controller extends Rest_Api_Controller_Base {
    protected $routes = array();
    public function __construct() {
        $this->routes = array(
            new Get_Form_Fields(),
            new Install_Migrations_Endpoint(),
        );
    }

    public function routes(): array {
        return $this->routes;
    }
}
```

2. By calling:

```php
$rest_api->get_controller()->install( new Generate_Form_Endpoint() );
```

## Flow

{{< mermaid >}}
graph TD
A["Attacker (Unauthenticated user)"]
--> B["Send POST request to /wp-json/jet-form-builder/v1/ai/generate"]
--> C["WordPress REST API receives request"]
--> D["JetFormBuilder register_routes() is triggered via rest_api_init"]
--> E["Generate_Form_Endpoint registered with: methods: POST callback: run_callback permission_callback: true (default)"]
--> F{"Is permission_callback properly defined?"}
F -- No (<=3.5.3) --> G["Access granted to all users"]
G --> H["run_callback executed → AI form generation"]
H --> I["Attacker bypasses intended restriction (15 requests/month)"]
F -- Yes (>=3.5.4) --> J["check_permission() requires current_user_can('edit_jet_fb_forms')"]
J --> K["Only Admin can access → Exploit prevented"]
{{< /mermaid >}}

## Proof of Concept (PoC)

Send a request as an unauthenticated user:

```http
POST /wp-json/jet-form-builder/v1/ai/generate HTTP/1.1
Host: localhost
...
prompt=create malicious form submit
```

![Result](resp.png "Result")

## Conclusion

CVE-2025-64384 stems from the **missing `permission_callback`** for the `/ai/generate` REST API in JetFormBuilder <= 3.5.3, allowing **unauthenticated users** to access the endpoint and abuse the AI-powered form generation feature. Version 3.5.4 fixed this by enforcing a permission check using `current_user_can('edit_jet_fb_forms')`, restricting access to administrators only and fully eliminating the exploit possibility.

## Key Takeaways

* Always define a `permission_callback` when registering REST API routes.
* Never rely on logical limits without proper access control.
* Inheriting the correct base class can prevent serious security flaws.

## References

[Broken Access Control](https://patchstack.com/academy/wordpress/vulnerabilities/broken-access-control/)

[WordPress JetFormBuilder Plugin <= 3.5.3 is vulnerable to Broken Access Control](https://patchstack.com/database/wordpress/plugin/jetformbuilder/vulnerability/wordpress-jetformbuilder-plugin-3-5-3-broken-access-control-vulnerability)


---

> Author: [Bui Van Y](github.com/w41bu1)  
> URL: http://localhost:1313/posts/2025-12-09-cve-2025-64384/  

