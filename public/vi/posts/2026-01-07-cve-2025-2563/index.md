# CVE-2025-2563 Analysis & POC


<!--more-->

## CVE & Basic Info
Plugin WordPress **User Registration & Membership** phiên bản **trước 4.1.2** **không ngăn chặn người dùng tự thiết lập vai trò tài khoản** khi **Membership Addon được kích hoạt**, dẫn đến **lỗ hổng leo thang đặc quyền** và cho phép **người dùng chưa xác thực** giành được **quyền quản trị (admin)**.

* **CVE ID**: [CVE-2025-2563](https://www.cve.org/CVERecord?id=CVE-2025-2563)
* **Vulnerability Type**: Privilege Escalation
* **Affected Versions**: <= 4.1.1
* **Patched Versions**: 4.1.2
* **CVSS severity**: High (9.8)
* **Required Privilege**: Unauthenticated
* **Product**: [WordPress User Registration Plugin](https://wordpress.org/plugins/user-registration/)

## Requirements
* **Local WordPress & Debugging**
    * [Virtual Machine](https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/)
    * [Docker](https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/)
* **Plugin Version** - **User Registration**:  
    * `4.1.1` – **vulnerable**  
    * `4.1.2` – **patched**
* **Diff Tool (diff)** → [**Meld**](https://meldmerge.org/) hoặc bất kỳ công cụ diff nào.

## Analysis 
Plugin đăng ký các shortcode như sau:

```php {title="class-bwf-data-tags.php v4.1.1" hl_lines=[2,8] data-open=true}
public $shortcodes = array(
    'get_cookie',
    'get_url_parameter',
);

public function __construct() {
    foreach ( $this->shortcodes as $code ) {
        add_shortcode( 'wf_' . $code, array( $this, $code ) );
    }
}
```


## Flow
{{< mermaid >}}
flowchart TD
A["Attacker (Contributor)"]
--> B["Create / Edit Post"]

B --> C["Insert shortcode wf_get_cookie into HTML attribute (img src)"]
C --> D["Post saved (draft or published)"]

D --> E["Admin visits post (preview or published URL)"]
E --> F["WordPress processes shortcode server-side"]

F --> G["wf_get_cookie reads wordpress_logged_in_* from $_COOKIE"]
G --> H["Cookie value rendered into HTML output"]

H --> I["Browser loads external resource (attacker.com)"]
I --> J["Admin authentication cookie leaked via URL"]

J --> K["Attacker captures wordpress_logged_in_* cookie"]
K --> L["Attacker sets stolen cookie in browser"]

L --> M["Access /my-account/edit-account/ as Admin"]
M --> N["Change admin email without re-authentication"]

N --> O["Trigger forgot password flow"]
O --> P["Reset password via attacker-controlled email"]

P --> Q["Full admin account takeover"]
{{< /mermaid >}}

## Proof of Concept (PoC)

## Conclusion

## Key Takeaways

## References
[Privilege Escalation](https://patchstack.com/academy/wordpress/vulnerabilities/privilege-escalation/)

[WordPress User Registration Plugin < 4.1.2 is vulnerable to a high priority Privilege Escalation](https://patchstack.com/database/wordpress/plugin/user-registration/vulnerability/wordpress-user-registration-membership-plugin-4-1-2-unauthenticated-privilege-escalation-vulnerability) 

---

> Tác giả: [Bui Van Y](github.com/w41bu1)  
> URL: http://localhost:1313/vi/posts/2026-01-07-cve-2025-2563/  

